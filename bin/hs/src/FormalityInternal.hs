module FormalityInternal where
import Unsafe.Coerce
import Data.Word
import Data.Bits
import Debug.Trace
import System.Exit
u = unsafeCoerce
run p = case p of {
  (1,f) -> (u f (\query param cont-> case query of {
    "print"    -> do { putStrLn param; run (cont ()); };
    "exit"     -> do { exitFailure; run (cont ()); };
    "get_line" -> do { line <- getLine; run (u cont line); };
    "get_file" -> do { line <- readFile param; run (u cont line); };
    otherwise  -> do { u cont (); };
  }));
  (0,f) -> (u f (\value-> do { (return :: a -> IO a) value; }));
}
word_to_u16       w        = u word_to_u16_go 0 w 0
word_to_u16_go 16 w      x = u x
word_to_u16_go  i (0,f)  x = u word_to_u16_go (i+1) (0,\t-> t) (x::Word16)
word_to_u16_go  i (1,f)  x = u f (\w-> word_to_u16_go (i+1) w x)
word_to_u16_go  i (2,f)  x = u f (\w-> word_to_u16_go (i+1) w (x .|. (shiftL 1 i)))
u16_to_word       x        = u u16_to_word_go 0 x (0,\t-> t)
u16_to_word_go 16 x      w = u w
u16_to_word_go  i x      w = u u16_to_word_go (i+1) (x::Word16) (if (shiftR x (16-i-1) .&. 1) > 0 then (2,\t-> t w) else (1,\t-> t w))
io = (\_a_1-> ())
io_ask = (\_query_2-> (\_param_3-> (\_then_4-> (1,\t-> t _query_2 _param_3 _then_4))))
io_bind = (\_a_3-> (\_f_4-> (let _0 = _a_3 in (case _0 of {(0,f) -> u f (\_1-> (u _f_4 _1)); (1,f) -> u f (\_2 _3 _4-> (u (u (u io_ask _2) _3) (\_x_8-> (u (u io_bind (u _4 _x_8)) _f_4)))); }))))
io_end = (\_value_2-> (0,\t-> t _value_2))
io_monad = (\_new_2-> (u (u _new_2 io_bind) io_end))
maybe = (\_a_1-> ())
map = (\_a_1-> ())
maybe_none = (0,\t-> t)
map_get = (\_bits_2-> (\_map_3-> (let _5 = _bits_2 in (case _5 of {(0,f) -> u f ((let _6 = _map_3 in (case _6 of {(0,f) -> u f (maybe_none); (1,f) -> u f (\_7 _8 _9-> _7); }))); (1,f) -> u f (\_10-> (let _11 = _map_3 in (case _11 of {(0,f) -> u f (maybe_none); (1,f) -> u f (\_12 _13 _14-> (u (u map_get _10) _13)); }))); (2,f) -> u f (\_15-> (let _16 = _map_3 in (case _16 of {(0,f) -> u f (maybe_none); (1,f) -> u f (\_17 _18 _19-> (u (u map_get _15) _19)); }))); }))))
bits_e = (0,\t-> t)
bool_false = False
bool_and = (\a0-> \a1-> (a0 && a1))
bool_true = True
cmp_as_lte = (\_cmp_1-> (let _20 = _cmp_1 in (case _20 of {(0,f) -> u f (bool_true); (1,f) -> u f (bool_true); (2,f) -> u f (bool_false); })))
cmp_ltn = (0,\t-> t)
cmp_gtn = (2,\t-> t)
word_cmp_go = (\_a_2-> (\_b_3-> (\_c_4-> (let _21 = _a_2 in (case _21 of {(0,f) -> u f ((\_b_5-> _c_4)); (1,f) -> u f (\_22-> (\_b_7-> (let _23 = _b_7 in (case _23 of {(0,f) -> u f ((\_a_pred_8-> _c_4)); (1,f) -> u f (\_24-> (\_a_pred_10-> (u (u (u word_cmp_go _a_pred_10) _24) _c_4))); (2,f) -> u f (\_25-> (\_a_pred_10-> (u (u (u word_cmp_go _a_pred_10) _25) cmp_ltn))); })) _22)); (2,f) -> u f (\_26-> (\_b_7-> (let _27 = _b_7 in (case _27 of {(0,f) -> u f ((\_a_pred_8-> _c_4)); (1,f) -> u f (\_28-> (\_a_pred_10-> (u (u (u word_cmp_go _a_pred_10) _28) cmp_gtn))); (2,f) -> u f (\_29-> (\_a_pred_10-> (u (u (u word_cmp_go _a_pred_10) _29) _c_4))); })) _26)); })) _b_3)))
cmp_eql = (1,\t-> t)
word_cmp = (\_a_2-> (\_b_3-> (u (u (u word_cmp_go _a_2) _b_3) cmp_eql)))
word_lte = (\_a_2-> (\_b_3-> (u cmp_as_lte (u (u word_cmp _a_2) _b_3))))
nat_succ = (\_pred_1-> 1+_pred_1)
nat_zero = 0
u16_lte = (\a0-> \a1-> ((a0::Word16) <= a1))
u16_btw = (\_a_1-> (\_b_2-> (\_c_3-> (((((_a_1::Word16) <= _b_2)) && (((_b_2::Word16) <= _c_3)))))))
u16_new = (\_value_1-> (word_to_u16 _value_1))
word_e = (0,\t-> t)
word = (\_size_1-> ())
word_i = (\_pred_2-> (2,\t-> t _pred_2))
word_o = (\_pred_2-> (1,\t-> t _pred_2))
word_subber = (\_a_2-> (\_b_3-> (\_c_4-> (let _30 = _a_2 in (case _30 of {(0,f) -> u f ((\_b_5-> word_e)); (1,f) -> u f (\_31-> (\_b_7-> (let _32 = _b_7 in (case _32 of {(0,f) -> u f ((\_a_pred_8-> word_e)); (1,f) -> u f (\_33-> (\_a_pred_10-> (let _34 = _c_4 in (if _34 then (u word_i (u (u (u word_subber _a_pred_10) _33) bool_true)) else (u word_o (u (u (u word_subber _a_pred_10) _33) bool_false)))))); (2,f) -> u f (\_35-> (\_a_pred_10-> (let _36 = _c_4 in (if _36 then (u word_o (u (u (u word_subber _a_pred_10) _35) bool_true)) else (u word_i (u (u (u word_subber _a_pred_10) _35) bool_true)))))); })) _31)); (2,f) -> u f (\_37-> (\_b_7-> (let _38 = _b_7 in (case _38 of {(0,f) -> u f ((\_a_pred_8-> word_e)); (1,f) -> u f (\_39-> (\_a_pred_10-> (let _40 = _c_4 in (if _40 then (u word_o (u (u (u word_subber _a_pred_10) _39) bool_false)) else (u word_i (u (u (u word_subber _a_pred_10) _39) bool_false)))))); (2,f) -> u f (\_41-> (\_a_pred_10-> (let _42 = _c_4 in (if _42 then (u word_i (u (u (u word_subber _a_pred_10) _41) bool_true)) else (u word_o (u (u (u word_subber _a_pred_10) _41) bool_false)))))); })) _37)); })) _b_3)))
word_sub = (\_a_2-> (\_b_3-> (u (u (u word_subber _a_2) _b_3) bool_false)))
u16_sub = (\a0-> \a1-> ((a0::Word16) - a1))
nat_apply = (\_n_2-> (\_f_3-> (\_x_4-> (let _43 = _n_2 in (if _43==0 then _x_4 else (u (u (u nat_apply (_43-1)) _f_3) (u _f_3 _x_4)))))))
word_inc = (\_word_2-> (let _44 = _word_2 in (case _44 of {(0,f) -> u f (word_e); (1,f) -> u f (\_45-> (u word_i _45)); (2,f) -> u f (\_46-> (u word_o (u word_inc _46))); })))
u16_inc = (\_a_1-> (let _47 = _a_1 in (u u16_new (u word_inc (u16_to_word _47)))))
word_zero = (\_size_1-> (let _48 = _size_1 in (if _48==0 then word_e else (u word_o (u word_zero (_48-1))))))
u16_zero = (u u16_new (u word_zero 16))
nat_to_u16 = (\a0-> (fromIntegral (a0::Integer)))
word_adder = (\_a_2-> (\_b_3-> (\_c_4-> (let _49 = _a_2 in (case _49 of {(0,f) -> u f ((\_b_5-> word_e)); (1,f) -> u f (\_50-> (\_b_7-> (let _51 = _b_7 in (case _51 of {(0,f) -> u f ((\_a_pred_8-> word_e)); (1,f) -> u f (\_52-> (\_a_pred_10-> (let _53 = _c_4 in (if _53 then (u word_i (u (u (u word_adder _a_pred_10) _52) bool_false)) else (u word_o (u (u (u word_adder _a_pred_10) _52) bool_false)))))); (2,f) -> u f (\_54-> (\_a_pred_10-> (let _55 = _c_4 in (if _55 then (u word_o (u (u (u word_adder _a_pred_10) _54) bool_true)) else (u word_i (u (u (u word_adder _a_pred_10) _54) bool_false)))))); })) _50)); (2,f) -> u f (\_56-> (\_b_7-> (let _57 = _b_7 in (case _57 of {(0,f) -> u f ((\_a_pred_8-> word_e)); (1,f) -> u f (\_58-> (\_a_pred_10-> (let _59 = _c_4 in (if _59 then (u word_o (u (u (u word_adder _a_pred_10) _58) bool_true)) else (u word_i (u (u (u word_adder _a_pred_10) _58) bool_false)))))); (2,f) -> u f (\_60-> (\_a_pred_10-> (let _61 = _c_4 in (if _61 then (u word_i (u (u (u word_adder _a_pred_10) _60) bool_true)) else (u word_o (u (u (u word_adder _a_pred_10) _60) bool_true)))))); })) _56)); })) _b_3)))
word_add = (\_a_2-> (\_b_3-> (u (u (u word_adder _a_2) _b_3) bool_false)))
u16_add = (\a0-> \a1-> ((a0::Word16) + a1))
cmp_as_eql = (\_cmp_1-> (let _62 = _cmp_1 in (case _62 of {(0,f) -> u f (bool_false); (1,f) -> u f (bool_true); (2,f) -> u f (bool_false); })))
word_eql = (\_a_2-> (\_b_3-> (u cmp_as_eql (u (u word_cmp _a_2) _b_3))))
u16_eql = (\a0-> \a1-> ((a0::Word16) == a1))
bits_o = (\_pred_1-> (1,\t-> t _pred_1))
bits_i = (\_pred_1-> (2,\t-> t _pred_1))
word_to_bits = (\_a_2-> (let _63 = _a_2 in (case _63 of {(0,f) -> u f (bits_e); (1,f) -> u f (\_64-> (u bits_o (u word_to_bits _64))); (2,f) -> u f (\_65-> (u bits_i (u word_to_bits _65))); })))
word_trim = (\_new_size_2-> (\_word_3-> (let _66 = _new_size_2 in (if _66==0 then word_e else (let _67 = _word_3 in (case _67 of {(0,f) -> u f ((u word_o (u (u word_trim (_66-1)) word_e))); (1,f) -> u f (\_68-> (u word_o (u (u word_trim (_66-1)) _68))); (2,f) -> u f (\_69-> (u word_i (u (u word_trim (_66-1)) _69))); }))))))
bits_concat = (\_a_1-> (\_b_2-> (let _70 = _a_1 in (case _70 of {(0,f) -> u f (_b_2); (1,f) -> u f (\_71-> (u bits_o (u (u bits_concat _71) _b_2))); (2,f) -> u f (\_72-> (u bits_i (u (u bits_concat _72) _b_2))); }))))
bits_reverse_tco = (\_a_1-> (\_r_2-> (let _73 = _a_1 in (case _73 of {(0,f) -> u f (_r_2); (1,f) -> u f (\_74-> (u (u bits_reverse_tco _74) (u bits_o _r_2))); (2,f) -> u f (\_75-> (u (u bits_reverse_tco _75) (u bits_i _r_2))); }))))
bits_reverse = (\_a_1-> (u (u bits_reverse_tco _a_1) bits_e))
fm_name_to_bits = (\_name_1-> (let _76 = _name_1 in (if null (_76::String) then bits_e else (let _chr_4=(fromIntegral (fromEnum (head _76 :: Char)) :: Word16) in (let _u16_5=(let _77 = (u (u (u u16_btw 65) _chr_4) 90) in (if _77 then (((_chr_4::Word16) - 65)) else (let _78 = (u (u (u u16_btw 97) _chr_4) 122) in (if _78 then (((_chr_4::Word16) - 71)) else (let _79 = (u (u (u u16_btw 48) _chr_4) 57) in (if _79 then (((_chr_4::Word16) + 4)) else (let _80 = (((46::Word16) == _chr_4)) in (if _80 then 62 else (let _81 = (((95::Word16) == _chr_4)) in (if _81 then 63 else 0)))))))))) in (let _bts_6=(let _82 = _u16_5 in (u word_to_bits (u (u word_trim 6) (u16_to_word _82)))) in (u (u bits_concat (u bits_reverse _bts_6)) (u fm_name_to_bits (tail _76)))))))))
fm_get = (\_name_2-> (\_map_3-> (u (u map_get (u fm_name_to_bits _name_2)) _map_3)))
string_cons = (\_head_1-> (\_tail_2-> ((toEnum (fromIntegral _head_1 :: Int) :: Char) : _tail_2)))
fm_synth_file_of = (\_name_1-> (let _83 = _name_1 in (if null (_83::String) then ".fm" else (let _84 = ((((fromIntegral (fromEnum (head _83 :: Char)) :: Word16)::Word16) == 46)) in (if _84 then ".fm" else (u (u string_cons (fromIntegral (fromEnum (head _83 :: Char)) :: Word16)) (u fm_synth_file_of (tail _83))))))))
io_get_file = (\_name_1-> (u (u (u io_ask "get_file") _name_1) (\_file_2-> (u io_end _file_2))))
parser_reply = (\_v_1-> ())
parser_reply_value = (\_idx_2-> (\_code_3-> (\_val_4-> (1,\t-> t _idx_2 _code_3 _val_4))))
parser_is_eof = (\_idx_1-> (\_code_2-> (let _85 = _code_2 in (if null (_85::String) then (u (u (u parser_reply_value _idx_1) _code_2) bool_true) else (u (u (u parser_reply_value _idx_1) _code_2) bool_false)))))
parser_reply_error = (\_idx_2-> (\_code_3-> (\_err_4-> (0,\t-> t _idx_2 _code_3 _err_4))))
parser = (\_v_1-> ())
maybe_some = (\_value_2-> (1,\t-> t _value_2))
parser_errorat_new = (\_idx_1-> (\_code_2-> (\_err_3-> (0,\t-> t _idx_1 _code_2 _err_3))))
nat_gtn = (\a0-> \a1-> ((a0::Integer) > a1))
parser_errorat_combine = (\_a_1-> (\_b_2-> (let _86 = _a_1 in (case _86 of {(0,f) -> u f (_b_2); (1,f) -> u f (\_87-> (let _88 = _b_2 in (case _88 of {(0,f) -> u f (_a_1); (1,f) -> u f (\_89-> (let _90 = _87 in (case _90 of {(0,f) -> u f (\_91 _92 _93-> (let _94 = _89 in (case _94 of {(0,f) -> u f (\_95 _96 _97-> (let _98 = (((_91::Integer) > _95)) in (if _98 then _a_1 else _b_2))); }))); }))); }))); }))))
parser_first_of_go = (\_pars_2-> (\_err_3-> (\_idx_4-> (\_code_5-> (let _99 = _pars_2 in (case _99 of {(0,f) -> u f ((let _100 = _err_3 in (case _100 of {(0,f) -> u f ((u (u (u parser_reply_error _idx_4) _code_5) "No parse.")); (1,f) -> u f (\_101-> (let _102 = _101 in (case _102 of {(0,f) -> u f (\_103 _104 _105-> (u (u (u parser_reply_error _103) _104) _105)); }))); }))); (1,f) -> u f (\_106 _107-> (let _parsed_8=(u (u _106 _idx_4) _code_5) in (let _108 = _parsed_8 in (case _108 of {(0,f) -> u f (\_109 _110 _111-> (let _neo_12=(u maybe_some (u (u (u parser_errorat_new _109) _110) _111)) in (let _err_13=(u (u parser_errorat_combine _neo_12) _err_3) in (u (u (u (u parser_first_of_go _107) _err_13) _idx_4) _code_5)))); (1,f) -> u f (\_112 _113 _114-> (u (u (u parser_reply_value _112) _113) _114)); })))); }))))))
parser_first_of = (\_pars_2-> (u (u parser_first_of_go _pars_2) maybe_none))
list_cons = (\_head_2-> (\_tail_3-> (1,\t-> t _head_2 _tail_3)))
list = (\_a_1-> ())
list_nil = (0,\t-> t)
parser_many_go = (\_parse_2-> (\_values_3-> (\_idx_4-> (\_code_5-> (let _115 = (u (u _parse_2 _idx_4) _code_5) in (case _115 of {(0,f) -> u f (\_116 _117 _118-> (u (u (u parser_reply_value _idx_4) _code_5) (u _values_3 list_nil))); (1,f) -> u f (\_119 _120 _121-> (u (u (u (u parser_many_go _parse_2) (\_xs_9-> (u _values_3 (u (u list_cons _121) _xs_9)))) _119) _120)); }))))))
parser_many = (\_parser_2-> (u (u parser_many_go _parser_2) (\_x_3-> _x_3)))
unit_new = ()
string_concat = (\a0-> \a1-> ((a0::String) ++ a1))
string_flatten_go = (\_xs_1-> (\_res_2-> (let _122 = _xs_1 in (case _122 of {(0,f) -> u f (_res_2); (1,f) -> u f (\_123 _124-> (u (u string_flatten_go _124) (((_res_2::String) ++ _123)))); }))))
string_flatten = (\_xs_1-> (u (u string_flatten_go _xs_1) ""))
string_nil = []
parser_text_go = (\_text_1-> (\_idx_2-> (\_code_3-> (let _125 = _text_1 in (if null (_125::String) then (u (u (u parser_reply_value _idx_2) _code_3) unit_new) else (let _126 = _code_3 in (if null (_126::String) then (let _error_6=(u string_flatten (u (u list_cons "Expected '") (u (u list_cons _text_1) (u (u list_cons "', found end of file.") list_nil)))) in (u (u (u parser_reply_error _idx_2) _code_3) _error_6)) else (let _127 = ((((fromIntegral (fromEnum (head _125 :: Char)) :: Word16)::Word16) == (fromIntegral (fromEnum (head _126 :: Char)) :: Word16))) in (if _127 then (u (u (u parser_text (tail _125)) (u nat_succ _idx_2)) (tail _126)) else (let _error_8=(u string_flatten (u (u list_cons "Expected '") (u (u list_cons _text_1) (u (u list_cons "', found '") (u (u list_cons (u (u string_cons (fromIntegral (fromEnum (head _126 :: Char)) :: Word16)) string_nil)) (u (u list_cons "'.") list_nil)))))) in (u (u (u parser_reply_error _idx_2) _code_3) _error_8)))))))))))
parser_text = (\_text_1-> (\_idx_2-> (\_code_3-> (let _128 = (u (u (u parser_text_go _text_1) _idx_2) _code_3) in (case _128 of {(0,f) -> u f (\_129 _130 _131-> (u (u (u parser_reply_error _idx_2) _code_3) _131)); (1,f) -> u f (\_132 _133 _134-> (u (u (u parser_reply_value _132) _133) _134)); })))))
parser_until_go = (\_until_2-> (\_parse_3-> (\_values_4-> (\_idx_5-> (\_code_6-> (let _until_reply_7=(u (u _until_2 _idx_5) _code_6) in (let _135 = _until_reply_7 in (case _135 of {(0,f) -> u f (\_136 _137 _138-> (let _reply_11=(u (u _parse_3 _idx_5) _code_6) in (let _139 = _reply_11 in (case _139 of {(0,f) -> u f (\_140 _141 _142-> (u (u (u parser_reply_error _140) _141) _142)); (1,f) -> u f (\_143 _144 _145-> (u (u (u (u (u parser_until_go _until_2) _parse_3) (\_xs_15-> (u _values_4 (u (u list_cons _145) _xs_15)))) _143) _144)); })))); (1,f) -> u f (\_146 _147 _148-> (u (u (u parser_reply_value _146) _147) (u _values_4 list_nil))); }))))))))
parser_until = (\_until_2-> (\_parse_3-> (u (u (u parser_until_go _until_2) _parse_3) (\_x_4-> _x_4))))
parser_one = (\_idx_1-> (\_code_2-> (let _149 = _code_2 in (if null (_149::String) then (u (u (u parser_reply_error _idx_1) _code_2) "Unexpected end of file.") else (u (u (u parser_reply_value (u nat_succ _idx_1)) (tail _149)) (fromIntegral (fromEnum (head _149 :: Char)) :: Word16))))))
fm_parser_spaces = (u parser_many (u parser_first_of (u (u list_cons (u parser_text " ")) (u (u list_cons (u parser_text "\n")) (u (u list_cons (\_idx_1-> (\_code_2-> (let _150 = (u (u (u parser_text "//") _idx_1) _code_2) in (case _150 of {(0,f) -> u f (\_151 _152 _153-> (u (u (u parser_reply_error _151) _152) _153)); (1,f) -> u f (\_154 _155 _156-> (let _157 = (u (u (u (u parser_until (u parser_text "\n")) parser_one) _154) _155) in (case _157 of {(0,f) -> u f (\_158 _159 _160-> (u (u (u parser_reply_error _158) _159) _160)); (1,f) -> u f (\_161 _162 _163-> (u (u (u parser_reply_value _161) _162) unit_new)); }))); }))))) list_nil)))))
fm_parser_text = (\_text_1-> (\_idx_2-> (\_code_3-> (let _164 = (u (u fm_parser_spaces _idx_2) _code_3) in (case _164 of {(0,f) -> u f (\_165 _166 _167-> (u (u (u parser_reply_error _165) _166) _167)); (1,f) -> u f (\_168 _169 _170-> (u (u (u parser_text _text_1) _168) _169)); })))))
parser_many1 = (\_parser_2-> (\_idx_3-> (\_code_4-> (let _171 = (u (u _parser_2 _idx_3) _code_4) in (case _171 of {(0,f) -> u f (\_172 _173 _174-> (u (u (u parser_reply_error _172) _173) _174)); (1,f) -> u f (\_175 _176 _177-> (let _178 = (u (u (u parser_many _parser_2) _175) _176) in (case _178 of {(0,f) -> u f (\_179 _180 _181-> (u (u (u parser_reply_error _179) _180) _181)); (1,f) -> u f (\_182 _183 _184-> (u (u (u parser_reply_value _182) _183) (u (u list_cons _177) _184))); }))); })))))
fm_name_is_letter = (\_chr_1-> (let _185 = (u (u (u u16_btw 65) _chr_1) 90) in (if _185 then bool_true else (let _186 = (u (u (u u16_btw 97) _chr_1) 122) in (if _186 then bool_true else (let _187 = (u (u (u u16_btw 48) _chr_1) 57) in (if _187 then bool_true else (let _188 = (((46::Word16) == _chr_1)) in (if _188 then bool_true else (let _189 = (((95::Word16) == _chr_1)) in (if _189 then bool_true else bool_false)))))))))))
fm_parser_letter = (\_idx_1-> (\_code_2-> (let _190 = _code_2 in (if null (_190::String) then (u (u (u parser_reply_error _idx_1) _code_2) "Unexpected eof.") else (let _191 = (u fm_name_is_letter (fromIntegral (fromEnum (head _190 :: Char)) :: Word16)) in (if _191 then (u (u (u parser_reply_value (u nat_succ _idx_1)) (tail _190)) (fromIntegral (fromEnum (head _190 :: Char)) :: Word16)) else (u (u (u parser_reply_error _idx_1) _code_2) "Expected letter.")))))))
list_fold = (\_list_2-> (\_nil_4-> (\_cons_5-> (let _192 = _list_2 in (case _192 of {(0,f) -> u f (_nil_4); (1,f) -> u f (\_193 _194-> (u (u _cons_5 _193) (u (u (u list_fold _194) _nil_4) _cons_5))); })))))
fm_parser_name1 = (\_idx_1-> (\_code_2-> (let _195 = (u (u fm_parser_spaces _idx_1) _code_2) in (case _195 of {(0,f) -> u f (\_196 _197 _198-> (u (u (u parser_reply_error _196) _197) _198)); (1,f) -> u f (\_199 _200 _201-> (let _202 = (u (u (u parser_many1 fm_parser_letter) _199) _200) in (case _202 of {(0,f) -> u f (\_203 _204 _205-> (u (u (u parser_reply_error _203) _204) _205)); (1,f) -> u f (\_206 _207 _208-> (u (u (u parser_reply_value _206) _207) (u (u (u list_fold _208) string_nil) string_cons))); }))); }))))
parser_until1 = (\_cond_2-> (\_parser_3-> (\_idx_4-> (\_code_5-> (let _209 = (u (u _parser_3 _idx_4) _code_5) in (case _209 of {(0,f) -> u f (\_210 _211 _212-> (u (u (u parser_reply_error _210) _211) _212)); (1,f) -> u f (\_213 _214 _215-> (let _216 = (u (u (u (u parser_until _cond_2) _parser_3) _213) _214) in (case _216 of {(0,f) -> u f (\_217 _218 _219-> (u (u (u parser_reply_error _217) _218) _219)); (1,f) -> u f (\_220 _221 _222-> (u (u (u parser_reply_value _220) _221) (u (u list_cons _215) _222))); }))); }))))))
pair = (\_a_1-> (\_b_2-> ()))
parser_maybe = (\_parse_2-> (\_idx_3-> (\_code_4-> (let _223 = (u (u _parse_2 _idx_3) _code_4) in (case _223 of {(0,f) -> u f (\_224 _225 _226-> (u (u (u parser_reply_value _idx_3) _code_4) maybe_none)); (1,f) -> u f (\_227 _228 _229-> (u (u (u parser_reply_value _227) _228) (u maybe_some _229))); })))))
fm_parser_item = (\_parser_2-> (\_idx_3-> (\_code_4-> (let _230 = (u (u fm_parser_spaces _idx_3) _code_4) in (case _230 of {(0,f) -> u f (\_231 _232 _233-> (u (u (u parser_reply_error _231) _232) _233)); (1,f) -> u f (\_234 _235 _236-> (let _237 = (u (u _parser_2 _234) _235) in (case _237 of {(0,f) -> u f (\_238 _239 _240-> (u (u (u parser_reply_error _238) _239) _240)); (1,f) -> u f (\_241 _242 _243-> (let _244 = (u (u (u parser_maybe (u fm_parser_text ",")) _241) _242) in (case _244 of {(0,f) -> u f (\_245 _246 _247-> (u (u (u parser_reply_error _245) _246) _247)); (1,f) -> u f (\_248 _249 _250-> (u (u (u parser_reply_value _248) _249) _243)); }))); }))); })))))
fm_parser_name = (\_idx_1-> (\_code_2-> (let _251 = (u (u fm_parser_spaces _idx_1) _code_2) in (case _251 of {(0,f) -> u f (\_252 _253 _254-> (u (u (u parser_reply_error _252) _253) _254)); (1,f) -> u f (\_255 _256 _257-> (let _258 = (u (u (u parser_many fm_parser_letter) _255) _256) in (case _258 of {(0,f) -> u f (\_259 _260 _261-> (u (u (u parser_reply_error _259) _260) _261)); (1,f) -> u f (\_262 _263 _264-> (u (u (u parser_reply_value _262) _263) (u (u (u list_fold _264) string_nil) string_cons))); }))); }))))
parser_get_code = (\_idx_1-> (\_code_2-> (u (u (u parser_reply_value _idx_1) _code_2) _code_2)))
parser_get_index = (\_idx_1-> (\_code_2-> (u (u (u parser_reply_value _idx_1) _code_2) _idx_1)))
fm_parser_init = (\_idx_1-> (\_code_2-> (let _265 = (u (u fm_parser_spaces _idx_1) _code_2) in (case _265 of {(0,f) -> u f (\_266 _267 _268-> (u (u (u parser_reply_error _266) _267) _268)); (1,f) -> u f (\_269 _270 _271-> (let _272 = (u (u parser_get_index _269) _270) in (case _272 of {(0,f) -> u f (\_273 _274 _275-> (u (u (u parser_reply_error _273) _274) _275)); (1,f) -> u f (\_276 _277 _278-> (u (u (u parser_reply_value _276) _277) _278)); }))); }))))
fm_origin_new = (\_file_1-> (\_from_2-> (\_upto_3-> (0,\t-> t _file_1 _from_2 _upto_3))))
fm_parser_stop = (\_from_1-> (\_idx_2-> (\_code_3-> (let _279 = (u (u parser_get_index _idx_2) _code_3) in (case _279 of {(0,f) -> u f (\_280 _281 _282-> (u (u (u parser_reply_error _280) _281) _282)); (1,f) -> u f (\_283 _284 _285-> (let _orig_7=(u (u (u fm_origin_new "") _from_1) _285) in (u (u (u parser_reply_value _283) _284) _orig_7))); })))))
fm_term_ori = (\_orig_1-> (\_expr_2-> (15,\t-> t _orig_1 _expr_2)))
fm_term_typ = (2,\t-> t)
fm_parser_type = (\_idx_1-> (\_code_2-> (let _286 = (u (u fm_parser_init _idx_1) _code_2) in (case _286 of {(0,f) -> u f (\_287 _288 _289-> (u (u (u parser_reply_error _287) _288) _289)); (1,f) -> u f (\_290 _291 _292-> (let _293 = (u (u (u fm_parser_text "Type") _290) _291) in (case _293 of {(0,f) -> u f (\_294 _295 _296-> (u (u (u parser_reply_error _294) _295) _296)); (1,f) -> u f (\_297 _298 _299-> (let _300 = (u (u (u fm_parser_stop _292) _297) _298) in (case _300 of {(0,f) -> u f (\_301 _302 _303-> (u (u (u parser_reply_error _301) _302) _303)); (1,f) -> u f (\_304 _305 _306-> (u (u (u parser_reply_value _304) _305) (u (u fm_term_ori _306) fm_term_typ))); }))); }))); }))))
fm_term_all = (\_eras_1-> (\_self_2-> (\_name_3-> (\_xtyp_4-> (\_body_5-> (3,\t-> t _eras_1 _self_2 _name_3 _xtyp_4 _body_5))))))
fm_parser_forall = (\_idx_1-> (\_code_2-> (let _307 = (u (u fm_parser_init _idx_1) _code_2) in (case _307 of {(0,f) -> u f (\_308 _309 _310-> (u (u (u parser_reply_error _308) _309) _310)); (1,f) -> u f (\_311 _312 _313-> (let _314 = (u (u fm_parser_name _311) _312) in (case _314 of {(0,f) -> u f (\_315 _316 _317-> (u (u (u parser_reply_error _315) _316) _317)); (1,f) -> u f (\_318 _319 _320-> (let _321 = (u (u fm_parser_binder _318) _319) in (case _321 of {(0,f) -> u f (\_322 _323 _324-> (u (u (u parser_reply_error _322) _323) _324)); (1,f) -> u f (\_325 _326 _327-> (let _328 = (u (u (u parser_maybe (u fm_parser_text "->")) _325) _326) in (case _328 of {(0,f) -> u f (\_329 _330 _331-> (u (u (u parser_reply_error _329) _330) _331)); (1,f) -> u f (\_332 _333 _334-> (let _335 = (u (u fm_parser_term _332) _333) in (case _335 of {(0,f) -> u f (\_336 _337 _338-> (u (u (u parser_reply_error _336) _337) _338)); (1,f) -> u f (\_339 _340 _341-> (let _term_18=(u (u (u list_fold _327) _341) (\_x_18-> (\_t_19-> (let _342 = _x_18 in (case _342 of {(0,f) -> u f (\_343 _344 _345-> (u (u (u (u (u fm_term_all _343) "") _344) _345) (\_s_23-> (\_x_24-> _t_19)))); }))))) in (let _346 = (u (u (u fm_parser_stop _313) _339) _340) in (case _346 of {(0,f) -> u f (\_347 _348 _349-> (u (u (u parser_reply_error _347) _348) _349)); (1,f) -> u f (\_350 _351 _352-> (u (u (u parser_reply_value _350) _351) (let _353 = _term_18 in (case _353 of {(0,f) -> u f (\_354 _355-> _term_18); (1,f) -> u f (\_356-> _term_18); (2,f) -> u f (_term_18); (3,f) -> u f (\_357 _358 _359 _360 _361-> (u (u fm_term_ori _352) (u (u (u (u (u fm_term_all _357) _320) _359) _360) _361))); (4,f) -> u f (\_362 _363-> _term_18); (5,f) -> u f (\_364 _365-> _term_18); (6,f) -> u f (\_366 _367 _368-> _term_18); (7,f) -> u f (\_369 _370 _371-> _term_18); (8,f) -> u f (\_372 _373 _374-> _term_18); (9,f) -> u f (\_375 _376 _377-> _term_18); (10,f) -> u f (\_378-> _term_18); (11,f) -> u f (\_379-> _term_18); (12,f) -> u f (\_380-> _term_18); (13,f) -> u f (\_381-> _term_18); (14,f) -> u f (\_382 _383 _384 _385 _386 _387-> _term_18); (15,f) -> u f (\_388 _389-> _term_18); })))); })))); }))); }))); }))); }))); }))))
fm_term_lam = (\_name_1-> (\_body_2-> (4,\t-> t _name_1 _body_2)))
fm_parser_make_lambda = (\_names_1-> (\_body_2-> (let _390 = _names_1 in (case _390 of {(0,f) -> u f (_body_2); (1,f) -> u f (\_391 _392-> (u (u fm_term_lam _391) (\_x_5-> (u (u fm_parser_make_lambda _392) _body_2)))); }))))
fm_parser_lambda = (\_idx_1-> (\_code_2-> (let _393 = (u (u fm_parser_init _idx_1) _code_2) in (case _393 of {(0,f) -> u f (\_394 _395 _396-> (u (u (u parser_reply_error _394) _395) _396)); (1,f) -> u f (\_397 _398 _399-> (let _400 = (u (u (u fm_parser_text "(") _397) _398) in (case _400 of {(0,f) -> u f (\_401 _402 _403-> (u (u (u parser_reply_error _401) _402) _403)); (1,f) -> u f (\_404 _405 _406-> (let _407 = (u (u (u (u parser_until1 (u fm_parser_text ")")) (u fm_parser_item fm_parser_name1)) _404) _405) in (case _407 of {(0,f) -> u f (\_408 _409 _410-> (u (u (u parser_reply_error _408) _409) _410)); (1,f) -> u f (\_411 _412 _413-> (let _414 = (u (u fm_parser_term _411) _412) in (case _414 of {(0,f) -> u f (\_415 _416 _417-> (u (u (u parser_reply_error _415) _416) _417)); (1,f) -> u f (\_418 _419 _420-> (let _421 = (u (u (u fm_parser_stop _399) _418) _419) in (case _421 of {(0,f) -> u f (\_422 _423 _424-> (u (u (u parser_reply_error _422) _423) _424)); (1,f) -> u f (\_425 _426 _427-> (let _expr_18=(u (u fm_parser_make_lambda _413) _420) in (u (u (u parser_reply_value _425) _426) (u (u fm_term_ori _427) _expr_18)))); }))); }))); }))); }))); }))))
fm_parser_lambda_erased = (\_idx_1-> (\_code_2-> (let _428 = (u (u fm_parser_init _idx_1) _code_2) in (case _428 of {(0,f) -> u f (\_429 _430 _431-> (u (u (u parser_reply_error _429) _430) _431)); (1,f) -> u f (\_432 _433 _434-> (let _435 = (u (u (u fm_parser_text "<") _432) _433) in (case _435 of {(0,f) -> u f (\_436 _437 _438-> (u (u (u parser_reply_error _436) _437) _438)); (1,f) -> u f (\_439 _440 _441-> (let _442 = (u (u (u (u parser_until1 (u fm_parser_text ">")) (u fm_parser_item fm_parser_name1)) _439) _440) in (case _442 of {(0,f) -> u f (\_443 _444 _445-> (u (u (u parser_reply_error _443) _444) _445)); (1,f) -> u f (\_446 _447 _448-> (let _449 = (u (u fm_parser_term _446) _447) in (case _449 of {(0,f) -> u f (\_450 _451 _452-> (u (u (u parser_reply_error _450) _451) _452)); (1,f) -> u f (\_453 _454 _455-> (let _456 = (u (u (u fm_parser_stop _434) _453) _454) in (case _456 of {(0,f) -> u f (\_457 _458 _459-> (u (u (u parser_reply_error _457) _458) _459)); (1,f) -> u f (\_460 _461 _462-> (let _expr_18=(u (u fm_parser_make_lambda _448) _455) in (u (u (u parser_reply_value _460) _461) (u (u fm_term_ori _462) _expr_18)))); }))); }))); }))); }))); }))))
fm_parser_lambda_nameless = (\_idx_1-> (\_code_2-> (let _463 = (u (u fm_parser_init _idx_1) _code_2) in (case _463 of {(0,f) -> u f (\_464 _465 _466-> (u (u (u parser_reply_error _464) _465) _466)); (1,f) -> u f (\_467 _468 _469-> (let _470 = (u (u (u fm_parser_text "()") _467) _468) in (case _470 of {(0,f) -> u f (\_471 _472 _473-> (u (u (u parser_reply_error _471) _472) _473)); (1,f) -> u f (\_474 _475 _476-> (let _477 = (u (u fm_parser_term _474) _475) in (case _477 of {(0,f) -> u f (\_478 _479 _480-> (u (u (u parser_reply_error _478) _479) _480)); (1,f) -> u f (\_481 _482 _483-> (let _484 = (u (u (u fm_parser_stop _469) _481) _482) in (case _484 of {(0,f) -> u f (\_485 _486 _487-> (u (u (u parser_reply_error _485) _486) _487)); (1,f) -> u f (\_488 _489 _490-> (let _expr_15=(u (u fm_term_lam "") (\_x_15-> _483)) in (u (u (u parser_reply_value _488) _489) (u (u fm_term_ori _490) _expr_15)))); }))); }))); }))); }))))
fm_parser_parenthesis = (\_idx_1-> (\_code_2-> (let _491 = (u (u (u fm_parser_text "(") _idx_1) _code_2) in (case _491 of {(0,f) -> u f (\_492 _493 _494-> (u (u (u parser_reply_error _492) _493) _494)); (1,f) -> u f (\_495 _496 _497-> (let _498 = (u (u fm_parser_term _495) _496) in (case _498 of {(0,f) -> u f (\_499 _500 _501-> (u (u (u parser_reply_error _499) _500) _501)); (1,f) -> u f (\_502 _503 _504-> (let _505 = (u (u (u fm_parser_text ")") _502) _503) in (case _505 of {(0,f) -> u f (\_506 _507 _508-> (u (u (u parser_reply_error _506) _507) _508)); (1,f) -> u f (\_509 _510 _511-> (u (u (u parser_reply_value _509) _510) _504)); }))); }))); }))))
fm_term_ref = (\_name_1-> (1,\t-> t _name_1))
fm_term_app = (\_func_1-> (\_argm_2-> (5,\t-> t _func_1 _argm_2)))
fm_term_hol = (\_path_1-> (10,\t-> t _path_1))
fm_term_let = (\_name_1-> (\_expr_2-> (\_body_3-> (6,\t-> t _name_1 _expr_2 _body_3))))
fm_parser_letforrange_u32 = (\_idx_1-> (\_code_2-> (let _512 = (u (u fm_parser_init _idx_1) _code_2) in (case _512 of {(0,f) -> u f (\_513 _514 _515-> (u (u (u parser_reply_error _513) _514) _515)); (1,f) -> u f (\_516 _517 _518-> (let _519 = (u (u (u fm_parser_text "let ") _516) _517) in (case _519 of {(0,f) -> u f (\_520 _521 _522-> (u (u (u parser_reply_error _520) _521) _522)); (1,f) -> u f (\_523 _524 _525-> (let _526 = (u (u fm_parser_name1 _523) _524) in (case _526 of {(0,f) -> u f (\_527 _528 _529-> (u (u (u parser_reply_error _527) _528) _529)); (1,f) -> u f (\_530 _531 _532-> (let _533 = (u (u (u fm_parser_text "=") _530) _531) in (case _533 of {(0,f) -> u f (\_534 _535 _536-> (u (u (u parser_reply_error _534) _535) _536)); (1,f) -> u f (\_537 _538 _539-> (let _540 = (u (u (u fm_parser_text "for ") _537) _538) in (case _540 of {(0,f) -> u f (\_541 _542 _543-> (u (u (u parser_reply_error _541) _542) _543)); (1,f) -> u f (\_544 _545 _546-> (let _547 = (u (u fm_parser_name1 _544) _545) in (case _547 of {(0,f) -> u f (\_548 _549 _550-> (u (u (u parser_reply_error _548) _549) _550)); (1,f) -> u f (\_551 _552 _553-> (let _554 = (u (u (u fm_parser_text ":") _551) _552) in (case _554 of {(0,f) -> u f (\_555 _556 _557-> (u (u (u parser_reply_error _555) _556) _557)); (1,f) -> u f (\_558 _559 _560-> (let _561 = (u (u (u fm_parser_text "U32") _558) _559) in (case _561 of {(0,f) -> u f (\_562 _563 _564-> (u (u (u parser_reply_error _562) _563) _564)); (1,f) -> u f (\_565 _566 _567-> (let _568 = (u (u (u fm_parser_text "=") _565) _566) in (case _568 of {(0,f) -> u f (\_569 _570 _571-> (u (u (u parser_reply_error _569) _570) _571)); (1,f) -> u f (\_572 _573 _574-> (let _575 = (u (u fm_parser_term _572) _573) in (case _575 of {(0,f) -> u f (\_576 _577 _578-> (u (u (u parser_reply_error _576) _577) _578)); (1,f) -> u f (\_579 _580 _581-> (let _582 = (u (u (u fm_parser_text "..") _579) _580) in (case _582 of {(0,f) -> u f (\_583 _584 _585-> (u (u (u parser_reply_error _583) _584) _585)); (1,f) -> u f (\_586 _587 _588-> (let _589 = (u (u fm_parser_term _586) _587) in (case _589 of {(0,f) -> u f (\_590 _591 _592-> (u (u (u parser_reply_error _590) _591) _592)); (1,f) -> u f (\_593 _594 _595-> (let _596 = (u (u (u fm_parser_text ":") _593) _594) in (case _596 of {(0,f) -> u f (\_597 _598 _599-> (u (u (u parser_reply_error _597) _598) _599)); (1,f) -> u f (\_600 _601 _602-> (let _603 = (u (u fm_parser_term _600) _601) in (case _603 of {(0,f) -> u f (\_604 _605 _606-> (u (u (u parser_reply_error _604) _605) _606)); (1,f) -> u f (\_607 _608 _609-> (let _610 = (u (u (u parser_maybe (u fm_parser_text ";")) _607) _608) in (case _610 of {(0,f) -> u f (\_611 _612 _613-> (u (u (u parser_reply_error _611) _612) _613)); (1,f) -> u f (\_614 _615 _616-> (let _617 = (u (u fm_parser_term _614) _615) in (case _617 of {(0,f) -> u f (\_618 _619 _620-> (u (u (u parser_reply_error _618) _619) _620)); (1,f) -> u f (\_621 _622 _623-> (let _624 = (u (u (u fm_parser_stop _518) _621) _622) in (case _624 of {(0,f) -> u f (\_625 _626 _627-> (u (u (u parser_reply_error _625) _626) _627)); (1,f) -> u f (\_628 _629 _630-> (let _term_54=(u fm_term_ref "U32.for") in (let _term_55=(u (u fm_term_app _term_54) (u fm_term_hol bits_e)) in (let _term_56=(u (u fm_term_app _term_55) (u fm_term_ref _532)) in (let _term_57=(u (u fm_term_app _term_56) _581) in (let _term_58=(u (u fm_term_app _term_57) _595) in (let _lamb_59=(u (u fm_term_lam _553) (\_e_59-> (u (u fm_term_lam _532) (\_s_60-> _609)))) in (let _term_60=(u (u fm_term_app _term_58) _lamb_59) in (let _term_61=(u (u (u fm_term_let _532) _term_60) (\_x_61-> _623)) in (u (u (u parser_reply_value _628) _629) (u (u fm_term_ori _630) _term_61))))))))))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))))
fm_parser_letforin = (\_idx_1-> (\_code_2-> (let _631 = (u (u fm_parser_init _idx_1) _code_2) in (case _631 of {(0,f) -> u f (\_632 _633 _634-> (u (u (u parser_reply_error _632) _633) _634)); (1,f) -> u f (\_635 _636 _637-> (let _638 = (u (u (u fm_parser_text "let ") _635) _636) in (case _638 of {(0,f) -> u f (\_639 _640 _641-> (u (u (u parser_reply_error _639) _640) _641)); (1,f) -> u f (\_642 _643 _644-> (let _645 = (u (u fm_parser_name1 _642) _643) in (case _645 of {(0,f) -> u f (\_646 _647 _648-> (u (u (u parser_reply_error _646) _647) _648)); (1,f) -> u f (\_649 _650 _651-> (let _652 = (u (u (u fm_parser_text "=") _649) _650) in (case _652 of {(0,f) -> u f (\_653 _654 _655-> (u (u (u parser_reply_error _653) _654) _655)); (1,f) -> u f (\_656 _657 _658-> (let _659 = (u (u (u fm_parser_text "for ") _656) _657) in (case _659 of {(0,f) -> u f (\_660 _661 _662-> (u (u (u parser_reply_error _660) _661) _662)); (1,f) -> u f (\_663 _664 _665-> (let _666 = (u (u fm_parser_name1 _663) _664) in (case _666 of {(0,f) -> u f (\_667 _668 _669-> (u (u (u parser_reply_error _667) _668) _669)); (1,f) -> u f (\_670 _671 _672-> (let _673 = (u (u (u fm_parser_text "in") _670) _671) in (case _673 of {(0,f) -> u f (\_674 _675 _676-> (u (u (u parser_reply_error _674) _675) _676)); (1,f) -> u f (\_677 _678 _679-> (let _680 = (u (u fm_parser_term _677) _678) in (case _680 of {(0,f) -> u f (\_681 _682 _683-> (u (u (u parser_reply_error _681) _682) _683)); (1,f) -> u f (\_684 _685 _686-> (let _687 = (u (u (u fm_parser_text ":") _684) _685) in (case _687 of {(0,f) -> u f (\_688 _689 _690-> (u (u (u parser_reply_error _688) _689) _690)); (1,f) -> u f (\_691 _692 _693-> (let _694 = (u (u fm_parser_term _691) _692) in (case _694 of {(0,f) -> u f (\_695 _696 _697-> (u (u (u parser_reply_error _695) _696) _697)); (1,f) -> u f (\_698 _699 _700-> (let _701 = (u (u (u parser_maybe (u fm_parser_text ";")) _698) _699) in (case _701 of {(0,f) -> u f (\_702 _703 _704-> (u (u (u parser_reply_error _702) _703) _704)); (1,f) -> u f (\_705 _706 _707-> (let _708 = (u (u fm_parser_term _705) _706) in (case _708 of {(0,f) -> u f (\_709 _710 _711-> (u (u (u parser_reply_error _709) _710) _711)); (1,f) -> u f (\_712 _713 _714-> (let _715 = (u (u (u fm_parser_stop _637) _712) _713) in (case _715 of {(0,f) -> u f (\_716 _717 _718-> (u (u (u parser_reply_error _716) _717) _718)); (1,f) -> u f (\_719 _720 _721-> (let _term_42=(u fm_term_ref "List.for") in (let _term_43=(u (u fm_term_app _term_42) (u fm_term_hol bits_e)) in (let _term_44=(u (u fm_term_app _term_43) _686) in (let _term_45=(u (u fm_term_app _term_44) (u fm_term_hol bits_e)) in (let _term_46=(u (u fm_term_app _term_45) (u fm_term_ref _651)) in (let _lamb_47=(u (u fm_term_lam _672) (\_i_47-> (u (u fm_term_lam _651) (\_x_48-> _700)))) in (let _term_48=(u (u fm_term_app _term_46) _lamb_47) in (let _term_49=(u (u (u fm_term_let _651) _term_48) (\_x_49-> _714)) in (u (u (u parser_reply_value _719) _720) (u (u fm_term_ori _721) _term_49))))))))))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))))
fm_parser_let = (\_idx_1-> (\_code_2-> (let _722 = (u (u fm_parser_init _idx_1) _code_2) in (case _722 of {(0,f) -> u f (\_723 _724 _725-> (u (u (u parser_reply_error _723) _724) _725)); (1,f) -> u f (\_726 _727 _728-> (let _729 = (u (u (u fm_parser_text "let ") _726) _727) in (case _729 of {(0,f) -> u f (\_730 _731 _732-> (u (u (u parser_reply_error _730) _731) _732)); (1,f) -> u f (\_733 _734 _735-> (let _736 = (u (u fm_parser_name _733) _734) in (case _736 of {(0,f) -> u f (\_737 _738 _739-> (u (u (u parser_reply_error _737) _738) _739)); (1,f) -> u f (\_740 _741 _742-> (let _743 = (u (u (u fm_parser_text "=") _740) _741) in (case _743 of {(0,f) -> u f (\_744 _745 _746-> (u (u (u parser_reply_error _744) _745) _746)); (1,f) -> u f (\_747 _748 _749-> (let _750 = (u (u fm_parser_term _747) _748) in (case _750 of {(0,f) -> u f (\_751 _752 _753-> (u (u (u parser_reply_error _751) _752) _753)); (1,f) -> u f (\_754 _755 _756-> (let _757 = (u (u (u parser_maybe (u fm_parser_text ";")) _754) _755) in (case _757 of {(0,f) -> u f (\_758 _759 _760-> (u (u (u parser_reply_error _758) _759) _760)); (1,f) -> u f (\_761 _762 _763-> (let _764 = (u (u fm_parser_term _761) _762) in (case _764 of {(0,f) -> u f (\_765 _766 _767-> (u (u (u parser_reply_error _765) _766) _767)); (1,f) -> u f (\_768 _769 _770-> (let _771 = (u (u (u fm_parser_stop _728) _768) _769) in (case _771 of {(0,f) -> u f (\_772 _773 _774-> (u (u (u parser_reply_error _772) _773) _774)); (1,f) -> u f (\_775 _776 _777-> (u (u (u parser_reply_value _775) _776) (u (u fm_term_ori _777) (u (u (u fm_term_let _742) _756) (\_x_27-> _770))))); }))); }))); }))); }))); }))); }))); }))); }))))
fm_parser_get = (\_idx_1-> (\_code_2-> (let _778 = (u (u fm_parser_init _idx_1) _code_2) in (case _778 of {(0,f) -> u f (\_779 _780 _781-> (u (u (u parser_reply_error _779) _780) _781)); (1,f) -> u f (\_782 _783 _784-> (let _785 = (u (u (u fm_parser_text "let ") _782) _783) in (case _785 of {(0,f) -> u f (\_786 _787 _788-> (u (u (u parser_reply_error _786) _787) _788)); (1,f) -> u f (\_789 _790 _791-> (let _792 = (u (u (u fm_parser_text "{") _789) _790) in (case _792 of {(0,f) -> u f (\_793 _794 _795-> (u (u (u parser_reply_error _793) _794) _795)); (1,f) -> u f (\_796 _797 _798-> (let _799 = (u (u fm_parser_name _796) _797) in (case _799 of {(0,f) -> u f (\_800 _801 _802-> (u (u (u parser_reply_error _800) _801) _802)); (1,f) -> u f (\_803 _804 _805-> (let _806 = (u (u (u fm_parser_text ",") _803) _804) in (case _806 of {(0,f) -> u f (\_807 _808 _809-> (u (u (u parser_reply_error _807) _808) _809)); (1,f) -> u f (\_810 _811 _812-> (let _813 = (u (u fm_parser_name _810) _811) in (case _813 of {(0,f) -> u f (\_814 _815 _816-> (u (u (u parser_reply_error _814) _815) _816)); (1,f) -> u f (\_817 _818 _819-> (let _820 = (u (u (u fm_parser_text "}") _817) _818) in (case _820 of {(0,f) -> u f (\_821 _822 _823-> (u (u (u parser_reply_error _821) _822) _823)); (1,f) -> u f (\_824 _825 _826-> (let _827 = (u (u (u fm_parser_text "=") _824) _825) in (case _827 of {(0,f) -> u f (\_828 _829 _830-> (u (u (u parser_reply_error _828) _829) _830)); (1,f) -> u f (\_831 _832 _833-> (let _834 = (u (u fm_parser_term _831) _832) in (case _834 of {(0,f) -> u f (\_835 _836 _837-> (u (u (u parser_reply_error _835) _836) _837)); (1,f) -> u f (\_838 _839 _840-> (let _841 = (u (u (u parser_maybe (u fm_parser_text ";")) _838) _839) in (case _841 of {(0,f) -> u f (\_842 _843 _844-> (u (u (u parser_reply_error _842) _843) _844)); (1,f) -> u f (\_845 _846 _847-> (let _848 = (u (u fm_parser_term _845) _846) in (case _848 of {(0,f) -> u f (\_849 _850 _851-> (u (u (u parser_reply_error _849) _850) _851)); (1,f) -> u f (\_852 _853 _854-> (let _855 = (u (u (u fm_parser_stop _784) _852) _853) in (case _855 of {(0,f) -> u f (\_856 _857 _858-> (u (u (u parser_reply_error _856) _857) _858)); (1,f) -> u f (\_859 _860 _861-> (let _term_39=_840 in (let _term_40=(u (u fm_term_app _term_39) (u (u fm_term_lam "x") (\_x_40-> (u fm_term_hol bits_e)))) in (let _term_41=(u (u fm_term_app _term_40) (u (u fm_term_lam _805) (\_x_41-> (u (u fm_term_lam _819) (\_y_42-> _854))))) in (u (u (u parser_reply_value _859) _860) (u (u fm_term_ori _861) _term_41)))))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))))
fm_term_def = (\_name_1-> (\_expr_2-> (\_body_3-> (7,\t-> t _name_1 _expr_2 _body_3))))
fm_parser_def = (\_idx_1-> (\_code_2-> (let _862 = (u (u fm_parser_init _idx_1) _code_2) in (case _862 of {(0,f) -> u f (\_863 _864 _865-> (u (u (u parser_reply_error _863) _864) _865)); (1,f) -> u f (\_866 _867 _868-> (let _869 = (u (u (u fm_parser_text "def ") _866) _867) in (case _869 of {(0,f) -> u f (\_870 _871 _872-> (u (u (u parser_reply_error _870) _871) _872)); (1,f) -> u f (\_873 _874 _875-> (let _876 = (u (u fm_parser_name _873) _874) in (case _876 of {(0,f) -> u f (\_877 _878 _879-> (u (u (u parser_reply_error _877) _878) _879)); (1,f) -> u f (\_880 _881 _882-> (let _883 = (u (u (u fm_parser_text "=") _880) _881) in (case _883 of {(0,f) -> u f (\_884 _885 _886-> (u (u (u parser_reply_error _884) _885) _886)); (1,f) -> u f (\_887 _888 _889-> (let _890 = (u (u fm_parser_term _887) _888) in (case _890 of {(0,f) -> u f (\_891 _892 _893-> (u (u (u parser_reply_error _891) _892) _893)); (1,f) -> u f (\_894 _895 _896-> (let _897 = (u (u (u parser_maybe (u fm_parser_text ";")) _894) _895) in (case _897 of {(0,f) -> u f (\_898 _899 _900-> (u (u (u parser_reply_error _898) _899) _900)); (1,f) -> u f (\_901 _902 _903-> (let _904 = (u (u fm_parser_term _901) _902) in (case _904 of {(0,f) -> u f (\_905 _906 _907-> (u (u (u parser_reply_error _905) _906) _907)); (1,f) -> u f (\_908 _909 _910-> (let _911 = (u (u (u fm_parser_stop _868) _908) _909) in (case _911 of {(0,f) -> u f (\_912 _913 _914-> (u (u (u parser_reply_error _912) _913) _914)); (1,f) -> u f (\_915 _916 _917-> (u (u (u parser_reply_value _915) _916) (u (u fm_term_ori _917) (u (u (u fm_term_def _882) _896) (\_x_27-> _910))))); }))); }))); }))); }))); }))); }))); }))); }))))
fm_parser_if = (\_idx_1-> (\_code_2-> (let _918 = (u (u fm_parser_init _idx_1) _code_2) in (case _918 of {(0,f) -> u f (\_919 _920 _921-> (u (u (u parser_reply_error _919) _920) _921)); (1,f) -> u f (\_922 _923 _924-> (let _925 = (u (u (u fm_parser_text "if ") _922) _923) in (case _925 of {(0,f) -> u f (\_926 _927 _928-> (u (u (u parser_reply_error _926) _927) _928)); (1,f) -> u f (\_929 _930 _931-> (let _932 = (u (u fm_parser_term _929) _930) in (case _932 of {(0,f) -> u f (\_933 _934 _935-> (u (u (u parser_reply_error _933) _934) _935)); (1,f) -> u f (\_936 _937 _938-> (let _939 = (u (u (u fm_parser_text "then") _936) _937) in (case _939 of {(0,f) -> u f (\_940 _941 _942-> (u (u (u parser_reply_error _940) _941) _942)); (1,f) -> u f (\_943 _944 _945-> (let _946 = (u (u fm_parser_term _943) _944) in (case _946 of {(0,f) -> u f (\_947 _948 _949-> (u (u (u parser_reply_error _947) _948) _949)); (1,f) -> u f (\_950 _951 _952-> (let _953 = (u (u (u fm_parser_text "else") _950) _951) in (case _953 of {(0,f) -> u f (\_954 _955 _956-> (u (u (u parser_reply_error _954) _955) _956)); (1,f) -> u f (\_957 _958 _959-> (let _960 = (u (u fm_parser_term _957) _958) in (case _960 of {(0,f) -> u f (\_961 _962 _963-> (u (u (u parser_reply_error _961) _962) _963)); (1,f) -> u f (\_964 _965 _966-> (let _967 = (u (u (u fm_parser_stop _924) _964) _965) in (case _967 of {(0,f) -> u f (\_968 _969 _970-> (u (u (u parser_reply_error _968) _969) _970)); (1,f) -> u f (\_971 _972 _973-> (let _term_27=_938 in (let _term_28=(u (u fm_term_app _term_27) (u (u fm_term_lam "") (\_x_28-> (u fm_term_hol bits_e)))) in (let _term_29=(u (u fm_term_app _term_28) _952) in (let _term_30=(u (u fm_term_app _term_29) _966) in (u (u (u parser_reply_value _971) _972) (u (u fm_term_ori _973) _term_30))))))); }))); }))); }))); }))); }))); }))); }))); }))))
list_mapped = (\_as_2-> (\_f_4-> (let _974 = _as_2 in (case _974 of {(0,f) -> u f (list_nil); (1,f) -> u f (\_975 _976-> (u (u list_cons (u _f_4 _975)) (u (u list_mapped _976) _f_4))); }))))
pair_new = (\_fst_3-> (\_snd_4-> (0,\t-> t _fst_3 _snd_4)))
fm_backslash = 92
fm_escapes = (u (u list_cons (u (u pair_new "\\b") 8)) (u (u list_cons (u (u pair_new "\\f") 12)) (u (u list_cons (u (u pair_new "\\n") 10)) (u (u list_cons (u (u pair_new "\\r") 13)) (u (u list_cons (u (u pair_new "\\t") 9)) (u (u list_cons (u (u pair_new "\\v") 11)) (u (u list_cons (u (u pair_new (u (u string_cons fm_backslash) (u (u string_cons fm_backslash) string_nil))) fm_backslash)) (u (u list_cons (u (u pair_new "\\\"") 34)) (u (u list_cons (u (u pair_new "\\0") 0)) (u (u list_cons (u (u pair_new "\\'") 39)) list_nil))))))))))
fm_parser_char_single = (u parser_first_of (u (u list_cons (u parser_first_of (u (u list_mapped fm_escapes) (\_esc_1-> (let _977 = _esc_1 in (case _977 of {(0,f) -> u f (\_978 _979-> (\_idx_4-> (\_code_5-> (let _980 = (u (u (u parser_text _978) _idx_4) _code_5) in (case _980 of {(0,f) -> u f (\_981 _982 _983-> (u (u (u parser_reply_error _981) _982) _983)); (1,f) -> u f (\_984 _985 _986-> (u (u (u parser_reply_value _984) _985) _979)); }))))); })))))) (u (u list_cons parser_one) list_nil)))
fm_term_chr = (\_chrx_1-> (12,\t-> t _chrx_1))
fm_parser_char = (\_idx_1-> (\_code_2-> (let _987 = (u (u fm_parser_init _idx_1) _code_2) in (case _987 of {(0,f) -> u f (\_988 _989 _990-> (u (u (u parser_reply_error _988) _989) _990)); (1,f) -> u f (\_991 _992 _993-> (let _994 = (u (u (u fm_parser_text "'") _991) _992) in (case _994 of {(0,f) -> u f (\_995 _996 _997-> (u (u (u parser_reply_error _995) _996) _997)); (1,f) -> u f (\_998 _999 _1000-> (let _1001 = (u (u fm_parser_char_single _998) _999) in (case _1001 of {(0,f) -> u f (\_1002 _1003 _1004-> (u (u (u parser_reply_error _1002) _1003) _1004)); (1,f) -> u f (\_1005 _1006 _1007-> (let _1008 = (u (u (u parser_text "'") _1005) _1006) in (case _1008 of {(0,f) -> u f (\_1009 _1010 _1011-> (u (u (u parser_reply_error _1009) _1010) _1011)); (1,f) -> u f (\_1012 _1013 _1014-> (let _1015 = (u (u (u fm_parser_stop _993) _1012) _1013) in (case _1015 of {(0,f) -> u f (\_1016 _1017 _1018-> (u (u (u parser_reply_error _1016) _1017) _1018)); (1,f) -> u f (\_1019 _1020 _1021-> (u (u (u parser_reply_value _1019) _1020) (u (u fm_term_ori _1021) (u fm_term_chr _1007)))); }))); }))); }))); }))); }))))
fm_term_str = (\_strx_1-> (13,\t-> t _strx_1))
fm_parser_string = (\_idx_1-> (\_code_2-> (let _1022 = (u (u fm_parser_init _idx_1) _code_2) in (case _1022 of {(0,f) -> u f (\_1023 _1024 _1025-> (u (u (u parser_reply_error _1023) _1024) _1025)); (1,f) -> u f (\_1026 _1027 _1028-> (let _quot_6=(u (u string_cons 34) string_nil) in (let _1029 = (u (u (u fm_parser_text _quot_6) _1026) _1027) in (case _1029 of {(0,f) -> u f (\_1030 _1031 _1032-> (u (u (u parser_reply_error _1030) _1031) _1032)); (1,f) -> u f (\_1033 _1034 _1035-> (let _1036 = (u (u (u (u parser_until (u parser_text _quot_6)) fm_parser_char_single) _1033) _1034) in (case _1036 of {(0,f) -> u f (\_1037 _1038 _1039-> (u (u (u parser_reply_error _1037) _1038) _1039)); (1,f) -> u f (\_1040 _1041 _1042-> (let _strx_13=(u (u (u list_fold _1042) string_nil) string_cons) in (let _1043 = (u (u (u fm_parser_stop _1028) _1040) _1041) in (case _1043 of {(0,f) -> u f (\_1044 _1045 _1046-> (u (u (u parser_reply_error _1044) _1045) _1046)); (1,f) -> u f (\_1047 _1048 _1049-> (u (u (u parser_reply_value _1047) _1048) (u (u fm_term_ori _1049) (u fm_term_str _strx_13)))); })))); }))); })))); }))))
fm_parser_pair = (\_idx_1-> (\_code_2-> (let _1050 = (u (u fm_parser_init _idx_1) _code_2) in (case _1050 of {(0,f) -> u f (\_1051 _1052 _1053-> (u (u (u parser_reply_error _1051) _1052) _1053)); (1,f) -> u f (\_1054 _1055 _1056-> (let _1057 = (u (u (u fm_parser_text "{") _1054) _1055) in (case _1057 of {(0,f) -> u f (\_1058 _1059 _1060-> (u (u (u parser_reply_error _1058) _1059) _1060)); (1,f) -> u f (\_1061 _1062 _1063-> (let _1064 = (u (u fm_parser_term _1061) _1062) in (case _1064 of {(0,f) -> u f (\_1065 _1066 _1067-> (u (u (u parser_reply_error _1065) _1066) _1067)); (1,f) -> u f (\_1068 _1069 _1070-> (let _1071 = (u (u (u fm_parser_text ",") _1068) _1069) in (case _1071 of {(0,f) -> u f (\_1072 _1073 _1074-> (u (u (u parser_reply_error _1072) _1073) _1074)); (1,f) -> u f (\_1075 _1076 _1077-> (let _1078 = (u (u fm_parser_term _1075) _1076) in (case _1078 of {(0,f) -> u f (\_1079 _1080 _1081-> (u (u (u parser_reply_error _1079) _1080) _1081)); (1,f) -> u f (\_1082 _1083 _1084-> (let _1085 = (u (u (u fm_parser_text "}") _1082) _1083) in (case _1085 of {(0,f) -> u f (\_1086 _1087 _1088-> (u (u (u parser_reply_error _1086) _1087) _1088)); (1,f) -> u f (\_1089 _1090 _1091-> (let _1092 = (u (u (u fm_parser_stop _1056) _1089) _1090) in (case _1092 of {(0,f) -> u f (\_1093 _1094 _1095-> (u (u (u parser_reply_error _1093) _1094) _1095)); (1,f) -> u f (\_1096 _1097 _1098-> (let _term_24=(u fm_term_ref "Pair.new") in (let _term_25=(u (u fm_term_app _term_24) (u fm_term_hol bits_e)) in (let _term_26=(u (u fm_term_app _term_25) (u fm_term_hol bits_e)) in (let _term_27=(u (u fm_term_app _term_26) _1070) in (let _term_28=(u (u fm_term_app _term_27) _1084) in (u (u (u parser_reply_value _1096) _1097) (u (u fm_term_ori _1098) _term_28)))))))); }))); }))); }))); }))); }))); }))); }))))
fm_parser_sigma_type = (\_idx_1-> (\_code_2-> (let _1099 = (u (u fm_parser_init _idx_1) _code_2) in (case _1099 of {(0,f) -> u f (\_1100 _1101 _1102-> (u (u (u parser_reply_error _1100) _1101) _1102)); (1,f) -> u f (\_1103 _1104 _1105-> (let _1106 = (u (u (u fm_parser_text "{") _1103) _1104) in (case _1106 of {(0,f) -> u f (\_1107 _1108 _1109-> (u (u (u parser_reply_error _1107) _1108) _1109)); (1,f) -> u f (\_1110 _1111 _1112-> (let _1113 = (u (u fm_parser_name1 _1110) _1111) in (case _1113 of {(0,f) -> u f (\_1114 _1115 _1116-> (u (u (u parser_reply_error _1114) _1115) _1116)); (1,f) -> u f (\_1117 _1118 _1119-> (let _1120 = (u (u (u fm_parser_text ":") _1117) _1118) in (case _1120 of {(0,f) -> u f (\_1121 _1122 _1123-> (u (u (u parser_reply_error _1121) _1122) _1123)); (1,f) -> u f (\_1124 _1125 _1126-> (let _1127 = (u (u fm_parser_term _1124) _1125) in (case _1127 of {(0,f) -> u f (\_1128 _1129 _1130-> (u (u (u parser_reply_error _1128) _1129) _1130)); (1,f) -> u f (\_1131 _1132 _1133-> (let _1134 = (u (u (u fm_parser_text "}") _1131) _1132) in (case _1134 of {(0,f) -> u f (\_1135 _1136 _1137-> (u (u (u parser_reply_error _1135) _1136) _1137)); (1,f) -> u f (\_1138 _1139 _1140-> (let _1141 = (u (u fm_parser_term _1138) _1139) in (case _1141 of {(0,f) -> u f (\_1142 _1143 _1144-> (u (u (u parser_reply_error _1142) _1143) _1144)); (1,f) -> u f (\_1145 _1146 _1147-> (let _1148 = (u (u (u fm_parser_stop _1105) _1145) _1146) in (case _1148 of {(0,f) -> u f (\_1149 _1150 _1151-> (u (u (u parser_reply_error _1149) _1150) _1151)); (1,f) -> u f (\_1152 _1153 _1154-> (let _term_27=(u fm_term_ref "Sigma") in (let _term_28=(u (u fm_term_app _term_27) _1133) in (let _term_29=(u (u fm_term_app _term_28) (u (u fm_term_lam "x") (\_x_29-> _1147))) in (u (u (u parser_reply_value _1152) _1153) (u (u fm_term_ori _1154) _term_29)))))); }))); }))); }))); }))); }))); }))); }))); }))))
fm_parser_some = (\_idx_1-> (\_code_2-> (let _1155 = (u (u fm_parser_init _idx_1) _code_2) in (case _1155 of {(0,f) -> u f (\_1156 _1157 _1158-> (u (u (u parser_reply_error _1156) _1157) _1158)); (1,f) -> u f (\_1159 _1160 _1161-> (let _1162 = (u (u (u fm_parser_text "some(") _1159) _1160) in (case _1162 of {(0,f) -> u f (\_1163 _1164 _1165-> (u (u (u parser_reply_error _1163) _1164) _1165)); (1,f) -> u f (\_1166 _1167 _1168-> (let _1169 = (u (u fm_parser_term _1166) _1167) in (case _1169 of {(0,f) -> u f (\_1170 _1171 _1172-> (u (u (u parser_reply_error _1170) _1171) _1172)); (1,f) -> u f (\_1173 _1174 _1175-> (let _1176 = (u (u (u fm_parser_text ")") _1173) _1174) in (case _1176 of {(0,f) -> u f (\_1177 _1178 _1179-> (u (u (u parser_reply_error _1177) _1178) _1179)); (1,f) -> u f (\_1180 _1181 _1182-> (let _1183 = (u (u (u fm_parser_stop _1161) _1180) _1181) in (case _1183 of {(0,f) -> u f (\_1184 _1185 _1186-> (u (u (u parser_reply_error _1184) _1185) _1186)); (1,f) -> u f (\_1187 _1188 _1189-> (let _term_18=(u fm_term_ref "Maybe.some") in (let _term_19=(u (u fm_term_app _term_18) (u fm_term_hol bits_e)) in (let _term_20=(u (u fm_term_app _term_19) _1175) in (u (u (u parser_reply_value _1187) _1188) (u (u fm_term_ori _1189) _term_20)))))); }))); }))); }))); }))); }))))
fm_parser_apply = (\_idx_1-> (\_code_2-> (let _1190 = (u (u fm_parser_init _idx_1) _code_2) in (case _1190 of {(0,f) -> u f (\_1191 _1192 _1193-> (u (u (u parser_reply_error _1191) _1192) _1193)); (1,f) -> u f (\_1194 _1195 _1196-> (let _1197 = (u (u (u fm_parser_text "apply(") _1194) _1195) in (case _1197 of {(0,f) -> u f (\_1198 _1199 _1200-> (u (u (u parser_reply_error _1198) _1199) _1200)); (1,f) -> u f (\_1201 _1202 _1203-> (let _1204 = (u (u fm_parser_term _1201) _1202) in (case _1204 of {(0,f) -> u f (\_1205 _1206 _1207-> (u (u (u parser_reply_error _1205) _1206) _1207)); (1,f) -> u f (\_1208 _1209 _1210-> (let _1211 = (u (u (u fm_parser_text ",") _1208) _1209) in (case _1211 of {(0,f) -> u f (\_1212 _1213 _1214-> (u (u (u parser_reply_error _1212) _1213) _1214)); (1,f) -> u f (\_1215 _1216 _1217-> (let _1218 = (u (u fm_parser_term _1215) _1216) in (case _1218 of {(0,f) -> u f (\_1219 _1220 _1221-> (u (u (u parser_reply_error _1219) _1220) _1221)); (1,f) -> u f (\_1222 _1223 _1224-> (let _1225 = (u (u (u fm_parser_text ")") _1222) _1223) in (case _1225 of {(0,f) -> u f (\_1226 _1227 _1228-> (u (u (u parser_reply_error _1226) _1227) _1228)); (1,f) -> u f (\_1229 _1230 _1231-> (let _1232 = (u (u (u fm_parser_stop _1196) _1229) _1230) in (case _1232 of {(0,f) -> u f (\_1233 _1234 _1235-> (u (u (u parser_reply_error _1233) _1234) _1235)); (1,f) -> u f (\_1236 _1237 _1238-> (let _term_24=(u fm_term_ref "Equal.apply") in (let _term_25=(u (u fm_term_app _term_24) (u fm_term_hol bits_e)) in (let _term_26=(u (u fm_term_app _term_25) (u fm_term_hol bits_e)) in (let _term_27=(u (u fm_term_app _term_26) (u fm_term_hol bits_e)) in (let _term_28=(u (u fm_term_app _term_27) (u fm_term_hol bits_e)) in (let _term_29=(u (u fm_term_app _term_28) _1210) in (let _term_30=(u (u fm_term_app _term_29) _1224) in (u (u (u parser_reply_value _1236) _1237) (u (u fm_term_ori _1238) _term_30)))))))))); }))); }))); }))); }))); }))); }))); }))))
fm_name_read = (\_str_1-> _str_1)
fm_parser_list = (\_idx_1-> (\_code_2-> (let _1239 = (u (u fm_parser_init _idx_1) _code_2) in (case _1239 of {(0,f) -> u f (\_1240 _1241 _1242-> (u (u (u parser_reply_error _1240) _1241) _1242)); (1,f) -> u f (\_1243 _1244 _1245-> (let _1246 = (u (u (u fm_parser_text "[") _1243) _1244) in (case _1246 of {(0,f) -> u f (\_1247 _1248 _1249-> (u (u (u parser_reply_error _1247) _1248) _1249)); (1,f) -> u f (\_1250 _1251 _1252-> (let _1253 = (u (u (u (u parser_until (u fm_parser_text "]")) (u fm_parser_item fm_parser_term)) _1250) _1251) in (case _1253 of {(0,f) -> u f (\_1254 _1255 _1256-> (u (u (u parser_reply_error _1254) _1255) _1256)); (1,f) -> u f (\_1257 _1258 _1259-> (let _1260 = (u (u (u fm_parser_stop _1245) _1257) _1258) in (case _1260 of {(0,f) -> u f (\_1261 _1262 _1263-> (u (u (u parser_reply_error _1261) _1262) _1263)); (1,f) -> u f (\_1264 _1265 _1266-> (u (u (u parser_reply_value _1264) _1265) (u (u (u list_fold _1259) (u (u fm_term_app (u fm_term_ref (u fm_name_read "List.nil"))) (u fm_term_hol bits_e))) (\_x_15-> (\_xs_16-> (let _term_17=(u fm_term_ref (u fm_name_read "List.cons")) in (let _term_18=(u (u fm_term_app _term_17) (u fm_term_hol bits_e)) in (let _term_19=(u (u fm_term_app _term_18) _x_15) in (let _term_20=(u (u fm_term_app _term_19) _xs_16) in (u (u fm_term_ori _1266) _term_20)))))))))); }))); }))); }))); }))))
fm_parser_log = (\_idx_1-> (\_code_2-> (let _1267 = (u (u fm_parser_init _idx_1) _code_2) in (case _1267 of {(0,f) -> u f (\_1268 _1269 _1270-> (u (u (u parser_reply_error _1268) _1269) _1270)); (1,f) -> u f (\_1271 _1272 _1273-> (let _1274 = (u (u (u fm_parser_text "log(") _1271) _1272) in (case _1274 of {(0,f) -> u f (\_1275 _1276 _1277-> (u (u (u parser_reply_error _1275) _1276) _1277)); (1,f) -> u f (\_1278 _1279 _1280-> (let _1281 = (u (u (u (u parser_until (u fm_parser_text ")")) (u fm_parser_item fm_parser_term)) _1278) _1279) in (case _1281 of {(0,f) -> u f (\_1282 _1283 _1284-> (u (u (u parser_reply_error _1282) _1283) _1284)); (1,f) -> u f (\_1285 _1286 _1287-> (let _1288 = (u (u fm_parser_term _1285) _1286) in (case _1288 of {(0,f) -> u f (\_1289 _1290 _1291-> (u (u (u parser_reply_error _1289) _1290) _1291)); (1,f) -> u f (\_1292 _1293 _1294-> (let _term_15=(u fm_term_ref "Debug.log") in (let _term_16=(u (u fm_term_app _term_15) (u fm_term_hol bits_e)) in (let _args_17=(u (u (u list_fold _1287) (u fm_term_ref "String.nil")) (\_x_17-> (\_xs_18-> (let _arg_19=(u fm_term_ref "String.concat") in (let _arg_20=(u (u fm_term_app _arg_19) _x_17) in (let _arg_21=(u (u fm_term_app _arg_20) _xs_18) in _arg_21)))))) in (let _term_18=(u (u fm_term_app _term_16) _args_17) in (let _term_19=(u (u fm_term_app _term_18) (u (u fm_term_lam "x") (\_x_19-> _1294))) in (let _1295 = (u (u (u fm_parser_stop _1273) _1292) _1293) in (case _1295 of {(0,f) -> u f (\_1296 _1297 _1298-> (u (u (u parser_reply_error _1296) _1297) _1298)); (1,f) -> u f (\_1299 _1300 _1301-> (u (u (u parser_reply_value _1299) _1300) (u (u fm_term_ori _1301) _term_19))); })))))))); }))); }))); }))); }))))
fm_parser_forrange_u32 = (\_idx_1-> (\_code_2-> (let _1302 = (u (u fm_parser_init _idx_1) _code_2) in (case _1302 of {(0,f) -> u f (\_1303 _1304 _1305-> (u (u (u parser_reply_error _1303) _1304) _1305)); (1,f) -> u f (\_1306 _1307 _1308-> (let _1309 = (u (u (u fm_parser_text "for ") _1306) _1307) in (case _1309 of {(0,f) -> u f (\_1310 _1311 _1312-> (u (u (u parser_reply_error _1310) _1311) _1312)); (1,f) -> u f (\_1313 _1314 _1315-> (let _1316 = (u (u fm_parser_name1 _1313) _1314) in (case _1316 of {(0,f) -> u f (\_1317 _1318 _1319-> (u (u (u parser_reply_error _1317) _1318) _1319)); (1,f) -> u f (\_1320 _1321 _1322-> (let _1323 = (u (u (u fm_parser_text ":") _1320) _1321) in (case _1323 of {(0,f) -> u f (\_1324 _1325 _1326-> (u (u (u parser_reply_error _1324) _1325) _1326)); (1,f) -> u f (\_1327 _1328 _1329-> (let _1330 = (u (u (u fm_parser_text "U32") _1327) _1328) in (case _1330 of {(0,f) -> u f (\_1331 _1332 _1333-> (u (u (u parser_reply_error _1331) _1332) _1333)); (1,f) -> u f (\_1334 _1335 _1336-> (let _1337 = (u (u (u fm_parser_text "=") _1334) _1335) in (case _1337 of {(0,f) -> u f (\_1338 _1339 _1340-> (u (u (u parser_reply_error _1338) _1339) _1340)); (1,f) -> u f (\_1341 _1342 _1343-> (let _1344 = (u (u fm_parser_term _1341) _1342) in (case _1344 of {(0,f) -> u f (\_1345 _1346 _1347-> (u (u (u parser_reply_error _1345) _1346) _1347)); (1,f) -> u f (\_1348 _1349 _1350-> (let _1351 = (u (u (u fm_parser_text "..") _1348) _1349) in (case _1351 of {(0,f) -> u f (\_1352 _1353 _1354-> (u (u (u parser_reply_error _1352) _1353) _1354)); (1,f) -> u f (\_1355 _1356 _1357-> (let _1358 = (u (u fm_parser_term _1355) _1356) in (case _1358 of {(0,f) -> u f (\_1359 _1360 _1361-> (u (u (u parser_reply_error _1359) _1360) _1361)); (1,f) -> u f (\_1362 _1363 _1364-> (let _1365 = (u (u (u fm_parser_text "with") _1362) _1363) in (case _1365 of {(0,f) -> u f (\_1366 _1367 _1368-> (u (u (u parser_reply_error _1366) _1367) _1368)); (1,f) -> u f (\_1369 _1370 _1371-> (let _1372 = (u (u fm_parser_name1 _1369) _1370) in (case _1372 of {(0,f) -> u f (\_1373 _1374 _1375-> (u (u (u parser_reply_error _1373) _1374) _1375)); (1,f) -> u f (\_1376 _1377 _1378-> (let _1379 = (u (u (u fm_parser_text ":") _1376) _1377) in (case _1379 of {(0,f) -> u f (\_1380 _1381 _1382-> (u (u (u parser_reply_error _1380) _1381) _1382)); (1,f) -> u f (\_1383 _1384 _1385-> (let _1386 = (u (u fm_parser_term _1383) _1384) in (case _1386 of {(0,f) -> u f (\_1387 _1388 _1389-> (u (u (u parser_reply_error _1387) _1388) _1389)); (1,f) -> u f (\_1390 _1391 _1392-> (let _1393 = (u (u (u fm_parser_stop _1308) _1390) _1391) in (case _1393 of {(0,f) -> u f (\_1394 _1395 _1396-> (u (u (u parser_reply_error _1394) _1395) _1396)); (1,f) -> u f (\_1397 _1398 _1399-> (let _term_45=(u fm_term_ref "U32.for") in (let _term_46=(u (u fm_term_app _term_45) (u fm_term_hol bits_e)) in (let _term_47=(u (u fm_term_app _term_46) (u fm_term_ref _1378)) in (let _term_48=(u (u fm_term_app _term_47) _1350) in (let _term_49=(u (u fm_term_app _term_48) _1364) in (let _lamb_50=(u (u fm_term_lam _1322) (\_e_50-> (u (u fm_term_lam _1378) (\_s_51-> _1392)))) in (let _term_51=(u (u fm_term_app _term_49) _lamb_50) in (let _term_52=(u (u (u fm_term_let _1378) _term_51) (\_x_52-> (u fm_term_ref _1378))) in (u (u (u parser_reply_value _1397) _1398) (u (u fm_term_ori _1399) _term_52))))))))))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))))
fm_parser_forrange_u32_2 = (\_idx_1-> (\_code_2-> (let _1400 = (u (u fm_parser_init _idx_1) _code_2) in (case _1400 of {(0,f) -> u f (\_1401 _1402 _1403-> (u (u (u parser_reply_error _1401) _1402) _1403)); (1,f) -> u f (\_1404 _1405 _1406-> (let _1407 = (u (u (u fm_parser_text "for ") _1404) _1405) in (case _1407 of {(0,f) -> u f (\_1408 _1409 _1410-> (u (u (u parser_reply_error _1408) _1409) _1410)); (1,f) -> u f (\_1411 _1412 _1413-> (let _1414 = (u (u fm_parser_name1 _1411) _1412) in (case _1414 of {(0,f) -> u f (\_1415 _1416 _1417-> (u (u (u parser_reply_error _1415) _1416) _1417)); (1,f) -> u f (\_1418 _1419 _1420-> (let _1421 = (u (u (u fm_parser_text ":") _1418) _1419) in (case _1421 of {(0,f) -> u f (\_1422 _1423 _1424-> (u (u (u parser_reply_error _1422) _1423) _1424)); (1,f) -> u f (\_1425 _1426 _1427-> (let _1428 = (u (u (u fm_parser_text "U32") _1425) _1426) in (case _1428 of {(0,f) -> u f (\_1429 _1430 _1431-> (u (u (u parser_reply_error _1429) _1430) _1431)); (1,f) -> u f (\_1432 _1433 _1434-> (let _1435 = (u (u (u fm_parser_text "=") _1432) _1433) in (case _1435 of {(0,f) -> u f (\_1436 _1437 _1438-> (u (u (u parser_reply_error _1436) _1437) _1438)); (1,f) -> u f (\_1439 _1440 _1441-> (let _1442 = (u (u fm_parser_term _1439) _1440) in (case _1442 of {(0,f) -> u f (\_1443 _1444 _1445-> (u (u (u parser_reply_error _1443) _1444) _1445)); (1,f) -> u f (\_1446 _1447 _1448-> (let _1449 = (u (u (u fm_parser_text "..") _1446) _1447) in (case _1449 of {(0,f) -> u f (\_1450 _1451 _1452-> (u (u (u parser_reply_error _1450) _1451) _1452)); (1,f) -> u f (\_1453 _1454 _1455-> (let _1456 = (u (u fm_parser_term _1453) _1454) in (case _1456 of {(0,f) -> u f (\_1457 _1458 _1459-> (u (u (u parser_reply_error _1457) _1458) _1459)); (1,f) -> u f (\_1460 _1461 _1462-> (let _1463 = (u (u (u fm_parser_text ":") _1460) _1461) in (case _1463 of {(0,f) -> u f (\_1464 _1465 _1466-> (u (u (u parser_reply_error _1464) _1465) _1466)); (1,f) -> u f (\_1467 _1468 _1469-> (let _1470 = (u (u fm_parser_name1 _1467) _1468) in (case _1470 of {(0,f) -> u f (\_1471 _1472 _1473-> (u (u (u parser_reply_error _1471) _1472) _1473)); (1,f) -> u f (\_1474 _1475 _1476-> (let _1477 = (u (u (u fm_parser_text "=") _1474) _1475) in (case _1477 of {(0,f) -> u f (\_1478 _1479 _1480-> (u (u (u parser_reply_error _1478) _1479) _1480)); (1,f) -> u f (\_1481 _1482 _1483-> (let _1484 = (u (u fm_parser_term _1481) _1482) in (case _1484 of {(0,f) -> u f (\_1485 _1486 _1487-> (u (u (u parser_reply_error _1485) _1486) _1487)); (1,f) -> u f (\_1488 _1489 _1490-> (let _1491 = (u (u (u parser_maybe (u fm_parser_text ";")) _1488) _1489) in (case _1491 of {(0,f) -> u f (\_1492 _1493 _1494-> (u (u (u parser_reply_error _1492) _1493) _1494)); (1,f) -> u f (\_1495 _1496 _1497-> (let _1498 = (u (u fm_parser_term _1495) _1496) in (case _1498 of {(0,f) -> u f (\_1499 _1500 _1501-> (u (u (u parser_reply_error _1499) _1500) _1501)); (1,f) -> u f (\_1502 _1503 _1504-> (let _1505 = (u (u (u fm_parser_stop _1406) _1502) _1503) in (case _1505 of {(0,f) -> u f (\_1506 _1507 _1508-> (u (u (u parser_reply_error _1506) _1507) _1508)); (1,f) -> u f (\_1509 _1510 _1511-> (let _term_51=(u fm_term_ref "U32.for") in (let _term_52=(u (u fm_term_app _term_51) (u fm_term_hol bits_e)) in (let _term_53=(u (u fm_term_app _term_52) (u fm_term_ref _1476)) in (let _term_54=(u (u fm_term_app _term_53) _1448) in (let _term_55=(u (u fm_term_app _term_54) _1462) in (let _lamb_56=(u (u fm_term_lam _1420) (\_e_56-> (u (u fm_term_lam _1476) (\_s_57-> _1490)))) in (let _term_57=(u (u fm_term_app _term_55) _lamb_56) in (let _term_58=(u (u (u fm_term_let _1476) _term_57) (\_x_58-> _1504)) in (u (u (u parser_reply_value _1509) _1510) (u (u fm_term_ori _1511) _term_58))))))))))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))))
fm_parser_forin = (\_idx_1-> (\_code_2-> (let _1512 = (u (u fm_parser_init _idx_1) _code_2) in (case _1512 of {(0,f) -> u f (\_1513 _1514 _1515-> (u (u (u parser_reply_error _1513) _1514) _1515)); (1,f) -> u f (\_1516 _1517 _1518-> (let _1519 = (u (u (u fm_parser_text "for ") _1516) _1517) in (case _1519 of {(0,f) -> u f (\_1520 _1521 _1522-> (u (u (u parser_reply_error _1520) _1521) _1522)); (1,f) -> u f (\_1523 _1524 _1525-> (let _1526 = (u (u fm_parser_name1 _1523) _1524) in (case _1526 of {(0,f) -> u f (\_1527 _1528 _1529-> (u (u (u parser_reply_error _1527) _1528) _1529)); (1,f) -> u f (\_1530 _1531 _1532-> (let _1533 = (u (u (u fm_parser_text "in") _1530) _1531) in (case _1533 of {(0,f) -> u f (\_1534 _1535 _1536-> (u (u (u parser_reply_error _1534) _1535) _1536)); (1,f) -> u f (\_1537 _1538 _1539-> (let _1540 = (u (u fm_parser_term _1537) _1538) in (case _1540 of {(0,f) -> u f (\_1541 _1542 _1543-> (u (u (u parser_reply_error _1541) _1542) _1543)); (1,f) -> u f (\_1544 _1545 _1546-> (let _1547 = (u (u (u fm_parser_text "with") _1544) _1545) in (case _1547 of {(0,f) -> u f (\_1548 _1549 _1550-> (u (u (u parser_reply_error _1548) _1549) _1550)); (1,f) -> u f (\_1551 _1552 _1553-> (let _1554 = (u (u fm_parser_name1 _1551) _1552) in (case _1554 of {(0,f) -> u f (\_1555 _1556 _1557-> (u (u (u parser_reply_error _1555) _1556) _1557)); (1,f) -> u f (\_1558 _1559 _1560-> (let _1561 = (u (u (u fm_parser_text ":") _1558) _1559) in (case _1561 of {(0,f) -> u f (\_1562 _1563 _1564-> (u (u (u parser_reply_error _1562) _1563) _1564)); (1,f) -> u f (\_1565 _1566 _1567-> (let _1568 = (u (u fm_parser_term _1565) _1566) in (case _1568 of {(0,f) -> u f (\_1569 _1570 _1571-> (u (u (u parser_reply_error _1569) _1570) _1571)); (1,f) -> u f (\_1572 _1573 _1574-> (let _1575 = (u (u (u fm_parser_stop _1518) _1572) _1573) in (case _1575 of {(0,f) -> u f (\_1576 _1577 _1578-> (u (u (u parser_reply_error _1576) _1577) _1578)); (1,f) -> u f (\_1579 _1580 _1581-> (let _term_33=(u fm_term_ref "List.for") in (let _term_34=(u (u fm_term_app _term_33) (u fm_term_hol bits_e)) in (let _term_35=(u (u fm_term_app _term_34) _1546) in (let _term_36=(u (u fm_term_app _term_35) (u fm_term_hol bits_e)) in (let _term_37=(u (u fm_term_app _term_36) (u fm_term_ref _1560)) in (let _lamb_38=(u (u fm_term_lam _1532) (\_i_38-> (u (u fm_term_lam _1560) (\_x_39-> _1574)))) in (let _term_39=(u (u fm_term_app _term_37) _lamb_38) in (let _term_40=(u (u (u fm_term_let _1560) _term_39) (\_x_40-> (u fm_term_ref _1560))) in (u (u (u parser_reply_value _1579) _1580) (u (u fm_term_ori _1581) _term_40))))))))))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))))
fm_parser_forin_2 = (\_idx_1-> (\_code_2-> (let _1582 = (u (u fm_parser_init _idx_1) _code_2) in (case _1582 of {(0,f) -> u f (\_1583 _1584 _1585-> (u (u (u parser_reply_error _1583) _1584) _1585)); (1,f) -> u f (\_1586 _1587 _1588-> (let _1589 = (u (u (u fm_parser_text "for ") _1586) _1587) in (case _1589 of {(0,f) -> u f (\_1590 _1591 _1592-> (u (u (u parser_reply_error _1590) _1591) _1592)); (1,f) -> u f (\_1593 _1594 _1595-> (let _1596 = (u (u fm_parser_name1 _1593) _1594) in (case _1596 of {(0,f) -> u f (\_1597 _1598 _1599-> (u (u (u parser_reply_error _1597) _1598) _1599)); (1,f) -> u f (\_1600 _1601 _1602-> (let _1603 = (u (u (u fm_parser_text "in") _1600) _1601) in (case _1603 of {(0,f) -> u f (\_1604 _1605 _1606-> (u (u (u parser_reply_error _1604) _1605) _1606)); (1,f) -> u f (\_1607 _1608 _1609-> (let _1610 = (u (u fm_parser_term _1607) _1608) in (case _1610 of {(0,f) -> u f (\_1611 _1612 _1613-> (u (u (u parser_reply_error _1611) _1612) _1613)); (1,f) -> u f (\_1614 _1615 _1616-> (let _1617 = (u (u (u fm_parser_text ":") _1614) _1615) in (case _1617 of {(0,f) -> u f (\_1618 _1619 _1620-> (u (u (u parser_reply_error _1618) _1619) _1620)); (1,f) -> u f (\_1621 _1622 _1623-> (let _1624 = (u (u fm_parser_name1 _1621) _1622) in (case _1624 of {(0,f) -> u f (\_1625 _1626 _1627-> (u (u (u parser_reply_error _1625) _1626) _1627)); (1,f) -> u f (\_1628 _1629 _1630-> (let _1631 = (u (u (u fm_parser_text "=") _1628) _1629) in (case _1631 of {(0,f) -> u f (\_1632 _1633 _1634-> (u (u (u parser_reply_error _1632) _1633) _1634)); (1,f) -> u f (\_1635 _1636 _1637-> (let _1638 = (u (u fm_parser_term _1635) _1636) in (case _1638 of {(0,f) -> u f (\_1639 _1640 _1641-> (u (u (u parser_reply_error _1639) _1640) _1641)); (1,f) -> u f (\_1642 _1643 _1644-> (let _1645 = (u (u (u parser_maybe (u fm_parser_text ";")) _1642) _1643) in (case _1645 of {(0,f) -> u f (\_1646 _1647 _1648-> (u (u (u parser_reply_error _1646) _1647) _1648)); (1,f) -> u f (\_1649 _1650 _1651-> (let _1652 = (u (u fm_parser_term _1649) _1650) in (case _1652 of {(0,f) -> u f (\_1653 _1654 _1655-> (u (u (u parser_reply_error _1653) _1654) _1655)); (1,f) -> u f (\_1656 _1657 _1658-> (let _1659 = (u (u (u fm_parser_stop _1588) _1656) _1657) in (case _1659 of {(0,f) -> u f (\_1660 _1661 _1662-> (u (u (u parser_reply_error _1660) _1661) _1662)); (1,f) -> u f (\_1663 _1664 _1665-> (let _term_39=(u fm_term_ref "List.for") in (let _term_40=(u (u fm_term_app _term_39) (u fm_term_hol bits_e)) in (let _term_41=(u (u fm_term_app _term_40) _1616) in (let _term_42=(u (u fm_term_app _term_41) (u fm_term_hol bits_e)) in (let _term_43=(u (u fm_term_app _term_42) (u fm_term_ref _1630)) in (let _lamb_44=(u (u fm_term_lam _1602) (\_i_44-> (u (u fm_term_lam _1630) (\_x_45-> _1644)))) in (let _term_45=(u (u fm_term_app _term_43) _lamb_44) in (let _term_46=(u (u (u fm_term_let _1630) _term_45) (\_x_46-> _1658)) in (u (u (u parser_reply_value _1663) _1664) (u (u fm_term_ori _1665) _term_46))))))))))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))))
fm_parser_do_statements = (\_monad_name_1-> (u parser_first_of (u (u list_cons (\_idx_2-> (\_code_3-> (let _1666 = (u (u fm_parser_init _idx_2) _code_3) in (case _1666 of {(0,f) -> u f (\_1667 _1668 _1669-> (u (u (u parser_reply_error _1667) _1668) _1669)); (1,f) -> u f (\_1670 _1671 _1672-> (let _1673 = (u (u (u fm_parser_text "var ") _1670) _1671) in (case _1673 of {(0,f) -> u f (\_1674 _1675 _1676-> (u (u (u parser_reply_error _1674) _1675) _1676)); (1,f) -> u f (\_1677 _1678 _1679-> (let _1680 = (u (u fm_parser_name1 _1677) _1678) in (case _1680 of {(0,f) -> u f (\_1681 _1682 _1683-> (u (u (u parser_reply_error _1681) _1682) _1683)); (1,f) -> u f (\_1684 _1685 _1686-> (let _1687 = (u (u (u fm_parser_text "=") _1684) _1685) in (case _1687 of {(0,f) -> u f (\_1688 _1689 _1690-> (u (u (u parser_reply_error _1688) _1689) _1690)); (1,f) -> u f (\_1691 _1692 _1693-> (let _1694 = (u (u fm_parser_term _1691) _1692) in (case _1694 of {(0,f) -> u f (\_1695 _1696 _1697-> (u (u (u parser_reply_error _1695) _1696) _1697)); (1,f) -> u f (\_1698 _1699 _1700-> (let _1701 = (u (u (u parser_maybe (u fm_parser_text ";")) _1698) _1699) in (case _1701 of {(0,f) -> u f (\_1702 _1703 _1704-> (u (u (u parser_reply_error _1702) _1703) _1704)); (1,f) -> u f (\_1705 _1706 _1707-> (let _1708 = (u (u (u fm_parser_do_statements _monad_name_1) _1705) _1706) in (case _1708 of {(0,f) -> u f (\_1709 _1710 _1711-> (u (u (u parser_reply_error _1709) _1710) _1711)); (1,f) -> u f (\_1712 _1713 _1714-> (let _1715 = (u (u (u fm_parser_stop _1672) _1712) _1713) in (case _1715 of {(0,f) -> u f (\_1716 _1717 _1718-> (u (u (u parser_reply_error _1716) _1717) _1718)); (1,f) -> u f (\_1719 _1720 _1721-> (let _term_28=(u (u fm_term_app (u fm_term_ref "Monad.bind")) (u fm_term_ref _monad_name_1)) in (let _term_29=(u (u fm_term_app _term_28) (u fm_term_ref (((_monad_name_1::String) ++ ".monad")))) in (let _term_30=(u (u fm_term_app _term_29) (u fm_term_hol bits_e)) in (let _term_31=(u (u fm_term_app _term_30) (u fm_term_hol bits_e)) in (let _term_32=(u (u fm_term_app _term_31) _1700) in (let _term_33=(u (u fm_term_app _term_32) (u (u fm_term_lam _1686) (\_x_33-> _1714))) in (u (u (u parser_reply_value _1719) _1720) (u (u fm_term_ori _1721) _term_33))))))))); }))); }))); }))); }))); }))); }))); }))); }))))) (u (u list_cons (\_idx_2-> (\_code_3-> (let _1722 = (u (u fm_parser_init _idx_2) _code_3) in (case _1722 of {(0,f) -> u f (\_1723 _1724 _1725-> (u (u (u parser_reply_error _1723) _1724) _1725)); (1,f) -> u f (\_1726 _1727 _1728-> (let _1729 = (u (u (u fm_parser_text "let ") _1726) _1727) in (case _1729 of {(0,f) -> u f (\_1730 _1731 _1732-> (u (u (u parser_reply_error _1730) _1731) _1732)); (1,f) -> u f (\_1733 _1734 _1735-> (let _1736 = (u (u fm_parser_name1 _1733) _1734) in (case _1736 of {(0,f) -> u f (\_1737 _1738 _1739-> (u (u (u parser_reply_error _1737) _1738) _1739)); (1,f) -> u f (\_1740 _1741 _1742-> (let _1743 = (u (u (u fm_parser_text "=") _1740) _1741) in (case _1743 of {(0,f) -> u f (\_1744 _1745 _1746-> (u (u (u parser_reply_error _1744) _1745) _1746)); (1,f) -> u f (\_1747 _1748 _1749-> (let _1750 = (u (u fm_parser_term _1747) _1748) in (case _1750 of {(0,f) -> u f (\_1751 _1752 _1753-> (u (u (u parser_reply_error _1751) _1752) _1753)); (1,f) -> u f (\_1754 _1755 _1756-> (let _1757 = (u (u (u parser_maybe (u fm_parser_text ";")) _1754) _1755) in (case _1757 of {(0,f) -> u f (\_1758 _1759 _1760-> (u (u (u parser_reply_error _1758) _1759) _1760)); (1,f) -> u f (\_1761 _1762 _1763-> (let _1764 = (u (u (u fm_parser_do_statements _monad_name_1) _1761) _1762) in (case _1764 of {(0,f) -> u f (\_1765 _1766 _1767-> (u (u (u parser_reply_error _1765) _1766) _1767)); (1,f) -> u f (\_1768 _1769 _1770-> (let _1771 = (u (u (u fm_parser_stop _1728) _1768) _1769) in (case _1771 of {(0,f) -> u f (\_1772 _1773 _1774-> (u (u (u parser_reply_error _1772) _1773) _1774)); (1,f) -> u f (\_1775 _1776 _1777-> (u (u (u parser_reply_value _1775) _1776) (u (u fm_term_ori _1777) (u (u (u fm_term_let _1742) _1756) (\_x_28-> _1770))))); }))); }))); }))); }))); }))); }))); }))); }))))) (u (u list_cons (\_idx_2-> (\_code_3-> (let _1778 = (u (u fm_parser_init _idx_2) _code_3) in (case _1778 of {(0,f) -> u f (\_1779 _1780 _1781-> (u (u (u parser_reply_error _1779) _1780) _1781)); (1,f) -> u f (\_1782 _1783 _1784-> (let _1785 = (u (u (u fm_parser_text "return ") _1782) _1783) in (case _1785 of {(0,f) -> u f (\_1786 _1787 _1788-> (u (u (u parser_reply_error _1786) _1787) _1788)); (1,f) -> u f (\_1789 _1790 _1791-> (let _1792 = (u (u fm_parser_term _1789) _1790) in (case _1792 of {(0,f) -> u f (\_1793 _1794 _1795-> (u (u (u parser_reply_error _1793) _1794) _1795)); (1,f) -> u f (\_1796 _1797 _1798-> (let _1799 = (u (u (u parser_maybe (u fm_parser_text ";")) _1796) _1797) in (case _1799 of {(0,f) -> u f (\_1800 _1801 _1802-> (u (u (u parser_reply_error _1800) _1801) _1802)); (1,f) -> u f (\_1803 _1804 _1805-> (let _1806 = (u (u (u fm_parser_stop _1784) _1803) _1804) in (case _1806 of {(0,f) -> u f (\_1807 _1808 _1809-> (u (u (u parser_reply_error _1807) _1808) _1809)); (1,f) -> u f (\_1810 _1811 _1812-> (let _term_19=(u (u fm_term_app (u fm_term_ref "Monad.pure")) (u fm_term_ref _monad_name_1)) in (let _term_20=(u (u fm_term_app _term_19) (u fm_term_ref (((_monad_name_1::String) ++ ".monad")))) in (let _term_21=(u (u fm_term_app _term_20) (u fm_term_hol bits_e)) in (let _term_22=(u (u fm_term_app _term_21) _1798) in (u (u (u parser_reply_value _1810) _1811) (u (u fm_term_ori _1812) _term_22))))))); }))); }))); }))); }))); }))))) (u (u list_cons (\_idx_2-> (\_code_3-> (let _1813 = (u (u fm_parser_init _idx_2) _code_3) in (case _1813 of {(0,f) -> u f (\_1814 _1815 _1816-> (u (u (u parser_reply_error _1814) _1815) _1816)); (1,f) -> u f (\_1817 _1818 _1819-> (let _1820 = (u (u fm_parser_term _1817) _1818) in (case _1820 of {(0,f) -> u f (\_1821 _1822 _1823-> (u (u (u parser_reply_error _1821) _1822) _1823)); (1,f) -> u f (\_1824 _1825 _1826-> (let _1827 = (u (u (u parser_maybe (u fm_parser_text ";")) _1824) _1825) in (case _1827 of {(0,f) -> u f (\_1828 _1829 _1830-> (u (u (u parser_reply_error _1828) _1829) _1830)); (1,f) -> u f (\_1831 _1832 _1833-> (let _1834 = (u (u (u fm_parser_do_statements _monad_name_1) _1831) _1832) in (case _1834 of {(0,f) -> u f (\_1835 _1836 _1837-> (u (u (u parser_reply_error _1835) _1836) _1837)); (1,f) -> u f (\_1838 _1839 _1840-> (let _1841 = (u (u (u fm_parser_stop _1819) _1838) _1839) in (case _1841 of {(0,f) -> u f (\_1842 _1843 _1844-> (u (u (u parser_reply_error _1842) _1843) _1844)); (1,f) -> u f (\_1845 _1846 _1847-> (let _term_19=(u (u fm_term_app (u fm_term_ref "Monad.bind")) (u fm_term_ref _monad_name_1)) in (let _term_20=(u (u fm_term_app _term_19) (u fm_term_ref (((_monad_name_1::String) ++ ".monad")))) in (let _term_21=(u (u fm_term_app _term_20) (u fm_term_hol bits_e)) in (let _term_22=(u (u fm_term_app _term_21) (u fm_term_hol bits_e)) in (let _term_23=(u (u fm_term_app _term_22) _1826) in (let _term_24=(u (u fm_term_app _term_23) (u (u fm_term_lam "") (\_x_24-> _1840))) in (u (u (u parser_reply_value _1845) _1846) (u (u fm_term_ori _1847) _term_24))))))))); }))); }))); }))); }))); }))))) (u (u list_cons (\_idx_2-> (\_code_3-> (let _1848 = (u (u fm_parser_term _idx_2) _code_3) in (case _1848 of {(0,f) -> u f (\_1849 _1850 _1851-> (u (u (u parser_reply_error _1849) _1850) _1851)); (1,f) -> u f (\_1852 _1853 _1854-> (let _1855 = (u (u (u parser_maybe (u fm_parser_text ";")) _1852) _1853) in (case _1855 of {(0,f) -> u f (\_1856 _1857 _1858-> (u (u (u parser_reply_error _1856) _1857) _1858)); (1,f) -> u f (\_1859 _1860 _1861-> (u (u (u parser_reply_value _1859) _1860) _1854)); }))); }))))) list_nil)))))))
fm_parser_do = (\_idx_1-> (\_code_2-> (let _1862 = (u (u (u fm_parser_text "do ") _idx_1) _code_2) in (case _1862 of {(0,f) -> u f (\_1863 _1864 _1865-> (u (u (u parser_reply_error _1863) _1864) _1865)); (1,f) -> u f (\_1866 _1867 _1868-> (let _1869 = (u (u fm_parser_name1 _1866) _1867) in (case _1869 of {(0,f) -> u f (\_1870 _1871 _1872-> (u (u (u parser_reply_error _1870) _1871) _1872)); (1,f) -> u f (\_1873 _1874 _1875-> (let _1876 = (u (u (u fm_parser_text "{") _1873) _1874) in (case _1876 of {(0,f) -> u f (\_1877 _1878 _1879-> (u (u (u parser_reply_error _1877) _1878) _1879)); (1,f) -> u f (\_1880 _1881 _1882-> (let _1883 = (u (u (u fm_parser_do_statements _1875) _1880) _1881) in (case _1883 of {(0,f) -> u f (\_1884 _1885 _1886-> (u (u (u parser_reply_error _1884) _1885) _1886)); (1,f) -> u f (\_1887 _1888 _1889-> (let _1890 = (u (u (u fm_parser_text "}") _1887) _1888) in (case _1890 of {(0,f) -> u f (\_1891 _1892 _1893-> (u (u (u parser_reply_error _1891) _1892) _1893)); (1,f) -> u f (\_1894 _1895 _1896-> (u (u (u parser_reply_value _1894) _1895) _1889)); }))); }))); }))); }))); }))))
fm_term_nat = (\_natx_1-> (11,\t-> t _natx_1))
fm_term_unroll_nat = (\_natx_1-> (let _1897 = _natx_1 in (if _1897==0 then (u fm_term_ref (u fm_name_read "Nat.zero")) else (let _func_3=(u fm_term_ref (u fm_name_read "Nat.succ")) in (let _argm_4=(u fm_term_nat (_1897-1)) in (u (u fm_term_app _func_3) _argm_4))))))
u16_to_bits = (\_a_1-> (let _1898 = _a_1 in (u word_to_bits (u16_to_word _1898))))
fm_term_unroll_chr_bits = (\_bits_1-> (let _1899 = _bits_1 in (case _1899 of {(0,f) -> u f ((u fm_term_ref (u fm_name_read "Bits.e"))); (1,f) -> u f (\_1900-> (u (u fm_term_app (u fm_term_ref (u fm_name_read "Bits.o"))) (u fm_term_unroll_chr_bits _1900))); (2,f) -> u f (\_1901-> (u (u fm_term_app (u fm_term_ref (u fm_name_read "Bits.i"))) (u fm_term_unroll_chr_bits _1901))); })))
fm_term_unroll_chr = (\_chrx_1-> (let _bits_2=(u u16_to_bits _chrx_1) in (let _term_3=(u fm_term_ref (u fm_name_read "Word.from_bits")) in (let _term_4=(u (u fm_term_app _term_3) (u fm_term_nat 16)) in (let _term_5=(u (u fm_term_app _term_4) (u fm_term_unroll_chr_bits _bits_2)) in (let _term_6=(u (u fm_term_app (u fm_term_ref (u fm_name_read "U16.new"))) _term_5) in _term_6))))))
fm_term_unroll_str = (\_strx_1-> (let _1902 = _strx_1 in (if null (_1902::String) then (u fm_term_ref (u fm_name_read "String.nil")) else (let _char_4=(u fm_term_chr (fromIntegral (fromEnum (head _1902 :: Char)) :: Word16)) in (let _term_5=(u fm_term_ref (u fm_name_read "String.cons")) in (let _term_6=(u (u fm_term_app _term_5) _char_4) in (let _term_7=(u (u fm_term_app _term_6) (u fm_term_str (tail _1902))) in _term_7)))))))
fm_term_reduce = (\_term_1-> (\_defs_2-> (let _1903 = _term_1 in (case _1903 of {(0,f) -> u f (\_1904 _1905-> _term_1); (1,f) -> u f (\_1906-> (let _1907 = (u (u fm_get _1906) _defs_2) in (case _1907 of {(0,f) -> u f ((u fm_term_ref _1906)); (1,f) -> u f (\_1908-> (let _1909 = _1908 in (case _1909 of {(0,f) -> u f (\_1910 _1911 _1912 _1913 _1914 _1915-> (u (u fm_term_reduce _1913) _defs_2)); }))); }))); (2,f) -> u f (_term_1); (3,f) -> u f (\_1916 _1917 _1918 _1919 _1920-> _term_1); (4,f) -> u f (\_1921 _1922-> _term_1); (5,f) -> u f (\_1923 _1924-> (let _func_5=(u (u fm_term_reduce _1923) _defs_2) in (let _1925 = _func_5 in (case _1925 of {(0,f) -> u f (\_1926 _1927-> _term_1); (1,f) -> u f (\_1928-> _term_1); (2,f) -> u f (_term_1); (3,f) -> u f (\_1929 _1930 _1931 _1932 _1933-> _term_1); (4,f) -> u f (\_1934 _1935-> (u (u fm_term_reduce (u _1935 _1924)) _defs_2)); (5,f) -> u f (\_1936 _1937-> _term_1); (6,f) -> u f (\_1938 _1939 _1940-> _term_1); (7,f) -> u f (\_1941 _1942 _1943-> _term_1); (8,f) -> u f (\_1944 _1945 _1946-> _term_1); (9,f) -> u f (\_1947 _1948 _1949-> _term_1); (10,f) -> u f (\_1950-> _term_1); (11,f) -> u f (\_1951-> _term_1); (12,f) -> u f (\_1952-> _term_1); (13,f) -> u f (\_1953-> _term_1); (14,f) -> u f (\_1954 _1955 _1956 _1957 _1958 _1959-> _term_1); (15,f) -> u f (\_1960 _1961-> _term_1); })))); (6,f) -> u f (\_1962 _1963 _1964-> (u (u fm_term_reduce (u _1964 _1963)) _defs_2)); (7,f) -> u f (\_1965 _1966 _1967-> (u (u fm_term_reduce (u _1967 _1966)) _defs_2)); (8,f) -> u f (\_1968 _1969 _1970-> (u (u fm_term_reduce _1969) _defs_2)); (9,f) -> u f (\_1971 _1972 _1973-> _term_1); (10,f) -> u f (\_1974-> _term_1); (11,f) -> u f (\_1975-> (u (u fm_term_reduce (u fm_term_unroll_nat _1975)) _defs_2)); (12,f) -> u f (\_1976-> (u (u fm_term_reduce (u fm_term_unroll_chr _1976)) _defs_2)); (13,f) -> u f (\_1977-> (u (u fm_term_reduce (u fm_term_unroll_str _1977)) _defs_2)); (14,f) -> u f (\_1978 _1979 _1980 _1981 _1982 _1983-> _term_1); (15,f) -> u f (\_1984 _1985-> (u (u fm_term_reduce _1985) _defs_2)); }))))
map_new = (0,\t-> t)
fm_def_new = (\_file_1-> (\_code_2-> (\_name_3-> (\_term_4-> (\_type_5-> (\_stat_6-> (0,\t-> t _file_1 _code_2 _name_3 _term_4 _type_5 _stat_6)))))))
fm_status_init = (0,\t-> t)
fm_parser_case_with = (\_idx_1-> (\_code_2-> (let _1986 = (u (u (u fm_parser_text "with") _idx_1) _code_2) in (case _1986 of {(0,f) -> u f (\_1987 _1988 _1989-> (u (u (u parser_reply_error _1987) _1988) _1989)); (1,f) -> u f (\_1990 _1991 _1992-> (let _1993 = (u (u fm_parser_name1 _1990) _1991) in (case _1993 of {(0,f) -> u f (\_1994 _1995 _1996-> (u (u (u parser_reply_error _1994) _1995) _1996)); (1,f) -> u f (\_1997 _1998 _1999-> (let _2000 = (u (u (u fm_parser_text ":") _1997) _1998) in (case _2000 of {(0,f) -> u f (\_2001 _2002 _2003-> (u (u (u parser_reply_error _2001) _2002) _2003)); (1,f) -> u f (\_2004 _2005 _2006-> (let _2007 = (u (u fm_parser_term _2004) _2005) in (case _2007 of {(0,f) -> u f (\_2008 _2009 _2010-> (u (u (u parser_reply_error _2008) _2009) _2010)); (1,f) -> u f (\_2011 _2012 _2013-> (let _2014 = (u (u (u fm_parser_text "=") _2011) _2012) in (case _2014 of {(0,f) -> u f (\_2015 _2016 _2017-> (u (u (u parser_reply_error _2015) _2016) _2017)); (1,f) -> u f (\_2018 _2019 _2020-> (let _2021 = (u (u fm_parser_term _2018) _2019) in (case _2021 of {(0,f) -> u f (\_2022 _2023 _2024-> (u (u (u parser_reply_error _2022) _2023) _2024)); (1,f) -> u f (\_2025 _2026 _2027-> (u (u (u parser_reply_value _2025) _2026) (u (u (u (u (u (u fm_def_new "") "") _1999) _2027) _2013) fm_status_init))); }))); }))); }))); }))); }))); }))))
fm_parser_case_case = (\_idx_1-> (\_code_2-> (let _2028 = (u (u fm_parser_name1 _idx_1) _code_2) in (case _2028 of {(0,f) -> u f (\_2029 _2030 _2031-> (u (u (u parser_reply_error _2029) _2030) _2031)); (1,f) -> u f (\_2032 _2033 _2034-> (let _2035 = (u (u (u fm_parser_text ":") _2032) _2033) in (case _2035 of {(0,f) -> u f (\_2036 _2037 _2038-> (u (u (u parser_reply_error _2036) _2037) _2038)); (1,f) -> u f (\_2039 _2040 _2041-> (let _2042 = (u (u fm_parser_term _2039) _2040) in (case _2042 of {(0,f) -> u f (\_2043 _2044 _2045-> (u (u (u parser_reply_error _2043) _2044) _2045)); (1,f) -> u f (\_2046 _2047 _2048-> (let _2049 = (u (u (u parser_maybe (u fm_parser_text ",")) _2046) _2047) in (case _2049 of {(0,f) -> u f (\_2050 _2051 _2052-> (u (u (u parser_reply_error _2050) _2051) _2052)); (1,f) -> u f (\_2053 _2054 _2055-> (u (u (u parser_reply_value _2053) _2054) (u (u pair_new _2034) _2048))); }))); }))); }))); }))))
map_tie = (\_val_2-> (\_lft_3-> (\_rgt_4-> (1,\t-> t _val_2 _lft_3 _rgt_4))))
map_set = (\_bits_2-> (\_val_3-> (\_map_4-> (let _2056 = _bits_2 in (case _2056 of {(0,f) -> u f ((let _2057 = _map_4 in (case _2057 of {(0,f) -> u f ((u (u (u map_tie (u maybe_some _val_3)) map_new) map_new)); (1,f) -> u f (\_2058 _2059 _2060-> (u (u (u map_tie (u maybe_some _val_3)) _2059) _2060)); }))); (1,f) -> u f (\_2061-> (let _2062 = _map_4 in (case _2062 of {(0,f) -> u f ((u (u (u map_tie maybe_none) (u (u (u map_set _2061) _val_3) map_new)) map_new)); (1,f) -> u f (\_2063 _2064 _2065-> (u (u (u map_tie _2063) (u (u (u map_set _2061) _val_3) _2064)) _2065)); }))); (2,f) -> u f (\_2066-> (let _2067 = _map_4 in (case _2067 of {(0,f) -> u f ((u (u (u map_tie maybe_none) map_new) (u (u (u map_set _2066) _val_3) map_new))); (1,f) -> u f (\_2068 _2069 _2070-> (u (u (u map_tie _2068) _2069) (u (u (u map_set _2066) _val_3) _2070))); }))); })))))
map_from_list = (\_xs_2-> (let _2071 = _xs_2 in (case _2071 of {(0,f) -> u f (map_new); (1,f) -> u f (\_2072 _2073-> (let _2074 = _2072 in (case _2074 of {(0,f) -> u f (\_2075 _2076-> (u (u (u map_set _2075) _2076) (u map_from_list _2073))); }))); })))
pair_fst = (\_pair_3-> (let _2077 = _pair_3 in (case _2077 of {(0,f) -> u f (\_2078 _2079-> _2078); })))
pair_snd = (\_pair_3-> (let _2080 = _pair_3 in (case _2080 of {(0,f) -> u f (\_2081 _2082-> _2082); })))
fm_term_cse = (\_path_1-> (\_expr_2-> (\_name_3-> (\_with_4-> (\_cses_5-> (\_moti_6-> (14,\t-> t _path_1 _expr_2 _name_3 _with_4 _cses_5 _moti_6)))))))
fm_parser_case = (\_idx_1-> (\_code_2-> (let _2083 = (u (u fm_parser_init _idx_1) _code_2) in (case _2083 of {(0,f) -> u f (\_2084 _2085 _2086-> (u (u (u parser_reply_error _2084) _2085) _2086)); (1,f) -> u f (\_2087 _2088 _2089-> (let _2090 = (u (u (u fm_parser_text "case ") _2087) _2088) in (case _2090 of {(0,f) -> u f (\_2091 _2092 _2093-> (u (u (u parser_reply_error _2091) _2092) _2093)); (1,f) -> u f (\_2094 _2095 _2096-> (let _2097 = (u (u fm_parser_spaces _2094) _2095) in (case _2097 of {(0,f) -> u f (\_2098 _2099 _2100-> (u (u (u parser_reply_error _2098) _2099) _2100)); (1,f) -> u f (\_2101 _2102 _2103-> (let _2104 = (u (u fm_parser_term _2101) _2102) in (case _2104 of {(0,f) -> u f (\_2105 _2106 _2107-> (u (u (u parser_reply_error _2105) _2106) _2107)); (1,f) -> u f (\_2108 _2109 _2110-> (let _2111 = (u (u (u parser_maybe (\_idx_15-> (\_code_16-> (let _2112 = (u (u (u fm_parser_text "as") _idx_15) _code_16) in (case _2112 of {(0,f) -> u f (\_2113 _2114 _2115-> (u (u (u parser_reply_error _2113) _2114) _2115)); (1,f) -> u f (\_2116 _2117 _2118-> (u (u fm_parser_name1 _2116) _2117)); }))))) _2108) _2109) in (case _2111 of {(0,f) -> u f (\_2119 _2120 _2121-> (u (u (u parser_reply_error _2119) _2120) _2121)); (1,f) -> u f (\_2122 _2123 _2124-> (let _name_18=(let _2125 = _2124 in (case _2125 of {(0,f) -> u f ((let _2126 = (u (u fm_term_reduce _2110) map_new) in (case _2126 of {(0,f) -> u f (\_2127 _2128-> _2127); (1,f) -> u f (\_2129-> _2129); (2,f) -> u f ((u fm_name_read "self")); (3,f) -> u f (\_2130 _2131 _2132 _2133 _2134-> (u fm_name_read "self")); (4,f) -> u f (\_2135 _2136-> (u fm_name_read "self")); (5,f) -> u f (\_2137 _2138-> (u fm_name_read "self")); (6,f) -> u f (\_2139 _2140 _2141-> (u fm_name_read "self")); (7,f) -> u f (\_2142 _2143 _2144-> (u fm_name_read "self")); (8,f) -> u f (\_2145 _2146 _2147-> (u fm_name_read "self")); (9,f) -> u f (\_2148 _2149 _2150-> (u fm_name_read "self")); (10,f) -> u f (\_2151-> (u fm_name_read "self")); (11,f) -> u f (\_2152-> (u fm_name_read "self")); (12,f) -> u f (\_2153-> (u fm_name_read "self")); (13,f) -> u f (\_2154-> (u fm_name_read "self")); (14,f) -> u f (\_2155 _2156 _2157 _2158 _2159 _2160-> (u fm_name_read "self")); (15,f) -> u f (\_2161 _2162-> (u fm_name_read "self")); }))); (1,f) -> u f (\_2163-> _2163); })) in (let _2164 = (u (u (u parser_many fm_parser_case_with) _2122) _2123) in (case _2164 of {(0,f) -> u f (\_2165 _2166 _2167-> (u (u (u parser_reply_error _2165) _2166) _2167)); (1,f) -> u f (\_2168 _2169 _2170-> (let _2171 = (u (u (u fm_parser_text "{") _2168) _2169) in (case _2171 of {(0,f) -> u f (\_2172 _2173 _2174-> (u (u (u parser_reply_error _2172) _2173) _2174)); (1,f) -> u f (\_2175 _2176 _2177-> (let _2178 = (u (u (u (u parser_until (u fm_parser_text "}")) fm_parser_case_case) _2175) _2176) in (case _2178 of {(0,f) -> u f (\_2179 _2180 _2181-> (u (u (u parser_reply_error _2179) _2180) _2181)); (1,f) -> u f (\_2182 _2183 _2184-> (let _cses_28=(u map_from_list (u (u list_mapped _2184) (\_x_28-> (u (u pair_new (u fm_name_to_bits (u pair_fst _x_28))) (u pair_snd _x_28))))) in (let _2185 = (u (u (u parser_first_of (u (u list_cons (\_idx_29-> (\_code_30-> (let _2186 = (u (u (u fm_parser_text ":") _idx_29) _code_30) in (case _2186 of {(0,f) -> u f (\_2187 _2188 _2189-> (u (u (u parser_reply_error _2187) _2188) _2189)); (1,f) -> u f (\_2190 _2191 _2192-> (let _2193 = (u (u fm_parser_term _2190) _2191) in (case _2193 of {(0,f) -> u f (\_2194 _2195 _2196-> (u (u (u parser_reply_error _2194) _2195) _2196)); (1,f) -> u f (\_2197 _2198 _2199-> (u (u (u parser_reply_value _2197) _2198) (u maybe_some _2199))); }))); }))))) (u (u list_cons (\_idx_29-> (\_code_30-> (let _2200 = (u (u (u fm_parser_text "!") _idx_29) _code_30) in (case _2200 of {(0,f) -> u f (\_2201 _2202 _2203-> (u (u (u parser_reply_error _2201) _2202) _2203)); (1,f) -> u f (\_2204 _2205 _2206-> (u (u (u parser_reply_value _2204) _2205) maybe_none)); }))))) (u (u list_cons (\_idx_29-> (\_code_30-> (u (u (u parser_reply_value _idx_29) _code_30) (u maybe_some (u fm_term_hol bits_e)))))) list_nil)))) _2182) _2183) in (case _2185 of {(0,f) -> u f (\_2207 _2208 _2209-> (u (u (u parser_reply_error _2207) _2208) _2209)); (1,f) -> u f (\_2210 _2211 _2212-> (let _2213 = (u (u (u fm_parser_stop _2089) _2210) _2211) in (case _2213 of {(0,f) -> u f (\_2214 _2215 _2216-> (u (u (u parser_reply_error _2214) _2215) _2216)); (1,f) -> u f (\_2217 _2218 _2219-> (u (u (u parser_reply_value _2217) _2218) (u (u fm_term_ori _2219) (u (u (u (u (u (u fm_term_cse bits_e) _2110) _name_18) _2170) _cses_28) _2212)))); }))); })))); }))); }))); })))); }))); }))); }))); }))); }))))
fm_set = (\_name_2-> (\_val_3-> (\_map_4-> (u (u (u map_set (u fm_name_to_bits _name_2)) _val_3) _map_4))))
fm_parser_open = (\_idx_1-> (\_code_2-> (let _2220 = (u (u fm_parser_init _idx_1) _code_2) in (case _2220 of {(0,f) -> u f (\_2221 _2222 _2223-> (u (u (u parser_reply_error _2221) _2222) _2223)); (1,f) -> u f (\_2224 _2225 _2226-> (let _2227 = (u (u (u fm_parser_text "open ") _2224) _2225) in (case _2227 of {(0,f) -> u f (\_2228 _2229 _2230-> (u (u (u parser_reply_error _2228) _2229) _2230)); (1,f) -> u f (\_2231 _2232 _2233-> (let _2234 = (u (u fm_parser_spaces _2231) _2232) in (case _2234 of {(0,f) -> u f (\_2235 _2236 _2237-> (u (u (u parser_reply_error _2235) _2236) _2237)); (1,f) -> u f (\_2238 _2239 _2240-> (let _2241 = (u (u fm_parser_term _2238) _2239) in (case _2241 of {(0,f) -> u f (\_2242 _2243 _2244-> (u (u (u parser_reply_error _2242) _2243) _2244)); (1,f) -> u f (\_2245 _2246 _2247-> (let _2248 = (u (u (u parser_maybe (\_idx_15-> (\_code_16-> (let _2249 = (u (u (u fm_parser_text "as") _idx_15) _code_16) in (case _2249 of {(0,f) -> u f (\_2250 _2251 _2252-> (u (u (u parser_reply_error _2250) _2251) _2252)); (1,f) -> u f (\_2253 _2254 _2255-> (u (u fm_parser_name1 _2253) _2254)); }))))) _2245) _2246) in (case _2248 of {(0,f) -> u f (\_2256 _2257 _2258-> (u (u (u parser_reply_error _2256) _2257) _2258)); (1,f) -> u f (\_2259 _2260 _2261-> (let _2262 = (u (u (u parser_maybe (u fm_parser_text ";")) _2259) _2260) in (case _2262 of {(0,f) -> u f (\_2263 _2264 _2265-> (u (u (u parser_reply_error _2263) _2264) _2265)); (1,f) -> u f (\_2266 _2267 _2268-> (let _name_21=(let _2269 = _2261 in (case _2269 of {(0,f) -> u f ((let _2270 = (u (u fm_term_reduce _2247) map_new) in (case _2270 of {(0,f) -> u f (\_2271 _2272-> _2271); (1,f) -> u f (\_2273-> _2273); (2,f) -> u f ((u fm_name_read "self")); (3,f) -> u f (\_2274 _2275 _2276 _2277 _2278-> (u fm_name_read "self")); (4,f) -> u f (\_2279 _2280-> (u fm_name_read "self")); (5,f) -> u f (\_2281 _2282-> (u fm_name_read "self")); (6,f) -> u f (\_2283 _2284 _2285-> (u fm_name_read "self")); (7,f) -> u f (\_2286 _2287 _2288-> (u fm_name_read "self")); (8,f) -> u f (\_2289 _2290 _2291-> (u fm_name_read "self")); (9,f) -> u f (\_2292 _2293 _2294-> (u fm_name_read "self")); (10,f) -> u f (\_2295-> (u fm_name_read "self")); (11,f) -> u f (\_2296-> (u fm_name_read "self")); (12,f) -> u f (\_2297-> (u fm_name_read "self")); (13,f) -> u f (\_2298-> (u fm_name_read "self")); (14,f) -> u f (\_2299 _2300 _2301 _2302 _2303 _2304-> (u fm_name_read "self")); (15,f) -> u f (\_2305 _2306-> (u fm_name_read "self")); }))); (1,f) -> u f (\_2307-> _2307); })) in (let _wyth_22=list_nil in (let _2308 = (u (u fm_parser_term _2266) _2267) in (case _2308 of {(0,f) -> u f (\_2309 _2310 _2311-> (u (u (u parser_reply_error _2309) _2310) _2311)); (1,f) -> u f (\_2312 _2313 _2314-> (let _cses_26=(u (u (u fm_set "_") _2314) map_new) in (let _moti_27=(u maybe_some (u fm_term_hol bits_e)) in (let _2315 = (u (u (u fm_parser_stop _2226) _2312) _2313) in (case _2315 of {(0,f) -> u f (\_2316 _2317 _2318-> (u (u (u parser_reply_error _2316) _2317) _2318)); (1,f) -> u f (\_2319 _2320 _2321-> (u (u (u parser_reply_value _2319) _2320) (u (u fm_term_ori _2321) (u (u (u (u (u (u fm_term_cse bits_e) _2247) _name_21) _wyth_22) _cses_26) _moti_27)))); }))))); }))))); }))); }))); }))); }))); }))); }))))
parser_digit = (\_idx_1-> (\_code_2-> (let _2322 = _code_2 in (if null (_2322::String) then (u (u (u parser_reply_error _idx_1) _code_2) "Not a digit.") else (let _sidx_5=(u nat_succ _idx_1) in (let _2323 = ((((fromIntegral (fromEnum (head _2322 :: Char)) :: Word16)::Word16) == 48)) in (if _2323 then (u (u (u parser_reply_value _sidx_5) (tail _2322)) 0) else (let _2324 = ((((fromIntegral (fromEnum (head _2322 :: Char)) :: Word16)::Word16) == 49)) in (if _2324 then (u (u (u parser_reply_value _sidx_5) (tail _2322)) 1) else (let _2325 = ((((fromIntegral (fromEnum (head _2322 :: Char)) :: Word16)::Word16) == 50)) in (if _2325 then (u (u (u parser_reply_value _sidx_5) (tail _2322)) 2) else (let _2326 = ((((fromIntegral (fromEnum (head _2322 :: Char)) :: Word16)::Word16) == 51)) in (if _2326 then (u (u (u parser_reply_value _sidx_5) (tail _2322)) 3) else (let _2327 = ((((fromIntegral (fromEnum (head _2322 :: Char)) :: Word16)::Word16) == 52)) in (if _2327 then (u (u (u parser_reply_value _sidx_5) (tail _2322)) 4) else (let _2328 = ((((fromIntegral (fromEnum (head _2322 :: Char)) :: Word16)::Word16) == 53)) in (if _2328 then (u (u (u parser_reply_value _sidx_5) (tail _2322)) 5) else (let _2329 = ((((fromIntegral (fromEnum (head _2322 :: Char)) :: Word16)::Word16) == 54)) in (if _2329 then (u (u (u parser_reply_value _sidx_5) (tail _2322)) 6) else (let _2330 = ((((fromIntegral (fromEnum (head _2322 :: Char)) :: Word16)::Word16) == 55)) in (if _2330 then (u (u (u parser_reply_value _sidx_5) (tail _2322)) 7) else (let _2331 = ((((fromIntegral (fromEnum (head _2322 :: Char)) :: Word16)::Word16) == 56)) in (if _2331 then (u (u (u parser_reply_value _sidx_5) (tail _2322)) 8) else (let _2332 = ((((fromIntegral (fromEnum (head _2322 :: Char)) :: Word16)::Word16) == 57)) in (if _2332 then (u (u (u parser_reply_value _sidx_5) (tail _2322)) 9) else (u (u (u parser_reply_error _idx_1) _code_2) "Not a digit."))))))))))))))))))))))))))
nat_add = (\a0-> \a1-> ((a0::Integer) + a1))
nat_mul = (\a0-> \a1-> ((a0::Integer) * a1))
nat_from_base_go = (\_b_1-> (\_ds_2-> (\_p_3-> (\_res_4-> (let _2333 = _ds_2 in (case _2333 of {(0,f) -> u f (_res_4); (1,f) -> u f (\_2334 _2335-> (u (u (u (u nat_from_base_go _b_1) _2335) (((_b_1::Integer) * _p_3))) ((((((_2334::Integer) * _p_3))::Integer) + _res_4)))); }))))))
list_reverse_go = (\_xs_2-> (\_res_3-> (let _2336 = _xs_2 in (case _2336 of {(0,f) -> u f (_res_3); (1,f) -> u f (\_2337 _2338-> (u (u list_reverse_go _2338) (u (u list_cons _2337) _res_3))); }))))
list_reverse = (\_xs_2-> (u (u list_reverse_go _xs_2) list_nil))
nat_from_base = (\_base_1-> (\_ds_2-> (u (u (u (u nat_from_base_go _base_1) (u list_reverse _ds_2)) 1) 0)))
parser_nat = (\_idx_1-> (\_code_2-> (let _2339 = (u (u (u parser_many1 parser_digit) _idx_1) _code_2) in (case _2339 of {(0,f) -> u f (\_2340 _2341 _2342-> (u (u (u parser_reply_error _2340) _2341) _2342)); (1,f) -> u f (\_2343 _2344 _2345-> (u (u (u parser_reply_value _2343) _2344) (u (u nat_from_base 10) _2345))); }))))
bits_tail = (\_a_1-> (let _2346 = _a_1 in (case _2346 of {(0,f) -> u f (bits_e); (1,f) -> u f (\_2347-> _2347); (2,f) -> u f (\_2348-> _2348); })))
bits_inc = (\_a_1-> (let _2349 = _a_1 in (case _2349 of {(0,f) -> u f ((u bits_i bits_e)); (1,f) -> u f (\_2350-> (u bits_i _2350)); (2,f) -> u f (\_2351-> (u bits_o (u bits_inc _2351))); })))
nat_to_bits = (\_n_1-> (let _2352 = _n_1 in (if _2352==0 then bits_e else (u bits_inc (u nat_to_bits (_2352-1))))))
maybe_to_bool = (\_m_2-> (let _2353 = _m_2 in (case _2353 of {(0,f) -> u f (bool_false); (1,f) -> u f (\_2354-> bool_true); })))
fm_term_gol = (\_name_1-> (\_dref_2-> (\_verb_3-> (9,\t-> t _name_1 _dref_2 _verb_3))))
fm_parser_goal = (\_idx_1-> (\_code_2-> (let _2355 = (u (u fm_parser_init _idx_1) _code_2) in (case _2355 of {(0,f) -> u f (\_2356 _2357 _2358-> (u (u (u parser_reply_error _2356) _2357) _2358)); (1,f) -> u f (\_2359 _2360 _2361-> (let _2362 = (u (u (u fm_parser_text "?") _2359) _2360) in (case _2362 of {(0,f) -> u f (\_2363 _2364 _2365-> (u (u (u parser_reply_error _2363) _2364) _2365)); (1,f) -> u f (\_2366 _2367 _2368-> (let _2369 = (u (u fm_parser_name _2366) _2367) in (case _2369 of {(0,f) -> u f (\_2370 _2371 _2372-> (u (u (u parser_reply_error _2370) _2371) _2372)); (1,f) -> u f (\_2373 _2374 _2375-> (let _2376 = (u (u (u parser_many (\_idx_12-> (\_code_13-> (let _2377 = (u (u (u fm_parser_text "-") _idx_12) _code_13) in (case _2377 of {(0,f) -> u f (\_2378 _2379 _2380-> (u (u (u parser_reply_error _2378) _2379) _2380)); (1,f) -> u f (\_2381 _2382 _2383-> (let _2384 = (u (u parser_nat _2381) _2382) in (case _2384 of {(0,f) -> u f (\_2385 _2386 _2387-> (u (u (u parser_reply_error _2385) _2386) _2387)); (1,f) -> u f (\_2388 _2389 _2390-> (let _bits_20=(u bits_reverse (u bits_tail (u bits_reverse (u nat_to_bits _2390)))) in (u (u (u parser_reply_value _2388) _2389) _bits_20))); }))); }))))) _2373) _2374) in (case _2376 of {(0,f) -> u f (\_2391 _2392 _2393-> (u (u (u parser_reply_error _2391) _2392) _2393)); (1,f) -> u f (\_2394 _2395 _2396-> (let _2397 = (let _2398 = (u (u (u parser_maybe (u parser_text "-")) _2394) _2395) in (case _2398 of {(0,f) -> u f (\_2399 _2400 _2401-> (u (u (u parser_reply_error _2399) _2400) _2401)); (1,f) -> u f (\_2402 _2403 _2404-> (u (u (u parser_reply_value _2402) _2403) (u maybe_to_bool _2404))); })) in (case _2397 of {(0,f) -> u f (\_2405 _2406 _2407-> (u (u (u parser_reply_error _2405) _2406) _2407)); (1,f) -> u f (\_2408 _2409 _2410-> (let _2411 = (u (u (u fm_parser_stop _2361) _2408) _2409) in (case _2411 of {(0,f) -> u f (\_2412 _2413 _2414-> (u (u (u parser_reply_error _2412) _2413) _2414)); (1,f) -> u f (\_2415 _2416 _2417-> (u (u (u parser_reply_value _2415) _2416) (u (u fm_term_ori _2417) (u (u (u fm_term_gol _2375) _2396) _2410)))); }))); }))); }))); }))); }))); }))))
fm_parser_hole = (\_idx_1-> (\_code_2-> (let _2418 = (u (u fm_parser_init _idx_1) _code_2) in (case _2418 of {(0,f) -> u f (\_2419 _2420 _2421-> (u (u (u parser_reply_error _2419) _2420) _2421)); (1,f) -> u f (\_2422 _2423 _2424-> (let _2425 = (u (u (u fm_parser_text "_") _2422) _2423) in (case _2425 of {(0,f) -> u f (\_2426 _2427 _2428-> (u (u (u parser_reply_error _2426) _2427) _2428)); (1,f) -> u f (\_2429 _2430 _2431-> (let _2432 = (u (u (u fm_parser_stop _2424) _2429) _2430) in (case _2432 of {(0,f) -> u f (\_2433 _2434 _2435-> (u (u (u parser_reply_error _2433) _2434) _2435)); (1,f) -> u f (\_2436 _2437 _2438-> (u (u (u parser_reply_value _2436) _2437) (u (u fm_term_ori _2438) (u fm_term_hol bits_e)))); }))); }))); }))))
fm_parser_u8 = (\_idx_1-> (\_code_2-> (let _2439 = (u (u fm_parser_init _idx_1) _code_2) in (case _2439 of {(0,f) -> u f (\_2440 _2441 _2442-> (u (u (u parser_reply_error _2440) _2441) _2442)); (1,f) -> u f (\_2443 _2444 _2445-> (let _2446 = (u (u fm_parser_spaces _2443) _2444) in (case _2446 of {(0,f) -> u f (\_2447 _2448 _2449-> (u (u (u parser_reply_error _2447) _2448) _2449)); (1,f) -> u f (\_2450 _2451 _2452-> (let _2453 = (u (u parser_nat _2450) _2451) in (case _2453 of {(0,f) -> u f (\_2454 _2455 _2456-> (u (u (u parser_reply_error _2454) _2455) _2456)); (1,f) -> u f (\_2457 _2458 _2459-> (let _2460 = (u (u (u parser_text "b") _2457) _2458) in (case _2460 of {(0,f) -> u f (\_2461 _2462 _2463-> (u (u (u parser_reply_error _2461) _2462) _2463)); (1,f) -> u f (\_2464 _2465 _2466-> (let _term_15=(u fm_term_ref "Nat.to_u8") in (let _term_16=(u (u fm_term_app _term_15) (u fm_term_nat _2459)) in (let _2467 = (u (u (u fm_parser_stop _2445) _2464) _2465) in (case _2467 of {(0,f) -> u f (\_2468 _2469 _2470-> (u (u (u parser_reply_error _2468) _2469) _2470)); (1,f) -> u f (\_2471 _2472 _2473-> (u (u (u parser_reply_value _2471) _2472) (u (u fm_term_ori _2473) _term_16))); }))))); }))); }))); }))); }))))
fm_parser_u16 = (\_idx_1-> (\_code_2-> (let _2474 = (u (u fm_parser_init _idx_1) _code_2) in (case _2474 of {(0,f) -> u f (\_2475 _2476 _2477-> (u (u (u parser_reply_error _2475) _2476) _2477)); (1,f) -> u f (\_2478 _2479 _2480-> (let _2481 = (u (u fm_parser_spaces _2478) _2479) in (case _2481 of {(0,f) -> u f (\_2482 _2483 _2484-> (u (u (u parser_reply_error _2482) _2483) _2484)); (1,f) -> u f (\_2485 _2486 _2487-> (let _2488 = (u (u parser_nat _2485) _2486) in (case _2488 of {(0,f) -> u f (\_2489 _2490 _2491-> (u (u (u parser_reply_error _2489) _2490) _2491)); (1,f) -> u f (\_2492 _2493 _2494-> (let _2495 = (u (u (u parser_text "s") _2492) _2493) in (case _2495 of {(0,f) -> u f (\_2496 _2497 _2498-> (u (u (u parser_reply_error _2496) _2497) _2498)); (1,f) -> u f (\_2499 _2500 _2501-> (let _term_15=(u fm_term_ref "Nat.to_u16") in (let _term_16=(u (u fm_term_app _term_15) (u fm_term_nat _2494)) in (let _2502 = (u (u (u fm_parser_stop _2480) _2499) _2500) in (case _2502 of {(0,f) -> u f (\_2503 _2504 _2505-> (u (u (u parser_reply_error _2503) _2504) _2505)); (1,f) -> u f (\_2506 _2507 _2508-> (u (u (u parser_reply_value _2506) _2507) (u (u fm_term_ori _2508) _term_16))); }))))); }))); }))); }))); }))))
fm_parser_u32 = (\_idx_1-> (\_code_2-> (let _2509 = (u (u fm_parser_init _idx_1) _code_2) in (case _2509 of {(0,f) -> u f (\_2510 _2511 _2512-> (u (u (u parser_reply_error _2510) _2511) _2512)); (1,f) -> u f (\_2513 _2514 _2515-> (let _2516 = (u (u fm_parser_spaces _2513) _2514) in (case _2516 of {(0,f) -> u f (\_2517 _2518 _2519-> (u (u (u parser_reply_error _2517) _2518) _2519)); (1,f) -> u f (\_2520 _2521 _2522-> (let _2523 = (u (u parser_nat _2520) _2521) in (case _2523 of {(0,f) -> u f (\_2524 _2525 _2526-> (u (u (u parser_reply_error _2524) _2525) _2526)); (1,f) -> u f (\_2527 _2528 _2529-> (let _2530 = (u (u (u parser_text "u") _2527) _2528) in (case _2530 of {(0,f) -> u f (\_2531 _2532 _2533-> (u (u (u parser_reply_error _2531) _2532) _2533)); (1,f) -> u f (\_2534 _2535 _2536-> (let _term_15=(u fm_term_ref "Nat.to_u32") in (let _term_16=(u (u fm_term_app _term_15) (u fm_term_nat _2529)) in (let _2537 = (u (u (u fm_parser_stop _2515) _2534) _2535) in (case _2537 of {(0,f) -> u f (\_2538 _2539 _2540-> (u (u (u parser_reply_error _2538) _2539) _2540)); (1,f) -> u f (\_2541 _2542 _2543-> (u (u (u parser_reply_value _2541) _2542) (u (u fm_term_ori _2543) _term_16))); }))))); }))); }))); }))); }))))
fm_parser_u64 = (\_idx_1-> (\_code_2-> (let _2544 = (u (u fm_parser_init _idx_1) _code_2) in (case _2544 of {(0,f) -> u f (\_2545 _2546 _2547-> (u (u (u parser_reply_error _2545) _2546) _2547)); (1,f) -> u f (\_2548 _2549 _2550-> (let _2551 = (u (u fm_parser_spaces _2548) _2549) in (case _2551 of {(0,f) -> u f (\_2552 _2553 _2554-> (u (u (u parser_reply_error _2552) _2553) _2554)); (1,f) -> u f (\_2555 _2556 _2557-> (let _2558 = (u (u parser_nat _2555) _2556) in (case _2558 of {(0,f) -> u f (\_2559 _2560 _2561-> (u (u (u parser_reply_error _2559) _2560) _2561)); (1,f) -> u f (\_2562 _2563 _2564-> (let _2565 = (u (u (u parser_text "l") _2562) _2563) in (case _2565 of {(0,f) -> u f (\_2566 _2567 _2568-> (u (u (u parser_reply_error _2566) _2567) _2568)); (1,f) -> u f (\_2569 _2570 _2571-> (let _term_15=(u fm_term_ref "Nat.to_u64") in (let _term_16=(u (u fm_term_app _term_15) (u fm_term_nat _2564)) in (let _2572 = (u (u (u fm_parser_stop _2550) _2569) _2570) in (case _2572 of {(0,f) -> u f (\_2573 _2574 _2575-> (u (u (u parser_reply_error _2573) _2574) _2575)); (1,f) -> u f (\_2576 _2577 _2578-> (u (u (u parser_reply_value _2576) _2577) (u (u fm_term_ori _2578) _term_16))); }))))); }))); }))); }))); }))))
fm_parser_nat = (\_idx_1-> (\_code_2-> (let _2579 = (u (u fm_parser_init _idx_1) _code_2) in (case _2579 of {(0,f) -> u f (\_2580 _2581 _2582-> (u (u (u parser_reply_error _2580) _2581) _2582)); (1,f) -> u f (\_2583 _2584 _2585-> (let _2586 = (u (u fm_parser_spaces _2583) _2584) in (case _2586 of {(0,f) -> u f (\_2587 _2588 _2589-> (u (u (u parser_reply_error _2587) _2588) _2589)); (1,f) -> u f (\_2590 _2591 _2592-> (let _2593 = (u (u parser_nat _2590) _2591) in (case _2593 of {(0,f) -> u f (\_2594 _2595 _2596-> (u (u (u parser_reply_error _2594) _2595) _2596)); (1,f) -> u f (\_2597 _2598 _2599-> (let _2600 = (u (u (u fm_parser_stop _2585) _2597) _2598) in (case _2600 of {(0,f) -> u f (\_2601 _2602 _2603-> (u (u (u parser_reply_error _2601) _2602) _2603)); (1,f) -> u f (\_2604 _2605 _2606-> (u (u (u parser_reply_value _2604) _2605) (u (u fm_term_ori _2606) (u fm_term_nat _2599)))); }))); }))); }))); }))))
string_eql = (\a0-> \a1-> ((a0::String) == a1))
parser_fail = (\_error_2-> (\_idx_3-> (\_code_4-> (u (u (u parser_reply_error _idx_3) _code_4) _error_2))))
fm_parser_reference = (\_idx_1-> (\_code_2-> (let _2607 = (u (u fm_parser_init _idx_1) _code_2) in (case _2607 of {(0,f) -> u f (\_2608 _2609 _2610-> (u (u (u parser_reply_error _2608) _2609) _2610)); (1,f) -> u f (\_2611 _2612 _2613-> (let _2614 = (u (u fm_parser_name1 _2611) _2612) in (case _2614 of {(0,f) -> u f (\_2615 _2616 _2617-> (u (u (u parser_reply_error _2615) _2616) _2617)); (1,f) -> u f (\_2618 _2619 _2620-> (let _2621 = (((_2620::String) == "case")) in (if _2621 then (u parser_fail "Reserved keyword.") else (let _2622 = (((_2620::String) == "do")) in (if _2622 then (u parser_fail "Reserved keyword.") else (let _2623 = (((_2620::String) == "if")) in (if _2623 then (u parser_fail "Reserved keyword.") else (let _2624 = (((_2620::String) == "let")) in (if _2624 then (u parser_fail "Reserved keyword.") else (let _2625 = (((_2620::String) == "def")) in (if _2625 then (u parser_fail "Reserved keyword.") else (let _2626 = (((_2620::String) == "true")) in (if _2626 then (\_idx_9-> (\_code_10-> (u (u (u parser_reply_value _idx_9) _code_10) (u fm_term_ref "Bool.true")))) else (let _2627 = (((_2620::String) == "false")) in (if _2627 then (\_idx_9-> (\_code_10-> (u (u (u parser_reply_value _idx_9) _code_10) (u fm_term_ref "Bool.false")))) else (let _2628 = (((_2620::String) == "unit")) in (if _2628 then (\_idx_9-> (\_code_10-> (u (u (u parser_reply_value _idx_9) _code_10) (u fm_term_ref "Unit.new")))) else (let _2629 = (((_2620::String) == "none")) in (if _2629 then (let _term_9=(u fm_term_ref "Maybe.none") in (let _term_10=(u (u fm_term_app _term_9) (u fm_term_hol bits_e)) in (\_idx_11-> (\_code_12-> (u (u (u parser_reply_value _idx_11) _code_12) _term_10))))) else (let _2630 = (((_2620::String) == "refl")) in (if _2630 then (let _term_9=(u fm_term_ref "Equal.refl") in (let _term_10=(u (u fm_term_app _term_9) (u fm_term_hol bits_e)) in (let _term_11=(u (u fm_term_app _term_10) (u fm_term_hol bits_e)) in (\_idx_12-> (\_code_13-> (u (u (u parser_reply_value _idx_12) _code_13) _term_11)))))) else (\_idx_9-> (\_code_10-> (let _2631 = (u (u (u fm_parser_stop _2613) _idx_9) _code_10) in (case _2631 of {(0,f) -> u f (\_2632 _2633 _2634-> (u (u (u parser_reply_error _2632) _2633) _2634)); (1,f) -> u f (\_2635 _2636 _2637-> (u (u (u parser_reply_value _2635) _2636) (u (u fm_term_ori _2637) (u fm_term_ref _2620)))); })))))))))))))))))))))))) _2618 _2619); }))); }))))
list_for = (\_xs_2-> (\_b_4-> (\_f_5-> (let _2638 = _xs_2 in (case _2638 of {(0,f) -> u f (_b_4); (1,f) -> u f (\_2639 _2640-> (u (u (u list_for _2640) (u (u _f_5 _2639) _b_4)) _f_5)); })))))
fm_parser_application = (\_init_1-> (\_func_2-> (\_idx_3-> (\_code_4-> (let _2641 = (u (u (u parser_text "(") _idx_3) _code_4) in (case _2641 of {(0,f) -> u f (\_2642 _2643 _2644-> (u (u (u parser_reply_error _2642) _2643) _2644)); (1,f) -> u f (\_2645 _2646 _2647-> (let _2648 = (u (u (u (u parser_until1 (u fm_parser_text ")")) (u fm_parser_item fm_parser_term)) _2645) _2646) in (case _2648 of {(0,f) -> u f (\_2649 _2650 _2651-> (u (u (u parser_reply_error _2649) _2650) _2651)); (1,f) -> u f (\_2652 _2653 _2654-> (let _2655 = (u (u (u fm_parser_stop _init_1) _2652) _2653) in (case _2655 of {(0,f) -> u f (\_2656 _2657 _2658-> (u (u (u parser_reply_error _2656) _2657) _2658)); (1,f) -> u f (\_2659 _2660 _2661-> (let _expr_14=(u (u (u list_for _2654) _func_2) (\_x_14-> (\_f_15-> (u (u fm_term_app _f_15) _x_14)))) in (u (u (u parser_reply_value _2659) _2660) (u (u fm_term_ori _2661) _expr_14)))); }))); }))); }))))))
parser_spaces = (u parser_many (u parser_first_of (u (u list_cons (u parser_text " ")) (u (u list_cons (u parser_text "\n")) list_nil))))
parser_spaces_text = (\_text_1-> (\_idx_2-> (\_code_3-> (let _2662 = (u (u parser_spaces _idx_2) _code_3) in (case _2662 of {(0,f) -> u f (\_2663 _2664 _2665-> (u (u (u parser_reply_error _2663) _2664) _2665)); (1,f) -> u f (\_2666 _2667 _2668-> (u (u (u parser_text _text_1) _2666) _2667)); })))))
fm_parser_application_erased = (\_init_1-> (\_func_2-> (\_idx_3-> (\_code_4-> (let _2669 = (u (u parser_get_index _idx_3) _code_4) in (case _2669 of {(0,f) -> u f (\_2670 _2671 _2672-> (u (u (u parser_reply_error _2670) _2671) _2672)); (1,f) -> u f (\_2673 _2674 _2675-> (let _2676 = (u (u (u parser_text "<") _2673) _2674) in (case _2676 of {(0,f) -> u f (\_2677 _2678 _2679-> (u (u (u parser_reply_error _2677) _2678) _2679)); (1,f) -> u f (\_2680 _2681 _2682-> (let _2683 = (u (u (u (u parser_until1 (u parser_spaces_text ">")) (u fm_parser_item fm_parser_term)) _2680) _2681) in (case _2683 of {(0,f) -> u f (\_2684 _2685 _2686-> (u (u (u parser_reply_error _2684) _2685) _2686)); (1,f) -> u f (\_2687 _2688 _2689-> (let _2690 = (u (u (u fm_parser_stop _2675) _2687) _2688) in (case _2690 of {(0,f) -> u f (\_2691 _2692 _2693-> (u (u (u parser_reply_error _2691) _2692) _2693)); (1,f) -> u f (\_2694 _2695 _2696-> (let _expr_17=(u (u (u list_for _2689) _func_2) (\_x_17-> (\_f_18-> (u (u fm_term_app _f_18) _x_17)))) in (u (u (u parser_reply_value _2694) _2695) (u (u fm_term_ori _2696) _expr_17)))); }))); }))); }))); }))))))
fm_parser_arrow = (\_init_1-> (\_xtyp_2-> (\_idx_3-> (\_code_4-> (let _2697 = (u (u (u fm_parser_text "->") _idx_3) _code_4) in (case _2697 of {(0,f) -> u f (\_2698 _2699 _2700-> (u (u (u parser_reply_error _2698) _2699) _2700)); (1,f) -> u f (\_2701 _2702 _2703-> (let _2704 = (u (u fm_parser_term _2701) _2702) in (case _2704 of {(0,f) -> u f (\_2705 _2706 _2707-> (u (u (u parser_reply_error _2705) _2706) _2707)); (1,f) -> u f (\_2708 _2709 _2710-> (let _2711 = (u (u (u fm_parser_stop _init_1) _2708) _2709) in (case _2711 of {(0,f) -> u f (\_2712 _2713 _2714-> (u (u (u parser_reply_error _2712) _2713) _2714)); (1,f) -> u f (\_2715 _2716 _2717-> (u (u (u parser_reply_value _2715) _2716) (u (u fm_term_ori _2717) (u (u (u (u (u fm_term_all bool_false) "") "") _xtyp_2) (\_s_14-> (\_x_15-> _2710)))))); }))); }))); }))))))
fm_parser_op = (\_sym_1-> (\_ref_2-> (\_init_3-> (\_val0_4-> (\_idx_5-> (\_code_6-> (let _2718 = (u (u (u fm_parser_text _sym_1) _idx_5) _code_6) in (case _2718 of {(0,f) -> u f (\_2719 _2720 _2721-> (u (u (u parser_reply_error _2719) _2720) _2721)); (1,f) -> u f (\_2722 _2723 _2724-> (let _2725 = (u (u fm_parser_term _2722) _2723) in (case _2725 of {(0,f) -> u f (\_2726 _2727 _2728-> (u (u (u parser_reply_error _2726) _2727) _2728)); (1,f) -> u f (\_2729 _2730 _2731-> (let _2732 = (u (u (u fm_parser_stop _init_3) _2729) _2730) in (case _2732 of {(0,f) -> u f (\_2733 _2734 _2735-> (u (u (u parser_reply_error _2733) _2734) _2735)); (1,f) -> u f (\_2736 _2737 _2738-> (let _term_16=(u fm_term_ref _ref_2) in (let _term_17=(u (u fm_term_app _term_16) _val0_4) in (let _term_18=(u (u fm_term_app _term_17) _2731) in (u (u (u parser_reply_value _2736) _2737) (u (u fm_term_ori _2738) _term_18)))))); }))); }))); }))))))))
fm_parser_add = (u (u fm_parser_op "+") "Nat.add")
fm_parser_sub = (u (u fm_parser_op "+") "Nat.add")
fm_parser_mul = (u (u fm_parser_op "*") "Nat.mul")
fm_parser_div = (u (u fm_parser_op "/") "Nat.div")
fm_parser_mod = (u (u fm_parser_op "%") "Nat.mod")
fm_parser_default = (\_init_1-> (\_mayb_2-> (\_idx_3-> (\_code_4-> (let _2739 = (u (u (u fm_parser_text "?") _idx_3) _code_4) in (case _2739 of {(0,f) -> u f (\_2740 _2741 _2742-> (u (u (u parser_reply_error _2740) _2741) _2742)); (1,f) -> u f (\_2743 _2744 _2745-> (let _2746 = (u (u fm_parser_term _2743) _2744) in (case _2746 of {(0,f) -> u f (\_2747 _2748 _2749-> (u (u (u parser_reply_error _2747) _2748) _2749)); (1,f) -> u f (\_2750 _2751 _2752-> (let _2753 = (u (u (u fm_parser_stop _init_1) _2750) _2751) in (case _2753 of {(0,f) -> u f (\_2754 _2755 _2756-> (u (u (u parser_reply_error _2754) _2755) _2756)); (1,f) -> u f (\_2757 _2758 _2759-> (let _term_14=(u fm_term_ref "Maybe.default") in (let _term_15=(u (u fm_term_app _term_14) (u fm_term_hol bits_e)) in (let _term_16=(u (u fm_term_app _term_15) _2752) in (let _term_17=(u (u fm_term_app _term_16) _mayb_2) in (u (u (u parser_reply_value _2757) _2758) (u (u fm_term_ori _2759) _term_17))))))); }))); }))); }))))))
fm_parser_cons = (\_init_1-> (\_head_2-> (\_idx_3-> (\_code_4-> (let _2760 = (u (u (u fm_parser_text "&") _idx_3) _code_4) in (case _2760 of {(0,f) -> u f (\_2761 _2762 _2763-> (u (u (u parser_reply_error _2761) _2762) _2763)); (1,f) -> u f (\_2764 _2765 _2766-> (let _2767 = (u (u fm_parser_term _2764) _2765) in (case _2767 of {(0,f) -> u f (\_2768 _2769 _2770-> (u (u (u parser_reply_error _2768) _2769) _2770)); (1,f) -> u f (\_2771 _2772 _2773-> (let _2774 = (u (u (u fm_parser_stop _init_1) _2771) _2772) in (case _2774 of {(0,f) -> u f (\_2775 _2776 _2777-> (u (u (u parser_reply_error _2775) _2776) _2777)); (1,f) -> u f (\_2778 _2779 _2780-> (let _term_14=(u fm_term_ref "List.cons") in (let _term_15=(u (u fm_term_app _term_14) (u fm_term_hol bits_e)) in (let _term_16=(u (u fm_term_app _term_15) _head_2) in (let _term_17=(u (u fm_term_app _term_16) _2773) in (let _2781 = (u (u (u fm_parser_stop _init_1) _2778) _2779) in (case _2781 of {(0,f) -> u f (\_2782 _2783 _2784-> (u (u (u parser_reply_error _2782) _2783) _2784)); (1,f) -> u f (\_2785 _2786 _2787-> (u (u (u parser_reply_value _2785) _2786) (u (u fm_term_ori _2787) _term_17))); }))))))); }))); }))); }))))))
fm_parser_concat = (\_init_1-> (\_lst0_2-> (\_idx_3-> (\_code_4-> (let _2788 = (u (u (u fm_parser_text "++") _idx_3) _code_4) in (case _2788 of {(0,f) -> u f (\_2789 _2790 _2791-> (u (u (u parser_reply_error _2789) _2790) _2791)); (1,f) -> u f (\_2792 _2793 _2794-> (let _2795 = (u (u fm_parser_term _2792) _2793) in (case _2795 of {(0,f) -> u f (\_2796 _2797 _2798-> (u (u (u parser_reply_error _2796) _2797) _2798)); (1,f) -> u f (\_2799 _2800 _2801-> (let _2802 = (u (u (u fm_parser_stop _init_1) _2799) _2800) in (case _2802 of {(0,f) -> u f (\_2803 _2804 _2805-> (u (u (u parser_reply_error _2803) _2804) _2805)); (1,f) -> u f (\_2806 _2807 _2808-> (let _term_14=(u fm_term_ref "List.concat") in (let _term_15=(u (u fm_term_app _term_14) (u fm_term_hol bits_e)) in (let _term_16=(u (u fm_term_app _term_15) _lst0_2) in (let _term_17=(u (u fm_term_app _term_16) _2801) in (let _2809 = (u (u (u fm_parser_stop _init_1) _2806) _2807) in (case _2809 of {(0,f) -> u f (\_2810 _2811 _2812-> (u (u (u parser_reply_error _2810) _2811) _2812)); (1,f) -> u f (\_2813 _2814 _2815-> (u (u (u parser_reply_value _2813) _2814) (u (u fm_term_ori _2815) _term_17))); }))))))); }))); }))); }))))))
fm_parser_string_concat = (\_init_1-> (\_str0_2-> (\_idx_3-> (\_code_4-> (let _2816 = (u (u (u fm_parser_text "|") _idx_3) _code_4) in (case _2816 of {(0,f) -> u f (\_2817 _2818 _2819-> (u (u (u parser_reply_error _2817) _2818) _2819)); (1,f) -> u f (\_2820 _2821 _2822-> (let _2823 = (u (u fm_parser_term _2820) _2821) in (case _2823 of {(0,f) -> u f (\_2824 _2825 _2826-> (u (u (u parser_reply_error _2824) _2825) _2826)); (1,f) -> u f (\_2827 _2828 _2829-> (let _2830 = (u (u (u fm_parser_stop _init_1) _2827) _2828) in (case _2830 of {(0,f) -> u f (\_2831 _2832 _2833-> (u (u (u parser_reply_error _2831) _2832) _2833)); (1,f) -> u f (\_2834 _2835 _2836-> (let _term_14=(u fm_term_ref "String.concat") in (let _term_15=(u (u fm_term_app _term_14) _str0_2) in (let _term_16=(u (u fm_term_app _term_15) _2829) in (let _2837 = (u (u (u fm_parser_stop _init_1) _2834) _2835) in (case _2837 of {(0,f) -> u f (\_2838 _2839 _2840-> (u (u (u parser_reply_error _2838) _2839) _2840)); (1,f) -> u f (\_2841 _2842 _2843-> (u (u (u parser_reply_value _2841) _2842) (u (u fm_term_ori _2843) _term_16))); })))))); }))); }))); }))))))
fm_parser_sigma = (\_init_1-> (\_val0_2-> (\_idx_3-> (\_code_4-> (let _2844 = (u (u (u fm_parser_text "~") _idx_3) _code_4) in (case _2844 of {(0,f) -> u f (\_2845 _2846 _2847-> (u (u (u parser_reply_error _2845) _2846) _2847)); (1,f) -> u f (\_2848 _2849 _2850-> (let _2851 = (u (u fm_parser_term _2848) _2849) in (case _2851 of {(0,f) -> u f (\_2852 _2853 _2854-> (u (u (u parser_reply_error _2852) _2853) _2854)); (1,f) -> u f (\_2855 _2856 _2857-> (let _2858 = (u (u (u fm_parser_stop _init_1) _2855) _2856) in (case _2858 of {(0,f) -> u f (\_2859 _2860 _2861-> (u (u (u parser_reply_error _2859) _2860) _2861)); (1,f) -> u f (\_2862 _2863 _2864-> (let _term_14=(u fm_term_ref "Sigma.new") in (let _term_15=(u (u fm_term_app _term_14) (u fm_term_hol bits_e)) in (let _term_16=(u (u fm_term_app _term_15) (u fm_term_hol bits_e)) in (let _term_17=(u (u fm_term_app _term_16) _val0_2) in (let _term_18=(u (u fm_term_app _term_17) _2857) in (u (u (u parser_reply_value _2862) _2863) (u (u fm_term_ori _2864) _term_18)))))))); }))); }))); }))))))
fm_parser_equality = (\_init_1-> (\_val0_2-> (\_idx_3-> (\_code_4-> (let _2865 = (u (u (u fm_parser_text "==") _idx_3) _code_4) in (case _2865 of {(0,f) -> u f (\_2866 _2867 _2868-> (u (u (u parser_reply_error _2866) _2867) _2868)); (1,f) -> u f (\_2869 _2870 _2871-> (let _2872 = (u (u fm_parser_term _2869) _2870) in (case _2872 of {(0,f) -> u f (\_2873 _2874 _2875-> (u (u (u parser_reply_error _2873) _2874) _2875)); (1,f) -> u f (\_2876 _2877 _2878-> (let _2879 = (u (u (u fm_parser_stop _init_1) _2876) _2877) in (case _2879 of {(0,f) -> u f (\_2880 _2881 _2882-> (u (u (u parser_reply_error _2880) _2881) _2882)); (1,f) -> u f (\_2883 _2884 _2885-> (let _term_14=(u fm_term_ref "Equal") in (let _term_15=(u (u fm_term_app _term_14) (u fm_term_hol bits_e)) in (let _term_16=(u (u fm_term_app _term_15) _val0_2) in (let _term_17=(u (u fm_term_app _term_16) _2878) in (u (u (u parser_reply_value _2883) _2884) (u (u fm_term_ori _2885) _term_17))))))); }))); }))); }))))))
fm_parser_inequality = (\_init_1-> (\_val0_2-> (\_idx_3-> (\_code_4-> (let _2886 = (u (u (u fm_parser_text "!=") _idx_3) _code_4) in (case _2886 of {(0,f) -> u f (\_2887 _2888 _2889-> (u (u (u parser_reply_error _2887) _2888) _2889)); (1,f) -> u f (\_2890 _2891 _2892-> (let _2893 = (u (u fm_parser_term _2890) _2891) in (case _2893 of {(0,f) -> u f (\_2894 _2895 _2896-> (u (u (u parser_reply_error _2894) _2895) _2896)); (1,f) -> u f (\_2897 _2898 _2899-> (let _2900 = (u (u (u fm_parser_stop _init_1) _2897) _2898) in (case _2900 of {(0,f) -> u f (\_2901 _2902 _2903-> (u (u (u parser_reply_error _2901) _2902) _2903)); (1,f) -> u f (\_2904 _2905 _2906-> (let _term_14=(u fm_term_ref "Equal") in (let _term_15=(u (u fm_term_app _term_14) (u fm_term_hol bits_e)) in (let _term_16=(u (u fm_term_app _term_15) _val0_2) in (let _term_17=(u (u fm_term_app _term_16) _2899) in (let _term_18=(u (u fm_term_app (u fm_term_ref "Not")) _term_17) in (u (u (u parser_reply_value _2904) _2905) (u (u fm_term_ori _2906) _term_18)))))))); }))); }))); }))))))
fm_parser_rewrite = (\_init_1-> (\_subt_2-> (\_idx_3-> (\_code_4-> (let _2907 = (u (u (u fm_parser_text "::") _idx_3) _code_4) in (case _2907 of {(0,f) -> u f (\_2908 _2909 _2910-> (u (u (u parser_reply_error _2908) _2909) _2910)); (1,f) -> u f (\_2911 _2912 _2913-> (let _2914 = (u (u (u fm_parser_text "rewrite") _2911) _2912) in (case _2914 of {(0,f) -> u f (\_2915 _2916 _2917-> (u (u (u parser_reply_error _2915) _2916) _2917)); (1,f) -> u f (\_2918 _2919 _2920-> (let _2921 = (u (u fm_parser_name1 _2918) _2919) in (case _2921 of {(0,f) -> u f (\_2922 _2923 _2924-> (u (u (u parser_reply_error _2922) _2923) _2924)); (1,f) -> u f (\_2925 _2926 _2927-> (let _2928 = (u (u (u fm_parser_text "in") _2925) _2926) in (case _2928 of {(0,f) -> u f (\_2929 _2930 _2931-> (u (u (u parser_reply_error _2929) _2930) _2931)); (1,f) -> u f (\_2932 _2933 _2934-> (let _2935 = (u (u fm_parser_term _2932) _2933) in (case _2935 of {(0,f) -> u f (\_2936 _2937 _2938-> (u (u (u parser_reply_error _2936) _2937) _2938)); (1,f) -> u f (\_2939 _2940 _2941-> (let _2942 = (u (u (u fm_parser_text "with") _2939) _2940) in (case _2942 of {(0,f) -> u f (\_2943 _2944 _2945-> (u (u (u parser_reply_error _2943) _2944) _2945)); (1,f) -> u f (\_2946 _2947 _2948-> (let _2949 = (u (u fm_parser_term _2946) _2947) in (case _2949 of {(0,f) -> u f (\_2950 _2951 _2952-> (u (u (u parser_reply_error _2950) _2951) _2952)); (1,f) -> u f (\_2953 _2954 _2955-> (let _2956 = (u (u (u fm_parser_stop _init_1) _2953) _2954) in (case _2956 of {(0,f) -> u f (\_2957 _2958 _2959-> (u (u (u parser_reply_error _2957) _2958) _2959)); (1,f) -> u f (\_2960 _2961 _2962-> (let _term_29=(u fm_term_ref "Equal.rewrite") in (let _term_30=(u (u fm_term_app _term_29) (u fm_term_hol bits_e)) in (let _term_31=(u (u fm_term_app _term_30) (u fm_term_hol bits_e)) in (let _term_32=(u (u fm_term_app _term_31) (u fm_term_hol bits_e)) in (let _term_33=(u (u fm_term_app _term_32) (u (u fm_term_lam _2927) (\_x_33-> _2941))) in (let _term_34=(u (u fm_term_app _term_33) _2955) in (let _term_35=(u (u fm_term_app _term_34) _subt_2) in (u (u (u parser_reply_value _2960) _2961) (u (u fm_term_ori _2962) _term_35)))))))))); }))); }))); }))); }))); }))); }))); }))); }))))))
fm_term_ann = (\_done_1-> (\_term_2-> (\_type_3-> (8,\t-> t _done_1 _term_2 _type_3))))
fm_parser_annotation = (\_init_1-> (\_term_2-> (\_idx_3-> (\_code_4-> (let _2963 = (u (u (u fm_parser_text "::") _idx_3) _code_4) in (case _2963 of {(0,f) -> u f (\_2964 _2965 _2966-> (u (u (u parser_reply_error _2964) _2965) _2966)); (1,f) -> u f (\_2967 _2968 _2969-> (let _2970 = (u (u fm_parser_term _2967) _2968) in (case _2970 of {(0,f) -> u f (\_2971 _2972 _2973-> (u (u (u parser_reply_error _2971) _2972) _2973)); (1,f) -> u f (\_2974 _2975 _2976-> (let _2977 = (u (u (u fm_parser_stop _init_1) _2974) _2975) in (case _2977 of {(0,f) -> u f (\_2978 _2979 _2980-> (u (u (u parser_reply_error _2978) _2979) _2980)); (1,f) -> u f (\_2981 _2982 _2983-> (u (u (u parser_reply_value _2981) _2982) (u (u fm_term_ori _2983) (u (u (u fm_term_ann bool_false) _term_2) _2976)))); }))); }))); }))))))
fm_parser_application_hole = (\_init_1-> (\_term_2-> (\_idx_3-> (\_code_4-> (let _2984 = (u (u (u fm_parser_text "!") _idx_3) _code_4) in (case _2984 of {(0,f) -> u f (\_2985 _2986 _2987-> (u (u (u parser_reply_error _2985) _2986) _2987)); (1,f) -> u f (\_2988 _2989 _2990-> (let _2991 = (u (u (u fm_parser_stop _init_1) _2988) _2989) in (case _2991 of {(0,f) -> u f (\_2992 _2993 _2994-> (u (u (u parser_reply_error _2992) _2993) _2994)); (1,f) -> u f (\_2995 _2996 _2997-> (u (u (u parser_reply_value _2995) _2996) (u (u fm_term_ori _2997) (u (u fm_term_app _term_2) (u fm_term_hol bits_e))))); }))); }))))))
fm_parser_suffix = (\_init_1-> (\_term_2-> (\_idx_3-> (\_code_4-> (let _suffix_parser_5=(u parser_first_of (u (u list_cons (u (u fm_parser_application _init_1) _term_2)) (u (u list_cons (u (u fm_parser_application_erased _init_1) _term_2)) (u (u list_cons (u (u fm_parser_arrow _init_1) _term_2)) (u (u list_cons (u (u fm_parser_add _init_1) _term_2)) (u (u list_cons (u (u fm_parser_sub _init_1) _term_2)) (u (u list_cons (u (u fm_parser_mul _init_1) _term_2)) (u (u list_cons (u (u fm_parser_div _init_1) _term_2)) (u (u list_cons (u (u fm_parser_mod _init_1) _term_2)) (u (u list_cons (u (u fm_parser_default _init_1) _term_2)) (u (u list_cons (u (u fm_parser_cons _init_1) _term_2)) (u (u list_cons (u (u fm_parser_concat _init_1) _term_2)) (u (u list_cons (u (u fm_parser_string_concat _init_1) _term_2)) (u (u list_cons (u (u fm_parser_sigma _init_1) _term_2)) (u (u list_cons (u (u fm_parser_equality _init_1) _term_2)) (u (u list_cons (u (u fm_parser_inequality _init_1) _term_2)) (u (u list_cons (u (u fm_parser_rewrite _init_1) _term_2)) (u (u list_cons (u (u fm_parser_annotation _init_1) _term_2)) (u (u list_cons (u (u fm_parser_application_hole _init_1) _term_2)) list_nil))))))))))))))))))) in (let _2998 = (u (u _suffix_parser_5 _idx_3) _code_4) in (case _2998 of {(0,f) -> u f (\_2999 _3000 _3001-> (u (u (u parser_reply_value _idx_3) _code_4) _term_2)); (1,f) -> u f (\_3002 _3003 _3004-> (u (u (u (u fm_parser_suffix _init_1) _3004) _3002) _3003)); })))))))
fm_parser_term = (\_idx_1-> (\_code_2-> (let _3005 = (u (u parser_get_code _idx_1) _code_2) in (case _3005 of {(0,f) -> u f (\_3006 _3007 _3008-> (u (u (u parser_reply_error _3006) _3007) _3008)); (1,f) -> u f (\_3009 _3010 _3011-> (let _3012 = (u (u fm_parser_init _3009) _3010) in (case _3012 of {(0,f) -> u f (\_3013 _3014 _3015-> (u (u (u parser_reply_error _3013) _3014) _3015)); (1,f) -> u f (\_3016 _3017 _3018-> (let _3019 = (u (u (u parser_first_of (u (u list_cons fm_parser_type) (u (u list_cons fm_parser_forall) (u (u list_cons fm_parser_lambda) (u (u list_cons fm_parser_lambda_erased) (u (u list_cons fm_parser_lambda_nameless) (u (u list_cons fm_parser_parenthesis) (u (u list_cons fm_parser_letforrange_u32) (u (u list_cons fm_parser_letforin) (u (u list_cons fm_parser_let) (u (u list_cons fm_parser_get) (u (u list_cons fm_parser_def) (u (u list_cons fm_parser_if) (u (u list_cons fm_parser_char) (u (u list_cons fm_parser_string) (u (u list_cons fm_parser_pair) (u (u list_cons fm_parser_sigma_type) (u (u list_cons fm_parser_some) (u (u list_cons fm_parser_apply) (u (u list_cons fm_parser_list) (u (u list_cons fm_parser_log) (u (u list_cons fm_parser_forrange_u32) (u (u list_cons fm_parser_forrange_u32_2) (u (u list_cons fm_parser_forin) (u (u list_cons fm_parser_forin_2) (u (u list_cons fm_parser_do) (u (u list_cons fm_parser_case) (u (u list_cons fm_parser_open) (u (u list_cons fm_parser_goal) (u (u list_cons fm_parser_hole) (u (u list_cons fm_parser_u8) (u (u list_cons fm_parser_u16) (u (u list_cons fm_parser_u32) (u (u list_cons fm_parser_u64) (u (u list_cons fm_parser_nat) (u (u list_cons fm_parser_reference) list_nil)))))))))))))))))))))))))))))))))))) _3016) _3017) in (case _3019 of {(0,f) -> u f (\_3020 _3021 _3022-> (u (u (u parser_reply_error _3020) _3021) _3022)); (1,f) -> u f (\_3023 _3024 _3025-> (u (u (u (u fm_parser_suffix _3018) _3025) _3023) _3024)); }))); }))); }))))
fm_parser_name_term = (\_idx_1-> (\_code_2-> (let _3026 = (u (u fm_parser_name _idx_1) _code_2) in (case _3026 of {(0,f) -> u f (\_3027 _3028 _3029-> (u (u (u parser_reply_error _3027) _3028) _3029)); (1,f) -> u f (\_3030 _3031 _3032-> (let _3033 = (u (u (u fm_parser_text ":") _3030) _3031) in (case _3033 of {(0,f) -> u f (\_3034 _3035 _3036-> (u (u (u parser_reply_error _3034) _3035) _3036)); (1,f) -> u f (\_3037 _3038 _3039-> (let _3040 = (u (u fm_parser_term _3037) _3038) in (case _3040 of {(0,f) -> u f (\_3041 _3042 _3043-> (u (u (u parser_reply_error _3041) _3042) _3043)); (1,f) -> u f (\_3044 _3045 _3046-> (u (u (u parser_reply_value _3044) _3045) (u (u pair_new _3032) _3046))); }))); }))); }))))
fm_binder_new = (\_eras_1-> (\_name_2-> (\_term_3-> (0,\t-> t _eras_1 _name_2 _term_3))))
fm_parser_binder_homo = (\_eras_1-> (\_idx_2-> (\_code_3-> (let _3047 = (u (u (u fm_parser_text (let _3048 = _eras_1 in (if _3048 then "<" else "("))) _idx_2) _code_3) in (case _3047 of {(0,f) -> u f (\_3049 _3050 _3051-> (u (u (u parser_reply_error _3049) _3050) _3051)); (1,f) -> u f (\_3052 _3053 _3054-> (let _3055 = (u (u (u (u parser_until1 (u fm_parser_text (let _3056 = _eras_1 in (if _3056 then ">" else ")")))) (u fm_parser_item fm_parser_name_term)) _3052) _3053) in (case _3055 of {(0,f) -> u f (\_3057 _3058 _3059-> (u (u (u parser_reply_error _3057) _3058) _3059)); (1,f) -> u f (\_3060 _3061 _3062-> (u (u (u parser_reply_value _3060) _3061) (u (u list_mapped _3062) (\_pair_10-> (let _3063 = _pair_10 in (case _3063 of {(0,f) -> u f (\_3064 _3065-> (u (u (u fm_binder_new _eras_1) _3064) _3065)); })))))); }))); })))))
list_concat = (\_as_2-> (\_bs_3-> (let _3066 = _as_2 in (case _3066 of {(0,f) -> u f (_bs_3); (1,f) -> u f (\_3067 _3068-> (u (u list_cons _3067) (u (u list_concat _3068) _bs_3))); }))))
list_flatten = (\_xs_2-> (let _3069 = _xs_2 in (case _3069 of {(0,f) -> u f (list_nil); (1,f) -> u f (\_3070 _3071-> (u (u list_concat _3070) (u list_flatten _3071))); })))
fm_parser_binder = (\_idx_1-> (\_code_2-> (let _3072 = (u (u (u parser_many1 (u parser_first_of (u (u list_cons (u fm_parser_binder_homo bool_true)) (u (u list_cons (u fm_parser_binder_homo bool_false)) list_nil)))) _idx_1) _code_2) in (case _3072 of {(0,f) -> u f (\_3073 _3074 _3075-> (u (u (u parser_reply_error _3073) _3074) _3075)); (1,f) -> u f (\_3076 _3077 _3078-> (u (u (u parser_reply_value _3076) _3077) (u list_flatten _3078))); }))))
fm_parser_make_forall = (\_binds_1-> (\_body_2-> (let _3079 = _binds_1 in (case _3079 of {(0,f) -> u f (_body_2); (1,f) -> u f (\_3080 _3081-> (let _3082 = _3080 in (case _3082 of {(0,f) -> u f (\_3083 _3084 _3085-> (u (u (u (u (u fm_term_all _3083) "") _3084) _3085) (\_s_8-> (\_x_9-> (u (u fm_parser_make_forall _3081) _body_2))))); }))); }))))
list_at = (\_index_2-> (\_list_3-> (let _3086 = _list_3 in (case _3086 of {(0,f) -> u f (maybe_none); (1,f) -> u f (\_3087 _3088-> (let _3089 = _index_2 in (if _3089==0 then (u maybe_some _3087) else (u (u list_at (_3089-1)) _3088)))); }))))
list_at_last = (\_index_2-> (\_list_3-> (u (u list_at _index_2) (u list_reverse _list_3))))
fm_term_var = (\_name_1-> (\_indx_2-> (0,\t-> t _name_1 _indx_2)))
fm_name_eql = (\_a_1-> (\_b_2-> (((_a_1::String) == _b_2))))
fm_context_find = (\_name_1-> (\_ctx_2-> (let _3090 = _ctx_2 in (case _3090 of {(0,f) -> u f (maybe_none); (1,f) -> u f (\_3091 _3092-> (let _3093 = _3091 in (case _3093 of {(0,f) -> u f (\_3094 _3095-> (let _3096 = (u (u fm_name_eql _name_1) _3094) in (if _3096 then (u maybe_some _3095) else (u (u fm_context_find _name_1) _3092)))); }))); }))))
list_length = (\_xs_2-> (let _3097 = _xs_2 in (case _3097 of {(0,f) -> u f (0); (1,f) -> u f (\_3098 _3099-> (u nat_succ (u list_length _3099))); })))
fm_path_o = (\_path_1-> (\_x_2-> (u _path_1 (u bits_o _x_2))))
fm_path_i = (\_path_1-> (\_x_2-> (u _path_1 (u bits_i _x_2))))
fm_path_to_bits = (\_path_1-> (u _path_1 bits_e))
fm_term_bind = (\_vars_1-> (\_path_2-> (\_term_3-> (let _3100 = _term_3 in (case _3100 of {(0,f) -> u f (\_3101 _3102-> (let _3103 = (u (u list_at_last _3102) _vars_1) in (case _3103 of {(0,f) -> u f ((u (u fm_term_var _3101) _3102)); (1,f) -> u f (\_3104-> (u pair_snd _3104)); }))); (1,f) -> u f (\_3105-> (let _3106 = (u (u fm_context_find _3105) _vars_1) in (case _3106 of {(0,f) -> u f ((u fm_term_ref _3105)); (1,f) -> u f (\_3107-> _3107); }))); (2,f) -> u f (fm_term_typ); (3,f) -> u f (\_3108 _3109 _3110 _3111 _3112-> (let _vlen_9=(u list_length _vars_1) in (u (u (u (u (u fm_term_all _3108) _3109) _3110) (u (u (u fm_term_bind _vars_1) (u fm_path_o _path_2)) _3111)) (\_s_10-> (\_x_11-> (u (u (u fm_term_bind (u (u list_cons (u (u pair_new _3110) _x_11)) (u (u list_cons (u (u pair_new _3109) _s_10)) _vars_1))) (u fm_path_i _path_2)) (u (u _3112 (u (u fm_term_var _3109) _vlen_9)) (u (u fm_term_var _3110) (u nat_succ _vlen_9))))))))); (4,f) -> u f (\_3113 _3114-> (let _vlen_6=(u list_length _vars_1) in (u (u fm_term_lam _3113) (\_x_7-> (u (u (u fm_term_bind (u (u list_cons (u (u pair_new _3113) _x_7)) _vars_1)) (u fm_path_o _path_2)) (u _3114 (u (u fm_term_var _3113) _vlen_6))))))); (5,f) -> u f (\_3115 _3116-> (u (u fm_term_app (u (u (u fm_term_bind _vars_1) (u fm_path_o _path_2)) _3115)) (u (u (u fm_term_bind _vars_1) (u fm_path_i _path_2)) _3116))); (6,f) -> u f (\_3117 _3118 _3119-> (let _vlen_7=(u list_length _vars_1) in (u (u (u fm_term_let _3117) (u (u (u fm_term_bind _vars_1) (u fm_path_o _path_2)) _3118)) (\_x_8-> (u (u (u fm_term_bind (u (u list_cons (u (u pair_new _3117) _x_8)) _vars_1)) (u fm_path_i _path_2)) (u _3119 (u (u fm_term_var _3117) _vlen_7))))))); (7,f) -> u f (\_3120 _3121 _3122-> (let _vlen_7=(u list_length _vars_1) in (u (u (u fm_term_def _3120) (u (u (u fm_term_bind _vars_1) (u fm_path_o _path_2)) _3121)) (\_x_8-> (u (u (u fm_term_bind (u (u list_cons (u (u pair_new _3120) _x_8)) _vars_1)) (u fm_path_i _path_2)) (u _3122 (u (u fm_term_var _3120) _vlen_7))))))); (8,f) -> u f (\_3123 _3124 _3125-> (u (u (u fm_term_ann _3123) (u (u (u fm_term_bind _vars_1) (u fm_path_o _path_2)) _3124)) (u (u (u fm_term_bind _vars_1) (u fm_path_i _path_2)) _3125))); (9,f) -> u f (\_3126 _3127 _3128-> (u (u (u fm_term_gol _3126) _3127) _3128)); (10,f) -> u f (\_3129-> (u fm_term_hol (u fm_path_to_bits _path_2))); (11,f) -> u f (\_3130-> (u fm_term_nat _3130)); (12,f) -> u f (\_3131-> (u fm_term_chr _3131)); (13,f) -> u f (\_3132-> (u fm_term_str _3132)); (14,f) -> u f (\_3133 _3134 _3135 _3136 _3137 _3138-> (let _expr_10=(u (u (u fm_term_bind _vars_1) (u fm_path_o _path_2)) _3134) in (let _name_11=_3135 in (let _wyth_12=_3136 in (let _cses_13=_3137 in (let _moti_14=_3138 in (u (u (u (u (u (u fm_term_cse (u fm_path_to_bits _path_2)) _expr_10) _name_11) _wyth_12) _cses_13) _moti_14))))))); (15,f) -> u f (\_3139 _3140-> (u (u fm_term_ori _3139) (u (u (u fm_term_bind _vars_1) _path_2) _3140))); })))))
fm_status_done = (2,\t-> t)
fm_define = (\_file_1-> (\_code_2-> (\_name_3-> (\_term_4-> (\_type_5-> (\_done_6-> (\_defs_7-> (let _stat_8=(let _3141 = _done_6 in (if _3141 then fm_status_done else fm_status_init)) in (u (u (u fm_set _name_3) (u (u (u (u (u (u fm_def_new _file_1) _code_2) _name_3) _term_4) _type_5) _stat_8)) _defs_7)))))))))
fm_parser_file_def = (\_file_1-> (\_code_2-> (\_defs_3-> (\_idx_4-> (\_code_5-> (let _3142 = (u (u fm_parser_name1 _idx_4) _code_5) in (case _3142 of {(0,f) -> u f (\_3143 _3144 _3145-> (u (u (u parser_reply_error _3143) _3144) _3145)); (1,f) -> u f (\_3146 _3147 _3148-> (let _3149 = (u (u (u parser_many fm_parser_binder) _3146) _3147) in (case _3149 of {(0,f) -> u f (\_3150 _3151 _3152-> (u (u (u parser_reply_error _3150) _3151) _3152)); (1,f) -> u f (\_3153 _3154 _3155-> (let _args_12=(u list_flatten _3155) in (let _3156 = (u (u (u fm_parser_text ":") _3153) _3154) in (case _3156 of {(0,f) -> u f (\_3157 _3158 _3159-> (u (u (u parser_reply_error _3157) _3158) _3159)); (1,f) -> u f (\_3160 _3161 _3162-> (let _3163 = (u (u fm_parser_term _3160) _3161) in (case _3163 of {(0,f) -> u f (\_3164 _3165 _3166-> (u (u (u parser_reply_error _3164) _3165) _3166)); (1,f) -> u f (\_3167 _3168 _3169-> (let _3170 = (u (u fm_parser_term _3167) _3168) in (case _3170 of {(0,f) -> u f (\_3171 _3172 _3173-> (u (u (u parser_reply_error _3171) _3172) _3173)); (1,f) -> u f (\_3174 _3175 _3176-> (let _type_22=(u (u fm_parser_make_forall _args_12) _3169) in (let _term_23=(u (u fm_parser_make_lambda (u (u list_mapped _args_12) (\_x_23-> (let _3177 = _x_23 in (case _3177 of {(0,f) -> u f (\_3178 _3179 _3180-> _3179); }))))) _3176) in (let _type_24=(u (u (u fm_term_bind list_nil) (\_x_24-> (u bits_i _x_24))) _type_22) in (let _term_25=(u (u (u fm_term_bind list_nil) (\_x_25-> (u bits_o _x_25))) _term_23) in (let _defs_26=(u (u (u (u (u (u (u fm_define _file_1) _code_2) _3148) _term_25) _type_24) bool_false) _defs_3) in (u (u (u parser_reply_value _3174) _3175) _defs_26))))))); }))); }))); })))); }))); })))))))
maybe_default = (\_a_2-> (\_m_3-> (let _3181 = _m_3 in (case _3181 of {(0,f) -> u f (_a_2); (1,f) -> u f (\_3182-> _3182); }))))
fm_constructor_new = (\_name_1-> (\_args_2-> (\_inds_3-> (0,\t-> t _name_1 _args_2 _inds_3))))
fm_parser_constructor = (\_namespace_1-> (\_idx_2-> (\_code_3-> (let _3183 = (u (u fm_parser_name1 _idx_2) _code_3) in (case _3183 of {(0,f) -> u f (\_3184 _3185 _3186-> (u (u (u parser_reply_error _3184) _3185) _3186)); (1,f) -> u f (\_3187 _3188 _3189-> (let _3190 = (u (u (u parser_maybe fm_parser_binder) _3187) _3188) in (case _3190 of {(0,f) -> u f (\_3191 _3192 _3193-> (u (u (u parser_reply_error _3191) _3192) _3193)); (1,f) -> u f (\_3194 _3195 _3196-> (let _3197 = (u (u (u parser_maybe (\_idx_10-> (\_code_11-> (let _3198 = (u (u (u fm_parser_text "~") _idx_10) _code_11) in (case _3198 of {(0,f) -> u f (\_3199 _3200 _3201-> (u (u (u parser_reply_error _3199) _3200) _3201)); (1,f) -> u f (\_3202 _3203 _3204-> (u (u fm_parser_binder _3202) _3203)); }))))) _3194) _3195) in (case _3197 of {(0,f) -> u f (\_3205 _3206 _3207-> (u (u (u parser_reply_error _3205) _3206) _3207)); (1,f) -> u f (\_3208 _3209 _3210-> (let _args_13=(u (u maybe_default list_nil) _3196) in (let _inds_14=(u (u maybe_default list_nil) _3210) in (u (u (u parser_reply_value _3208) _3209) (u (u (u fm_constructor_new _3189) _args_13) _inds_14))))); }))); }))); })))))
fm_datatype_new = (\_name_1-> (\_pars_2-> (\_inds_3-> (\_ctrs_4-> (0,\t-> t _name_1 _pars_2 _inds_3 _ctrs_4)))))
fm_parser_datatype = (\_idx_1-> (\_code_2-> (let _3211 = (u (u (u fm_parser_text "type ") _idx_1) _code_2) in (case _3211 of {(0,f) -> u f (\_3212 _3213 _3214-> (u (u (u parser_reply_error _3212) _3213) _3214)); (1,f) -> u f (\_3215 _3216 _3217-> (let _3218 = (u (u fm_parser_name1 _3215) _3216) in (case _3218 of {(0,f) -> u f (\_3219 _3220 _3221-> (u (u (u parser_reply_error _3219) _3220) _3221)); (1,f) -> u f (\_3222 _3223 _3224-> (let _3225 = (u (u (u parser_maybe fm_parser_binder) _3222) _3223) in (case _3225 of {(0,f) -> u f (\_3226 _3227 _3228-> (u (u (u parser_reply_error _3226) _3227) _3228)); (1,f) -> u f (\_3229 _3230 _3231-> (let _3232 = (u (u (u parser_maybe (\_idx_12-> (\_code_13-> (let _3233 = (u (u (u fm_parser_text "~") _idx_12) _code_13) in (case _3233 of {(0,f) -> u f (\_3234 _3235 _3236-> (u (u (u parser_reply_error _3234) _3235) _3236)); (1,f) -> u f (\_3237 _3238 _3239-> (u (u fm_parser_binder _3237) _3238)); }))))) _3229) _3230) in (case _3232 of {(0,f) -> u f (\_3240 _3241 _3242-> (u (u (u parser_reply_error _3240) _3241) _3242)); (1,f) -> u f (\_3243 _3244 _3245-> (let _pars_15=(u (u maybe_default list_nil) _3231) in (let _inds_16=(u (u maybe_default list_nil) _3245) in (let _3246 = (u (u (u fm_parser_text "{") _3243) _3244) in (case _3246 of {(0,f) -> u f (\_3247 _3248 _3249-> (u (u (u parser_reply_error _3247) _3248) _3249)); (1,f) -> u f (\_3250 _3251 _3252-> (let _3253 = (u (u (u (u parser_until (u fm_parser_text "}")) (u fm_parser_item (u fm_parser_constructor _3224))) _3250) _3251) in (case _3253 of {(0,f) -> u f (\_3254 _3255 _3256-> (u (u (u parser_reply_error _3254) _3255) _3256)); (1,f) -> u f (\_3257 _3258 _3259-> (u (u (u parser_reply_value _3257) _3258) (u (u (u (u fm_datatype_new _3224) _pars_15) _inds_16) _3259))); }))); }))))); }))); }))); }))); }))))
fm_datatype_build_term_motive_go = (\_type_1-> (\_name_2-> (\_inds_3-> (let _3260 = _inds_3 in (case _3260 of {(0,f) -> u f ((let _3261 = _type_1 in (case _3261 of {(0,f) -> u f (\_3262 _3263 _3264 _3265-> (let _slf_8=(u fm_term_ref _name_2) in (let _slf_9=(u (u (u list_for _3263) _slf_8) (\_var_9-> (\_slf_10-> (u (u fm_term_app _slf_10) (u fm_term_ref (let _3266 = _var_9 in (case _3266 of {(0,f) -> u f (\_3267 _3268 _3269-> _3268); }))))))) in (let _slf_10=(u (u (u list_for _3264) _slf_9) (\_var_10-> (\_slf_11-> (u (u fm_term_app _slf_11) (u fm_term_ref (let _3270 = _var_10 in (case _3270 of {(0,f) -> u f (\_3271 _3272 _3273-> _3272); }))))))) in (u (u (u (u (u fm_term_all bool_false) "") "") _slf_10) (\_s_11-> (\_x_12-> fm_term_typ))))))); }))); (1,f) -> u f (\_3274 _3275-> (let _3276 = _3274 in (case _3276 of {(0,f) -> u f (\_3277 _3278 _3279-> (u (u (u (u (u fm_term_all _3277) "") _3278) _3279) (\_s_9-> (\_x_10-> (u (u (u fm_datatype_build_term_motive_go _type_1) _name_2) _3275))))); }))); })))))
fm_datatype_build_term_motive = (\_type_1-> (let _3280 = _type_1 in (case _3280 of {(0,f) -> u f (\_3281 _3282 _3283 _3284-> (u (u (u fm_datatype_build_term_motive_go _type_1) _3281) _3283)); })))
fm_datatype_build_term_constructor_go = (\_type_1-> (\_ctor_2-> (\_args_3-> (let _3285 = _args_3 in (case _3285 of {(0,f) -> u f ((let _3286 = _type_1 in (case _3286 of {(0,f) -> u f (\_3287 _3288 _3289 _3290-> (let _3291 = _ctor_2 in (case _3291 of {(0,f) -> u f (\_3292 _3293 _3294-> (let _ret_11=(u fm_term_ref (u fm_name_read "P")) in (let _ret_12=(u (u (u list_for _3294) _ret_11) (\_var_12-> (\_ret_13-> (u (u fm_term_app _ret_13) (let _3295 = _var_12 in (case _3295 of {(0,f) -> u f (\_3296 _3297 _3298-> _3298); })))))) in (let _ctr_13=(u string_flatten (u (u list_cons _3287) (u (u list_cons (u fm_name_read ".")) (u (u list_cons _3292) list_nil)))) in (let _slf_14=(u fm_term_ref _ctr_13) in (let _slf_15=(u (u (u list_for _3288) _slf_14) (\_var_15-> (\_slf_16-> (u (u fm_term_app _slf_16) (u fm_term_ref (let _3299 = _var_15 in (case _3299 of {(0,f) -> u f (\_3300 _3301 _3302-> _3301); }))))))) in (let _slf_16=(u (u (u list_for _3293) _slf_15) (\_var_16-> (\_slf_17-> (u (u fm_term_app _slf_17) (u fm_term_ref (let _3303 = _var_16 in (case _3303 of {(0,f) -> u f (\_3304 _3305 _3306-> _3305); }))))))) in (u (u fm_term_app _ret_12) _slf_16)))))))); }))); }))); (1,f) -> u f (\_3307 _3308-> (let _3309 = _3307 in (case _3309 of {(0,f) -> u f (\_3310 _3311 _3312-> (let _eras_9=_3310 in (let _name_10=_3311 in (let _xtyp_11=_3312 in (let _body_12=(u (u (u fm_datatype_build_term_constructor_go _type_1) _ctor_2) _3308) in (u (u (u (u (u fm_term_all _eras_9) "") _name_10) _xtyp_11) (\_s_13-> (\_x_14-> _body_12)))))))); }))); })))))
fm_datatype_build_term_constructor = (\_type_1-> (\_ctor_2-> (let _3313 = _ctor_2 in (case _3313 of {(0,f) -> u f (\_3314 _3315 _3316-> (u (u (u fm_datatype_build_term_constructor_go _type_1) _ctor_2) _3315)); }))))
fm_datatype_build_term_constructors_go = (\_type_1-> (\_name_2-> (\_ctrs_3-> (let _3317 = _ctrs_3 in (case _3317 of {(0,f) -> u f ((let _3318 = _type_1 in (case _3318 of {(0,f) -> u f (\_3319 _3320 _3321 _3322-> (let _ret_8=(u fm_term_ref (u fm_name_read "P")) in (let _ret_9=(u (u (u list_for _3321) _ret_8) (\_var_9-> (\_ret_10-> (u (u fm_term_app _ret_10) (u fm_term_ref (let _3323 = _var_9 in (case _3323 of {(0,f) -> u f (\_3324 _3325 _3326-> _3325); }))))))) in (u (u fm_term_app _ret_9) (u fm_term_ref (((_name_2::String) ++ ".Self"))))))); }))); (1,f) -> u f (\_3327 _3328-> (let _3329 = _3327 in (case _3329 of {(0,f) -> u f (\_3330 _3331 _3332-> (u (u (u (u (u fm_term_all bool_false) "") _3330) (u (u fm_datatype_build_term_constructor _type_1) _3327)) (\_s_9-> (\_x_10-> (u (u (u fm_datatype_build_term_constructors_go _type_1) _name_2) _3328))))); }))); })))))
fm_datatype_build_term_constructors = (\_type_1-> (let _3333 = _type_1 in (case _3333 of {(0,f) -> u f (\_3334 _3335 _3336 _3337-> (u (u (u fm_datatype_build_term_constructors_go _type_1) _3334) _3337)); })))
fm_datatype_build_term_go = (\_type_1-> (\_name_2-> (\_pars_3-> (\_inds_4-> (let _3338 = _pars_3 in (case _3338 of {(0,f) -> u f ((let _3339 = _inds_4 in (case _3339 of {(0,f) -> u f ((u (u (u (u (u fm_term_all bool_true) (((_name_2::String) ++ ".Self"))) (u fm_name_read "P")) (u fm_datatype_build_term_motive _type_1)) (\_s_5-> (\_x_6-> (u fm_datatype_build_term_constructors _type_1))))); (1,f) -> u f (\_3340 _3341-> (let _3342 = _3340 in (case _3342 of {(0,f) -> u f (\_3343 _3344 _3345-> (u (u fm_term_lam _3344) (\_x_10-> (u (u (u (u fm_datatype_build_term_go _type_1) _name_2) _pars_3) _3341)))); }))); }))); (1,f) -> u f (\_3346 _3347-> (let _3348 = _3346 in (case _3348 of {(0,f) -> u f (\_3349 _3350 _3351-> (u (u fm_term_lam _3350) (\_x_10-> (u (u (u (u fm_datatype_build_term_go _type_1) _name_2) _3347) _inds_4)))); }))); }))))))
fm_datatype_build_term = (\_type_1-> (let _3352 = _type_1 in (case _3352 of {(0,f) -> u f (\_3353 _3354 _3355 _3356-> (u (u (u (u fm_datatype_build_term_go _type_1) _3353) _3354) _3355)); })))
fm_datatype_build_type_go = (\_type_1-> (\_name_2-> (\_pars_3-> (\_inds_4-> (let _3357 = _pars_3 in (case _3357 of {(0,f) -> u f ((let _3358 = _inds_4 in (case _3358 of {(0,f) -> u f (fm_term_typ); (1,f) -> u f (\_3359 _3360-> (let _3361 = _3359 in (case _3361 of {(0,f) -> u f (\_3362 _3363 _3364-> (u (u (u (u (u fm_term_all bool_false) "") _3363) _3364) (\_s_10-> (\_x_11-> (u (u (u (u fm_datatype_build_type_go _type_1) _name_2) _pars_3) _3360))))); }))); }))); (1,f) -> u f (\_3365 _3366-> (let _3367 = _3365 in (case _3367 of {(0,f) -> u f (\_3368 _3369 _3370-> (u (u (u (u (u fm_term_all bool_false) "") _3369) _3370) (\_s_10-> (\_x_11-> (u (u (u (u fm_datatype_build_type_go _type_1) _name_2) _3366) _inds_4))))); }))); }))))))
fm_datatype_build_type = (\_type_1-> (let _3371 = _type_1 in (case _3371 of {(0,f) -> u f (\_3372 _3373 _3374 _3375-> (u (u (u (u fm_datatype_build_type_go _type_1) _3372) _3373) _3374)); })))
fm_constructor_build_term_opt_go = (\_type_1-> (\_ctor_2-> (\_ctrs_3-> (let _3376 = _ctrs_3 in (case _3376 of {(0,f) -> u f ((let _3377 = _ctor_2 in (case _3377 of {(0,f) -> u f (\_3378 _3379 _3380-> (let _ret_7=(u fm_term_ref _3378) in (let _ret_8=(u (u (u list_for _3379) _ret_7) (\_arg_8-> (\_ret_9-> (u (u fm_term_app _ret_9) (u fm_term_ref (let _3381 = _arg_8 in (case _3381 of {(0,f) -> u f (\_3382 _3383 _3384-> _3383); }))))))) in _ret_8))); }))); (1,f) -> u f (\_3385 _3386-> (let _3387 = _3385 in (case _3387 of {(0,f) -> u f (\_3388 _3389 _3390-> (u (u fm_term_lam _3388) (\_x_9-> (u (u (u fm_constructor_build_term_opt_go _type_1) _ctor_2) _3386)))); }))); })))))
fm_constructor_build_term_opt = (\_type_1-> (\_ctor_2-> (let _3391 = _type_1 in (case _3391 of {(0,f) -> u f (\_3392 _3393 _3394 _3395-> (u (u (u fm_constructor_build_term_opt_go _type_1) _ctor_2) _3395)); }))))
fm_constructor_build_term_go = (\_type_1-> (\_ctor_2-> (\_name_3-> (\_pars_4-> (\_args_5-> (let _3396 = _pars_4 in (case _3396 of {(0,f) -> u f ((let _3397 = _args_5 in (case _3397 of {(0,f) -> u f ((u (u fm_term_lam (u fm_name_read "P")) (\_x_6-> (u (u fm_constructor_build_term_opt _type_1) _ctor_2)))); (1,f) -> u f (\_3398 _3399-> (let _3400 = _3398 in (case _3400 of {(0,f) -> u f (\_3401 _3402 _3403-> (u (u fm_term_lam _3402) (\_x_11-> (u (u (u (u (u fm_constructor_build_term_go _type_1) _ctor_2) _name_3) _pars_4) _3399)))); }))); }))); (1,f) -> u f (\_3404 _3405-> (let _3406 = _3404 in (case _3406 of {(0,f) -> u f (\_3407 _3408 _3409-> (u (u fm_term_lam _3408) (\_x_11-> (u (u (u (u (u fm_constructor_build_term_go _type_1) _ctor_2) _name_3) _3405) _args_5)))); }))); })))))))
fm_constructor_build_term = (\_type_1-> (\_ctor_2-> (let _3410 = _type_1 in (case _3410 of {(0,f) -> u f (\_3411 _3412 _3413 _3414-> (let _3415 = _ctor_2 in (case _3415 of {(0,f) -> u f (\_3416 _3417 _3418-> (u (u (u (u (u fm_constructor_build_term_go _type_1) _ctor_2) _3411) _3412) _3417)); }))); }))))
fm_constructor_build_type_go = (\_type_1-> (\_ctor_2-> (\_name_3-> (\_pars_4-> (\_args_5-> (let _3419 = _pars_4 in (case _3419 of {(0,f) -> u f ((let _3420 = _args_5 in (case _3420 of {(0,f) -> u f ((let _3421 = _type_1 in (case _3421 of {(0,f) -> u f (\_3422 _3423 _3424 _3425-> (let _3426 = _ctor_2 in (case _3426 of {(0,f) -> u f (\_3427 _3428 _3429-> (let _type_13=(u fm_term_ref _name_3) in (let _type_14=(u (u (u list_for _3423) _type_13) (\_var_14-> (\_type_15-> (u (u fm_term_app _type_15) (u fm_term_ref (let _3430 = _var_14 in (case _3430 of {(0,f) -> u f (\_3431 _3432 _3433-> _3432); }))))))) in (let _type_15=(u (u (u list_for _3429) _type_14) (\_var_15-> (\_type_16-> (u (u fm_term_app _type_16) (let _3434 = _var_15 in (case _3434 of {(0,f) -> u f (\_3435 _3436 _3437-> _3437); })))))) in _type_15)))); }))); }))); (1,f) -> u f (\_3438 _3439-> (let _3440 = _3438 in (case _3440 of {(0,f) -> u f (\_3441 _3442 _3443-> (u (u (u (u (u fm_term_all _3441) "") _3442) _3443) (\_s_11-> (\_x_12-> (u (u (u (u (u fm_constructor_build_type_go _type_1) _ctor_2) _name_3) _pars_4) _3439))))); }))); }))); (1,f) -> u f (\_3444 _3445-> (let _3446 = _3444 in (case _3446 of {(0,f) -> u f (\_3447 _3448 _3449-> (u (u (u (u (u fm_term_all _3447) "") _3448) _3449) (\_s_11-> (\_x_12-> (u (u (u (u (u fm_constructor_build_type_go _type_1) _ctor_2) _name_3) _3445) _args_5))))); }))); })))))))
fm_constructor_build_type = (\_type_1-> (\_ctor_2-> (let _3450 = _type_1 in (case _3450 of {(0,f) -> u f (\_3451 _3452 _3453 _3454-> (let _3455 = _ctor_2 in (case _3455 of {(0,f) -> u f (\_3456 _3457 _3458-> (u (u (u (u (u fm_constructor_build_type_go _type_1) _ctor_2) _3451) _3452) _3457)); }))); }))))
fm_parser_file_adt = (\_file_1-> (\_code_2-> (\_defs_3-> (\_idx_4-> (\_code_5-> (let _3459 = (u (u fm_parser_datatype _idx_4) _code_5) in (case _3459 of {(0,f) -> u f (\_3460 _3461 _3462-> (u (u (u parser_reply_error _3460) _3461) _3462)); (1,f) -> u f (\_3463 _3464 _3465-> (let _3466 = _3465 in (case _3466 of {(0,f) -> u f (\_3467 _3468 _3469 _3470-> (let _term_13=(u fm_datatype_build_term _3465) in (let _term_14=(u (u (u fm_term_bind list_nil) (\_x_14-> (u bits_i _x_14))) _term_13) in (let _type_15=(u fm_datatype_build_type _3465) in (let _type_16=(u (u (u fm_term_bind list_nil) (\_x_16-> (u bits_o _x_16))) _type_15) in (let _defs_17=(u (u (u (u (u (u (u fm_define _file_1) _code_2) _3467) _term_14) _type_16) bool_false) _defs_3) in (let _defs_18=(u (u (u list_fold _3470) _defs_17) (\_ctr_18-> (\_defs_19-> (let _typ_name_20=_3467 in (let _ctr_name_21=(u string_flatten (u (u list_cons _typ_name_20) (u (u list_cons (u fm_name_read ".")) (u (u list_cons (let _3471 = _ctr_18 in (case _3471 of {(0,f) -> u f (\_3472 _3473 _3474-> _3472); }))) list_nil)))) in (let _ctr_term_22=(u (u fm_constructor_build_term _3465) _ctr_18) in (let _ctr_term_23=(u (u (u fm_term_bind list_nil) (\_x_23-> (u bits_i _x_23))) _ctr_term_22) in (let _ctr_type_24=(u (u fm_constructor_build_type _3465) _ctr_18) in (let _ctr_type_25=(u (u (u fm_term_bind list_nil) (\_x_25-> (u bits_o _x_25))) _ctr_type_24) in (u (u (u (u (u (u (u fm_define _file_1) _code_2) _ctr_name_21) _ctr_term_23) _ctr_type_25) bool_false) _defs_19)))))))))) in (\_idx_19-> (\_code_20-> (u (u (u parser_reply_value _idx_19) _code_20) _defs_18)))))))))); })) _3463 _3464); })))))))
parser_eof = (\_idx_1-> (\_code_2-> (let _3475 = _code_2 in (if null (_3475::String) then (u (u (u parser_reply_value _idx_1) _code_2) unit_new) else (u (u (u parser_reply_error _idx_1) _code_2) "Expected end-of-file.")))))
fm_parser_file_end = (\_file_1-> (\_code_2-> (\_defs_3-> (\_idx_4-> (\_code_5-> (let _3476 = (u (u fm_parser_spaces _idx_4) _code_5) in (case _3476 of {(0,f) -> u f (\_3477 _3478 _3479-> (u (u (u parser_reply_error _3477) _3478) _3479)); (1,f) -> u f (\_3480 _3481 _3482-> (let _3483 = (u (u parser_eof _3480) _3481) in (case _3483 of {(0,f) -> u f (\_3484 _3485 _3486-> (u (u (u parser_reply_error _3484) _3485) _3486)); (1,f) -> u f (\_3487 _3488 _3489-> (u (u (u parser_reply_value _3487) _3488) _defs_3)); }))); })))))))
fm_parser_file = (\_file_1-> (\_code_2-> (\_defs_3-> (\_idx_4-> (\_code_5-> (let _3490 = (u (u parser_is_eof _idx_4) _code_5) in (case _3490 of {(0,f) -> u f (\_3491 _3492 _3493-> (u (u (u parser_reply_error _3491) _3492) _3493)); (1,f) -> u f (\_3494 _3495 _3496-> (let _3497 = _3496 in (if _3497 then (\_idx_9-> (\_code_10-> (u (u (u parser_reply_value _idx_9) _code_10) _defs_3))) else (u parser_first_of (u (u list_cons (\_idx_9-> (\_code_10-> (let _3498 = (u (u (u fm_parser_text "#") _idx_9) _code_10) in (case _3498 of {(0,f) -> u f (\_3499 _3500 _3501-> (u (u (u parser_reply_error _3499) _3500) _3501)); (1,f) -> u f (\_3502 _3503 _3504-> (let _3505 = (u (u fm_parser_name1 _3502) _3503) in (case _3505 of {(0,f) -> u f (\_3506 _3507 _3508-> (u (u (u parser_reply_error _3506) _3507) _3508)); (1,f) -> u f (\_3509 _3510 _3511-> (u (u (u (u (u fm_parser_file _3511) _code_2) _defs_3) _3509) _3510)); }))); }))))) (u (u list_cons (\_idx_9-> (\_code_10-> (let _3512 = (u (u (u parser_first_of (u (u list_cons (u (u (u fm_parser_file_def _file_1) _code_2) _defs_3)) (u (u list_cons (u (u (u fm_parser_file_adt _file_1) _code_2) _defs_3)) (u (u list_cons (u (u (u fm_parser_file_end _file_1) _code_2) _defs_3)) list_nil)))) _idx_9) _code_10) in (case _3512 of {(0,f) -> u f (\_3513 _3514 _3515-> (u (u (u parser_reply_error _3513) _3514) _3515)); (1,f) -> u f (\_3516 _3517 _3518-> (u (u (u (u (u fm_parser_file _file_1) _code_2) _3518) _3516) _3517)); }))))) list_nil))))) _3494 _3495); })))))))
either = (\_a_1-> (\_b_2-> ()))
string_join_go = (\_sep_1-> (\_list_2-> (\_fst_3-> (let _3519 = _list_2 in (case _3519 of {(0,f) -> u f (""); (1,f) -> u f (\_3520 _3521-> (u string_flatten (u (u list_cons (let _3522 = _fst_3 in (if _3522 then "" else _sep_1))) (u (u list_cons _3520) (u (u list_cons (u (u (u string_join_go _sep_1) _3521) bool_false)) list_nil))))); })))))
string_join = (\_sep_1-> (\_list_2-> (u (u (u string_join_go _sep_1) _list_2) bool_true)))
fm_highlight_end = (\_col_1-> (\_row_2-> (\_res_3-> (u (u string_join "\n") _res_3))))
maybe_extract = (\_m_2-> (\_a_4-> (\_f_5-> (let _3523 = _m_2 in (case _3523 of {(0,f) -> u f (_a_4); (1,f) -> u f (\_3524-> (u _f_5 _3524)); })))))
nat_is_zero = (\_n_1-> (let _3525 = _n_1 in (if _3525==0 then bool_true else bool_false)))
nat_double = (\_n_1-> (let _3526 = _n_1 in (if _3526==0 then nat_zero else (u nat_succ (u nat_succ (u nat_double (_3526-1)))))))
nat_pred = (\_n_1-> (let _3527 = _n_1 in (if _3527==0 then nat_zero else (_3527-1))))
list_take = (\_n_2-> (\_xs_3-> (let _3528 = _xs_3 in (case _3528 of {(0,f) -> u f (list_nil); (1,f) -> u f (\_3529 _3530-> (let _3531 = _n_2 in (if _3531==0 then list_nil else (u (u list_cons _3529) (u (u list_take (_3531-1)) _3530))))); }))))
string_reverse_go = (\_xs_1-> (\_res_2-> (let _3532 = _xs_1 in (if null (_3532::String) then _res_2 else (u (u string_reverse_go (tail _3532)) (u (u string_cons (fromIntegral (fromEnum (head _3532 :: Char)) :: Word16)) _res_2))))))
string_reverse = (\_xs_1-> (u (u string_reverse_go _xs_1) string_nil))
string_pad_right = (\_size_1-> (\_chr_2-> (\_str_3-> (let _3533 = _size_1 in (if _3533==0 then _str_3 else (let _3534 = _str_3 in (if null (_3534::String) then (u (u string_cons _chr_2) (u (u (u string_pad_right (_3533-1)) _chr_2) "")) else (u (u string_cons (fromIntegral (fromEnum (head _3534 :: Char)) :: Word16)) (u (u (u string_pad_right (_3533-1)) _chr_2) (tail _3534))))))))))
string_pad_left = (\_size_1-> (\_chr_2-> (\_str_3-> (u string_reverse (u (u (u string_pad_right _size_1) _chr_2) (u string_reverse _str_3))))))
either_left = (\_value_3-> (0,\t-> t _value_3))
either_right = (\_value_3-> (1,\t-> t _value_3))
nat_sub_rem = (\_n_1-> (\_m_2-> (let _3535 = _m_2 in (if _3535==0 then (u either_left _n_1) else (let _3536 = _n_1 in (if _3536==0 then (u either_right (u nat_succ (_3535-1))) else (u (u nat_sub_rem (_3536-1)) (_3535-1))))))))
nat_div_mod_go = (\_n_1-> (\_m_2-> (\_d_3-> (let _3537 = (u (u nat_sub_rem _n_1) _m_2) in (case _3537 of {(0,f) -> u f (\_3538-> (u (u (u nat_div_mod_go _3538) _m_2) (u nat_succ _d_3))); (1,f) -> u f (\_3539-> (u (u pair_new _d_3) _n_1)); })))))
nat_div_mod = (\_n_1-> (\_m_2-> (u (u (u nat_div_mod_go _n_1) _m_2) nat_zero)))
nat_to_base_go = (\_base_1-> (\_nat_2-> (\_res_3-> (let _3540 = (u (u nat_div_mod _nat_2) _base_1) in (case _3540 of {(0,f) -> u f (\_3541 _3542-> (let _3543 = _3541 in (if _3543==0 then (u (u list_cons _3542) _res_3) else (u (u (u nat_to_base_go _base_1) _3541) (u (u list_cons _3542) _res_3))))); })))))
nat_to_base = (\_base_1-> (\_nat_2-> (u (u (u nat_to_base_go _base_1) _nat_2) list_nil)))
nat_mod_go = (\_n_1-> (\_m_2-> (\_r_3-> (let _3544 = _m_2 in (if _3544==0 then (u (u (u nat_mod_go _n_1) _r_3) _m_2) else (let _3545 = _n_1 in (if _3545==0 then _r_3 else (u (u (u nat_mod_go (_3545-1)) (_3544-1)) (u nat_succ _r_3)))))))))
nat_mod = (\_n_1-> (\_m_2-> (u (u (u nat_mod_go _n_1) _m_2) 0)))
nat_lte = (\a0-> \a1-> ((a0::Integer) <= a1))
nat_show_digit = (\_base_1-> (\_n_2-> (let _m_3=(u (u nat_mod _n_2) _base_1) in (let _base64_4=(u (u list_cons 48) (u (u list_cons 49) (u (u list_cons 50) (u (u list_cons 51) (u (u list_cons 52) (u (u list_cons 53) (u (u list_cons 54) (u (u list_cons 55) (u (u list_cons 56) (u (u list_cons 57) (u (u list_cons 65) (u (u list_cons 66) (u (u list_cons 67) (u (u list_cons 68) (u (u list_cons 69) (u (u list_cons 70) (u (u list_cons 71) (u (u list_cons 72) (u (u list_cons 73) (u (u list_cons 74) (u (u list_cons 75) (u (u list_cons 76) (u (u list_cons 77) (u (u list_cons 78) (u (u list_cons 79) (u (u list_cons 80) (u (u list_cons 81) (u (u list_cons 82) (u (u list_cons 83) (u (u list_cons 84) (u (u list_cons 85) (u (u list_cons 86) (u (u list_cons 87) (u (u list_cons 88) (u (u list_cons 89) (u (u list_cons 90) (u (u list_cons 97) (u (u list_cons 98) (u (u list_cons 99) (u (u list_cons 100) (u (u list_cons 101) (u (u list_cons 102) (u (u list_cons 103) (u (u list_cons 104) (u (u list_cons 105) (u (u list_cons 106) (u (u list_cons 107) (u (u list_cons 108) (u (u list_cons 109) (u (u list_cons 110) (u (u list_cons 111) (u (u list_cons 112) (u (u list_cons 113) (u (u list_cons 114) (u (u list_cons 115) (u (u list_cons 116) (u (u list_cons 117) (u (u list_cons 118) (u (u list_cons 119) (u (u list_cons 120) (u (u list_cons 121) (u (u list_cons 122) (u (u list_cons 43) (u (u list_cons 47) list_nil)))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))) in (let _3546 = (((((_base_1::Integer) > 0)) && (((_base_1::Integer) <= 64)))) in (if _3546 then (let _3547 = (u (u list_at _m_3) _base64_4) in (case _3547 of {(0,f) -> u f (35); (1,f) -> u f (\_3548-> _3548); })) else 35))))))
nat_to_string_base = (\_base_1-> (\_nat_2-> (u (u (u list_fold (u (u nat_to_base _base_1) _nat_2)) string_nil) (\_n_3-> (\_str_4-> (u (u string_cons (u (u nat_show_digit _base_1) _n_3)) _str_4))))))
nat_show = (\_n_1-> (u (u nat_to_string_base 10) _n_1))
bool_not = (\a0-> (not a0))
fm_color = (\_col_1-> (\_str_2-> (u (u string_cons 27) (u (u string_cons 91) (((_col_1::String) ++ (u (u string_cons 109) (((_str_2::String) ++ (u (u string_cons 27) (u (u string_cons 91) (u (u string_cons 48) (u (u string_cons 109) string_nil)))))))))))))
fm_highlight_tc = (\_code_1-> (\_ix0_2-> (\_ix1_3-> (\_col_4-> (\_row_5-> (\_lft_6-> (\_lin_7-> (\_res_8-> (let _3549 = _code_1 in (if null (_3549::String) then (u (u (u fm_highlight_end _col_4) _row_5) (u list_reverse _res_8)) else (let _3550 = ((((fromIntegral (fromEnum (head _3549 :: Char)) :: Word16)::Word16) == 10)) in (if _3550 then (let _stp_11=(u (u (u maybe_extract _lft_6) bool_false) nat_is_zero) in (let _3551 = _stp_11 in (if _3551 then (u (u (u fm_highlight_end _col_4) _row_5) (u list_reverse _res_8)) else (let _spa_12=3 in (let _siz_13=(u nat_succ (u nat_double _spa_12)) in (let _lft_14=(let _3552 = _ix1_3 in (if _3552==0 then (let _3553 = _lft_6 in (case _3553 of {(0,f) -> u f ((u maybe_some _spa_12)); (1,f) -> u f (\_3554-> (u maybe_some (u nat_pred _3554))); })) else _lft_6)) in (let _ix0_15=(u nat_pred _ix0_2) in (let _ix1_16=(u nat_pred _ix1_3) in (let _col_17=0 in (let _row_18=(u nat_succ _row_5) in (let _res_19=(u (u list_take _siz_13) (u (u list_cons (u string_reverse _lin_7)) _res_8)) in (let _lin_20=(u string_reverse (u string_flatten (u (u list_cons (u (u (u string_pad_left 4) 32) (u nat_show _row_18))) (u (u list_cons " | ") list_nil)))) in (u (u (u (u (u (u (u (u fm_highlight_tc (tail _3549)) _ix0_15) _ix1_16) _col_17) _row_18) _lft_14) _lin_20) _res_19))))))))))))) else (let _chr_11=(u (u string_cons (fromIntegral (fromEnum (head _3549 :: Char)) :: Word16)) string_nil) in (let _chr_12=(let _3555 = (((u nat_is_zero _ix0_2) && ((not (u nat_is_zero _ix1_3))))) in (if _3555 then (u string_reverse (u (u fm_color "31") (u (u fm_color "4") _chr_11))) else _chr_11)) in (let _ix0_13=(u nat_pred _ix0_2) in (let _ix1_14=(u nat_pred _ix1_3) in (let _col_15=(u nat_succ _col_4) in (let _lin_16=(u string_flatten (u (u list_cons _chr_12) (u (u list_cons _lin_7) list_nil))) in (u (u (u (u (u (u (u (u fm_highlight_tc (tail _3549)) _ix0_13) _ix1_14) _col_15) _row_5) _lft_6) _lin_16) _res_8)))))))))))))))))))
fm_highlight = (\_code_1-> (\_idx0_2-> (\_idx1_3-> (u (u (u (u (u (u (u (u fm_highlight_tc _code_1) _idx0_2) _idx1_3) 0) 1) maybe_none) (u string_reverse "   1 | ")) list_nil))))
fm_defs_read = (\_file_1-> (\_code_2-> (\_defs_3-> (let _3556 = (u (u (u (u (u fm_parser_file _file_1) _code_2) _defs_3) 0) _code_2) in (case _3556 of {(0,f) -> u f (\_3557 _3558 _3559-> (let _err_7=_3559 in (let _hig_8=(u (u (u fm_highlight _code_2) _3557) (u nat_succ _3557)) in (let _str_9=(u string_flatten (u (u list_cons _err_7) (u (u list_cons "\n") (u (u list_cons _hig_8) list_nil)))) in (u either_left _str_9))))); (1,f) -> u f (\_3560 _3561 _3562-> (u either_right _3562)); })))))
fm_synth_load = (\_name_1-> (\_defs_2-> (let _file_3=(u fm_synth_file_of _name_1) in (u (u (u io_monad (\_m_bind_4-> (\_m_pure_5-> _m_bind_4))) (u io_get_file _file_3)) (\_code_4-> (let _read_5=(u (u (u fm_defs_read _file_3) _code_4) _defs_2) in (let _3563 = _read_5 in (case _3563 of {(0,f) -> u f (\_3564-> (u (u io_monad (\_m_bind_7-> (\_m_pure_8-> _m_pure_8))) maybe_none)); (1,f) -> u f (\_3565-> (let _defs_7=_3565 in (let _3566 = (u (u fm_get _name_1) _defs_7) in (case _3566 of {(0,f) -> u f ((u (u io_monad (\_m_bind_8-> (\_m_pure_9-> _m_pure_9))) maybe_none)); (1,f) -> u f (\_3567-> (u (u io_monad (\_m_bind_9-> (\_m_pure_10-> _m_pure_10))) (u maybe_some _defs_7))); })))); }))))))))
fm_status_wait = (1,\t-> t)
fm_check = (\_v_1-> ())
fm_check_result = (\_value_2-> (\_errors_3-> (0,\t-> t _value_2 _errors_3)))
fm_error_undefined_reference = (\_origin_1-> (\_name_2-> (5,\t-> t _origin_1 _name_2)))
fm_error_waiting = (\_name_1-> (2,\t-> t _name_1))
fm_error_indirect = (\_name_1-> (3,\t-> t _name_1))
maybe_mapped = (\_m_2-> (\_f_4-> (let _3568 = _m_2 in (case _3568 of {(0,f) -> u f (maybe_none); (1,f) -> u f (\_3569-> (u maybe_some (u _f_4 _3569))); }))))
fm_mpath_o = (\_path_1-> (u (u maybe_mapped _path_1) fm_path_o))
fm_mpath_i = (\_path_1-> (u (u maybe_mapped _path_1) fm_path_i))
fm_error_patch = (\_path_1-> (\_term_2-> (4,\t-> t _path_1 _term_2)))
fm_mpath_to_bits = (\_path_1-> (let _3570 = _path_1 in (case _3570 of {(0,f) -> u f (bits_e); (1,f) -> u f (\_3571-> (u _3571 bits_e)); })))
fm_error_type_mismatch = (\_origin_1-> (\_expected_2-> (\_detected_3-> (\_context_4-> (0,\t-> t _origin_1 _expected_2 _detected_3 _context_4)))))
fm_error_show_goal = (\_name_1-> (\_dref_2-> (\_verb_3-> (\_goal_4-> (\_context_5-> (1,\t-> t _name_1 _dref_2 _verb_3 _goal_4 _context_5))))))
fm_term_normalize = (\_term_1-> (\_defs_2-> (let _3572 = (u (u fm_term_reduce _term_1) _defs_2) in (case _3572 of {(0,f) -> u f (\_3573 _3574-> (u (u fm_term_var _3573) _3574)); (1,f) -> u f (\_3575-> (u fm_term_ref _3575)); (2,f) -> u f (fm_term_typ); (3,f) -> u f (\_3576 _3577 _3578 _3579 _3580-> (u (u (u (u (u fm_term_all _3576) _3577) _3578) (u (u fm_term_normalize _3579) _defs_2)) (\_s_8-> (\_x_9-> (u (u fm_term_normalize (u (u _3580 _s_8) _x_9)) _defs_2))))); (4,f) -> u f (\_3581 _3582-> (u (u fm_term_lam _3581) (\_x_5-> (u (u fm_term_normalize (u _3582 _x_5)) _defs_2)))); (5,f) -> u f (\_3583 _3584-> (u (u fm_term_app (u (u fm_term_normalize _3583) _defs_2)) (u (u fm_term_normalize _3584) _defs_2))); (6,f) -> u f (\_3585 _3586 _3587-> (u (u (u fm_term_let _3585) (u (u fm_term_normalize _3586) _defs_2)) (\_x_6-> (u (u fm_term_normalize (u _3587 _x_6)) _defs_2)))); (7,f) -> u f (\_3588 _3589 _3590-> (u (u (u fm_term_def _3588) (u (u fm_term_normalize _3589) _defs_2)) (\_x_6-> (u (u fm_term_normalize (u _3590 _x_6)) _defs_2)))); (8,f) -> u f (\_3591 _3592 _3593-> (u (u (u fm_term_ann _3591) (u (u fm_term_normalize _3592) _defs_2)) (u (u fm_term_normalize _3593) _defs_2))); (9,f) -> u f (\_3594 _3595 _3596-> (u (u (u fm_term_gol _3594) _3595) _3596)); (10,f) -> u f (\_3597-> (u fm_term_hol _3597)); (11,f) -> u f (\_3598-> (u fm_term_nat _3598)); (12,f) -> u f (\_3599-> (u fm_term_chr _3599)); (13,f) -> u f (\_3600-> (u fm_term_str _3600)); (14,f) -> u f (\_3601 _3602 _3603 _3604 _3605 _3606-> _term_1); (15,f) -> u f (\_3607 _3608-> (u (u fm_term_normalize _3608) _defs_2)); }))))
list_tail = (\_xs_2-> (let _3609 = _xs_2 in (case _3609 of {(0,f) -> u f (list_nil); (1,f) -> u f (\_3610 _3611-> _3611); })))
fm_smartmotive_vals_cont = (\_expr_1-> (\_term_2-> (\_args_3-> (\_defs_4-> (let _3612 = (u (u fm_term_reduce _term_2) _defs_4) in (case _3612 of {(0,f) -> u f (\_3613 _3614-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (1,f) -> u f (\_3615-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (2,f) -> u f ((u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (3,f) -> u f (\_3616 _3617 _3618 _3619 _3620-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (4,f) -> u f (\_3621 _3622-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (5,f) -> u f (\_3623 _3624-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _3623) (u (u list_cons _3624) _args_3)) _defs_4)); (6,f) -> u f (\_3625 _3626 _3627-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (7,f) -> u f (\_3628 _3629 _3630-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (8,f) -> u f (\_3631 _3632 _3633-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (9,f) -> u f (\_3634 _3635 _3636-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (10,f) -> u f (\_3637-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (11,f) -> u f (\_3638-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (12,f) -> u f (\_3639-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (13,f) -> u f (\_3640-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (14,f) -> u f (\_3641 _3642 _3643 _3644 _3645 _3646-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (15,f) -> u f (\_3647 _3648-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); }))))))
fm_smartmotive_vals = (\_expr_1-> (\_type_2-> (\_defs_3-> (let _3649 = (u (u fm_term_reduce _type_2) _defs_3) in (case _3649 of {(0,f) -> u f (\_3650 _3651-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (1,f) -> u f (\_3652-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (2,f) -> u f ((u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (3,f) -> u f (\_3653 _3654 _3655 _3656 _3657-> (u (u (u fm_smartmotive_vals _expr_1) (u (u _3657 fm_term_typ) fm_term_typ)) _defs_3)); (4,f) -> u f (\_3658 _3659-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (5,f) -> u f (\_3660 _3661-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (6,f) -> u f (\_3662 _3663 _3664-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (7,f) -> u f (\_3665 _3666 _3667-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (8,f) -> u f (\_3668 _3669 _3670-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (9,f) -> u f (\_3671 _3672 _3673-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (10,f) -> u f (\_3674-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (11,f) -> u f (\_3675-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (12,f) -> u f (\_3676-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (13,f) -> u f (\_3677-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (14,f) -> u f (\_3678 _3679 _3680 _3681 _3682 _3683-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (15,f) -> u f (\_3684 _3685-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); })))))
fm_smartmotive_nams_cont = (\_name_1-> (\_term_2-> (\_binds_3-> (\_defs_4-> (let _3686 = (u (u fm_term_reduce _term_2) _defs_4) in (case _3686 of {(0,f) -> u f (\_3687 _3688-> (u (u list_cons _name_1) (u list_tail _binds_3))); (1,f) -> u f (\_3689-> (u (u list_cons _name_1) (u list_tail _binds_3))); (2,f) -> u f ((u (u list_cons _name_1) (u list_tail _binds_3))); (3,f) -> u f (\_3690 _3691 _3692 _3693 _3694-> (u (u (u (u fm_smartmotive_nams_cont _name_1) (u (u _3694 (u fm_term_ref _3691)) (u fm_term_ref _3692))) (u (u list_cons (u string_flatten (u (u list_cons _name_1) (u (u list_cons ".") (u (u list_cons _3692) list_nil))))) _binds_3)) _defs_4)); (4,f) -> u f (\_3695 _3696-> (u (u list_cons _name_1) (u list_tail _binds_3))); (5,f) -> u f (\_3697 _3698-> (u (u list_cons _name_1) (u list_tail _binds_3))); (6,f) -> u f (\_3699 _3700 _3701-> (u (u list_cons _name_1) (u list_tail _binds_3))); (7,f) -> u f (\_3702 _3703 _3704-> (u (u list_cons _name_1) (u list_tail _binds_3))); (8,f) -> u f (\_3705 _3706 _3707-> (u (u list_cons _name_1) (u list_tail _binds_3))); (9,f) -> u f (\_3708 _3709 _3710-> (u (u list_cons _name_1) (u list_tail _binds_3))); (10,f) -> u f (\_3711-> (u (u list_cons _name_1) (u list_tail _binds_3))); (11,f) -> u f (\_3712-> (u (u list_cons _name_1) (u list_tail _binds_3))); (12,f) -> u f (\_3713-> (u (u list_cons _name_1) (u list_tail _binds_3))); (13,f) -> u f (\_3714-> (u (u list_cons _name_1) (u list_tail _binds_3))); (14,f) -> u f (\_3715 _3716 _3717 _3718 _3719 _3720-> (u (u list_cons _name_1) (u list_tail _binds_3))); (15,f) -> u f (\_3721 _3722-> (u (u list_cons _name_1) (u list_tail _binds_3))); }))))))
fm_smartmotive_nams = (\_name_1-> (\_type_2-> (\_defs_3-> (let _3723 = (u (u fm_term_reduce _type_2) _defs_3) in (case _3723 of {(0,f) -> u f (\_3724 _3725-> list_nil); (1,f) -> u f (\_3726-> list_nil); (2,f) -> u f (list_nil); (3,f) -> u f (\_3727 _3728 _3729 _3730 _3731-> (u (u (u (u fm_smartmotive_nams_cont _name_1) _3730) list_nil) _defs_3)); (4,f) -> u f (\_3732 _3733-> list_nil); (5,f) -> u f (\_3734 _3735-> list_nil); (6,f) -> u f (\_3736 _3737 _3738-> list_nil); (7,f) -> u f (\_3739 _3740 _3741-> list_nil); (8,f) -> u f (\_3742 _3743 _3744-> list_nil); (9,f) -> u f (\_3745 _3746 _3747-> list_nil); (10,f) -> u f (\_3748-> list_nil); (11,f) -> u f (\_3749-> list_nil); (12,f) -> u f (\_3750-> list_nil); (13,f) -> u f (\_3751-> list_nil); (14,f) -> u f (\_3752 _3753 _3754 _3755 _3756 _3757-> list_nil); (15,f) -> u f (\_3758 _3759-> list_nil); })))))
list_zip = (\_as_3-> (\_bs_4-> (let _3760 = _as_3 in (case _3760 of {(0,f) -> u f (list_nil); (1,f) -> u f (\_3761 _3762-> (let _3763 = _bs_4 in (case _3763 of {(0,f) -> u f (list_nil); (1,f) -> u f (\_3764 _3765-> (u (u list_cons (u (u pair_new _3761) _3764)) (u (u list_zip _3762) _3765))); }))); }))))
nat_gte = (\a0-> \a1-> ((a0::Integer) >= a1))
nat_sub = (\a0-> \a1-> ((a0::Integer) - a1))
fm_term_serialize_name = (\_name_1-> (u fm_name_to_bits _name_1))
fm_term_serialize = (\_term_1-> (\_depth_2-> (\_init_3-> (\_diff_4-> (\_x_5-> (let _3766 = _term_1 in (case _3766 of {(0,f) -> u f (\_3767 _3768-> (let _3769 = (((_3768::Integer) >= _init_3)) in (if _3769 then (let _name_8=(u bits_concat (u nat_to_bits (u nat_pred (((_depth_2::Integer) - _3768))))) in (u bits_o (u bits_o (u bits_i (u _name_8 _x_5))))) else (let _name_8=(u bits_concat (u nat_to_bits _3768)) in (u bits_o (u bits_i (u bits_o (u _name_8 _x_5)))))))); (1,f) -> u f (\_3770-> (let _name_7=(u bits_concat (u fm_term_serialize_name _3770)) in (u bits_o (u bits_o (u bits_o (u _name_7 _x_5)))))); (2,f) -> u f ((u bits_o (u bits_i (u bits_i _x_5)))); (3,f) -> u f (\_3771 _3772 _3773 _3774 _3775-> (let _eras_11=(let _3776 = _3771 in (if _3776 then bits_i else bits_o)) in (let _self_12=(u bits_concat (u fm_name_to_bits _3772)) in (let _xtyp_13=(u (u (u (u fm_term_serialize _3774) _depth_2) _init_3) _diff_4) in (let _body_14=(u (u (u (u fm_term_serialize (u (u _3775 (u (u fm_term_var _3772) _depth_2)) (u (u fm_term_var _3773) (u nat_succ _depth_2)))) (u nat_succ (u nat_succ _depth_2))) _init_3) _diff_4) in (u bits_i (u bits_o (u bits_o (u _eras_11 (u _self_12 (u _xtyp_13 (u _body_14 _x_5)))))))))))); (4,f) -> u f (\_3777 _3778-> (let _body_8=(u (u (u (u fm_term_serialize (u _3778 (u (u fm_term_var _3777) _depth_2))) (u nat_succ _depth_2)) _init_3) _diff_4) in (u bits_i (u bits_o (u bits_i (u _body_8 _x_5)))))); (5,f) -> u f (\_3779 _3780-> (let _func_8=(u (u (u (u fm_term_serialize _3779) _depth_2) _init_3) _diff_4) in (let _argm_9=(u (u (u (u fm_term_serialize _3780) _depth_2) _init_3) _diff_4) in (u bits_i (u bits_i (u bits_o (u _func_8 (u _argm_9 _x_5)))))))); (6,f) -> u f (\_3781 _3782 _3783-> (let _expr_9=(u (u (u (u fm_term_serialize _3782) _depth_2) _init_3) _diff_4) in (let _body_10=(u (u (u (u fm_term_serialize (u _3783 (u (u fm_term_var _3781) _depth_2))) (u nat_succ _depth_2)) _init_3) _diff_4) in (u bits_i (u bits_i (u bits_i (u _expr_9 (u _body_10 _x_5)))))))); (7,f) -> u f (\_3784 _3785 _3786-> (u (u (u (u (u fm_term_serialize (u _3786 _3785)) _depth_2) _init_3) _diff_4) _x_5)); (8,f) -> u f (\_3787 _3788 _3789-> (u (u (u (u (u fm_term_serialize _3788) _depth_2) _init_3) _diff_4) _x_5)); (9,f) -> u f (\_3790 _3791 _3792-> (let _name_9=(u bits_concat (u fm_name_to_bits _3790)) in (u bits_o (u bits_o (u bits_o (u _name_9 _x_5)))))); (10,f) -> u f (\_3793-> _x_5); (11,f) -> u f (\_3794-> (u (u (u (u (u fm_term_serialize (u fm_term_unroll_nat _3794)) _depth_2) _init_3) _diff_4) _x_5)); (12,f) -> u f (\_3795-> (u (u (u (u (u fm_term_serialize (u fm_term_unroll_chr _3795)) _depth_2) _init_3) _diff_4) _x_5)); (13,f) -> u f (\_3796-> (u (u (u (u (u fm_term_serialize (u fm_term_unroll_str _3796)) _depth_2) _init_3) _diff_4) _x_5)); (14,f) -> u f (\_3797 _3798 _3799 _3800 _3801 _3802-> (u _diff_4 _x_5)); (15,f) -> u f (\_3803 _3804-> (u (u (u (u (u fm_term_serialize _3804) _depth_2) _init_3) _diff_4) _x_5)); })))))))
bits_eql = (\_a_1-> (\_b_2-> (let _3805 = _a_1 in (case _3805 of {(0,f) -> u f ((let _3806 = _b_2 in (case _3806 of {(0,f) -> u f (bool_true); (1,f) -> u f (\_3807-> bool_false); (2,f) -> u f (\_3808-> bool_false); }))); (1,f) -> u f (\_3809-> (let _3810 = _b_2 in (case _3810 of {(0,f) -> u f (bool_false); (1,f) -> u f (\_3811-> (u (u bits_eql _3809) _3811)); (2,f) -> u f (\_3812-> bool_false); }))); (2,f) -> u f (\_3813-> (let _3814 = _b_2 in (case _3814 of {(0,f) -> u f (bool_false); (1,f) -> u f (\_3815-> bool_false); (2,f) -> u f (\_3816-> (u (u bits_eql _3813) _3816)); }))); }))))
fm_term_identical = (\_a_1-> (\_b_2-> (\_lv_3-> (let _ah_4=(u (u (u (u (u fm_term_serialize _a_1) _lv_3) _lv_3) bits_o) bits_e) in (let _bh_5=(u (u (u (u (u fm_term_serialize _b_2) _lv_3) _lv_3) bits_i) bits_e) in (u (u bits_eql _ah_4) _bh_5))))))
fm_smartmotive_replace = (\_term_1-> (\_from_2-> (\_to_3-> (\_lv_4-> (let _3817 = (u (u (u fm_term_identical _term_1) _from_2) _lv_4) in (if _3817 then _to_3 else (let _3818 = _term_1 in (case _3818 of {(0,f) -> u f (\_3819 _3820-> (u (u fm_term_var _3819) _3820)); (1,f) -> u f (\_3821-> (u fm_term_ref _3821)); (2,f) -> u f (fm_term_typ); (3,f) -> u f (\_3822 _3823 _3824 _3825 _3826-> (let _xtyp_10=(u (u (u (u fm_smartmotive_replace _3825) _from_2) _to_3) _lv_4) in (let _body_11=(u (u _3826 (u fm_term_ref _3823)) (u fm_term_ref _3824)) in (let _body_12=(u (u (u (u fm_smartmotive_replace _body_11) _from_2) _to_3) (u nat_succ (u nat_succ _lv_4))) in (u (u (u (u (u fm_term_all _3822) _3823) _3824) _xtyp_10) (\_s_13-> (\_x_14-> _body_12))))))); (4,f) -> u f (\_3827 _3828-> (let _body_7=(u _3828 (u fm_term_ref _3827)) in (let _body_8=(u (u (u (u fm_smartmotive_replace _body_7) _from_2) _to_3) (u nat_succ _lv_4)) in (u (u fm_term_lam _3827) (\_x_9-> _body_8))))); (5,f) -> u f (\_3829 _3830-> (let _func_7=(u (u (u (u fm_smartmotive_replace _3829) _from_2) _to_3) _lv_4) in (let _argm_8=(u (u (u (u fm_smartmotive_replace _3830) _from_2) _to_3) _lv_4) in (u (u fm_term_app _func_7) _argm_8)))); (6,f) -> u f (\_3831 _3832 _3833-> (let _expr_8=(u (u (u (u fm_smartmotive_replace _3832) _from_2) _to_3) _lv_4) in (let _body_9=(u _3833 (u fm_term_ref _3831)) in (let _body_10=(u (u (u (u fm_smartmotive_replace _body_9) _from_2) _to_3) (u nat_succ _lv_4)) in (u (u (u fm_term_let _3831) _expr_8) (\_x_11-> _body_10)))))); (7,f) -> u f (\_3834 _3835 _3836-> (let _expr_8=(u (u (u (u fm_smartmotive_replace _3835) _from_2) _to_3) _lv_4) in (let _body_9=(u _3836 (u fm_term_ref _3834)) in (let _body_10=(u (u (u (u fm_smartmotive_replace _body_9) _from_2) _to_3) (u nat_succ _lv_4)) in (u (u (u fm_term_def _3834) _expr_8) (\_x_11-> _body_10)))))); (8,f) -> u f (\_3837 _3838 _3839-> (let _term_8=(u (u (u (u fm_smartmotive_replace _3838) _from_2) _to_3) _lv_4) in (let _type_9=(u (u (u (u fm_smartmotive_replace _3839) _from_2) _to_3) _lv_4) in (u (u (u fm_term_ann _3837) _term_8) _type_9)))); (9,f) -> u f (\_3840 _3841 _3842-> _term_1); (10,f) -> u f (\_3843-> _term_1); (11,f) -> u f (\_3844-> _term_1); (12,f) -> u f (\_3845-> _term_1); (13,f) -> u f (\_3846-> _term_1); (14,f) -> u f (\_3847 _3848 _3849 _3850 _3851 _3852-> _term_1); (15,f) -> u f (\_3853 _3854-> (u (u (u (u fm_smartmotive_replace _3854) _from_2) _to_3) _lv_4)); }))))))))
fm_smartmotive_make = (\_name_1-> (\_expr_2-> (\_type_3-> (\_moti_4-> (\_lv_5-> (\_defs_6-> (let _vals_7=(u (u (u fm_smartmotive_vals _expr_2) _type_3) _defs_6) in (let _nams_8=(u (u (u fm_smartmotive_nams _name_1) _type_3) _defs_6) in (let _subs_9=(u (u list_zip _nams_8) _vals_7) in (let _moti_10=(u (u (u list_fold _subs_9) _moti_4) (\_sub_10-> (\_moti_11-> (let _3855 = _sub_10 in (case _3855 of {(0,f) -> u f (\_3856 _3857-> (u (u (u (u fm_smartmotive_replace _moti_11) _3857) (u fm_term_ref _3856)) _lv_5)); }))))) in _moti_10))))))))))
fm_term_desugar_cse_motive = (\_wyth_1-> (\_moti_2-> (let _3858 = _wyth_1 in (case _3858 of {(0,f) -> u f (_moti_2); (1,f) -> u f (\_3859 _3860-> (let _3861 = _3859 in (case _3861 of {(0,f) -> u f (\_3862 _3863 _3864 _3865 _3866 _3867-> (u (u (u (u (u fm_term_all bool_false) "") _3864) _3866) (\_s_11-> (\_x_12-> (u (u fm_term_desugar_cse_motive _3860) _moti_2))))); }))); }))))
string_is_empty = (\_str_1-> (let _3868 = _str_1 in (if null (_3868::String) then bool_true else bool_false)))
fm_term_desugar_cse_argument = (\_name_1-> (\_wyth_2-> (\_type_3-> (\_body_4-> (\_defs_5-> (let _3869 = (u (u fm_term_reduce _type_3) _defs_5) in (case _3869 of {(0,f) -> u f (\_3870 _3871-> (let _3872 = _wyth_2 in (case _3872 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_3873 _3874-> (let _3875 = _3873 in (case _3875 of {(0,f) -> u f (\_3876 _3877 _3878 _3879 _3880 _3881-> (u (u fm_term_lam _3878) (\_x_16-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _3874) _type_3) _body_4) _defs_5)))); }))); }))); (1,f) -> u f (\_3882-> (let _3883 = _wyth_2 in (case _3883 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_3884 _3885-> (let _3886 = _3884 in (case _3886 of {(0,f) -> u f (\_3887 _3888 _3889 _3890 _3891 _3892-> (u (u fm_term_lam _3889) (\_x_15-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _3885) _type_3) _body_4) _defs_5)))); }))); }))); (2,f) -> u f ((let _3893 = _wyth_2 in (case _3893 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_3894 _3895-> (let _3896 = _3894 in (case _3896 of {(0,f) -> u f (\_3897 _3898 _3899 _3900 _3901 _3902-> (u (u fm_term_lam _3899) (\_x_14-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _3895) _type_3) _body_4) _defs_5)))); }))); }))); (3,f) -> u f (\_3903 _3904 _3905 _3906 _3907-> (u (u fm_term_lam (let _3908 = (u string_is_empty _3905) in (if _3908 then _name_1 else (u string_flatten (u (u list_cons _name_1) (u (u list_cons ".") (u (u list_cons _3905) list_nil))))))) (\_x_11-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _wyth_2) (u (u _3907 (u (u fm_term_var _3904) 0)) (u (u fm_term_var _3905) 0))) _body_4) _defs_5)))); (4,f) -> u f (\_3909 _3910-> (let _3911 = _wyth_2 in (case _3911 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_3912 _3913-> (let _3914 = _3912 in (case _3914 of {(0,f) -> u f (\_3915 _3916 _3917 _3918 _3919 _3920-> (u (u fm_term_lam _3917) (\_x_16-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _3913) _type_3) _body_4) _defs_5)))); }))); }))); (5,f) -> u f (\_3921 _3922-> (let _3923 = _wyth_2 in (case _3923 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_3924 _3925-> (let _3926 = _3924 in (case _3926 of {(0,f) -> u f (\_3927 _3928 _3929 _3930 _3931 _3932-> (u (u fm_term_lam _3929) (\_x_16-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _3925) _type_3) _body_4) _defs_5)))); }))); }))); (6,f) -> u f (\_3933 _3934 _3935-> (let _3936 = _wyth_2 in (case _3936 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_3937 _3938-> (let _3939 = _3937 in (case _3939 of {(0,f) -> u f (\_3940 _3941 _3942 _3943 _3944 _3945-> (u (u fm_term_lam _3942) (\_x_17-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _3938) _type_3) _body_4) _defs_5)))); }))); }))); (7,f) -> u f (\_3946 _3947 _3948-> (let _3949 = _wyth_2 in (case _3949 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_3950 _3951-> (let _3952 = _3950 in (case _3952 of {(0,f) -> u f (\_3953 _3954 _3955 _3956 _3957 _3958-> (u (u fm_term_lam _3955) (\_x_17-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _3951) _type_3) _body_4) _defs_5)))); }))); }))); (8,f) -> u f (\_3959 _3960 _3961-> (let _3962 = _wyth_2 in (case _3962 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_3963 _3964-> (let _3965 = _3963 in (case _3965 of {(0,f) -> u f (\_3966 _3967 _3968 _3969 _3970 _3971-> (u (u fm_term_lam _3968) (\_x_17-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _3964) _type_3) _body_4) _defs_5)))); }))); }))); (9,f) -> u f (\_3972 _3973 _3974-> (let _3975 = _wyth_2 in (case _3975 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_3976 _3977-> (let _3978 = _3976 in (case _3978 of {(0,f) -> u f (\_3979 _3980 _3981 _3982 _3983 _3984-> (u (u fm_term_lam _3981) (\_x_17-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _3977) _type_3) _body_4) _defs_5)))); }))); }))); (10,f) -> u f (\_3985-> (let _3986 = _wyth_2 in (case _3986 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_3987 _3988-> (let _3989 = _3987 in (case _3989 of {(0,f) -> u f (\_3990 _3991 _3992 _3993 _3994 _3995-> (u (u fm_term_lam _3992) (\_x_15-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _3988) _type_3) _body_4) _defs_5)))); }))); }))); (11,f) -> u f (\_3996-> (let _3997 = _wyth_2 in (case _3997 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_3998 _3999-> (let _4000 = _3998 in (case _4000 of {(0,f) -> u f (\_4001 _4002 _4003 _4004 _4005 _4006-> (u (u fm_term_lam _4003) (\_x_15-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _3999) _type_3) _body_4) _defs_5)))); }))); }))); (12,f) -> u f (\_4007-> (let _4008 = _wyth_2 in (case _4008 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_4009 _4010-> (let _4011 = _4009 in (case _4011 of {(0,f) -> u f (\_4012 _4013 _4014 _4015 _4016 _4017-> (u (u fm_term_lam _4014) (\_x_15-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _4010) _type_3) _body_4) _defs_5)))); }))); }))); (13,f) -> u f (\_4018-> (let _4019 = _wyth_2 in (case _4019 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_4020 _4021-> (let _4022 = _4020 in (case _4022 of {(0,f) -> u f (\_4023 _4024 _4025 _4026 _4027 _4028-> (u (u fm_term_lam _4025) (\_x_15-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _4021) _type_3) _body_4) _defs_5)))); }))); }))); (14,f) -> u f (\_4029 _4030 _4031 _4032 _4033 _4034-> (let _4035 = _wyth_2 in (case _4035 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_4036 _4037-> (let _4038 = _4036 in (case _4038 of {(0,f) -> u f (\_4039 _4040 _4041 _4042 _4043 _4044-> (u (u fm_term_lam _4041) (\_x_20-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _4037) _type_3) _body_4) _defs_5)))); }))); }))); (15,f) -> u f (\_4045 _4046-> (let _4047 = _wyth_2 in (case _4047 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_4048 _4049-> (let _4050 = _4048 in (case _4050 of {(0,f) -> u f (\_4051 _4052 _4053 _4054 _4055 _4056-> (u (u fm_term_lam _4053) (\_x_16-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _4049) _type_3) _body_4) _defs_5)))); }))); }))); })))))))
maybe_or = (\_a_2-> (\_b_3-> (let _4057 = _a_2 in (case _4057 of {(0,f) -> u f (_b_3); (1,f) -> u f (\_4058-> (u maybe_some _4058)); }))))
fm_term_desugar_cse_cases = (\_expr_1-> (\_name_2-> (\_wyth_3-> (\_cses_4-> (\_type_5-> (\_defs_6-> (\_ctxt_7-> (let _4059 = (u (u fm_term_reduce _type_5) _defs_6) in (case _4059 of {(0,f) -> u f (\_4060 _4061-> (let _expr_10=(u (u (u list_for _wyth_3) _expr_1) (\_defn_10-> (\_expr_11-> (u (u fm_term_app _expr_11) (let _4062 = _defn_10 in (case _4062 of {(0,f) -> u f (\_4063 _4064 _4065 _4066 _4067 _4068-> _4066); })))))) in _expr_10)); (1,f) -> u f (\_4069-> (let _expr_9=(u (u (u list_for _wyth_3) _expr_1) (\_defn_9-> (\_expr_10-> (u (u fm_term_app _expr_10) (let _4070 = _defn_9 in (case _4070 of {(0,f) -> u f (\_4071 _4072 _4073 _4074 _4075 _4076-> _4074); })))))) in _expr_9)); (2,f) -> u f ((let _expr_8=(u (u (u list_for _wyth_3) _expr_1) (\_defn_8-> (\_expr_9-> (u (u fm_term_app _expr_9) (let _4077 = _defn_8 in (case _4077 of {(0,f) -> u f (\_4078 _4079 _4080 _4081 _4082 _4083-> _4081); })))))) in _expr_8)); (3,f) -> u f (\_4084 _4085 _4086 _4087 _4088-> (let _got_13=(u (u maybe_or (u (u fm_get _4086) _cses_4)) (u (u fm_get "_") _cses_4)) in (let _4089 = _got_13 in (case _4089 of {(0,f) -> u f ((let _expr_14=(u (u (u list_for _wyth_3) _expr_1) (\_defn_14-> (\_expr_15-> (let _4090 = _defn_14 in (case _4090 of {(0,f) -> u f (\_4091 _4092 _4093 _4094 _4095 _4096-> (u (u fm_term_app _expr_15) _4094)); }))))) in _expr_14)); (1,f) -> u f (\_4097-> (let _argm_15=(u (u (u (u (u fm_term_desugar_cse_argument _name_2) _wyth_3) _4087) _4097) _defs_6) in (let _expr_16=(u (u fm_term_app _expr_1) _argm_15) in (let _type_17=(u (u _4088 (u (u fm_term_var _4085) 0)) (u (u fm_term_var _4086) 0)) in (u (u (u (u (u (u (u fm_term_desugar_cse_cases _expr_16) _name_2) _wyth_3) _cses_4) _type_17) _defs_6) _ctxt_7))))); })))); (4,f) -> u f (\_4098 _4099-> (let _expr_10=(u (u (u list_for _wyth_3) _expr_1) (\_defn_10-> (\_expr_11-> (u (u fm_term_app _expr_11) (let _4100 = _defn_10 in (case _4100 of {(0,f) -> u f (\_4101 _4102 _4103 _4104 _4105 _4106-> _4104); })))))) in _expr_10)); (5,f) -> u f (\_4107 _4108-> (let _expr_10=(u (u (u list_for _wyth_3) _expr_1) (\_defn_10-> (\_expr_11-> (u (u fm_term_app _expr_11) (let _4109 = _defn_10 in (case _4109 of {(0,f) -> u f (\_4110 _4111 _4112 _4113 _4114 _4115-> _4113); })))))) in _expr_10)); (6,f) -> u f (\_4116 _4117 _4118-> (let _expr_11=(u (u (u list_for _wyth_3) _expr_1) (\_defn_11-> (\_expr_12-> (u (u fm_term_app _expr_12) (let _4119 = _defn_11 in (case _4119 of {(0,f) -> u f (\_4120 _4121 _4122 _4123 _4124 _4125-> _4123); })))))) in _expr_11)); (7,f) -> u f (\_4126 _4127 _4128-> (let _expr_11=(u (u (u list_for _wyth_3) _expr_1) (\_defn_11-> (\_expr_12-> (u (u fm_term_app _expr_12) (let _4129 = _defn_11 in (case _4129 of {(0,f) -> u f (\_4130 _4131 _4132 _4133 _4134 _4135-> _4133); })))))) in _expr_11)); (8,f) -> u f (\_4136 _4137 _4138-> (let _expr_11=(u (u (u list_for _wyth_3) _expr_1) (\_defn_11-> (\_expr_12-> (u (u fm_term_app _expr_12) (let _4139 = _defn_11 in (case _4139 of {(0,f) -> u f (\_4140 _4141 _4142 _4143 _4144 _4145-> _4143); })))))) in _expr_11)); (9,f) -> u f (\_4146 _4147 _4148-> (let _expr_11=(u (u (u list_for _wyth_3) _expr_1) (\_defn_11-> (\_expr_12-> (u (u fm_term_app _expr_12) (let _4149 = _defn_11 in (case _4149 of {(0,f) -> u f (\_4150 _4151 _4152 _4153 _4154 _4155-> _4153); })))))) in _expr_11)); (10,f) -> u f (\_4156-> (let _expr_9=(u (u (u list_for _wyth_3) _expr_1) (\_defn_9-> (\_expr_10-> (u (u fm_term_app _expr_10) (let _4157 = _defn_9 in (case _4157 of {(0,f) -> u f (\_4158 _4159 _4160 _4161 _4162 _4163-> _4161); })))))) in _expr_9)); (11,f) -> u f (\_4164-> (let _expr_9=(u (u (u list_for _wyth_3) _expr_1) (\_defn_9-> (\_expr_10-> (u (u fm_term_app _expr_10) (let _4165 = _defn_9 in (case _4165 of {(0,f) -> u f (\_4166 _4167 _4168 _4169 _4170 _4171-> _4169); })))))) in _expr_9)); (12,f) -> u f (\_4172-> (let _expr_9=(u (u (u list_for _wyth_3) _expr_1) (\_defn_9-> (\_expr_10-> (u (u fm_term_app _expr_10) (let _4173 = _defn_9 in (case _4173 of {(0,f) -> u f (\_4174 _4175 _4176 _4177 _4178 _4179-> _4177); })))))) in _expr_9)); (13,f) -> u f (\_4180-> (let _expr_9=(u (u (u list_for _wyth_3) _expr_1) (\_defn_9-> (\_expr_10-> (u (u fm_term_app _expr_10) (let _4181 = _defn_9 in (case _4181 of {(0,f) -> u f (\_4182 _4183 _4184 _4185 _4186 _4187-> _4185); })))))) in _expr_9)); (14,f) -> u f (\_4188 _4189 _4190 _4191 _4192 _4193-> (let _expr_14=(u (u (u list_for _wyth_3) _expr_1) (\_defn_14-> (\_expr_15-> (u (u fm_term_app _expr_15) (let _4194 = _defn_14 in (case _4194 of {(0,f) -> u f (\_4195 _4196 _4197 _4198 _4199 _4200-> _4198); })))))) in _expr_14)); (15,f) -> u f (\_4201 _4202-> (let _expr_10=(u (u (u list_for _wyth_3) _expr_1) (\_defn_10-> (\_expr_11-> (u (u fm_term_app _expr_11) (let _4203 = _defn_10 in (case _4203 of {(0,f) -> u f (\_4204 _4205 _4206 _4207 _4208 _4209-> _4207); })))))) in _expr_10)); })))))))))
fm_term_desugar_cse = (\_expr_1-> (\_name_2-> (\_with_3-> (\_cses_4-> (\_moti_5-> (\_type_6-> (\_defs_7-> (\_ctxt_8-> (let _4210 = (u (u fm_term_reduce _type_6) _defs_7) in (case _4210 of {(0,f) -> u f (\_4211 _4212-> maybe_none); (1,f) -> u f (\_4213-> maybe_none); (2,f) -> u f (maybe_none); (3,f) -> u f (\_4214 _4215 _4216 _4217 _4218-> (let _moti_14=(u (u fm_term_desugar_cse_motive _with_3) _moti_5) in (let _argm_15=(u (u (u (u (u fm_term_desugar_cse_argument _name_2) list_nil) _4217) _moti_14) _defs_7) in (let _expr_16=(u (u fm_term_app _expr_1) _argm_15) in (let _type_17=(u (u _4218 (u (u fm_term_var _4215) 0)) (u (u fm_term_var _4216) 0)) in (u maybe_some (u (u (u (u (u (u (u fm_term_desugar_cse_cases _expr_16) _name_2) _with_3) _cses_4) _type_17) _defs_7) _ctxt_8))))))); (4,f) -> u f (\_4219 _4220-> maybe_none); (5,f) -> u f (\_4221 _4222-> maybe_none); (6,f) -> u f (\_4223 _4224 _4225-> maybe_none); (7,f) -> u f (\_4226 _4227 _4228-> maybe_none); (8,f) -> u f (\_4229 _4230 _4231-> maybe_none); (9,f) -> u f (\_4232 _4233 _4234-> maybe_none); (10,f) -> u f (\_4235-> maybe_none); (11,f) -> u f (\_4236-> maybe_none); (12,f) -> u f (\_4237-> maybe_none); (13,f) -> u f (\_4238-> maybe_none); (14,f) -> u f (\_4239 _4240 _4241 _4242 _4243 _4244-> maybe_none); (15,f) -> u f (\_4245 _4246-> maybe_none); }))))))))))
fm_error_cant_infer = (\_origin_1-> (\_term_2-> (\_context_3-> (6,\t-> t _origin_1 _term_2 _context_3))))
set_has = (\_bits_1-> (\_set_2-> (let _4247 = (u (u map_get _bits_1) _set_2) in (case _4247 of {(0,f) -> u f (bool_false); (1,f) -> u f (\_4248-> bool_true); }))))
bool_or = (\a0-> \a1-> (a0 || a1))
fm_term_has_holes = (\_term_1-> (let _4249 = _term_1 in (case _4249 of {(0,f) -> u f (\_4250 _4251-> bool_false); (1,f) -> u f (\_4252-> bool_false); (2,f) -> u f (bool_false); (3,f) -> u f (\_4253 _4254 _4255 _4256 _4257-> (((u fm_term_has_holes _4256) || (u fm_term_has_holes (u (u _4257 fm_term_typ) fm_term_typ))))); (4,f) -> u f (\_4258 _4259-> (u fm_term_has_holes (u _4259 fm_term_typ))); (5,f) -> u f (\_4260 _4261-> (((u fm_term_has_holes _4260) || (u fm_term_has_holes _4261)))); (6,f) -> u f (\_4262 _4263 _4264-> (((u fm_term_has_holes _4263) || (u fm_term_has_holes (u _4264 fm_term_typ))))); (7,f) -> u f (\_4265 _4266 _4267-> (((u fm_term_has_holes _4266) || (u fm_term_has_holes (u _4267 fm_term_typ))))); (8,f) -> u f (\_4268 _4269 _4270-> (((u fm_term_has_holes _4269) || (u fm_term_has_holes _4270)))); (9,f) -> u f (\_4271 _4272 _4273-> bool_false); (10,f) -> u f (\_4274-> bool_true); (11,f) -> u f (\_4275-> bool_false); (12,f) -> u f (\_4276-> bool_false); (13,f) -> u f (\_4277-> bool_false); (14,f) -> u f (\_4278 _4279 _4280 _4281 _4282 _4283-> bool_false); (15,f) -> u f (\_4284 _4285-> (u fm_term_has_holes _4285)); })))
fm_term_equal_hole = (\_path_1-> (\_term_2-> (let _4286 = _term_2 in (case _4286 of {(0,f) -> u f (\_4287 _4288-> (let _4289 = (u fm_term_has_holes _term_2) in (if _4289 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); (1,f) -> u f (\_4290-> (let _4291 = (u fm_term_has_holes _term_2) in (if _4291 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); (2,f) -> u f ((let _4292 = (u fm_term_has_holes _term_2) in (if _4292 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); (3,f) -> u f (\_4293 _4294 _4295 _4296 _4297-> (let _4298 = (u fm_term_has_holes _term_2) in (if _4298 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); (4,f) -> u f (\_4299 _4300-> (let _4301 = (u fm_term_has_holes _term_2) in (if _4301 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); (5,f) -> u f (\_4302 _4303-> (let _4304 = (u fm_term_has_holes _term_2) in (if _4304 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); (6,f) -> u f (\_4305 _4306 _4307-> (let _4308 = (u fm_term_has_holes _term_2) in (if _4308 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); (7,f) -> u f (\_4309 _4310 _4311-> (let _4312 = (u fm_term_has_holes _term_2) in (if _4312 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); (8,f) -> u f (\_4313 _4314 _4315-> (let _4316 = (u fm_term_has_holes _term_2) in (if _4316 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); (9,f) -> u f (\_4317 _4318 _4319-> (let _4320 = (u fm_term_has_holes _term_2) in (if _4320 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); (10,f) -> u f (\_4321-> (u (u fm_check_result (u maybe_some bool_true)) list_nil)); (11,f) -> u f (\_4322-> (let _4323 = (u fm_term_has_holes _term_2) in (if _4323 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); (12,f) -> u f (\_4324-> (let _4325 = (u fm_term_has_holes _term_2) in (if _4325 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); (13,f) -> u f (\_4326-> (let _4327 = (u fm_term_has_holes _term_2) in (if _4327 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); (14,f) -> u f (\_4328 _4329 _4330 _4331 _4332 _4333-> (let _4334 = (u fm_term_has_holes _term_2) in (if _4334 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); (15,f) -> u f (\_4335 _4336-> (let _4337 = (u fm_term_has_holes _term_2) in (if _4337 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); }))))
fm_term_equal_extra_holes = (\_a_1-> (\_b_2-> (let _4338 = _a_1 in (case _4338 of {(0,f) -> u f (\_4339 _4340-> (let _4341 = _b_2 in (case _4341 of {(0,f) -> u f (\_4342 _4343-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (1,f) -> u f (\_4344-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some unit_new)) list_nil)); (3,f) -> u f (\_4345 _4346 _4347 _4348 _4349-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (4,f) -> u f (\_4350 _4351-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (5,f) -> u f (\_4352 _4353-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (6,f) -> u f (\_4354 _4355 _4356-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (7,f) -> u f (\_4357 _4358 _4359-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (8,f) -> u f (\_4360 _4361 _4362-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (9,f) -> u f (\_4363 _4364 _4365-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (10,f) -> u f (\_4366-> (let _4367 = (u (u fm_term_equal_hole _4366) _a_1) in (case _4367 of {(0,f) -> u f (\_4368 _4369-> (let _4370 = _4368 in (case _4370 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _4369)); (1,f) -> u f (\_4371-> (let _4372 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _4372 of {(0,f) -> u f (\_4373 _4374-> (u (u fm_check_result _4373) (u (u list_concat _4369) _4374))); }))); }))); }))); (11,f) -> u f (\_4375-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (12,f) -> u f (\_4376-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (13,f) -> u f (\_4377-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (14,f) -> u f (\_4378 _4379 _4380 _4381 _4382 _4383-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (15,f) -> u f (\_4384 _4385-> (u (u fm_term_equal_extra_holes _a_1) _4385)); }))); (1,f) -> u f (\_4386-> (let _4387 = _b_2 in (case _4387 of {(0,f) -> u f (\_4388 _4389-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (1,f) -> u f (\_4390-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some unit_new)) list_nil)); (3,f) -> u f (\_4391 _4392 _4393 _4394 _4395-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (4,f) -> u f (\_4396 _4397-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (5,f) -> u f (\_4398 _4399-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (6,f) -> u f (\_4400 _4401 _4402-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (7,f) -> u f (\_4403 _4404 _4405-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (8,f) -> u f (\_4406 _4407 _4408-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (9,f) -> u f (\_4409 _4410 _4411-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (10,f) -> u f (\_4412-> (let _4413 = (u (u fm_term_equal_hole _4412) _a_1) in (case _4413 of {(0,f) -> u f (\_4414 _4415-> (let _4416 = _4414 in (case _4416 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _4415)); (1,f) -> u f (\_4417-> (let _4418 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _4418 of {(0,f) -> u f (\_4419 _4420-> (u (u fm_check_result _4419) (u (u list_concat _4415) _4420))); }))); }))); }))); (11,f) -> u f (\_4421-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (12,f) -> u f (\_4422-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (13,f) -> u f (\_4423-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (14,f) -> u f (\_4424 _4425 _4426 _4427 _4428 _4429-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (15,f) -> u f (\_4430 _4431-> (u (u fm_term_equal_extra_holes _a_1) _4431)); }))); (2,f) -> u f ((let _4432 = _b_2 in (case _4432 of {(0,f) -> u f (\_4433 _4434-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (1,f) -> u f (\_4435-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some unit_new)) list_nil)); (3,f) -> u f (\_4436 _4437 _4438 _4439 _4440-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (4,f) -> u f (\_4441 _4442-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (5,f) -> u f (\_4443 _4444-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (6,f) -> u f (\_4445 _4446 _4447-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (7,f) -> u f (\_4448 _4449 _4450-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (8,f) -> u f (\_4451 _4452 _4453-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (9,f) -> u f (\_4454 _4455 _4456-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (10,f) -> u f (\_4457-> (let _4458 = (u (u fm_term_equal_hole _4457) _a_1) in (case _4458 of {(0,f) -> u f (\_4459 _4460-> (let _4461 = _4459 in (case _4461 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _4460)); (1,f) -> u f (\_4462-> (let _4463 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _4463 of {(0,f) -> u f (\_4464 _4465-> (u (u fm_check_result _4464) (u (u list_concat _4460) _4465))); }))); }))); }))); (11,f) -> u f (\_4466-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (12,f) -> u f (\_4467-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (13,f) -> u f (\_4468-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (14,f) -> u f (\_4469 _4470 _4471 _4472 _4473 _4474-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (15,f) -> u f (\_4475 _4476-> (u (u fm_term_equal_extra_holes _a_1) _4476)); }))); (3,f) -> u f (\_4477 _4478 _4479 _4480 _4481-> (let _4482 = _b_2 in (case _4482 of {(0,f) -> u f (\_4483 _4484-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (1,f) -> u f (\_4485-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some unit_new)) list_nil)); (3,f) -> u f (\_4486 _4487 _4488 _4489 _4490-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (4,f) -> u f (\_4491 _4492-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (5,f) -> u f (\_4493 _4494-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (6,f) -> u f (\_4495 _4496 _4497-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (7,f) -> u f (\_4498 _4499 _4500-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (8,f) -> u f (\_4501 _4502 _4503-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (9,f) -> u f (\_4504 _4505 _4506-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (10,f) -> u f (\_4507-> (let _4508 = (u (u fm_term_equal_hole _4507) _a_1) in (case _4508 of {(0,f) -> u f (\_4509 _4510-> (let _4511 = _4509 in (case _4511 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _4510)); (1,f) -> u f (\_4512-> (let _4513 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _4513 of {(0,f) -> u f (\_4514 _4515-> (u (u fm_check_result _4514) (u (u list_concat _4510) _4515))); }))); }))); }))); (11,f) -> u f (\_4516-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (12,f) -> u f (\_4517-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (13,f) -> u f (\_4518-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (14,f) -> u f (\_4519 _4520 _4521 _4522 _4523 _4524-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (15,f) -> u f (\_4525 _4526-> (u (u fm_term_equal_extra_holes _a_1) _4526)); }))); (4,f) -> u f (\_4527 _4528-> (let _4529 = _b_2 in (case _4529 of {(0,f) -> u f (\_4530 _4531-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (1,f) -> u f (\_4532-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some unit_new)) list_nil)); (3,f) -> u f (\_4533 _4534 _4535 _4536 _4537-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (4,f) -> u f (\_4538 _4539-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (5,f) -> u f (\_4540 _4541-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (6,f) -> u f (\_4542 _4543 _4544-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (7,f) -> u f (\_4545 _4546 _4547-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (8,f) -> u f (\_4548 _4549 _4550-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (9,f) -> u f (\_4551 _4552 _4553-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (10,f) -> u f (\_4554-> (let _4555 = (u (u fm_term_equal_hole _4554) _a_1) in (case _4555 of {(0,f) -> u f (\_4556 _4557-> (let _4558 = _4556 in (case _4558 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _4557)); (1,f) -> u f (\_4559-> (let _4560 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _4560 of {(0,f) -> u f (\_4561 _4562-> (u (u fm_check_result _4561) (u (u list_concat _4557) _4562))); }))); }))); }))); (11,f) -> u f (\_4563-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (12,f) -> u f (\_4564-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (13,f) -> u f (\_4565-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (14,f) -> u f (\_4566 _4567 _4568 _4569 _4570 _4571-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (15,f) -> u f (\_4572 _4573-> (u (u fm_term_equal_extra_holes _a_1) _4573)); }))); (5,f) -> u f (\_4574 _4575-> (let _4576 = _b_2 in (case _4576 of {(0,f) -> u f (\_4577 _4578-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (1,f) -> u f (\_4579-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some unit_new)) list_nil)); (3,f) -> u f (\_4580 _4581 _4582 _4583 _4584-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (4,f) -> u f (\_4585 _4586-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (5,f) -> u f (\_4587 _4588-> (let _4589 = (u (u fm_term_equal_extra_holes _4574) _4587) in (case _4589 of {(0,f) -> u f (\_4590 _4591-> (let _4592 = _4590 in (case _4592 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _4591)); (1,f) -> u f (\_4593-> (let _4594 = (u (u fm_term_equal_extra_holes _4575) _4588) in (case _4594 of {(0,f) -> u f (\_4595 _4596-> (u (u fm_check_result _4595) (u (u list_concat _4591) _4596))); }))); }))); }))); (6,f) -> u f (\_4597 _4598 _4599-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (7,f) -> u f (\_4600 _4601 _4602-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (8,f) -> u f (\_4603 _4604 _4605-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (9,f) -> u f (\_4606 _4607 _4608-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (10,f) -> u f (\_4609-> (let _4610 = (u (u fm_term_equal_hole _4609) _a_1) in (case _4610 of {(0,f) -> u f (\_4611 _4612-> (let _4613 = _4611 in (case _4613 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _4612)); (1,f) -> u f (\_4614-> (let _4615 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _4615 of {(0,f) -> u f (\_4616 _4617-> (u (u fm_check_result _4616) (u (u list_concat _4612) _4617))); }))); }))); }))); (11,f) -> u f (\_4618-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (12,f) -> u f (\_4619-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (13,f) -> u f (\_4620-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (14,f) -> u f (\_4621 _4622 _4623 _4624 _4625 _4626-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (15,f) -> u f (\_4627 _4628-> (u (u fm_term_equal_extra_holes _a_1) _4628)); }))); (6,f) -> u f (\_4629 _4630 _4631-> (let _4632 = _b_2 in (case _4632 of {(0,f) -> u f (\_4633 _4634-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (1,f) -> u f (\_4635-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some unit_new)) list_nil)); (3,f) -> u f (\_4636 _4637 _4638 _4639 _4640-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (4,f) -> u f (\_4641 _4642-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (5,f) -> u f (\_4643 _4644-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (6,f) -> u f (\_4645 _4646 _4647-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (7,f) -> u f (\_4648 _4649 _4650-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (8,f) -> u f (\_4651 _4652 _4653-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (9,f) -> u f (\_4654 _4655 _4656-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (10,f) -> u f (\_4657-> (let _4658 = (u (u fm_term_equal_hole _4657) _a_1) in (case _4658 of {(0,f) -> u f (\_4659 _4660-> (let _4661 = _4659 in (case _4661 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _4660)); (1,f) -> u f (\_4662-> (let _4663 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _4663 of {(0,f) -> u f (\_4664 _4665-> (u (u fm_check_result _4664) (u (u list_concat _4660) _4665))); }))); }))); }))); (11,f) -> u f (\_4666-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (12,f) -> u f (\_4667-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (13,f) -> u f (\_4668-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (14,f) -> u f (\_4669 _4670 _4671 _4672 _4673 _4674-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (15,f) -> u f (\_4675 _4676-> (u (u fm_term_equal_extra_holes _a_1) _4676)); }))); (7,f) -> u f (\_4677 _4678 _4679-> (let _4680 = _b_2 in (case _4680 of {(0,f) -> u f (\_4681 _4682-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (1,f) -> u f (\_4683-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some unit_new)) list_nil)); (3,f) -> u f (\_4684 _4685 _4686 _4687 _4688-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (4,f) -> u f (\_4689 _4690-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (5,f) -> u f (\_4691 _4692-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (6,f) -> u f (\_4693 _4694 _4695-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (7,f) -> u f (\_4696 _4697 _4698-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (8,f) -> u f (\_4699 _4700 _4701-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (9,f) -> u f (\_4702 _4703 _4704-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (10,f) -> u f (\_4705-> (let _4706 = (u (u fm_term_equal_hole _4705) _a_1) in (case _4706 of {(0,f) -> u f (\_4707 _4708-> (let _4709 = _4707 in (case _4709 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _4708)); (1,f) -> u f (\_4710-> (let _4711 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _4711 of {(0,f) -> u f (\_4712 _4713-> (u (u fm_check_result _4712) (u (u list_concat _4708) _4713))); }))); }))); }))); (11,f) -> u f (\_4714-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (12,f) -> u f (\_4715-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (13,f) -> u f (\_4716-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (14,f) -> u f (\_4717 _4718 _4719 _4720 _4721 _4722-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (15,f) -> u f (\_4723 _4724-> (u (u fm_term_equal_extra_holes _a_1) _4724)); }))); (8,f) -> u f (\_4725 _4726 _4727-> (let _4728 = _b_2 in (case _4728 of {(0,f) -> u f (\_4729 _4730-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (1,f) -> u f (\_4731-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some unit_new)) list_nil)); (3,f) -> u f (\_4732 _4733 _4734 _4735 _4736-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (4,f) -> u f (\_4737 _4738-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (5,f) -> u f (\_4739 _4740-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (6,f) -> u f (\_4741 _4742 _4743-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (7,f) -> u f (\_4744 _4745 _4746-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (8,f) -> u f (\_4747 _4748 _4749-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (9,f) -> u f (\_4750 _4751 _4752-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (10,f) -> u f (\_4753-> (let _4754 = (u (u fm_term_equal_hole _4753) _a_1) in (case _4754 of {(0,f) -> u f (\_4755 _4756-> (let _4757 = _4755 in (case _4757 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _4756)); (1,f) -> u f (\_4758-> (let _4759 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _4759 of {(0,f) -> u f (\_4760 _4761-> (u (u fm_check_result _4760) (u (u list_concat _4756) _4761))); }))); }))); }))); (11,f) -> u f (\_4762-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (12,f) -> u f (\_4763-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (13,f) -> u f (\_4764-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (14,f) -> u f (\_4765 _4766 _4767 _4768 _4769 _4770-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (15,f) -> u f (\_4771 _4772-> (u (u fm_term_equal_extra_holes _a_1) _4772)); }))); (9,f) -> u f (\_4773 _4774 _4775-> (let _4776 = _b_2 in (case _4776 of {(0,f) -> u f (\_4777 _4778-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (1,f) -> u f (\_4779-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some unit_new)) list_nil)); (3,f) -> u f (\_4780 _4781 _4782 _4783 _4784-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (4,f) -> u f (\_4785 _4786-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (5,f) -> u f (\_4787 _4788-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (6,f) -> u f (\_4789 _4790 _4791-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (7,f) -> u f (\_4792 _4793 _4794-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (8,f) -> u f (\_4795 _4796 _4797-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (9,f) -> u f (\_4798 _4799 _4800-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (10,f) -> u f (\_4801-> (let _4802 = (u (u fm_term_equal_hole _4801) _a_1) in (case _4802 of {(0,f) -> u f (\_4803 _4804-> (let _4805 = _4803 in (case _4805 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _4804)); (1,f) -> u f (\_4806-> (let _4807 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _4807 of {(0,f) -> u f (\_4808 _4809-> (u (u fm_check_result _4808) (u (u list_concat _4804) _4809))); }))); }))); }))); (11,f) -> u f (\_4810-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (12,f) -> u f (\_4811-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (13,f) -> u f (\_4812-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (14,f) -> u f (\_4813 _4814 _4815 _4816 _4817 _4818-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (15,f) -> u f (\_4819 _4820-> (u (u fm_term_equal_extra_holes _a_1) _4820)); }))); (10,f) -> u f (\_4821-> (let _4822 = (u (u fm_term_equal_hole _4821) _b_2) in (case _4822 of {(0,f) -> u f (\_4823 _4824-> (let _4825 = _4823 in (case _4825 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _4824)); (1,f) -> u f (\_4826-> (let _4827 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _4827 of {(0,f) -> u f (\_4828 _4829-> (u (u fm_check_result _4828) (u (u list_concat _4824) _4829))); }))); }))); }))); (11,f) -> u f (\_4830-> (let _4831 = _b_2 in (case _4831 of {(0,f) -> u f (\_4832 _4833-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (1,f) -> u f (\_4834-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some unit_new)) list_nil)); (3,f) -> u f (\_4835 _4836 _4837 _4838 _4839-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (4,f) -> u f (\_4840 _4841-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (5,f) -> u f (\_4842 _4843-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (6,f) -> u f (\_4844 _4845 _4846-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (7,f) -> u f (\_4847 _4848 _4849-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (8,f) -> u f (\_4850 _4851 _4852-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (9,f) -> u f (\_4853 _4854 _4855-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (10,f) -> u f (\_4856-> (let _4857 = (u (u fm_term_equal_hole _4856) _a_1) in (case _4857 of {(0,f) -> u f (\_4858 _4859-> (let _4860 = _4858 in (case _4860 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _4859)); (1,f) -> u f (\_4861-> (let _4862 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _4862 of {(0,f) -> u f (\_4863 _4864-> (u (u fm_check_result _4863) (u (u list_concat _4859) _4864))); }))); }))); }))); (11,f) -> u f (\_4865-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (12,f) -> u f (\_4866-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (13,f) -> u f (\_4867-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (14,f) -> u f (\_4868 _4869 _4870 _4871 _4872 _4873-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (15,f) -> u f (\_4874 _4875-> (u (u fm_term_equal_extra_holes _a_1) _4875)); }))); (12,f) -> u f (\_4876-> (let _4877 = _b_2 in (case _4877 of {(0,f) -> u f (\_4878 _4879-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (1,f) -> u f (\_4880-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some unit_new)) list_nil)); (3,f) -> u f (\_4881 _4882 _4883 _4884 _4885-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (4,f) -> u f (\_4886 _4887-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (5,f) -> u f (\_4888 _4889-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (6,f) -> u f (\_4890 _4891 _4892-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (7,f) -> u f (\_4893 _4894 _4895-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (8,f) -> u f (\_4896 _4897 _4898-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (9,f) -> u f (\_4899 _4900 _4901-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (10,f) -> u f (\_4902-> (let _4903 = (u (u fm_term_equal_hole _4902) _a_1) in (case _4903 of {(0,f) -> u f (\_4904 _4905-> (let _4906 = _4904 in (case _4906 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _4905)); (1,f) -> u f (\_4907-> (let _4908 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _4908 of {(0,f) -> u f (\_4909 _4910-> (u (u fm_check_result _4909) (u (u list_concat _4905) _4910))); }))); }))); }))); (11,f) -> u f (\_4911-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (12,f) -> u f (\_4912-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (13,f) -> u f (\_4913-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (14,f) -> u f (\_4914 _4915 _4916 _4917 _4918 _4919-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (15,f) -> u f (\_4920 _4921-> (u (u fm_term_equal_extra_holes _a_1) _4921)); }))); (13,f) -> u f (\_4922-> (let _4923 = _b_2 in (case _4923 of {(0,f) -> u f (\_4924 _4925-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (1,f) -> u f (\_4926-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some unit_new)) list_nil)); (3,f) -> u f (\_4927 _4928 _4929 _4930 _4931-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (4,f) -> u f (\_4932 _4933-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (5,f) -> u f (\_4934 _4935-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (6,f) -> u f (\_4936 _4937 _4938-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (7,f) -> u f (\_4939 _4940 _4941-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (8,f) -> u f (\_4942 _4943 _4944-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (9,f) -> u f (\_4945 _4946 _4947-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (10,f) -> u f (\_4948-> (let _4949 = (u (u fm_term_equal_hole _4948) _a_1) in (case _4949 of {(0,f) -> u f (\_4950 _4951-> (let _4952 = _4950 in (case _4952 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _4951)); (1,f) -> u f (\_4953-> (let _4954 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _4954 of {(0,f) -> u f (\_4955 _4956-> (u (u fm_check_result _4955) (u (u list_concat _4951) _4956))); }))); }))); }))); (11,f) -> u f (\_4957-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (12,f) -> u f (\_4958-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (13,f) -> u f (\_4959-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (14,f) -> u f (\_4960 _4961 _4962 _4963 _4964 _4965-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (15,f) -> u f (\_4966 _4967-> (u (u fm_term_equal_extra_holes _a_1) _4967)); }))); (14,f) -> u f (\_4968 _4969 _4970 _4971 _4972 _4973-> (let _4974 = _b_2 in (case _4974 of {(0,f) -> u f (\_4975 _4976-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (1,f) -> u f (\_4977-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some unit_new)) list_nil)); (3,f) -> u f (\_4978 _4979 _4980 _4981 _4982-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (4,f) -> u f (\_4983 _4984-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (5,f) -> u f (\_4985 _4986-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (6,f) -> u f (\_4987 _4988 _4989-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (7,f) -> u f (\_4990 _4991 _4992-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (8,f) -> u f (\_4993 _4994 _4995-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (9,f) -> u f (\_4996 _4997 _4998-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (10,f) -> u f (\_4999-> (let _5000 = (u (u fm_term_equal_hole _4999) _a_1) in (case _5000 of {(0,f) -> u f (\_5001 _5002-> (let _5003 = _5001 in (case _5003 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5002)); (1,f) -> u f (\_5004-> (let _5005 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _5005 of {(0,f) -> u f (\_5006 _5007-> (u (u fm_check_result _5006) (u (u list_concat _5002) _5007))); }))); }))); }))); (11,f) -> u f (\_5008-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (12,f) -> u f (\_5009-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (13,f) -> u f (\_5010-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (14,f) -> u f (\_5011 _5012 _5013 _5014 _5015 _5016-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (15,f) -> u f (\_5017 _5018-> (u (u fm_term_equal_extra_holes _a_1) _5018)); }))); (15,f) -> u f (\_5019 _5020-> (u (u fm_term_equal_extra_holes _5020) _b_2)); }))))
set_set = (\_bits_1-> (\_set_2-> (u (u (u map_set _bits_1) unit_new) _set_2)))
bool_eql = (\_a_1-> (\_b_2-> (let _5021 = _a_1 in (if _5021 then _b_2 else ((not _b_2))))))
fm_term_equal = (\_a_1-> (\_b_2-> (\_defs_3-> (\_lv_4-> (\_seen_5-> (let _ah_6=(u (u (u (u (u fm_term_serialize (u (u fm_term_reduce _a_1) map_new)) _lv_4) _lv_4) bits_o) bits_e) in (let _bh_7=(u (u (u (u (u fm_term_serialize (u (u fm_term_reduce _b_2) map_new)) _lv_4) _lv_4) bits_i) bits_e) in (let _5022 = (u (u bits_eql _ah_6) _bh_7) in (if _5022 then (u (u fm_check_result (u maybe_some bool_true)) list_nil) else (let _a1_8=(u (u fm_term_reduce _a_1) _defs_3) in (let _b1_9=(u (u fm_term_reduce _b_2) _defs_3) in (let _ah_10=(u (u (u (u (u fm_term_serialize _a1_8) _lv_4) _lv_4) bits_o) bits_e) in (let _bh_11=(u (u (u (u (u fm_term_serialize _b1_9) _lv_4) _lv_4) bits_i) bits_e) in (let _5023 = (u (u bits_eql _ah_10) _bh_11) in (if _5023 then (u (u fm_check_result (u maybe_some bool_true)) list_nil) else (let _id_12=(u (u bits_concat _ah_10) _bh_11) in (let _5024 = (u (u set_has _id_12) _seen_5) in (if _5024 then (let _5025 = (u (u fm_term_equal_extra_holes _a_1) _b_2) in (case _5025 of {(0,f) -> u f (\_5026 _5027-> (let _5028 = _5026 in (case _5028 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5027)); (1,f) -> u f (\_5029-> (let _5030 = (u (u fm_check_result (u maybe_some bool_true)) list_nil) in (case _5030 of {(0,f) -> u f (\_5031 _5032-> (u (u fm_check_result _5031) (u (u list_concat _5027) _5032))); }))); }))); })) else (let _5033 = _a1_8 in (case _5033 of {(0,f) -> u f (\_5034 _5035-> (let _5036 = _b1_9 in (case _5036 of {(0,f) -> u f (\_5037 _5038-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5039-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5040 _5041 _5042 _5043 _5044-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (4,f) -> u f (\_5045 _5046-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (5,f) -> u f (\_5047 _5048-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (6,f) -> u f (\_5049 _5050 _5051-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (7,f) -> u f (\_5052 _5053 _5054-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5055 _5056 _5057-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5058 _5059 _5060-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5061-> (u (u fm_term_equal_hole _5061) _a_1)); (11,f) -> u f (\_5062-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5063-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5064-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5065 _5066 _5067 _5068 _5069 _5070-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5071 _5072-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); (1,f) -> u f (\_5073-> (let _5074 = _b1_9 in (case _5074 of {(0,f) -> u f (\_5075 _5076-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5077-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5078 _5079 _5080 _5081 _5082-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (4,f) -> u f (\_5083 _5084-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (5,f) -> u f (\_5085 _5086-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (6,f) -> u f (\_5087 _5088 _5089-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (7,f) -> u f (\_5090 _5091 _5092-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5093 _5094 _5095-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5096 _5097 _5098-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5099-> (u (u fm_term_equal_hole _5099) _a_1)); (11,f) -> u f (\_5100-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5101-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5102-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5103 _5104 _5105 _5106 _5107 _5108-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5109 _5110-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); (2,f) -> u f ((let _5111 = _b1_9 in (case _5111 of {(0,f) -> u f (\_5112 _5113-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5114-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5115 _5116 _5117 _5118 _5119-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (4,f) -> u f (\_5120 _5121-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (5,f) -> u f (\_5122 _5123-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (6,f) -> u f (\_5124 _5125 _5126-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (7,f) -> u f (\_5127 _5128 _5129-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5130 _5131 _5132-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5133 _5134 _5135-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5136-> (u (u fm_term_equal_hole _5136) _a_1)); (11,f) -> u f (\_5137-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5138-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5139-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5140 _5141 _5142 _5143 _5144 _5145-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5146 _5147-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); (3,f) -> u f (\_5148 _5149 _5150 _5151 _5152-> (let _5153 = _b1_9 in (case _5153 of {(0,f) -> u f (\_5154 _5155-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5156-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5157 _5158 _5159 _5160 _5161-> (let _seen_23=(u (u set_set _id_12) _seen_5) in (let _a1_body_24=(u (u _5152 (u (u fm_term_var _5149) _lv_4)) (u (u fm_term_var _5150) (u nat_succ _lv_4))) in (let _b1_body_25=(u (u _5161 (u (u fm_term_var _5158) _lv_4)) (u (u fm_term_var _5159) (u nat_succ _lv_4))) in (let _eq_self_26=(((_5149::String) == _5158)) in (let _eq_eras_27=(u (u bool_eql _5148) _5157) in (let _5162 = ((_eq_self_26 && _eq_eras_27)) in (if _5162 then (let _5163 = (u (u (u (u (u fm_term_equal _5151) _5160) _defs_3) _lv_4) _seen_23) in (case _5163 of {(0,f) -> u f (\_5164 _5165-> (let _5166 = _5164 in (case _5166 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5165)); (1,f) -> u f (\_5167-> (let _5168 = (let _5169 = (u (u (u (u (u fm_term_equal _a1_body_24) _b1_body_25) _defs_3) (u nat_succ (u nat_succ _lv_4))) _seen_23) in (case _5169 of {(0,f) -> u f (\_5170 _5171-> (let _5172 = _5170 in (case _5172 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5171)); (1,f) -> u f (\_5173-> (let _5174 = (u (u fm_check_result (u maybe_some ((_5167 && _5173)))) list_nil) in (case _5174 of {(0,f) -> u f (\_5175 _5176-> (u (u fm_check_result _5175) (u (u list_concat _5171) _5176))); }))); }))); })) in (case _5168 of {(0,f) -> u f (\_5177 _5178-> (u (u fm_check_result _5177) (u (u list_concat _5165) _5178))); }))); }))); })) else (u (u fm_check_result (u maybe_some bool_false)) list_nil))))))))); (4,f) -> u f (\_5179 _5180-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (5,f) -> u f (\_5181 _5182-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (6,f) -> u f (\_5183 _5184 _5185-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (7,f) -> u f (\_5186 _5187 _5188-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5189 _5190 _5191-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5192 _5193 _5194-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5195-> (u (u fm_term_equal_hole _5195) _a_1)); (11,f) -> u f (\_5196-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5197-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5198-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5199 _5200 _5201 _5202 _5203 _5204-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5205 _5206-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); (4,f) -> u f (\_5207 _5208-> (let _5209 = _b1_9 in (case _5209 of {(0,f) -> u f (\_5210 _5211-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5212-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5213 _5214 _5215 _5216 _5217-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (4,f) -> u f (\_5218 _5219-> (let _seen_17=(u (u set_set _id_12) _seen_5) in (let _a1_body_18=(u _5208 (u (u fm_term_var _5207) _lv_4)) in (let _b1_body_19=(u _5219 (u (u fm_term_var _5218) _lv_4)) in (let _5220 = (u (u (u (u (u fm_term_equal _a1_body_18) _b1_body_19) _defs_3) (u nat_succ _lv_4)) _seen_17) in (case _5220 of {(0,f) -> u f (\_5221 _5222-> (let _5223 = _5221 in (case _5223 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5222)); (1,f) -> u f (\_5224-> (let _5225 = (u (u fm_check_result (u maybe_some _5224)) list_nil) in (case _5225 of {(0,f) -> u f (\_5226 _5227-> (u (u fm_check_result _5226) (u (u list_concat _5222) _5227))); }))); }))); })))))); (5,f) -> u f (\_5228 _5229-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (6,f) -> u f (\_5230 _5231 _5232-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (7,f) -> u f (\_5233 _5234 _5235-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5236 _5237 _5238-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5239 _5240 _5241-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5242-> (u (u fm_term_equal_hole _5242) _a_1)); (11,f) -> u f (\_5243-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5244-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5245-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5246 _5247 _5248 _5249 _5250 _5251-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5252 _5253-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); (5,f) -> u f (\_5254 _5255-> (let _5256 = _b1_9 in (case _5256 of {(0,f) -> u f (\_5257 _5258-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5259-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5260 _5261 _5262 _5263 _5264-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (4,f) -> u f (\_5265 _5266-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (5,f) -> u f (\_5267 _5268-> (let _seen_17=(u (u set_set _id_12) _seen_5) in (let _5269 = (u (u (u (u (u fm_term_equal _5254) _5267) _defs_3) _lv_4) _seen_17) in (case _5269 of {(0,f) -> u f (\_5270 _5271-> (let _5272 = _5270 in (case _5272 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5271)); (1,f) -> u f (\_5273-> (let _5274 = (let _5275 = (u (u (u (u (u fm_term_equal _5255) _5268) _defs_3) _lv_4) _seen_17) in (case _5275 of {(0,f) -> u f (\_5276 _5277-> (let _5278 = _5276 in (case _5278 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5277)); (1,f) -> u f (\_5279-> (let _5280 = (u (u fm_check_result (u maybe_some ((_5273 && _5279)))) list_nil) in (case _5280 of {(0,f) -> u f (\_5281 _5282-> (u (u fm_check_result _5281) (u (u list_concat _5277) _5282))); }))); }))); })) in (case _5274 of {(0,f) -> u f (\_5283 _5284-> (u (u fm_check_result _5283) (u (u list_concat _5271) _5284))); }))); }))); })))); (6,f) -> u f (\_5285 _5286 _5287-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (7,f) -> u f (\_5288 _5289 _5290-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5291 _5292 _5293-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5294 _5295 _5296-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5297-> (u (u fm_term_equal_hole _5297) _a_1)); (11,f) -> u f (\_5298-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5299-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5300-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5301 _5302 _5303 _5304 _5305 _5306-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5307 _5308-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); (6,f) -> u f (\_5309 _5310 _5311-> (let _5312 = _b1_9 in (case _5312 of {(0,f) -> u f (\_5313 _5314-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5315-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5316 _5317 _5318 _5319 _5320-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (4,f) -> u f (\_5321 _5322-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (5,f) -> u f (\_5323 _5324-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (6,f) -> u f (\_5325 _5326 _5327-> (let _seen_19=(u (u set_set _id_12) _seen_5) in (let _a1_body_20=(u _5311 (u (u fm_term_var _5309) _lv_4)) in (let _b1_body_21=(u _5327 (u (u fm_term_var _5325) _lv_4)) in (let _5328 = (u (u (u (u (u fm_term_equal _5310) _5326) _defs_3) _lv_4) _seen_19) in (case _5328 of {(0,f) -> u f (\_5329 _5330-> (let _5331 = _5329 in (case _5331 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5330)); (1,f) -> u f (\_5332-> (let _5333 = (let _5334 = (u (u (u (u (u fm_term_equal _a1_body_20) _b1_body_21) _defs_3) (u nat_succ _lv_4)) _seen_19) in (case _5334 of {(0,f) -> u f (\_5335 _5336-> (let _5337 = _5335 in (case _5337 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5336)); (1,f) -> u f (\_5338-> (let _5339 = (u (u fm_check_result (u maybe_some ((_5332 && _5338)))) list_nil) in (case _5339 of {(0,f) -> u f (\_5340 _5341-> (u (u fm_check_result _5340) (u (u list_concat _5336) _5341))); }))); }))); })) in (case _5333 of {(0,f) -> u f (\_5342 _5343-> (u (u fm_check_result _5342) (u (u list_concat _5330) _5343))); }))); }))); })))))); (7,f) -> u f (\_5344 _5345 _5346-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5347 _5348 _5349-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5350 _5351 _5352-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5353-> (u (u fm_term_equal_hole _5353) _a_1)); (11,f) -> u f (\_5354-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5355-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5356-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5357 _5358 _5359 _5360 _5361 _5362-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5363 _5364-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); (7,f) -> u f (\_5365 _5366 _5367-> (let _5368 = _b1_9 in (case _5368 of {(0,f) -> u f (\_5369 _5370-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5371-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5372 _5373 _5374 _5375 _5376-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (4,f) -> u f (\_5377 _5378-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (5,f) -> u f (\_5379 _5380-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (6,f) -> u f (\_5381 _5382 _5383-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (7,f) -> u f (\_5384 _5385 _5386-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5387 _5388 _5389-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5390 _5391 _5392-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5393-> (u (u fm_term_equal_hole _5393) _a_1)); (11,f) -> u f (\_5394-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5395-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5396-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5397 _5398 _5399 _5400 _5401 _5402-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5403 _5404-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); (8,f) -> u f (\_5405 _5406 _5407-> (let _5408 = _b1_9 in (case _5408 of {(0,f) -> u f (\_5409 _5410-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5411-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5412 _5413 _5414 _5415 _5416-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (4,f) -> u f (\_5417 _5418-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (5,f) -> u f (\_5419 _5420-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (6,f) -> u f (\_5421 _5422 _5423-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (7,f) -> u f (\_5424 _5425 _5426-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5427 _5428 _5429-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5430 _5431 _5432-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5433-> (u (u fm_term_equal_hole _5433) _a_1)); (11,f) -> u f (\_5434-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5435-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5436-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5437 _5438 _5439 _5440 _5441 _5442-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5443 _5444-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); (9,f) -> u f (\_5445 _5446 _5447-> (let _5448 = _b1_9 in (case _5448 of {(0,f) -> u f (\_5449 _5450-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5451-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5452 _5453 _5454 _5455 _5456-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (4,f) -> u f (\_5457 _5458-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (5,f) -> u f (\_5459 _5460-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (6,f) -> u f (\_5461 _5462 _5463-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (7,f) -> u f (\_5464 _5465 _5466-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5467 _5468 _5469-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5470 _5471 _5472-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5473-> (u (u fm_term_equal_hole _5473) _a_1)); (11,f) -> u f (\_5474-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5475-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5476-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5477 _5478 _5479 _5480 _5481 _5482-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5483 _5484-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); (10,f) -> u f (\_5485-> (u (u fm_term_equal_hole _5485) _b_2)); (11,f) -> u f (\_5486-> (let _5487 = _b1_9 in (case _5487 of {(0,f) -> u f (\_5488 _5489-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5490-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5491 _5492 _5493 _5494 _5495-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (4,f) -> u f (\_5496 _5497-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (5,f) -> u f (\_5498 _5499-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (6,f) -> u f (\_5500 _5501 _5502-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (7,f) -> u f (\_5503 _5504 _5505-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5506 _5507 _5508-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5509 _5510 _5511-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5512-> (u (u fm_term_equal_hole _5512) _a_1)); (11,f) -> u f (\_5513-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5514-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5515-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5516 _5517 _5518 _5519 _5520 _5521-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5522 _5523-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); (12,f) -> u f (\_5524-> (let _5525 = _b1_9 in (case _5525 of {(0,f) -> u f (\_5526 _5527-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5528-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5529 _5530 _5531 _5532 _5533-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (4,f) -> u f (\_5534 _5535-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (5,f) -> u f (\_5536 _5537-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (6,f) -> u f (\_5538 _5539 _5540-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (7,f) -> u f (\_5541 _5542 _5543-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5544 _5545 _5546-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5547 _5548 _5549-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5550-> (u (u fm_term_equal_hole _5550) _a_1)); (11,f) -> u f (\_5551-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5552-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5553-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5554 _5555 _5556 _5557 _5558 _5559-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5560 _5561-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); (13,f) -> u f (\_5562-> (let _5563 = _b1_9 in (case _5563 of {(0,f) -> u f (\_5564 _5565-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5566-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5567 _5568 _5569 _5570 _5571-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (4,f) -> u f (\_5572 _5573-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (5,f) -> u f (\_5574 _5575-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (6,f) -> u f (\_5576 _5577 _5578-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (7,f) -> u f (\_5579 _5580 _5581-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5582 _5583 _5584-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5585 _5586 _5587-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5588-> (u (u fm_term_equal_hole _5588) _a_1)); (11,f) -> u f (\_5589-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5590-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5591-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5592 _5593 _5594 _5595 _5596 _5597-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5598 _5599-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); (14,f) -> u f (\_5600 _5601 _5602 _5603 _5604 _5605-> (let _5606 = _b1_9 in (case _5606 of {(0,f) -> u f (\_5607 _5608-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5609-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5610 _5611 _5612 _5613 _5614-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (4,f) -> u f (\_5615 _5616-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (5,f) -> u f (\_5617 _5618-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (6,f) -> u f (\_5619 _5620 _5621-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (7,f) -> u f (\_5622 _5623 _5624-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5625 _5626 _5627-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5628 _5629 _5630-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5631-> (u (u fm_term_equal_hole _5631) _a_1)); (11,f) -> u f (\_5632-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5633-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5634-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5635 _5636 _5637 _5638 _5639 _5640-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5641 _5642-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); (15,f) -> u f (\_5643 _5644-> (let _5645 = _b1_9 in (case _5645 of {(0,f) -> u f (\_5646 _5647-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5648-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5649 _5650 _5651 _5652 _5653-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (4,f) -> u f (\_5654 _5655-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (5,f) -> u f (\_5656 _5657-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (6,f) -> u f (\_5658 _5659 _5660-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (7,f) -> u f (\_5661 _5662 _5663-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5664 _5665 _5666-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5667 _5668 _5669-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5670-> (u (u fm_term_equal_hole _5670) _a_1)); (11,f) -> u f (\_5671-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5672-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5673-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5674 _5675 _5676 _5677 _5678 _5679-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5680 _5681-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); }))))))))))))))))))))
set_new = map_new
fm_term_check = (\_term_1-> (\_type_2-> (\_defs_3-> (\_ctx_4-> (\_path_5-> (\_orig_6-> (let _5682 = (let _5683 = _term_1 in (case _5683 of {(0,f) -> u f (\_5684 _5685-> (let _5686 = (u (u list_at_last _5685) _ctx_4) in (case _5686 of {(0,f) -> u f ((u (u fm_check_result _type_2) (u (u list_cons (u (u fm_error_undefined_reference _orig_6) _5684)) list_nil))); (1,f) -> u f (\_5687-> (u (u fm_check_result (u maybe_some (let _5688 = _5687 in (case _5688 of {(0,f) -> u f (\_5689 _5690-> _5690); })))) list_nil)); }))); (1,f) -> u f (\_5691-> (let _5692 = (u (u fm_get _5691) _defs_3) in (case _5692 of {(0,f) -> u f ((u (u fm_check_result _type_2) (u (u list_cons (u (u fm_error_undefined_reference _orig_6) _5691)) list_nil))); (1,f) -> u f (\_5693-> (let _5694 = _5693 in (case _5694 of {(0,f) -> u f (\_5695 _5696 _5697 _5698 _5699 _5700-> (let _ref_name_15=_5697 in (let _ref_type_16=_5699 in (let _ref_term_17=_5698 in (let _ref_stat_18=_5700 in (let _5701 = _ref_stat_18 in (case _5701 of {(0,f) -> u f ((u (u fm_check_result (u maybe_some _ref_type_16)) (u (u list_cons (u fm_error_waiting _ref_name_15)) list_nil))); (1,f) -> u f ((u (u fm_check_result (u maybe_some _ref_type_16)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some _ref_type_16)) list_nil)); (3,f) -> u f (\_5702-> (u (u fm_check_result (u maybe_some _ref_type_16)) (u (u list_cons (u fm_error_indirect _ref_name_15)) list_nil))); }))))))); }))); }))); (2,f) -> u f ((u (u fm_check_result (u maybe_some fm_term_typ)) list_nil)); (3,f) -> u f (\_5703 _5704 _5705 _5706 _5707-> (let _ctx_size_12=(u list_length _ctx_4) in (let _self_var_13=(u (u fm_term_var _5704) _ctx_size_12) in (let _body_var_14=(u (u fm_term_var _5705) (u nat_succ _ctx_size_12)) in (let _body_ctx_15=(u (u list_cons (u (u pair_new _5705) _5706)) (u (u list_cons (u (u pair_new _5704) _term_1)) _ctx_4)) in (let _5708 = (u (u (u (u (u (u fm_term_check _5706) (u maybe_some fm_term_typ)) _defs_3) _ctx_4) (u fm_mpath_o _path_5)) _orig_6) in (case _5708 of {(0,f) -> u f (\_5709 _5710-> (let _5711 = _5709 in (case _5711 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5710)); (1,f) -> u f (\_5712-> (let _5713 = (let _5714 = (u (u (u (u (u (u fm_term_check (u (u _5707 _self_var_13) _body_var_14)) (u maybe_some fm_term_typ)) _defs_3) _body_ctx_15) (u fm_mpath_i _path_5)) _orig_6) in (case _5714 of {(0,f) -> u f (\_5715 _5716-> (let _5717 = _5715 in (case _5717 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5716)); (1,f) -> u f (\_5718-> (let _5719 = (u (u fm_check_result (u maybe_some fm_term_typ)) list_nil) in (case _5719 of {(0,f) -> u f (\_5720 _5721-> (u (u fm_check_result _5720) (u (u list_concat _5716) _5721))); }))); }))); })) in (case _5713 of {(0,f) -> u f (\_5722 _5723-> (u (u fm_check_result _5722) (u (u list_concat _5710) _5723))); }))); }))); }))))))); (4,f) -> u f (\_5724 _5725-> (let _5726 = _type_2 in (case _5726 of {(0,f) -> u f ((let _lam_type_9=(u fm_term_hol bits_e) in (let _lam_term_10=(u (u (u fm_term_ann bool_false) _term_1) _lam_type_9) in (u (u fm_check_result _type_2) (u (u list_cons (u (u fm_error_patch (u fm_mpath_to_bits _path_5)) _lam_term_10)) list_nil))))); (1,f) -> u f (\_5727-> (let _typv_10=(u (u fm_term_reduce _5727) _defs_3) in (let _5728 = _typv_10 in (case _5728 of {(0,f) -> u f (\_5729 _5730-> (let _expected_13=(u either_left "(function type)") in (let _detected_14=(u either_right _5727) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_13) _detected_14) _ctx_4)) list_nil))))); (1,f) -> u f (\_5731-> (let _expected_12=(u either_left "(function type)") in (let _detected_13=(u either_right _5727) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_12) _detected_13) _ctx_4)) list_nil))))); (2,f) -> u f ((let _expected_11=(u either_left "(function type)") in (let _detected_12=(u either_right _5727) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_11) _detected_12) _ctx_4)) list_nil))))); (3,f) -> u f (\_5732 _5733 _5734 _5735 _5736-> (let _ctx_size_16=(u list_length _ctx_4) in (let _self_var_17=_term_1 in (let _body_var_18=(u (u fm_term_var _5724) _ctx_size_16) in (let _body_typ_19=(u (u _5736 _self_var_17) _body_var_18) in (let _body_ctx_20=(u (u list_cons (u (u pair_new _5724) _5735)) _ctx_4) in (let _5737 = (u (u (u (u (u (u fm_term_check (u _5725 _body_var_18)) (u maybe_some _body_typ_19)) _defs_3) _body_ctx_20) (u fm_mpath_o _path_5)) _orig_6) in (case _5737 of {(0,f) -> u f (\_5738 _5739-> (let _5740 = _5738 in (case _5740 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5739)); (1,f) -> u f (\_5741-> (let _5742 = (u (u fm_check_result (u maybe_some _5727)) list_nil) in (case _5742 of {(0,f) -> u f (\_5743 _5744-> (u (u fm_check_result _5743) (u (u list_concat _5739) _5744))); }))); }))); })))))))); (4,f) -> u f (\_5745 _5746-> (let _expected_13=(u either_left "(function type)") in (let _detected_14=(u either_right _5727) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_13) _detected_14) _ctx_4)) list_nil))))); (5,f) -> u f (\_5747 _5748-> (let _expected_13=(u either_left "(function type)") in (let _detected_14=(u either_right _5727) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_13) _detected_14) _ctx_4)) list_nil))))); (6,f) -> u f (\_5749 _5750 _5751-> (let _expected_14=(u either_left "(function type)") in (let _detected_15=(u either_right _5727) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_14) _detected_15) _ctx_4)) list_nil))))); (7,f) -> u f (\_5752 _5753 _5754-> (let _expected_14=(u either_left "(function type)") in (let _detected_15=(u either_right _5727) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_14) _detected_15) _ctx_4)) list_nil))))); (8,f) -> u f (\_5755 _5756 _5757-> (let _expected_14=(u either_left "(function type)") in (let _detected_15=(u either_right _5727) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_14) _detected_15) _ctx_4)) list_nil))))); (9,f) -> u f (\_5758 _5759 _5760-> (let _expected_14=(u either_left "(function type)") in (let _detected_15=(u either_right _5727) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_14) _detected_15) _ctx_4)) list_nil))))); (10,f) -> u f (\_5761-> (let _expected_12=(u either_left "(function type)") in (let _detected_13=(u either_right _5727) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_12) _detected_13) _ctx_4)) list_nil))))); (11,f) -> u f (\_5762-> (let _expected_12=(u either_left "(function type)") in (let _detected_13=(u either_right _5727) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_12) _detected_13) _ctx_4)) list_nil))))); (12,f) -> u f (\_5763-> (let _expected_12=(u either_left "(function type)") in (let _detected_13=(u either_right _5727) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_12) _detected_13) _ctx_4)) list_nil))))); (13,f) -> u f (\_5764-> (let _expected_12=(u either_left "(function type)") in (let _detected_13=(u either_right _5727) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_12) _detected_13) _ctx_4)) list_nil))))); (14,f) -> u f (\_5765 _5766 _5767 _5768 _5769 _5770-> (let _expected_17=(u either_left "(function type)") in (let _detected_18=(u either_right _5727) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_17) _detected_18) _ctx_4)) list_nil))))); (15,f) -> u f (\_5771 _5772-> (let _expected_13=(u either_left "(function type)") in (let _detected_14=(u either_right _5727) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_13) _detected_14) _ctx_4)) list_nil))))); })))); }))); (5,f) -> u f (\_5773 _5774-> (let _5775 = (u (u (u (u (u (u fm_term_check _5773) maybe_none) _defs_3) _ctx_4) (u fm_mpath_o _path_5)) _orig_6) in (case _5775 of {(0,f) -> u f (\_5776 _5777-> (let _5778 = _5776 in (case _5778 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5777)); (1,f) -> u f (\_5779-> (let _func_typ_12=(u (u fm_term_reduce _5779) _defs_3) in (let _5780 = (let _5781 = _func_typ_12 in (case _5781 of {(0,f) -> u f (\_5782 _5783-> (let _expected_15=(u either_left "(function type)") in (let _detected_16=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_15) _detected_16) _ctx_4)) list_nil))))); (1,f) -> u f (\_5784-> (let _expected_14=(u either_left "(function type)") in (let _detected_15=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_14) _detected_15) _ctx_4)) list_nil))))); (2,f) -> u f ((let _expected_13=(u either_left "(function type)") in (let _detected_14=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_13) _detected_14) _ctx_4)) list_nil))))); (3,f) -> u f (\_5785 _5786 _5787 _5788 _5789-> (let _5790 = (u (u (u (u (u (u fm_term_check _5774) (u maybe_some _5788)) _defs_3) _ctx_4) (u fm_mpath_i _path_5)) _orig_6) in (case _5790 of {(0,f) -> u f (\_5791 _5792-> (let _5793 = _5791 in (case _5793 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5792)); (1,f) -> u f (\_5794-> (let _5795 = (u (u fm_check_result (u maybe_some (u (u _5789 _5773) _5774))) list_nil) in (case _5795 of {(0,f) -> u f (\_5796 _5797-> (u (u fm_check_result _5796) (u (u list_concat _5792) _5797))); }))); }))); }))); (4,f) -> u f (\_5798 _5799-> (let _expected_15=(u either_left "(function type)") in (let _detected_16=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_15) _detected_16) _ctx_4)) list_nil))))); (5,f) -> u f (\_5800 _5801-> (let _expected_15=(u either_left "(function type)") in (let _detected_16=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_15) _detected_16) _ctx_4)) list_nil))))); (6,f) -> u f (\_5802 _5803 _5804-> (let _expected_16=(u either_left "(function type)") in (let _detected_17=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_16) _detected_17) _ctx_4)) list_nil))))); (7,f) -> u f (\_5805 _5806 _5807-> (let _expected_16=(u either_left "(function type)") in (let _detected_17=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_16) _detected_17) _ctx_4)) list_nil))))); (8,f) -> u f (\_5808 _5809 _5810-> (let _expected_16=(u either_left "(function type)") in (let _detected_17=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_16) _detected_17) _ctx_4)) list_nil))))); (9,f) -> u f (\_5811 _5812 _5813-> (let _expected_16=(u either_left "(function type)") in (let _detected_17=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_16) _detected_17) _ctx_4)) list_nil))))); (10,f) -> u f (\_5814-> (let _expected_14=(u either_left "(function type)") in (let _detected_15=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_14) _detected_15) _ctx_4)) list_nil))))); (11,f) -> u f (\_5815-> (let _expected_14=(u either_left "(function type)") in (let _detected_15=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_14) _detected_15) _ctx_4)) list_nil))))); (12,f) -> u f (\_5816-> (let _expected_14=(u either_left "(function type)") in (let _detected_15=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_14) _detected_15) _ctx_4)) list_nil))))); (13,f) -> u f (\_5817-> (let _expected_14=(u either_left "(function type)") in (let _detected_15=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_14) _detected_15) _ctx_4)) list_nil))))); (14,f) -> u f (\_5818 _5819 _5820 _5821 _5822 _5823-> (let _expected_19=(u either_left "(function type)") in (let _detected_20=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_19) _detected_20) _ctx_4)) list_nil))))); (15,f) -> u f (\_5824 _5825-> (let _expected_15=(u either_left "(function type)") in (let _detected_16=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_15) _detected_16) _ctx_4)) list_nil))))); })) in (case _5780 of {(0,f) -> u f (\_5826 _5827-> (u (u fm_check_result _5826) (u (u list_concat _5777) _5827))); })))); }))); }))); (6,f) -> u f (\_5828 _5829 _5830-> (let _ctx_size_10=(u list_length _ctx_4) in (let _5831 = (u (u (u (u (u (u fm_term_check _5829) maybe_none) _defs_3) _ctx_4) (u fm_mpath_o _path_5)) _orig_6) in (case _5831 of {(0,f) -> u f (\_5832 _5833-> (let _5834 = _5832 in (case _5834 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5833)); (1,f) -> u f (\_5835-> (let _body_val_14=(u _5830 (u (u fm_term_var _5828) _ctx_size_10)) in (let _body_ctx_15=(u (u list_cons (u (u pair_new _5828) _5835)) _ctx_4) in (let _5836 = (let _5837 = (u (u (u (u (u (u fm_term_check _body_val_14) _type_2) _defs_3) _body_ctx_15) (u fm_mpath_i _path_5)) _orig_6) in (case _5837 of {(0,f) -> u f (\_5838 _5839-> (let _5840 = _5838 in (case _5840 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5839)); (1,f) -> u f (\_5841-> (let _5842 = (u (u fm_check_result (u maybe_some _5841)) list_nil) in (case _5842 of {(0,f) -> u f (\_5843 _5844-> (u (u fm_check_result _5843) (u (u list_concat _5839) _5844))); }))); }))); })) in (case _5836 of {(0,f) -> u f (\_5845 _5846-> (u (u fm_check_result _5845) (u (u list_concat _5833) _5846))); }))))); }))); })))); (7,f) -> u f (\_5847 _5848 _5849-> (let _ctx_size_10=(u list_length _ctx_4) in (let _5850 = (u (u (u (u (u (u fm_term_check _5848) maybe_none) _defs_3) _ctx_4) (u fm_mpath_o _path_5)) _orig_6) in (case _5850 of {(0,f) -> u f (\_5851 _5852-> (let _5853 = _5851 in (case _5853 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5852)); (1,f) -> u f (\_5854-> (let _body_val_14=(u _5849 (u (u (u fm_term_ann bool_true) _5848) _5854)) in (let _body_ctx_15=(u (u list_cons (u (u pair_new _5847) _5854)) _ctx_4) in (let _5855 = (let _5856 = (u (u (u (u (u (u fm_term_check _body_val_14) _type_2) _defs_3) _body_ctx_15) (u fm_mpath_i _path_5)) _orig_6) in (case _5856 of {(0,f) -> u f (\_5857 _5858-> (let _5859 = _5857 in (case _5859 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5858)); (1,f) -> u f (\_5860-> (let _5861 = (u (u fm_check_result (u maybe_some _5860)) list_nil) in (case _5861 of {(0,f) -> u f (\_5862 _5863-> (u (u fm_check_result _5862) (u (u list_concat _5858) _5863))); }))); }))); })) in (case _5855 of {(0,f) -> u f (\_5864 _5865-> (u (u fm_check_result _5864) (u (u list_concat _5852) _5865))); }))))); }))); })))); (8,f) -> u f (\_5866 _5867 _5868-> (let _5869 = _5866 in (if _5869 then (u (u fm_check_result (u maybe_some _5868)) list_nil) else (let _5870 = (u (u (u (u (u (u fm_term_check _5867) (u maybe_some _5868)) _defs_3) _ctx_4) (u fm_mpath_o _path_5)) _orig_6) in (case _5870 of {(0,f) -> u f (\_5871 _5872-> (let _5873 = _5871 in (case _5873 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5872)); (1,f) -> u f (\_5874-> (let _5875 = (let _5876 = (u (u (u (u (u (u fm_term_check _5868) (u maybe_some fm_term_typ)) _defs_3) _ctx_4) (u fm_mpath_i _path_5)) _orig_6) in (case _5876 of {(0,f) -> u f (\_5877 _5878-> (let _5879 = _5877 in (case _5879 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5878)); (1,f) -> u f (\_5880-> (let _5881 = (u (u fm_check_result (u maybe_some _5868)) list_nil) in (case _5881 of {(0,f) -> u f (\_5882 _5883-> (u (u fm_check_result _5882) (u (u list_concat _5878) _5883))); }))); }))); })) in (case _5875 of {(0,f) -> u f (\_5884 _5885-> (u (u fm_check_result _5884) (u (u list_concat _5872) _5885))); }))); }))); }))))); (9,f) -> u f (\_5886 _5887 _5888-> (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u (u fm_error_show_goal _5886) _5887) _5888) _type_2) _ctx_4)) list_nil))); (10,f) -> u f (\_5889-> (u (u fm_check_result _type_2) list_nil)); (11,f) -> u f (\_5890-> (u (u fm_check_result (u maybe_some (u fm_term_ref "Nat"))) list_nil)); (12,f) -> u f (\_5891-> (u (u fm_check_result (u maybe_some (u fm_term_ref "Char"))) list_nil)); (13,f) -> u f (\_5892-> (u (u fm_check_result (u maybe_some (u fm_term_ref "String"))) list_nil)); (14,f) -> u f (\_5893 _5894 _5895 _5896 _5897 _5898-> (let _expr_13=_5894 in (let _5899 = (u (u (u (u (u (u fm_term_check _expr_13) maybe_none) _defs_3) _ctx_4) (u fm_mpath_o _path_5)) _orig_6) in (case _5899 of {(0,f) -> u f (\_5900 _5901-> (let _5902 = _5900 in (case _5902 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5901)); (1,f) -> u f (\_5903-> (let _dsug_17=(let _5904 = _5898 in (case _5904 of {(0,f) -> u f ((let _moti_17=(let _5905 = _type_2 in (case _5905 of {(0,f) -> u f ((u fm_term_hol bits_e)); (1,f) -> u f (\_5906-> (let _size_18=(u list_length _ctx_4) in (let _typv_19=(u (u fm_term_normalize _5906) map_new) in (let _moti_20=(u (u (u (u (u (u fm_smartmotive_make _5895) _5894) _5903) _typv_19) _size_18) _defs_3) in _moti_20)))); })) in (u maybe_some (u (u (u (u (u (u fm_term_cse _5893) _5894) _5895) _5896) _5897) (u maybe_some _moti_17))))); (1,f) -> u f (\_5907-> (u (u (u (u (u (u (u (u fm_term_desugar_cse _5894) _5895) _5896) _5897) _5907) _5903) _defs_3) _ctx_4)); })) in (let _5908 = (let _5909 = _dsug_17 in (case _5909 of {(0,f) -> u f ((u (u fm_check_result _type_2) (u (u list_cons (u (u (u fm_error_cant_infer _orig_6) _term_1) _ctx_4)) list_nil))); (1,f) -> u f (\_5910-> (u (u fm_check_result _type_2) (u (u list_cons (u (u fm_error_patch (u fm_mpath_to_bits _path_5)) _5910)) list_nil))); })) in (case _5908 of {(0,f) -> u f (\_5911 _5912-> (u (u fm_check_result _5911) (u (u list_concat _5901) _5912))); })))); }))); })))); (15,f) -> u f (\_5913 _5914-> (u (u (u (u (u (u fm_term_check _5914) _type_2) _defs_3) _ctx_4) _path_5) (u maybe_some _5913))); })) in (case _5682 of {(0,f) -> u f (\_5915 _5916-> (let _5917 = _5915 in (case _5917 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5916)); (1,f) -> u f (\_5918-> (let _5919 = (let _5920 = _type_2 in (case _5920 of {(0,f) -> u f ((u (u fm_check_result (u maybe_some _5918)) list_nil)); (1,f) -> u f (\_5921-> (let _5922 = (u (u (u (u (u fm_term_equal _5921) _5918) _defs_3) (u list_length _ctx_4)) set_new) in (case _5922 of {(0,f) -> u f (\_5923 _5924-> (let _5925 = _5923 in (case _5925 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5924)); (1,f) -> u f (\_5926-> (let _5927 = (let _5928 = _5926 in (if _5928 then (u (u fm_check_result (u maybe_some _5921)) list_nil) else (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) (u either_right _5921)) (u either_right _5918)) _ctx_4)) list_nil)))) in (case _5927 of {(0,f) -> u f (\_5929 _5930-> (u (u fm_check_result _5929) (u (u list_concat _5924) _5930))); }))); }))); }))); })) in (case _5919 of {(0,f) -> u f (\_5931 _5932-> (u (u fm_check_result _5931) (u (u list_concat _5916) _5932))); }))); }))); }))))))))
fm_path_nil = (\_x_1-> _x_1)
fm_mpath_nil = (u maybe_some fm_path_nil)
list_is_empty = (\_list_2-> (let _5933 = _list_2 in (case _5933 of {(0,f) -> u f (bool_true); (1,f) -> u f (\_5934 _5935-> bool_false); })))
fm_term_patch_at = (\_path_1-> (\_term_2-> (\_fn_3-> (let _5936 = _term_2 in (case _5936 of {(0,f) -> u f (\_5937 _5938-> (let _5939 = _path_1 in (case _5939 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_5940-> _term_2); (2,f) -> u f (\_5941-> _term_2); }))); (1,f) -> u f (\_5942-> (let _5943 = _path_1 in (case _5943 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_5944-> _term_2); (2,f) -> u f (\_5945-> _term_2); }))); (2,f) -> u f ((let _5946 = _path_1 in (case _5946 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_5947-> _term_2); (2,f) -> u f (\_5948-> _term_2); }))); (3,f) -> u f (\_5949 _5950 _5951 _5952 _5953-> (let _5954 = _path_1 in (case _5954 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_5955-> (u (u (u (u (u fm_term_all _5949) _5950) _5951) (u (u (u fm_term_patch_at _5955) _5952) _fn_3)) _5953)); (2,f) -> u f (\_5956-> (u (u (u (u (u fm_term_all _5949) _5950) _5951) _5952) (\_s_10-> (\_x_11-> (u (u (u fm_term_patch_at _5956) (u (u _5953 _s_10) _x_11)) _fn_3))))); }))); (4,f) -> u f (\_5957 _5958-> (let _5959 = _path_1 in (case _5959 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_5960-> (u (u fm_term_lam _5957) (\_x_7-> (u (u (u fm_term_patch_at (u bits_tail _path_1)) (u _5958 _x_7)) _fn_3)))); (2,f) -> u f (\_5961-> (u (u fm_term_lam _5957) (\_x_7-> (u (u (u fm_term_patch_at (u bits_tail _path_1)) (u _5958 _x_7)) _fn_3)))); }))); (5,f) -> u f (\_5962 _5963-> (let _5964 = _path_1 in (case _5964 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_5965-> (u (u fm_term_app (u (u (u fm_term_patch_at _5965) _5962) _fn_3)) _5963)); (2,f) -> u f (\_5966-> (u (u fm_term_app _5962) (u (u (u fm_term_patch_at _5966) _5963) _fn_3))); }))); (6,f) -> u f (\_5967 _5968 _5969-> (let _5970 = _path_1 in (case _5970 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_5971-> (u (u (u fm_term_let _5967) (u (u (u fm_term_patch_at _5971) _5968) _fn_3)) _5969)); (2,f) -> u f (\_5972-> (u (u (u fm_term_let _5967) _5968) (\_x_8-> (u (u (u fm_term_patch_at _5972) (u _5969 _x_8)) _fn_3)))); }))); (7,f) -> u f (\_5973 _5974 _5975-> (let _5976 = _path_1 in (case _5976 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_5977-> (u (u (u fm_term_def _5973) (u (u (u fm_term_patch_at _5977) _5974) _fn_3)) _5975)); (2,f) -> u f (\_5978-> (u (u (u fm_term_def _5973) _5974) (\_x_8-> (u (u (u fm_term_patch_at _5978) (u _5975 _x_8)) _fn_3)))); }))); (8,f) -> u f (\_5979 _5980 _5981-> (let _5982 = _path_1 in (case _5982 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_5983-> (u (u (u fm_term_ann _5979) (u (u (u fm_term_patch_at _5983) _5980) _fn_3)) _5981)); (2,f) -> u f (\_5984-> (u (u (u fm_term_ann _5979) _5980) (u (u (u fm_term_patch_at _5984) _5981) _fn_3))); }))); (9,f) -> u f (\_5985 _5986 _5987-> (let _5988 = _path_1 in (case _5988 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_5989-> _term_2); (2,f) -> u f (\_5990-> _term_2); }))); (10,f) -> u f (\_5991-> (let _5992 = _path_1 in (case _5992 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_5993-> _term_2); (2,f) -> u f (\_5994-> _term_2); }))); (11,f) -> u f (\_5995-> (let _5996 = _path_1 in (case _5996 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_5997-> _term_2); (2,f) -> u f (\_5998-> _term_2); }))); (12,f) -> u f (\_5999-> (let _6000 = _path_1 in (case _6000 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_6001-> _term_2); (2,f) -> u f (\_6002-> _term_2); }))); (13,f) -> u f (\_6003-> (let _6004 = _path_1 in (case _6004 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_6005-> _term_2); (2,f) -> u f (\_6006-> _term_2); }))); (14,f) -> u f (\_6007 _6008 _6009 _6010 _6011 _6012-> (let _6013 = _path_1 in (case _6013 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_6014-> _term_2); (2,f) -> u f (\_6015-> _term_2); }))); (15,f) -> u f (\_6016 _6017-> (u (u fm_term_ori _6016) (u (u (u fm_term_patch_at _path_1) _6017) _fn_3))); })))))
fm_synth_fix = (\_file_1-> (\_code_2-> (\_name_3-> (\_term_4-> (\_type_5-> (\_defs_6-> (\_errs_7-> (\_fixd_8-> (let _6018 = _errs_7 in (case _6018 of {(0,f) -> u f ((let _6019 = _fixd_8 in (if _6019 then (let _type_9=(u (u (u fm_term_bind list_nil) (\_x_9-> (u bits_i _x_9))) _type_5) in (let _term_10=(u (u (u fm_term_bind list_nil) (\_x_10-> (u bits_o _x_10))) _term_4) in (let _defs_11=(u (u (u fm_set _name_3) (u (u (u (u (u (u fm_def_new _file_1) _code_2) _name_3) _term_10) _type_9) fm_status_init)) _defs_6) in (u (u io_monad (\_m_bind_12-> (\_m_pure_13-> _m_pure_13))) (u maybe_some _defs_11))))) else (u (u io_monad (\_m_bind_9-> (\_m_pure_10-> _m_pure_10))) maybe_none)))); (1,f) -> u f (\_6020 _6021-> (let _6022 = _6020 in (case _6022 of {(0,f) -> u f (\_6023 _6024 _6025 _6026-> (u (u (u (u (u (u (u (u fm_synth_fix _file_1) _code_2) _name_3) _term_4) _type_5) _defs_6) _6021) _fixd_8)); (1,f) -> u f (\_6027 _6028 _6029 _6030 _6031-> (u (u (u (u (u (u (u (u fm_synth_fix _file_1) _code_2) _name_3) _term_4) _type_5) _defs_6) _6021) _fixd_8)); (2,f) -> u f (\_6032-> (u (u (u io_monad (\_m_bind_12-> (\_m_pure_13-> _m_bind_12))) (u (u fm_synth_one _6032) _defs_6)) (\_new_defs_12-> (let _6033 = _new_defs_12 in (case _6033 of {(0,f) -> u f ((u (u (u (u (u (u (u (u fm_synth_fix _file_1) _code_2) _name_3) _term_4) _type_5) _defs_6) _6021) _fixd_8)); (1,f) -> u f (\_6034-> (u (u (u (u (u (u (u (u fm_synth_fix _file_1) _code_2) _name_3) _term_4) _type_5) _6034) _6021) bool_true)); }))))); (3,f) -> u f (\_6035-> (u (u (u (u (u (u (u (u fm_synth_fix _file_1) _code_2) _name_3) _term_4) _type_5) _defs_6) _6021) _fixd_8)); (4,f) -> u f (\_6036 _6037-> (let _6038 = _6036 in (case _6038 of {(0,f) -> u f ((u (u io_monad (\_m_bind_13-> (\_m_pure_14-> _m_pure_14))) maybe_none)); (1,f) -> u f (\_6039-> (let _term_14=(u (u (u fm_term_patch_at _6039) _term_4) (\_x_14-> _6037)) in (u (u (u (u (u (u (u (u fm_synth_fix _file_1) _code_2) _name_3) _term_14) _type_5) _defs_6) _6021) bool_true))); (2,f) -> u f (\_6040-> (let _type_14=(u (u (u fm_term_patch_at _6040) _type_5) (\_x_14-> _6037)) in (u (u (u (u (u (u (u (u fm_synth_fix _file_1) _code_2) _name_3) _term_4) _type_14) _defs_6) _6021) bool_true))); }))); (5,f) -> u f (\_6041 _6042-> (u (u (u io_monad (\_m_bind_13-> (\_m_pure_14-> _m_bind_13))) (u (u fm_synth_one _6042) _defs_6)) (\_new_defs_13-> (let _6043 = _new_defs_13 in (case _6043 of {(0,f) -> u f ((u (u (u (u (u (u (u (u fm_synth_fix _file_1) _code_2) _name_3) _term_4) _type_5) _defs_6) _6021) _fixd_8)); (1,f) -> u f (\_6044-> (u (u (u (u (u (u (u (u fm_synth_fix _file_1) _code_2) _name_3) _term_4) _type_5) _6044) _6021) bool_true)); }))))); (6,f) -> u f (\_6045 _6046 _6047-> (u (u (u (u (u (u (u (u fm_synth_fix _file_1) _code_2) _name_3) _term_4) _type_5) _defs_6) _6021) _fixd_8)); }))); }))))))))))
fm_status_fail = (\_errors_1-> (3,\t-> t _errors_1))
fm_synth_one = (\_name_1-> (\_defs_2-> (let _6048 = (u (u fm_get _name_1) _defs_2) in (case _6048 of {(0,f) -> u f ((u (u (u io_monad (\_m_bind_3-> (\_m_pure_4-> _m_bind_3))) (u (u fm_synth_load _name_1) _defs_2)) (\_loaded_3-> (let _6049 = _loaded_3 in (case _6049 of {(0,f) -> u f ((u (u io_monad (\_m_bind_4-> (\_m_pure_5-> _m_pure_5))) maybe_none)); (1,f) -> u f (\_6050-> (u (u fm_synth_one _name_1) _6050)); }))))); (1,f) -> u f (\_6051-> (let _6052 = _6051 in (case _6052 of {(0,f) -> u f (\_6053 _6054 _6055 _6056 _6057 _6058-> (let _file_10=_6053 in (let _code_11=_6054 in (let _name_12=_6055 in (let _term_13=_6056 in (let _type_14=_6057 in (let _stat_15=_6058 in (let _6059 = _stat_15 in (case _6059 of {(0,f) -> u f ((let _defs_16=(u (u (u fm_set _name_12) (u (u (u (u (u (u fm_def_new _file_10) _code_11) _name_12) _term_13) _type_14) fm_status_wait)) _defs_2) in (let _checked_17=(let _6060 = (u (u (u (u (u (u fm_term_check _type_14) (u maybe_some fm_term_typ)) _defs_16) list_nil) (u fm_mpath_i fm_mpath_nil)) maybe_none) in (case _6060 of {(0,f) -> u f (\_6061 _6062-> (let _6063 = _6061 in (case _6063 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _6062)); (1,f) -> u f (\_6064-> (let _6065 = (let _6066 = (u (u (u (u (u (u fm_term_check _term_13) (u maybe_some _type_14)) _defs_16) list_nil) (u fm_mpath_o fm_mpath_nil)) maybe_none) in (case _6066 of {(0,f) -> u f (\_6067 _6068-> (let _6069 = _6067 in (case _6069 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _6068)); (1,f) -> u f (\_6070-> (let _6071 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _6071 of {(0,f) -> u f (\_6072 _6073-> (u (u fm_check_result _6072) (u (u list_concat _6068) _6073))); }))); }))); })) in (case _6065 of {(0,f) -> u f (\_6074 _6075-> (u (u fm_check_result _6074) (u (u list_concat _6062) _6075))); }))); }))); })) in (let _6076 = _checked_17 in (case _6076 of {(0,f) -> u f (\_6077 _6078-> (let _6079 = (u list_is_empty _6078) in (if _6079 then (let _defs_20=(u (u (u (u (u (u (u fm_define _file_10) _code_11) _name_12) _term_13) _type_14) bool_true) _defs_16) in (u (u io_monad (\_m_bind_21-> (\_m_pure_22-> _m_pure_22))) (u maybe_some _defs_20))) else (u (u (u io_monad (\_m_bind_20-> (\_m_pure_21-> _m_bind_20))) (u (u (u (u (u (u (u (u fm_synth_fix _file_10) _code_11) _name_12) _term_13) _type_14) _defs_16) _6078) bool_false)) (\_fixed_20-> (let _6080 = _fixed_20 in (case _6080 of {(0,f) -> u f ((let _stat_21=(u fm_status_fail _6078) in (let _defs_22=(u (u (u fm_set _name_12) (u (u (u (u (u (u fm_def_new _file_10) _code_11) _name_12) _term_13) _type_14) _stat_21)) _defs_16) in (u (u io_monad (\_m_bind_23-> (\_m_pure_24-> _m_pure_24))) (u maybe_some _defs_22))))); (1,f) -> u f (\_6081-> (u (u fm_synth_one _name_12) _6081)); }))))))); }))))); (1,f) -> u f ((u (u io_monad (\_m_bind_16-> (\_m_pure_17-> _m_pure_17))) (u maybe_some _defs_2))); (2,f) -> u f ((u (u io_monad (\_m_bind_16-> (\_m_pure_17-> _m_pure_17))) (u maybe_some _defs_2))); (3,f) -> u f (\_6082-> (u (u io_monad (\_m_bind_17-> (\_m_pure_18-> _m_pure_18))) (u maybe_some _defs_2))); }))))))))); }))); }))))
map_map = (\_fn_3-> (\_map_4-> (let _6083 = _map_4 in (case _6083 of {(0,f) -> u f (map_new); (1,f) -> u f (\_6084 _6085 _6086-> (let _val_8=(let _6087 = _6084 in (case _6087 of {(0,f) -> u f (maybe_none); (1,f) -> u f (\_6088-> (u maybe_some (u _fn_3 _6088))); })) in (let _lft_9=(u (u map_map _fn_3) _6085) in (let _rgt_10=(u (u map_map _fn_3) _6086) in (u (u (u map_tie _val_8) _lft_9) _rgt_10))))); }))))
fm_term_inline_names = (let _inl_1=(u (u list_cons "Monad.pure") (u (u list_cons "Monad.bind") (u (u list_cons "Monad.new") (u (u list_cons "Parser.monad") (u (u list_cons "Parser.bind") (u (u list_cons "Parser.pure") (u (u list_cons "Fm.Check.pure") (u (u list_cons "Fm.Check.bind") (u (u list_cons "Fm.Check.monad") (u (u list_cons "Fm.Check.value") (u (u list_cons "Fm.Check.none") list_nil))))))))))) in (let _kvs_2=(u (u list_mapped _inl_1) (\_x_2-> (u (u pair_new (u fm_name_to_bits _x_2)) unit_new))) in (u map_from_list _kvs_2)))
fm_term_inline_reduce = (\_term_1-> (\_defs_2-> (let _6089 = _term_1 in (case _6089 of {(0,f) -> u f (\_6090 _6091-> _term_1); (1,f) -> u f (\_6092-> (let _inli_4=(u (u set_has (u fm_name_to_bits _6092)) fm_term_inline_names) in (let _6093 = _inli_4 in (if _6093 then (let _6094 = (u (u fm_get _6092) _defs_2) in (case _6094 of {(0,f) -> u f ((u fm_term_ref _6092)); (1,f) -> u f (\_6095-> (let _6096 = _6095 in (case _6096 of {(0,f) -> u f (\_6097 _6098 _6099 _6100 _6101 _6102-> (u (u fm_term_inline_reduce _6100) _defs_2)); }))); })) else _term_1)))); (2,f) -> u f (_term_1); (3,f) -> u f (\_6103 _6104 _6105 _6106 _6107-> _term_1); (4,f) -> u f (\_6108 _6109-> _term_1); (5,f) -> u f (\_6110 _6111-> (let _func_5=(u (u fm_term_inline_reduce _6110) _defs_2) in (let _6112 = _func_5 in (case _6112 of {(0,f) -> u f (\_6113 _6114-> _term_1); (1,f) -> u f (\_6115-> _term_1); (2,f) -> u f (_term_1); (3,f) -> u f (\_6116 _6117 _6118 _6119 _6120-> _term_1); (4,f) -> u f (\_6121 _6122-> (u (u fm_term_inline_reduce (u _6122 _6111)) _defs_2)); (5,f) -> u f (\_6123 _6124-> _term_1); (6,f) -> u f (\_6125 _6126 _6127-> (u (u (u fm_term_let _6125) _6126) (\_x_9-> (u (u fm_term_inline_reduce (u (u fm_term_app (u _6127 _x_9)) _6111)) _defs_2)))); (7,f) -> u f (\_6128 _6129 _6130-> _term_1); (8,f) -> u f (\_6131 _6132 _6133-> _term_1); (9,f) -> u f (\_6134 _6135 _6136-> _term_1); (10,f) -> u f (\_6137-> _term_1); (11,f) -> u f (\_6138-> _term_1); (12,f) -> u f (\_6139-> _term_1); (13,f) -> u f (\_6140-> _term_1); (14,f) -> u f (\_6141 _6142 _6143 _6144 _6145 _6146-> _term_1); (15,f) -> u f (\_6147 _6148-> _term_1); })))); (6,f) -> u f (\_6149 _6150 _6151-> _term_1); (7,f) -> u f (\_6152 _6153 _6154-> _term_1); (8,f) -> u f (\_6155 _6156 _6157-> _term_1); (9,f) -> u f (\_6158 _6159 _6160-> _term_1); (10,f) -> u f (\_6161-> _term_1); (11,f) -> u f (\_6162-> _term_1); (12,f) -> u f (\_6163-> _term_1); (13,f) -> u f (\_6164-> _term_1); (14,f) -> u f (\_6165 _6166 _6167 _6168 _6169 _6170-> _term_1); (15,f) -> u f (\_6171 _6172-> (u (u fm_term_inline_reduce _6172) _defs_2)); }))))
fm_term_inline = (\_term_1-> (\_defs_2-> (let _6173 = (u (u fm_term_inline_reduce _term_1) _defs_2) in (case _6173 of {(0,f) -> u f (\_6174 _6175-> (u (u fm_term_var _6174) _6175)); (1,f) -> u f (\_6176-> (u fm_term_ref _6176)); (2,f) -> u f (fm_term_typ); (3,f) -> u f (\_6177 _6178 _6179 _6180 _6181-> (u (u (u (u (u fm_term_all _6177) _6178) _6179) (u (u fm_term_inline _6180) _defs_2)) (\_s_8-> (\_x_9-> (u (u fm_term_inline (u (u _6181 _s_8) _x_9)) _defs_2))))); (4,f) -> u f (\_6182 _6183-> (u (u fm_term_lam _6182) (\_x_5-> (u (u fm_term_inline (u _6183 _x_5)) _defs_2)))); (5,f) -> u f (\_6184 _6185-> (u (u fm_term_app (u (u fm_term_inline _6184) _defs_2)) (u (u fm_term_inline _6185) _defs_2))); (6,f) -> u f (\_6186 _6187 _6188-> (u (u (u fm_term_let _6186) (u (u fm_term_inline _6187) _defs_2)) (\_x_6-> (u (u fm_term_inline (u _6188 _x_6)) _defs_2)))); (7,f) -> u f (\_6189 _6190 _6191-> (u (u (u fm_term_def _6189) (u (u fm_term_inline _6190) _defs_2)) (\_x_6-> (u (u fm_term_inline (u _6191 _x_6)) _defs_2)))); (8,f) -> u f (\_6192 _6193 _6194-> (u (u (u fm_term_ann _6192) (u (u fm_term_inline _6193) _defs_2)) (u (u fm_term_inline _6194) _defs_2))); (9,f) -> u f (\_6195 _6196 _6197-> (u (u (u fm_term_gol _6195) _6196) _6197)); (10,f) -> u f (\_6198-> (u fm_term_hol _6198)); (11,f) -> u f (\_6199-> (u fm_term_nat _6199)); (12,f) -> u f (\_6200-> (u fm_term_chr _6200)); (13,f) -> u f (\_6201-> (u fm_term_str _6201)); (14,f) -> u f (\_6202 _6203 _6204 _6205 _6206 _6207-> _term_1); (15,f) -> u f (\_6208 _6209-> (u (u fm_term_inline _6209) _defs_2)); }))))
map_values_go = (\_xs_2-> (\_list_3-> (let _6210 = _xs_2 in (case _6210 of {(0,f) -> u f (_list_3); (1,f) -> u f (\_6211 _6212 _6213-> (let _list0_7=(let _6214 = _6211 in (case _6214 of {(0,f) -> u f (_list_3); (1,f) -> u f (\_6215-> (u (u list_cons _6215) _list_3)); })) in (let _list1_8=(u (u map_values_go _6212) _list0_7) in (let _list2_9=(u (u map_values_go _6213) _list1_8) in _list2_9)))); }))))
map_values = (\_xs_2-> (u (u map_values_go _xs_2) list_nil))
fm_term_core_var_name = (\_indx_1-> (\_name_2-> (\_brui_3-> (\_vars_4-> (let _6216 = _indx_1 in (if _6216==0 then (let _6217 = _brui_3 in (if _6217==0 then _name_2 else (((_name_2::String) ++ ((("^"::String) ++ (u nat_show _brui_3))))))) else (let _6218 = _vars_4 in (case _6218 of {(0,f) -> u f ("unbound"); (1,f) -> u f (\_6219 _6220-> (let _brui_8=(let _6221 = (((_name_2::String) == _6219)) in (if _6221 then (u nat_succ _brui_3) else _brui_3)) in (u (u (u (u fm_term_core_var_name (_6216-1)) _name_2) _brui_8) _6220))); }))))))))
fm_name_show = (\_name_1-> _name_1)
bits_to_nat = (\_b_1-> (let _6222 = _b_1 in (case _6222 of {(0,f) -> u f (0); (1,f) -> u f (\_6223-> (((2::Integer) * (u bits_to_nat _6223)))); (2,f) -> u f (\_6224-> (u nat_succ (((2::Integer) * (u bits_to_nat _6224))))); })))
u16_show_hex = (\_a_1-> (let _6225 = _a_1 in (u (u nat_to_string_base 16) (u bits_to_nat (u word_to_bits (u16_to_word _6225))))))
fm_escape_char = (\_chr_1-> (let _6226 = (((_chr_1::Word16) == fm_backslash)) in (if _6226 then (u (u string_cons fm_backslash) (u (u string_cons _chr_1) string_nil)) else (let _6227 = (((_chr_1::Word16) == 34)) in (if _6227 then (u (u string_cons fm_backslash) (u (u string_cons _chr_1) string_nil)) else (let _6228 = (((_chr_1::Word16) == 39)) in (if _6228 then (u (u string_cons fm_backslash) (u (u string_cons _chr_1) string_nil)) else (let _6229 = (u (u (u u16_btw 32) _chr_1) 126) in (if _6229 then (u (u string_cons _chr_1) string_nil) else (u string_flatten (u (u list_cons (u (u string_cons fm_backslash) string_nil)) (u (u list_cons "u{") (u (u list_cons (u u16_show_hex _chr_1)) (u (u list_cons "}") (u (u list_cons string_nil) list_nil)))))))))))))))
fm_escape = (\_str_1-> (let _6230 = _str_1 in (if null (_6230::String) then string_nil else (let _head_4=(u fm_escape_char (fromIntegral (fromEnum (head _6230 :: Char)) :: Word16)) in (let _tail_5=(u fm_escape (tail _6230)) in (((_head_4::String) ++ _tail_5)))))))
fm_term_core = (\_term_1-> (\_indx_2-> (\_vars_3-> (let _6231 = _term_1 in (case _6231 of {(0,f) -> u f (\_6232 _6233-> (u (u (u (u fm_term_core_var_name (u nat_pred (((_indx_2::Integer) - _6233)))) _6232) 0) _vars_3)); (1,f) -> u f (\_6234-> (u fm_name_show _6234)); (2,f) -> u f ("*"); (3,f) -> u f (\_6235 _6236 _6237 _6238 _6239-> (let _eras_9=_6235 in (let _init_10=(let _6240 = _eras_9 in (if _6240 then "%" else "@")) in (let _self_11=(u fm_name_show _6236) in (let _name_12=(u fm_name_show _6237) in (let _xtyp_13=(u (u (u fm_term_core _6238) _indx_2) _vars_3) in (let _body_14=(u (u (u fm_term_core (u (u _6239 (u (u fm_term_var _6236) _indx_2)) (u (u fm_term_var _6237) (u nat_succ _indx_2)))) (u nat_succ (u nat_succ _indx_2))) (u (u list_cons _6237) (u (u list_cons _6236) _vars_3))) in (u string_flatten (u (u list_cons _init_10) (u (u list_cons _self_11) (u (u list_cons "(") (u (u list_cons _name_12) (u (u list_cons ":") (u (u list_cons _xtyp_13) (u (u list_cons ") ") (u (u list_cons _body_14) list_nil)))))))))))))))); (4,f) -> u f (\_6241 _6242-> (let _name_6=(u fm_name_show _6241) in (let _body_7=(u (u (u fm_term_core (u _6242 (u (u fm_term_var _6241) _indx_2))) (u nat_succ _indx_2)) (u (u list_cons _6241) _vars_3)) in (u string_flatten (u (u list_cons "#") (u (u list_cons _name_6) (u (u list_cons " ") (u (u list_cons _body_7) list_nil)))))))); (5,f) -> u f (\_6243 _6244-> (let _func_6=(u (u (u fm_term_core _6243) _indx_2) _vars_3) in (let _argm_7=(u (u (u fm_term_core _6244) _indx_2) _vars_3) in (u string_flatten (u (u list_cons "(") (u (u list_cons _func_6) (u (u list_cons " ") (u (u list_cons _argm_7) (u (u list_cons ")") list_nil))))))))); (6,f) -> u f (\_6245 _6246 _6247-> (let _name_7=(u fm_name_show _6245) in (let _expr_8=(u (u (u fm_term_core _6246) _indx_2) _vars_3) in (let _body_9=(u (u (u fm_term_core (u _6247 (u (u fm_term_var _6245) _indx_2))) (u nat_succ _indx_2)) (u (u list_cons _6245) _vars_3)) in (u string_flatten (u (u list_cons "!") (u (u list_cons _name_7) (u (u list_cons " = ") (u (u list_cons _expr_8) (u (u list_cons "; ") (u (u list_cons _body_9) list_nil))))))))))); (7,f) -> u f (\_6248 _6249 _6250-> (let _name_7=(u fm_name_show _6248) in (let _expr_8=(u (u (u fm_term_core _6249) _indx_2) _vars_3) in (let _body_9=(u (u (u fm_term_core (u _6250 (u (u fm_term_var _6248) _indx_2))) (u nat_succ _indx_2)) (u (u list_cons _6248) _vars_3)) in (u string_flatten (u (u list_cons "$") (u (u list_cons _name_7) (u (u list_cons " = ") (u (u list_cons _expr_8) (u (u list_cons "; ") (u (u list_cons _body_9) list_nil))))))))))); (8,f) -> u f (\_6251 _6252 _6253-> (let _term_7=(u (u (u fm_term_core _6252) _indx_2) _vars_3) in (let _type_8=(u (u (u fm_term_core _6253) _indx_2) _vars_3) in (u string_flatten (u (u list_cons "{") (u (u list_cons _term_7) (u (u list_cons ":") (u (u list_cons _type_8) (u (u list_cons "}") list_nil))))))))); (9,f) -> u f (\_6254 _6255 _6256-> "<GOL>"); (10,f) -> u f (\_6257-> "<HOL>"); (11,f) -> u f (\_6258-> (u string_flatten (u (u list_cons "+") (u (u list_cons (u nat_show _6258)) list_nil)))); (12,f) -> u f (\_6259-> (u string_flatten (u (u list_cons "'") (u (u list_cons (u fm_escape_char _6259)) (u (u list_cons "'") list_nil))))); (13,f) -> u f (\_6260-> (u string_flatten (u (u list_cons "\"") (u (u list_cons (u fm_escape _6260)) (u (u list_cons "\"") list_nil))))); (14,f) -> u f (\_6261 _6262 _6263 _6264 _6265 _6266-> "<CSE>"); (15,f) -> u f (\_6267 _6268-> (u (u (u fm_term_core _6268) _indx_2) _vars_3)); })))))
fm_defs_core = (\_defs_1-> (let _result_2="" in (let _result_3=(u (u (u list_for (u map_values _defs_1)) _result_2) (\_defn_3-> (\_result_4-> (let _6269 = _defn_3 in (case _6269 of {(0,f) -> u f (\_6270 _6271 _6272 _6273 _6274 _6275-> (let _6276 = _6275 in (case _6276 of {(0,f) -> u f (_result_4); (1,f) -> u f (_result_4); (2,f) -> u f ((let _name_11=_6272 in (let _term_12=(u (u (u fm_term_core _6273) 0) list_nil) in (let _type_13=(u (u (u fm_term_core _6274) 0) list_nil) in (u string_flatten (u (u list_cons _result_4) (u (u list_cons _name_11) (u (u list_cons " : ") (u (u list_cons _type_13) (u (u list_cons " = ") (u (u list_cons _term_12) (u (u list_cons ";\n") list_nil)))))))))))); (3,f) -> u f (\_6277-> _result_4); }))); }))))) in _result_3)))
fm_to_core_io_one = (\_name_1-> (u (u (u io_monad (\_m_bind_2-> (\_m_pure_3-> _m_bind_2))) (u (u fm_synth_one _name_1) map_new)) (\_new_defs_2-> (let _defs_3=(let _6278 = _new_defs_2 in (case _6278 of {(0,f) -> u f (map_new); (1,f) -> u f (\_6279-> _6279); })) in (let _defs_4=(u (u map_map (\_defn_4-> (let _6280 = _defn_4 in (case _6280 of {(0,f) -> u f (\_6281 _6282 _6283 _6284 _6285 _6286-> (let _term_11=(u (u fm_term_inline _6284) _defs_3) in (let _type_12=(u (u fm_term_inline _6285) _defs_3) in (u (u (u (u (u (u fm_def_new _6281) _6282) _6283) _term_11) _type_12) _6286)))); })))) _defs_3) in (u (u io_monad (\_m_bind_5-> (\_m_pure_6-> _m_pure_6))) (u fm_defs_core _defs_4)))))))
io_print = (\_text_1-> (u (u (u io_ask "print") _text_1) (\_skip_2-> (u io_end unit_new))))
maybe_bind = (\_m_3-> (\_f_4-> (let _6287 = _m_3 in (case _6287 of {(0,f) -> u f (maybe_none); (1,f) -> u f (\_6288-> (u _f_4 _6288)); }))))
maybe_monad = (\_new_2-> (u (u _new_2 maybe_bind) maybe_some))
fm_term_show_as_nat_go = (\_term_1-> (let _6289 = _term_1 in (case _6289 of {(0,f) -> u f (\_6290 _6291-> maybe_none); (1,f) -> u f (\_6292-> (let _6293 = (((_6292::String) == "Nat.zero")) in (if _6293 then (u maybe_some 0) else maybe_none))); (2,f) -> u f (maybe_none); (3,f) -> u f (\_6294 _6295 _6296 _6297 _6298-> maybe_none); (4,f) -> u f (\_6299 _6300-> maybe_none); (5,f) -> u f (\_6301 _6302-> (let _6303 = _6301 in (case _6303 of {(0,f) -> u f (\_6304 _6305-> maybe_none); (1,f) -> u f (\_6306-> (let _6307 = (((_6306::String) == "Nat.succ")) in (if _6307 then (u (u (u maybe_monad (\_m_bind_5-> (\_m_pure_6-> _m_bind_5))) (u fm_term_show_as_nat_go _6302)) (\_pred_5-> (u (u maybe_monad (\_m_bind_6-> (\_m_pure_7-> _m_pure_7))) (u nat_succ _pred_5)))) else maybe_none))); (2,f) -> u f (maybe_none); (3,f) -> u f (\_6308 _6309 _6310 _6311 _6312-> maybe_none); (4,f) -> u f (\_6313 _6314-> maybe_none); (5,f) -> u f (\_6315 _6316-> maybe_none); (6,f) -> u f (\_6317 _6318 _6319-> maybe_none); (7,f) -> u f (\_6320 _6321 _6322-> maybe_none); (8,f) -> u f (\_6323 _6324 _6325-> maybe_none); (9,f) -> u f (\_6326 _6327 _6328-> maybe_none); (10,f) -> u f (\_6329-> maybe_none); (11,f) -> u f (\_6330-> maybe_none); (12,f) -> u f (\_6331-> maybe_none); (13,f) -> u f (\_6332-> maybe_none); (14,f) -> u f (\_6333 _6334 _6335 _6336 _6337 _6338-> maybe_none); (15,f) -> u f (\_6339 _6340-> maybe_none); }))); (6,f) -> u f (\_6341 _6342 _6343-> maybe_none); (7,f) -> u f (\_6344 _6345 _6346-> maybe_none); (8,f) -> u f (\_6347 _6348 _6349-> maybe_none); (9,f) -> u f (\_6350 _6351 _6352-> maybe_none); (10,f) -> u f (\_6353-> maybe_none); (11,f) -> u f (\_6354-> maybe_none); (12,f) -> u f (\_6355-> maybe_none); (13,f) -> u f (\_6356-> maybe_none); (14,f) -> u f (\_6357 _6358 _6359 _6360 _6361 _6362-> maybe_none); (15,f) -> u f (\_6363 _6364-> maybe_none); })))
fm_term_show_as_nat = (\_term_1-> (u (u maybe_mapped (u fm_term_show_as_nat_go _term_1)) nat_show))
fm_term_show_is_ref = (\_term_1-> (\_name_2-> (let _6365 = _term_1 in (case _6365 of {(0,f) -> u f (\_6366 _6367-> bool_false); (1,f) -> u f (\_6368-> (((_name_2::String) == _6368))); (2,f) -> u f (bool_false); (3,f) -> u f (\_6369 _6370 _6371 _6372 _6373-> bool_false); (4,f) -> u f (\_6374 _6375-> bool_false); (5,f) -> u f (\_6376 _6377-> bool_false); (6,f) -> u f (\_6378 _6379 _6380-> bool_false); (7,f) -> u f (\_6381 _6382 _6383-> bool_false); (8,f) -> u f (\_6384 _6385 _6386-> bool_false); (9,f) -> u f (\_6387 _6388 _6389-> bool_false); (10,f) -> u f (\_6390-> bool_false); (11,f) -> u f (\_6391-> bool_false); (12,f) -> u f (\_6392-> bool_false); (13,f) -> u f (\_6393-> bool_false); (14,f) -> u f (\_6394 _6395 _6396 _6397 _6398 _6399-> bool_false); (15,f) -> u f (\_6400 _6401-> bool_false); }))))
nat_eql = (\a0-> \a1-> ((a0::Integer) == a1))
fm_term_show_app = (\_term_1-> (\_path_2-> (\_args_3-> (let _6402 = _term_1 in (case _6402 of {(0,f) -> u f (\_6403 _6404-> (let _arity_6=(u list_length _args_3) in (let _6405 = (((u (u fm_term_show_is_ref _term_1) "Equal") && (((_arity_6::Integer) == 3)))) in (if _6405 then (let _func_7=(u (u fm_term_show_go _term_1) _path_2) in (let _eq_lft_8=(u (u maybe_default "?") (u (u list_at 1) _args_3)) in (let _eq_rgt_9=(u (u maybe_default "?") (u (u list_at 2) _args_3)) in (u string_flatten (u (u list_cons _eq_lft_8) (u (u list_cons " == ") (u (u list_cons _eq_rgt_9) list_nil))))))) else (let _func_7=(u (u fm_term_show_go _term_1) _path_2) in (let _wrap_8=(let _6406 = _func_7 in (if null (_6406::String) then bool_false else ((((fromIntegral (fromEnum (head _6406 :: Char)) :: Word16)::Word16) == 40)))) in (let _args_9=(u (u string_join ",") _args_3) in (let _func_10=(let _6407 = _wrap_8 in (if _6407 then (u string_flatten (u (u list_cons "(") (u (u list_cons _func_7) (u (u list_cons ")") list_nil)))) else _func_7)) in (u string_flatten (u (u list_cons _func_10) (u (u list_cons "(") (u (u list_cons _args_9) (u (u list_cons ")") list_nil))))))))))))); (1,f) -> u f (\_6408-> (let _arity_5=(u list_length _args_3) in (let _6409 = (((u (u fm_term_show_is_ref _term_1) "Equal") && (((_arity_5::Integer) == 3)))) in (if _6409 then (let _func_6=(u (u fm_term_show_go _term_1) _path_2) in (let _eq_lft_7=(u (u maybe_default "?") (u (u list_at 1) _args_3)) in (let _eq_rgt_8=(u (u maybe_default "?") (u (u list_at 2) _args_3)) in (u string_flatten (u (u list_cons _eq_lft_7) (u (u list_cons " == ") (u (u list_cons _eq_rgt_8) list_nil))))))) else (let _func_6=(u (u fm_term_show_go _term_1) _path_2) in (let _wrap_7=(let _6410 = _func_6 in (if null (_6410::String) then bool_false else ((((fromIntegral (fromEnum (head _6410 :: Char)) :: Word16)::Word16) == 40)))) in (let _args_8=(u (u string_join ",") _args_3) in (let _func_9=(let _6411 = _wrap_7 in (if _6411 then (u string_flatten (u (u list_cons "(") (u (u list_cons _func_6) (u (u list_cons ")") list_nil)))) else _func_6)) in (u string_flatten (u (u list_cons _func_9) (u (u list_cons "(") (u (u list_cons _args_8) (u (u list_cons ")") list_nil))))))))))))); (2,f) -> u f ((let _arity_4=(u list_length _args_3) in (let _6412 = (((u (u fm_term_show_is_ref _term_1) "Equal") && (((_arity_4::Integer) == 3)))) in (if _6412 then (let _func_5=(u (u fm_term_show_go _term_1) _path_2) in (let _eq_lft_6=(u (u maybe_default "?") (u (u list_at 1) _args_3)) in (let _eq_rgt_7=(u (u maybe_default "?") (u (u list_at 2) _args_3)) in (u string_flatten (u (u list_cons _eq_lft_6) (u (u list_cons " == ") (u (u list_cons _eq_rgt_7) list_nil))))))) else (let _func_5=(u (u fm_term_show_go _term_1) _path_2) in (let _wrap_6=(let _6413 = _func_5 in (if null (_6413::String) then bool_false else ((((fromIntegral (fromEnum (head _6413 :: Char)) :: Word16)::Word16) == 40)))) in (let _args_7=(u (u string_join ",") _args_3) in (let _func_8=(let _6414 = _wrap_6 in (if _6414 then (u string_flatten (u (u list_cons "(") (u (u list_cons _func_5) (u (u list_cons ")") list_nil)))) else _func_5)) in (u string_flatten (u (u list_cons _func_8) (u (u list_cons "(") (u (u list_cons _args_7) (u (u list_cons ")") list_nil))))))))))))); (3,f) -> u f (\_6415 _6416 _6417 _6418 _6419-> (let _arity_9=(u list_length _args_3) in (let _6420 = (((u (u fm_term_show_is_ref _term_1) "Equal") && (((_arity_9::Integer) == 3)))) in (if _6420 then (let _func_10=(u (u fm_term_show_go _term_1) _path_2) in (let _eq_lft_11=(u (u maybe_default "?") (u (u list_at 1) _args_3)) in (let _eq_rgt_12=(u (u maybe_default "?") (u (u list_at 2) _args_3)) in (u string_flatten (u (u list_cons _eq_lft_11) (u (u list_cons " == ") (u (u list_cons _eq_rgt_12) list_nil))))))) else (let _func_10=(u (u fm_term_show_go _term_1) _path_2) in (let _wrap_11=(let _6421 = _func_10 in (if null (_6421::String) then bool_false else ((((fromIntegral (fromEnum (head _6421 :: Char)) :: Word16)::Word16) == 40)))) in (let _args_12=(u (u string_join ",") _args_3) in (let _func_13=(let _6422 = _wrap_11 in (if _6422 then (u string_flatten (u (u list_cons "(") (u (u list_cons _func_10) (u (u list_cons ")") list_nil)))) else _func_10)) in (u string_flatten (u (u list_cons _func_13) (u (u list_cons "(") (u (u list_cons _args_12) (u (u list_cons ")") list_nil))))))))))))); (4,f) -> u f (\_6423 _6424-> (let _arity_6=(u list_length _args_3) in (let _6425 = (((u (u fm_term_show_is_ref _term_1) "Equal") && (((_arity_6::Integer) == 3)))) in (if _6425 then (let _func_7=(u (u fm_term_show_go _term_1) _path_2) in (let _eq_lft_8=(u (u maybe_default "?") (u (u list_at 1) _args_3)) in (let _eq_rgt_9=(u (u maybe_default "?") (u (u list_at 2) _args_3)) in (u string_flatten (u (u list_cons _eq_lft_8) (u (u list_cons " == ") (u (u list_cons _eq_rgt_9) list_nil))))))) else (let _func_7=(u (u fm_term_show_go _term_1) _path_2) in (let _wrap_8=(let _6426 = _func_7 in (if null (_6426::String) then bool_false else ((((fromIntegral (fromEnum (head _6426 :: Char)) :: Word16)::Word16) == 40)))) in (let _args_9=(u (u string_join ",") _args_3) in (let _func_10=(let _6427 = _wrap_8 in (if _6427 then (u string_flatten (u (u list_cons "(") (u (u list_cons _func_7) (u (u list_cons ")") list_nil)))) else _func_7)) in (u string_flatten (u (u list_cons _func_10) (u (u list_cons "(") (u (u list_cons _args_9) (u (u list_cons ")") list_nil))))))))))))); (5,f) -> u f (\_6428 _6429-> (let _argm_6=(u (u fm_term_show_go _6429) (u fm_mpath_i _path_2)) in (u (u (u fm_term_show_app _6428) (u fm_mpath_o _path_2)) (u (u list_cons _argm_6) _args_3)))); (6,f) -> u f (\_6430 _6431 _6432-> (let _arity_7=(u list_length _args_3) in (let _6433 = (((u (u fm_term_show_is_ref _term_1) "Equal") && (((_arity_7::Integer) == 3)))) in (if _6433 then (let _func_8=(u (u fm_term_show_go _term_1) _path_2) in (let _eq_lft_9=(u (u maybe_default "?") (u (u list_at 1) _args_3)) in (let _eq_rgt_10=(u (u maybe_default "?") (u (u list_at 2) _args_3)) in (u string_flatten (u (u list_cons _eq_lft_9) (u (u list_cons " == ") (u (u list_cons _eq_rgt_10) list_nil))))))) else (let _func_8=(u (u fm_term_show_go _term_1) _path_2) in (let _wrap_9=(let _6434 = _func_8 in (if null (_6434::String) then bool_false else ((((fromIntegral (fromEnum (head _6434 :: Char)) :: Word16)::Word16) == 40)))) in (let _args_10=(u (u string_join ",") _args_3) in (let _func_11=(let _6435 = _wrap_9 in (if _6435 then (u string_flatten (u (u list_cons "(") (u (u list_cons _func_8) (u (u list_cons ")") list_nil)))) else _func_8)) in (u string_flatten (u (u list_cons _func_11) (u (u list_cons "(") (u (u list_cons _args_10) (u (u list_cons ")") list_nil))))))))))))); (7,f) -> u f (\_6436 _6437 _6438-> (let _arity_7=(u list_length _args_3) in (let _6439 = (((u (u fm_term_show_is_ref _term_1) "Equal") && (((_arity_7::Integer) == 3)))) in (if _6439 then (let _func_8=(u (u fm_term_show_go _term_1) _path_2) in (let _eq_lft_9=(u (u maybe_default "?") (u (u list_at 1) _args_3)) in (let _eq_rgt_10=(u (u maybe_default "?") (u (u list_at 2) _args_3)) in (u string_flatten (u (u list_cons _eq_lft_9) (u (u list_cons " == ") (u (u list_cons _eq_rgt_10) list_nil))))))) else (let _func_8=(u (u fm_term_show_go _term_1) _path_2) in (let _wrap_9=(let _6440 = _func_8 in (if null (_6440::String) then bool_false else ((((fromIntegral (fromEnum (head _6440 :: Char)) :: Word16)::Word16) == 40)))) in (let _args_10=(u (u string_join ",") _args_3) in (let _func_11=(let _6441 = _wrap_9 in (if _6441 then (u string_flatten (u (u list_cons "(") (u (u list_cons _func_8) (u (u list_cons ")") list_nil)))) else _func_8)) in (u string_flatten (u (u list_cons _func_11) (u (u list_cons "(") (u (u list_cons _args_10) (u (u list_cons ")") list_nil))))))))))))); (8,f) -> u f (\_6442 _6443 _6444-> (let _arity_7=(u list_length _args_3) in (let _6445 = (((u (u fm_term_show_is_ref _term_1) "Equal") && (((_arity_7::Integer) == 3)))) in (if _6445 then (let _func_8=(u (u fm_term_show_go _term_1) _path_2) in (let _eq_lft_9=(u (u maybe_default "?") (u (u list_at 1) _args_3)) in (let _eq_rgt_10=(u (u maybe_default "?") (u (u list_at 2) _args_3)) in (u string_flatten (u (u list_cons _eq_lft_9) (u (u list_cons " == ") (u (u list_cons _eq_rgt_10) list_nil))))))) else (let _func_8=(u (u fm_term_show_go _term_1) _path_2) in (let _wrap_9=(let _6446 = _func_8 in (if null (_6446::String) then bool_false else ((((fromIntegral (fromEnum (head _6446 :: Char)) :: Word16)::Word16) == 40)))) in (let _args_10=(u (u string_join ",") _args_3) in (let _func_11=(let _6447 = _wrap_9 in (if _6447 then (u string_flatten (u (u list_cons "(") (u (u list_cons _func_8) (u (u list_cons ")") list_nil)))) else _func_8)) in (u string_flatten (u (u list_cons _func_11) (u (u list_cons "(") (u (u list_cons _args_10) (u (u list_cons ")") list_nil))))))))))))); (9,f) -> u f (\_6448 _6449 _6450-> (let _arity_7=(u list_length _args_3) in (let _6451 = (((u (u fm_term_show_is_ref _term_1) "Equal") && (((_arity_7::Integer) == 3)))) in (if _6451 then (let _func_8=(u (u fm_term_show_go _term_1) _path_2) in (let _eq_lft_9=(u (u maybe_default "?") (u (u list_at 1) _args_3)) in (let _eq_rgt_10=(u (u maybe_default "?") (u (u list_at 2) _args_3)) in (u string_flatten (u (u list_cons _eq_lft_9) (u (u list_cons " == ") (u (u list_cons _eq_rgt_10) list_nil))))))) else (let _func_8=(u (u fm_term_show_go _term_1) _path_2) in (let _wrap_9=(let _6452 = _func_8 in (if null (_6452::String) then bool_false else ((((fromIntegral (fromEnum (head _6452 :: Char)) :: Word16)::Word16) == 40)))) in (let _args_10=(u (u string_join ",") _args_3) in (let _func_11=(let _6453 = _wrap_9 in (if _6453 then (u string_flatten (u (u list_cons "(") (u (u list_cons _func_8) (u (u list_cons ")") list_nil)))) else _func_8)) in (u string_flatten (u (u list_cons _func_11) (u (u list_cons "(") (u (u list_cons _args_10) (u (u list_cons ")") list_nil))))))))))))); (10,f) -> u f (\_6454-> (let _arity_5=(u list_length _args_3) in (let _6455 = (((u (u fm_term_show_is_ref _term_1) "Equal") && (((_arity_5::Integer) == 3)))) in (if _6455 then (let _func_6=(u (u fm_term_show_go _term_1) _path_2) in (let _eq_lft_7=(u (u maybe_default "?") (u (u list_at 1) _args_3)) in (let _eq_rgt_8=(u (u maybe_default "?") (u (u list_at 2) _args_3)) in (u string_flatten (u (u list_cons _eq_lft_7) (u (u list_cons " == ") (u (u list_cons _eq_rgt_8) list_nil))))))) else (let _func_6=(u (u fm_term_show_go _term_1) _path_2) in (let _wrap_7=(let _6456 = _func_6 in (if null (_6456::String) then bool_false else ((((fromIntegral (fromEnum (head _6456 :: Char)) :: Word16)::Word16) == 40)))) in (let _args_8=(u (u string_join ",") _args_3) in (let _func_9=(let _6457 = _wrap_7 in (if _6457 then (u string_flatten (u (u list_cons "(") (u (u list_cons _func_6) (u (u list_cons ")") list_nil)))) else _func_6)) in (u string_flatten (u (u list_cons _func_9) (u (u list_cons "(") (u (u list_cons _args_8) (u (u list_cons ")") list_nil))))))))))))); (11,f) -> u f (\_6458-> (let _arity_5=(u list_length _args_3) in (let _6459 = (((u (u fm_term_show_is_ref _term_1) "Equal") && (((_arity_5::Integer) == 3)))) in (if _6459 then (let _func_6=(u (u fm_term_show_go _term_1) _path_2) in (let _eq_lft_7=(u (u maybe_default "?") (u (u list_at 1) _args_3)) in (let _eq_rgt_8=(u (u maybe_default "?") (u (u list_at 2) _args_3)) in (u string_flatten (u (u list_cons _eq_lft_7) (u (u list_cons " == ") (u (u list_cons _eq_rgt_8) list_nil))))))) else (let _func_6=(u (u fm_term_show_go _term_1) _path_2) in (let _wrap_7=(let _6460 = _func_6 in (if null (_6460::String) then bool_false else ((((fromIntegral (fromEnum (head _6460 :: Char)) :: Word16)::Word16) == 40)))) in (let _args_8=(u (u string_join ",") _args_3) in (let _func_9=(let _6461 = _wrap_7 in (if _6461 then (u string_flatten (u (u list_cons "(") (u (u list_cons _func_6) (u (u list_cons ")") list_nil)))) else _func_6)) in (u string_flatten (u (u list_cons _func_9) (u (u list_cons "(") (u (u list_cons _args_8) (u (u list_cons ")") list_nil))))))))))))); (12,f) -> u f (\_6462-> (let _arity_5=(u list_length _args_3) in (let _6463 = (((u (u fm_term_show_is_ref _term_1) "Equal") && (((_arity_5::Integer) == 3)))) in (if _6463 then (let _func_6=(u (u fm_term_show_go _term_1) _path_2) in (let _eq_lft_7=(u (u maybe_default "?") (u (u list_at 1) _args_3)) in (let _eq_rgt_8=(u (u maybe_default "?") (u (u list_at 2) _args_3)) in (u string_flatten (u (u list_cons _eq_lft_7) (u (u list_cons " == ") (u (u list_cons _eq_rgt_8) list_nil))))))) else (let _func_6=(u (u fm_term_show_go _term_1) _path_2) in (let _wrap_7=(let _6464 = _func_6 in (if null (_6464::String) then bool_false else ((((fromIntegral (fromEnum (head _6464 :: Char)) :: Word16)::Word16) == 40)))) in (let _args_8=(u (u string_join ",") _args_3) in (let _func_9=(let _6465 = _wrap_7 in (if _6465 then (u string_flatten (u (u list_cons "(") (u (u list_cons _func_6) (u (u list_cons ")") list_nil)))) else _func_6)) in (u string_flatten (u (u list_cons _func_9) (u (u list_cons "(") (u (u list_cons _args_8) (u (u list_cons ")") list_nil))))))))))))); (13,f) -> u f (\_6466-> (let _arity_5=(u list_length _args_3) in (let _6467 = (((u (u fm_term_show_is_ref _term_1) "Equal") && (((_arity_5::Integer) == 3)))) in (if _6467 then (let _func_6=(u (u fm_term_show_go _term_1) _path_2) in (let _eq_lft_7=(u (u maybe_default "?") (u (u list_at 1) _args_3)) in (let _eq_rgt_8=(u (u maybe_default "?") (u (u list_at 2) _args_3)) in (u string_flatten (u (u list_cons _eq_lft_7) (u (u list_cons " == ") (u (u list_cons _eq_rgt_8) list_nil))))))) else (let _func_6=(u (u fm_term_show_go _term_1) _path_2) in (let _wrap_7=(let _6468 = _func_6 in (if null (_6468::String) then bool_false else ((((fromIntegral (fromEnum (head _6468 :: Char)) :: Word16)::Word16) == 40)))) in (let _args_8=(u (u string_join ",") _args_3) in (let _func_9=(let _6469 = _wrap_7 in (if _6469 then (u string_flatten (u (u list_cons "(") (u (u list_cons _func_6) (u (u list_cons ")") list_nil)))) else _func_6)) in (u string_flatten (u (u list_cons _func_9) (u (u list_cons "(") (u (u list_cons _args_8) (u (u list_cons ")") list_nil))))))))))))); (14,f) -> u f (\_6470 _6471 _6472 _6473 _6474 _6475-> (let _arity_10=(u list_length _args_3) in (let _6476 = (((u (u fm_term_show_is_ref _term_1) "Equal") && (((_arity_10::Integer) == 3)))) in (if _6476 then (let _func_11=(u (u fm_term_show_go _term_1) _path_2) in (let _eq_lft_12=(u (u maybe_default "?") (u (u list_at 1) _args_3)) in (let _eq_rgt_13=(u (u maybe_default "?") (u (u list_at 2) _args_3)) in (u string_flatten (u (u list_cons _eq_lft_12) (u (u list_cons " == ") (u (u list_cons _eq_rgt_13) list_nil))))))) else (let _func_11=(u (u fm_term_show_go _term_1) _path_2) in (let _wrap_12=(let _6477 = _func_11 in (if null (_6477::String) then bool_false else ((((fromIntegral (fromEnum (head _6477 :: Char)) :: Word16)::Word16) == 40)))) in (let _args_13=(u (u string_join ",") _args_3) in (let _func_14=(let _6478 = _wrap_12 in (if _6478 then (u string_flatten (u (u list_cons "(") (u (u list_cons _func_11) (u (u list_cons ")") list_nil)))) else _func_11)) in (u string_flatten (u (u list_cons _func_14) (u (u list_cons "(") (u (u list_cons _args_13) (u (u list_cons ")") list_nil))))))))))))); (15,f) -> u f (\_6479 _6480-> (u (u (u fm_term_show_app _6480) _path_2) _args_3)); })))))
map_to_list_go = (\_xs_2-> (\_key_3-> (\_list_4-> (let _6481 = _xs_2 in (case _6481 of {(0,f) -> u f (_list_4); (1,f) -> u f (\_6482 _6483 _6484-> (let _list0_8=(let _6485 = _6482 in (case _6485 of {(0,f) -> u f (_list_4); (1,f) -> u f (\_6486-> (u (u list_cons (u (u pair_new (u bits_reverse _key_3)) _6486)) _list_4)); })) in (let _list1_9=(u (u (u map_to_list_go _6483) (u bits_o _key_3)) _list0_8) in (let _list2_10=(u (u (u map_to_list_go _6484) (u bits_i _key_3)) _list1_9) in _list2_10)))); })))))
map_to_list = (\_xs_2-> (u list_reverse (u (u (u map_to_list_go _xs_2) bits_e) list_nil)))
bits_chunks_of_go = (\_len_1-> (\_bits_2-> (\_need_3-> (\_chunk_4-> (let _6487 = _bits_2 in (case _6487 of {(0,f) -> u f ((u (u list_cons (u bits_reverse _chunk_4)) list_nil)); (1,f) -> u f (\_6488-> (let _6489 = _need_3 in (if _6489==0 then (let _head_6=(u bits_reverse _chunk_4) in (let _tail_7=(u (u (u (u bits_chunks_of_go _len_1) _bits_2) _len_1) bits_e) in (u (u list_cons _head_6) _tail_7))) else (let _chunk_7=(u bits_o _chunk_4) in (u (u (u (u bits_chunks_of_go _len_1) _6488) (_6489-1)) _chunk_7))))); (2,f) -> u f (\_6490-> (let _6491 = _need_3 in (if _6491==0 then (let _head_6=(u bits_reverse _chunk_4) in (let _tail_7=(u (u (u (u bits_chunks_of_go _len_1) _bits_2) _len_1) bits_e) in (u (u list_cons _head_6) _tail_7))) else (let _chunk_7=(u bits_i _chunk_4) in (u (u (u (u bits_chunks_of_go _len_1) _6490) (_6491-1)) _chunk_7))))); }))))))
bits_chunks_of = (\_len_1-> (\_bits_2-> (u (u (u (u bits_chunks_of_go _len_1) _bits_2) _len_1) bits_e)))
word_from_bits = (\_size_1-> (\_bits_2-> (let _6492 = _size_1 in (if _6492==0 then word_e else (let _6493 = _bits_2 in (case _6493 of {(0,f) -> u f ((u word_o (u (u word_from_bits (_6492-1)) bits_e))); (1,f) -> u f (\_6494-> (u word_o (u (u word_from_bits (_6492-1)) _6494))); (2,f) -> u f (\_6495-> (u word_i (u (u word_from_bits (_6492-1)) _6495))); }))))))
fm_name_from_bits = (\_bits_1-> (let _list_2=(u (u bits_chunks_of 6) _bits_1) in (let _name_3=(u (u (u list_fold _list_2) string_nil) (\_bts_3-> (\_name_4-> (let _u16_5=(u u16_new (u (u word_from_bits 16) (u bits_reverse _bts_3))) in (let _chr_6=(let _6496 = (u (u (u u16_btw 0) _u16_5) 25) in (if _6496 then (((_u16_5::Word16) + 65)) else (let _6497 = (u (u (u u16_btw 26) _u16_5) 51) in (if _6497 then (((_u16_5::Word16) + 71)) else (let _6498 = (u (u (u u16_btw 52) _u16_5) 61) in (if _6498 then (((_u16_5::Word16) - 4)) else (let _6499 = (((62::Word16) == _u16_5)) in (if _6499 then 46 else 95)))))))) in (u (u string_cons _chr_6) _name_4)))))) in _name_3)))
fm_term_show_go = (\_term_1-> (\_path_2-> (let _6500 = (u fm_term_show_as_nat _term_1) in (case _6500 of {(0,f) -> u f ((let _6501 = _term_1 in (case _6501 of {(0,f) -> u f (\_6502 _6503-> (u fm_name_show _6502)); (1,f) -> u f (\_6504-> (let _name_4=(u fm_name_show _6504) in (let _6505 = _path_2 in (case _6505 of {(0,f) -> u f (_name_4); (1,f) -> u f (\_6506-> (let _path_val_6=(u (u bits_concat (u fm_path_to_bits _6506)) (u bits_i bits_e)) in (let _path_str_7=(u nat_show (u bits_to_nat _path_val_6)) in (u string_flatten (u (u list_cons _name_4) (u (u list_cons (u (u fm_color "2") ((("-"::String) ++ _path_str_7)))) list_nil)))))); })))); (2,f) -> u f ("Type"); (3,f) -> u f (\_6507 _6508 _6509 _6510 _6511-> (let _eras_8=_6507 in (let _self_9=(u fm_name_show _6508) in (let _name_10=(u fm_name_show _6509) in (let _type_11=(u (u fm_term_show_go _6510) (u fm_mpath_o _path_2)) in (let _open_12=(let _6512 = _eras_8 in (if _6512 then "<" else "(")) in (let _clos_13=(let _6513 = _eras_8 in (if _6513 then ">" else ")")) in (let _body_14=(u (u fm_term_show_go (u (u _6511 (u (u fm_term_var _6508) 0)) (u (u fm_term_var _6509) 0))) (u fm_mpath_i _path_2)) in (u string_flatten (u (u list_cons _self_9) (u (u list_cons _open_12) (u (u list_cons _name_10) (u (u list_cons ":") (u (u list_cons _type_11) (u (u list_cons _clos_13) (u (u list_cons " ") (u (u list_cons _body_14) list_nil))))))))))))))))); (4,f) -> u f (\_6514 _6515-> (let _name_5=(u fm_name_show _6514) in (let _body_6=(u (u fm_term_show_go (u _6515 (u (u fm_term_var _6514) 0))) (u fm_mpath_o _path_2)) in (u string_flatten (u (u list_cons "(") (u (u list_cons _name_5) (u (u list_cons ") ") (u (u list_cons _body_6) list_nil)))))))); (5,f) -> u f (\_6516 _6517-> (u (u (u fm_term_show_app _term_1) _path_2) list_nil)); (6,f) -> u f (\_6518 _6519 _6520-> (let _name_6=(u fm_name_show _6518) in (let _expr_7=(u (u fm_term_show_go _6519) (u fm_mpath_o _path_2)) in (let _body_8=(u (u fm_term_show_go (u _6520 (u (u fm_term_var _6518) 0))) (u fm_mpath_i _path_2)) in (u string_flatten (u (u list_cons "let ") (u (u list_cons _name_6) (u (u list_cons " = ") (u (u list_cons _expr_7) (u (u list_cons "; ") (u (u list_cons _body_8) list_nil))))))))))); (7,f) -> u f (\_6521 _6522 _6523-> (let _name_6=(u fm_name_show _6521) in (let _expr_7=(u (u fm_term_show_go _6522) (u fm_mpath_o _path_2)) in (let _body_8=(u (u fm_term_show_go (u _6523 (u (u fm_term_var _6521) 0))) (u fm_mpath_i _path_2)) in (u string_flatten (u (u list_cons "def ") (u (u list_cons _name_6) (u (u list_cons " = ") (u (u list_cons _expr_7) (u (u list_cons "; ") (u (u list_cons _body_8) list_nil))))))))))); (8,f) -> u f (\_6524 _6525 _6526-> (let _term_6=(u (u fm_term_show_go _6525) (u fm_mpath_o _path_2)) in (let _type_7=(u (u fm_term_show_go _6526) (u fm_mpath_i _path_2)) in (u string_flatten (u (u list_cons _term_6) (u (u list_cons "::") (u (u list_cons _type_7) list_nil))))))); (9,f) -> u f (\_6527 _6528 _6529-> (let _name_6=(u fm_name_show _6527) in (u string_flatten (u (u list_cons "?") (u (u list_cons _name_6) list_nil))))); (10,f) -> u f (\_6530-> "_"); (11,f) -> u f (\_6531-> (u string_flatten (u (u list_cons (u nat_show _6531)) list_nil))); (12,f) -> u f (\_6532-> (u string_flatten (u (u list_cons "'") (u (u list_cons (u fm_escape_char _6532)) (u (u list_cons "'") list_nil))))); (13,f) -> u f (\_6533-> (u string_flatten (u (u list_cons "\"") (u (u list_cons (u fm_escape _6533)) (u (u list_cons "\"") list_nil))))); (14,f) -> u f (\_6534 _6535 _6536 _6537 _6538 _6539-> (let _expr_9=(u (u fm_term_show_go _6535) (u fm_mpath_o _path_2)) in (let _name_10=(u fm_name_show _6536) in (let _wyth_11=(u (u string_join "") (u (u list_mapped _6537) (\_defn_11-> (let _6540 = _defn_11 in (case _6540 of {(0,f) -> u f (\_6541 _6542 _6543 _6544 _6545 _6546-> (let _name_18=(u fm_name_show _6543) in (let _type_19=(u (u fm_term_show_go _6545) maybe_none) in (let _term_20=(u (u fm_term_show_go _6544) maybe_none) in (u string_flatten (u (u list_cons _name_18) (u (u list_cons ": ") (u (u list_cons _type_19) (u (u list_cons " = ") (u (u list_cons _term_20) (u (u list_cons ";") list_nil))))))))))); }))))) in (let _cses_12=(u map_to_list _6538) in (let _cses_13=(u (u string_join "") (u (u list_mapped _cses_12) (\_x_13-> (let _name_14=(u fm_name_from_bits (u pair_fst _x_13)) in (let _term_15=(u (u fm_term_show_go (u pair_snd _x_13)) maybe_none) in (u string_flatten (u (u list_cons _name_14) (u (u list_cons ": ") (u (u list_cons _term_15) (u (u list_cons "; ") list_nil)))))))))) in (let _moti_14=(let _6547 = _6539 in (case _6547 of {(0,f) -> u f (""); (1,f) -> u f (\_6548-> (u string_flatten (u (u list_cons ": ") (u (u list_cons (u (u fm_term_show_go _6548) maybe_none)) list_nil)))); })) in (u string_flatten (u (u list_cons "case ") (u (u list_cons _expr_9) (u (u list_cons " as ") (u (u list_cons _name_10) (u (u list_cons _wyth_11) (u (u list_cons " { ") (u (u list_cons _cses_13) (u (u list_cons "}") (u (u list_cons _moti_14) list_nil))))))))))))))))); (15,f) -> u f (\_6549 _6550-> (u (u fm_term_show_go _6550) _path_2)); }))); (1,f) -> u f (\_6551-> _6551); }))))
fm_term_show = (\_term_1-> (u (u fm_term_show_go _term_1) maybe_none))
fm_error_relevant = (\_errors_1-> (\_got_2-> (let _6552 = _errors_1 in (case _6552 of {(0,f) -> u f (list_nil); (1,f) -> u f (\_6553 _6554-> (let _keep_5=(let _6555 = _6553 in (case _6555 of {(0,f) -> u f (\_6556 _6557 _6558 _6559-> ((not _got_2))); (1,f) -> u f (\_6560 _6561 _6562 _6563 _6564-> bool_true); (2,f) -> u f (\_6565-> bool_false); (3,f) -> u f (\_6566-> bool_false); (4,f) -> u f (\_6567 _6568-> bool_false); (5,f) -> u f (\_6569 _6570-> ((not _got_2))); (6,f) -> u f (\_6571 _6572 _6573-> ((not _got_2))); })) in (let _got_6=(let _6574 = _6553 in (case _6574 of {(0,f) -> u f (\_6575 _6576 _6577 _6578-> bool_true); (1,f) -> u f (\_6579 _6580 _6581 _6582 _6583-> _got_2); (2,f) -> u f (\_6584-> _got_2); (3,f) -> u f (\_6585-> _got_2); (4,f) -> u f (\_6586 _6587-> _got_2); (5,f) -> u f (\_6588 _6589-> bool_true); (6,f) -> u f (\_6590 _6591 _6592-> _got_2); })) in (let _tail_7=(u (u fm_error_relevant _6554) _got_6) in (let _6593 = _keep_5 in (if _6593 then (u (u list_cons _6553) _tail_7) else _tail_7)))))); }))))
fm_context_show = (\_context_1-> (let _6594 = _context_1 in (case _6594 of {(0,f) -> u f (""); (1,f) -> u f (\_6595 _6596-> (let _6597 = _6595 in (case _6597 of {(0,f) -> u f (\_6598 _6599-> (let _name_6=(u fm_name_show _6598) in (let _type_7=(u fm_term_show (u (u fm_term_normalize _6599) map_new)) in (let _rest_8=(u fm_context_show _6596) in (u string_flatten (u (u list_cons _rest_8) (u (u list_cons "- ") (u (u list_cons _name_6) (u (u list_cons ": ") (u (u list_cons _type_7) (u (u list_cons "\n") list_nil))))))))))); }))); })))
fm_term_expand_at = (\_path_1-> (\_term_2-> (\_defs_3-> (u (u (u fm_term_patch_at _path_1) _term_2) (\_term_4-> (let _6600 = _term_4 in (case _6600 of {(0,f) -> u f (\_6601 _6602-> _term_4); (1,f) -> u f (\_6603-> (let _6604 = (u (u fm_get _6603) _defs_3) in (case _6604 of {(0,f) -> u f ((u fm_term_ref _6603)); (1,f) -> u f (\_6605-> (let _6606 = _6605 in (case _6606 of {(0,f) -> u f (\_6607 _6608 _6609 _6610 _6611 _6612-> _6610); }))); }))); (2,f) -> u f (_term_4); (3,f) -> u f (\_6613 _6614 _6615 _6616 _6617-> _term_4); (4,f) -> u f (\_6618 _6619-> _term_4); (5,f) -> u f (\_6620 _6621-> _term_4); (6,f) -> u f (\_6622 _6623 _6624-> _term_4); (7,f) -> u f (\_6625 _6626 _6627-> _term_4); (8,f) -> u f (\_6628 _6629 _6630-> _term_4); (9,f) -> u f (\_6631 _6632 _6633-> _term_4); (10,f) -> u f (\_6634-> _term_4); (11,f) -> u f (\_6635-> _term_4); (12,f) -> u f (\_6636-> _term_4); (13,f) -> u f (\_6637-> _term_4); (14,f) -> u f (\_6638 _6639 _6640 _6641 _6642 _6643-> _term_4); (15,f) -> u f (\_6644 _6645-> _term_4); })))))))
fm_term_expand_ct = (\_term_1-> (\_defs_2-> (\_arity_3-> (let _6646 = _term_1 in (case _6646 of {(0,f) -> u f (\_6647 _6648-> (u (u fm_term_var _6647) _6648)); (1,f) -> u f (\_6649-> (let _expand_5=bool_false in (let _expand_6=(((((((_6649::String) == "Nat.succ")) && (((_arity_3::Integer) > 1)))) || _expand_5)) in (let _expand_7=(((((((_6649::String) == "Nat.zero")) && (((_arity_3::Integer) > 0)))) || _expand_6)) in (let _expand_8=(((((((_6649::String) == "Bool.true")) && (((_arity_3::Integer) > 0)))) || _expand_7)) in (let _expand_9=(((((((_6649::String) == "Bool.false")) && (((_arity_3::Integer) > 0)))) || _expand_8)) in (let _6650 = _expand_9 in (if _6650 then (let _6651 = (u (u fm_get _6649) _defs_2) in (case _6651 of {(0,f) -> u f ((u fm_term_ref _6649)); (1,f) -> u f (\_6652-> (let _6653 = _6652 in (case _6653 of {(0,f) -> u f (\_6654 _6655 _6656 _6657 _6658 _6659-> _6657); }))); })) else (u fm_term_ref _6649))))))))); (2,f) -> u f (fm_term_typ); (3,f) -> u f (\_6660 _6661 _6662 _6663 _6664-> (u (u (u (u (u fm_term_all _6660) _6661) _6662) (u (u (u fm_term_expand_ct _6663) _defs_2) 0)) (\_s_9-> (\_x_10-> (u (u (u fm_term_expand_ct (u (u _6664 _s_9) _x_10)) _defs_2) 0))))); (4,f) -> u f (\_6665 _6666-> (u (u fm_term_lam _6665) (\_x_6-> (u (u (u fm_term_expand_ct (u _6666 _x_6)) _defs_2) 0)))); (5,f) -> u f (\_6667 _6668-> (u (u fm_term_app (u (u (u fm_term_expand_ct _6667) _defs_2) (u nat_succ _arity_3))) (u (u (u fm_term_expand_ct _6668) _defs_2) 0))); (6,f) -> u f (\_6669 _6670 _6671-> (u (u (u fm_term_let _6669) (u (u (u fm_term_expand_ct _6670) _defs_2) 0)) (\_x_7-> (u (u (u fm_term_expand_ct (u _6671 _x_7)) _defs_2) 0)))); (7,f) -> u f (\_6672 _6673 _6674-> (u (u (u fm_term_def _6672) (u (u (u fm_term_expand_ct _6673) _defs_2) 0)) (\_x_7-> (u (u (u fm_term_expand_ct (u _6674 _x_7)) _defs_2) 0)))); (8,f) -> u f (\_6675 _6676 _6677-> (u (u (u fm_term_ann _6675) (u (u (u fm_term_expand_ct _6676) _defs_2) 0)) (u (u (u fm_term_expand_ct _6677) _defs_2) 0))); (9,f) -> u f (\_6678 _6679 _6680-> (u (u (u fm_term_gol _6678) _6679) _6680)); (10,f) -> u f (\_6681-> (u fm_term_hol _6681)); (11,f) -> u f (\_6682-> (u fm_term_nat _6682)); (12,f) -> u f (\_6683-> (u fm_term_chr _6683)); (13,f) -> u f (\_6684-> (u fm_term_str _6684)); (14,f) -> u f (\_6685 _6686 _6687 _6688 _6689 _6690-> _term_1); (15,f) -> u f (\_6691 _6692-> (u (u fm_term_ori _6691) _6692)); })))))
fm_term_expand = (\_dref_1-> (\_term_2-> (\_defs_3-> (let _term_4=(u (u fm_term_normalize _term_2) map_new) in (let _term_5=(u (u (u list_for _dref_1) _term_4) (\_path_5-> (\_term_6-> (let _term_7=(u (u (u fm_term_expand_at _path_5) _term_6) _defs_3) in (let _term_8=(u (u fm_term_normalize _term_7) map_new) in (let _term_9=(u (u (u fm_term_expand_ct _term_8) _defs_3) 0) in (let _term_10=(u (u fm_term_normalize _term_9) map_new) in _term_10))))))) in _term_5)))))
fm_error_show = (\_error_1-> (\_defs_2-> (let _6693 = _error_1 in (case _6693 of {(0,f) -> u f (\_6694 _6695 _6696 _6697-> (let _expected_7=(let _6698 = _6695 in (case _6698 of {(0,f) -> u f (\_6699-> _6699); (1,f) -> u f (\_6700-> (u fm_term_show (u (u fm_term_normalize _6700) map_new))); })) in (let _detected_8=(let _6701 = _6696 in (case _6701 of {(0,f) -> u f (\_6702-> _6702); (1,f) -> u f (\_6703-> (u fm_term_show (u (u fm_term_normalize _6703) map_new))); })) in (u string_flatten (u (u list_cons "Type mismatch.\n") (u (u list_cons "- Expected: ") (u (u list_cons _expected_7) (u (u list_cons "\n") (u (u list_cons "- Detected: ") (u (u list_cons _detected_8) (u (u list_cons "\n") (u (u list_cons (let _6704 = _6697 in (case _6704 of {(0,f) -> u f (""); (1,f) -> u f (\_6705 _6706-> (u string_flatten (u (u list_cons "With context:\n") (u (u list_cons (u fm_context_show _6697)) list_nil)))); }))) list_nil)))))))))))); (1,f) -> u f (\_6707 _6708 _6709 _6710 _6711-> (let _goal_name_8=(u string_flatten (u (u list_cons "Goal ?") (u (u list_cons (u fm_name_show _6707)) (u (u list_cons ":\n") list_nil)))) in (let _with_type_9=(let _6712 = _6710 in (case _6712 of {(0,f) -> u f (""); (1,f) -> u f (\_6713-> (let _goal_10=(u (u (u fm_term_expand _6708) _6713) _defs_2) in (u string_flatten (u (u list_cons "With type: ") (u (u list_cons (let _6714 = _6709 in (if _6714 then (u (u fm_term_show_go _goal_10) (u maybe_some (\_x_11-> _x_11))) else (u fm_term_show _goal_10)))) (u (u list_cons "\n") list_nil)))))); })) in (let _with_ctxt_10=(let _6715 = _6711 in (case _6715 of {(0,f) -> u f (""); (1,f) -> u f (\_6716 _6717-> (u string_flatten (u (u list_cons "With ctxt:\n") (u (u list_cons (u fm_context_show _6711)) list_nil)))); })) in (u string_flatten (u (u list_cons _goal_name_8) (u (u list_cons _with_type_9) (u (u list_cons _with_ctxt_10) list_nil)))))))); (2,f) -> u f (\_6718-> (u string_flatten (u (u list_cons "Waiting for '") (u (u list_cons _6718) (u (u list_cons "'.") list_nil))))); (3,f) -> u f (\_6719-> (u string_flatten (u (u list_cons "Error on dependency '") (u (u list_cons _6719) (u (u list_cons "'.") list_nil))))); (4,f) -> u f (\_6720 _6721-> (u string_flatten (u (u list_cons "Patching: ") (u (u list_cons (u fm_term_show _6721)) list_nil)))); (5,f) -> u f (\_6722 _6723-> (u string_flatten (u (u list_cons "Undefined reference: ") (u (u list_cons (u fm_name_show _6723)) (u (u list_cons "\n") list_nil))))); (6,f) -> u f (\_6724 _6725 _6726-> (let _term_6=(u fm_term_show _6725) in (let _context_7=(u fm_context_show _6726) in (u string_flatten (u (u list_cons "Can't infer type of: ") (u (u list_cons _term_6) (u (u list_cons "\n") (u (u list_cons "With ctxt:\n") (u (u list_cons _context_7) list_nil))))))))); }))))
fm_error_origin = (\_error_1-> (let _6727 = _error_1 in (case _6727 of {(0,f) -> u f (\_6728 _6729 _6730 _6731-> _6728); (1,f) -> u f (\_6732 _6733 _6734 _6735 _6736-> maybe_none); (2,f) -> u f (\_6737-> maybe_none); (3,f) -> u f (\_6738-> maybe_none); (4,f) -> u f (\_6739 _6740-> maybe_none); (5,f) -> u f (\_6741 _6742-> _6741); (6,f) -> u f (\_6743 _6744 _6745-> _6743); })))
fm_defs_report_go = (\_defs_1-> (\_list_2-> (\_errs_3-> (\_typs_4-> (let _6746 = _list_2 in (case _6746 of {(0,f) -> u f ((u string_flatten (u (u list_cons _typs_4) (u (u list_cons "\n") (u (u list_cons (let _6747 = _errs_3 in (if null (_6747::String) then "All terms check." else _errs_3))) list_nil))))); (1,f) -> u f (\_6748 _6749-> (let _name_7=_6748 in (let _6750 = (u (u fm_get _name_7) _defs_1) in (case _6750 of {(0,f) -> u f ((u (u (u (u fm_defs_report_go _defs_1) _6749) _errs_3) _typs_4)); (1,f) -> u f (\_6751-> (let _6752 = _6751 in (case _6752 of {(0,f) -> u f (\_6753 _6754 _6755 _6756 _6757 _6758-> (let _typs_15=(u string_flatten (u (u list_cons _typs_4) (u (u list_cons _name_7) (u (u list_cons ": ") (u (u list_cons (u fm_term_show _6757)) (u (u list_cons "\n") list_nil)))))) in (let _6759 = _6758 in (case _6759 of {(0,f) -> u f ((u (u (u (u fm_defs_report_go _defs_1) _6749) _errs_3) _typs_15)); (1,f) -> u f ((u (u (u (u fm_defs_report_go _defs_1) _6749) _errs_3) _typs_15)); (2,f) -> u f ((u (u (u (u fm_defs_report_go _defs_1) _6749) _errs_3) _typs_15)); (3,f) -> u f (\_6760-> (let _6761 = _6760 in (case _6761 of {(0,f) -> u f ((u (u (u (u fm_defs_report_go _defs_1) _6749) _errs_3) _typs_15)); (1,f) -> u f (\_6762 _6763-> (let _name_str_19=(u fm_name_show _6755) in (let _rel_errs_20=(u (u fm_error_relevant _6760) bool_false) in (let _6764 = _rel_errs_20 in (case _6764 of {(0,f) -> u f ((u (u (u (u fm_defs_report_go _defs_1) _6749) _errs_3) _typs_15)); (1,f) -> u f (\_6765 _6766-> (let _rel_msgs_23=(u (u list_mapped _rel_errs_20) (\_err_23-> (u string_flatten (u (u list_cons (u (u fm_error_show _err_23) _defs_1)) (u (u list_cons (let _6767 = (u fm_error_origin _err_23) in (case _6767 of {(0,f) -> u f (""); (1,f) -> u f (\_6768-> (let _6769 = _6768 in (case _6769 of {(0,f) -> u f (\_6770 _6771 _6772-> (u string_flatten (u (u list_cons "Inside '") (u (u list_cons _6753) (u (u list_cons "':\n") (u (u list_cons (u (u (u fm_highlight _6754) _6771) _6772)) (u (u list_cons "\n") list_nil))))))); }))); }))) list_nil))))) in (let _errs_24=(u string_flatten (u (u list_cons _errs_3) (u (u list_cons (u (u string_join "\n") _rel_msgs_23)) (u (u list_cons "\n") list_nil)))) in (u (u (u (u fm_defs_report_go _defs_1) _6749) _errs_24) _typs_15)))); }))))); }))); })))); }))); })))); }))))))
fm_defs_report = (\_defs_1-> (\_list_2-> (u (u (u (u fm_defs_report_go _defs_1) _list_2) "") "")))
fm_checker_io_one = (\_name_1-> (u (u (u io_monad (\_m_bind_2-> (\_m_pure_3-> _m_bind_2))) (u (u fm_synth_one _name_1) map_new)) (\_new_defs_2-> (let _6773 = _new_defs_2 in (case _6773 of {(0,f) -> u f ((u io_print (u (u fm_defs_report map_new) (u (u list_cons _name_1) list_nil)))); (1,f) -> u f (\_6774-> (u io_print (u (u fm_defs_report _6774) (u (u list_cons _name_1) list_nil)))); })))))
map_keys_go = (\_xs_2-> (\_key_3-> (\_list_4-> (let _6775 = _xs_2 in (case _6775 of {(0,f) -> u f (_list_4); (1,f) -> u f (\_6776 _6777 _6778-> (let _list0_8=(let _6779 = _6776 in (case _6779 of {(0,f) -> u f (_list_4); (1,f) -> u f (\_6780-> (u (u list_cons (u bits_reverse _key_3)) _list_4)); })) in (let _list1_9=(u (u (u map_keys_go _6777) (u bits_o _key_3)) _list0_8) in (let _list2_10=(u (u (u map_keys_go _6778) (u bits_i _key_3)) _list1_9) in _list2_10)))); })))))
map_keys = (\_xs_2-> (u list_reverse (u (u (u map_keys_go _xs_2) bits_e) list_nil)))
fm_synth_many = (\_names_1-> (\_defs_2-> (let _6781 = _names_1 in (case _6781 of {(0,f) -> u f ((u (u io_monad (\_m_bind_3-> (\_m_pure_4-> _m_pure_4))) _defs_2)); (1,f) -> u f (\_6782 _6783-> (u (u (u io_monad (\_m_bind_5-> (\_m_pure_6-> _m_bind_5))) (u (u fm_synth_one _6782) _defs_2)) (\_new_defs_5-> (let _6784 = _new_defs_5 in (case _6784 of {(0,f) -> u f ((u (u fm_synth_many _6783) _defs_2)); (1,f) -> u f (\_6785-> (u (u fm_synth_many _6783) _6785)); }))))); }))))
fm_synth_file = (\_file_1-> (\_defs_2-> (u (u (u io_monad (\_m_bind_3-> (\_m_pure_4-> _m_bind_3))) (u io_get_file _file_1)) (\_code_3-> (let _read_4=(u (u (u fm_defs_read _file_1) _code_3) _defs_2) in (let _6786 = _read_4 in (case _6786 of {(0,f) -> u f (\_6787-> (u (u io_monad (\_m_bind_6-> (\_m_pure_7-> _m_pure_7))) (u either_left _6787))); (1,f) -> u f (\_6788-> (let _file_defs_6=_6788 in (let _file_keys_7=(u map_keys _file_defs_6) in (let _file_nams_8=(u (u list_mapped _file_keys_7) fm_name_from_bits) in (u (u (u io_monad (\_m_bind_9-> (\_m_pure_10-> _m_bind_9))) (u (u fm_synth_many _file_nams_8) _file_defs_6)) (\_defs_9-> (u (u io_monad (\_m_bind_10-> (\_m_pure_11-> _m_pure_11))) (u either_right (u (u pair_new _file_nams_8) _defs_9))))))))); })))))))
fm_checker_io_file = (\_file_1-> (u (u (u io_monad (\_m_bind_2-> (\_m_pure_3-> _m_bind_2))) (u (u fm_synth_file _file_1) map_new)) (\_loaded_2-> (let _6789 = _loaded_2 in (case _6789 of {(0,f) -> u f (\_6790-> (u (u (u io_monad (\_m_bind_4-> (\_m_pure_5-> _m_bind_4))) (u io_print (u string_flatten (u (u list_cons "On '") (u (u list_cons _file_1) (u (u list_cons "':") list_nil)))))) (\__4-> (u io_print _6790)))); (1,f) -> u f (\_6791-> (let _6792 = _6791 in (case _6792 of {(0,f) -> u f (\_6793 _6794-> (let _nams_6=_6793 in (let _defs_7=_6794 in (u io_print (u (u fm_defs_report _defs_7) _nams_6))))); }))); })))))
io_purify = (\_io_2-> (let _6795 = _io_2 in (case _6795 of {(0,f) -> u f (\_6796-> _6796); (1,f) -> u f (\_6797 _6798 _6799-> (u io_purify (u _6799 ""))); })))
fm_checker_code = (\_code_1-> (let _6800 = (u (u (u fm_defs_read "Main.fm") _code_1) map_new) in (case _6800 of {(0,f) -> u f (\_6801-> _6801); (1,f) -> u f (\_6802-> (u io_purify (let _defs_3=_6802 in (let _nams_4=(u (u list_mapped (u map_keys _defs_3)) fm_name_from_bits) in (u (u (u io_monad (\_m_bind_5-> (\_m_pure_6-> _m_bind_5))) (u (u fm_synth_many _nams_4) _defs_3)) (\_defs_5-> (u (u io_monad (\_m_bind_6-> (\_m_pure_7-> _m_pure_7))) (u (u fm_defs_report _defs_5) _nams_4)))))))); })))
fm_term_read = (\_code_1-> (let _6803 = (u (u fm_parser_term 0) _code_1) in (case _6803 of {(0,f) -> u f (\_6804 _6805 _6806-> maybe_none); (1,f) -> u f (\_6807 _6808 _6809-> (u maybe_some _6809)); })))
fm = (let ___1=fm_to_core_io_one in (let ___2=fm_checker_io_one in (let ___3=fm_checker_io_file in (let ___4=fm_checker_code in (let ___5=fm_term_read in (u (u (u io_monad (\_m_bind_6-> (\_m_pure_7-> _m_bind_6))) (u fm_to_core_io_one "Fm")) (\_s_6-> (u io_print _s_6))))))))


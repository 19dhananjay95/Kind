module FormalityInternal where
import Unsafe.Coerce
import Data.Word
import Data.Bits
import Data.List (intercalate)
import Debug.Trace
import System.Exit
import System.Directory
import System.FilePath.Posix (takeDirectory)
u = unsafeCoerce
setFile :: String -> IO ()
setFile param = do
  let path = takeWhile (/= '=') param
  let file = drop (length path + 1) param
  createDirectoryIfMissing True (takeDirectory path)
  writeFile path file
delFile :: String -> IO ()
delFile param = do
  isDir <- doesDirectoryExist param
  if isDir then do
    removeDirectory param
  else do
    removeFile param
getDir :: String -> IO String
getDir param = do
  dir <- listDirectory param
  return $ intercalate ";" dir
run p = case p of {
  (1,f) -> (u f (\query param cont-> case query of {
    "print"    -> do { putStrLn param; run (cont ()); };
    "exit"     -> do { exitFailure; run (cont ()); };
    "get_line" -> do { line <- getLine; run (u cont line); };
    "set_file" -> do { setFile param; run (u cont ""); };
    "get_file" -> do { line <- readFile param; run (u cont line); };
    "del_file" -> do { delFile param; run (u cont ""); };
    "get_dir" -> do { dir <- getDir param; run (u cont dir); };
    otherwise  -> do { u cont (); };
  }));
  (0,f) -> (u f (\value-> do { (return :: a -> IO a) value; }));
}
word_to_u16       w        = u word_to_u16_go 0 w 0
word_to_u16_go 16 w      x = u x
word_to_u16_go  i (0,f)  x = u word_to_u16_go (i+1) (0,\t-> t) (x::Word16)
word_to_u16_go  i (1,f)  x = u f (\w-> word_to_u16_go (i+1) w x)
word_to_u16_go  i (2,f)  x = u f (\w-> word_to_u16_go (i+1) w (x .|. (shiftL 1 i)))
u16_to_word       x        = u u16_to_word_go 0 x (0,\t-> t)
u16_to_word_go 16 x      w = u w
u16_to_word_go  i x      w = u u16_to_word_go (i+1) (x::Word16) (if (shiftR x (16-i-1) .&. 1) > 0 then (2,\t-> t w) else (1,\t-> t w))
io = (\_a_1-> ())
io_ask = (\_query_2-> (\_param_3-> (\_then_4-> (1,\t-> t _query_2 _param_3 _then_4))))
io_bind = (\_a_3-> (\_f_4-> (let _0 = _a_3 in (case _0 of {(0,f) -> u f (\_1-> (u _f_4 _1)); (1,f) -> u f (\_2 _3 _4-> (u (u (u io_ask _2) _3) (\_x_8-> (u (u io_bind (u _4 _x_8)) _f_4)))); }))))
io_end = (\_value_2-> (0,\t-> t _value_2))
io_monad = (\_new_2-> (u (u _new_2 io_bind) io_end))
maybe = (\_a_1-> ())
map = (\_a_1-> ())
maybe_none = (0,\t-> t)
map_get = (\_bits_2-> (\_map_3-> (let _5 = _bits_2 in (case _5 of {(0,f) -> u f ((let _6 = _map_3 in (case _6 of {(0,f) -> u f (maybe_none); (1,f) -> u f (\_7 _8 _9-> _7); }))); (1,f) -> u f (\_10-> (let _11 = _map_3 in (case _11 of {(0,f) -> u f (maybe_none); (1,f) -> u f (\_12 _13 _14-> (u (u map_get _10) _13)); }))); (2,f) -> u f (\_15-> (let _16 = _map_3 in (case _16 of {(0,f) -> u f (maybe_none); (1,f) -> u f (\_17 _18 _19-> (u (u map_get _15) _19)); }))); }))))
bits_e = (0,\t-> t)
bool_false = False
bool_and = (\a0-> \a1-> (a0 && a1))
bool_true = True
cmp_as_lte = (\_cmp_1-> (let _20 = _cmp_1 in (case _20 of {(0,f) -> u f (bool_true); (1,f) -> u f (bool_true); (2,f) -> u f (bool_false); })))
cmp_ltn = (0,\t-> t)
cmp_gtn = (2,\t-> t)
word_cmp_go = (\_a_2-> (\_b_3-> (\_c_4-> (let _21 = _a_2 in (case _21 of {(0,f) -> u f ((\_b_5-> _c_4)); (1,f) -> u f (\_22-> (\_b_7-> (let _23 = _b_7 in (case _23 of {(0,f) -> u f ((\_a_pred_8-> _c_4)); (1,f) -> u f (\_24-> (\_a_pred_10-> (u (u (u word_cmp_go _a_pred_10) _24) _c_4))); (2,f) -> u f (\_25-> (\_a_pred_10-> (u (u (u word_cmp_go _a_pred_10) _25) cmp_ltn))); })) _22)); (2,f) -> u f (\_26-> (\_b_7-> (let _27 = _b_7 in (case _27 of {(0,f) -> u f ((\_a_pred_8-> _c_4)); (1,f) -> u f (\_28-> (\_a_pred_10-> (u (u (u word_cmp_go _a_pred_10) _28) cmp_gtn))); (2,f) -> u f (\_29-> (\_a_pred_10-> (u (u (u word_cmp_go _a_pred_10) _29) _c_4))); })) _26)); })) _b_3)))
cmp_eql = (1,\t-> t)
word_cmp = (\_a_2-> (\_b_3-> (u (u (u word_cmp_go _a_2) _b_3) cmp_eql)))
word_lte = (\_a_2-> (\_b_3-> (u cmp_as_lte (u (u word_cmp _a_2) _b_3))))
nat_succ = (\_pred_1-> 1+_pred_1)
nat_zero = 0
u16_lte = (\a0-> \a1-> ((a0::Word16) <= a1))
u16_btw = (\_a_1-> (\_b_2-> (\_c_3-> (((((_a_1::Word16) <= _b_2)) && (((_b_2::Word16) <= _c_3)))))))
u16_new = (\_value_1-> (word_to_u16 _value_1))
word_e = (0,\t-> t)
word = (\_size_1-> ())
word_i = (\_pred_2-> (2,\t-> t _pred_2))
word_o = (\_pred_2-> (1,\t-> t _pred_2))
word_subber = (\_a_2-> (\_b_3-> (\_c_4-> (let _30 = _a_2 in (case _30 of {(0,f) -> u f ((\_b_5-> word_e)); (1,f) -> u f (\_31-> (\_b_7-> (let _32 = _b_7 in (case _32 of {(0,f) -> u f ((\_a_pred_8-> word_e)); (1,f) -> u f (\_33-> (\_a_pred_10-> (let _34 = _c_4 in (if _34 then (u word_i (u (u (u word_subber _a_pred_10) _33) bool_true)) else (u word_o (u (u (u word_subber _a_pred_10) _33) bool_false)))))); (2,f) -> u f (\_35-> (\_a_pred_10-> (let _36 = _c_4 in (if _36 then (u word_o (u (u (u word_subber _a_pred_10) _35) bool_true)) else (u word_i (u (u (u word_subber _a_pred_10) _35) bool_true)))))); })) _31)); (2,f) -> u f (\_37-> (\_b_7-> (let _38 = _b_7 in (case _38 of {(0,f) -> u f ((\_a_pred_8-> word_e)); (1,f) -> u f (\_39-> (\_a_pred_10-> (let _40 = _c_4 in (if _40 then (u word_o (u (u (u word_subber _a_pred_10) _39) bool_false)) else (u word_i (u (u (u word_subber _a_pred_10) _39) bool_false)))))); (2,f) -> u f (\_41-> (\_a_pred_10-> (let _42 = _c_4 in (if _42 then (u word_i (u (u (u word_subber _a_pred_10) _41) bool_true)) else (u word_o (u (u (u word_subber _a_pred_10) _41) bool_false)))))); })) _37)); })) _b_3)))
word_sub = (\_a_2-> (\_b_3-> (u (u (u word_subber _a_2) _b_3) bool_false)))
u16_sub = (\a0-> \a1-> ((a0::Word16) - a1))
nat_apply = (\_n_2-> (\_f_3-> (\_x_4-> (let _43 = _n_2 in (if _43==0 then _x_4 else (u (u (u nat_apply (_43-1)) _f_3) (u _f_3 _x_4)))))))
word_inc = (\_word_2-> (let _44 = _word_2 in (case _44 of {(0,f) -> u f (word_e); (1,f) -> u f (\_45-> (u word_i _45)); (2,f) -> u f (\_46-> (u word_o (u word_inc _46))); })))
u16_inc = (\_a_1-> (let _47 = _a_1 in (u u16_new (u word_inc (u16_to_word _47)))))
word_zero = (\_size_1-> (let _48 = _size_1 in (if _48==0 then word_e else (u word_o (u word_zero (_48-1))))))
u16_zero = (u u16_new (u word_zero 16))
nat_to_u16 = (\a0-> (fromIntegral (a0::Integer)))
word_adder = (\_a_2-> (\_b_3-> (\_c_4-> (let _49 = _a_2 in (case _49 of {(0,f) -> u f ((\_b_5-> word_e)); (1,f) -> u f (\_50-> (\_b_7-> (let _51 = _b_7 in (case _51 of {(0,f) -> u f ((\_a_pred_8-> word_e)); (1,f) -> u f (\_52-> (\_a_pred_10-> (let _53 = _c_4 in (if _53 then (u word_i (u (u (u word_adder _a_pred_10) _52) bool_false)) else (u word_o (u (u (u word_adder _a_pred_10) _52) bool_false)))))); (2,f) -> u f (\_54-> (\_a_pred_10-> (let _55 = _c_4 in (if _55 then (u word_o (u (u (u word_adder _a_pred_10) _54) bool_true)) else (u word_i (u (u (u word_adder _a_pred_10) _54) bool_false)))))); })) _50)); (2,f) -> u f (\_56-> (\_b_7-> (let _57 = _b_7 in (case _57 of {(0,f) -> u f ((\_a_pred_8-> word_e)); (1,f) -> u f (\_58-> (\_a_pred_10-> (let _59 = _c_4 in (if _59 then (u word_o (u (u (u word_adder _a_pred_10) _58) bool_true)) else (u word_i (u (u (u word_adder _a_pred_10) _58) bool_false)))))); (2,f) -> u f (\_60-> (\_a_pred_10-> (let _61 = _c_4 in (if _61 then (u word_i (u (u (u word_adder _a_pred_10) _60) bool_true)) else (u word_o (u (u (u word_adder _a_pred_10) _60) bool_true)))))); })) _56)); })) _b_3)))
word_add = (\_a_2-> (\_b_3-> (u (u (u word_adder _a_2) _b_3) bool_false)))
u16_add = (\a0-> \a1-> ((a0::Word16) + a1))
cmp_as_eql = (\_cmp_1-> (let _62 = _cmp_1 in (case _62 of {(0,f) -> u f (bool_false); (1,f) -> u f (bool_true); (2,f) -> u f (bool_false); })))
word_eql = (\_a_2-> (\_b_3-> (u cmp_as_eql (u (u word_cmp _a_2) _b_3))))
u16_eql = (\a0-> \a1-> ((a0::Word16) == a1))
bits_o = (\_pred_1-> (1,\t-> t _pred_1))
bits_i = (\_pred_1-> (2,\t-> t _pred_1))
word_to_bits = (\_a_2-> (let _63 = _a_2 in (case _63 of {(0,f) -> u f (bits_e); (1,f) -> u f (\_64-> (u bits_o (u word_to_bits _64))); (2,f) -> u f (\_65-> (u bits_i (u word_to_bits _65))); })))
word_trim = (\_new_size_2-> (\_word_3-> (let _66 = _new_size_2 in (if _66==0 then word_e else (let _67 = _word_3 in (case _67 of {(0,f) -> u f ((u word_o (u (u word_trim (_66-1)) word_e))); (1,f) -> u f (\_68-> (u word_o (u (u word_trim (_66-1)) _68))); (2,f) -> u f (\_69-> (u word_i (u (u word_trim (_66-1)) _69))); }))))))
bits_concat = (\_a_1-> (\_b_2-> (let _70 = _a_1 in (case _70 of {(0,f) -> u f (_b_2); (1,f) -> u f (\_71-> (u bits_o (u (u bits_concat _71) _b_2))); (2,f) -> u f (\_72-> (u bits_i (u (u bits_concat _72) _b_2))); }))))
bits_reverse_tco = (\_a_1-> (\_r_2-> (let _73 = _a_1 in (case _73 of {(0,f) -> u f (_r_2); (1,f) -> u f (\_74-> (u (u bits_reverse_tco _74) (u bits_o _r_2))); (2,f) -> u f (\_75-> (u (u bits_reverse_tco _75) (u bits_i _r_2))); }))))
bits_reverse = (\_a_1-> (u (u bits_reverse_tco _a_1) bits_e))
fm_name_to_bits = (\_name_1-> (let _76 = _name_1 in (if null (_76::String) then bits_e else (let _chr_4=(fromIntegral (fromEnum (head _76 :: Char)) :: Word16) in (let _u16_5=(let _77 = (u (u (u u16_btw 65) _chr_4) 90) in (if _77 then (((_chr_4::Word16) - 65)) else (let _78 = (u (u (u u16_btw 97) _chr_4) 122) in (if _78 then (((_chr_4::Word16) - 71)) else (let _79 = (u (u (u u16_btw 48) _chr_4) 57) in (if _79 then (((_chr_4::Word16) + 4)) else (let _80 = (((46::Word16) == _chr_4)) in (if _80 then 62 else (let _81 = (((95::Word16) == _chr_4)) in (if _81 then 63 else 0)))))))))) in (let _bts_6=(let _82 = _u16_5 in (u word_to_bits (u (u word_trim 6) (u16_to_word _82)))) in (u (u bits_concat (u bits_reverse _bts_6)) (u fm_name_to_bits (tail _76)))))))))
fm_get = (\_name_2-> (\_map_3-> (u (u map_get (u fm_name_to_bits _name_2)) _map_3)))
io_get_file = (\_name_1-> (u (u (u io_ask "get_file") _name_1) (\_file_2-> (u io_end _file_2))))
parser_reply = (\_v_1-> ())
parser_reply_value = (\_idx_2-> (\_code_3-> (\_val_4-> (1,\t-> t _idx_2 _code_3 _val_4))))
parser_is_eof = (\_idx_1-> (\_code_2-> (let _83 = _code_2 in (if null (_83::String) then (u (u (u parser_reply_value _idx_1) _code_2) bool_true) else (u (u (u parser_reply_value _idx_1) _code_2) bool_false)))))
parser_reply_error = (\_idx_2-> (\_code_3-> (\_err_4-> (0,\t-> t _idx_2 _code_3 _err_4))))
parser = (\_v_1-> ())
maybe_some = (\_value_2-> (1,\t-> t _value_2))
parser_errorat_new = (\_idx_1-> (\_code_2-> (\_err_3-> (0,\t-> t _idx_1 _code_2 _err_3))))
nat_gtn = (\a0-> \a1-> ((a0::Integer) > a1))
parser_errorat_combine = (\_a_1-> (\_b_2-> (let _84 = _a_1 in (case _84 of {(0,f) -> u f (_b_2); (1,f) -> u f (\_85-> (let _86 = _b_2 in (case _86 of {(0,f) -> u f (_a_1); (1,f) -> u f (\_87-> (let _88 = _85 in (case _88 of {(0,f) -> u f (\_89 _90 _91-> (let _92 = _87 in (case _92 of {(0,f) -> u f (\_93 _94 _95-> (let _96 = (((_89::Integer) > _93)) in (if _96 then _a_1 else _b_2))); }))); }))); }))); }))))
parser_first_of_go = (\_pars_2-> (\_err_3-> (\_idx_4-> (\_code_5-> (let _97 = _pars_2 in (case _97 of {(0,f) -> u f ((let _98 = _err_3 in (case _98 of {(0,f) -> u f ((u (u (u parser_reply_error _idx_4) _code_5) "No parse.")); (1,f) -> u f (\_99-> (let _100 = _99 in (case _100 of {(0,f) -> u f (\_101 _102 _103-> (u (u (u parser_reply_error _101) _102) _103)); }))); }))); (1,f) -> u f (\_104 _105-> (let _parsed_8=(u (u _104 _idx_4) _code_5) in (let _106 = _parsed_8 in (case _106 of {(0,f) -> u f (\_107 _108 _109-> (let _neo_12=(u maybe_some (u (u (u parser_errorat_new _107) _108) _109)) in (let _err_13=(u (u parser_errorat_combine _neo_12) _err_3) in (u (u (u (u parser_first_of_go _105) _err_13) _idx_4) _code_5)))); (1,f) -> u f (\_110 _111 _112-> (u (u (u parser_reply_value _110) _111) _112)); })))); }))))))
parser_first_of = (\_pars_2-> (u (u parser_first_of_go _pars_2) maybe_none))
list_cons = (\_head_2-> (\_tail_3-> (1,\t-> t _head_2 _tail_3)))
list = (\_a_1-> ())
list_nil = (0,\t-> t)
parser_many_go = (\_parse_2-> (\_values_3-> (\_idx_4-> (\_code_5-> (let _113 = (u (u _parse_2 _idx_4) _code_5) in (case _113 of {(0,f) -> u f (\_114 _115 _116-> (u (u (u parser_reply_value _idx_4) _code_5) (u _values_3 list_nil))); (1,f) -> u f (\_117 _118 _119-> (u (u (u (u parser_many_go _parse_2) (\_xs_9-> (u _values_3 (u (u list_cons _119) _xs_9)))) _117) _118)); }))))))
parser_many = (\_parser_2-> (u (u parser_many_go _parser_2) (\_x_3-> _x_3)))
unit_new = ()
string_cons = (\_head_1-> (\_tail_2-> ((toEnum (fromIntegral _head_1 :: Int) :: Char) : _tail_2)))
string_concat = (\a0-> \a1-> ((a0::String) ++ a1))
string_flatten_go = (\_xs_1-> (\_res_2-> (let _120 = _xs_1 in (case _120 of {(0,f) -> u f (_res_2); (1,f) -> u f (\_121 _122-> (u (u string_flatten_go _122) (((_res_2::String) ++ _121)))); }))))
string_flatten = (\_xs_1-> (u (u string_flatten_go _xs_1) ""))
string_nil = []
parser_text_go = (\_text_1-> (\_idx_2-> (\_code_3-> (let _123 = _text_1 in (if null (_123::String) then (u (u (u parser_reply_value _idx_2) _code_3) unit_new) else (let _124 = _code_3 in (if null (_124::String) then (let _error_6=(u string_flatten (u (u list_cons "Expected '") (u (u list_cons _text_1) (u (u list_cons "', found end of file.") list_nil)))) in (u (u (u parser_reply_error _idx_2) _code_3) _error_6)) else (let _125 = ((((fromIntegral (fromEnum (head _123 :: Char)) :: Word16)::Word16) == (fromIntegral (fromEnum (head _124 :: Char)) :: Word16))) in (if _125 then (u (u (u parser_text (tail _123)) (u nat_succ _idx_2)) (tail _124)) else (let _error_8=(u string_flatten (u (u list_cons "Expected '") (u (u list_cons _text_1) (u (u list_cons "', found '") (u (u list_cons (u (u string_cons (fromIntegral (fromEnum (head _124 :: Char)) :: Word16)) string_nil)) (u (u list_cons "'.") list_nil)))))) in (u (u (u parser_reply_error _idx_2) _code_3) _error_8)))))))))))
parser_text = (\_text_1-> (\_idx_2-> (\_code_3-> (let _126 = (u (u (u parser_text_go _text_1) _idx_2) _code_3) in (case _126 of {(0,f) -> u f (\_127 _128 _129-> (u (u (u parser_reply_error _idx_2) _code_3) _129)); (1,f) -> u f (\_130 _131 _132-> (u (u (u parser_reply_value _130) _131) _132)); })))))
parser_until_go = (\_until_2-> (\_parse_3-> (\_values_4-> (\_idx_5-> (\_code_6-> (let _until_reply_7=(u (u _until_2 _idx_5) _code_6) in (let _133 = _until_reply_7 in (case _133 of {(0,f) -> u f (\_134 _135 _136-> (let _reply_11=(u (u _parse_3 _idx_5) _code_6) in (let _137 = _reply_11 in (case _137 of {(0,f) -> u f (\_138 _139 _140-> (u (u (u parser_reply_error _138) _139) _140)); (1,f) -> u f (\_141 _142 _143-> (u (u (u (u (u parser_until_go _until_2) _parse_3) (\_xs_15-> (u _values_4 (u (u list_cons _143) _xs_15)))) _141) _142)); })))); (1,f) -> u f (\_144 _145 _146-> (u (u (u parser_reply_value _144) _145) (u _values_4 list_nil))); }))))))))
parser_until = (\_until_2-> (\_parse_3-> (u (u (u parser_until_go _until_2) _parse_3) (\_x_4-> _x_4))))
parser_one = (\_idx_1-> (\_code_2-> (let _147 = _code_2 in (if null (_147::String) then (u (u (u parser_reply_error _idx_1) _code_2) "Unexpected end of file.") else (u (u (u parser_reply_value (u nat_succ _idx_1)) (tail _147)) (fromIntegral (fromEnum (head _147 :: Char)) :: Word16))))))
fm_parser_spaces = (u parser_many (u parser_first_of (u (u list_cons (u parser_text " ")) (u (u list_cons (u parser_text "\t")) (u (u list_cons (u parser_text "\n")) (u (u list_cons (\_idx_1-> (\_code_2-> (let _148 = (u (u (u parser_text "//") _idx_1) _code_2) in (case _148 of {(0,f) -> u f (\_149 _150 _151-> (u (u (u parser_reply_error _149) _150) _151)); (1,f) -> u f (\_152 _153 _154-> (let _155 = (u (u (u (u parser_until (u parser_text "\n")) parser_one) _152) _153) in (case _155 of {(0,f) -> u f (\_156 _157 _158-> (u (u (u parser_reply_error _156) _157) _158)); (1,f) -> u f (\_159 _160 _161-> (u (u (u parser_reply_value _159) _160) unit_new)); }))); }))))) list_nil))))))
parser_get_index = (\_idx_1-> (\_code_2-> (u (u (u parser_reply_value _idx_1) _code_2) _idx_1)))
fm_parser_init = (\_idx_1-> (\_code_2-> (let _162 = (u (u fm_parser_spaces _idx_1) _code_2) in (case _162 of {(0,f) -> u f (\_163 _164 _165-> (u (u (u parser_reply_error _163) _164) _165)); (1,f) -> u f (\_166 _167 _168-> (let _169 = (u (u parser_get_index _166) _167) in (case _169 of {(0,f) -> u f (\_170 _171 _172-> (u (u (u parser_reply_error _170) _171) _172)); (1,f) -> u f (\_173 _174 _175-> (u (u (u parser_reply_value _173) _174) _175)); }))); }))))
parser_many1 = (\_parser_2-> (\_idx_3-> (\_code_4-> (let _176 = (u (u _parser_2 _idx_3) _code_4) in (case _176 of {(0,f) -> u f (\_177 _178 _179-> (u (u (u parser_reply_error _177) _178) _179)); (1,f) -> u f (\_180 _181 _182-> (let _183 = (u (u (u parser_many _parser_2) _180) _181) in (case _183 of {(0,f) -> u f (\_184 _185 _186-> (u (u (u parser_reply_error _184) _185) _186)); (1,f) -> u f (\_187 _188 _189-> (u (u (u parser_reply_value _187) _188) (u (u list_cons _182) _189))); }))); })))))
fm_name_is_letter = (\_chr_1-> (let _190 = (u (u (u u16_btw 65) _chr_1) 90) in (if _190 then bool_true else (let _191 = (u (u (u u16_btw 97) _chr_1) 122) in (if _191 then bool_true else (let _192 = (u (u (u u16_btw 48) _chr_1) 57) in (if _192 then bool_true else (let _193 = (((46::Word16) == _chr_1)) in (if _193 then bool_true else (let _194 = (((95::Word16) == _chr_1)) in (if _194 then bool_true else (let _195 = (((94::Word16) == _chr_1)) in (if _195 then bool_true else bool_false)))))))))))))
fm_parser_letter = (\_idx_1-> (\_code_2-> (let _196 = _code_2 in (if null (_196::String) then (u (u (u parser_reply_error _idx_1) _code_2) "Unexpected eof.") else (let _197 = (u fm_name_is_letter (fromIntegral (fromEnum (head _196 :: Char)) :: Word16)) in (if _197 then (u (u (u parser_reply_value (u nat_succ _idx_1)) (tail _196)) (fromIntegral (fromEnum (head _196 :: Char)) :: Word16)) else (u (u (u parser_reply_error _idx_1) _code_2) "Expected letter.")))))))
list_fold = (\_list_2-> (\_nil_4-> (\_cons_5-> (let _198 = _list_2 in (case _198 of {(0,f) -> u f (_nil_4); (1,f) -> u f (\_199 _200-> (u (u _cons_5 _199) (u (u (u list_fold _200) _nil_4) _cons_5))); })))))
fm_parser_name1 = (\_idx_1-> (\_code_2-> (let _201 = (u (u fm_parser_spaces _idx_1) _code_2) in (case _201 of {(0,f) -> u f (\_202 _203 _204-> (u (u (u parser_reply_error _202) _203) _204)); (1,f) -> u f (\_205 _206 _207-> (let _208 = (u (u (u parser_many1 fm_parser_letter) _205) _206) in (case _208 of {(0,f) -> u f (\_209 _210 _211-> (u (u (u parser_reply_error _209) _210) _211)); (1,f) -> u f (\_212 _213 _214-> (u (u (u parser_reply_value _212) _213) (u (u (u list_fold _214) string_nil) string_cons))); }))); }))))
fm_parser_text = (\_text_1-> (\_idx_2-> (\_code_3-> (let _215 = (u (u fm_parser_spaces _idx_2) _code_3) in (case _215 of {(0,f) -> u f (\_216 _217 _218-> (u (u (u parser_reply_error _216) _217) _218)); (1,f) -> u f (\_219 _220 _221-> (u (u (u parser_text _text_1) _219) _220)); })))))
parser_until1 = (\_cond_2-> (\_parser_3-> (\_idx_4-> (\_code_5-> (let _222 = (u (u _parser_3 _idx_4) _code_5) in (case _222 of {(0,f) -> u f (\_223 _224 _225-> (u (u (u parser_reply_error _223) _224) _225)); (1,f) -> u f (\_226 _227 _228-> (let _229 = (u (u (u (u parser_until _cond_2) _parser_3) _226) _227) in (case _229 of {(0,f) -> u f (\_230 _231 _232-> (u (u (u parser_reply_error _230) _231) _232)); (1,f) -> u f (\_233 _234 _235-> (u (u (u parser_reply_value _233) _234) (u (u list_cons _228) _235))); }))); }))))))
pair = (\_a_1-> (\_b_2-> ()))
parser_maybe = (\_parse_2-> (\_idx_3-> (\_code_4-> (let _236 = (u (u _parse_2 _idx_3) _code_4) in (case _236 of {(0,f) -> u f (\_237 _238 _239-> (u (u (u parser_reply_value _idx_3) _code_4) maybe_none)); (1,f) -> u f (\_240 _241 _242-> (u (u (u parser_reply_value _240) _241) (u maybe_some _242))); })))))
fm_parser_item = (\_parser_2-> (\_idx_3-> (\_code_4-> (let _243 = (u (u fm_parser_spaces _idx_3) _code_4) in (case _243 of {(0,f) -> u f (\_244 _245 _246-> (u (u (u parser_reply_error _244) _245) _246)); (1,f) -> u f (\_247 _248 _249-> (let _250 = (u (u _parser_2 _247) _248) in (case _250 of {(0,f) -> u f (\_251 _252 _253-> (u (u (u parser_reply_error _251) _252) _253)); (1,f) -> u f (\_254 _255 _256-> (let _257 = (u (u (u parser_maybe (u fm_parser_text ",")) _254) _255) in (case _257 of {(0,f) -> u f (\_258 _259 _260-> (u (u (u parser_reply_error _258) _259) _260)); (1,f) -> u f (\_261 _262 _263-> (u (u (u parser_reply_value _261) _262) _256)); }))); }))); })))))
fm_parser_name = (\_idx_1-> (\_code_2-> (let _264 = (u (u fm_parser_spaces _idx_1) _code_2) in (case _264 of {(0,f) -> u f (\_265 _266 _267-> (u (u (u parser_reply_error _265) _266) _267)); (1,f) -> u f (\_268 _269 _270-> (let _271 = (u (u (u parser_many fm_parser_letter) _268) _269) in (case _271 of {(0,f) -> u f (\_272 _273 _274-> (u (u (u parser_reply_error _272) _273) _274)); (1,f) -> u f (\_275 _276 _277-> (u (u (u parser_reply_value _275) _276) (u (u (u list_fold _277) string_nil) string_cons))); }))); }))))
pair_new = (\_fst_3-> (\_snd_4-> (0,\t-> t _fst_3 _snd_4)))
fm_parser_stop = (\_from_1-> (\_idx_2-> (\_code_3-> (let _278 = (u (u parser_get_index _idx_2) _code_3) in (case _278 of {(0,f) -> u f (\_279 _280 _281-> (u (u (u parser_reply_error _279) _280) _281)); (1,f) -> u f (\_282 _283 _284-> (let _orig_7=(u (u pair_new _from_1) _284) in (u (u (u parser_reply_value _282) _283) _orig_7))); })))))
fm_term_ori = (\_orig_1-> (\_expr_2-> (15,\t-> t _orig_1 _expr_2)))
fm_term_typ = (2,\t-> t)
fm_parser_type = (\_idx_1-> (\_code_2-> (let _285 = (u (u fm_parser_init _idx_1) _code_2) in (case _285 of {(0,f) -> u f (\_286 _287 _288-> (u (u (u parser_reply_error _286) _287) _288)); (1,f) -> u f (\_289 _290 _291-> (let _292 = (u (u (u fm_parser_text "Type") _289) _290) in (case _292 of {(0,f) -> u f (\_293 _294 _295-> (u (u (u parser_reply_error _293) _294) _295)); (1,f) -> u f (\_296 _297 _298-> (let _299 = (u (u (u fm_parser_stop _291) _296) _297) in (case _299 of {(0,f) -> u f (\_300 _301 _302-> (u (u (u parser_reply_error _300) _301) _302)); (1,f) -> u f (\_303 _304 _305-> (u (u (u parser_reply_value _303) _304) (u (u fm_term_ori _305) fm_term_typ))); }))); }))); }))))
fm_term_all = (\_eras_1-> (\_self_2-> (\_name_3-> (\_xtyp_4-> (\_body_5-> (3,\t-> t _eras_1 _self_2 _name_3 _xtyp_4 _body_5))))))
fm_parser_forall = (\_idx_1-> (\_code_2-> (let _306 = (u (u fm_parser_init _idx_1) _code_2) in (case _306 of {(0,f) -> u f (\_307 _308 _309-> (u (u (u parser_reply_error _307) _308) _309)); (1,f) -> u f (\_310 _311 _312-> (let _313 = (u (u fm_parser_name _310) _311) in (case _313 of {(0,f) -> u f (\_314 _315 _316-> (u (u (u parser_reply_error _314) _315) _316)); (1,f) -> u f (\_317 _318 _319-> (let _320 = (u (u fm_parser_binder _317) _318) in (case _320 of {(0,f) -> u f (\_321 _322 _323-> (u (u (u parser_reply_error _321) _322) _323)); (1,f) -> u f (\_324 _325 _326-> (let _327 = (u (u (u parser_maybe (u fm_parser_text "->")) _324) _325) in (case _327 of {(0,f) -> u f (\_328 _329 _330-> (u (u (u parser_reply_error _328) _329) _330)); (1,f) -> u f (\_331 _332 _333-> (let _334 = (u (u fm_parser_term _331) _332) in (case _334 of {(0,f) -> u f (\_335 _336 _337-> (u (u (u parser_reply_error _335) _336) _337)); (1,f) -> u f (\_338 _339 _340-> (let _term_18=(u (u (u list_fold _326) _340) (\_x_18-> (\_t_19-> (let _341 = _x_18 in (case _341 of {(0,f) -> u f (\_342 _343 _344-> (u (u (u (u (u fm_term_all _342) "") _343) _344) (\_s_23-> (\_x_24-> _t_19)))); }))))) in (let _345 = (u (u (u fm_parser_stop _312) _338) _339) in (case _345 of {(0,f) -> u f (\_346 _347 _348-> (u (u (u parser_reply_error _346) _347) _348)); (1,f) -> u f (\_349 _350 _351-> (u (u (u parser_reply_value _349) _350) (let _352 = _term_18 in (case _352 of {(0,f) -> u f (\_353 _354-> _term_18); (1,f) -> u f (\_355-> _term_18); (2,f) -> u f (_term_18); (3,f) -> u f (\_356 _357 _358 _359 _360-> (u (u fm_term_ori _351) (u (u (u (u (u fm_term_all _356) _319) _358) _359) _360))); (4,f) -> u f (\_361 _362-> _term_18); (5,f) -> u f (\_363 _364-> _term_18); (6,f) -> u f (\_365 _366 _367-> _term_18); (7,f) -> u f (\_368 _369 _370-> _term_18); (8,f) -> u f (\_371 _372 _373-> _term_18); (9,f) -> u f (\_374 _375 _376-> _term_18); (10,f) -> u f (\_377-> _term_18); (11,f) -> u f (\_378-> _term_18); (12,f) -> u f (\_379-> _term_18); (13,f) -> u f (\_380-> _term_18); (14,f) -> u f (\_381 _382 _383 _384 _385 _386-> _term_18); (15,f) -> u f (\_387 _388-> _term_18); })))); })))); }))); }))); }))); }))); }))))
fm_term_lam = (\_name_1-> (\_body_2-> (4,\t-> t _name_1 _body_2)))
fm_parser_make_lambda = (\_names_1-> (\_body_2-> (let _389 = _names_1 in (case _389 of {(0,f) -> u f (_body_2); (1,f) -> u f (\_390 _391-> (u (u fm_term_lam _390) (\_x_5-> (u (u fm_parser_make_lambda _391) _body_2)))); }))))
fm_parser_lambda = (\_idx_1-> (\_code_2-> (let _392 = (u (u fm_parser_init _idx_1) _code_2) in (case _392 of {(0,f) -> u f (\_393 _394 _395-> (u (u (u parser_reply_error _393) _394) _395)); (1,f) -> u f (\_396 _397 _398-> (let _399 = (u (u (u fm_parser_text "(") _396) _397) in (case _399 of {(0,f) -> u f (\_400 _401 _402-> (u (u (u parser_reply_error _400) _401) _402)); (1,f) -> u f (\_403 _404 _405-> (let _406 = (u (u (u (u parser_until1 (u fm_parser_text ")")) (u fm_parser_item fm_parser_name1)) _403) _404) in (case _406 of {(0,f) -> u f (\_407 _408 _409-> (u (u (u parser_reply_error _407) _408) _409)); (1,f) -> u f (\_410 _411 _412-> (let _413 = (u (u fm_parser_term _410) _411) in (case _413 of {(0,f) -> u f (\_414 _415 _416-> (u (u (u parser_reply_error _414) _415) _416)); (1,f) -> u f (\_417 _418 _419-> (let _420 = (u (u (u fm_parser_stop _398) _417) _418) in (case _420 of {(0,f) -> u f (\_421 _422 _423-> (u (u (u parser_reply_error _421) _422) _423)); (1,f) -> u f (\_424 _425 _426-> (let _expr_18=(u (u fm_parser_make_lambda _412) _419) in (u (u (u parser_reply_value _424) _425) (u (u fm_term_ori _426) _expr_18)))); }))); }))); }))); }))); }))))
fm_parser_lambda_erased = (\_idx_1-> (\_code_2-> (let _427 = (u (u fm_parser_init _idx_1) _code_2) in (case _427 of {(0,f) -> u f (\_428 _429 _430-> (u (u (u parser_reply_error _428) _429) _430)); (1,f) -> u f (\_431 _432 _433-> (let _434 = (u (u (u fm_parser_text "<") _431) _432) in (case _434 of {(0,f) -> u f (\_435 _436 _437-> (u (u (u parser_reply_error _435) _436) _437)); (1,f) -> u f (\_438 _439 _440-> (let _441 = (u (u (u (u parser_until1 (u fm_parser_text ">")) (u fm_parser_item fm_parser_name1)) _438) _439) in (case _441 of {(0,f) -> u f (\_442 _443 _444-> (u (u (u parser_reply_error _442) _443) _444)); (1,f) -> u f (\_445 _446 _447-> (let _448 = (u (u fm_parser_term _445) _446) in (case _448 of {(0,f) -> u f (\_449 _450 _451-> (u (u (u parser_reply_error _449) _450) _451)); (1,f) -> u f (\_452 _453 _454-> (let _455 = (u (u (u fm_parser_stop _433) _452) _453) in (case _455 of {(0,f) -> u f (\_456 _457 _458-> (u (u (u parser_reply_error _456) _457) _458)); (1,f) -> u f (\_459 _460 _461-> (let _expr_18=(u (u fm_parser_make_lambda _447) _454) in (u (u (u parser_reply_value _459) _460) (u (u fm_term_ori _461) _expr_18)))); }))); }))); }))); }))); }))))
fm_parser_lambda_nameless = (\_idx_1-> (\_code_2-> (let _462 = (u (u fm_parser_init _idx_1) _code_2) in (case _462 of {(0,f) -> u f (\_463 _464 _465-> (u (u (u parser_reply_error _463) _464) _465)); (1,f) -> u f (\_466 _467 _468-> (let _469 = (u (u (u fm_parser_text "()") _466) _467) in (case _469 of {(0,f) -> u f (\_470 _471 _472-> (u (u (u parser_reply_error _470) _471) _472)); (1,f) -> u f (\_473 _474 _475-> (let _476 = (u (u fm_parser_term _473) _474) in (case _476 of {(0,f) -> u f (\_477 _478 _479-> (u (u (u parser_reply_error _477) _478) _479)); (1,f) -> u f (\_480 _481 _482-> (let _483 = (u (u (u fm_parser_stop _468) _480) _481) in (case _483 of {(0,f) -> u f (\_484 _485 _486-> (u (u (u parser_reply_error _484) _485) _486)); (1,f) -> u f (\_487 _488 _489-> (let _expr_15=(u (u fm_term_lam "") (\_x_15-> _482)) in (u (u (u parser_reply_value _487) _488) (u (u fm_term_ori _489) _expr_15)))); }))); }))); }))); }))))
fm_parser_parenthesis = (\_idx_1-> (\_code_2-> (let _490 = (u (u (u fm_parser_text "(") _idx_1) _code_2) in (case _490 of {(0,f) -> u f (\_491 _492 _493-> (u (u (u parser_reply_error _491) _492) _493)); (1,f) -> u f (\_494 _495 _496-> (let _497 = (u (u fm_parser_term _494) _495) in (case _497 of {(0,f) -> u f (\_498 _499 _500-> (u (u (u parser_reply_error _498) _499) _500)); (1,f) -> u f (\_501 _502 _503-> (let _504 = (u (u (u fm_parser_text ")") _501) _502) in (case _504 of {(0,f) -> u f (\_505 _506 _507-> (u (u (u parser_reply_error _505) _506) _507)); (1,f) -> u f (\_508 _509 _510-> (u (u (u parser_reply_value _508) _509) _503)); }))); }))); }))))
fm_term_ref = (\_name_1-> (1,\t-> t _name_1))
fm_term_app = (\_func_1-> (\_argm_2-> (5,\t-> t _func_1 _argm_2)))
fm_term_hol = (\_path_1-> (10,\t-> t _path_1))
fm_term_let = (\_name_1-> (\_expr_2-> (\_body_3-> (6,\t-> t _name_1 _expr_2 _body_3))))
fm_parser_letforrange_u32 = (\_idx_1-> (\_code_2-> (let _511 = (u (u fm_parser_init _idx_1) _code_2) in (case _511 of {(0,f) -> u f (\_512 _513 _514-> (u (u (u parser_reply_error _512) _513) _514)); (1,f) -> u f (\_515 _516 _517-> (let _518 = (u (u (u fm_parser_text "let ") _515) _516) in (case _518 of {(0,f) -> u f (\_519 _520 _521-> (u (u (u parser_reply_error _519) _520) _521)); (1,f) -> u f (\_522 _523 _524-> (let _525 = (u (u fm_parser_name1 _522) _523) in (case _525 of {(0,f) -> u f (\_526 _527 _528-> (u (u (u parser_reply_error _526) _527) _528)); (1,f) -> u f (\_529 _530 _531-> (let _532 = (u (u (u fm_parser_text "=") _529) _530) in (case _532 of {(0,f) -> u f (\_533 _534 _535-> (u (u (u parser_reply_error _533) _534) _535)); (1,f) -> u f (\_536 _537 _538-> (let _539 = (u (u (u fm_parser_text "for ") _536) _537) in (case _539 of {(0,f) -> u f (\_540 _541 _542-> (u (u (u parser_reply_error _540) _541) _542)); (1,f) -> u f (\_543 _544 _545-> (let _546 = (u (u fm_parser_name1 _543) _544) in (case _546 of {(0,f) -> u f (\_547 _548 _549-> (u (u (u parser_reply_error _547) _548) _549)); (1,f) -> u f (\_550 _551 _552-> (let _553 = (u (u (u fm_parser_text ":") _550) _551) in (case _553 of {(0,f) -> u f (\_554 _555 _556-> (u (u (u parser_reply_error _554) _555) _556)); (1,f) -> u f (\_557 _558 _559-> (let _560 = (u (u (u fm_parser_text "U32") _557) _558) in (case _560 of {(0,f) -> u f (\_561 _562 _563-> (u (u (u parser_reply_error _561) _562) _563)); (1,f) -> u f (\_564 _565 _566-> (let _567 = (u (u (u fm_parser_text "=") _564) _565) in (case _567 of {(0,f) -> u f (\_568 _569 _570-> (u (u (u parser_reply_error _568) _569) _570)); (1,f) -> u f (\_571 _572 _573-> (let _574 = (u (u fm_parser_term _571) _572) in (case _574 of {(0,f) -> u f (\_575 _576 _577-> (u (u (u parser_reply_error _575) _576) _577)); (1,f) -> u f (\_578 _579 _580-> (let _581 = (u (u (u fm_parser_text "..") _578) _579) in (case _581 of {(0,f) -> u f (\_582 _583 _584-> (u (u (u parser_reply_error _582) _583) _584)); (1,f) -> u f (\_585 _586 _587-> (let _588 = (u (u fm_parser_term _585) _586) in (case _588 of {(0,f) -> u f (\_589 _590 _591-> (u (u (u parser_reply_error _589) _590) _591)); (1,f) -> u f (\_592 _593 _594-> (let _595 = (u (u (u fm_parser_text ":") _592) _593) in (case _595 of {(0,f) -> u f (\_596 _597 _598-> (u (u (u parser_reply_error _596) _597) _598)); (1,f) -> u f (\_599 _600 _601-> (let _602 = (u (u fm_parser_term _599) _600) in (case _602 of {(0,f) -> u f (\_603 _604 _605-> (u (u (u parser_reply_error _603) _604) _605)); (1,f) -> u f (\_606 _607 _608-> (let _609 = (u (u (u parser_maybe (u fm_parser_text ";")) _606) _607) in (case _609 of {(0,f) -> u f (\_610 _611 _612-> (u (u (u parser_reply_error _610) _611) _612)); (1,f) -> u f (\_613 _614 _615-> (let _616 = (u (u fm_parser_term _613) _614) in (case _616 of {(0,f) -> u f (\_617 _618 _619-> (u (u (u parser_reply_error _617) _618) _619)); (1,f) -> u f (\_620 _621 _622-> (let _623 = (u (u (u fm_parser_stop _517) _620) _621) in (case _623 of {(0,f) -> u f (\_624 _625 _626-> (u (u (u parser_reply_error _624) _625) _626)); (1,f) -> u f (\_627 _628 _629-> (let _term_54=(u fm_term_ref "U32.for") in (let _term_55=(u (u fm_term_app _term_54) (u fm_term_hol bits_e)) in (let _term_56=(u (u fm_term_app _term_55) (u fm_term_ref _531)) in (let _term_57=(u (u fm_term_app _term_56) _580) in (let _term_58=(u (u fm_term_app _term_57) _594) in (let _lamb_59=(u (u fm_term_lam _552) (\_e_59-> (u (u fm_term_lam _531) (\_s_60-> _608)))) in (let _term_60=(u (u fm_term_app _term_58) _lamb_59) in (let _term_61=(u (u (u fm_term_let _531) _term_60) (\_x_61-> _622)) in (u (u (u parser_reply_value _627) _628) (u (u fm_term_ori _629) _term_61))))))))))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))))
fm_parser_letforin = (\_idx_1-> (\_code_2-> (let _630 = (u (u fm_parser_init _idx_1) _code_2) in (case _630 of {(0,f) -> u f (\_631 _632 _633-> (u (u (u parser_reply_error _631) _632) _633)); (1,f) -> u f (\_634 _635 _636-> (let _637 = (u (u (u fm_parser_text "let ") _634) _635) in (case _637 of {(0,f) -> u f (\_638 _639 _640-> (u (u (u parser_reply_error _638) _639) _640)); (1,f) -> u f (\_641 _642 _643-> (let _644 = (u (u fm_parser_name1 _641) _642) in (case _644 of {(0,f) -> u f (\_645 _646 _647-> (u (u (u parser_reply_error _645) _646) _647)); (1,f) -> u f (\_648 _649 _650-> (let _651 = (u (u (u fm_parser_text "=") _648) _649) in (case _651 of {(0,f) -> u f (\_652 _653 _654-> (u (u (u parser_reply_error _652) _653) _654)); (1,f) -> u f (\_655 _656 _657-> (let _658 = (u (u (u fm_parser_text "for ") _655) _656) in (case _658 of {(0,f) -> u f (\_659 _660 _661-> (u (u (u parser_reply_error _659) _660) _661)); (1,f) -> u f (\_662 _663 _664-> (let _665 = (u (u fm_parser_name1 _662) _663) in (case _665 of {(0,f) -> u f (\_666 _667 _668-> (u (u (u parser_reply_error _666) _667) _668)); (1,f) -> u f (\_669 _670 _671-> (let _672 = (u (u (u fm_parser_text "in") _669) _670) in (case _672 of {(0,f) -> u f (\_673 _674 _675-> (u (u (u parser_reply_error _673) _674) _675)); (1,f) -> u f (\_676 _677 _678-> (let _679 = (u (u fm_parser_term _676) _677) in (case _679 of {(0,f) -> u f (\_680 _681 _682-> (u (u (u parser_reply_error _680) _681) _682)); (1,f) -> u f (\_683 _684 _685-> (let _686 = (u (u (u fm_parser_text ":") _683) _684) in (case _686 of {(0,f) -> u f (\_687 _688 _689-> (u (u (u parser_reply_error _687) _688) _689)); (1,f) -> u f (\_690 _691 _692-> (let _693 = (u (u fm_parser_term _690) _691) in (case _693 of {(0,f) -> u f (\_694 _695 _696-> (u (u (u parser_reply_error _694) _695) _696)); (1,f) -> u f (\_697 _698 _699-> (let _700 = (u (u (u parser_maybe (u fm_parser_text ";")) _697) _698) in (case _700 of {(0,f) -> u f (\_701 _702 _703-> (u (u (u parser_reply_error _701) _702) _703)); (1,f) -> u f (\_704 _705 _706-> (let _707 = (u (u fm_parser_term _704) _705) in (case _707 of {(0,f) -> u f (\_708 _709 _710-> (u (u (u parser_reply_error _708) _709) _710)); (1,f) -> u f (\_711 _712 _713-> (let _714 = (u (u (u fm_parser_stop _636) _711) _712) in (case _714 of {(0,f) -> u f (\_715 _716 _717-> (u (u (u parser_reply_error _715) _716) _717)); (1,f) -> u f (\_718 _719 _720-> (let _term_42=(u fm_term_ref "List.for") in (let _term_43=(u (u fm_term_app _term_42) (u fm_term_hol bits_e)) in (let _term_44=(u (u fm_term_app _term_43) _685) in (let _term_45=(u (u fm_term_app _term_44) (u fm_term_hol bits_e)) in (let _term_46=(u (u fm_term_app _term_45) (u fm_term_ref _650)) in (let _lamb_47=(u (u fm_term_lam _671) (\_i_47-> (u (u fm_term_lam _650) (\_x_48-> _699)))) in (let _term_48=(u (u fm_term_app _term_46) _lamb_47) in (let _term_49=(u (u (u fm_term_let _650) _term_48) (\_x_49-> _713)) in (u (u (u parser_reply_value _718) _719) (u (u fm_term_ori _720) _term_49))))))))))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))))
fm_parser_let = (\_idx_1-> (\_code_2-> (let _721 = (u (u fm_parser_init _idx_1) _code_2) in (case _721 of {(0,f) -> u f (\_722 _723 _724-> (u (u (u parser_reply_error _722) _723) _724)); (1,f) -> u f (\_725 _726 _727-> (let _728 = (u (u (u fm_parser_text "let ") _725) _726) in (case _728 of {(0,f) -> u f (\_729 _730 _731-> (u (u (u parser_reply_error _729) _730) _731)); (1,f) -> u f (\_732 _733 _734-> (let _735 = (u (u fm_parser_name _732) _733) in (case _735 of {(0,f) -> u f (\_736 _737 _738-> (u (u (u parser_reply_error _736) _737) _738)); (1,f) -> u f (\_739 _740 _741-> (let _742 = (u (u (u fm_parser_text "=") _739) _740) in (case _742 of {(0,f) -> u f (\_743 _744 _745-> (u (u (u parser_reply_error _743) _744) _745)); (1,f) -> u f (\_746 _747 _748-> (let _749 = (u (u fm_parser_term _746) _747) in (case _749 of {(0,f) -> u f (\_750 _751 _752-> (u (u (u parser_reply_error _750) _751) _752)); (1,f) -> u f (\_753 _754 _755-> (let _756 = (u (u (u parser_maybe (u fm_parser_text ";")) _753) _754) in (case _756 of {(0,f) -> u f (\_757 _758 _759-> (u (u (u parser_reply_error _757) _758) _759)); (1,f) -> u f (\_760 _761 _762-> (let _763 = (u (u fm_parser_term _760) _761) in (case _763 of {(0,f) -> u f (\_764 _765 _766-> (u (u (u parser_reply_error _764) _765) _766)); (1,f) -> u f (\_767 _768 _769-> (let _770 = (u (u (u fm_parser_stop _727) _767) _768) in (case _770 of {(0,f) -> u f (\_771 _772 _773-> (u (u (u parser_reply_error _771) _772) _773)); (1,f) -> u f (\_774 _775 _776-> (u (u (u parser_reply_value _774) _775) (u (u fm_term_ori _776) (u (u (u fm_term_let _741) _755) (\_x_27-> _769))))); }))); }))); }))); }))); }))); }))); }))); }))))
fm_parser_get = (\_idx_1-> (\_code_2-> (let _777 = (u (u fm_parser_init _idx_1) _code_2) in (case _777 of {(0,f) -> u f (\_778 _779 _780-> (u (u (u parser_reply_error _778) _779) _780)); (1,f) -> u f (\_781 _782 _783-> (let _784 = (u (u (u fm_parser_text "let ") _781) _782) in (case _784 of {(0,f) -> u f (\_785 _786 _787-> (u (u (u parser_reply_error _785) _786) _787)); (1,f) -> u f (\_788 _789 _790-> (let _791 = (u (u (u fm_parser_text "{") _788) _789) in (case _791 of {(0,f) -> u f (\_792 _793 _794-> (u (u (u parser_reply_error _792) _793) _794)); (1,f) -> u f (\_795 _796 _797-> (let _798 = (u (u fm_parser_name _795) _796) in (case _798 of {(0,f) -> u f (\_799 _800 _801-> (u (u (u parser_reply_error _799) _800) _801)); (1,f) -> u f (\_802 _803 _804-> (let _805 = (u (u (u fm_parser_text ",") _802) _803) in (case _805 of {(0,f) -> u f (\_806 _807 _808-> (u (u (u parser_reply_error _806) _807) _808)); (1,f) -> u f (\_809 _810 _811-> (let _812 = (u (u fm_parser_name _809) _810) in (case _812 of {(0,f) -> u f (\_813 _814 _815-> (u (u (u parser_reply_error _813) _814) _815)); (1,f) -> u f (\_816 _817 _818-> (let _819 = (u (u (u fm_parser_text "}") _816) _817) in (case _819 of {(0,f) -> u f (\_820 _821 _822-> (u (u (u parser_reply_error _820) _821) _822)); (1,f) -> u f (\_823 _824 _825-> (let _826 = (u (u (u fm_parser_text "=") _823) _824) in (case _826 of {(0,f) -> u f (\_827 _828 _829-> (u (u (u parser_reply_error _827) _828) _829)); (1,f) -> u f (\_830 _831 _832-> (let _833 = (u (u fm_parser_term _830) _831) in (case _833 of {(0,f) -> u f (\_834 _835 _836-> (u (u (u parser_reply_error _834) _835) _836)); (1,f) -> u f (\_837 _838 _839-> (let _840 = (u (u (u parser_maybe (u fm_parser_text ";")) _837) _838) in (case _840 of {(0,f) -> u f (\_841 _842 _843-> (u (u (u parser_reply_error _841) _842) _843)); (1,f) -> u f (\_844 _845 _846-> (let _847 = (u (u fm_parser_term _844) _845) in (case _847 of {(0,f) -> u f (\_848 _849 _850-> (u (u (u parser_reply_error _848) _849) _850)); (1,f) -> u f (\_851 _852 _853-> (let _854 = (u (u (u fm_parser_stop _783) _851) _852) in (case _854 of {(0,f) -> u f (\_855 _856 _857-> (u (u (u parser_reply_error _855) _856) _857)); (1,f) -> u f (\_858 _859 _860-> (let _term_39=_839 in (let _term_40=(u (u fm_term_app _term_39) (u (u fm_term_lam "x") (\_x_40-> (u fm_term_hol bits_e)))) in (let _term_41=(u (u fm_term_app _term_40) (u (u fm_term_lam _804) (\_x_41-> (u (u fm_term_lam _818) (\_y_42-> _853))))) in (u (u (u parser_reply_value _858) _859) (u (u fm_term_ori _860) _term_41)))))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))))
fm_term_def = (\_name_1-> (\_expr_2-> (\_body_3-> (7,\t-> t _name_1 _expr_2 _body_3))))
fm_parser_def = (\_idx_1-> (\_code_2-> (let _861 = (u (u fm_parser_init _idx_1) _code_2) in (case _861 of {(0,f) -> u f (\_862 _863 _864-> (u (u (u parser_reply_error _862) _863) _864)); (1,f) -> u f (\_865 _866 _867-> (let _868 = (u (u (u fm_parser_text "def ") _865) _866) in (case _868 of {(0,f) -> u f (\_869 _870 _871-> (u (u (u parser_reply_error _869) _870) _871)); (1,f) -> u f (\_872 _873 _874-> (let _875 = (u (u fm_parser_name _872) _873) in (case _875 of {(0,f) -> u f (\_876 _877 _878-> (u (u (u parser_reply_error _876) _877) _878)); (1,f) -> u f (\_879 _880 _881-> (let _882 = (u (u (u fm_parser_text "=") _879) _880) in (case _882 of {(0,f) -> u f (\_883 _884 _885-> (u (u (u parser_reply_error _883) _884) _885)); (1,f) -> u f (\_886 _887 _888-> (let _889 = (u (u fm_parser_term _886) _887) in (case _889 of {(0,f) -> u f (\_890 _891 _892-> (u (u (u parser_reply_error _890) _891) _892)); (1,f) -> u f (\_893 _894 _895-> (let _896 = (u (u (u parser_maybe (u fm_parser_text ";")) _893) _894) in (case _896 of {(0,f) -> u f (\_897 _898 _899-> (u (u (u parser_reply_error _897) _898) _899)); (1,f) -> u f (\_900 _901 _902-> (let _903 = (u (u fm_parser_term _900) _901) in (case _903 of {(0,f) -> u f (\_904 _905 _906-> (u (u (u parser_reply_error _904) _905) _906)); (1,f) -> u f (\_907 _908 _909-> (let _910 = (u (u (u fm_parser_stop _867) _907) _908) in (case _910 of {(0,f) -> u f (\_911 _912 _913-> (u (u (u parser_reply_error _911) _912) _913)); (1,f) -> u f (\_914 _915 _916-> (u (u (u parser_reply_value _914) _915) (u (u fm_term_ori _916) (u (u (u fm_term_def _881) _895) (\_x_27-> _909))))); }))); }))); }))); }))); }))); }))); }))); }))))
fm_parser_if = (\_idx_1-> (\_code_2-> (let _917 = (u (u fm_parser_init _idx_1) _code_2) in (case _917 of {(0,f) -> u f (\_918 _919 _920-> (u (u (u parser_reply_error _918) _919) _920)); (1,f) -> u f (\_921 _922 _923-> (let _924 = (u (u (u fm_parser_text "if ") _921) _922) in (case _924 of {(0,f) -> u f (\_925 _926 _927-> (u (u (u parser_reply_error _925) _926) _927)); (1,f) -> u f (\_928 _929 _930-> (let _931 = (u (u fm_parser_term _928) _929) in (case _931 of {(0,f) -> u f (\_932 _933 _934-> (u (u (u parser_reply_error _932) _933) _934)); (1,f) -> u f (\_935 _936 _937-> (let _938 = (u (u (u fm_parser_text "then") _935) _936) in (case _938 of {(0,f) -> u f (\_939 _940 _941-> (u (u (u parser_reply_error _939) _940) _941)); (1,f) -> u f (\_942 _943 _944-> (let _945 = (u (u fm_parser_term _942) _943) in (case _945 of {(0,f) -> u f (\_946 _947 _948-> (u (u (u parser_reply_error _946) _947) _948)); (1,f) -> u f (\_949 _950 _951-> (let _952 = (u (u (u fm_parser_text "else") _949) _950) in (case _952 of {(0,f) -> u f (\_953 _954 _955-> (u (u (u parser_reply_error _953) _954) _955)); (1,f) -> u f (\_956 _957 _958-> (let _959 = (u (u fm_parser_term _956) _957) in (case _959 of {(0,f) -> u f (\_960 _961 _962-> (u (u (u parser_reply_error _960) _961) _962)); (1,f) -> u f (\_963 _964 _965-> (let _966 = (u (u (u fm_parser_stop _923) _963) _964) in (case _966 of {(0,f) -> u f (\_967 _968 _969-> (u (u (u parser_reply_error _967) _968) _969)); (1,f) -> u f (\_970 _971 _972-> (let _term_27=_937 in (let _term_28=(u (u fm_term_app _term_27) (u (u fm_term_lam "") (\_x_28-> (u fm_term_hol bits_e)))) in (let _term_29=(u (u fm_term_app _term_28) _951) in (let _term_30=(u (u fm_term_app _term_29) _965) in (u (u (u parser_reply_value _970) _971) (u (u fm_term_ori _972) _term_30))))))); }))); }))); }))); }))); }))); }))); }))); }))))
list_mapped = (\_as_2-> (\_f_4-> (let _973 = _as_2 in (case _973 of {(0,f) -> u f (list_nil); (1,f) -> u f (\_974 _975-> (u (u list_cons (u _f_4 _974)) (u (u list_mapped _975) _f_4))); }))))
fm_backslash = 92
fm_escapes = (u (u list_cons (u (u pair_new "\\b") 8)) (u (u list_cons (u (u pair_new "\\f") 12)) (u (u list_cons (u (u pair_new "\\n") 10)) (u (u list_cons (u (u pair_new "\\r") 13)) (u (u list_cons (u (u pair_new "\\t") 9)) (u (u list_cons (u (u pair_new "\\v") 11)) (u (u list_cons (u (u pair_new (u (u string_cons fm_backslash) (u (u string_cons fm_backslash) string_nil))) fm_backslash)) (u (u list_cons (u (u pair_new "\\\"") 34)) (u (u list_cons (u (u pair_new "\\0") 0)) (u (u list_cons (u (u pair_new "\\'") 39)) list_nil))))))))))
fm_parser_char_single = (u parser_first_of (u (u list_cons (u parser_first_of (u (u list_mapped fm_escapes) (\_esc_1-> (let _976 = _esc_1 in (case _976 of {(0,f) -> u f (\_977 _978-> (\_idx_4-> (\_code_5-> (let _979 = (u (u (u parser_text _977) _idx_4) _code_5) in (case _979 of {(0,f) -> u f (\_980 _981 _982-> (u (u (u parser_reply_error _980) _981) _982)); (1,f) -> u f (\_983 _984 _985-> (u (u (u parser_reply_value _983) _984) _978)); }))))); })))))) (u (u list_cons parser_one) list_nil)))
fm_term_chr = (\_chrx_1-> (12,\t-> t _chrx_1))
fm_parser_char = (\_idx_1-> (\_code_2-> (let _986 = (u (u fm_parser_init _idx_1) _code_2) in (case _986 of {(0,f) -> u f (\_987 _988 _989-> (u (u (u parser_reply_error _987) _988) _989)); (1,f) -> u f (\_990 _991 _992-> (let _993 = (u (u (u fm_parser_text "'") _990) _991) in (case _993 of {(0,f) -> u f (\_994 _995 _996-> (u (u (u parser_reply_error _994) _995) _996)); (1,f) -> u f (\_997 _998 _999-> (let _1000 = (u (u fm_parser_char_single _997) _998) in (case _1000 of {(0,f) -> u f (\_1001 _1002 _1003-> (u (u (u parser_reply_error _1001) _1002) _1003)); (1,f) -> u f (\_1004 _1005 _1006-> (let _1007 = (u (u (u parser_text "'") _1004) _1005) in (case _1007 of {(0,f) -> u f (\_1008 _1009 _1010-> (u (u (u parser_reply_error _1008) _1009) _1010)); (1,f) -> u f (\_1011 _1012 _1013-> (let _1014 = (u (u (u fm_parser_stop _992) _1011) _1012) in (case _1014 of {(0,f) -> u f (\_1015 _1016 _1017-> (u (u (u parser_reply_error _1015) _1016) _1017)); (1,f) -> u f (\_1018 _1019 _1020-> (u (u (u parser_reply_value _1018) _1019) (u (u fm_term_ori _1020) (u fm_term_chr _1006)))); }))); }))); }))); }))); }))))
fm_term_str = (\_strx_1-> (13,\t-> t _strx_1))
fm_parser_string = (\_idx_1-> (\_code_2-> (let _1021 = (u (u fm_parser_init _idx_1) _code_2) in (case _1021 of {(0,f) -> u f (\_1022 _1023 _1024-> (u (u (u parser_reply_error _1022) _1023) _1024)); (1,f) -> u f (\_1025 _1026 _1027-> (let _quot_6=(u (u string_cons 34) string_nil) in (let _1028 = (u (u (u fm_parser_text _quot_6) _1025) _1026) in (case _1028 of {(0,f) -> u f (\_1029 _1030 _1031-> (u (u (u parser_reply_error _1029) _1030) _1031)); (1,f) -> u f (\_1032 _1033 _1034-> (let _1035 = (u (u (u (u parser_until (u parser_text _quot_6)) fm_parser_char_single) _1032) _1033) in (case _1035 of {(0,f) -> u f (\_1036 _1037 _1038-> (u (u (u parser_reply_error _1036) _1037) _1038)); (1,f) -> u f (\_1039 _1040 _1041-> (let _strx_13=(u (u (u list_fold _1041) string_nil) string_cons) in (let _1042 = (u (u (u fm_parser_stop _1027) _1039) _1040) in (case _1042 of {(0,f) -> u f (\_1043 _1044 _1045-> (u (u (u parser_reply_error _1043) _1044) _1045)); (1,f) -> u f (\_1046 _1047 _1048-> (u (u (u parser_reply_value _1046) _1047) (u (u fm_term_ori _1048) (u fm_term_str _strx_13)))); })))); }))); })))); }))))
fm_parser_pair = (\_idx_1-> (\_code_2-> (let _1049 = (u (u fm_parser_init _idx_1) _code_2) in (case _1049 of {(0,f) -> u f (\_1050 _1051 _1052-> (u (u (u parser_reply_error _1050) _1051) _1052)); (1,f) -> u f (\_1053 _1054 _1055-> (let _1056 = (u (u (u fm_parser_text "{") _1053) _1054) in (case _1056 of {(0,f) -> u f (\_1057 _1058 _1059-> (u (u (u parser_reply_error _1057) _1058) _1059)); (1,f) -> u f (\_1060 _1061 _1062-> (let _1063 = (u (u fm_parser_term _1060) _1061) in (case _1063 of {(0,f) -> u f (\_1064 _1065 _1066-> (u (u (u parser_reply_error _1064) _1065) _1066)); (1,f) -> u f (\_1067 _1068 _1069-> (let _1070 = (u (u (u fm_parser_text ",") _1067) _1068) in (case _1070 of {(0,f) -> u f (\_1071 _1072 _1073-> (u (u (u parser_reply_error _1071) _1072) _1073)); (1,f) -> u f (\_1074 _1075 _1076-> (let _1077 = (u (u fm_parser_term _1074) _1075) in (case _1077 of {(0,f) -> u f (\_1078 _1079 _1080-> (u (u (u parser_reply_error _1078) _1079) _1080)); (1,f) -> u f (\_1081 _1082 _1083-> (let _1084 = (u (u (u fm_parser_text "}") _1081) _1082) in (case _1084 of {(0,f) -> u f (\_1085 _1086 _1087-> (u (u (u parser_reply_error _1085) _1086) _1087)); (1,f) -> u f (\_1088 _1089 _1090-> (let _1091 = (u (u (u fm_parser_stop _1055) _1088) _1089) in (case _1091 of {(0,f) -> u f (\_1092 _1093 _1094-> (u (u (u parser_reply_error _1092) _1093) _1094)); (1,f) -> u f (\_1095 _1096 _1097-> (let _term_24=(u fm_term_ref "Pair.new") in (let _term_25=(u (u fm_term_app _term_24) (u fm_term_hol bits_e)) in (let _term_26=(u (u fm_term_app _term_25) (u fm_term_hol bits_e)) in (let _term_27=(u (u fm_term_app _term_26) _1069) in (let _term_28=(u (u fm_term_app _term_27) _1083) in (u (u (u parser_reply_value _1095) _1096) (u (u fm_term_ori _1097) _term_28)))))))); }))); }))); }))); }))); }))); }))); }))))
fm_parser_sigma_type = (\_idx_1-> (\_code_2-> (let _1098 = (u (u fm_parser_init _idx_1) _code_2) in (case _1098 of {(0,f) -> u f (\_1099 _1100 _1101-> (u (u (u parser_reply_error _1099) _1100) _1101)); (1,f) -> u f (\_1102 _1103 _1104-> (let _1105 = (u (u (u fm_parser_text "{") _1102) _1103) in (case _1105 of {(0,f) -> u f (\_1106 _1107 _1108-> (u (u (u parser_reply_error _1106) _1107) _1108)); (1,f) -> u f (\_1109 _1110 _1111-> (let _1112 = (u (u fm_parser_name1 _1109) _1110) in (case _1112 of {(0,f) -> u f (\_1113 _1114 _1115-> (u (u (u parser_reply_error _1113) _1114) _1115)); (1,f) -> u f (\_1116 _1117 _1118-> (let _1119 = (u (u (u fm_parser_text ":") _1116) _1117) in (case _1119 of {(0,f) -> u f (\_1120 _1121 _1122-> (u (u (u parser_reply_error _1120) _1121) _1122)); (1,f) -> u f (\_1123 _1124 _1125-> (let _1126 = (u (u fm_parser_term _1123) _1124) in (case _1126 of {(0,f) -> u f (\_1127 _1128 _1129-> (u (u (u parser_reply_error _1127) _1128) _1129)); (1,f) -> u f (\_1130 _1131 _1132-> (let _1133 = (u (u (u fm_parser_text "}") _1130) _1131) in (case _1133 of {(0,f) -> u f (\_1134 _1135 _1136-> (u (u (u parser_reply_error _1134) _1135) _1136)); (1,f) -> u f (\_1137 _1138 _1139-> (let _1140 = (u (u fm_parser_term _1137) _1138) in (case _1140 of {(0,f) -> u f (\_1141 _1142 _1143-> (u (u (u parser_reply_error _1141) _1142) _1143)); (1,f) -> u f (\_1144 _1145 _1146-> (let _1147 = (u (u (u fm_parser_stop _1104) _1144) _1145) in (case _1147 of {(0,f) -> u f (\_1148 _1149 _1150-> (u (u (u parser_reply_error _1148) _1149) _1150)); (1,f) -> u f (\_1151 _1152 _1153-> (let _term_27=(u fm_term_ref "Sigma") in (let _term_28=(u (u fm_term_app _term_27) _1132) in (let _term_29=(u (u fm_term_app _term_28) (u (u fm_term_lam "x") (\_x_29-> _1146))) in (u (u (u parser_reply_value _1151) _1152) (u (u fm_term_ori _1153) _term_29)))))); }))); }))); }))); }))); }))); }))); }))); }))))
fm_parser_some = (\_idx_1-> (\_code_2-> (let _1154 = (u (u fm_parser_init _idx_1) _code_2) in (case _1154 of {(0,f) -> u f (\_1155 _1156 _1157-> (u (u (u parser_reply_error _1155) _1156) _1157)); (1,f) -> u f (\_1158 _1159 _1160-> (let _1161 = (u (u (u fm_parser_text "some(") _1158) _1159) in (case _1161 of {(0,f) -> u f (\_1162 _1163 _1164-> (u (u (u parser_reply_error _1162) _1163) _1164)); (1,f) -> u f (\_1165 _1166 _1167-> (let _1168 = (u (u fm_parser_term _1165) _1166) in (case _1168 of {(0,f) -> u f (\_1169 _1170 _1171-> (u (u (u parser_reply_error _1169) _1170) _1171)); (1,f) -> u f (\_1172 _1173 _1174-> (let _1175 = (u (u (u fm_parser_text ")") _1172) _1173) in (case _1175 of {(0,f) -> u f (\_1176 _1177 _1178-> (u (u (u parser_reply_error _1176) _1177) _1178)); (1,f) -> u f (\_1179 _1180 _1181-> (let _1182 = (u (u (u fm_parser_stop _1160) _1179) _1180) in (case _1182 of {(0,f) -> u f (\_1183 _1184 _1185-> (u (u (u parser_reply_error _1183) _1184) _1185)); (1,f) -> u f (\_1186 _1187 _1188-> (let _term_18=(u fm_term_ref "Maybe.some") in (let _term_19=(u (u fm_term_app _term_18) (u fm_term_hol bits_e)) in (let _term_20=(u (u fm_term_app _term_19) _1174) in (u (u (u parser_reply_value _1186) _1187) (u (u fm_term_ori _1188) _term_20)))))); }))); }))); }))); }))); }))))
fm_parser_apply = (\_idx_1-> (\_code_2-> (let _1189 = (u (u fm_parser_init _idx_1) _code_2) in (case _1189 of {(0,f) -> u f (\_1190 _1191 _1192-> (u (u (u parser_reply_error _1190) _1191) _1192)); (1,f) -> u f (\_1193 _1194 _1195-> (let _1196 = (u (u (u fm_parser_text "apply(") _1193) _1194) in (case _1196 of {(0,f) -> u f (\_1197 _1198 _1199-> (u (u (u parser_reply_error _1197) _1198) _1199)); (1,f) -> u f (\_1200 _1201 _1202-> (let _1203 = (u (u fm_parser_term _1200) _1201) in (case _1203 of {(0,f) -> u f (\_1204 _1205 _1206-> (u (u (u parser_reply_error _1204) _1205) _1206)); (1,f) -> u f (\_1207 _1208 _1209-> (let _1210 = (u (u (u fm_parser_text ",") _1207) _1208) in (case _1210 of {(0,f) -> u f (\_1211 _1212 _1213-> (u (u (u parser_reply_error _1211) _1212) _1213)); (1,f) -> u f (\_1214 _1215 _1216-> (let _1217 = (u (u fm_parser_term _1214) _1215) in (case _1217 of {(0,f) -> u f (\_1218 _1219 _1220-> (u (u (u parser_reply_error _1218) _1219) _1220)); (1,f) -> u f (\_1221 _1222 _1223-> (let _1224 = (u (u (u fm_parser_text ")") _1221) _1222) in (case _1224 of {(0,f) -> u f (\_1225 _1226 _1227-> (u (u (u parser_reply_error _1225) _1226) _1227)); (1,f) -> u f (\_1228 _1229 _1230-> (let _1231 = (u (u (u fm_parser_stop _1195) _1228) _1229) in (case _1231 of {(0,f) -> u f (\_1232 _1233 _1234-> (u (u (u parser_reply_error _1232) _1233) _1234)); (1,f) -> u f (\_1235 _1236 _1237-> (let _term_24=(u fm_term_ref "Equal.apply") in (let _term_25=(u (u fm_term_app _term_24) (u fm_term_hol bits_e)) in (let _term_26=(u (u fm_term_app _term_25) (u fm_term_hol bits_e)) in (let _term_27=(u (u fm_term_app _term_26) (u fm_term_hol bits_e)) in (let _term_28=(u (u fm_term_app _term_27) (u fm_term_hol bits_e)) in (let _term_29=(u (u fm_term_app _term_28) _1209) in (let _term_30=(u (u fm_term_app _term_29) _1223) in (u (u (u parser_reply_value _1235) _1236) (u (u fm_term_ori _1237) _term_30)))))))))); }))); }))); }))); }))); }))); }))); }))))
fm_parser_mirror = (\_idx_1-> (\_code_2-> (let _1238 = (u (u fm_parser_init _idx_1) _code_2) in (case _1238 of {(0,f) -> u f (\_1239 _1240 _1241-> (u (u (u parser_reply_error _1239) _1240) _1241)); (1,f) -> u f (\_1242 _1243 _1244-> (let _1245 = (u (u (u fm_parser_text "mirror(") _1242) _1243) in (case _1245 of {(0,f) -> u f (\_1246 _1247 _1248-> (u (u (u parser_reply_error _1246) _1247) _1248)); (1,f) -> u f (\_1249 _1250 _1251-> (let _1252 = (u (u fm_parser_term _1249) _1250) in (case _1252 of {(0,f) -> u f (\_1253 _1254 _1255-> (u (u (u parser_reply_error _1253) _1254) _1255)); (1,f) -> u f (\_1256 _1257 _1258-> (let _1259 = (u (u (u fm_parser_text ")") _1256) _1257) in (case _1259 of {(0,f) -> u f (\_1260 _1261 _1262-> (u (u (u parser_reply_error _1260) _1261) _1262)); (1,f) -> u f (\_1263 _1264 _1265-> (let _1266 = (u (u (u fm_parser_stop _1244) _1263) _1264) in (case _1266 of {(0,f) -> u f (\_1267 _1268 _1269-> (u (u (u parser_reply_error _1267) _1268) _1269)); (1,f) -> u f (\_1270 _1271 _1272-> (let _term_18=(u fm_term_ref "Equal.mirror") in (let _term_19=(u (u fm_term_app _term_18) (u fm_term_hol bits_e)) in (let _term_20=(u (u fm_term_app _term_19) (u fm_term_hol bits_e)) in (let _term_21=(u (u fm_term_app _term_20) (u fm_term_hol bits_e)) in (let _term_22=(u (u fm_term_app _term_21) _1258) in (u (u (u parser_reply_value _1270) _1271) (u (u fm_term_ori _1272) _term_22)))))))); }))); }))); }))); }))); }))))
fm_name_read = (\_str_1-> _str_1)
fm_parser_list = (\_idx_1-> (\_code_2-> (let _1273 = (u (u fm_parser_init _idx_1) _code_2) in (case _1273 of {(0,f) -> u f (\_1274 _1275 _1276-> (u (u (u parser_reply_error _1274) _1275) _1276)); (1,f) -> u f (\_1277 _1278 _1279-> (let _1280 = (u (u (u fm_parser_text "[") _1277) _1278) in (case _1280 of {(0,f) -> u f (\_1281 _1282 _1283-> (u (u (u parser_reply_error _1281) _1282) _1283)); (1,f) -> u f (\_1284 _1285 _1286-> (let _1287 = (u (u (u (u parser_until (u fm_parser_text "]")) (u fm_parser_item fm_parser_term)) _1284) _1285) in (case _1287 of {(0,f) -> u f (\_1288 _1289 _1290-> (u (u (u parser_reply_error _1288) _1289) _1290)); (1,f) -> u f (\_1291 _1292 _1293-> (let _1294 = (u (u (u fm_parser_stop _1279) _1291) _1292) in (case _1294 of {(0,f) -> u f (\_1295 _1296 _1297-> (u (u (u parser_reply_error _1295) _1296) _1297)); (1,f) -> u f (\_1298 _1299 _1300-> (u (u (u parser_reply_value _1298) _1299) (u (u (u list_fold _1293) (u (u fm_term_app (u fm_term_ref (u fm_name_read "List.nil"))) (u fm_term_hol bits_e))) (\_x_15-> (\_xs_16-> (let _term_17=(u fm_term_ref (u fm_name_read "List.cons")) in (let _term_18=(u (u fm_term_app _term_17) (u fm_term_hol bits_e)) in (let _term_19=(u (u fm_term_app _term_18) _x_15) in (let _term_20=(u (u fm_term_app _term_19) _xs_16) in (u (u fm_term_ori _1300) _term_20)))))))))); }))); }))); }))); }))))
fm_parser_log = (\_idx_1-> (\_code_2-> (let _1301 = (u (u fm_parser_init _idx_1) _code_2) in (case _1301 of {(0,f) -> u f (\_1302 _1303 _1304-> (u (u (u parser_reply_error _1302) _1303) _1304)); (1,f) -> u f (\_1305 _1306 _1307-> (let _1308 = (u (u (u fm_parser_text "log(") _1305) _1306) in (case _1308 of {(0,f) -> u f (\_1309 _1310 _1311-> (u (u (u parser_reply_error _1309) _1310) _1311)); (1,f) -> u f (\_1312 _1313 _1314-> (let _1315 = (u (u (u (u parser_until (u fm_parser_text ")")) (u fm_parser_item fm_parser_term)) _1312) _1313) in (case _1315 of {(0,f) -> u f (\_1316 _1317 _1318-> (u (u (u parser_reply_error _1316) _1317) _1318)); (1,f) -> u f (\_1319 _1320 _1321-> (let _1322 = (u (u fm_parser_term _1319) _1320) in (case _1322 of {(0,f) -> u f (\_1323 _1324 _1325-> (u (u (u parser_reply_error _1323) _1324) _1325)); (1,f) -> u f (\_1326 _1327 _1328-> (let _term_15=(u fm_term_ref "Debug.log") in (let _term_16=(u (u fm_term_app _term_15) (u fm_term_hol bits_e)) in (let _args_17=(u (u (u list_fold _1321) (u fm_term_ref "String.nil")) (\_x_17-> (\_xs_18-> (let _arg_19=(u fm_term_ref "String.concat") in (let _arg_20=(u (u fm_term_app _arg_19) _x_17) in (let _arg_21=(u (u fm_term_app _arg_20) _xs_18) in _arg_21)))))) in (let _term_18=(u (u fm_term_app _term_16) _args_17) in (let _term_19=(u (u fm_term_app _term_18) (u (u fm_term_lam "x") (\_x_19-> _1328))) in (let _1329 = (u (u (u fm_parser_stop _1307) _1326) _1327) in (case _1329 of {(0,f) -> u f (\_1330 _1331 _1332-> (u (u (u parser_reply_error _1330) _1331) _1332)); (1,f) -> u f (\_1333 _1334 _1335-> (u (u (u parser_reply_value _1333) _1334) (u (u fm_term_ori _1335) _term_19))); })))))))); }))); }))); }))); }))))
fm_parser_forrange_u32 = (\_idx_1-> (\_code_2-> (let _1336 = (u (u fm_parser_init _idx_1) _code_2) in (case _1336 of {(0,f) -> u f (\_1337 _1338 _1339-> (u (u (u parser_reply_error _1337) _1338) _1339)); (1,f) -> u f (\_1340 _1341 _1342-> (let _1343 = (u (u (u fm_parser_text "for ") _1340) _1341) in (case _1343 of {(0,f) -> u f (\_1344 _1345 _1346-> (u (u (u parser_reply_error _1344) _1345) _1346)); (1,f) -> u f (\_1347 _1348 _1349-> (let _1350 = (u (u fm_parser_name1 _1347) _1348) in (case _1350 of {(0,f) -> u f (\_1351 _1352 _1353-> (u (u (u parser_reply_error _1351) _1352) _1353)); (1,f) -> u f (\_1354 _1355 _1356-> (let _1357 = (u (u (u fm_parser_text ":") _1354) _1355) in (case _1357 of {(0,f) -> u f (\_1358 _1359 _1360-> (u (u (u parser_reply_error _1358) _1359) _1360)); (1,f) -> u f (\_1361 _1362 _1363-> (let _1364 = (u (u (u fm_parser_text "U32") _1361) _1362) in (case _1364 of {(0,f) -> u f (\_1365 _1366 _1367-> (u (u (u parser_reply_error _1365) _1366) _1367)); (1,f) -> u f (\_1368 _1369 _1370-> (let _1371 = (u (u (u fm_parser_text "=") _1368) _1369) in (case _1371 of {(0,f) -> u f (\_1372 _1373 _1374-> (u (u (u parser_reply_error _1372) _1373) _1374)); (1,f) -> u f (\_1375 _1376 _1377-> (let _1378 = (u (u fm_parser_term _1375) _1376) in (case _1378 of {(0,f) -> u f (\_1379 _1380 _1381-> (u (u (u parser_reply_error _1379) _1380) _1381)); (1,f) -> u f (\_1382 _1383 _1384-> (let _1385 = (u (u (u fm_parser_text "..") _1382) _1383) in (case _1385 of {(0,f) -> u f (\_1386 _1387 _1388-> (u (u (u parser_reply_error _1386) _1387) _1388)); (1,f) -> u f (\_1389 _1390 _1391-> (let _1392 = (u (u fm_parser_term _1389) _1390) in (case _1392 of {(0,f) -> u f (\_1393 _1394 _1395-> (u (u (u parser_reply_error _1393) _1394) _1395)); (1,f) -> u f (\_1396 _1397 _1398-> (let _1399 = (u (u (u fm_parser_text "with") _1396) _1397) in (case _1399 of {(0,f) -> u f (\_1400 _1401 _1402-> (u (u (u parser_reply_error _1400) _1401) _1402)); (1,f) -> u f (\_1403 _1404 _1405-> (let _1406 = (u (u fm_parser_name1 _1403) _1404) in (case _1406 of {(0,f) -> u f (\_1407 _1408 _1409-> (u (u (u parser_reply_error _1407) _1408) _1409)); (1,f) -> u f (\_1410 _1411 _1412-> (let _1413 = (u (u (u fm_parser_text ":") _1410) _1411) in (case _1413 of {(0,f) -> u f (\_1414 _1415 _1416-> (u (u (u parser_reply_error _1414) _1415) _1416)); (1,f) -> u f (\_1417 _1418 _1419-> (let _1420 = (u (u fm_parser_term _1417) _1418) in (case _1420 of {(0,f) -> u f (\_1421 _1422 _1423-> (u (u (u parser_reply_error _1421) _1422) _1423)); (1,f) -> u f (\_1424 _1425 _1426-> (let _1427 = (u (u (u fm_parser_stop _1342) _1424) _1425) in (case _1427 of {(0,f) -> u f (\_1428 _1429 _1430-> (u (u (u parser_reply_error _1428) _1429) _1430)); (1,f) -> u f (\_1431 _1432 _1433-> (let _term_45=(u fm_term_ref "U32.for") in (let _term_46=(u (u fm_term_app _term_45) (u fm_term_hol bits_e)) in (let _term_47=(u (u fm_term_app _term_46) (u fm_term_ref _1412)) in (let _term_48=(u (u fm_term_app _term_47) _1384) in (let _term_49=(u (u fm_term_app _term_48) _1398) in (let _lamb_50=(u (u fm_term_lam _1356) (\_e_50-> (u (u fm_term_lam _1412) (\_s_51-> _1426)))) in (let _term_51=(u (u fm_term_app _term_49) _lamb_50) in (let _term_52=(u (u (u fm_term_let _1412) _term_51) (\_x_52-> (u fm_term_ref _1412))) in (u (u (u parser_reply_value _1431) _1432) (u (u fm_term_ori _1433) _term_52))))))))))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))))
fm_parser_forrange_u32_2 = (\_idx_1-> (\_code_2-> (let _1434 = (u (u fm_parser_init _idx_1) _code_2) in (case _1434 of {(0,f) -> u f (\_1435 _1436 _1437-> (u (u (u parser_reply_error _1435) _1436) _1437)); (1,f) -> u f (\_1438 _1439 _1440-> (let _1441 = (u (u (u fm_parser_text "for ") _1438) _1439) in (case _1441 of {(0,f) -> u f (\_1442 _1443 _1444-> (u (u (u parser_reply_error _1442) _1443) _1444)); (1,f) -> u f (\_1445 _1446 _1447-> (let _1448 = (u (u fm_parser_name1 _1445) _1446) in (case _1448 of {(0,f) -> u f (\_1449 _1450 _1451-> (u (u (u parser_reply_error _1449) _1450) _1451)); (1,f) -> u f (\_1452 _1453 _1454-> (let _1455 = (u (u (u fm_parser_text ":") _1452) _1453) in (case _1455 of {(0,f) -> u f (\_1456 _1457 _1458-> (u (u (u parser_reply_error _1456) _1457) _1458)); (1,f) -> u f (\_1459 _1460 _1461-> (let _1462 = (u (u (u fm_parser_text "U32") _1459) _1460) in (case _1462 of {(0,f) -> u f (\_1463 _1464 _1465-> (u (u (u parser_reply_error _1463) _1464) _1465)); (1,f) -> u f (\_1466 _1467 _1468-> (let _1469 = (u (u (u fm_parser_text "=") _1466) _1467) in (case _1469 of {(0,f) -> u f (\_1470 _1471 _1472-> (u (u (u parser_reply_error _1470) _1471) _1472)); (1,f) -> u f (\_1473 _1474 _1475-> (let _1476 = (u (u fm_parser_term _1473) _1474) in (case _1476 of {(0,f) -> u f (\_1477 _1478 _1479-> (u (u (u parser_reply_error _1477) _1478) _1479)); (1,f) -> u f (\_1480 _1481 _1482-> (let _1483 = (u (u (u fm_parser_text "..") _1480) _1481) in (case _1483 of {(0,f) -> u f (\_1484 _1485 _1486-> (u (u (u parser_reply_error _1484) _1485) _1486)); (1,f) -> u f (\_1487 _1488 _1489-> (let _1490 = (u (u fm_parser_term _1487) _1488) in (case _1490 of {(0,f) -> u f (\_1491 _1492 _1493-> (u (u (u parser_reply_error _1491) _1492) _1493)); (1,f) -> u f (\_1494 _1495 _1496-> (let _1497 = (u (u (u fm_parser_text ":") _1494) _1495) in (case _1497 of {(0,f) -> u f (\_1498 _1499 _1500-> (u (u (u parser_reply_error _1498) _1499) _1500)); (1,f) -> u f (\_1501 _1502 _1503-> (let _1504 = (u (u fm_parser_name1 _1501) _1502) in (case _1504 of {(0,f) -> u f (\_1505 _1506 _1507-> (u (u (u parser_reply_error _1505) _1506) _1507)); (1,f) -> u f (\_1508 _1509 _1510-> (let _1511 = (u (u (u fm_parser_text "=") _1508) _1509) in (case _1511 of {(0,f) -> u f (\_1512 _1513 _1514-> (u (u (u parser_reply_error _1512) _1513) _1514)); (1,f) -> u f (\_1515 _1516 _1517-> (let _1518 = (u (u fm_parser_term _1515) _1516) in (case _1518 of {(0,f) -> u f (\_1519 _1520 _1521-> (u (u (u parser_reply_error _1519) _1520) _1521)); (1,f) -> u f (\_1522 _1523 _1524-> (let _1525 = (u (u (u parser_maybe (u fm_parser_text ";")) _1522) _1523) in (case _1525 of {(0,f) -> u f (\_1526 _1527 _1528-> (u (u (u parser_reply_error _1526) _1527) _1528)); (1,f) -> u f (\_1529 _1530 _1531-> (let _1532 = (u (u fm_parser_term _1529) _1530) in (case _1532 of {(0,f) -> u f (\_1533 _1534 _1535-> (u (u (u parser_reply_error _1533) _1534) _1535)); (1,f) -> u f (\_1536 _1537 _1538-> (let _1539 = (u (u (u fm_parser_stop _1440) _1536) _1537) in (case _1539 of {(0,f) -> u f (\_1540 _1541 _1542-> (u (u (u parser_reply_error _1540) _1541) _1542)); (1,f) -> u f (\_1543 _1544 _1545-> (let _term_51=(u fm_term_ref "U32.for") in (let _term_52=(u (u fm_term_app _term_51) (u fm_term_hol bits_e)) in (let _term_53=(u (u fm_term_app _term_52) (u fm_term_ref _1510)) in (let _term_54=(u (u fm_term_app _term_53) _1482) in (let _term_55=(u (u fm_term_app _term_54) _1496) in (let _lamb_56=(u (u fm_term_lam _1454) (\_e_56-> (u (u fm_term_lam _1510) (\_s_57-> _1524)))) in (let _term_57=(u (u fm_term_app _term_55) _lamb_56) in (let _term_58=(u (u (u fm_term_let _1510) _term_57) (\_x_58-> _1538)) in (u (u (u parser_reply_value _1543) _1544) (u (u fm_term_ori _1545) _term_58))))))))))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))))
fm_parser_forin = (\_idx_1-> (\_code_2-> (let _1546 = (u (u fm_parser_init _idx_1) _code_2) in (case _1546 of {(0,f) -> u f (\_1547 _1548 _1549-> (u (u (u parser_reply_error _1547) _1548) _1549)); (1,f) -> u f (\_1550 _1551 _1552-> (let _1553 = (u (u (u fm_parser_text "for ") _1550) _1551) in (case _1553 of {(0,f) -> u f (\_1554 _1555 _1556-> (u (u (u parser_reply_error _1554) _1555) _1556)); (1,f) -> u f (\_1557 _1558 _1559-> (let _1560 = (u (u fm_parser_name1 _1557) _1558) in (case _1560 of {(0,f) -> u f (\_1561 _1562 _1563-> (u (u (u parser_reply_error _1561) _1562) _1563)); (1,f) -> u f (\_1564 _1565 _1566-> (let _1567 = (u (u (u fm_parser_text "in") _1564) _1565) in (case _1567 of {(0,f) -> u f (\_1568 _1569 _1570-> (u (u (u parser_reply_error _1568) _1569) _1570)); (1,f) -> u f (\_1571 _1572 _1573-> (let _1574 = (u (u fm_parser_term _1571) _1572) in (case _1574 of {(0,f) -> u f (\_1575 _1576 _1577-> (u (u (u parser_reply_error _1575) _1576) _1577)); (1,f) -> u f (\_1578 _1579 _1580-> (let _1581 = (u (u (u fm_parser_text "with") _1578) _1579) in (case _1581 of {(0,f) -> u f (\_1582 _1583 _1584-> (u (u (u parser_reply_error _1582) _1583) _1584)); (1,f) -> u f (\_1585 _1586 _1587-> (let _1588 = (u (u fm_parser_name1 _1585) _1586) in (case _1588 of {(0,f) -> u f (\_1589 _1590 _1591-> (u (u (u parser_reply_error _1589) _1590) _1591)); (1,f) -> u f (\_1592 _1593 _1594-> (let _1595 = (u (u (u fm_parser_text ":") _1592) _1593) in (case _1595 of {(0,f) -> u f (\_1596 _1597 _1598-> (u (u (u parser_reply_error _1596) _1597) _1598)); (1,f) -> u f (\_1599 _1600 _1601-> (let _1602 = (u (u fm_parser_term _1599) _1600) in (case _1602 of {(0,f) -> u f (\_1603 _1604 _1605-> (u (u (u parser_reply_error _1603) _1604) _1605)); (1,f) -> u f (\_1606 _1607 _1608-> (let _1609 = (u (u (u fm_parser_stop _1552) _1606) _1607) in (case _1609 of {(0,f) -> u f (\_1610 _1611 _1612-> (u (u (u parser_reply_error _1610) _1611) _1612)); (1,f) -> u f (\_1613 _1614 _1615-> (let _term_33=(u fm_term_ref "List.for") in (let _term_34=(u (u fm_term_app _term_33) (u fm_term_hol bits_e)) in (let _term_35=(u (u fm_term_app _term_34) _1580) in (let _term_36=(u (u fm_term_app _term_35) (u fm_term_hol bits_e)) in (let _term_37=(u (u fm_term_app _term_36) (u fm_term_ref _1594)) in (let _lamb_38=(u (u fm_term_lam _1566) (\_i_38-> (u (u fm_term_lam _1594) (\_x_39-> _1608)))) in (let _term_39=(u (u fm_term_app _term_37) _lamb_38) in (let _term_40=(u (u (u fm_term_let _1594) _term_39) (\_x_40-> (u fm_term_ref _1594))) in (u (u (u parser_reply_value _1613) _1614) (u (u fm_term_ori _1615) _term_40))))))))))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))))
fm_parser_forin_2 = (\_idx_1-> (\_code_2-> (let _1616 = (u (u fm_parser_init _idx_1) _code_2) in (case _1616 of {(0,f) -> u f (\_1617 _1618 _1619-> (u (u (u parser_reply_error _1617) _1618) _1619)); (1,f) -> u f (\_1620 _1621 _1622-> (let _1623 = (u (u (u fm_parser_text "for ") _1620) _1621) in (case _1623 of {(0,f) -> u f (\_1624 _1625 _1626-> (u (u (u parser_reply_error _1624) _1625) _1626)); (1,f) -> u f (\_1627 _1628 _1629-> (let _1630 = (u (u fm_parser_name1 _1627) _1628) in (case _1630 of {(0,f) -> u f (\_1631 _1632 _1633-> (u (u (u parser_reply_error _1631) _1632) _1633)); (1,f) -> u f (\_1634 _1635 _1636-> (let _1637 = (u (u (u fm_parser_text "in") _1634) _1635) in (case _1637 of {(0,f) -> u f (\_1638 _1639 _1640-> (u (u (u parser_reply_error _1638) _1639) _1640)); (1,f) -> u f (\_1641 _1642 _1643-> (let _1644 = (u (u fm_parser_term _1641) _1642) in (case _1644 of {(0,f) -> u f (\_1645 _1646 _1647-> (u (u (u parser_reply_error _1645) _1646) _1647)); (1,f) -> u f (\_1648 _1649 _1650-> (let _1651 = (u (u (u fm_parser_text ":") _1648) _1649) in (case _1651 of {(0,f) -> u f (\_1652 _1653 _1654-> (u (u (u parser_reply_error _1652) _1653) _1654)); (1,f) -> u f (\_1655 _1656 _1657-> (let _1658 = (u (u fm_parser_name1 _1655) _1656) in (case _1658 of {(0,f) -> u f (\_1659 _1660 _1661-> (u (u (u parser_reply_error _1659) _1660) _1661)); (1,f) -> u f (\_1662 _1663 _1664-> (let _1665 = (u (u (u fm_parser_text "=") _1662) _1663) in (case _1665 of {(0,f) -> u f (\_1666 _1667 _1668-> (u (u (u parser_reply_error _1666) _1667) _1668)); (1,f) -> u f (\_1669 _1670 _1671-> (let _1672 = (u (u fm_parser_term _1669) _1670) in (case _1672 of {(0,f) -> u f (\_1673 _1674 _1675-> (u (u (u parser_reply_error _1673) _1674) _1675)); (1,f) -> u f (\_1676 _1677 _1678-> (let _1679 = (u (u (u parser_maybe (u fm_parser_text ";")) _1676) _1677) in (case _1679 of {(0,f) -> u f (\_1680 _1681 _1682-> (u (u (u parser_reply_error _1680) _1681) _1682)); (1,f) -> u f (\_1683 _1684 _1685-> (let _1686 = (u (u fm_parser_term _1683) _1684) in (case _1686 of {(0,f) -> u f (\_1687 _1688 _1689-> (u (u (u parser_reply_error _1687) _1688) _1689)); (1,f) -> u f (\_1690 _1691 _1692-> (let _1693 = (u (u (u fm_parser_stop _1622) _1690) _1691) in (case _1693 of {(0,f) -> u f (\_1694 _1695 _1696-> (u (u (u parser_reply_error _1694) _1695) _1696)); (1,f) -> u f (\_1697 _1698 _1699-> (let _term_39=(u fm_term_ref "List.for") in (let _term_40=(u (u fm_term_app _term_39) (u fm_term_hol bits_e)) in (let _term_41=(u (u fm_term_app _term_40) _1650) in (let _term_42=(u (u fm_term_app _term_41) (u fm_term_hol bits_e)) in (let _term_43=(u (u fm_term_app _term_42) (u fm_term_ref _1664)) in (let _lamb_44=(u (u fm_term_lam _1636) (\_i_44-> (u (u fm_term_lam _1664) (\_x_45-> _1678)))) in (let _term_45=(u (u fm_term_app _term_43) _lamb_44) in (let _term_46=(u (u (u fm_term_let _1664) _term_45) (\_x_46-> _1692)) in (u (u (u parser_reply_value _1697) _1698) (u (u fm_term_ori _1699) _term_46))))))))))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))))
fm_parser_do_statements = (\_monad_name_1-> (u parser_first_of (u (u list_cons (\_idx_2-> (\_code_3-> (let _1700 = (u (u fm_parser_init _idx_2) _code_3) in (case _1700 of {(0,f) -> u f (\_1701 _1702 _1703-> (u (u (u parser_reply_error _1701) _1702) _1703)); (1,f) -> u f (\_1704 _1705 _1706-> (let _1707 = (u (u (u fm_parser_text "var ") _1704) _1705) in (case _1707 of {(0,f) -> u f (\_1708 _1709 _1710-> (u (u (u parser_reply_error _1708) _1709) _1710)); (1,f) -> u f (\_1711 _1712 _1713-> (let _1714 = (u (u fm_parser_name1 _1711) _1712) in (case _1714 of {(0,f) -> u f (\_1715 _1716 _1717-> (u (u (u parser_reply_error _1715) _1716) _1717)); (1,f) -> u f (\_1718 _1719 _1720-> (let _1721 = (u (u (u fm_parser_text "=") _1718) _1719) in (case _1721 of {(0,f) -> u f (\_1722 _1723 _1724-> (u (u (u parser_reply_error _1722) _1723) _1724)); (1,f) -> u f (\_1725 _1726 _1727-> (let _1728 = (u (u fm_parser_term _1725) _1726) in (case _1728 of {(0,f) -> u f (\_1729 _1730 _1731-> (u (u (u parser_reply_error _1729) _1730) _1731)); (1,f) -> u f (\_1732 _1733 _1734-> (let _1735 = (u (u (u parser_maybe (u fm_parser_text ";")) _1732) _1733) in (case _1735 of {(0,f) -> u f (\_1736 _1737 _1738-> (u (u (u parser_reply_error _1736) _1737) _1738)); (1,f) -> u f (\_1739 _1740 _1741-> (let _1742 = (u (u (u fm_parser_do_statements _monad_name_1) _1739) _1740) in (case _1742 of {(0,f) -> u f (\_1743 _1744 _1745-> (u (u (u parser_reply_error _1743) _1744) _1745)); (1,f) -> u f (\_1746 _1747 _1748-> (let _1749 = (u (u (u fm_parser_stop _1706) _1746) _1747) in (case _1749 of {(0,f) -> u f (\_1750 _1751 _1752-> (u (u (u parser_reply_error _1750) _1751) _1752)); (1,f) -> u f (\_1753 _1754 _1755-> (let _term_28=(u (u fm_term_app (u fm_term_ref "Monad.bind")) (u fm_term_ref _monad_name_1)) in (let _term_29=(u (u fm_term_app _term_28) (u fm_term_ref (((_monad_name_1::String) ++ ".monad")))) in (let _term_30=(u (u fm_term_app _term_29) (u fm_term_hol bits_e)) in (let _term_31=(u (u fm_term_app _term_30) (u fm_term_hol bits_e)) in (let _term_32=(u (u fm_term_app _term_31) _1734) in (let _term_33=(u (u fm_term_app _term_32) (u (u fm_term_lam _1720) (\_x_33-> _1748))) in (u (u (u parser_reply_value _1753) _1754) (u (u fm_term_ori _1755) _term_33))))))))); }))); }))); }))); }))); }))); }))); }))); }))))) (u (u list_cons (\_idx_2-> (\_code_3-> (let _1756 = (u (u fm_parser_init _idx_2) _code_3) in (case _1756 of {(0,f) -> u f (\_1757 _1758 _1759-> (u (u (u parser_reply_error _1757) _1758) _1759)); (1,f) -> u f (\_1760 _1761 _1762-> (let _1763 = (u (u (u fm_parser_text "let ") _1760) _1761) in (case _1763 of {(0,f) -> u f (\_1764 _1765 _1766-> (u (u (u parser_reply_error _1764) _1765) _1766)); (1,f) -> u f (\_1767 _1768 _1769-> (let _1770 = (u (u fm_parser_name1 _1767) _1768) in (case _1770 of {(0,f) -> u f (\_1771 _1772 _1773-> (u (u (u parser_reply_error _1771) _1772) _1773)); (1,f) -> u f (\_1774 _1775 _1776-> (let _1777 = (u (u (u fm_parser_text "=") _1774) _1775) in (case _1777 of {(0,f) -> u f (\_1778 _1779 _1780-> (u (u (u parser_reply_error _1778) _1779) _1780)); (1,f) -> u f (\_1781 _1782 _1783-> (let _1784 = (u (u fm_parser_term _1781) _1782) in (case _1784 of {(0,f) -> u f (\_1785 _1786 _1787-> (u (u (u parser_reply_error _1785) _1786) _1787)); (1,f) -> u f (\_1788 _1789 _1790-> (let _1791 = (u (u (u parser_maybe (u fm_parser_text ";")) _1788) _1789) in (case _1791 of {(0,f) -> u f (\_1792 _1793 _1794-> (u (u (u parser_reply_error _1792) _1793) _1794)); (1,f) -> u f (\_1795 _1796 _1797-> (let _1798 = (u (u (u fm_parser_do_statements _monad_name_1) _1795) _1796) in (case _1798 of {(0,f) -> u f (\_1799 _1800 _1801-> (u (u (u parser_reply_error _1799) _1800) _1801)); (1,f) -> u f (\_1802 _1803 _1804-> (let _1805 = (u (u (u fm_parser_stop _1762) _1802) _1803) in (case _1805 of {(0,f) -> u f (\_1806 _1807 _1808-> (u (u (u parser_reply_error _1806) _1807) _1808)); (1,f) -> u f (\_1809 _1810 _1811-> (u (u (u parser_reply_value _1809) _1810) (u (u fm_term_ori _1811) (u (u (u fm_term_let _1776) _1790) (\_x_28-> _1804))))); }))); }))); }))); }))); }))); }))); }))); }))))) (u (u list_cons (\_idx_2-> (\_code_3-> (let _1812 = (u (u fm_parser_init _idx_2) _code_3) in (case _1812 of {(0,f) -> u f (\_1813 _1814 _1815-> (u (u (u parser_reply_error _1813) _1814) _1815)); (1,f) -> u f (\_1816 _1817 _1818-> (let _1819 = (u (u (u fm_parser_text "return ") _1816) _1817) in (case _1819 of {(0,f) -> u f (\_1820 _1821 _1822-> (u (u (u parser_reply_error _1820) _1821) _1822)); (1,f) -> u f (\_1823 _1824 _1825-> (let _1826 = (u (u fm_parser_term _1823) _1824) in (case _1826 of {(0,f) -> u f (\_1827 _1828 _1829-> (u (u (u parser_reply_error _1827) _1828) _1829)); (1,f) -> u f (\_1830 _1831 _1832-> (let _1833 = (u (u (u parser_maybe (u fm_parser_text ";")) _1830) _1831) in (case _1833 of {(0,f) -> u f (\_1834 _1835 _1836-> (u (u (u parser_reply_error _1834) _1835) _1836)); (1,f) -> u f (\_1837 _1838 _1839-> (let _1840 = (u (u (u fm_parser_stop _1818) _1837) _1838) in (case _1840 of {(0,f) -> u f (\_1841 _1842 _1843-> (u (u (u parser_reply_error _1841) _1842) _1843)); (1,f) -> u f (\_1844 _1845 _1846-> (let _term_19=(u (u fm_term_app (u fm_term_ref "Monad.pure")) (u fm_term_ref _monad_name_1)) in (let _term_20=(u (u fm_term_app _term_19) (u fm_term_ref (((_monad_name_1::String) ++ ".monad")))) in (let _term_21=(u (u fm_term_app _term_20) (u fm_term_hol bits_e)) in (let _term_22=(u (u fm_term_app _term_21) _1832) in (u (u (u parser_reply_value _1844) _1845) (u (u fm_term_ori _1846) _term_22))))))); }))); }))); }))); }))); }))))) (u (u list_cons (\_idx_2-> (\_code_3-> (let _1847 = (u (u fm_parser_init _idx_2) _code_3) in (case _1847 of {(0,f) -> u f (\_1848 _1849 _1850-> (u (u (u parser_reply_error _1848) _1849) _1850)); (1,f) -> u f (\_1851 _1852 _1853-> (let _1854 = (u (u fm_parser_term _1851) _1852) in (case _1854 of {(0,f) -> u f (\_1855 _1856 _1857-> (u (u (u parser_reply_error _1855) _1856) _1857)); (1,f) -> u f (\_1858 _1859 _1860-> (let _1861 = (u (u (u parser_maybe (u fm_parser_text ";")) _1858) _1859) in (case _1861 of {(0,f) -> u f (\_1862 _1863 _1864-> (u (u (u parser_reply_error _1862) _1863) _1864)); (1,f) -> u f (\_1865 _1866 _1867-> (let _1868 = (u (u (u fm_parser_do_statements _monad_name_1) _1865) _1866) in (case _1868 of {(0,f) -> u f (\_1869 _1870 _1871-> (u (u (u parser_reply_error _1869) _1870) _1871)); (1,f) -> u f (\_1872 _1873 _1874-> (let _1875 = (u (u (u fm_parser_stop _1853) _1872) _1873) in (case _1875 of {(0,f) -> u f (\_1876 _1877 _1878-> (u (u (u parser_reply_error _1876) _1877) _1878)); (1,f) -> u f (\_1879 _1880 _1881-> (let _term_19=(u (u fm_term_app (u fm_term_ref "Monad.bind")) (u fm_term_ref _monad_name_1)) in (let _term_20=(u (u fm_term_app _term_19) (u fm_term_ref (((_monad_name_1::String) ++ ".monad")))) in (let _term_21=(u (u fm_term_app _term_20) (u fm_term_hol bits_e)) in (let _term_22=(u (u fm_term_app _term_21) (u fm_term_hol bits_e)) in (let _term_23=(u (u fm_term_app _term_22) _1860) in (let _term_24=(u (u fm_term_app _term_23) (u (u fm_term_lam "") (\_x_24-> _1874))) in (u (u (u parser_reply_value _1879) _1880) (u (u fm_term_ori _1881) _term_24))))))))); }))); }))); }))); }))); }))))) (u (u list_cons (\_idx_2-> (\_code_3-> (let _1882 = (u (u fm_parser_term _idx_2) _code_3) in (case _1882 of {(0,f) -> u f (\_1883 _1884 _1885-> (u (u (u parser_reply_error _1883) _1884) _1885)); (1,f) -> u f (\_1886 _1887 _1888-> (let _1889 = (u (u (u parser_maybe (u fm_parser_text ";")) _1886) _1887) in (case _1889 of {(0,f) -> u f (\_1890 _1891 _1892-> (u (u (u parser_reply_error _1890) _1891) _1892)); (1,f) -> u f (\_1893 _1894 _1895-> (u (u (u parser_reply_value _1893) _1894) _1888)); }))); }))))) list_nil)))))))
fm_parser_do = (\_idx_1-> (\_code_2-> (let _1896 = (u (u (u fm_parser_text "do ") _idx_1) _code_2) in (case _1896 of {(0,f) -> u f (\_1897 _1898 _1899-> (u (u (u parser_reply_error _1897) _1898) _1899)); (1,f) -> u f (\_1900 _1901 _1902-> (let _1903 = (u (u fm_parser_name1 _1900) _1901) in (case _1903 of {(0,f) -> u f (\_1904 _1905 _1906-> (u (u (u parser_reply_error _1904) _1905) _1906)); (1,f) -> u f (\_1907 _1908 _1909-> (let _1910 = (u (u (u fm_parser_text "{") _1907) _1908) in (case _1910 of {(0,f) -> u f (\_1911 _1912 _1913-> (u (u (u parser_reply_error _1911) _1912) _1913)); (1,f) -> u f (\_1914 _1915 _1916-> (let _1917 = (u (u (u fm_parser_do_statements _1909) _1914) _1915) in (case _1917 of {(0,f) -> u f (\_1918 _1919 _1920-> (u (u (u parser_reply_error _1918) _1919) _1920)); (1,f) -> u f (\_1921 _1922 _1923-> (let _1924 = (u (u (u fm_parser_text "}") _1921) _1922) in (case _1924 of {(0,f) -> u f (\_1925 _1926 _1927-> (u (u (u parser_reply_error _1925) _1926) _1927)); (1,f) -> u f (\_1928 _1929 _1930-> (u (u (u parser_reply_value _1928) _1929) _1923)); }))); }))); }))); }))); }))))
fm_term_nat = (\_natx_1-> (11,\t-> t _natx_1))
fm_term_unroll_nat = (\_natx_1-> (let _1931 = _natx_1 in (if _1931==0 then (u fm_term_ref (u fm_name_read "Nat.zero")) else (let _func_3=(u fm_term_ref (u fm_name_read "Nat.succ")) in (let _argm_4=(u fm_term_nat (_1931-1)) in (u (u fm_term_app _func_3) _argm_4))))))
u16_to_bits = (\_a_1-> (let _1932 = _a_1 in (u word_to_bits (u16_to_word _1932))))
fm_term_unroll_chr_bits = (\_bits_1-> (let _1933 = _bits_1 in (case _1933 of {(0,f) -> u f ((u fm_term_ref (u fm_name_read "Bits.e"))); (1,f) -> u f (\_1934-> (u (u fm_term_app (u fm_term_ref (u fm_name_read "Bits.o"))) (u fm_term_unroll_chr_bits _1934))); (2,f) -> u f (\_1935-> (u (u fm_term_app (u fm_term_ref (u fm_name_read "Bits.i"))) (u fm_term_unroll_chr_bits _1935))); })))
fm_term_unroll_chr = (\_chrx_1-> (let _bits_2=(u u16_to_bits _chrx_1) in (let _term_3=(u fm_term_ref (u fm_name_read "Word.from_bits")) in (let _term_4=(u (u fm_term_app _term_3) (u fm_term_nat 16)) in (let _term_5=(u (u fm_term_app _term_4) (u fm_term_unroll_chr_bits _bits_2)) in (let _term_6=(u (u fm_term_app (u fm_term_ref (u fm_name_read "U16.new"))) _term_5) in _term_6))))))
fm_term_unroll_str = (\_strx_1-> (let _1936 = _strx_1 in (if null (_1936::String) then (u fm_term_ref (u fm_name_read "String.nil")) else (let _char_4=(u fm_term_chr (fromIntegral (fromEnum (head _1936 :: Char)) :: Word16)) in (let _term_5=(u fm_term_ref (u fm_name_read "String.cons")) in (let _term_6=(u (u fm_term_app _term_5) _char_4) in (let _term_7=(u (u fm_term_app _term_6) (u fm_term_str (tail _1936))) in _term_7)))))))
fm_term_reduce = (\_term_1-> (\_defs_2-> (let _1937 = _term_1 in (case _1937 of {(0,f) -> u f (\_1938 _1939-> _term_1); (1,f) -> u f (\_1940-> (let _1941 = (u (u fm_get _1940) _defs_2) in (case _1941 of {(0,f) -> u f ((u fm_term_ref _1940)); (1,f) -> u f (\_1942-> (let _1943 = _1942 in (case _1943 of {(0,f) -> u f (\_1944 _1945 _1946 _1947 _1948 _1949 _1950 _1951-> (u (u fm_term_reduce _1948) _defs_2)); }))); }))); (2,f) -> u f (_term_1); (3,f) -> u f (\_1952 _1953 _1954 _1955 _1956-> _term_1); (4,f) -> u f (\_1957 _1958-> _term_1); (5,f) -> u f (\_1959 _1960-> (let _func_5=(u (u fm_term_reduce _1959) _defs_2) in (let _1961 = _func_5 in (case _1961 of {(0,f) -> u f (\_1962 _1963-> _term_1); (1,f) -> u f (\_1964-> _term_1); (2,f) -> u f (_term_1); (3,f) -> u f (\_1965 _1966 _1967 _1968 _1969-> _term_1); (4,f) -> u f (\_1970 _1971-> (u (u fm_term_reduce (u _1971 _1960)) _defs_2)); (5,f) -> u f (\_1972 _1973-> _term_1); (6,f) -> u f (\_1974 _1975 _1976-> _term_1); (7,f) -> u f (\_1977 _1978 _1979-> _term_1); (8,f) -> u f (\_1980 _1981 _1982-> _term_1); (9,f) -> u f (\_1983 _1984 _1985-> _term_1); (10,f) -> u f (\_1986-> _term_1); (11,f) -> u f (\_1987-> _term_1); (12,f) -> u f (\_1988-> _term_1); (13,f) -> u f (\_1989-> _term_1); (14,f) -> u f (\_1990 _1991 _1992 _1993 _1994 _1995-> _term_1); (15,f) -> u f (\_1996 _1997-> _term_1); })))); (6,f) -> u f (\_1998 _1999 _2000-> (u (u fm_term_reduce (u _2000 _1999)) _defs_2)); (7,f) -> u f (\_2001 _2002 _2003-> (u (u fm_term_reduce (u _2003 _2002)) _defs_2)); (8,f) -> u f (\_2004 _2005 _2006-> (u (u fm_term_reduce _2005) _defs_2)); (9,f) -> u f (\_2007 _2008 _2009-> _term_1); (10,f) -> u f (\_2010-> _term_1); (11,f) -> u f (\_2011-> (u (u fm_term_reduce (u fm_term_unroll_nat _2011)) _defs_2)); (12,f) -> u f (\_2012-> (u (u fm_term_reduce (u fm_term_unroll_chr _2012)) _defs_2)); (13,f) -> u f (\_2013-> (u (u fm_term_reduce (u fm_term_unroll_str _2013)) _defs_2)); (14,f) -> u f (\_2014 _2015 _2016 _2017 _2018 _2019-> _term_1); (15,f) -> u f (\_2020 _2021-> (u (u fm_term_reduce _2021) _defs_2)); }))))
map_new = (0,\t-> t)
fm_def_new = (\_file_1-> (\_code_2-> (\_orig_3-> (\_name_4-> (\_term_5-> (\_type_6-> (\_isct_7-> (\_stat_8-> (0,\t-> t _file_1 _code_2 _orig_3 _name_4 _term_5 _type_6 _isct_7 _stat_8)))))))))
fm_status_init = (0,\t-> t)
fm_parser_case_with = (\_idx_1-> (\_code_2-> (let _2022 = (u (u (u fm_parser_text "with") _idx_1) _code_2) in (case _2022 of {(0,f) -> u f (\_2023 _2024 _2025-> (u (u (u parser_reply_error _2023) _2024) _2025)); (1,f) -> u f (\_2026 _2027 _2028-> (let _2029 = (u (u fm_parser_name1 _2026) _2027) in (case _2029 of {(0,f) -> u f (\_2030 _2031 _2032-> (u (u (u parser_reply_error _2030) _2031) _2032)); (1,f) -> u f (\_2033 _2034 _2035-> (let _2036 = (u (u (u fm_parser_text ":") _2033) _2034) in (case _2036 of {(0,f) -> u f (\_2037 _2038 _2039-> (u (u (u parser_reply_error _2037) _2038) _2039)); (1,f) -> u f (\_2040 _2041 _2042-> (let _2043 = (u (u fm_parser_term _2040) _2041) in (case _2043 of {(0,f) -> u f (\_2044 _2045 _2046-> (u (u (u parser_reply_error _2044) _2045) _2046)); (1,f) -> u f (\_2047 _2048 _2049-> (let _2050 = (u (u (u fm_parser_text "=") _2047) _2048) in (case _2050 of {(0,f) -> u f (\_2051 _2052 _2053-> (u (u (u parser_reply_error _2051) _2052) _2053)); (1,f) -> u f (\_2054 _2055 _2056-> (let _2057 = (u (u fm_parser_term _2054) _2055) in (case _2057 of {(0,f) -> u f (\_2058 _2059 _2060-> (u (u (u parser_reply_error _2058) _2059) _2060)); (1,f) -> u f (\_2061 _2062 _2063-> (u (u (u parser_reply_value _2061) _2062) (u (u (u (u (u (u (u (u fm_def_new "") "") (u (u pair_new 0) 0)) _2035) _2063) _2049) bool_false) fm_status_init))); }))); }))); }))); }))); }))); }))))
fm_parser_case_case = (\_idx_1-> (\_code_2-> (let _2064 = (u (u fm_parser_name1 _idx_1) _code_2) in (case _2064 of {(0,f) -> u f (\_2065 _2066 _2067-> (u (u (u parser_reply_error _2065) _2066) _2067)); (1,f) -> u f (\_2068 _2069 _2070-> (let _2071 = (u (u (u fm_parser_text ":") _2068) _2069) in (case _2071 of {(0,f) -> u f (\_2072 _2073 _2074-> (u (u (u parser_reply_error _2072) _2073) _2074)); (1,f) -> u f (\_2075 _2076 _2077-> (let _2078 = (u (u fm_parser_term _2075) _2076) in (case _2078 of {(0,f) -> u f (\_2079 _2080 _2081-> (u (u (u parser_reply_error _2079) _2080) _2081)); (1,f) -> u f (\_2082 _2083 _2084-> (let _2085 = (u (u (u parser_maybe (u fm_parser_text ",")) _2082) _2083) in (case _2085 of {(0,f) -> u f (\_2086 _2087 _2088-> (u (u (u parser_reply_error _2086) _2087) _2088)); (1,f) -> u f (\_2089 _2090 _2091-> (u (u (u parser_reply_value _2089) _2090) (u (u pair_new _2070) _2084))); }))); }))); }))); }))))
map_tie = (\_val_2-> (\_lft_3-> (\_rgt_4-> (1,\t-> t _val_2 _lft_3 _rgt_4))))
map_set = (\_bits_2-> (\_val_3-> (\_map_4-> (let _2092 = _bits_2 in (case _2092 of {(0,f) -> u f ((let _2093 = _map_4 in (case _2093 of {(0,f) -> u f ((u (u (u map_tie (u maybe_some _val_3)) map_new) map_new)); (1,f) -> u f (\_2094 _2095 _2096-> (u (u (u map_tie (u maybe_some _val_3)) _2095) _2096)); }))); (1,f) -> u f (\_2097-> (let _2098 = _map_4 in (case _2098 of {(0,f) -> u f ((u (u (u map_tie maybe_none) (u (u (u map_set _2097) _val_3) map_new)) map_new)); (1,f) -> u f (\_2099 _2100 _2101-> (u (u (u map_tie _2099) (u (u (u map_set _2097) _val_3) _2100)) _2101)); }))); (2,f) -> u f (\_2102-> (let _2103 = _map_4 in (case _2103 of {(0,f) -> u f ((u (u (u map_tie maybe_none) map_new) (u (u (u map_set _2102) _val_3) map_new))); (1,f) -> u f (\_2104 _2105 _2106-> (u (u (u map_tie _2104) _2105) (u (u (u map_set _2102) _val_3) _2106))); }))); })))))
map_from_list = (\_xs_2-> (let _2107 = _xs_2 in (case _2107 of {(0,f) -> u f (map_new); (1,f) -> u f (\_2108 _2109-> (let _2110 = _2108 in (case _2110 of {(0,f) -> u f (\_2111 _2112-> (u (u (u map_set _2111) _2112) (u map_from_list _2109))); }))); })))
pair_fst = (\_pair_3-> (let _2113 = _pair_3 in (case _2113 of {(0,f) -> u f (\_2114 _2115-> _2114); })))
pair_snd = (\_pair_3-> (let _2116 = _pair_3 in (case _2116 of {(0,f) -> u f (\_2117 _2118-> _2118); })))
fm_term_cse = (\_path_1-> (\_expr_2-> (\_name_3-> (\_with_4-> (\_cses_5-> (\_moti_6-> (14,\t-> t _path_1 _expr_2 _name_3 _with_4 _cses_5 _moti_6)))))))
fm_parser_case = (\_idx_1-> (\_code_2-> (let _2119 = (u (u fm_parser_init _idx_1) _code_2) in (case _2119 of {(0,f) -> u f (\_2120 _2121 _2122-> (u (u (u parser_reply_error _2120) _2121) _2122)); (1,f) -> u f (\_2123 _2124 _2125-> (let _2126 = (u (u (u fm_parser_text "case ") _2123) _2124) in (case _2126 of {(0,f) -> u f (\_2127 _2128 _2129-> (u (u (u parser_reply_error _2127) _2128) _2129)); (1,f) -> u f (\_2130 _2131 _2132-> (let _2133 = (u (u fm_parser_spaces _2130) _2131) in (case _2133 of {(0,f) -> u f (\_2134 _2135 _2136-> (u (u (u parser_reply_error _2134) _2135) _2136)); (1,f) -> u f (\_2137 _2138 _2139-> (let _2140 = (u (u fm_parser_term _2137) _2138) in (case _2140 of {(0,f) -> u f (\_2141 _2142 _2143-> (u (u (u parser_reply_error _2141) _2142) _2143)); (1,f) -> u f (\_2144 _2145 _2146-> (let _2147 = (u (u (u parser_maybe (\_idx_15-> (\_code_16-> (let _2148 = (u (u (u fm_parser_text "as") _idx_15) _code_16) in (case _2148 of {(0,f) -> u f (\_2149 _2150 _2151-> (u (u (u parser_reply_error _2149) _2150) _2151)); (1,f) -> u f (\_2152 _2153 _2154-> (u (u fm_parser_name1 _2152) _2153)); }))))) _2144) _2145) in (case _2147 of {(0,f) -> u f (\_2155 _2156 _2157-> (u (u (u parser_reply_error _2155) _2156) _2157)); (1,f) -> u f (\_2158 _2159 _2160-> (let _name_18=(let _2161 = _2160 in (case _2161 of {(0,f) -> u f ((let _2162 = (u (u fm_term_reduce _2146) map_new) in (case _2162 of {(0,f) -> u f (\_2163 _2164-> _2163); (1,f) -> u f (\_2165-> _2165); (2,f) -> u f ((u fm_name_read "self")); (3,f) -> u f (\_2166 _2167 _2168 _2169 _2170-> (u fm_name_read "self")); (4,f) -> u f (\_2171 _2172-> (u fm_name_read "self")); (5,f) -> u f (\_2173 _2174-> (u fm_name_read "self")); (6,f) -> u f (\_2175 _2176 _2177-> (u fm_name_read "self")); (7,f) -> u f (\_2178 _2179 _2180-> (u fm_name_read "self")); (8,f) -> u f (\_2181 _2182 _2183-> (u fm_name_read "self")); (9,f) -> u f (\_2184 _2185 _2186-> (u fm_name_read "self")); (10,f) -> u f (\_2187-> (u fm_name_read "self")); (11,f) -> u f (\_2188-> (u fm_name_read "self")); (12,f) -> u f (\_2189-> (u fm_name_read "self")); (13,f) -> u f (\_2190-> (u fm_name_read "self")); (14,f) -> u f (\_2191 _2192 _2193 _2194 _2195 _2196-> (u fm_name_read "self")); (15,f) -> u f (\_2197 _2198-> (u fm_name_read "self")); }))); (1,f) -> u f (\_2199-> _2199); })) in (let _2200 = (u (u (u parser_many fm_parser_case_with) _2158) _2159) in (case _2200 of {(0,f) -> u f (\_2201 _2202 _2203-> (u (u (u parser_reply_error _2201) _2202) _2203)); (1,f) -> u f (\_2204 _2205 _2206-> (let _2207 = (u (u (u fm_parser_text "{") _2204) _2205) in (case _2207 of {(0,f) -> u f (\_2208 _2209 _2210-> (u (u (u parser_reply_error _2208) _2209) _2210)); (1,f) -> u f (\_2211 _2212 _2213-> (let _2214 = (u (u (u (u parser_until (u fm_parser_text "}")) fm_parser_case_case) _2211) _2212) in (case _2214 of {(0,f) -> u f (\_2215 _2216 _2217-> (u (u (u parser_reply_error _2215) _2216) _2217)); (1,f) -> u f (\_2218 _2219 _2220-> (let _cses_28=(u map_from_list (u (u list_mapped _2220) (\_x_28-> (u (u pair_new (u fm_name_to_bits (u pair_fst _x_28))) (u pair_snd _x_28))))) in (let _2221 = (u (u (u parser_first_of (u (u list_cons (\_idx_29-> (\_code_30-> (let _2222 = (u (u (u fm_parser_text ":") _idx_29) _code_30) in (case _2222 of {(0,f) -> u f (\_2223 _2224 _2225-> (u (u (u parser_reply_error _2223) _2224) _2225)); (1,f) -> u f (\_2226 _2227 _2228-> (let _2229 = (u (u fm_parser_term _2226) _2227) in (case _2229 of {(0,f) -> u f (\_2230 _2231 _2232-> (u (u (u parser_reply_error _2230) _2231) _2232)); (1,f) -> u f (\_2233 _2234 _2235-> (u (u (u parser_reply_value _2233) _2234) (u maybe_some _2235))); }))); }))))) (u (u list_cons (\_idx_29-> (\_code_30-> (let _2236 = (u (u (u fm_parser_text "!") _idx_29) _code_30) in (case _2236 of {(0,f) -> u f (\_2237 _2238 _2239-> (u (u (u parser_reply_error _2237) _2238) _2239)); (1,f) -> u f (\_2240 _2241 _2242-> (u (u (u parser_reply_value _2240) _2241) maybe_none)); }))))) (u (u list_cons (\_idx_29-> (\_code_30-> (u (u (u parser_reply_value _idx_29) _code_30) (u maybe_some (u fm_term_hol bits_e)))))) list_nil)))) _2218) _2219) in (case _2221 of {(0,f) -> u f (\_2243 _2244 _2245-> (u (u (u parser_reply_error _2243) _2244) _2245)); (1,f) -> u f (\_2246 _2247 _2248-> (let _2249 = (u (u (u fm_parser_stop _2125) _2246) _2247) in (case _2249 of {(0,f) -> u f (\_2250 _2251 _2252-> (u (u (u parser_reply_error _2250) _2251) _2252)); (1,f) -> u f (\_2253 _2254 _2255-> (u (u (u parser_reply_value _2253) _2254) (u (u fm_term_ori _2255) (u (u (u (u (u (u fm_term_cse bits_e) _2146) _name_18) _2206) _cses_28) _2248)))); }))); })))); }))); }))); })))); }))); }))); }))); }))); }))))
fm_set = (\_name_2-> (\_val_3-> (\_map_4-> (u (u (u map_set (u fm_name_to_bits _name_2)) _val_3) _map_4))))
fm_parser_open = (\_idx_1-> (\_code_2-> (let _2256 = (u (u fm_parser_init _idx_1) _code_2) in (case _2256 of {(0,f) -> u f (\_2257 _2258 _2259-> (u (u (u parser_reply_error _2257) _2258) _2259)); (1,f) -> u f (\_2260 _2261 _2262-> (let _2263 = (u (u (u fm_parser_text "open ") _2260) _2261) in (case _2263 of {(0,f) -> u f (\_2264 _2265 _2266-> (u (u (u parser_reply_error _2264) _2265) _2266)); (1,f) -> u f (\_2267 _2268 _2269-> (let _2270 = (u (u fm_parser_spaces _2267) _2268) in (case _2270 of {(0,f) -> u f (\_2271 _2272 _2273-> (u (u (u parser_reply_error _2271) _2272) _2273)); (1,f) -> u f (\_2274 _2275 _2276-> (let _2277 = (u (u fm_parser_term _2274) _2275) in (case _2277 of {(0,f) -> u f (\_2278 _2279 _2280-> (u (u (u parser_reply_error _2278) _2279) _2280)); (1,f) -> u f (\_2281 _2282 _2283-> (let _2284 = (u (u (u parser_maybe (\_idx_15-> (\_code_16-> (let _2285 = (u (u (u fm_parser_text "as") _idx_15) _code_16) in (case _2285 of {(0,f) -> u f (\_2286 _2287 _2288-> (u (u (u parser_reply_error _2286) _2287) _2288)); (1,f) -> u f (\_2289 _2290 _2291-> (u (u fm_parser_name1 _2289) _2290)); }))))) _2281) _2282) in (case _2284 of {(0,f) -> u f (\_2292 _2293 _2294-> (u (u (u parser_reply_error _2292) _2293) _2294)); (1,f) -> u f (\_2295 _2296 _2297-> (let _2298 = (u (u (u parser_maybe (u fm_parser_text ";")) _2295) _2296) in (case _2298 of {(0,f) -> u f (\_2299 _2300 _2301-> (u (u (u parser_reply_error _2299) _2300) _2301)); (1,f) -> u f (\_2302 _2303 _2304-> (let _name_21=(let _2305 = _2297 in (case _2305 of {(0,f) -> u f ((let _2306 = (u (u fm_term_reduce _2283) map_new) in (case _2306 of {(0,f) -> u f (\_2307 _2308-> _2307); (1,f) -> u f (\_2309-> _2309); (2,f) -> u f ((u fm_name_read "self")); (3,f) -> u f (\_2310 _2311 _2312 _2313 _2314-> (u fm_name_read "self")); (4,f) -> u f (\_2315 _2316-> (u fm_name_read "self")); (5,f) -> u f (\_2317 _2318-> (u fm_name_read "self")); (6,f) -> u f (\_2319 _2320 _2321-> (u fm_name_read "self")); (7,f) -> u f (\_2322 _2323 _2324-> (u fm_name_read "self")); (8,f) -> u f (\_2325 _2326 _2327-> (u fm_name_read "self")); (9,f) -> u f (\_2328 _2329 _2330-> (u fm_name_read "self")); (10,f) -> u f (\_2331-> (u fm_name_read "self")); (11,f) -> u f (\_2332-> (u fm_name_read "self")); (12,f) -> u f (\_2333-> (u fm_name_read "self")); (13,f) -> u f (\_2334-> (u fm_name_read "self")); (14,f) -> u f (\_2335 _2336 _2337 _2338 _2339 _2340-> (u fm_name_read "self")); (15,f) -> u f (\_2341 _2342-> (u fm_name_read "self")); }))); (1,f) -> u f (\_2343-> _2343); })) in (let _wyth_22=list_nil in (let _2344 = (u (u fm_parser_term _2302) _2303) in (case _2344 of {(0,f) -> u f (\_2345 _2346 _2347-> (u (u (u parser_reply_error _2345) _2346) _2347)); (1,f) -> u f (\_2348 _2349 _2350-> (let _cses_26=(u (u (u fm_set "_") _2350) map_new) in (let _moti_27=(u maybe_some (u fm_term_hol bits_e)) in (let _2351 = (u (u (u fm_parser_stop _2262) _2348) _2349) in (case _2351 of {(0,f) -> u f (\_2352 _2353 _2354-> (u (u (u parser_reply_error _2352) _2353) _2354)); (1,f) -> u f (\_2355 _2356 _2357-> (u (u (u parser_reply_value _2355) _2356) (u (u fm_term_ori _2357) (u (u (u (u (u (u fm_term_cse bits_e) _2283) _name_21) _wyth_22) _cses_26) _moti_27)))); }))))); }))))); }))); }))); }))); }))); }))); }))))
parser_digit = (\_idx_1-> (\_code_2-> (let _2358 = _code_2 in (if null (_2358::String) then (u (u (u parser_reply_error _idx_1) _code_2) "Not a digit.") else (let _sidx_5=(u nat_succ _idx_1) in (let _2359 = ((((fromIntegral (fromEnum (head _2358 :: Char)) :: Word16)::Word16) == 48)) in (if _2359 then (u (u (u parser_reply_value _sidx_5) (tail _2358)) 0) else (let _2360 = ((((fromIntegral (fromEnum (head _2358 :: Char)) :: Word16)::Word16) == 49)) in (if _2360 then (u (u (u parser_reply_value _sidx_5) (tail _2358)) 1) else (let _2361 = ((((fromIntegral (fromEnum (head _2358 :: Char)) :: Word16)::Word16) == 50)) in (if _2361 then (u (u (u parser_reply_value _sidx_5) (tail _2358)) 2) else (let _2362 = ((((fromIntegral (fromEnum (head _2358 :: Char)) :: Word16)::Word16) == 51)) in (if _2362 then (u (u (u parser_reply_value _sidx_5) (tail _2358)) 3) else (let _2363 = ((((fromIntegral (fromEnum (head _2358 :: Char)) :: Word16)::Word16) == 52)) in (if _2363 then (u (u (u parser_reply_value _sidx_5) (tail _2358)) 4) else (let _2364 = ((((fromIntegral (fromEnum (head _2358 :: Char)) :: Word16)::Word16) == 53)) in (if _2364 then (u (u (u parser_reply_value _sidx_5) (tail _2358)) 5) else (let _2365 = ((((fromIntegral (fromEnum (head _2358 :: Char)) :: Word16)::Word16) == 54)) in (if _2365 then (u (u (u parser_reply_value _sidx_5) (tail _2358)) 6) else (let _2366 = ((((fromIntegral (fromEnum (head _2358 :: Char)) :: Word16)::Word16) == 55)) in (if _2366 then (u (u (u parser_reply_value _sidx_5) (tail _2358)) 7) else (let _2367 = ((((fromIntegral (fromEnum (head _2358 :: Char)) :: Word16)::Word16) == 56)) in (if _2367 then (u (u (u parser_reply_value _sidx_5) (tail _2358)) 8) else (let _2368 = ((((fromIntegral (fromEnum (head _2358 :: Char)) :: Word16)::Word16) == 57)) in (if _2368 then (u (u (u parser_reply_value _sidx_5) (tail _2358)) 9) else (u (u (u parser_reply_error _idx_1) _code_2) "Not a digit."))))))))))))))))))))))))))
nat_add = (\a0-> \a1-> ((a0::Integer) + a1))
nat_mul = (\a0-> \a1-> ((a0::Integer) * a1))
nat_from_base_go = (\_b_1-> (\_ds_2-> (\_p_3-> (\_res_4-> (let _2369 = _ds_2 in (case _2369 of {(0,f) -> u f (_res_4); (1,f) -> u f (\_2370 _2371-> (u (u (u (u nat_from_base_go _b_1) _2371) (((_b_1::Integer) * _p_3))) ((((((_2370::Integer) * _p_3))::Integer) + _res_4)))); }))))))
list_reverse_go = (\_xs_2-> (\_res_3-> (let _2372 = _xs_2 in (case _2372 of {(0,f) -> u f (_res_3); (1,f) -> u f (\_2373 _2374-> (u (u list_reverse_go _2374) (u (u list_cons _2373) _res_3))); }))))
list_reverse = (\_xs_2-> (u (u list_reverse_go _xs_2) list_nil))
nat_from_base = (\_base_1-> (\_ds_2-> (u (u (u (u nat_from_base_go _base_1) (u list_reverse _ds_2)) 1) 0)))
parser_nat = (\_idx_1-> (\_code_2-> (let _2375 = (u (u (u parser_many1 parser_digit) _idx_1) _code_2) in (case _2375 of {(0,f) -> u f (\_2376 _2377 _2378-> (u (u (u parser_reply_error _2376) _2377) _2378)); (1,f) -> u f (\_2379 _2380 _2381-> (u (u (u parser_reply_value _2379) _2380) (u (u nat_from_base 10) _2381))); }))))
bits_tail = (\_a_1-> (let _2382 = _a_1 in (case _2382 of {(0,f) -> u f (bits_e); (1,f) -> u f (\_2383-> _2383); (2,f) -> u f (\_2384-> _2384); })))
bits_inc = (\_a_1-> (let _2385 = _a_1 in (case _2385 of {(0,f) -> u f ((u bits_i bits_e)); (1,f) -> u f (\_2386-> (u bits_i _2386)); (2,f) -> u f (\_2387-> (u bits_o (u bits_inc _2387))); })))
nat_to_bits = (\_n_1-> (let _2388 = _n_1 in (if _2388==0 then bits_e else (u bits_inc (u nat_to_bits (_2388-1))))))
maybe_to_bool = (\_m_2-> (let _2389 = _m_2 in (case _2389 of {(0,f) -> u f (bool_false); (1,f) -> u f (\_2390-> bool_true); })))
fm_term_gol = (\_name_1-> (\_dref_2-> (\_verb_3-> (9,\t-> t _name_1 _dref_2 _verb_3))))
fm_parser_goal = (\_idx_1-> (\_code_2-> (let _2391 = (u (u fm_parser_init _idx_1) _code_2) in (case _2391 of {(0,f) -> u f (\_2392 _2393 _2394-> (u (u (u parser_reply_error _2392) _2393) _2394)); (1,f) -> u f (\_2395 _2396 _2397-> (let _2398 = (u (u (u fm_parser_text "?") _2395) _2396) in (case _2398 of {(0,f) -> u f (\_2399 _2400 _2401-> (u (u (u parser_reply_error _2399) _2400) _2401)); (1,f) -> u f (\_2402 _2403 _2404-> (let _2405 = (u (u fm_parser_name _2402) _2403) in (case _2405 of {(0,f) -> u f (\_2406 _2407 _2408-> (u (u (u parser_reply_error _2406) _2407) _2408)); (1,f) -> u f (\_2409 _2410 _2411-> (let _2412 = (u (u (u parser_many (\_idx_12-> (\_code_13-> (let _2413 = (u (u (u fm_parser_text "-") _idx_12) _code_13) in (case _2413 of {(0,f) -> u f (\_2414 _2415 _2416-> (u (u (u parser_reply_error _2414) _2415) _2416)); (1,f) -> u f (\_2417 _2418 _2419-> (let _2420 = (u (u parser_nat _2417) _2418) in (case _2420 of {(0,f) -> u f (\_2421 _2422 _2423-> (u (u (u parser_reply_error _2421) _2422) _2423)); (1,f) -> u f (\_2424 _2425 _2426-> (let _bits_20=(u bits_reverse (u bits_tail (u bits_reverse (u nat_to_bits _2426)))) in (u (u (u parser_reply_value _2424) _2425) _bits_20))); }))); }))))) _2409) _2410) in (case _2412 of {(0,f) -> u f (\_2427 _2428 _2429-> (u (u (u parser_reply_error _2427) _2428) _2429)); (1,f) -> u f (\_2430 _2431 _2432-> (let _2433 = (let _2434 = (u (u (u parser_maybe (u parser_text "-")) _2430) _2431) in (case _2434 of {(0,f) -> u f (\_2435 _2436 _2437-> (u (u (u parser_reply_error _2435) _2436) _2437)); (1,f) -> u f (\_2438 _2439 _2440-> (u (u (u parser_reply_value _2438) _2439) (u maybe_to_bool _2440))); })) in (case _2433 of {(0,f) -> u f (\_2441 _2442 _2443-> (u (u (u parser_reply_error _2441) _2442) _2443)); (1,f) -> u f (\_2444 _2445 _2446-> (let _2447 = (u (u (u fm_parser_stop _2397) _2444) _2445) in (case _2447 of {(0,f) -> u f (\_2448 _2449 _2450-> (u (u (u parser_reply_error _2448) _2449) _2450)); (1,f) -> u f (\_2451 _2452 _2453-> (u (u (u parser_reply_value _2451) _2452) (u (u fm_term_ori _2453) (u (u (u fm_term_gol _2411) _2432) _2446)))); }))); }))); }))); }))); }))); }))))
fm_parser_hole = (\_idx_1-> (\_code_2-> (let _2454 = (u (u fm_parser_init _idx_1) _code_2) in (case _2454 of {(0,f) -> u f (\_2455 _2456 _2457-> (u (u (u parser_reply_error _2455) _2456) _2457)); (1,f) -> u f (\_2458 _2459 _2460-> (let _2461 = (u (u (u fm_parser_text "_") _2458) _2459) in (case _2461 of {(0,f) -> u f (\_2462 _2463 _2464-> (u (u (u parser_reply_error _2462) _2463) _2464)); (1,f) -> u f (\_2465 _2466 _2467-> (let _2468 = (u (u (u fm_parser_stop _2460) _2465) _2466) in (case _2468 of {(0,f) -> u f (\_2469 _2470 _2471-> (u (u (u parser_reply_error _2469) _2470) _2471)); (1,f) -> u f (\_2472 _2473 _2474-> (u (u (u parser_reply_value _2472) _2473) (u (u fm_term_ori _2474) (u fm_term_hol bits_e)))); }))); }))); }))))
fm_parser_u8 = (\_idx_1-> (\_code_2-> (let _2475 = (u (u fm_parser_init _idx_1) _code_2) in (case _2475 of {(0,f) -> u f (\_2476 _2477 _2478-> (u (u (u parser_reply_error _2476) _2477) _2478)); (1,f) -> u f (\_2479 _2480 _2481-> (let _2482 = (u (u fm_parser_spaces _2479) _2480) in (case _2482 of {(0,f) -> u f (\_2483 _2484 _2485-> (u (u (u parser_reply_error _2483) _2484) _2485)); (1,f) -> u f (\_2486 _2487 _2488-> (let _2489 = (u (u parser_nat _2486) _2487) in (case _2489 of {(0,f) -> u f (\_2490 _2491 _2492-> (u (u (u parser_reply_error _2490) _2491) _2492)); (1,f) -> u f (\_2493 _2494 _2495-> (let _2496 = (u (u (u parser_text "b") _2493) _2494) in (case _2496 of {(0,f) -> u f (\_2497 _2498 _2499-> (u (u (u parser_reply_error _2497) _2498) _2499)); (1,f) -> u f (\_2500 _2501 _2502-> (let _term_15=(u fm_term_ref "Nat.to_u8") in (let _term_16=(u (u fm_term_app _term_15) (u fm_term_nat _2495)) in (let _2503 = (u (u (u fm_parser_stop _2481) _2500) _2501) in (case _2503 of {(0,f) -> u f (\_2504 _2505 _2506-> (u (u (u parser_reply_error _2504) _2505) _2506)); (1,f) -> u f (\_2507 _2508 _2509-> (u (u (u parser_reply_value _2507) _2508) (u (u fm_term_ori _2509) _term_16))); }))))); }))); }))); }))); }))))
fm_parser_u16 = (\_idx_1-> (\_code_2-> (let _2510 = (u (u fm_parser_init _idx_1) _code_2) in (case _2510 of {(0,f) -> u f (\_2511 _2512 _2513-> (u (u (u parser_reply_error _2511) _2512) _2513)); (1,f) -> u f (\_2514 _2515 _2516-> (let _2517 = (u (u fm_parser_spaces _2514) _2515) in (case _2517 of {(0,f) -> u f (\_2518 _2519 _2520-> (u (u (u parser_reply_error _2518) _2519) _2520)); (1,f) -> u f (\_2521 _2522 _2523-> (let _2524 = (u (u parser_nat _2521) _2522) in (case _2524 of {(0,f) -> u f (\_2525 _2526 _2527-> (u (u (u parser_reply_error _2525) _2526) _2527)); (1,f) -> u f (\_2528 _2529 _2530-> (let _2531 = (u (u (u parser_text "s") _2528) _2529) in (case _2531 of {(0,f) -> u f (\_2532 _2533 _2534-> (u (u (u parser_reply_error _2532) _2533) _2534)); (1,f) -> u f (\_2535 _2536 _2537-> (let _term_15=(u fm_term_ref "Nat.to_u16") in (let _term_16=(u (u fm_term_app _term_15) (u fm_term_nat _2530)) in (let _2538 = (u (u (u fm_parser_stop _2516) _2535) _2536) in (case _2538 of {(0,f) -> u f (\_2539 _2540 _2541-> (u (u (u parser_reply_error _2539) _2540) _2541)); (1,f) -> u f (\_2542 _2543 _2544-> (u (u (u parser_reply_value _2542) _2543) (u (u fm_term_ori _2544) _term_16))); }))))); }))); }))); }))); }))))
fm_parser_u32 = (\_idx_1-> (\_code_2-> (let _2545 = (u (u fm_parser_init _idx_1) _code_2) in (case _2545 of {(0,f) -> u f (\_2546 _2547 _2548-> (u (u (u parser_reply_error _2546) _2547) _2548)); (1,f) -> u f (\_2549 _2550 _2551-> (let _2552 = (u (u fm_parser_spaces _2549) _2550) in (case _2552 of {(0,f) -> u f (\_2553 _2554 _2555-> (u (u (u parser_reply_error _2553) _2554) _2555)); (1,f) -> u f (\_2556 _2557 _2558-> (let _2559 = (u (u parser_nat _2556) _2557) in (case _2559 of {(0,f) -> u f (\_2560 _2561 _2562-> (u (u (u parser_reply_error _2560) _2561) _2562)); (1,f) -> u f (\_2563 _2564 _2565-> (let _2566 = (u (u (u parser_text "u") _2563) _2564) in (case _2566 of {(0,f) -> u f (\_2567 _2568 _2569-> (u (u (u parser_reply_error _2567) _2568) _2569)); (1,f) -> u f (\_2570 _2571 _2572-> (let _term_15=(u fm_term_ref "Nat.to_u32") in (let _term_16=(u (u fm_term_app _term_15) (u fm_term_nat _2565)) in (let _2573 = (u (u (u fm_parser_stop _2551) _2570) _2571) in (case _2573 of {(0,f) -> u f (\_2574 _2575 _2576-> (u (u (u parser_reply_error _2574) _2575) _2576)); (1,f) -> u f (\_2577 _2578 _2579-> (u (u (u parser_reply_value _2577) _2578) (u (u fm_term_ori _2579) _term_16))); }))))); }))); }))); }))); }))))
fm_parser_u64 = (\_idx_1-> (\_code_2-> (let _2580 = (u (u fm_parser_init _idx_1) _code_2) in (case _2580 of {(0,f) -> u f (\_2581 _2582 _2583-> (u (u (u parser_reply_error _2581) _2582) _2583)); (1,f) -> u f (\_2584 _2585 _2586-> (let _2587 = (u (u fm_parser_spaces _2584) _2585) in (case _2587 of {(0,f) -> u f (\_2588 _2589 _2590-> (u (u (u parser_reply_error _2588) _2589) _2590)); (1,f) -> u f (\_2591 _2592 _2593-> (let _2594 = (u (u parser_nat _2591) _2592) in (case _2594 of {(0,f) -> u f (\_2595 _2596 _2597-> (u (u (u parser_reply_error _2595) _2596) _2597)); (1,f) -> u f (\_2598 _2599 _2600-> (let _2601 = (u (u (u parser_text "l") _2598) _2599) in (case _2601 of {(0,f) -> u f (\_2602 _2603 _2604-> (u (u (u parser_reply_error _2602) _2603) _2604)); (1,f) -> u f (\_2605 _2606 _2607-> (let _term_15=(u fm_term_ref "Nat.to_u64") in (let _term_16=(u (u fm_term_app _term_15) (u fm_term_nat _2600)) in (let _2608 = (u (u (u fm_parser_stop _2586) _2605) _2606) in (case _2608 of {(0,f) -> u f (\_2609 _2610 _2611-> (u (u (u parser_reply_error _2609) _2610) _2611)); (1,f) -> u f (\_2612 _2613 _2614-> (u (u (u parser_reply_value _2612) _2613) (u (u fm_term_ori _2614) _term_16))); }))))); }))); }))); }))); }))))
fm_parser_nat = (\_idx_1-> (\_code_2-> (let _2615 = (u (u fm_parser_init _idx_1) _code_2) in (case _2615 of {(0,f) -> u f (\_2616 _2617 _2618-> (u (u (u parser_reply_error _2616) _2617) _2618)); (1,f) -> u f (\_2619 _2620 _2621-> (let _2622 = (u (u fm_parser_spaces _2619) _2620) in (case _2622 of {(0,f) -> u f (\_2623 _2624 _2625-> (u (u (u parser_reply_error _2623) _2624) _2625)); (1,f) -> u f (\_2626 _2627 _2628-> (let _2629 = (u (u parser_nat _2626) _2627) in (case _2629 of {(0,f) -> u f (\_2630 _2631 _2632-> (u (u (u parser_reply_error _2630) _2631) _2632)); (1,f) -> u f (\_2633 _2634 _2635-> (let _2636 = (u (u (u fm_parser_stop _2621) _2633) _2634) in (case _2636 of {(0,f) -> u f (\_2637 _2638 _2639-> (u (u (u parser_reply_error _2637) _2638) _2639)); (1,f) -> u f (\_2640 _2641 _2642-> (u (u (u parser_reply_value _2640) _2641) (u (u fm_term_ori _2642) (u fm_term_nat _2635)))); }))); }))); }))); }))))
string_eql = (\a0-> \a1-> ((a0::String) == a1))
parser_fail = (\_error_2-> (\_idx_3-> (\_code_4-> (u (u (u parser_reply_error _idx_3) _code_4) _error_2))))
fm_parser_reference = (\_idx_1-> (\_code_2-> (let _2643 = (u (u fm_parser_init _idx_1) _code_2) in (case _2643 of {(0,f) -> u f (\_2644 _2645 _2646-> (u (u (u parser_reply_error _2644) _2645) _2646)); (1,f) -> u f (\_2647 _2648 _2649-> (let _2650 = (u (u fm_parser_name1 _2647) _2648) in (case _2650 of {(0,f) -> u f (\_2651 _2652 _2653-> (u (u (u parser_reply_error _2651) _2652) _2653)); (1,f) -> u f (\_2654 _2655 _2656-> (let _2657 = (((_2656::String) == "case")) in (if _2657 then (u parser_fail "Reserved keyword.") else (let _2658 = (((_2656::String) == "do")) in (if _2658 then (u parser_fail "Reserved keyword.") else (let _2659 = (((_2656::String) == "if")) in (if _2659 then (u parser_fail "Reserved keyword.") else (let _2660 = (((_2656::String) == "with")) in (if _2660 then (u parser_fail "Reserved keyword.") else (let _2661 = (((_2656::String) == "let")) in (if _2661 then (u parser_fail "Reserved keyword.") else (let _2662 = (((_2656::String) == "def")) in (if _2662 then (u parser_fail "Reserved keyword.") else (let _2663 = (((_2656::String) == "true")) in (if _2663 then (\_idx_9-> (\_code_10-> (u (u (u parser_reply_value _idx_9) _code_10) (u fm_term_ref "Bool.true")))) else (let _2664 = (((_2656::String) == "false")) in (if _2664 then (\_idx_9-> (\_code_10-> (u (u (u parser_reply_value _idx_9) _code_10) (u fm_term_ref "Bool.false")))) else (let _2665 = (((_2656::String) == "unit")) in (if _2665 then (\_idx_9-> (\_code_10-> (u (u (u parser_reply_value _idx_9) _code_10) (u fm_term_ref "Unit.new")))) else (let _2666 = (((_2656::String) == "none")) in (if _2666 then (let _term_9=(u fm_term_ref "Maybe.none") in (let _term_10=(u (u fm_term_app _term_9) (u fm_term_hol bits_e)) in (\_idx_11-> (\_code_12-> (u (u (u parser_reply_value _idx_11) _code_12) _term_10))))) else (let _2667 = (((_2656::String) == "refl")) in (if _2667 then (let _term_9=(u fm_term_ref "Equal.refl") in (let _term_10=(u (u fm_term_app _term_9) (u fm_term_hol bits_e)) in (let _term_11=(u (u fm_term_app _term_10) (u fm_term_hol bits_e)) in (\_idx_12-> (\_code_13-> (u (u (u parser_reply_value _idx_12) _code_13) _term_11)))))) else (\_idx_9-> (\_code_10-> (let _2668 = (u (u (u fm_parser_stop _2649) _idx_9) _code_10) in (case _2668 of {(0,f) -> u f (\_2669 _2670 _2671-> (u (u (u parser_reply_error _2669) _2670) _2671)); (1,f) -> u f (\_2672 _2673 _2674-> (u (u (u parser_reply_value _2672) _2673) (u (u fm_term_ori _2674) (u fm_term_ref _2656)))); })))))))))))))))))))))))))) _2654 _2655); }))); }))))
list_for = (\_xs_2-> (\_b_4-> (\_f_5-> (let _2675 = _xs_2 in (case _2675 of {(0,f) -> u f (_b_4); (1,f) -> u f (\_2676 _2677-> (u (u (u list_for _2677) (u (u _f_5 _2676) _b_4)) _f_5)); })))))
fm_parser_application = (\_init_1-> (\_func_2-> (\_idx_3-> (\_code_4-> (let _2678 = (u (u (u parser_text "(") _idx_3) _code_4) in (case _2678 of {(0,f) -> u f (\_2679 _2680 _2681-> (u (u (u parser_reply_error _2679) _2680) _2681)); (1,f) -> u f (\_2682 _2683 _2684-> (let _2685 = (u (u (u (u parser_until1 (u fm_parser_text ")")) (u fm_parser_item fm_parser_term)) _2682) _2683) in (case _2685 of {(0,f) -> u f (\_2686 _2687 _2688-> (u (u (u parser_reply_error _2686) _2687) _2688)); (1,f) -> u f (\_2689 _2690 _2691-> (let _2692 = (u (u (u fm_parser_stop _init_1) _2689) _2690) in (case _2692 of {(0,f) -> u f (\_2693 _2694 _2695-> (u (u (u parser_reply_error _2693) _2694) _2695)); (1,f) -> u f (\_2696 _2697 _2698-> (let _expr_14=(u (u (u list_for _2691) _func_2) (\_x_14-> (\_f_15-> (u (u fm_term_app _f_15) _x_14)))) in (u (u (u parser_reply_value _2696) _2697) (u (u fm_term_ori _2698) _expr_14)))); }))); }))); }))))))
parser_spaces = (u parser_many (u parser_first_of (u (u list_cons (u parser_text " ")) (u (u list_cons (u parser_text "\n")) list_nil))))
parser_spaces_text = (\_text_1-> (\_idx_2-> (\_code_3-> (let _2699 = (u (u parser_spaces _idx_2) _code_3) in (case _2699 of {(0,f) -> u f (\_2700 _2701 _2702-> (u (u (u parser_reply_error _2700) _2701) _2702)); (1,f) -> u f (\_2703 _2704 _2705-> (u (u (u parser_text _text_1) _2703) _2704)); })))))
fm_parser_application_erased = (\_init_1-> (\_func_2-> (\_idx_3-> (\_code_4-> (let _2706 = (u (u parser_get_index _idx_3) _code_4) in (case _2706 of {(0,f) -> u f (\_2707 _2708 _2709-> (u (u (u parser_reply_error _2707) _2708) _2709)); (1,f) -> u f (\_2710 _2711 _2712-> (let _2713 = (u (u (u parser_text "<") _2710) _2711) in (case _2713 of {(0,f) -> u f (\_2714 _2715 _2716-> (u (u (u parser_reply_error _2714) _2715) _2716)); (1,f) -> u f (\_2717 _2718 _2719-> (let _2720 = (u (u (u (u parser_until1 (u parser_spaces_text ">")) (u fm_parser_item fm_parser_term)) _2717) _2718) in (case _2720 of {(0,f) -> u f (\_2721 _2722 _2723-> (u (u (u parser_reply_error _2721) _2722) _2723)); (1,f) -> u f (\_2724 _2725 _2726-> (let _2727 = (u (u (u fm_parser_stop _2712) _2724) _2725) in (case _2727 of {(0,f) -> u f (\_2728 _2729 _2730-> (u (u (u parser_reply_error _2728) _2729) _2730)); (1,f) -> u f (\_2731 _2732 _2733-> (let _expr_17=(u (u (u list_for _2726) _func_2) (\_x_17-> (\_f_18-> (u (u fm_term_app _f_18) _x_17)))) in (u (u (u parser_reply_value _2731) _2732) (u (u fm_term_ori _2733) _expr_17)))); }))); }))); }))); }))))))
fm_parser_arrow = (\_init_1-> (\_xtyp_2-> (\_idx_3-> (\_code_4-> (let _2734 = (u (u (u fm_parser_text "->") _idx_3) _code_4) in (case _2734 of {(0,f) -> u f (\_2735 _2736 _2737-> (u (u (u parser_reply_error _2735) _2736) _2737)); (1,f) -> u f (\_2738 _2739 _2740-> (let _2741 = (u (u fm_parser_term _2738) _2739) in (case _2741 of {(0,f) -> u f (\_2742 _2743 _2744-> (u (u (u parser_reply_error _2742) _2743) _2744)); (1,f) -> u f (\_2745 _2746 _2747-> (let _2748 = (u (u (u fm_parser_stop _init_1) _2745) _2746) in (case _2748 of {(0,f) -> u f (\_2749 _2750 _2751-> (u (u (u parser_reply_error _2749) _2750) _2751)); (1,f) -> u f (\_2752 _2753 _2754-> (u (u (u parser_reply_value _2752) _2753) (u (u fm_term_ori _2754) (u (u (u (u (u fm_term_all bool_false) "") "") _xtyp_2) (\_s_14-> (\_x_15-> _2747)))))); }))); }))); }))))))
fm_parser_op = (\_sym_1-> (\_ref_2-> (\_init_3-> (\_val0_4-> (\_idx_5-> (\_code_6-> (let _2755 = (u (u (u fm_parser_text _sym_1) _idx_5) _code_6) in (case _2755 of {(0,f) -> u f (\_2756 _2757 _2758-> (u (u (u parser_reply_error _2756) _2757) _2758)); (1,f) -> u f (\_2759 _2760 _2761-> (let _2762 = (u (u fm_parser_term _2759) _2760) in (case _2762 of {(0,f) -> u f (\_2763 _2764 _2765-> (u (u (u parser_reply_error _2763) _2764) _2765)); (1,f) -> u f (\_2766 _2767 _2768-> (let _2769 = (u (u (u fm_parser_stop _init_3) _2766) _2767) in (case _2769 of {(0,f) -> u f (\_2770 _2771 _2772-> (u (u (u parser_reply_error _2770) _2771) _2772)); (1,f) -> u f (\_2773 _2774 _2775-> (let _term_16=(u fm_term_ref _ref_2) in (let _term_17=(u (u fm_term_app _term_16) _val0_4) in (let _term_18=(u (u fm_term_app _term_17) _2768) in (u (u (u parser_reply_value _2773) _2774) (u (u fm_term_ori _2775) _term_18)))))); }))); }))); }))))))))
fm_parser_add = (u (u fm_parser_op "+") "Nat.add")
fm_parser_sub = (u (u fm_parser_op "+") "Nat.add")
fm_parser_mul = (u (u fm_parser_op "*") "Nat.mul")
fm_parser_div = (u (u fm_parser_op "/") "Nat.div")
fm_parser_mod = (u (u fm_parser_op "%") "Nat.mod")
fm_parser_cons = (\_init_1-> (\_head_2-> (\_idx_3-> (\_code_4-> (let _2776 = (u (u (u fm_parser_text "&") _idx_3) _code_4) in (case _2776 of {(0,f) -> u f (\_2777 _2778 _2779-> (u (u (u parser_reply_error _2777) _2778) _2779)); (1,f) -> u f (\_2780 _2781 _2782-> (let _2783 = (u (u fm_parser_term _2780) _2781) in (case _2783 of {(0,f) -> u f (\_2784 _2785 _2786-> (u (u (u parser_reply_error _2784) _2785) _2786)); (1,f) -> u f (\_2787 _2788 _2789-> (let _2790 = (u (u (u fm_parser_stop _init_1) _2787) _2788) in (case _2790 of {(0,f) -> u f (\_2791 _2792 _2793-> (u (u (u parser_reply_error _2791) _2792) _2793)); (1,f) -> u f (\_2794 _2795 _2796-> (let _term_14=(u fm_term_ref "List.cons") in (let _term_15=(u (u fm_term_app _term_14) (u fm_term_hol bits_e)) in (let _term_16=(u (u fm_term_app _term_15) _head_2) in (let _term_17=(u (u fm_term_app _term_16) _2789) in (let _2797 = (u (u (u fm_parser_stop _init_1) _2794) _2795) in (case _2797 of {(0,f) -> u f (\_2798 _2799 _2800-> (u (u (u parser_reply_error _2798) _2799) _2800)); (1,f) -> u f (\_2801 _2802 _2803-> (u (u (u parser_reply_value _2801) _2802) (u (u fm_term_ori _2803) _term_17))); }))))))); }))); }))); }))))))
fm_parser_concat = (\_init_1-> (\_lst0_2-> (\_idx_3-> (\_code_4-> (let _2804 = (u (u (u fm_parser_text "++") _idx_3) _code_4) in (case _2804 of {(0,f) -> u f (\_2805 _2806 _2807-> (u (u (u parser_reply_error _2805) _2806) _2807)); (1,f) -> u f (\_2808 _2809 _2810-> (let _2811 = (u (u fm_parser_term _2808) _2809) in (case _2811 of {(0,f) -> u f (\_2812 _2813 _2814-> (u (u (u parser_reply_error _2812) _2813) _2814)); (1,f) -> u f (\_2815 _2816 _2817-> (let _2818 = (u (u (u fm_parser_stop _init_1) _2815) _2816) in (case _2818 of {(0,f) -> u f (\_2819 _2820 _2821-> (u (u (u parser_reply_error _2819) _2820) _2821)); (1,f) -> u f (\_2822 _2823 _2824-> (let _term_14=(u fm_term_ref "List.concat") in (let _term_15=(u (u fm_term_app _term_14) (u fm_term_hol bits_e)) in (let _term_16=(u (u fm_term_app _term_15) _lst0_2) in (let _term_17=(u (u fm_term_app _term_16) _2817) in (let _2825 = (u (u (u fm_parser_stop _init_1) _2822) _2823) in (case _2825 of {(0,f) -> u f (\_2826 _2827 _2828-> (u (u (u parser_reply_error _2826) _2827) _2828)); (1,f) -> u f (\_2829 _2830 _2831-> (u (u (u parser_reply_value _2829) _2830) (u (u fm_term_ori _2831) _term_17))); }))))))); }))); }))); }))))))
fm_parser_string_concat = (\_init_1-> (\_str0_2-> (\_idx_3-> (\_code_4-> (let _2832 = (u (u (u fm_parser_text "|") _idx_3) _code_4) in (case _2832 of {(0,f) -> u f (\_2833 _2834 _2835-> (u (u (u parser_reply_error _2833) _2834) _2835)); (1,f) -> u f (\_2836 _2837 _2838-> (let _2839 = (u (u fm_parser_term _2836) _2837) in (case _2839 of {(0,f) -> u f (\_2840 _2841 _2842-> (u (u (u parser_reply_error _2840) _2841) _2842)); (1,f) -> u f (\_2843 _2844 _2845-> (let _2846 = (u (u (u fm_parser_stop _init_1) _2843) _2844) in (case _2846 of {(0,f) -> u f (\_2847 _2848 _2849-> (u (u (u parser_reply_error _2847) _2848) _2849)); (1,f) -> u f (\_2850 _2851 _2852-> (let _term_14=(u fm_term_ref "String.concat") in (let _term_15=(u (u fm_term_app _term_14) _str0_2) in (let _term_16=(u (u fm_term_app _term_15) _2845) in (let _2853 = (u (u (u fm_parser_stop _init_1) _2850) _2851) in (case _2853 of {(0,f) -> u f (\_2854 _2855 _2856-> (u (u (u parser_reply_error _2854) _2855) _2856)); (1,f) -> u f (\_2857 _2858 _2859-> (u (u (u parser_reply_value _2857) _2858) (u (u fm_term_ori _2859) _term_16))); })))))); }))); }))); }))))))
fm_parser_sigma = (\_init_1-> (\_val0_2-> (\_idx_3-> (\_code_4-> (let _2860 = (u (u (u fm_parser_text "~") _idx_3) _code_4) in (case _2860 of {(0,f) -> u f (\_2861 _2862 _2863-> (u (u (u parser_reply_error _2861) _2862) _2863)); (1,f) -> u f (\_2864 _2865 _2866-> (let _2867 = (u (u fm_parser_term _2864) _2865) in (case _2867 of {(0,f) -> u f (\_2868 _2869 _2870-> (u (u (u parser_reply_error _2868) _2869) _2870)); (1,f) -> u f (\_2871 _2872 _2873-> (let _2874 = (u (u (u fm_parser_stop _init_1) _2871) _2872) in (case _2874 of {(0,f) -> u f (\_2875 _2876 _2877-> (u (u (u parser_reply_error _2875) _2876) _2877)); (1,f) -> u f (\_2878 _2879 _2880-> (let _term_14=(u fm_term_ref "Sigma.new") in (let _term_15=(u (u fm_term_app _term_14) (u fm_term_hol bits_e)) in (let _term_16=(u (u fm_term_app _term_15) (u fm_term_hol bits_e)) in (let _term_17=(u (u fm_term_app _term_16) _val0_2) in (let _term_18=(u (u fm_term_app _term_17) _2873) in (u (u (u parser_reply_value _2878) _2879) (u (u fm_term_ori _2880) _term_18)))))))); }))); }))); }))))))
fm_parser_equality = (\_init_1-> (\_val0_2-> (\_idx_3-> (\_code_4-> (let _2881 = (u (u (u fm_parser_text "==") _idx_3) _code_4) in (case _2881 of {(0,f) -> u f (\_2882 _2883 _2884-> (u (u (u parser_reply_error _2882) _2883) _2884)); (1,f) -> u f (\_2885 _2886 _2887-> (let _2888 = (u (u fm_parser_term _2885) _2886) in (case _2888 of {(0,f) -> u f (\_2889 _2890 _2891-> (u (u (u parser_reply_error _2889) _2890) _2891)); (1,f) -> u f (\_2892 _2893 _2894-> (let _2895 = (u (u (u fm_parser_stop _init_1) _2892) _2893) in (case _2895 of {(0,f) -> u f (\_2896 _2897 _2898-> (u (u (u parser_reply_error _2896) _2897) _2898)); (1,f) -> u f (\_2899 _2900 _2901-> (let _term_14=(u fm_term_ref "Equal") in (let _term_15=(u (u fm_term_app _term_14) (u fm_term_hol bits_e)) in (let _term_16=(u (u fm_term_app _term_15) _val0_2) in (let _term_17=(u (u fm_term_app _term_16) _2894) in (u (u (u parser_reply_value _2899) _2900) (u (u fm_term_ori _2901) _term_17))))))); }))); }))); }))))))
fm_parser_inequality = (\_init_1-> (\_val0_2-> (\_idx_3-> (\_code_4-> (let _2902 = (u (u (u fm_parser_text "!=") _idx_3) _code_4) in (case _2902 of {(0,f) -> u f (\_2903 _2904 _2905-> (u (u (u parser_reply_error _2903) _2904) _2905)); (1,f) -> u f (\_2906 _2907 _2908-> (let _2909 = (u (u fm_parser_term _2906) _2907) in (case _2909 of {(0,f) -> u f (\_2910 _2911 _2912-> (u (u (u parser_reply_error _2910) _2911) _2912)); (1,f) -> u f (\_2913 _2914 _2915-> (let _2916 = (u (u (u fm_parser_stop _init_1) _2913) _2914) in (case _2916 of {(0,f) -> u f (\_2917 _2918 _2919-> (u (u (u parser_reply_error _2917) _2918) _2919)); (1,f) -> u f (\_2920 _2921 _2922-> (let _term_14=(u fm_term_ref "Equal") in (let _term_15=(u (u fm_term_app _term_14) (u fm_term_hol bits_e)) in (let _term_16=(u (u fm_term_app _term_15) _val0_2) in (let _term_17=(u (u fm_term_app _term_16) _2915) in (let _term_18=(u (u fm_term_app (u fm_term_ref "Not")) _term_17) in (u (u (u parser_reply_value _2920) _2921) (u (u fm_term_ori _2922) _term_18)))))))); }))); }))); }))))))
fm_parser_rewrite = (\_init_1-> (\_subt_2-> (\_idx_3-> (\_code_4-> (let _2923 = (u (u (u fm_parser_text "::") _idx_3) _code_4) in (case _2923 of {(0,f) -> u f (\_2924 _2925 _2926-> (u (u (u parser_reply_error _2924) _2925) _2926)); (1,f) -> u f (\_2927 _2928 _2929-> (let _2930 = (u (u (u fm_parser_text "rewrite") _2927) _2928) in (case _2930 of {(0,f) -> u f (\_2931 _2932 _2933-> (u (u (u parser_reply_error _2931) _2932) _2933)); (1,f) -> u f (\_2934 _2935 _2936-> (let _2937 = (u (u fm_parser_name1 _2934) _2935) in (case _2937 of {(0,f) -> u f (\_2938 _2939 _2940-> (u (u (u parser_reply_error _2938) _2939) _2940)); (1,f) -> u f (\_2941 _2942 _2943-> (let _2944 = (u (u (u fm_parser_text "in") _2941) _2942) in (case _2944 of {(0,f) -> u f (\_2945 _2946 _2947-> (u (u (u parser_reply_error _2945) _2946) _2947)); (1,f) -> u f (\_2948 _2949 _2950-> (let _2951 = (u (u fm_parser_term _2948) _2949) in (case _2951 of {(0,f) -> u f (\_2952 _2953 _2954-> (u (u (u parser_reply_error _2952) _2953) _2954)); (1,f) -> u f (\_2955 _2956 _2957-> (let _2958 = (u (u (u fm_parser_text "with") _2955) _2956) in (case _2958 of {(0,f) -> u f (\_2959 _2960 _2961-> (u (u (u parser_reply_error _2959) _2960) _2961)); (1,f) -> u f (\_2962 _2963 _2964-> (let _2965 = (u (u fm_parser_term _2962) _2963) in (case _2965 of {(0,f) -> u f (\_2966 _2967 _2968-> (u (u (u parser_reply_error _2966) _2967) _2968)); (1,f) -> u f (\_2969 _2970 _2971-> (let _2972 = (u (u (u fm_parser_stop _init_1) _2969) _2970) in (case _2972 of {(0,f) -> u f (\_2973 _2974 _2975-> (u (u (u parser_reply_error _2973) _2974) _2975)); (1,f) -> u f (\_2976 _2977 _2978-> (let _term_29=(u fm_term_ref "Equal.rewrite") in (let _term_30=(u (u fm_term_app _term_29) (u fm_term_hol bits_e)) in (let _term_31=(u (u fm_term_app _term_30) (u fm_term_hol bits_e)) in (let _term_32=(u (u fm_term_app _term_31) (u fm_term_hol bits_e)) in (let _term_33=(u (u fm_term_app _term_32) _2971) in (let _term_34=(u (u fm_term_app _term_33) (u (u fm_term_lam _2943) (\_x_34-> _2957))) in (let _term_35=(u (u fm_term_app _term_34) _subt_2) in (u (u (u parser_reply_value _2976) _2977) (u (u fm_term_ori _2978) _term_35)))))))))); }))); }))); }))); }))); }))); }))); }))); }))))))
fm_term_ann = (\_done_1-> (\_term_2-> (\_type_3-> (8,\t-> t _done_1 _term_2 _type_3))))
fm_parser_annotation = (\_init_1-> (\_term_2-> (\_idx_3-> (\_code_4-> (let _2979 = (u (u (u fm_parser_text "::") _idx_3) _code_4) in (case _2979 of {(0,f) -> u f (\_2980 _2981 _2982-> (u (u (u parser_reply_error _2980) _2981) _2982)); (1,f) -> u f (\_2983 _2984 _2985-> (let _2986 = (u (u fm_parser_term _2983) _2984) in (case _2986 of {(0,f) -> u f (\_2987 _2988 _2989-> (u (u (u parser_reply_error _2987) _2988) _2989)); (1,f) -> u f (\_2990 _2991 _2992-> (let _2993 = (u (u (u fm_parser_stop _init_1) _2990) _2991) in (case _2993 of {(0,f) -> u f (\_2994 _2995 _2996-> (u (u (u parser_reply_error _2994) _2995) _2996)); (1,f) -> u f (\_2997 _2998 _2999-> (u (u (u parser_reply_value _2997) _2998) (u (u fm_term_ori _2999) (u (u (u fm_term_ann bool_false) _term_2) _2992)))); }))); }))); }))))))
fm_parser_application_hole = (\_init_1-> (\_term_2-> (\_idx_3-> (\_code_4-> (let _3000 = (u (u (u fm_parser_text "!") _idx_3) _code_4) in (case _3000 of {(0,f) -> u f (\_3001 _3002 _3003-> (u (u (u parser_reply_error _3001) _3002) _3003)); (1,f) -> u f (\_3004 _3005 _3006-> (let _3007 = (u (u (u fm_parser_stop _init_1) _3004) _3005) in (case _3007 of {(0,f) -> u f (\_3008 _3009 _3010-> (u (u (u parser_reply_error _3008) _3009) _3010)); (1,f) -> u f (\_3011 _3012 _3013-> (u (u (u parser_reply_value _3011) _3012) (u (u fm_term_ori _3013) (u (u fm_term_app _term_2) (u fm_term_hol bits_e))))); }))); }))))))
fm_parser_suffix = (\_init_1-> (\_term_2-> (\_idx_3-> (\_code_4-> (let _suffix_parser_5=(u parser_first_of (u (u list_cons (u (u fm_parser_application _init_1) _term_2)) (u (u list_cons (u (u fm_parser_application_erased _init_1) _term_2)) (u (u list_cons (u (u fm_parser_arrow _init_1) _term_2)) (u (u list_cons (u (u fm_parser_add _init_1) _term_2)) (u (u list_cons (u (u fm_parser_sub _init_1) _term_2)) (u (u list_cons (u (u fm_parser_mul _init_1) _term_2)) (u (u list_cons (u (u fm_parser_div _init_1) _term_2)) (u (u list_cons (u (u fm_parser_mod _init_1) _term_2)) (u (u list_cons (u (u fm_parser_cons _init_1) _term_2)) (u (u list_cons (u (u fm_parser_concat _init_1) _term_2)) (u (u list_cons (u (u fm_parser_string_concat _init_1) _term_2)) (u (u list_cons (u (u fm_parser_sigma _init_1) _term_2)) (u (u list_cons (u (u fm_parser_equality _init_1) _term_2)) (u (u list_cons (u (u fm_parser_inequality _init_1) _term_2)) (u (u list_cons (u (u fm_parser_rewrite _init_1) _term_2)) (u (u list_cons (u (u fm_parser_annotation _init_1) _term_2)) (u (u list_cons (u (u fm_parser_application_hole _init_1) _term_2)) list_nil)))))))))))))))))) in (let _3014 = (u (u _suffix_parser_5 _idx_3) _code_4) in (case _3014 of {(0,f) -> u f (\_3015 _3016 _3017-> (u (u (u parser_reply_value _idx_3) _code_4) _term_2)); (1,f) -> u f (\_3018 _3019 _3020-> (u (u (u (u fm_parser_suffix _init_1) _3020) _3018) _3019)); })))))))
fm_parser_term = (\_idx_1-> (\_code_2-> (let _3021 = (u (u fm_parser_init _idx_1) _code_2) in (case _3021 of {(0,f) -> u f (\_3022 _3023 _3024-> (u (u (u parser_reply_error _3022) _3023) _3024)); (1,f) -> u f (\_3025 _3026 _3027-> (let _3028 = (u (u (u parser_first_of (u (u list_cons fm_parser_type) (u (u list_cons fm_parser_forall) (u (u list_cons fm_parser_lambda) (u (u list_cons fm_parser_lambda_erased) (u (u list_cons fm_parser_lambda_nameless) (u (u list_cons fm_parser_parenthesis) (u (u list_cons fm_parser_letforrange_u32) (u (u list_cons fm_parser_letforin) (u (u list_cons fm_parser_let) (u (u list_cons fm_parser_get) (u (u list_cons fm_parser_def) (u (u list_cons fm_parser_if) (u (u list_cons fm_parser_char) (u (u list_cons fm_parser_string) (u (u list_cons fm_parser_pair) (u (u list_cons fm_parser_sigma_type) (u (u list_cons fm_parser_some) (u (u list_cons fm_parser_apply) (u (u list_cons fm_parser_mirror) (u (u list_cons fm_parser_list) (u (u list_cons fm_parser_log) (u (u list_cons fm_parser_forrange_u32) (u (u list_cons fm_parser_forrange_u32_2) (u (u list_cons fm_parser_forin) (u (u list_cons fm_parser_forin_2) (u (u list_cons fm_parser_do) (u (u list_cons fm_parser_case) (u (u list_cons fm_parser_open) (u (u list_cons fm_parser_goal) (u (u list_cons fm_parser_hole) (u (u list_cons fm_parser_u8) (u (u list_cons fm_parser_u16) (u (u list_cons fm_parser_u32) (u (u list_cons fm_parser_u64) (u (u list_cons fm_parser_nat) (u (u list_cons fm_parser_reference) list_nil))))))))))))))))))))))))))))))))))))) _3025) _3026) in (case _3028 of {(0,f) -> u f (\_3029 _3030 _3031-> (u (u (u parser_reply_error _3029) _3030) _3031)); (1,f) -> u f (\_3032 _3033 _3034-> (u (u (u (u fm_parser_suffix _3027) _3034) _3032) _3033)); }))); }))))
fm_parser_name_term = (\_idx_1-> (\_code_2-> (let _3035 = (u (u fm_parser_name _idx_1) _code_2) in (case _3035 of {(0,f) -> u f (\_3036 _3037 _3038-> (u (u (u parser_reply_error _3036) _3037) _3038)); (1,f) -> u f (\_3039 _3040 _3041-> (let _3042 = (u (u (u fm_parser_text ":") _3039) _3040) in (case _3042 of {(0,f) -> u f (\_3043 _3044 _3045-> (u (u (u parser_reply_error _3043) _3044) _3045)); (1,f) -> u f (\_3046 _3047 _3048-> (let _3049 = (u (u fm_parser_term _3046) _3047) in (case _3049 of {(0,f) -> u f (\_3050 _3051 _3052-> (u (u (u parser_reply_error _3050) _3051) _3052)); (1,f) -> u f (\_3053 _3054 _3055-> (u (u (u parser_reply_value _3053) _3054) (u (u pair_new _3041) _3055))); }))); }))); }))))
fm_binder_new = (\_eras_1-> (\_name_2-> (\_term_3-> (0,\t-> t _eras_1 _name_2 _term_3))))
fm_parser_binder_homo = (\_eras_1-> (\_idx_2-> (\_code_3-> (let _3056 = (u (u (u fm_parser_text (let _3057 = _eras_1 in (if _3057 then "<" else "("))) _idx_2) _code_3) in (case _3056 of {(0,f) -> u f (\_3058 _3059 _3060-> (u (u (u parser_reply_error _3058) _3059) _3060)); (1,f) -> u f (\_3061 _3062 _3063-> (let _3064 = (u (u (u (u parser_until1 (u fm_parser_text (let _3065 = _eras_1 in (if _3065 then ">" else ")")))) (u fm_parser_item fm_parser_name_term)) _3061) _3062) in (case _3064 of {(0,f) -> u f (\_3066 _3067 _3068-> (u (u (u parser_reply_error _3066) _3067) _3068)); (1,f) -> u f (\_3069 _3070 _3071-> (u (u (u parser_reply_value _3069) _3070) (u (u list_mapped _3071) (\_pair_10-> (let _3072 = _pair_10 in (case _3072 of {(0,f) -> u f (\_3073 _3074-> (u (u (u fm_binder_new _eras_1) _3073) _3074)); })))))); }))); })))))
list_concat = (\_as_2-> (\_bs_3-> (let _3075 = _as_2 in (case _3075 of {(0,f) -> u f (_bs_3); (1,f) -> u f (\_3076 _3077-> (u (u list_cons _3076) (u (u list_concat _3077) _bs_3))); }))))
list_flatten = (\_xs_2-> (let _3078 = _xs_2 in (case _3078 of {(0,f) -> u f (list_nil); (1,f) -> u f (\_3079 _3080-> (u (u list_concat _3079) (u list_flatten _3080))); })))
fm_parser_binder = (\_idx_1-> (\_code_2-> (let _3081 = (u (u (u parser_many1 (u parser_first_of (u (u list_cons (u fm_parser_binder_homo bool_true)) (u (u list_cons (u fm_parser_binder_homo bool_false)) list_nil)))) _idx_1) _code_2) in (case _3081 of {(0,f) -> u f (\_3082 _3083 _3084-> (u (u (u parser_reply_error _3082) _3083) _3084)); (1,f) -> u f (\_3085 _3086 _3087-> (u (u (u parser_reply_value _3085) _3086) (u list_flatten _3087))); }))))
fm_parser_make_forall = (\_binds_1-> (\_body_2-> (let _3088 = _binds_1 in (case _3088 of {(0,f) -> u f (_body_2); (1,f) -> u f (\_3089 _3090-> (let _3091 = _3089 in (case _3091 of {(0,f) -> u f (\_3092 _3093 _3094-> (u (u (u (u (u fm_term_all _3092) "") _3093) _3094) (\_s_8-> (\_x_9-> (u (u fm_parser_make_forall _3090) _body_2))))); }))); }))))
list_at = (\_index_2-> (\_list_3-> (let _3095 = _list_3 in (case _3095 of {(0,f) -> u f (maybe_none); (1,f) -> u f (\_3096 _3097-> (let _3098 = _index_2 in (if _3098==0 then (u maybe_some _3096) else (u (u list_at (_3098-1)) _3097)))); }))))
list_at_last = (\_index_2-> (\_list_3-> (u (u list_at _index_2) (u list_reverse _list_3))))
fm_term_var = (\_name_1-> (\_indx_2-> (0,\t-> t _name_1 _indx_2)))
fm_context_get_name_skips = (\_name_1-> (let _3099 = _name_1 in (if null (_3099::String) then (u (u pair_new "") 0) else (let _name_skips_4=(u fm_context_get_name_skips (tail _3099)) in (let _3100 = _name_skips_4 in (case _3100 of {(0,f) -> u f (\_3101 _3102-> (let _3103 = ((((fromIntegral (fromEnum (head _3099 :: Char)) :: Word16)::Word16) == 94)) in (if _3103 then (u (u pair_new _3101) (u nat_succ _3102)) else (u (u pair_new (u (u string_cons (fromIntegral (fromEnum (head _3099 :: Char)) :: Word16)) _3101)) _3102)))); }))))))
fm_name_eql = (\_a_1-> (\_b_2-> (((_a_1::String) == _b_2))))
fm_context_find_go = (\_name_1-> (\_skip_2-> (\_ctx_3-> (let _3104 = _ctx_3 in (case _3104 of {(0,f) -> u f (maybe_none); (1,f) -> u f (\_3105 _3106-> (let _3107 = _3105 in (case _3107 of {(0,f) -> u f (\_3108 _3109-> (let _3110 = (u (u fm_name_eql _name_1) _3108) in (if _3110 then (let _3111 = _skip_2 in (if _3111==0 then (u maybe_some _3109) else (u (u (u fm_context_find_go _name_1) (_3111-1)) _3106))) else (u (u (u fm_context_find_go _name_1) _skip_2) _3106)))); }))); })))))
fm_context_find = (\_name_1-> (\_ctx_2-> (let _3112 = (u fm_context_get_name_skips _name_1) in (case _3112 of {(0,f) -> u f (\_3113 _3114-> (u (u (u fm_context_find_go _3113) _3114) _ctx_2)); }))))
list_length = (\_xs_2-> (let _3115 = _xs_2 in (case _3115 of {(0,f) -> u f (0); (1,f) -> u f (\_3116 _3117-> (u nat_succ (u list_length _3117))); })))
fm_path_o = (\_path_1-> (\_x_2-> (u _path_1 (u bits_o _x_2))))
fm_path_i = (\_path_1-> (\_x_2-> (u _path_1 (u bits_i _x_2))))
fm_path_to_bits = (\_path_1-> (u _path_1 bits_e))
fm_term_bind = (\_vars_1-> (\_path_2-> (\_term_3-> (let _3118 = _term_3 in (case _3118 of {(0,f) -> u f (\_3119 _3120-> (let _3121 = (u (u list_at_last _3120) _vars_1) in (case _3121 of {(0,f) -> u f ((u (u fm_term_var _3119) _3120)); (1,f) -> u f (\_3122-> (u pair_snd _3122)); }))); (1,f) -> u f (\_3123-> (let _3124 = (u (u fm_context_find _3123) _vars_1) in (case _3124 of {(0,f) -> u f ((u fm_term_ref _3123)); (1,f) -> u f (\_3125-> _3125); }))); (2,f) -> u f (fm_term_typ); (3,f) -> u f (\_3126 _3127 _3128 _3129 _3130-> (let _vlen_9=(u list_length _vars_1) in (u (u (u (u (u fm_term_all _3126) _3127) _3128) (u (u (u fm_term_bind _vars_1) (u fm_path_o _path_2)) _3129)) (\_s_10-> (\_x_11-> (u (u (u fm_term_bind (u (u list_cons (u (u pair_new _3128) _x_11)) (u (u list_cons (u (u pair_new _3127) _s_10)) _vars_1))) (u fm_path_i _path_2)) (u (u _3130 (u (u fm_term_var _3127) _vlen_9)) (u (u fm_term_var _3128) (u nat_succ _vlen_9))))))))); (4,f) -> u f (\_3131 _3132-> (let _vlen_6=(u list_length _vars_1) in (u (u fm_term_lam _3131) (\_x_7-> (u (u (u fm_term_bind (u (u list_cons (u (u pair_new _3131) _x_7)) _vars_1)) (u fm_path_o _path_2)) (u _3132 (u (u fm_term_var _3131) _vlen_6))))))); (5,f) -> u f (\_3133 _3134-> (u (u fm_term_app (u (u (u fm_term_bind _vars_1) (u fm_path_o _path_2)) _3133)) (u (u (u fm_term_bind _vars_1) (u fm_path_i _path_2)) _3134))); (6,f) -> u f (\_3135 _3136 _3137-> (let _vlen_7=(u list_length _vars_1) in (u (u (u fm_term_let _3135) (u (u (u fm_term_bind _vars_1) (u fm_path_o _path_2)) _3136)) (\_x_8-> (u (u (u fm_term_bind (u (u list_cons (u (u pair_new _3135) _x_8)) _vars_1)) (u fm_path_i _path_2)) (u _3137 (u (u fm_term_var _3135) _vlen_7))))))); (7,f) -> u f (\_3138 _3139 _3140-> (let _vlen_7=(u list_length _vars_1) in (u (u (u fm_term_def _3138) (u (u (u fm_term_bind _vars_1) (u fm_path_o _path_2)) _3139)) (\_x_8-> (u (u (u fm_term_bind (u (u list_cons (u (u pair_new _3138) _x_8)) _vars_1)) (u fm_path_i _path_2)) (u _3140 (u (u fm_term_var _3138) _vlen_7))))))); (8,f) -> u f (\_3141 _3142 _3143-> (u (u (u fm_term_ann _3141) (u (u (u fm_term_bind _vars_1) (u fm_path_o _path_2)) _3142)) (u (u (u fm_term_bind _vars_1) (u fm_path_i _path_2)) _3143))); (9,f) -> u f (\_3144 _3145 _3146-> (u (u (u fm_term_gol _3144) _3145) _3146)); (10,f) -> u f (\_3147-> (u fm_term_hol (u fm_path_to_bits _path_2))); (11,f) -> u f (\_3148-> (u fm_term_nat _3148)); (12,f) -> u f (\_3149-> (u fm_term_chr _3149)); (13,f) -> u f (\_3150-> (u fm_term_str _3150)); (14,f) -> u f (\_3151 _3152 _3153 _3154 _3155 _3156-> (let _expr_10=(u (u (u fm_term_bind _vars_1) (u fm_path_o _path_2)) _3152) in (let _name_11=_3153 in (let _wyth_12=_3154 in (let _cses_13=_3155 in (let _moti_14=_3156 in (u (u (u (u (u (u fm_term_cse (u fm_path_to_bits _path_2)) _expr_10) _name_11) _wyth_12) _cses_13) _moti_14))))))); (15,f) -> u f (\_3157 _3158-> (u (u fm_term_ori _3157) (u (u (u fm_term_bind _vars_1) _path_2) _3158))); })))))
fm_status_done = (2,\t-> t)
fm_define = (\_file_1-> (\_code_2-> (\_orig_3-> (\_name_4-> (\_term_5-> (\_type_6-> (\_isct_7-> (\_done_8-> (\_defs_9-> (let _stat_10=(let _3159 = _done_8 in (if _3159 then fm_status_done else fm_status_init)) in (u (u (u fm_set _name_4) (u (u (u (u (u (u (u (u fm_def_new _file_1) _code_2) _orig_3) _name_4) _term_5) _type_6) _isct_7) _stat_10)) _defs_9)))))))))))
fm_parser_file_def = (\_file_1-> (\_code_2-> (\_defs_3-> (\_idx_4-> (\_code_5-> (let _3160 = (u (u fm_parser_init _idx_4) _code_5) in (case _3160 of {(0,f) -> u f (\_3161 _3162 _3163-> (u (u (u parser_reply_error _3161) _3162) _3163)); (1,f) -> u f (\_3164 _3165 _3166-> (let _3167 = (u (u fm_parser_name1 _3164) _3165) in (case _3167 of {(0,f) -> u f (\_3168 _3169 _3170-> (u (u (u parser_reply_error _3168) _3169) _3170)); (1,f) -> u f (\_3171 _3172 _3173-> (let _3174 = (u (u (u parser_many fm_parser_binder) _3171) _3172) in (case _3174 of {(0,f) -> u f (\_3175 _3176 _3177-> (u (u (u parser_reply_error _3175) _3176) _3177)); (1,f) -> u f (\_3178 _3179 _3180-> (let _args_15=(u list_flatten _3180) in (let _3181 = (u (u (u fm_parser_text ":") _3178) _3179) in (case _3181 of {(0,f) -> u f (\_3182 _3183 _3184-> (u (u (u parser_reply_error _3182) _3183) _3184)); (1,f) -> u f (\_3185 _3186 _3187-> (let _3188 = (u (u fm_parser_term _3185) _3186) in (case _3188 of {(0,f) -> u f (\_3189 _3190 _3191-> (u (u (u parser_reply_error _3189) _3190) _3191)); (1,f) -> u f (\_3192 _3193 _3194-> (let _3195 = (u (u fm_parser_term _3192) _3193) in (case _3195 of {(0,f) -> u f (\_3196 _3197 _3198-> (u (u (u parser_reply_error _3196) _3197) _3198)); (1,f) -> u f (\_3199 _3200 _3201-> (let _3202 = (u (u (u fm_parser_stop _3166) _3199) _3200) in (case _3202 of {(0,f) -> u f (\_3203 _3204 _3205-> (u (u (u parser_reply_error _3203) _3204) _3205)); (1,f) -> u f (\_3206 _3207 _3208-> (let _type_28=(u (u fm_parser_make_forall _args_15) _3194) in (let _term_29=(u (u fm_parser_make_lambda (u (u list_mapped _args_15) (\_x_29-> (let _3209 = _x_29 in (case _3209 of {(0,f) -> u f (\_3210 _3211 _3212-> _3211); }))))) _3201) in (let _type_30=(u (u (u fm_term_bind list_nil) (\_x_30-> (u bits_i _x_30))) _type_28) in (let _term_31=(u (u (u fm_term_bind list_nil) (\_x_31-> (u bits_o _x_31))) _term_29) in (let _defs_32=(u (u (u (u (u (u (u (u (u fm_define _file_1) _code_2) _3208) _3173) _term_31) _type_30) bool_false) bool_false) _defs_3) in (u (u (u parser_reply_value _3206) _3207) _defs_32))))))); }))); }))); }))); })))); }))); }))); })))))))
maybe_default = (\_a_2-> (\_m_3-> (let _3213 = _m_3 in (case _3213 of {(0,f) -> u f (_a_2); (1,f) -> u f (\_3214-> _3214); }))))
fm_constructor_new = (\_name_1-> (\_args_2-> (\_inds_3-> (0,\t-> t _name_1 _args_2 _inds_3))))
fm_parser_constructor = (\_namespace_1-> (\_idx_2-> (\_code_3-> (let _3215 = (u (u fm_parser_name1 _idx_2) _code_3) in (case _3215 of {(0,f) -> u f (\_3216 _3217 _3218-> (u (u (u parser_reply_error _3216) _3217) _3218)); (1,f) -> u f (\_3219 _3220 _3221-> (let _3222 = (u (u (u parser_maybe fm_parser_binder) _3219) _3220) in (case _3222 of {(0,f) -> u f (\_3223 _3224 _3225-> (u (u (u parser_reply_error _3223) _3224) _3225)); (1,f) -> u f (\_3226 _3227 _3228-> (let _3229 = (u (u (u parser_maybe (\_idx_10-> (\_code_11-> (let _3230 = (u (u (u fm_parser_text "~") _idx_10) _code_11) in (case _3230 of {(0,f) -> u f (\_3231 _3232 _3233-> (u (u (u parser_reply_error _3231) _3232) _3233)); (1,f) -> u f (\_3234 _3235 _3236-> (u (u fm_parser_binder _3234) _3235)); }))))) _3226) _3227) in (case _3229 of {(0,f) -> u f (\_3237 _3238 _3239-> (u (u (u parser_reply_error _3237) _3238) _3239)); (1,f) -> u f (\_3240 _3241 _3242-> (let _args_13=(u (u maybe_default list_nil) _3228) in (let _inds_14=(u (u maybe_default list_nil) _3242) in (u (u (u parser_reply_value _3240) _3241) (u (u (u fm_constructor_new _3221) _args_13) _inds_14))))); }))); }))); })))))
fm_datatype_new = (\_name_1-> (\_pars_2-> (\_inds_3-> (\_ctrs_4-> (0,\t-> t _name_1 _pars_2 _inds_3 _ctrs_4)))))
fm_parser_datatype = (\_idx_1-> (\_code_2-> (let _3243 = (u (u (u fm_parser_text "type ") _idx_1) _code_2) in (case _3243 of {(0,f) -> u f (\_3244 _3245 _3246-> (u (u (u parser_reply_error _3244) _3245) _3246)); (1,f) -> u f (\_3247 _3248 _3249-> (let _3250 = (u (u fm_parser_name1 _3247) _3248) in (case _3250 of {(0,f) -> u f (\_3251 _3252 _3253-> (u (u (u parser_reply_error _3251) _3252) _3253)); (1,f) -> u f (\_3254 _3255 _3256-> (let _3257 = (u (u (u parser_maybe fm_parser_binder) _3254) _3255) in (case _3257 of {(0,f) -> u f (\_3258 _3259 _3260-> (u (u (u parser_reply_error _3258) _3259) _3260)); (1,f) -> u f (\_3261 _3262 _3263-> (let _3264 = (u (u (u parser_maybe (\_idx_12-> (\_code_13-> (let _3265 = (u (u (u fm_parser_text "~") _idx_12) _code_13) in (case _3265 of {(0,f) -> u f (\_3266 _3267 _3268-> (u (u (u parser_reply_error _3266) _3267) _3268)); (1,f) -> u f (\_3269 _3270 _3271-> (u (u fm_parser_binder _3269) _3270)); }))))) _3261) _3262) in (case _3264 of {(0,f) -> u f (\_3272 _3273 _3274-> (u (u (u parser_reply_error _3272) _3273) _3274)); (1,f) -> u f (\_3275 _3276 _3277-> (let _pars_15=(u (u maybe_default list_nil) _3263) in (let _inds_16=(u (u maybe_default list_nil) _3277) in (let _3278 = (u (u (u fm_parser_text "{") _3275) _3276) in (case _3278 of {(0,f) -> u f (\_3279 _3280 _3281-> (u (u (u parser_reply_error _3279) _3280) _3281)); (1,f) -> u f (\_3282 _3283 _3284-> (let _3285 = (u (u (u (u parser_until (u fm_parser_text "}")) (u fm_parser_item (u fm_parser_constructor _3256))) _3282) _3283) in (case _3285 of {(0,f) -> u f (\_3286 _3287 _3288-> (u (u (u parser_reply_error _3286) _3287) _3288)); (1,f) -> u f (\_3289 _3290 _3291-> (u (u (u parser_reply_value _3289) _3290) (u (u (u (u fm_datatype_new _3256) _pars_15) _inds_16) _3291))); }))); }))))); }))); }))); }))); }))))
fm_datatype_build_term_motive_go = (\_type_1-> (\_name_2-> (\_inds_3-> (let _3292 = _inds_3 in (case _3292 of {(0,f) -> u f ((let _3293 = _type_1 in (case _3293 of {(0,f) -> u f (\_3294 _3295 _3296 _3297-> (let _slf_8=(u fm_term_ref _name_2) in (let _slf_9=(u (u (u list_for _3295) _slf_8) (\_var_9-> (\_slf_10-> (u (u fm_term_app _slf_10) (u fm_term_ref (let _3298 = _var_9 in (case _3298 of {(0,f) -> u f (\_3299 _3300 _3301-> _3300); }))))))) in (let _slf_10=(u (u (u list_for _3296) _slf_9) (\_var_10-> (\_slf_11-> (u (u fm_term_app _slf_11) (u fm_term_ref (let _3302 = _var_10 in (case _3302 of {(0,f) -> u f (\_3303 _3304 _3305-> _3304); }))))))) in (u (u (u (u (u fm_term_all bool_false) "") "") _slf_10) (\_s_11-> (\_x_12-> fm_term_typ))))))); }))); (1,f) -> u f (\_3306 _3307-> (let _3308 = _3306 in (case _3308 of {(0,f) -> u f (\_3309 _3310 _3311-> (u (u (u (u (u fm_term_all _3309) "") _3310) _3311) (\_s_9-> (\_x_10-> (u (u (u fm_datatype_build_term_motive_go _type_1) _name_2) _3307))))); }))); })))))
fm_datatype_build_term_motive = (\_type_1-> (let _3312 = _type_1 in (case _3312 of {(0,f) -> u f (\_3313 _3314 _3315 _3316-> (u (u (u fm_datatype_build_term_motive_go _type_1) _3313) _3315)); })))
fm_datatype_build_term_constructor_go = (\_type_1-> (\_ctor_2-> (\_args_3-> (let _3317 = _args_3 in (case _3317 of {(0,f) -> u f ((let _3318 = _type_1 in (case _3318 of {(0,f) -> u f (\_3319 _3320 _3321 _3322-> (let _3323 = _ctor_2 in (case _3323 of {(0,f) -> u f (\_3324 _3325 _3326-> (let _ret_11=(u fm_term_ref (u fm_name_read "P")) in (let _ret_12=(u (u (u list_for _3326) _ret_11) (\_var_12-> (\_ret_13-> (u (u fm_term_app _ret_13) (let _3327 = _var_12 in (case _3327 of {(0,f) -> u f (\_3328 _3329 _3330-> _3330); })))))) in (let _ctr_13=(u string_flatten (u (u list_cons _3319) (u (u list_cons (u fm_name_read ".")) (u (u list_cons _3324) list_nil)))) in (let _slf_14=(u fm_term_ref _ctr_13) in (let _slf_15=(u (u (u list_for _3320) _slf_14) (\_var_15-> (\_slf_16-> (u (u fm_term_app _slf_16) (u fm_term_ref (let _3331 = _var_15 in (case _3331 of {(0,f) -> u f (\_3332 _3333 _3334-> _3333); }))))))) in (let _slf_16=(u (u (u list_for _3325) _slf_15) (\_var_16-> (\_slf_17-> (u (u fm_term_app _slf_17) (u fm_term_ref (let _3335 = _var_16 in (case _3335 of {(0,f) -> u f (\_3336 _3337 _3338-> _3337); }))))))) in (u (u fm_term_app _ret_12) _slf_16)))))))); }))); }))); (1,f) -> u f (\_3339 _3340-> (let _3341 = _3339 in (case _3341 of {(0,f) -> u f (\_3342 _3343 _3344-> (let _eras_9=_3342 in (let _name_10=_3343 in (let _xtyp_11=_3344 in (let _body_12=(u (u (u fm_datatype_build_term_constructor_go _type_1) _ctor_2) _3340) in (u (u (u (u (u fm_term_all _eras_9) "") _name_10) _xtyp_11) (\_s_13-> (\_x_14-> _body_12)))))))); }))); })))))
fm_datatype_build_term_constructor = (\_type_1-> (\_ctor_2-> (let _3345 = _ctor_2 in (case _3345 of {(0,f) -> u f (\_3346 _3347 _3348-> (u (u (u fm_datatype_build_term_constructor_go _type_1) _ctor_2) _3347)); }))))
fm_datatype_build_term_constructors_go = (\_type_1-> (\_name_2-> (\_ctrs_3-> (let _3349 = _ctrs_3 in (case _3349 of {(0,f) -> u f ((let _3350 = _type_1 in (case _3350 of {(0,f) -> u f (\_3351 _3352 _3353 _3354-> (let _ret_8=(u fm_term_ref (u fm_name_read "P")) in (let _ret_9=(u (u (u list_for _3353) _ret_8) (\_var_9-> (\_ret_10-> (u (u fm_term_app _ret_10) (u fm_term_ref (let _3355 = _var_9 in (case _3355 of {(0,f) -> u f (\_3356 _3357 _3358-> _3357); }))))))) in (u (u fm_term_app _ret_9) (u fm_term_ref (((_name_2::String) ++ ".Self"))))))); }))); (1,f) -> u f (\_3359 _3360-> (let _3361 = _3359 in (case _3361 of {(0,f) -> u f (\_3362 _3363 _3364-> (u (u (u (u (u fm_term_all bool_false) "") _3362) (u (u fm_datatype_build_term_constructor _type_1) _3359)) (\_s_9-> (\_x_10-> (u (u (u fm_datatype_build_term_constructors_go _type_1) _name_2) _3360))))); }))); })))))
fm_datatype_build_term_constructors = (\_type_1-> (let _3365 = _type_1 in (case _3365 of {(0,f) -> u f (\_3366 _3367 _3368 _3369-> (u (u (u fm_datatype_build_term_constructors_go _type_1) _3366) _3369)); })))
fm_datatype_build_term_go = (\_type_1-> (\_name_2-> (\_pars_3-> (\_inds_4-> (let _3370 = _pars_3 in (case _3370 of {(0,f) -> u f ((let _3371 = _inds_4 in (case _3371 of {(0,f) -> u f ((u (u (u (u (u fm_term_all bool_true) (((_name_2::String) ++ ".Self"))) (u fm_name_read "P")) (u fm_datatype_build_term_motive _type_1)) (\_s_5-> (\_x_6-> (u fm_datatype_build_term_constructors _type_1))))); (1,f) -> u f (\_3372 _3373-> (let _3374 = _3372 in (case _3374 of {(0,f) -> u f (\_3375 _3376 _3377-> (u (u fm_term_lam _3376) (\_x_10-> (u (u (u (u fm_datatype_build_term_go _type_1) _name_2) _pars_3) _3373)))); }))); }))); (1,f) -> u f (\_3378 _3379-> (let _3380 = _3378 in (case _3380 of {(0,f) -> u f (\_3381 _3382 _3383-> (u (u fm_term_lam _3382) (\_x_10-> (u (u (u (u fm_datatype_build_term_go _type_1) _name_2) _3379) _inds_4)))); }))); }))))))
fm_datatype_build_term = (\_type_1-> (let _3384 = _type_1 in (case _3384 of {(0,f) -> u f (\_3385 _3386 _3387 _3388-> (u (u (u (u fm_datatype_build_term_go _type_1) _3385) _3386) _3387)); })))
fm_datatype_build_type_go = (\_type_1-> (\_name_2-> (\_pars_3-> (\_inds_4-> (let _3389 = _pars_3 in (case _3389 of {(0,f) -> u f ((let _3390 = _inds_4 in (case _3390 of {(0,f) -> u f (fm_term_typ); (1,f) -> u f (\_3391 _3392-> (let _3393 = _3391 in (case _3393 of {(0,f) -> u f (\_3394 _3395 _3396-> (u (u (u (u (u fm_term_all bool_false) "") _3395) _3396) (\_s_10-> (\_x_11-> (u (u (u (u fm_datatype_build_type_go _type_1) _name_2) _pars_3) _3392))))); }))); }))); (1,f) -> u f (\_3397 _3398-> (let _3399 = _3397 in (case _3399 of {(0,f) -> u f (\_3400 _3401 _3402-> (u (u (u (u (u fm_term_all bool_false) "") _3401) _3402) (\_s_10-> (\_x_11-> (u (u (u (u fm_datatype_build_type_go _type_1) _name_2) _3398) _inds_4))))); }))); }))))))
fm_datatype_build_type = (\_type_1-> (let _3403 = _type_1 in (case _3403 of {(0,f) -> u f (\_3404 _3405 _3406 _3407-> (u (u (u (u fm_datatype_build_type_go _type_1) _3404) _3405) _3406)); })))
fm_constructor_build_term_opt_go = (\_type_1-> (\_ctor_2-> (\_ctrs_3-> (let _3408 = _ctrs_3 in (case _3408 of {(0,f) -> u f ((let _3409 = _ctor_2 in (case _3409 of {(0,f) -> u f (\_3410 _3411 _3412-> (let _ret_7=(u fm_term_ref _3410) in (let _ret_8=(u (u (u list_for _3411) _ret_7) (\_arg_8-> (\_ret_9-> (u (u fm_term_app _ret_9) (u fm_term_ref (let _3413 = _arg_8 in (case _3413 of {(0,f) -> u f (\_3414 _3415 _3416-> _3415); }))))))) in _ret_8))); }))); (1,f) -> u f (\_3417 _3418-> (let _3419 = _3417 in (case _3419 of {(0,f) -> u f (\_3420 _3421 _3422-> (u (u fm_term_lam _3420) (\_x_9-> (u (u (u fm_constructor_build_term_opt_go _type_1) _ctor_2) _3418)))); }))); })))))
fm_constructor_build_term_opt = (\_type_1-> (\_ctor_2-> (let _3423 = _type_1 in (case _3423 of {(0,f) -> u f (\_3424 _3425 _3426 _3427-> (u (u (u fm_constructor_build_term_opt_go _type_1) _ctor_2) _3427)); }))))
fm_constructor_build_term_go = (\_type_1-> (\_ctor_2-> (\_name_3-> (\_pars_4-> (\_args_5-> (let _3428 = _pars_4 in (case _3428 of {(0,f) -> u f ((let _3429 = _args_5 in (case _3429 of {(0,f) -> u f ((u (u fm_term_lam (u fm_name_read "P")) (\_x_6-> (u (u fm_constructor_build_term_opt _type_1) _ctor_2)))); (1,f) -> u f (\_3430 _3431-> (let _3432 = _3430 in (case _3432 of {(0,f) -> u f (\_3433 _3434 _3435-> (u (u fm_term_lam _3434) (\_x_11-> (u (u (u (u (u fm_constructor_build_term_go _type_1) _ctor_2) _name_3) _pars_4) _3431)))); }))); }))); (1,f) -> u f (\_3436 _3437-> (let _3438 = _3436 in (case _3438 of {(0,f) -> u f (\_3439 _3440 _3441-> (u (u fm_term_lam _3440) (\_x_11-> (u (u (u (u (u fm_constructor_build_term_go _type_1) _ctor_2) _name_3) _3437) _args_5)))); }))); })))))))
fm_constructor_build_term = (\_type_1-> (\_ctor_2-> (let _3442 = _type_1 in (case _3442 of {(0,f) -> u f (\_3443 _3444 _3445 _3446-> (let _3447 = _ctor_2 in (case _3447 of {(0,f) -> u f (\_3448 _3449 _3450-> (u (u (u (u (u fm_constructor_build_term_go _type_1) _ctor_2) _3443) _3444) _3449)); }))); }))))
fm_constructor_build_type_go = (\_type_1-> (\_ctor_2-> (\_name_3-> (\_pars_4-> (\_args_5-> (let _3451 = _pars_4 in (case _3451 of {(0,f) -> u f ((let _3452 = _args_5 in (case _3452 of {(0,f) -> u f ((let _3453 = _type_1 in (case _3453 of {(0,f) -> u f (\_3454 _3455 _3456 _3457-> (let _3458 = _ctor_2 in (case _3458 of {(0,f) -> u f (\_3459 _3460 _3461-> (let _type_13=(u fm_term_ref _name_3) in (let _type_14=(u (u (u list_for _3455) _type_13) (\_var_14-> (\_type_15-> (u (u fm_term_app _type_15) (u fm_term_ref (let _3462 = _var_14 in (case _3462 of {(0,f) -> u f (\_3463 _3464 _3465-> _3464); }))))))) in (let _type_15=(u (u (u list_for _3461) _type_14) (\_var_15-> (\_type_16-> (u (u fm_term_app _type_16) (let _3466 = _var_15 in (case _3466 of {(0,f) -> u f (\_3467 _3468 _3469-> _3469); })))))) in _type_15)))); }))); }))); (1,f) -> u f (\_3470 _3471-> (let _3472 = _3470 in (case _3472 of {(0,f) -> u f (\_3473 _3474 _3475-> (u (u (u (u (u fm_term_all _3473) "") _3474) _3475) (\_s_11-> (\_x_12-> (u (u (u (u (u fm_constructor_build_type_go _type_1) _ctor_2) _name_3) _pars_4) _3471))))); }))); }))); (1,f) -> u f (\_3476 _3477-> (let _3478 = _3476 in (case _3478 of {(0,f) -> u f (\_3479 _3480 _3481-> (u (u (u (u (u fm_term_all _3479) "") _3480) _3481) (\_s_11-> (\_x_12-> (u (u (u (u (u fm_constructor_build_type_go _type_1) _ctor_2) _name_3) _3477) _args_5))))); }))); })))))))
fm_constructor_build_type = (\_type_1-> (\_ctor_2-> (let _3482 = _type_1 in (case _3482 of {(0,f) -> u f (\_3483 _3484 _3485 _3486-> (let _3487 = _ctor_2 in (case _3487 of {(0,f) -> u f (\_3488 _3489 _3490-> (u (u (u (u (u fm_constructor_build_type_go _type_1) _ctor_2) _3483) _3484) _3489)); }))); }))))
fm_parser_file_adt = (\_file_1-> (\_code_2-> (\_defs_3-> (\_idx_4-> (\_code_5-> (let _3491 = (u (u fm_parser_init _idx_4) _code_5) in (case _3491 of {(0,f) -> u f (\_3492 _3493 _3494-> (u (u (u parser_reply_error _3492) _3493) _3494)); (1,f) -> u f (\_3495 _3496 _3497-> (let _3498 = (u (u fm_parser_datatype _3495) _3496) in (case _3498 of {(0,f) -> u f (\_3499 _3500 _3501-> (u (u (u parser_reply_error _3499) _3500) _3501)); (1,f) -> u f (\_3502 _3503 _3504-> (let _3505 = (u (u (u fm_parser_stop _3497) _3502) _3503) in (case _3505 of {(0,f) -> u f (\_3506 _3507 _3508-> (u (u (u parser_reply_error _3506) _3507) _3508)); (1,f) -> u f (\_3509 _3510 _3511-> (let _3512 = _3504 in (case _3512 of {(0,f) -> u f (\_3513 _3514 _3515 _3516-> (let _term_19=(u fm_datatype_build_term _3504) in (let _term_20=(u (u (u fm_term_bind list_nil) (\_x_20-> (u bits_i _x_20))) _term_19) in (let _type_21=(u fm_datatype_build_type _3504) in (let _type_22=(u (u (u fm_term_bind list_nil) (\_x_22-> (u bits_o _x_22))) _type_21) in (let _defs_23=(u (u (u (u (u (u (u (u (u fm_define _file_1) _code_2) _3511) _3513) _term_20) _type_22) bool_false) bool_false) _defs_3) in (let _defs_24=(u (u (u list_fold _3516) _defs_23) (\_ctr_24-> (\_defs_25-> (let _typ_name_26=_3513 in (let _ctr_name_27=(u string_flatten (u (u list_cons _typ_name_26) (u (u list_cons (u fm_name_read ".")) (u (u list_cons (let _3517 = _ctr_24 in (case _3517 of {(0,f) -> u f (\_3518 _3519 _3520-> _3518); }))) list_nil)))) in (let _ctr_term_28=(u (u fm_constructor_build_term _3504) _ctr_24) in (let _ctr_term_29=(u (u (u fm_term_bind list_nil) (\_x_29-> (u bits_i _x_29))) _ctr_term_28) in (let _ctr_type_30=(u (u fm_constructor_build_type _3504) _ctr_24) in (let _ctr_type_31=(u (u (u fm_term_bind list_nil) (\_x_31-> (u bits_o _x_31))) _ctr_type_30) in (u (u (u (u (u (u (u (u (u fm_define _file_1) _code_2) _3511) _ctr_name_27) _ctr_term_29) _ctr_type_31) bool_true) bool_false) _defs_25)))))))))) in (\_idx_25-> (\_code_26-> (u (u (u parser_reply_value _idx_25) _code_26) _defs_24)))))))))); })) _3509 _3510); }))); }))); })))))))
parser_eof = (\_idx_1-> (\_code_2-> (let _3521 = _code_2 in (if null (_3521::String) then (u (u (u parser_reply_value _idx_1) _code_2) unit_new) else (u (u (u parser_reply_error _idx_1) _code_2) "Expected end-of-file.")))))
fm_parser_file_end = (\_file_1-> (\_code_2-> (\_defs_3-> (\_idx_4-> (\_code_5-> (let _3522 = (u (u fm_parser_spaces _idx_4) _code_5) in (case _3522 of {(0,f) -> u f (\_3523 _3524 _3525-> (u (u (u parser_reply_error _3523) _3524) _3525)); (1,f) -> u f (\_3526 _3527 _3528-> (let _3529 = (u (u parser_eof _3526) _3527) in (case _3529 of {(0,f) -> u f (\_3530 _3531 _3532-> (u (u (u parser_reply_error _3530) _3531) _3532)); (1,f) -> u f (\_3533 _3534 _3535-> (u (u (u parser_reply_value _3533) _3534) _defs_3)); }))); })))))))
fm_parser_file = (\_file_1-> (\_code_2-> (\_defs_3-> (\_idx_4-> (\_code_5-> (let _3536 = (u (u parser_is_eof _idx_4) _code_5) in (case _3536 of {(0,f) -> u f (\_3537 _3538 _3539-> (u (u (u parser_reply_error _3537) _3538) _3539)); (1,f) -> u f (\_3540 _3541 _3542-> (let _3543 = _3542 in (if _3543 then (\_idx_9-> (\_code_10-> (u (u (u parser_reply_value _idx_9) _code_10) _defs_3))) else (\_idx_9-> (\_code_10-> (let _3544 = (u (u (u parser_first_of (u (u list_cons (u (u (u fm_parser_file_def _file_1) _code_2) _defs_3)) (u (u list_cons (u (u (u fm_parser_file_adt _file_1) _code_2) _defs_3)) (u (u list_cons (u (u (u fm_parser_file_end _file_1) _code_2) _defs_3)) list_nil)))) _idx_9) _code_10) in (case _3544 of {(0,f) -> u f (\_3545 _3546 _3547-> (u (u (u parser_reply_error _3545) _3546) _3547)); (1,f) -> u f (\_3548 _3549 _3550-> (u (u (u (u (u fm_parser_file _file_1) _code_2) _3550) _3548) _3549)); })))))) _3540 _3541); })))))))
either = (\_a_1-> (\_b_2-> ()))
string_join_go = (\_sep_1-> (\_list_2-> (\_fst_3-> (let _3551 = _list_2 in (case _3551 of {(0,f) -> u f (""); (1,f) -> u f (\_3552 _3553-> (u string_flatten (u (u list_cons (let _3554 = _fst_3 in (if _3554 then "" else _sep_1))) (u (u list_cons _3552) (u (u list_cons (u (u (u string_join_go _sep_1) _3553) bool_false)) list_nil))))); })))))
string_join = (\_sep_1-> (\_list_2-> (u (u (u string_join_go _sep_1) _list_2) bool_true)))
fm_highlight_end = (\_col_1-> (\_row_2-> (\_res_3-> (u (u string_join "\n") _res_3))))
maybe_extract = (\_m_2-> (\_a_4-> (\_f_5-> (let _3555 = _m_2 in (case _3555 of {(0,f) -> u f (_a_4); (1,f) -> u f (\_3556-> (u _f_5 _3556)); })))))
nat_is_zero = (\_n_1-> (let _3557 = _n_1 in (if _3557==0 then bool_true else bool_false)))
nat_double = (\_n_1-> (let _3558 = _n_1 in (if _3558==0 then nat_zero else (u nat_succ (u nat_succ (u nat_double (_3558-1)))))))
nat_pred = (\_n_1-> (let _3559 = _n_1 in (if _3559==0 then nat_zero else (_3559-1))))
string_reverse_go = (\_xs_1-> (\_res_2-> (let _3560 = _xs_1 in (if null (_3560::String) then _res_2 else (u (u string_reverse_go (tail _3560)) (u (u string_cons (fromIntegral (fromEnum (head _3560 :: Char)) :: Word16)) _res_2))))))
string_reverse = (\_xs_1-> (u (u string_reverse_go _xs_1) string_nil))
string_pad_right = (\_size_1-> (\_chr_2-> (\_str_3-> (let _3561 = _size_1 in (if _3561==0 then _str_3 else (let _3562 = _str_3 in (if null (_3562::String) then (u (u string_cons _chr_2) (u (u (u string_pad_right (_3561-1)) _chr_2) "")) else (u (u string_cons (fromIntegral (fromEnum (head _3562 :: Char)) :: Word16)) (u (u (u string_pad_right (_3561-1)) _chr_2) (tail _3562))))))))))
string_pad_left = (\_size_1-> (\_chr_2-> (\_str_3-> (u string_reverse (u (u (u string_pad_right _size_1) _chr_2) (u string_reverse _str_3))))))
either_left = (\_value_3-> (0,\t-> t _value_3))
either_right = (\_value_3-> (1,\t-> t _value_3))
nat_sub_rem = (\_n_1-> (\_m_2-> (let _3563 = _m_2 in (if _3563==0 then (u either_left _n_1) else (let _3564 = _n_1 in (if _3564==0 then (u either_right (u nat_succ (_3563-1))) else (u (u nat_sub_rem (_3564-1)) (_3563-1))))))))
nat_div_mod_go = (\_n_1-> (\_m_2-> (\_d_3-> (let _3565 = (u (u nat_sub_rem _n_1) _m_2) in (case _3565 of {(0,f) -> u f (\_3566-> (u (u (u nat_div_mod_go _3566) _m_2) (u nat_succ _d_3))); (1,f) -> u f (\_3567-> (u (u pair_new _d_3) _n_1)); })))))
nat_div_mod = (\_n_1-> (\_m_2-> (u (u (u nat_div_mod_go _n_1) _m_2) nat_zero)))
nat_to_base_go = (\_base_1-> (\_nat_2-> (\_res_3-> (let _3568 = (u (u nat_div_mod _nat_2) _base_1) in (case _3568 of {(0,f) -> u f (\_3569 _3570-> (let _3571 = _3569 in (if _3571==0 then (u (u list_cons _3570) _res_3) else (u (u (u nat_to_base_go _base_1) _3569) (u (u list_cons _3570) _res_3))))); })))))
nat_to_base = (\_base_1-> (\_nat_2-> (u (u (u nat_to_base_go _base_1) _nat_2) list_nil)))
nat_mod_go = (\_n_1-> (\_m_2-> (\_r_3-> (let _3572 = _m_2 in (if _3572==0 then (u (u (u nat_mod_go _n_1) _r_3) _m_2) else (let _3573 = _n_1 in (if _3573==0 then _r_3 else (u (u (u nat_mod_go (_3573-1)) (_3572-1)) (u nat_succ _r_3)))))))))
nat_mod = (\_n_1-> (\_m_2-> (u (u (u nat_mod_go _n_1) _m_2) 0)))
nat_lte = (\a0-> \a1-> ((a0::Integer) <= a1))
nat_show_digit = (\_base_1-> (\_n_2-> (let _m_3=(u (u nat_mod _n_2) _base_1) in (let _base64_4=(u (u list_cons 48) (u (u list_cons 49) (u (u list_cons 50) (u (u list_cons 51) (u (u list_cons 52) (u (u list_cons 53) (u (u list_cons 54) (u (u list_cons 55) (u (u list_cons 56) (u (u list_cons 57) (u (u list_cons 65) (u (u list_cons 66) (u (u list_cons 67) (u (u list_cons 68) (u (u list_cons 69) (u (u list_cons 70) (u (u list_cons 71) (u (u list_cons 72) (u (u list_cons 73) (u (u list_cons 74) (u (u list_cons 75) (u (u list_cons 76) (u (u list_cons 77) (u (u list_cons 78) (u (u list_cons 79) (u (u list_cons 80) (u (u list_cons 81) (u (u list_cons 82) (u (u list_cons 83) (u (u list_cons 84) (u (u list_cons 85) (u (u list_cons 86) (u (u list_cons 87) (u (u list_cons 88) (u (u list_cons 89) (u (u list_cons 90) (u (u list_cons 97) (u (u list_cons 98) (u (u list_cons 99) (u (u list_cons 100) (u (u list_cons 101) (u (u list_cons 102) (u (u list_cons 103) (u (u list_cons 104) (u (u list_cons 105) (u (u list_cons 106) (u (u list_cons 107) (u (u list_cons 108) (u (u list_cons 109) (u (u list_cons 110) (u (u list_cons 111) (u (u list_cons 112) (u (u list_cons 113) (u (u list_cons 114) (u (u list_cons 115) (u (u list_cons 116) (u (u list_cons 117) (u (u list_cons 118) (u (u list_cons 119) (u (u list_cons 120) (u (u list_cons 121) (u (u list_cons 122) (u (u list_cons 43) (u (u list_cons 47) list_nil)))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))) in (let _3574 = (((((_base_1::Integer) > 0)) && (((_base_1::Integer) <= 64)))) in (if _3574 then (let _3575 = (u (u list_at _m_3) _base64_4) in (case _3575 of {(0,f) -> u f (35); (1,f) -> u f (\_3576-> _3576); })) else 35))))))
nat_to_string_base = (\_base_1-> (\_nat_2-> (u (u (u list_fold (u (u nat_to_base _base_1) _nat_2)) string_nil) (\_n_3-> (\_str_4-> (u (u string_cons (u (u nat_show_digit _base_1) _n_3)) _str_4))))))
nat_show = (\_n_1-> (u (u nat_to_string_base 10) _n_1))
bool_not = (\a0-> (not a0))
fm_color = (\_col_1-> (\_str_2-> (u (u string_cons 27) (u (u string_cons 91) (((_col_1::String) ++ (u (u string_cons 109) (((_str_2::String) ++ (u (u string_cons 27) (u (u string_cons 91) (u (u string_cons 48) (u (u string_cons 109) string_nil)))))))))))))
nat_eql = (\a0-> \a1-> ((a0::Integer) == a1))
list_take = (\_n_2-> (\_xs_3-> (let _3577 = _xs_3 in (case _3577 of {(0,f) -> u f (list_nil); (1,f) -> u f (\_3578 _3579-> (let _3580 = _n_2 in (if _3580==0 then list_nil else (u (u list_cons _3578) (u (u list_take (_3580-1)) _3579))))); }))))
fm_highlight_tc = (\_code_1-> (\_ix0_2-> (\_ix1_3-> (\_col_4-> (\_row_5-> (\_lft_6-> (\_lin_7-> (\_res_8-> (let _spa_9=3 in (let _3581 = _code_1 in (if null (_3581::String) then (u (u (u fm_highlight_end _col_4) _row_5) (u list_reverse _res_8)) else (let _3582 = ((((fromIntegral (fromEnum (head _3581 :: Char)) :: Word16)::Word16) == 10)) in (if _3582 then (let _stp_12=(u (u (u maybe_extract _lft_6) bool_false) nat_is_zero) in (let _3583 = _stp_12 in (if _3583 then (u (u (u fm_highlight_end _col_4) _row_5) (u list_reverse _res_8)) else (let _siz_13=(u nat_succ (u nat_double _spa_9)) in (let _lft_14=(let _3584 = _ix1_3 in (if _3584==0 then (let _3585 = _lft_6 in (case _3585 of {(0,f) -> u f ((u maybe_some _spa_9)); (1,f) -> u f (\_3586-> (u maybe_some (u nat_pred _3586))); })) else _lft_6)) in (let _ix0_15=(u nat_pred _ix0_2) in (let _ix1_16=(u nat_pred _ix1_3) in (let _col_17=0 in (let _row_18=(u nat_succ _row_5) in (let _res_19=(u (u list_cons (u string_reverse _lin_7)) _res_8) in (let _lin_20=(u string_reverse (u string_flatten (u (u list_cons (u (u (u string_pad_left 4) 32) (u nat_show _row_18))) (u (u list_cons " | ") list_nil)))) in (u (u (u (u (u (u (u (u fm_highlight_tc (tail _3581)) _ix0_15) _ix1_16) _col_17) _row_18) _lft_14) _lin_20) _res_19)))))))))))) else (let _chr_12=(u (u string_cons (fromIntegral (fromEnum (head _3581 :: Char)) :: Word16)) string_nil) in (let _chr_13=(let _3587 = (((u nat_is_zero _ix0_2) && ((not (u nat_is_zero _ix1_3))))) in (if _3587 then (u string_reverse (u (u fm_color "31") (u (u fm_color "4") _chr_12))) else _chr_12)) in (let _res_14=(let _3588 = (((_ix0_2::Integer) == 1)) in (if _3588 then (u (u list_take _spa_9) _res_8) else _res_8)) in (let _ix0_15=(u nat_pred _ix0_2) in (let _ix1_16=(u nat_pred _ix1_3) in (let _col_17=(u nat_succ _col_4) in (let _lin_18=(u string_flatten (u (u list_cons _chr_13) (u (u list_cons _lin_7) list_nil))) in (u (u (u (u (u (u (u (u fm_highlight_tc (tail _3581)) _ix0_15) _ix1_16) _col_17) _row_5) _lft_6) _lin_18) _res_14)))))))))))))))))))))
fm_highlight = (\_code_1-> (\_idx0_2-> (\_idx1_3-> (u (u (u (u (u (u (u (u fm_highlight_tc _code_1) _idx0_2) _idx1_3) 0) 1) maybe_none) (u string_reverse "   1 | ")) list_nil))))
fm_defs_read = (\_file_1-> (\_code_2-> (\_defs_3-> (let _3589 = (u (u (u (u (u fm_parser_file _file_1) _code_2) _defs_3) 0) _code_2) in (case _3589 of {(0,f) -> u f (\_3590 _3591 _3592-> (let _err_7=_3592 in (let _hig_8=(u (u (u fm_highlight _code_2) _3590) (u nat_succ _3590)) in (let _str_9=(u string_flatten (u (u list_cons _err_7) (u (u list_cons "\n") (u (u list_cons _hig_8) list_nil)))) in (u either_left _str_9))))); (1,f) -> u f (\_3593 _3594 _3595-> (u either_right _3595)); })))))
fm_synth_load_go = (\_name_1-> (\_files_2-> (\_defs_3-> (let _3596 = _files_2 in (case _3596 of {(0,f) -> u f ((u (u io_monad (\_m_bind_4-> (\_m_pure_5-> _m_pure_5))) maybe_none)); (1,f) -> u f (\_3597 _3598-> (u (u (u io_monad (\_m_bind_6-> (\_m_pure_7-> _m_bind_6))) (u io_get_file _3597)) (\_code_6-> (let _read_7=(u (u (u fm_defs_read _3597) _code_6) _defs_3) in (let _3599 = _read_7 in (case _3599 of {(0,f) -> u f (\_3600-> (u (u (u fm_synth_load_go _name_1) _3598) _defs_3)); (1,f) -> u f (\_3601-> (let _defs_9=_3601 in (let _3602 = (u (u fm_get _name_1) _defs_9) in (case _3602 of {(0,f) -> u f ((u (u (u fm_synth_load_go _name_1) _3598) _defs_9)); (1,f) -> u f (\_3603-> (u (u io_monad (\_m_bind_11-> (\_m_pure_12-> _m_pure_12))) (u maybe_some _defs_9))); })))); })))))); })))))
fm_synth_files_of_make = (\_names_1-> (\_last_2-> (let _3604 = _names_1 in (case _3604 of {(0,f) -> u f (list_nil); (1,f) -> u f (\_3605 _3606-> (let _head_5=(((_last_2::String) ++ (((_3605::String) ++ ".fm")))) in (let _tail_6=(u (u fm_synth_files_of_make _3606) (((_last_2::String) ++ (((_3605::String) ++ "/"))))) in (u (u list_cons _head_5) _tail_6)))); }))))
char_eql = (\_a_1-> (\_b_2-> (((_a_1::Word16) == _b_2))))
string_starts_with = (\_xs_1-> (\_match_2-> (let _3607 = _match_2 in (if null (_3607::String) then bool_true else (let _3608 = _xs_1 in (if null (_3608::String) then bool_false else (let _3609 = (u (u char_eql (fromIntegral (fromEnum (head _3607 :: Char)) :: Word16)) (fromIntegral (fromEnum (head _3608 :: Char)) :: Word16)) in (if _3609 then (u (u string_starts_with (tail _3608)) (tail _3607)) else bool_false))))))))
string_drop = (\_n_1-> (\_xs_2-> (let _3610 = _n_1 in (if _3610==0 then _xs_2 else (let _3611 = _xs_2 in (if null (_3611::String) then string_nil else (u (u string_drop (_3610-1)) (tail _3611))))))))
string_length_go = (\_xs_1-> (\_n_2-> (let _3612 = _xs_1 in (if null (_3612::String) then _n_2 else (u (u string_length_go (tail _3612)) (u nat_succ _n_2))))))
string_length = (\_xs_1-> (u (u string_length_go _xs_1) 0))
string_split_go = (\_xs_1-> (\_match_2-> (\_last_3-> (let _3613 = _xs_1 in (if null (_3613::String) then (u (u list_cons _last_3) list_nil) else (let _3614 = (u (u string_starts_with _xs_1) _match_2) in (if _3614 then (let _rest_6=(u (u string_drop (u string_length _match_2)) _xs_1) in (u (u list_cons _last_3) (u (u (u string_split_go _rest_6) _match_2) ""))) else (let _next_6=(u (u string_cons (fromIntegral (fromEnum (head _3613 :: Char)) :: Word16)) string_nil) in (u (u (u string_split_go (tail _3613)) _match_2) (((_last_3::String) ++ _next_6)))))))))))
string_split = (\_xs_1-> (\_match_2-> (u (u (u string_split_go _xs_1) _match_2) "")))
fm_synth_files_of = (\_name_1-> (u list_reverse (u (u fm_synth_files_of_make (u (u string_split _name_1) ".")) "")))
fm_synth_load = (\_name_1-> (\_defs_2-> (u (u (u fm_synth_load_go _name_1) (u fm_synth_files_of _name_1)) _defs_2)))
fm_status_wait = (1,\t-> t)
fm_check = (\_v_1-> ())
fm_check_result = (\_value_2-> (\_errors_3-> (0,\t-> t _value_2 _errors_3)))
fm_error_undefined_reference = (\_origin_1-> (\_name_2-> (5,\t-> t _origin_1 _name_2)))
fm_error_waiting = (\_name_1-> (2,\t-> t _name_1))
fm_error_indirect = (\_name_1-> (3,\t-> t _name_1))
maybe_mapped = (\_m_2-> (\_f_4-> (let _3615 = _m_2 in (case _3615 of {(0,f) -> u f (maybe_none); (1,f) -> u f (\_3616-> (u maybe_some (u _f_4 _3616))); }))))
fm_mpath_o = (\_path_1-> (u (u maybe_mapped _path_1) fm_path_o))
fm_mpath_i = (\_path_1-> (u (u maybe_mapped _path_1) fm_path_i))
fm_error_patch = (\_path_1-> (\_term_2-> (4,\t-> t _path_1 _term_2)))
fm_mpath_to_bits = (\_path_1-> (let _3617 = _path_1 in (case _3617 of {(0,f) -> u f (bits_e); (1,f) -> u f (\_3618-> (u _3618 bits_e)); })))
fm_error_type_mismatch = (\_origin_1-> (\_expected_2-> (\_detected_3-> (\_context_4-> (0,\t-> t _origin_1 _expected_2 _detected_3 _context_4)))))
fm_error_show_goal = (\_name_1-> (\_dref_2-> (\_verb_3-> (\_goal_4-> (\_context_5-> (1,\t-> t _name_1 _dref_2 _verb_3 _goal_4 _context_5))))))
fm_term_normalize = (\_term_1-> (\_defs_2-> (let _3619 = (u (u fm_term_reduce _term_1) _defs_2) in (case _3619 of {(0,f) -> u f (\_3620 _3621-> (u (u fm_term_var _3620) _3621)); (1,f) -> u f (\_3622-> (u fm_term_ref _3622)); (2,f) -> u f (fm_term_typ); (3,f) -> u f (\_3623 _3624 _3625 _3626 _3627-> (u (u (u (u (u fm_term_all _3623) _3624) _3625) (u (u fm_term_normalize _3626) _defs_2)) (\_s_8-> (\_x_9-> (u (u fm_term_normalize (u (u _3627 _s_8) _x_9)) _defs_2))))); (4,f) -> u f (\_3628 _3629-> (u (u fm_term_lam _3628) (\_x_5-> (u (u fm_term_normalize (u _3629 _x_5)) _defs_2)))); (5,f) -> u f (\_3630 _3631-> (u (u fm_term_app (u (u fm_term_normalize _3630) _defs_2)) (u (u fm_term_normalize _3631) _defs_2))); (6,f) -> u f (\_3632 _3633 _3634-> (u (u (u fm_term_let _3632) (u (u fm_term_normalize _3633) _defs_2)) (\_x_6-> (u (u fm_term_normalize (u _3634 _x_6)) _defs_2)))); (7,f) -> u f (\_3635 _3636 _3637-> (u (u (u fm_term_def _3635) (u (u fm_term_normalize _3636) _defs_2)) (\_x_6-> (u (u fm_term_normalize (u _3637 _x_6)) _defs_2)))); (8,f) -> u f (\_3638 _3639 _3640-> (u (u (u fm_term_ann _3638) (u (u fm_term_normalize _3639) _defs_2)) (u (u fm_term_normalize _3640) _defs_2))); (9,f) -> u f (\_3641 _3642 _3643-> (u (u (u fm_term_gol _3641) _3642) _3643)); (10,f) -> u f (\_3644-> (u fm_term_hol _3644)); (11,f) -> u f (\_3645-> (u fm_term_nat _3645)); (12,f) -> u f (\_3646-> (u fm_term_chr _3646)); (13,f) -> u f (\_3647-> (u fm_term_str _3647)); (14,f) -> u f (\_3648 _3649 _3650 _3651 _3652 _3653-> _term_1); (15,f) -> u f (\_3654 _3655-> (u (u fm_term_normalize _3655) _defs_2)); }))))
list_tail = (\_xs_2-> (let _3656 = _xs_2 in (case _3656 of {(0,f) -> u f (list_nil); (1,f) -> u f (\_3657 _3658-> _3658); })))
fm_smartmotive_vals_cont = (\_expr_1-> (\_term_2-> (\_args_3-> (\_defs_4-> (let _3659 = (u (u fm_term_reduce _term_2) _defs_4) in (case _3659 of {(0,f) -> u f (\_3660 _3661-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (1,f) -> u f (\_3662-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (2,f) -> u f ((u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (3,f) -> u f (\_3663 _3664 _3665 _3666 _3667-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (4,f) -> u f (\_3668 _3669-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (5,f) -> u f (\_3670 _3671-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _3670) (u (u list_cons _3671) _args_3)) _defs_4)); (6,f) -> u f (\_3672 _3673 _3674-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (7,f) -> u f (\_3675 _3676 _3677-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (8,f) -> u f (\_3678 _3679 _3680-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (9,f) -> u f (\_3681 _3682 _3683-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (10,f) -> u f (\_3684-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (11,f) -> u f (\_3685-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (12,f) -> u f (\_3686-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (13,f) -> u f (\_3687-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (14,f) -> u f (\_3688 _3689 _3690 _3691 _3692 _3693-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (15,f) -> u f (\_3694 _3695-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); }))))))
fm_smartmotive_vals = (\_expr_1-> (\_type_2-> (\_defs_3-> (let _3696 = (u (u fm_term_reduce _type_2) _defs_3) in (case _3696 of {(0,f) -> u f (\_3697 _3698-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (1,f) -> u f (\_3699-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (2,f) -> u f ((u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (3,f) -> u f (\_3700 _3701 _3702 _3703 _3704-> (u (u (u fm_smartmotive_vals _expr_1) (u (u _3704 fm_term_typ) fm_term_typ)) _defs_3)); (4,f) -> u f (\_3705 _3706-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (5,f) -> u f (\_3707 _3708-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (6,f) -> u f (\_3709 _3710 _3711-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (7,f) -> u f (\_3712 _3713 _3714-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (8,f) -> u f (\_3715 _3716 _3717-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (9,f) -> u f (\_3718 _3719 _3720-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (10,f) -> u f (\_3721-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (11,f) -> u f (\_3722-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (12,f) -> u f (\_3723-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (13,f) -> u f (\_3724-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (14,f) -> u f (\_3725 _3726 _3727 _3728 _3729 _3730-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (15,f) -> u f (\_3731 _3732-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); })))))
fm_smartmotive_nams_cont = (\_name_1-> (\_term_2-> (\_binds_3-> (\_defs_4-> (let _3733 = (u (u fm_term_reduce _term_2) _defs_4) in (case _3733 of {(0,f) -> u f (\_3734 _3735-> (u (u list_cons _name_1) (u list_tail _binds_3))); (1,f) -> u f (\_3736-> (u (u list_cons _name_1) (u list_tail _binds_3))); (2,f) -> u f ((u (u list_cons _name_1) (u list_tail _binds_3))); (3,f) -> u f (\_3737 _3738 _3739 _3740 _3741-> (u (u (u (u fm_smartmotive_nams_cont _name_1) (u (u _3741 (u fm_term_ref _3738)) (u fm_term_ref _3739))) (u (u list_cons (u string_flatten (u (u list_cons _name_1) (u (u list_cons ".") (u (u list_cons _3739) list_nil))))) _binds_3)) _defs_4)); (4,f) -> u f (\_3742 _3743-> (u (u list_cons _name_1) (u list_tail _binds_3))); (5,f) -> u f (\_3744 _3745-> (u (u list_cons _name_1) (u list_tail _binds_3))); (6,f) -> u f (\_3746 _3747 _3748-> (u (u list_cons _name_1) (u list_tail _binds_3))); (7,f) -> u f (\_3749 _3750 _3751-> (u (u list_cons _name_1) (u list_tail _binds_3))); (8,f) -> u f (\_3752 _3753 _3754-> (u (u list_cons _name_1) (u list_tail _binds_3))); (9,f) -> u f (\_3755 _3756 _3757-> (u (u list_cons _name_1) (u list_tail _binds_3))); (10,f) -> u f (\_3758-> (u (u list_cons _name_1) (u list_tail _binds_3))); (11,f) -> u f (\_3759-> (u (u list_cons _name_1) (u list_tail _binds_3))); (12,f) -> u f (\_3760-> (u (u list_cons _name_1) (u list_tail _binds_3))); (13,f) -> u f (\_3761-> (u (u list_cons _name_1) (u list_tail _binds_3))); (14,f) -> u f (\_3762 _3763 _3764 _3765 _3766 _3767-> (u (u list_cons _name_1) (u list_tail _binds_3))); (15,f) -> u f (\_3768 _3769-> (u (u list_cons _name_1) (u list_tail _binds_3))); }))))))
fm_smartmotive_nams = (\_name_1-> (\_type_2-> (\_defs_3-> (let _3770 = (u (u fm_term_reduce _type_2) _defs_3) in (case _3770 of {(0,f) -> u f (\_3771 _3772-> list_nil); (1,f) -> u f (\_3773-> list_nil); (2,f) -> u f (list_nil); (3,f) -> u f (\_3774 _3775 _3776 _3777 _3778-> (u (u (u (u fm_smartmotive_nams_cont _name_1) _3777) list_nil) _defs_3)); (4,f) -> u f (\_3779 _3780-> list_nil); (5,f) -> u f (\_3781 _3782-> list_nil); (6,f) -> u f (\_3783 _3784 _3785-> list_nil); (7,f) -> u f (\_3786 _3787 _3788-> list_nil); (8,f) -> u f (\_3789 _3790 _3791-> list_nil); (9,f) -> u f (\_3792 _3793 _3794-> list_nil); (10,f) -> u f (\_3795-> list_nil); (11,f) -> u f (\_3796-> list_nil); (12,f) -> u f (\_3797-> list_nil); (13,f) -> u f (\_3798-> list_nil); (14,f) -> u f (\_3799 _3800 _3801 _3802 _3803 _3804-> list_nil); (15,f) -> u f (\_3805 _3806-> list_nil); })))))
list_zip = (\_as_3-> (\_bs_4-> (let _3807 = _as_3 in (case _3807 of {(0,f) -> u f (list_nil); (1,f) -> u f (\_3808 _3809-> (let _3810 = _bs_4 in (case _3810 of {(0,f) -> u f (list_nil); (1,f) -> u f (\_3811 _3812-> (u (u list_cons (u (u pair_new _3808) _3811)) (u (u list_zip _3809) _3812))); }))); }))))
nat_gte = (\a0-> \a1-> ((a0::Integer) >= a1))
nat_sub = (\a0-> \a1-> ((a0::Integer) - a1))
fm_term_serialize_name = (\_name_1-> (u fm_name_to_bits _name_1))
fm_term_serialize = (\_term_1-> (\_depth_2-> (\_init_3-> (\_diff_4-> (\_x_5-> (let _3813 = _term_1 in (case _3813 of {(0,f) -> u f (\_3814 _3815-> (let _3816 = (((_3815::Integer) >= _init_3)) in (if _3816 then (let _name_8=(u bits_concat (u nat_to_bits (u nat_pred (((_depth_2::Integer) - _3815))))) in (u bits_o (u bits_o (u bits_i (u _name_8 _x_5))))) else (let _name_8=(u bits_concat (u nat_to_bits _3815)) in (u bits_o (u bits_i (u bits_o (u _name_8 _x_5)))))))); (1,f) -> u f (\_3817-> (let _name_7=(u bits_concat (u fm_term_serialize_name _3817)) in (u bits_o (u bits_o (u bits_o (u _name_7 _x_5)))))); (2,f) -> u f ((u bits_o (u bits_i (u bits_i _x_5)))); (3,f) -> u f (\_3818 _3819 _3820 _3821 _3822-> (let _eras_11=(let _3823 = _3818 in (if _3823 then bits_i else bits_o)) in (let _self_12=(u bits_concat (u fm_name_to_bits _3819)) in (let _xtyp_13=(u (u (u (u fm_term_serialize _3821) _depth_2) _init_3) _diff_4) in (let _body_14=(u (u (u (u fm_term_serialize (u (u _3822 (u (u fm_term_var _3819) _depth_2)) (u (u fm_term_var _3820) (u nat_succ _depth_2)))) (u nat_succ (u nat_succ _depth_2))) _init_3) _diff_4) in (u bits_i (u bits_o (u bits_o (u _eras_11 (u _self_12 (u _xtyp_13 (u _body_14 _x_5)))))))))))); (4,f) -> u f (\_3824 _3825-> (let _body_8=(u (u (u (u fm_term_serialize (u _3825 (u (u fm_term_var _3824) _depth_2))) (u nat_succ _depth_2)) _init_3) _diff_4) in (u bits_i (u bits_o (u bits_i (u _body_8 _x_5)))))); (5,f) -> u f (\_3826 _3827-> (let _func_8=(u (u (u (u fm_term_serialize _3826) _depth_2) _init_3) _diff_4) in (let _argm_9=(u (u (u (u fm_term_serialize _3827) _depth_2) _init_3) _diff_4) in (u bits_i (u bits_i (u bits_o (u _func_8 (u _argm_9 _x_5)))))))); (6,f) -> u f (\_3828 _3829 _3830-> (let _expr_9=(u (u (u (u fm_term_serialize _3829) _depth_2) _init_3) _diff_4) in (let _body_10=(u (u (u (u fm_term_serialize (u _3830 (u (u fm_term_var _3828) _depth_2))) (u nat_succ _depth_2)) _init_3) _diff_4) in (u bits_i (u bits_i (u bits_i (u _expr_9 (u _body_10 _x_5)))))))); (7,f) -> u f (\_3831 _3832 _3833-> (u (u (u (u (u fm_term_serialize (u _3833 _3832)) _depth_2) _init_3) _diff_4) _x_5)); (8,f) -> u f (\_3834 _3835 _3836-> (u (u (u (u (u fm_term_serialize _3835) _depth_2) _init_3) _diff_4) _x_5)); (9,f) -> u f (\_3837 _3838 _3839-> (let _name_9=(u bits_concat (u fm_name_to_bits _3837)) in (u bits_o (u bits_o (u bits_o (u _name_9 _x_5)))))); (10,f) -> u f (\_3840-> _x_5); (11,f) -> u f (\_3841-> (u (u (u (u (u fm_term_serialize (u fm_term_unroll_nat _3841)) _depth_2) _init_3) _diff_4) _x_5)); (12,f) -> u f (\_3842-> (u (u (u (u (u fm_term_serialize (u fm_term_unroll_chr _3842)) _depth_2) _init_3) _diff_4) _x_5)); (13,f) -> u f (\_3843-> (u (u (u (u (u fm_term_serialize (u fm_term_unroll_str _3843)) _depth_2) _init_3) _diff_4) _x_5)); (14,f) -> u f (\_3844 _3845 _3846 _3847 _3848 _3849-> (u _diff_4 _x_5)); (15,f) -> u f (\_3850 _3851-> (u (u (u (u (u fm_term_serialize _3851) _depth_2) _init_3) _diff_4) _x_5)); })))))))
bits_eql = (\_a_1-> (\_b_2-> (let _3852 = _a_1 in (case _3852 of {(0,f) -> u f ((let _3853 = _b_2 in (case _3853 of {(0,f) -> u f (bool_true); (1,f) -> u f (\_3854-> bool_false); (2,f) -> u f (\_3855-> bool_false); }))); (1,f) -> u f (\_3856-> (let _3857 = _b_2 in (case _3857 of {(0,f) -> u f (bool_false); (1,f) -> u f (\_3858-> (u (u bits_eql _3856) _3858)); (2,f) -> u f (\_3859-> bool_false); }))); (2,f) -> u f (\_3860-> (let _3861 = _b_2 in (case _3861 of {(0,f) -> u f (bool_false); (1,f) -> u f (\_3862-> bool_false); (2,f) -> u f (\_3863-> (u (u bits_eql _3860) _3863)); }))); }))))
fm_term_identical = (\_a_1-> (\_b_2-> (\_lv_3-> (let _ah_4=(u (u (u (u (u fm_term_serialize _a_1) _lv_3) _lv_3) bits_o) bits_e) in (let _bh_5=(u (u (u (u (u fm_term_serialize _b_2) _lv_3) _lv_3) bits_i) bits_e) in (u (u bits_eql _ah_4) _bh_5))))))
fm_smartmotive_replace = (\_term_1-> (\_from_2-> (\_to_3-> (\_lv_4-> (let _3864 = (u (u (u fm_term_identical _term_1) _from_2) _lv_4) in (if _3864 then _to_3 else (let _3865 = _term_1 in (case _3865 of {(0,f) -> u f (\_3866 _3867-> (u (u fm_term_var _3866) _3867)); (1,f) -> u f (\_3868-> (u fm_term_ref _3868)); (2,f) -> u f (fm_term_typ); (3,f) -> u f (\_3869 _3870 _3871 _3872 _3873-> (let _xtyp_10=(u (u (u (u fm_smartmotive_replace _3872) _from_2) _to_3) _lv_4) in (let _body_11=(u (u _3873 (u fm_term_ref _3870)) (u fm_term_ref _3871)) in (let _body_12=(u (u (u (u fm_smartmotive_replace _body_11) _from_2) _to_3) (u nat_succ (u nat_succ _lv_4))) in (u (u (u (u (u fm_term_all _3869) _3870) _3871) _xtyp_10) (\_s_13-> (\_x_14-> _body_12))))))); (4,f) -> u f (\_3874 _3875-> (let _body_7=(u _3875 (u fm_term_ref _3874)) in (let _body_8=(u (u (u (u fm_smartmotive_replace _body_7) _from_2) _to_3) (u nat_succ _lv_4)) in (u (u fm_term_lam _3874) (\_x_9-> _body_8))))); (5,f) -> u f (\_3876 _3877-> (let _func_7=(u (u (u (u fm_smartmotive_replace _3876) _from_2) _to_3) _lv_4) in (let _argm_8=(u (u (u (u fm_smartmotive_replace _3877) _from_2) _to_3) _lv_4) in (u (u fm_term_app _func_7) _argm_8)))); (6,f) -> u f (\_3878 _3879 _3880-> (let _expr_8=(u (u (u (u fm_smartmotive_replace _3879) _from_2) _to_3) _lv_4) in (let _body_9=(u _3880 (u fm_term_ref _3878)) in (let _body_10=(u (u (u (u fm_smartmotive_replace _body_9) _from_2) _to_3) (u nat_succ _lv_4)) in (u (u (u fm_term_let _3878) _expr_8) (\_x_11-> _body_10)))))); (7,f) -> u f (\_3881 _3882 _3883-> (let _expr_8=(u (u (u (u fm_smartmotive_replace _3882) _from_2) _to_3) _lv_4) in (let _body_9=(u _3883 (u fm_term_ref _3881)) in (let _body_10=(u (u (u (u fm_smartmotive_replace _body_9) _from_2) _to_3) (u nat_succ _lv_4)) in (u (u (u fm_term_def _3881) _expr_8) (\_x_11-> _body_10)))))); (8,f) -> u f (\_3884 _3885 _3886-> (let _term_8=(u (u (u (u fm_smartmotive_replace _3885) _from_2) _to_3) _lv_4) in (let _type_9=(u (u (u (u fm_smartmotive_replace _3886) _from_2) _to_3) _lv_4) in (u (u (u fm_term_ann _3884) _term_8) _type_9)))); (9,f) -> u f (\_3887 _3888 _3889-> _term_1); (10,f) -> u f (\_3890-> _term_1); (11,f) -> u f (\_3891-> _term_1); (12,f) -> u f (\_3892-> _term_1); (13,f) -> u f (\_3893-> _term_1); (14,f) -> u f (\_3894 _3895 _3896 _3897 _3898 _3899-> _term_1); (15,f) -> u f (\_3900 _3901-> (u (u (u (u fm_smartmotive_replace _3901) _from_2) _to_3) _lv_4)); }))))))))
fm_smartmotive_make = (\_name_1-> (\_expr_2-> (\_type_3-> (\_moti_4-> (\_lv_5-> (\_defs_6-> (let _vals_7=(u (u (u fm_smartmotive_vals _expr_2) _type_3) _defs_6) in (let _nams_8=(u (u (u fm_smartmotive_nams _name_1) _type_3) _defs_6) in (let _subs_9=(u (u list_zip _nams_8) _vals_7) in (let _moti_10=(u (u (u list_fold _subs_9) _moti_4) (\_sub_10-> (\_moti_11-> (let _3902 = _sub_10 in (case _3902 of {(0,f) -> u f (\_3903 _3904-> (u (u (u (u fm_smartmotive_replace _moti_11) _3904) (u fm_term_ref _3903)) _lv_5)); }))))) in _moti_10))))))))))
fm_term_desugar_cse_motive = (\_wyth_1-> (\_moti_2-> (let _3905 = _wyth_1 in (case _3905 of {(0,f) -> u f (_moti_2); (1,f) -> u f (\_3906 _3907-> (let _3908 = _3906 in (case _3908 of {(0,f) -> u f (\_3909 _3910 _3911 _3912 _3913 _3914 _3915 _3916-> (u (u (u (u (u fm_term_all bool_false) "") _3912) _3914) (\_s_13-> (\_x_14-> (u (u fm_term_desugar_cse_motive _3907) _moti_2))))); }))); }))))
string_is_empty = (\_str_1-> (let _3917 = _str_1 in (if null (_3917::String) then bool_true else bool_false)))
fm_term_desugar_cse_argument = (\_name_1-> (\_wyth_2-> (\_type_3-> (\_body_4-> (\_defs_5-> (let _3918 = (u (u fm_term_reduce _type_3) _defs_5) in (case _3918 of {(0,f) -> u f (\_3919 _3920-> (let _3921 = _wyth_2 in (case _3921 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_3922 _3923-> (let _3924 = _3922 in (case _3924 of {(0,f) -> u f (\_3925 _3926 _3927 _3928 _3929 _3930 _3931 _3932-> (u (u fm_term_lam _3928) (\_x_18-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _3923) _type_3) _body_4) _defs_5)))); }))); }))); (1,f) -> u f (\_3933-> (let _3934 = _wyth_2 in (case _3934 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_3935 _3936-> (let _3937 = _3935 in (case _3937 of {(0,f) -> u f (\_3938 _3939 _3940 _3941 _3942 _3943 _3944 _3945-> (u (u fm_term_lam _3941) (\_x_17-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _3936) _type_3) _body_4) _defs_5)))); }))); }))); (2,f) -> u f ((let _3946 = _wyth_2 in (case _3946 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_3947 _3948-> (let _3949 = _3947 in (case _3949 of {(0,f) -> u f (\_3950 _3951 _3952 _3953 _3954 _3955 _3956 _3957-> (u (u fm_term_lam _3953) (\_x_16-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _3948) _type_3) _body_4) _defs_5)))); }))); }))); (3,f) -> u f (\_3958 _3959 _3960 _3961 _3962-> (u (u fm_term_lam (let _3963 = (u string_is_empty _3960) in (if _3963 then _name_1 else (u string_flatten (u (u list_cons _name_1) (u (u list_cons ".") (u (u list_cons _3960) list_nil))))))) (\_x_11-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _wyth_2) (u (u _3962 (u (u fm_term_var _3959) 0)) (u (u fm_term_var _3960) 0))) _body_4) _defs_5)))); (4,f) -> u f (\_3964 _3965-> (let _3966 = _wyth_2 in (case _3966 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_3967 _3968-> (let _3969 = _3967 in (case _3969 of {(0,f) -> u f (\_3970 _3971 _3972 _3973 _3974 _3975 _3976 _3977-> (u (u fm_term_lam _3973) (\_x_18-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _3968) _type_3) _body_4) _defs_5)))); }))); }))); (5,f) -> u f (\_3978 _3979-> (let _3980 = _wyth_2 in (case _3980 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_3981 _3982-> (let _3983 = _3981 in (case _3983 of {(0,f) -> u f (\_3984 _3985 _3986 _3987 _3988 _3989 _3990 _3991-> (u (u fm_term_lam _3987) (\_x_18-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _3982) _type_3) _body_4) _defs_5)))); }))); }))); (6,f) -> u f (\_3992 _3993 _3994-> (let _3995 = _wyth_2 in (case _3995 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_3996 _3997-> (let _3998 = _3996 in (case _3998 of {(0,f) -> u f (\_3999 _4000 _4001 _4002 _4003 _4004 _4005 _4006-> (u (u fm_term_lam _4002) (\_x_19-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _3997) _type_3) _body_4) _defs_5)))); }))); }))); (7,f) -> u f (\_4007 _4008 _4009-> (let _4010 = _wyth_2 in (case _4010 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_4011 _4012-> (let _4013 = _4011 in (case _4013 of {(0,f) -> u f (\_4014 _4015 _4016 _4017 _4018 _4019 _4020 _4021-> (u (u fm_term_lam _4017) (\_x_19-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _4012) _type_3) _body_4) _defs_5)))); }))); }))); (8,f) -> u f (\_4022 _4023 _4024-> (let _4025 = _wyth_2 in (case _4025 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_4026 _4027-> (let _4028 = _4026 in (case _4028 of {(0,f) -> u f (\_4029 _4030 _4031 _4032 _4033 _4034 _4035 _4036-> (u (u fm_term_lam _4032) (\_x_19-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _4027) _type_3) _body_4) _defs_5)))); }))); }))); (9,f) -> u f (\_4037 _4038 _4039-> (let _4040 = _wyth_2 in (case _4040 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_4041 _4042-> (let _4043 = _4041 in (case _4043 of {(0,f) -> u f (\_4044 _4045 _4046 _4047 _4048 _4049 _4050 _4051-> (u (u fm_term_lam _4047) (\_x_19-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _4042) _type_3) _body_4) _defs_5)))); }))); }))); (10,f) -> u f (\_4052-> (let _4053 = _wyth_2 in (case _4053 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_4054 _4055-> (let _4056 = _4054 in (case _4056 of {(0,f) -> u f (\_4057 _4058 _4059 _4060 _4061 _4062 _4063 _4064-> (u (u fm_term_lam _4060) (\_x_17-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _4055) _type_3) _body_4) _defs_5)))); }))); }))); (11,f) -> u f (\_4065-> (let _4066 = _wyth_2 in (case _4066 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_4067 _4068-> (let _4069 = _4067 in (case _4069 of {(0,f) -> u f (\_4070 _4071 _4072 _4073 _4074 _4075 _4076 _4077-> (u (u fm_term_lam _4073) (\_x_17-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _4068) _type_3) _body_4) _defs_5)))); }))); }))); (12,f) -> u f (\_4078-> (let _4079 = _wyth_2 in (case _4079 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_4080 _4081-> (let _4082 = _4080 in (case _4082 of {(0,f) -> u f (\_4083 _4084 _4085 _4086 _4087 _4088 _4089 _4090-> (u (u fm_term_lam _4086) (\_x_17-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _4081) _type_3) _body_4) _defs_5)))); }))); }))); (13,f) -> u f (\_4091-> (let _4092 = _wyth_2 in (case _4092 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_4093 _4094-> (let _4095 = _4093 in (case _4095 of {(0,f) -> u f (\_4096 _4097 _4098 _4099 _4100 _4101 _4102 _4103-> (u (u fm_term_lam _4099) (\_x_17-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _4094) _type_3) _body_4) _defs_5)))); }))); }))); (14,f) -> u f (\_4104 _4105 _4106 _4107 _4108 _4109-> (let _4110 = _wyth_2 in (case _4110 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_4111 _4112-> (let _4113 = _4111 in (case _4113 of {(0,f) -> u f (\_4114 _4115 _4116 _4117 _4118 _4119 _4120 _4121-> (u (u fm_term_lam _4117) (\_x_22-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _4112) _type_3) _body_4) _defs_5)))); }))); }))); (15,f) -> u f (\_4122 _4123-> (let _4124 = _wyth_2 in (case _4124 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_4125 _4126-> (let _4127 = _4125 in (case _4127 of {(0,f) -> u f (\_4128 _4129 _4130 _4131 _4132 _4133 _4134 _4135-> (u (u fm_term_lam _4131) (\_x_18-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _4126) _type_3) _body_4) _defs_5)))); }))); }))); })))))))
maybe_or = (\_a_2-> (\_b_3-> (let _4136 = _a_2 in (case _4136 of {(0,f) -> u f (_b_3); (1,f) -> u f (\_4137-> (u maybe_some _4137)); }))))
fm_term_desugar_cse_cases = (\_expr_1-> (\_name_2-> (\_wyth_3-> (\_cses_4-> (\_type_5-> (\_defs_6-> (\_ctxt_7-> (let _4138 = (u (u fm_term_reduce _type_5) _defs_6) in (case _4138 of {(0,f) -> u f (\_4139 _4140-> (let _expr_10=(u (u (u list_for _wyth_3) _expr_1) (\_defn_10-> (\_expr_11-> (u (u fm_term_app _expr_11) (let _4141 = _defn_10 in (case _4141 of {(0,f) -> u f (\_4142 _4143 _4144 _4145 _4146 _4147 _4148 _4149-> _4146); })))))) in _expr_10)); (1,f) -> u f (\_4150-> (let _expr_9=(u (u (u list_for _wyth_3) _expr_1) (\_defn_9-> (\_expr_10-> (u (u fm_term_app _expr_10) (let _4151 = _defn_9 in (case _4151 of {(0,f) -> u f (\_4152 _4153 _4154 _4155 _4156 _4157 _4158 _4159-> _4156); })))))) in _expr_9)); (2,f) -> u f ((let _expr_8=(u (u (u list_for _wyth_3) _expr_1) (\_defn_8-> (\_expr_9-> (u (u fm_term_app _expr_9) (let _4160 = _defn_8 in (case _4160 of {(0,f) -> u f (\_4161 _4162 _4163 _4164 _4165 _4166 _4167 _4168-> _4165); })))))) in _expr_8)); (3,f) -> u f (\_4169 _4170 _4171 _4172 _4173-> (let _got_13=(u (u maybe_or (u (u fm_get _4171) _cses_4)) (u (u fm_get "_") _cses_4)) in (let _4174 = _got_13 in (case _4174 of {(0,f) -> u f ((let _expr_14=(u (u (u list_for _wyth_3) _expr_1) (\_defn_14-> (\_expr_15-> (let _4175 = _defn_14 in (case _4175 of {(0,f) -> u f (\_4176 _4177 _4178 _4179 _4180 _4181 _4182 _4183-> (u (u fm_term_app _expr_15) _4180)); }))))) in _expr_14)); (1,f) -> u f (\_4184-> (let _argm_15=(u (u (u (u (u fm_term_desugar_cse_argument _name_2) _wyth_3) _4172) _4184) _defs_6) in (let _expr_16=(u (u fm_term_app _expr_1) _argm_15) in (let _type_17=(u (u _4173 (u (u fm_term_var _4170) 0)) (u (u fm_term_var _4171) 0)) in (u (u (u (u (u (u (u fm_term_desugar_cse_cases _expr_16) _name_2) _wyth_3) _cses_4) _type_17) _defs_6) _ctxt_7))))); })))); (4,f) -> u f (\_4185 _4186-> (let _expr_10=(u (u (u list_for _wyth_3) _expr_1) (\_defn_10-> (\_expr_11-> (u (u fm_term_app _expr_11) (let _4187 = _defn_10 in (case _4187 of {(0,f) -> u f (\_4188 _4189 _4190 _4191 _4192 _4193 _4194 _4195-> _4192); })))))) in _expr_10)); (5,f) -> u f (\_4196 _4197-> (let _expr_10=(u (u (u list_for _wyth_3) _expr_1) (\_defn_10-> (\_expr_11-> (u (u fm_term_app _expr_11) (let _4198 = _defn_10 in (case _4198 of {(0,f) -> u f (\_4199 _4200 _4201 _4202 _4203 _4204 _4205 _4206-> _4203); })))))) in _expr_10)); (6,f) -> u f (\_4207 _4208 _4209-> (let _expr_11=(u (u (u list_for _wyth_3) _expr_1) (\_defn_11-> (\_expr_12-> (u (u fm_term_app _expr_12) (let _4210 = _defn_11 in (case _4210 of {(0,f) -> u f (\_4211 _4212 _4213 _4214 _4215 _4216 _4217 _4218-> _4215); })))))) in _expr_11)); (7,f) -> u f (\_4219 _4220 _4221-> (let _expr_11=(u (u (u list_for _wyth_3) _expr_1) (\_defn_11-> (\_expr_12-> (u (u fm_term_app _expr_12) (let _4222 = _defn_11 in (case _4222 of {(0,f) -> u f (\_4223 _4224 _4225 _4226 _4227 _4228 _4229 _4230-> _4227); })))))) in _expr_11)); (8,f) -> u f (\_4231 _4232 _4233-> (let _expr_11=(u (u (u list_for _wyth_3) _expr_1) (\_defn_11-> (\_expr_12-> (u (u fm_term_app _expr_12) (let _4234 = _defn_11 in (case _4234 of {(0,f) -> u f (\_4235 _4236 _4237 _4238 _4239 _4240 _4241 _4242-> _4239); })))))) in _expr_11)); (9,f) -> u f (\_4243 _4244 _4245-> (let _expr_11=(u (u (u list_for _wyth_3) _expr_1) (\_defn_11-> (\_expr_12-> (u (u fm_term_app _expr_12) (let _4246 = _defn_11 in (case _4246 of {(0,f) -> u f (\_4247 _4248 _4249 _4250 _4251 _4252 _4253 _4254-> _4251); })))))) in _expr_11)); (10,f) -> u f (\_4255-> (let _expr_9=(u (u (u list_for _wyth_3) _expr_1) (\_defn_9-> (\_expr_10-> (u (u fm_term_app _expr_10) (let _4256 = _defn_9 in (case _4256 of {(0,f) -> u f (\_4257 _4258 _4259 _4260 _4261 _4262 _4263 _4264-> _4261); })))))) in _expr_9)); (11,f) -> u f (\_4265-> (let _expr_9=(u (u (u list_for _wyth_3) _expr_1) (\_defn_9-> (\_expr_10-> (u (u fm_term_app _expr_10) (let _4266 = _defn_9 in (case _4266 of {(0,f) -> u f (\_4267 _4268 _4269 _4270 _4271 _4272 _4273 _4274-> _4271); })))))) in _expr_9)); (12,f) -> u f (\_4275-> (let _expr_9=(u (u (u list_for _wyth_3) _expr_1) (\_defn_9-> (\_expr_10-> (u (u fm_term_app _expr_10) (let _4276 = _defn_9 in (case _4276 of {(0,f) -> u f (\_4277 _4278 _4279 _4280 _4281 _4282 _4283 _4284-> _4281); })))))) in _expr_9)); (13,f) -> u f (\_4285-> (let _expr_9=(u (u (u list_for _wyth_3) _expr_1) (\_defn_9-> (\_expr_10-> (u (u fm_term_app _expr_10) (let _4286 = _defn_9 in (case _4286 of {(0,f) -> u f (\_4287 _4288 _4289 _4290 _4291 _4292 _4293 _4294-> _4291); })))))) in _expr_9)); (14,f) -> u f (\_4295 _4296 _4297 _4298 _4299 _4300-> (let _expr_14=(u (u (u list_for _wyth_3) _expr_1) (\_defn_14-> (\_expr_15-> (u (u fm_term_app _expr_15) (let _4301 = _defn_14 in (case _4301 of {(0,f) -> u f (\_4302 _4303 _4304 _4305 _4306 _4307 _4308 _4309-> _4306); })))))) in _expr_14)); (15,f) -> u f (\_4310 _4311-> (let _expr_10=(u (u (u list_for _wyth_3) _expr_1) (\_defn_10-> (\_expr_11-> (u (u fm_term_app _expr_11) (let _4312 = _defn_10 in (case _4312 of {(0,f) -> u f (\_4313 _4314 _4315 _4316 _4317 _4318 _4319 _4320-> _4317); })))))) in _expr_10)); })))))))))
fm_term_desugar_cse = (\_expr_1-> (\_name_2-> (\_wyth_3-> (\_cses_4-> (\_moti_5-> (\_type_6-> (\_defs_7-> (\_ctxt_8-> (let _4321 = (u (u fm_term_reduce _type_6) _defs_7) in (case _4321 of {(0,f) -> u f (\_4322 _4323-> maybe_none); (1,f) -> u f (\_4324-> maybe_none); (2,f) -> u f (maybe_none); (3,f) -> u f (\_4325 _4326 _4327 _4328 _4329-> (let _moti_14=(u (u fm_term_desugar_cse_motive _wyth_3) _moti_5) in (let _argm_15=(u (u (u (u (u fm_term_desugar_cse_argument _name_2) list_nil) _4328) _moti_14) _defs_7) in (let _expr_16=(u (u fm_term_app _expr_1) _argm_15) in (let _type_17=(u (u _4329 (u (u fm_term_var _4326) 0)) (u (u fm_term_var _4327) 0)) in (u maybe_some (u (u (u (u (u (u (u fm_term_desugar_cse_cases _expr_16) _name_2) _wyth_3) _cses_4) _type_17) _defs_7) _ctxt_8))))))); (4,f) -> u f (\_4330 _4331-> maybe_none); (5,f) -> u f (\_4332 _4333-> maybe_none); (6,f) -> u f (\_4334 _4335 _4336-> maybe_none); (7,f) -> u f (\_4337 _4338 _4339-> maybe_none); (8,f) -> u f (\_4340 _4341 _4342-> maybe_none); (9,f) -> u f (\_4343 _4344 _4345-> maybe_none); (10,f) -> u f (\_4346-> maybe_none); (11,f) -> u f (\_4347-> maybe_none); (12,f) -> u f (\_4348-> maybe_none); (13,f) -> u f (\_4349-> maybe_none); (14,f) -> u f (\_4350 _4351 _4352 _4353 _4354 _4355-> maybe_none); (15,f) -> u f (\_4356 _4357-> maybe_none); }))))))))))
fm_error_cant_infer = (\_origin_1-> (\_term_2-> (\_context_3-> (6,\t-> t _origin_1 _term_2 _context_3))))
set_has = (\_bits_1-> (\_set_2-> (let _4358 = (u (u map_get _bits_1) _set_2) in (case _4358 of {(0,f) -> u f (bool_false); (1,f) -> u f (\_4359-> bool_true); }))))
bool_or = (\a0-> \a1-> (a0 || a1))
fm_term_has_holes = (\_term_1-> (let _4360 = _term_1 in (case _4360 of {(0,f) -> u f (\_4361 _4362-> bool_false); (1,f) -> u f (\_4363-> bool_false); (2,f) -> u f (bool_false); (3,f) -> u f (\_4364 _4365 _4366 _4367 _4368-> (((u fm_term_has_holes _4367) || (u fm_term_has_holes (u (u _4368 fm_term_typ) fm_term_typ))))); (4,f) -> u f (\_4369 _4370-> (u fm_term_has_holes (u _4370 fm_term_typ))); (5,f) -> u f (\_4371 _4372-> (((u fm_term_has_holes _4371) || (u fm_term_has_holes _4372)))); (6,f) -> u f (\_4373 _4374 _4375-> (((u fm_term_has_holes _4374) || (u fm_term_has_holes (u _4375 fm_term_typ))))); (7,f) -> u f (\_4376 _4377 _4378-> (((u fm_term_has_holes _4377) || (u fm_term_has_holes (u _4378 fm_term_typ))))); (8,f) -> u f (\_4379 _4380 _4381-> (((u fm_term_has_holes _4380) || (u fm_term_has_holes _4381)))); (9,f) -> u f (\_4382 _4383 _4384-> bool_false); (10,f) -> u f (\_4385-> bool_true); (11,f) -> u f (\_4386-> bool_false); (12,f) -> u f (\_4387-> bool_false); (13,f) -> u f (\_4388-> bool_false); (14,f) -> u f (\_4389 _4390 _4391 _4392 _4393 _4394-> bool_false); (15,f) -> u f (\_4395 _4396-> (u fm_term_has_holes _4396)); })))
fm_term_equal_hole = (\_path_1-> (\_term_2-> (let _4397 = _term_2 in (case _4397 of {(0,f) -> u f (\_4398 _4399-> (let _4400 = (u fm_term_has_holes _term_2) in (if _4400 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); (1,f) -> u f (\_4401-> (let _4402 = (u fm_term_has_holes _term_2) in (if _4402 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); (2,f) -> u f ((let _4403 = (u fm_term_has_holes _term_2) in (if _4403 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); (3,f) -> u f (\_4404 _4405 _4406 _4407 _4408-> (let _4409 = (u fm_term_has_holes _term_2) in (if _4409 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); (4,f) -> u f (\_4410 _4411-> (let _4412 = (u fm_term_has_holes _term_2) in (if _4412 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); (5,f) -> u f (\_4413 _4414-> (let _4415 = (u fm_term_has_holes _term_2) in (if _4415 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); (6,f) -> u f (\_4416 _4417 _4418-> (let _4419 = (u fm_term_has_holes _term_2) in (if _4419 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); (7,f) -> u f (\_4420 _4421 _4422-> (let _4423 = (u fm_term_has_holes _term_2) in (if _4423 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); (8,f) -> u f (\_4424 _4425 _4426-> (let _4427 = (u fm_term_has_holes _term_2) in (if _4427 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); (9,f) -> u f (\_4428 _4429 _4430-> (let _4431 = (u fm_term_has_holes _term_2) in (if _4431 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); (10,f) -> u f (\_4432-> (u (u fm_check_result (u maybe_some bool_true)) list_nil)); (11,f) -> u f (\_4433-> (let _4434 = (u fm_term_has_holes _term_2) in (if _4434 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); (12,f) -> u f (\_4435-> (let _4436 = (u fm_term_has_holes _term_2) in (if _4436 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); (13,f) -> u f (\_4437-> (let _4438 = (u fm_term_has_holes _term_2) in (if _4438 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); (14,f) -> u f (\_4439 _4440 _4441 _4442 _4443 _4444-> (let _4445 = (u fm_term_has_holes _term_2) in (if _4445 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); (15,f) -> u f (\_4446 _4447-> (let _4448 = (u fm_term_has_holes _term_2) in (if _4448 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); }))))
fm_term_equal_extra_holes = (\_a_1-> (\_b_2-> (let _4449 = _a_1 in (case _4449 of {(0,f) -> u f (\_4450 _4451-> (let _4452 = _b_2 in (case _4452 of {(0,f) -> u f (\_4453 _4454-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (1,f) -> u f (\_4455-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some unit_new)) list_nil)); (3,f) -> u f (\_4456 _4457 _4458 _4459 _4460-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (4,f) -> u f (\_4461 _4462-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (5,f) -> u f (\_4463 _4464-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (6,f) -> u f (\_4465 _4466 _4467-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (7,f) -> u f (\_4468 _4469 _4470-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (8,f) -> u f (\_4471 _4472 _4473-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (9,f) -> u f (\_4474 _4475 _4476-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (10,f) -> u f (\_4477-> (let _4478 = (u (u fm_term_equal_hole _4477) _a_1) in (case _4478 of {(0,f) -> u f (\_4479 _4480-> (let _4481 = _4479 in (case _4481 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _4480)); (1,f) -> u f (\_4482-> (let _4483 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _4483 of {(0,f) -> u f (\_4484 _4485-> (u (u fm_check_result _4484) (u (u list_concat _4480) _4485))); }))); }))); }))); (11,f) -> u f (\_4486-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (12,f) -> u f (\_4487-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (13,f) -> u f (\_4488-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (14,f) -> u f (\_4489 _4490 _4491 _4492 _4493 _4494-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (15,f) -> u f (\_4495 _4496-> (u (u fm_term_equal_extra_holes _a_1) _4496)); }))); (1,f) -> u f (\_4497-> (let _4498 = _b_2 in (case _4498 of {(0,f) -> u f (\_4499 _4500-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (1,f) -> u f (\_4501-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some unit_new)) list_nil)); (3,f) -> u f (\_4502 _4503 _4504 _4505 _4506-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (4,f) -> u f (\_4507 _4508-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (5,f) -> u f (\_4509 _4510-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (6,f) -> u f (\_4511 _4512 _4513-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (7,f) -> u f (\_4514 _4515 _4516-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (8,f) -> u f (\_4517 _4518 _4519-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (9,f) -> u f (\_4520 _4521 _4522-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (10,f) -> u f (\_4523-> (let _4524 = (u (u fm_term_equal_hole _4523) _a_1) in (case _4524 of {(0,f) -> u f (\_4525 _4526-> (let _4527 = _4525 in (case _4527 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _4526)); (1,f) -> u f (\_4528-> (let _4529 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _4529 of {(0,f) -> u f (\_4530 _4531-> (u (u fm_check_result _4530) (u (u list_concat _4526) _4531))); }))); }))); }))); (11,f) -> u f (\_4532-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (12,f) -> u f (\_4533-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (13,f) -> u f (\_4534-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (14,f) -> u f (\_4535 _4536 _4537 _4538 _4539 _4540-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (15,f) -> u f (\_4541 _4542-> (u (u fm_term_equal_extra_holes _a_1) _4542)); }))); (2,f) -> u f ((let _4543 = _b_2 in (case _4543 of {(0,f) -> u f (\_4544 _4545-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (1,f) -> u f (\_4546-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some unit_new)) list_nil)); (3,f) -> u f (\_4547 _4548 _4549 _4550 _4551-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (4,f) -> u f (\_4552 _4553-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (5,f) -> u f (\_4554 _4555-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (6,f) -> u f (\_4556 _4557 _4558-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (7,f) -> u f (\_4559 _4560 _4561-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (8,f) -> u f (\_4562 _4563 _4564-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (9,f) -> u f (\_4565 _4566 _4567-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (10,f) -> u f (\_4568-> (let _4569 = (u (u fm_term_equal_hole _4568) _a_1) in (case _4569 of {(0,f) -> u f (\_4570 _4571-> (let _4572 = _4570 in (case _4572 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _4571)); (1,f) -> u f (\_4573-> (let _4574 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _4574 of {(0,f) -> u f (\_4575 _4576-> (u (u fm_check_result _4575) (u (u list_concat _4571) _4576))); }))); }))); }))); (11,f) -> u f (\_4577-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (12,f) -> u f (\_4578-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (13,f) -> u f (\_4579-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (14,f) -> u f (\_4580 _4581 _4582 _4583 _4584 _4585-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (15,f) -> u f (\_4586 _4587-> (u (u fm_term_equal_extra_holes _a_1) _4587)); }))); (3,f) -> u f (\_4588 _4589 _4590 _4591 _4592-> (let _4593 = _b_2 in (case _4593 of {(0,f) -> u f (\_4594 _4595-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (1,f) -> u f (\_4596-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some unit_new)) list_nil)); (3,f) -> u f (\_4597 _4598 _4599 _4600 _4601-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (4,f) -> u f (\_4602 _4603-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (5,f) -> u f (\_4604 _4605-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (6,f) -> u f (\_4606 _4607 _4608-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (7,f) -> u f (\_4609 _4610 _4611-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (8,f) -> u f (\_4612 _4613 _4614-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (9,f) -> u f (\_4615 _4616 _4617-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (10,f) -> u f (\_4618-> (let _4619 = (u (u fm_term_equal_hole _4618) _a_1) in (case _4619 of {(0,f) -> u f (\_4620 _4621-> (let _4622 = _4620 in (case _4622 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _4621)); (1,f) -> u f (\_4623-> (let _4624 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _4624 of {(0,f) -> u f (\_4625 _4626-> (u (u fm_check_result _4625) (u (u list_concat _4621) _4626))); }))); }))); }))); (11,f) -> u f (\_4627-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (12,f) -> u f (\_4628-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (13,f) -> u f (\_4629-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (14,f) -> u f (\_4630 _4631 _4632 _4633 _4634 _4635-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (15,f) -> u f (\_4636 _4637-> (u (u fm_term_equal_extra_holes _a_1) _4637)); }))); (4,f) -> u f (\_4638 _4639-> (let _4640 = _b_2 in (case _4640 of {(0,f) -> u f (\_4641 _4642-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (1,f) -> u f (\_4643-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some unit_new)) list_nil)); (3,f) -> u f (\_4644 _4645 _4646 _4647 _4648-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (4,f) -> u f (\_4649 _4650-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (5,f) -> u f (\_4651 _4652-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (6,f) -> u f (\_4653 _4654 _4655-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (7,f) -> u f (\_4656 _4657 _4658-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (8,f) -> u f (\_4659 _4660 _4661-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (9,f) -> u f (\_4662 _4663 _4664-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (10,f) -> u f (\_4665-> (let _4666 = (u (u fm_term_equal_hole _4665) _a_1) in (case _4666 of {(0,f) -> u f (\_4667 _4668-> (let _4669 = _4667 in (case _4669 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _4668)); (1,f) -> u f (\_4670-> (let _4671 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _4671 of {(0,f) -> u f (\_4672 _4673-> (u (u fm_check_result _4672) (u (u list_concat _4668) _4673))); }))); }))); }))); (11,f) -> u f (\_4674-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (12,f) -> u f (\_4675-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (13,f) -> u f (\_4676-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (14,f) -> u f (\_4677 _4678 _4679 _4680 _4681 _4682-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (15,f) -> u f (\_4683 _4684-> (u (u fm_term_equal_extra_holes _a_1) _4684)); }))); (5,f) -> u f (\_4685 _4686-> (let _4687 = _b_2 in (case _4687 of {(0,f) -> u f (\_4688 _4689-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (1,f) -> u f (\_4690-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some unit_new)) list_nil)); (3,f) -> u f (\_4691 _4692 _4693 _4694 _4695-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (4,f) -> u f (\_4696 _4697-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (5,f) -> u f (\_4698 _4699-> (let _4700 = (u (u fm_term_equal_extra_holes _4685) _4698) in (case _4700 of {(0,f) -> u f (\_4701 _4702-> (let _4703 = _4701 in (case _4703 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _4702)); (1,f) -> u f (\_4704-> (let _4705 = (u (u fm_term_equal_extra_holes _4686) _4699) in (case _4705 of {(0,f) -> u f (\_4706 _4707-> (u (u fm_check_result _4706) (u (u list_concat _4702) _4707))); }))); }))); }))); (6,f) -> u f (\_4708 _4709 _4710-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (7,f) -> u f (\_4711 _4712 _4713-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (8,f) -> u f (\_4714 _4715 _4716-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (9,f) -> u f (\_4717 _4718 _4719-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (10,f) -> u f (\_4720-> (let _4721 = (u (u fm_term_equal_hole _4720) _a_1) in (case _4721 of {(0,f) -> u f (\_4722 _4723-> (let _4724 = _4722 in (case _4724 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _4723)); (1,f) -> u f (\_4725-> (let _4726 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _4726 of {(0,f) -> u f (\_4727 _4728-> (u (u fm_check_result _4727) (u (u list_concat _4723) _4728))); }))); }))); }))); (11,f) -> u f (\_4729-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (12,f) -> u f (\_4730-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (13,f) -> u f (\_4731-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (14,f) -> u f (\_4732 _4733 _4734 _4735 _4736 _4737-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (15,f) -> u f (\_4738 _4739-> (u (u fm_term_equal_extra_holes _a_1) _4739)); }))); (6,f) -> u f (\_4740 _4741 _4742-> (let _4743 = _b_2 in (case _4743 of {(0,f) -> u f (\_4744 _4745-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (1,f) -> u f (\_4746-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some unit_new)) list_nil)); (3,f) -> u f (\_4747 _4748 _4749 _4750 _4751-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (4,f) -> u f (\_4752 _4753-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (5,f) -> u f (\_4754 _4755-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (6,f) -> u f (\_4756 _4757 _4758-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (7,f) -> u f (\_4759 _4760 _4761-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (8,f) -> u f (\_4762 _4763 _4764-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (9,f) -> u f (\_4765 _4766 _4767-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (10,f) -> u f (\_4768-> (let _4769 = (u (u fm_term_equal_hole _4768) _a_1) in (case _4769 of {(0,f) -> u f (\_4770 _4771-> (let _4772 = _4770 in (case _4772 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _4771)); (1,f) -> u f (\_4773-> (let _4774 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _4774 of {(0,f) -> u f (\_4775 _4776-> (u (u fm_check_result _4775) (u (u list_concat _4771) _4776))); }))); }))); }))); (11,f) -> u f (\_4777-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (12,f) -> u f (\_4778-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (13,f) -> u f (\_4779-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (14,f) -> u f (\_4780 _4781 _4782 _4783 _4784 _4785-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (15,f) -> u f (\_4786 _4787-> (u (u fm_term_equal_extra_holes _a_1) _4787)); }))); (7,f) -> u f (\_4788 _4789 _4790-> (let _4791 = _b_2 in (case _4791 of {(0,f) -> u f (\_4792 _4793-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (1,f) -> u f (\_4794-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some unit_new)) list_nil)); (3,f) -> u f (\_4795 _4796 _4797 _4798 _4799-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (4,f) -> u f (\_4800 _4801-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (5,f) -> u f (\_4802 _4803-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (6,f) -> u f (\_4804 _4805 _4806-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (7,f) -> u f (\_4807 _4808 _4809-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (8,f) -> u f (\_4810 _4811 _4812-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (9,f) -> u f (\_4813 _4814 _4815-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (10,f) -> u f (\_4816-> (let _4817 = (u (u fm_term_equal_hole _4816) _a_1) in (case _4817 of {(0,f) -> u f (\_4818 _4819-> (let _4820 = _4818 in (case _4820 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _4819)); (1,f) -> u f (\_4821-> (let _4822 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _4822 of {(0,f) -> u f (\_4823 _4824-> (u (u fm_check_result _4823) (u (u list_concat _4819) _4824))); }))); }))); }))); (11,f) -> u f (\_4825-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (12,f) -> u f (\_4826-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (13,f) -> u f (\_4827-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (14,f) -> u f (\_4828 _4829 _4830 _4831 _4832 _4833-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (15,f) -> u f (\_4834 _4835-> (u (u fm_term_equal_extra_holes _a_1) _4835)); }))); (8,f) -> u f (\_4836 _4837 _4838-> (let _4839 = _b_2 in (case _4839 of {(0,f) -> u f (\_4840 _4841-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (1,f) -> u f (\_4842-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some unit_new)) list_nil)); (3,f) -> u f (\_4843 _4844 _4845 _4846 _4847-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (4,f) -> u f (\_4848 _4849-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (5,f) -> u f (\_4850 _4851-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (6,f) -> u f (\_4852 _4853 _4854-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (7,f) -> u f (\_4855 _4856 _4857-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (8,f) -> u f (\_4858 _4859 _4860-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (9,f) -> u f (\_4861 _4862 _4863-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (10,f) -> u f (\_4864-> (let _4865 = (u (u fm_term_equal_hole _4864) _a_1) in (case _4865 of {(0,f) -> u f (\_4866 _4867-> (let _4868 = _4866 in (case _4868 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _4867)); (1,f) -> u f (\_4869-> (let _4870 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _4870 of {(0,f) -> u f (\_4871 _4872-> (u (u fm_check_result _4871) (u (u list_concat _4867) _4872))); }))); }))); }))); (11,f) -> u f (\_4873-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (12,f) -> u f (\_4874-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (13,f) -> u f (\_4875-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (14,f) -> u f (\_4876 _4877 _4878 _4879 _4880 _4881-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (15,f) -> u f (\_4882 _4883-> (u (u fm_term_equal_extra_holes _a_1) _4883)); }))); (9,f) -> u f (\_4884 _4885 _4886-> (let _4887 = _b_2 in (case _4887 of {(0,f) -> u f (\_4888 _4889-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (1,f) -> u f (\_4890-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some unit_new)) list_nil)); (3,f) -> u f (\_4891 _4892 _4893 _4894 _4895-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (4,f) -> u f (\_4896 _4897-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (5,f) -> u f (\_4898 _4899-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (6,f) -> u f (\_4900 _4901 _4902-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (7,f) -> u f (\_4903 _4904 _4905-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (8,f) -> u f (\_4906 _4907 _4908-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (9,f) -> u f (\_4909 _4910 _4911-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (10,f) -> u f (\_4912-> (let _4913 = (u (u fm_term_equal_hole _4912) _a_1) in (case _4913 of {(0,f) -> u f (\_4914 _4915-> (let _4916 = _4914 in (case _4916 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _4915)); (1,f) -> u f (\_4917-> (let _4918 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _4918 of {(0,f) -> u f (\_4919 _4920-> (u (u fm_check_result _4919) (u (u list_concat _4915) _4920))); }))); }))); }))); (11,f) -> u f (\_4921-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (12,f) -> u f (\_4922-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (13,f) -> u f (\_4923-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (14,f) -> u f (\_4924 _4925 _4926 _4927 _4928 _4929-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (15,f) -> u f (\_4930 _4931-> (u (u fm_term_equal_extra_holes _a_1) _4931)); }))); (10,f) -> u f (\_4932-> (let _4933 = (u (u fm_term_equal_hole _4932) _b_2) in (case _4933 of {(0,f) -> u f (\_4934 _4935-> (let _4936 = _4934 in (case _4936 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _4935)); (1,f) -> u f (\_4937-> (let _4938 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _4938 of {(0,f) -> u f (\_4939 _4940-> (u (u fm_check_result _4939) (u (u list_concat _4935) _4940))); }))); }))); }))); (11,f) -> u f (\_4941-> (let _4942 = _b_2 in (case _4942 of {(0,f) -> u f (\_4943 _4944-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (1,f) -> u f (\_4945-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some unit_new)) list_nil)); (3,f) -> u f (\_4946 _4947 _4948 _4949 _4950-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (4,f) -> u f (\_4951 _4952-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (5,f) -> u f (\_4953 _4954-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (6,f) -> u f (\_4955 _4956 _4957-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (7,f) -> u f (\_4958 _4959 _4960-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (8,f) -> u f (\_4961 _4962 _4963-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (9,f) -> u f (\_4964 _4965 _4966-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (10,f) -> u f (\_4967-> (let _4968 = (u (u fm_term_equal_hole _4967) _a_1) in (case _4968 of {(0,f) -> u f (\_4969 _4970-> (let _4971 = _4969 in (case _4971 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _4970)); (1,f) -> u f (\_4972-> (let _4973 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _4973 of {(0,f) -> u f (\_4974 _4975-> (u (u fm_check_result _4974) (u (u list_concat _4970) _4975))); }))); }))); }))); (11,f) -> u f (\_4976-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (12,f) -> u f (\_4977-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (13,f) -> u f (\_4978-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (14,f) -> u f (\_4979 _4980 _4981 _4982 _4983 _4984-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (15,f) -> u f (\_4985 _4986-> (u (u fm_term_equal_extra_holes _a_1) _4986)); }))); (12,f) -> u f (\_4987-> (let _4988 = _b_2 in (case _4988 of {(0,f) -> u f (\_4989 _4990-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (1,f) -> u f (\_4991-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some unit_new)) list_nil)); (3,f) -> u f (\_4992 _4993 _4994 _4995 _4996-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (4,f) -> u f (\_4997 _4998-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (5,f) -> u f (\_4999 _5000-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (6,f) -> u f (\_5001 _5002 _5003-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (7,f) -> u f (\_5004 _5005 _5006-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (8,f) -> u f (\_5007 _5008 _5009-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (9,f) -> u f (\_5010 _5011 _5012-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (10,f) -> u f (\_5013-> (let _5014 = (u (u fm_term_equal_hole _5013) _a_1) in (case _5014 of {(0,f) -> u f (\_5015 _5016-> (let _5017 = _5015 in (case _5017 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5016)); (1,f) -> u f (\_5018-> (let _5019 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _5019 of {(0,f) -> u f (\_5020 _5021-> (u (u fm_check_result _5020) (u (u list_concat _5016) _5021))); }))); }))); }))); (11,f) -> u f (\_5022-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (12,f) -> u f (\_5023-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (13,f) -> u f (\_5024-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (14,f) -> u f (\_5025 _5026 _5027 _5028 _5029 _5030-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (15,f) -> u f (\_5031 _5032-> (u (u fm_term_equal_extra_holes _a_1) _5032)); }))); (13,f) -> u f (\_5033-> (let _5034 = _b_2 in (case _5034 of {(0,f) -> u f (\_5035 _5036-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (1,f) -> u f (\_5037-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some unit_new)) list_nil)); (3,f) -> u f (\_5038 _5039 _5040 _5041 _5042-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (4,f) -> u f (\_5043 _5044-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (5,f) -> u f (\_5045 _5046-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (6,f) -> u f (\_5047 _5048 _5049-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (7,f) -> u f (\_5050 _5051 _5052-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (8,f) -> u f (\_5053 _5054 _5055-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (9,f) -> u f (\_5056 _5057 _5058-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (10,f) -> u f (\_5059-> (let _5060 = (u (u fm_term_equal_hole _5059) _a_1) in (case _5060 of {(0,f) -> u f (\_5061 _5062-> (let _5063 = _5061 in (case _5063 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5062)); (1,f) -> u f (\_5064-> (let _5065 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _5065 of {(0,f) -> u f (\_5066 _5067-> (u (u fm_check_result _5066) (u (u list_concat _5062) _5067))); }))); }))); }))); (11,f) -> u f (\_5068-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (12,f) -> u f (\_5069-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (13,f) -> u f (\_5070-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (14,f) -> u f (\_5071 _5072 _5073 _5074 _5075 _5076-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (15,f) -> u f (\_5077 _5078-> (u (u fm_term_equal_extra_holes _a_1) _5078)); }))); (14,f) -> u f (\_5079 _5080 _5081 _5082 _5083 _5084-> (let _5085 = _b_2 in (case _5085 of {(0,f) -> u f (\_5086 _5087-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (1,f) -> u f (\_5088-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some unit_new)) list_nil)); (3,f) -> u f (\_5089 _5090 _5091 _5092 _5093-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (4,f) -> u f (\_5094 _5095-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (5,f) -> u f (\_5096 _5097-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (6,f) -> u f (\_5098 _5099 _5100-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (7,f) -> u f (\_5101 _5102 _5103-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (8,f) -> u f (\_5104 _5105 _5106-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (9,f) -> u f (\_5107 _5108 _5109-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (10,f) -> u f (\_5110-> (let _5111 = (u (u fm_term_equal_hole _5110) _a_1) in (case _5111 of {(0,f) -> u f (\_5112 _5113-> (let _5114 = _5112 in (case _5114 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5113)); (1,f) -> u f (\_5115-> (let _5116 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _5116 of {(0,f) -> u f (\_5117 _5118-> (u (u fm_check_result _5117) (u (u list_concat _5113) _5118))); }))); }))); }))); (11,f) -> u f (\_5119-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (12,f) -> u f (\_5120-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (13,f) -> u f (\_5121-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (14,f) -> u f (\_5122 _5123 _5124 _5125 _5126 _5127-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (15,f) -> u f (\_5128 _5129-> (u (u fm_term_equal_extra_holes _a_1) _5129)); }))); (15,f) -> u f (\_5130 _5131-> (u (u fm_term_equal_extra_holes _5131) _b_2)); }))))
set_set = (\_bits_1-> (\_set_2-> (u (u (u map_set _bits_1) unit_new) _set_2)))
bool_eql = (\_a_1-> (\_b_2-> (let _5132 = _a_1 in (if _5132 then _b_2 else ((not _b_2))))))
fm_term_equal = (\_a_1-> (\_b_2-> (\_defs_3-> (\_lv_4-> (\_seen_5-> (let _ah_6=(u (u (u (u (u fm_term_serialize (u (u fm_term_reduce _a_1) map_new)) _lv_4) _lv_4) bits_o) bits_e) in (let _bh_7=(u (u (u (u (u fm_term_serialize (u (u fm_term_reduce _b_2) map_new)) _lv_4) _lv_4) bits_i) bits_e) in (let _5133 = (u (u bits_eql _ah_6) _bh_7) in (if _5133 then (u (u fm_check_result (u maybe_some bool_true)) list_nil) else (let _a1_8=(u (u fm_term_reduce _a_1) _defs_3) in (let _b1_9=(u (u fm_term_reduce _b_2) _defs_3) in (let _ah_10=(u (u (u (u (u fm_term_serialize _a1_8) _lv_4) _lv_4) bits_o) bits_e) in (let _bh_11=(u (u (u (u (u fm_term_serialize _b1_9) _lv_4) _lv_4) bits_i) bits_e) in (let _5134 = (u (u bits_eql _ah_10) _bh_11) in (if _5134 then (u (u fm_check_result (u maybe_some bool_true)) list_nil) else (let _id_12=(u (u bits_concat _ah_10) _bh_11) in (let _5135 = (u (u set_has _id_12) _seen_5) in (if _5135 then (let _5136 = (u (u fm_term_equal_extra_holes _a_1) _b_2) in (case _5136 of {(0,f) -> u f (\_5137 _5138-> (let _5139 = _5137 in (case _5139 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5138)); (1,f) -> u f (\_5140-> (let _5141 = (u (u fm_check_result (u maybe_some bool_true)) list_nil) in (case _5141 of {(0,f) -> u f (\_5142 _5143-> (u (u fm_check_result _5142) (u (u list_concat _5138) _5143))); }))); }))); })) else (let _5144 = _a1_8 in (case _5144 of {(0,f) -> u f (\_5145 _5146-> (let _5147 = _b1_9 in (case _5147 of {(0,f) -> u f (\_5148 _5149-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5150-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5151 _5152 _5153 _5154 _5155-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (4,f) -> u f (\_5156 _5157-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (5,f) -> u f (\_5158 _5159-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (6,f) -> u f (\_5160 _5161 _5162-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (7,f) -> u f (\_5163 _5164 _5165-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5166 _5167 _5168-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5169 _5170 _5171-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5172-> (u (u fm_term_equal_hole _5172) _a_1)); (11,f) -> u f (\_5173-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5174-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5175-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5176 _5177 _5178 _5179 _5180 _5181-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5182 _5183-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); (1,f) -> u f (\_5184-> (let _5185 = _b1_9 in (case _5185 of {(0,f) -> u f (\_5186 _5187-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5188-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5189 _5190 _5191 _5192 _5193-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (4,f) -> u f (\_5194 _5195-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (5,f) -> u f (\_5196 _5197-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (6,f) -> u f (\_5198 _5199 _5200-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (7,f) -> u f (\_5201 _5202 _5203-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5204 _5205 _5206-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5207 _5208 _5209-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5210-> (u (u fm_term_equal_hole _5210) _a_1)); (11,f) -> u f (\_5211-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5212-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5213-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5214 _5215 _5216 _5217 _5218 _5219-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5220 _5221-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); (2,f) -> u f ((let _5222 = _b1_9 in (case _5222 of {(0,f) -> u f (\_5223 _5224-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5225-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5226 _5227 _5228 _5229 _5230-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (4,f) -> u f (\_5231 _5232-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (5,f) -> u f (\_5233 _5234-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (6,f) -> u f (\_5235 _5236 _5237-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (7,f) -> u f (\_5238 _5239 _5240-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5241 _5242 _5243-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5244 _5245 _5246-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5247-> (u (u fm_term_equal_hole _5247) _a_1)); (11,f) -> u f (\_5248-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5249-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5250-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5251 _5252 _5253 _5254 _5255 _5256-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5257 _5258-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); (3,f) -> u f (\_5259 _5260 _5261 _5262 _5263-> (let _5264 = _b1_9 in (case _5264 of {(0,f) -> u f (\_5265 _5266-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5267-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5268 _5269 _5270 _5271 _5272-> (let _seen_23=(u (u set_set _id_12) _seen_5) in (let _a1_body_24=(u (u _5263 (u (u fm_term_var _5260) _lv_4)) (u (u fm_term_var _5261) (u nat_succ _lv_4))) in (let _b1_body_25=(u (u _5272 (u (u fm_term_var _5269) _lv_4)) (u (u fm_term_var _5270) (u nat_succ _lv_4))) in (let _eq_self_26=(((_5260::String) == _5269)) in (let _eq_eras_27=(u (u bool_eql _5259) _5268) in (let _5273 = ((_eq_self_26 && _eq_eras_27)) in (if _5273 then (let _5274 = (u (u (u (u (u fm_term_equal _5262) _5271) _defs_3) _lv_4) _seen_23) in (case _5274 of {(0,f) -> u f (\_5275 _5276-> (let _5277 = _5275 in (case _5277 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5276)); (1,f) -> u f (\_5278-> (let _5279 = (let _5280 = (u (u (u (u (u fm_term_equal _a1_body_24) _b1_body_25) _defs_3) (u nat_succ (u nat_succ _lv_4))) _seen_23) in (case _5280 of {(0,f) -> u f (\_5281 _5282-> (let _5283 = _5281 in (case _5283 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5282)); (1,f) -> u f (\_5284-> (let _5285 = (u (u fm_check_result (u maybe_some ((_5278 && _5284)))) list_nil) in (case _5285 of {(0,f) -> u f (\_5286 _5287-> (u (u fm_check_result _5286) (u (u list_concat _5282) _5287))); }))); }))); })) in (case _5279 of {(0,f) -> u f (\_5288 _5289-> (u (u fm_check_result _5288) (u (u list_concat _5276) _5289))); }))); }))); })) else (u (u fm_check_result (u maybe_some bool_false)) list_nil))))))))); (4,f) -> u f (\_5290 _5291-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (5,f) -> u f (\_5292 _5293-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (6,f) -> u f (\_5294 _5295 _5296-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (7,f) -> u f (\_5297 _5298 _5299-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5300 _5301 _5302-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5303 _5304 _5305-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5306-> (u (u fm_term_equal_hole _5306) _a_1)); (11,f) -> u f (\_5307-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5308-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5309-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5310 _5311 _5312 _5313 _5314 _5315-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5316 _5317-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); (4,f) -> u f (\_5318 _5319-> (let _5320 = _b1_9 in (case _5320 of {(0,f) -> u f (\_5321 _5322-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5323-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5324 _5325 _5326 _5327 _5328-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (4,f) -> u f (\_5329 _5330-> (let _seen_17=(u (u set_set _id_12) _seen_5) in (let _a1_body_18=(u _5319 (u (u fm_term_var _5318) _lv_4)) in (let _b1_body_19=(u _5330 (u (u fm_term_var _5329) _lv_4)) in (let _5331 = (u (u (u (u (u fm_term_equal _a1_body_18) _b1_body_19) _defs_3) (u nat_succ _lv_4)) _seen_17) in (case _5331 of {(0,f) -> u f (\_5332 _5333-> (let _5334 = _5332 in (case _5334 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5333)); (1,f) -> u f (\_5335-> (let _5336 = (u (u fm_check_result (u maybe_some _5335)) list_nil) in (case _5336 of {(0,f) -> u f (\_5337 _5338-> (u (u fm_check_result _5337) (u (u list_concat _5333) _5338))); }))); }))); })))))); (5,f) -> u f (\_5339 _5340-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (6,f) -> u f (\_5341 _5342 _5343-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (7,f) -> u f (\_5344 _5345 _5346-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5347 _5348 _5349-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5350 _5351 _5352-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5353-> (u (u fm_term_equal_hole _5353) _a_1)); (11,f) -> u f (\_5354-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5355-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5356-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5357 _5358 _5359 _5360 _5361 _5362-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5363 _5364-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); (5,f) -> u f (\_5365 _5366-> (let _5367 = _b1_9 in (case _5367 of {(0,f) -> u f (\_5368 _5369-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5370-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5371 _5372 _5373 _5374 _5375-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (4,f) -> u f (\_5376 _5377-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (5,f) -> u f (\_5378 _5379-> (let _seen_17=(u (u set_set _id_12) _seen_5) in (let _5380 = (u (u (u (u (u fm_term_equal _5365) _5378) _defs_3) _lv_4) _seen_17) in (case _5380 of {(0,f) -> u f (\_5381 _5382-> (let _5383 = _5381 in (case _5383 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5382)); (1,f) -> u f (\_5384-> (let _5385 = (let _5386 = (u (u (u (u (u fm_term_equal _5366) _5379) _defs_3) _lv_4) _seen_17) in (case _5386 of {(0,f) -> u f (\_5387 _5388-> (let _5389 = _5387 in (case _5389 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5388)); (1,f) -> u f (\_5390-> (let _5391 = (u (u fm_check_result (u maybe_some ((_5384 && _5390)))) list_nil) in (case _5391 of {(0,f) -> u f (\_5392 _5393-> (u (u fm_check_result _5392) (u (u list_concat _5388) _5393))); }))); }))); })) in (case _5385 of {(0,f) -> u f (\_5394 _5395-> (u (u fm_check_result _5394) (u (u list_concat _5382) _5395))); }))); }))); })))); (6,f) -> u f (\_5396 _5397 _5398-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (7,f) -> u f (\_5399 _5400 _5401-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5402 _5403 _5404-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5405 _5406 _5407-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5408-> (u (u fm_term_equal_hole _5408) _a_1)); (11,f) -> u f (\_5409-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5410-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5411-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5412 _5413 _5414 _5415 _5416 _5417-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5418 _5419-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); (6,f) -> u f (\_5420 _5421 _5422-> (let _5423 = _b1_9 in (case _5423 of {(0,f) -> u f (\_5424 _5425-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5426-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5427 _5428 _5429 _5430 _5431-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (4,f) -> u f (\_5432 _5433-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (5,f) -> u f (\_5434 _5435-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (6,f) -> u f (\_5436 _5437 _5438-> (let _seen_19=(u (u set_set _id_12) _seen_5) in (let _a1_body_20=(u _5422 (u (u fm_term_var _5420) _lv_4)) in (let _b1_body_21=(u _5438 (u (u fm_term_var _5436) _lv_4)) in (let _5439 = (u (u (u (u (u fm_term_equal _5421) _5437) _defs_3) _lv_4) _seen_19) in (case _5439 of {(0,f) -> u f (\_5440 _5441-> (let _5442 = _5440 in (case _5442 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5441)); (1,f) -> u f (\_5443-> (let _5444 = (let _5445 = (u (u (u (u (u fm_term_equal _a1_body_20) _b1_body_21) _defs_3) (u nat_succ _lv_4)) _seen_19) in (case _5445 of {(0,f) -> u f (\_5446 _5447-> (let _5448 = _5446 in (case _5448 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5447)); (1,f) -> u f (\_5449-> (let _5450 = (u (u fm_check_result (u maybe_some ((_5443 && _5449)))) list_nil) in (case _5450 of {(0,f) -> u f (\_5451 _5452-> (u (u fm_check_result _5451) (u (u list_concat _5447) _5452))); }))); }))); })) in (case _5444 of {(0,f) -> u f (\_5453 _5454-> (u (u fm_check_result _5453) (u (u list_concat _5441) _5454))); }))); }))); })))))); (7,f) -> u f (\_5455 _5456 _5457-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5458 _5459 _5460-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5461 _5462 _5463-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5464-> (u (u fm_term_equal_hole _5464) _a_1)); (11,f) -> u f (\_5465-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5466-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5467-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5468 _5469 _5470 _5471 _5472 _5473-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5474 _5475-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); (7,f) -> u f (\_5476 _5477 _5478-> (let _5479 = _b1_9 in (case _5479 of {(0,f) -> u f (\_5480 _5481-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5482-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5483 _5484 _5485 _5486 _5487-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (4,f) -> u f (\_5488 _5489-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (5,f) -> u f (\_5490 _5491-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (6,f) -> u f (\_5492 _5493 _5494-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (7,f) -> u f (\_5495 _5496 _5497-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5498 _5499 _5500-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5501 _5502 _5503-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5504-> (u (u fm_term_equal_hole _5504) _a_1)); (11,f) -> u f (\_5505-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5506-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5507-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5508 _5509 _5510 _5511 _5512 _5513-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5514 _5515-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); (8,f) -> u f (\_5516 _5517 _5518-> (let _5519 = _b1_9 in (case _5519 of {(0,f) -> u f (\_5520 _5521-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5522-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5523 _5524 _5525 _5526 _5527-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (4,f) -> u f (\_5528 _5529-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (5,f) -> u f (\_5530 _5531-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (6,f) -> u f (\_5532 _5533 _5534-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (7,f) -> u f (\_5535 _5536 _5537-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5538 _5539 _5540-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5541 _5542 _5543-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5544-> (u (u fm_term_equal_hole _5544) _a_1)); (11,f) -> u f (\_5545-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5546-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5547-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5548 _5549 _5550 _5551 _5552 _5553-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5554 _5555-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); (9,f) -> u f (\_5556 _5557 _5558-> (let _5559 = _b1_9 in (case _5559 of {(0,f) -> u f (\_5560 _5561-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5562-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5563 _5564 _5565 _5566 _5567-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (4,f) -> u f (\_5568 _5569-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (5,f) -> u f (\_5570 _5571-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (6,f) -> u f (\_5572 _5573 _5574-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (7,f) -> u f (\_5575 _5576 _5577-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5578 _5579 _5580-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5581 _5582 _5583-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5584-> (u (u fm_term_equal_hole _5584) _a_1)); (11,f) -> u f (\_5585-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5586-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5587-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5588 _5589 _5590 _5591 _5592 _5593-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5594 _5595-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); (10,f) -> u f (\_5596-> (u (u fm_term_equal_hole _5596) _b_2)); (11,f) -> u f (\_5597-> (let _5598 = _b1_9 in (case _5598 of {(0,f) -> u f (\_5599 _5600-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5601-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5602 _5603 _5604 _5605 _5606-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (4,f) -> u f (\_5607 _5608-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (5,f) -> u f (\_5609 _5610-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (6,f) -> u f (\_5611 _5612 _5613-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (7,f) -> u f (\_5614 _5615 _5616-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5617 _5618 _5619-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5620 _5621 _5622-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5623-> (u (u fm_term_equal_hole _5623) _a_1)); (11,f) -> u f (\_5624-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5625-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5626-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5627 _5628 _5629 _5630 _5631 _5632-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5633 _5634-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); (12,f) -> u f (\_5635-> (let _5636 = _b1_9 in (case _5636 of {(0,f) -> u f (\_5637 _5638-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5639-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5640 _5641 _5642 _5643 _5644-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (4,f) -> u f (\_5645 _5646-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (5,f) -> u f (\_5647 _5648-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (6,f) -> u f (\_5649 _5650 _5651-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (7,f) -> u f (\_5652 _5653 _5654-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5655 _5656 _5657-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5658 _5659 _5660-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5661-> (u (u fm_term_equal_hole _5661) _a_1)); (11,f) -> u f (\_5662-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5663-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5664-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5665 _5666 _5667 _5668 _5669 _5670-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5671 _5672-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); (13,f) -> u f (\_5673-> (let _5674 = _b1_9 in (case _5674 of {(0,f) -> u f (\_5675 _5676-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5677-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5678 _5679 _5680 _5681 _5682-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (4,f) -> u f (\_5683 _5684-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (5,f) -> u f (\_5685 _5686-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (6,f) -> u f (\_5687 _5688 _5689-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (7,f) -> u f (\_5690 _5691 _5692-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5693 _5694 _5695-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5696 _5697 _5698-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5699-> (u (u fm_term_equal_hole _5699) _a_1)); (11,f) -> u f (\_5700-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5701-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5702-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5703 _5704 _5705 _5706 _5707 _5708-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5709 _5710-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); (14,f) -> u f (\_5711 _5712 _5713 _5714 _5715 _5716-> (let _5717 = _b1_9 in (case _5717 of {(0,f) -> u f (\_5718 _5719-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5720-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5721 _5722 _5723 _5724 _5725-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (4,f) -> u f (\_5726 _5727-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (5,f) -> u f (\_5728 _5729-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (6,f) -> u f (\_5730 _5731 _5732-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (7,f) -> u f (\_5733 _5734 _5735-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5736 _5737 _5738-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5739 _5740 _5741-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5742-> (u (u fm_term_equal_hole _5742) _a_1)); (11,f) -> u f (\_5743-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5744-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5745-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5746 _5747 _5748 _5749 _5750 _5751-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5752 _5753-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); (15,f) -> u f (\_5754 _5755-> (let _5756 = _b1_9 in (case _5756 of {(0,f) -> u f (\_5757 _5758-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5759-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5760 _5761 _5762 _5763 _5764-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (4,f) -> u f (\_5765 _5766-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (5,f) -> u f (\_5767 _5768-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (6,f) -> u f (\_5769 _5770 _5771-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (7,f) -> u f (\_5772 _5773 _5774-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5775 _5776 _5777-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5778 _5779 _5780-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5781-> (u (u fm_term_equal_hole _5781) _a_1)); (11,f) -> u f (\_5782-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5783-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5784-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5785 _5786 _5787 _5788 _5789 _5790-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5791 _5792-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); }))))))))))))))))))))
set_new = map_new
fm_term_check = (\_term_1-> (\_type_2-> (\_defs_3-> (\_ctx_4-> (\_path_5-> (\_orig_6-> (let _5793 = (let _5794 = _term_1 in (case _5794 of {(0,f) -> u f (\_5795 _5796-> (let _5797 = (u (u list_at_last _5796) _ctx_4) in (case _5797 of {(0,f) -> u f ((u (u fm_check_result _type_2) (u (u list_cons (u (u fm_error_undefined_reference _orig_6) _5795)) list_nil))); (1,f) -> u f (\_5798-> (u (u fm_check_result (u maybe_some (let _5799 = _5798 in (case _5799 of {(0,f) -> u f (\_5800 _5801-> _5801); })))) list_nil)); }))); (1,f) -> u f (\_5802-> (let _5803 = (u (u fm_get _5802) _defs_3) in (case _5803 of {(0,f) -> u f ((u (u fm_check_result _type_2) (u (u list_cons (u (u fm_error_undefined_reference _orig_6) _5802)) list_nil))); (1,f) -> u f (\_5804-> (let _5805 = _5804 in (case _5805 of {(0,f) -> u f (\_5806 _5807 _5808 _5809 _5810 _5811 _5812 _5813-> (let _ref_name_17=_5809 in (let _ref_type_18=_5811 in (let _ref_term_19=_5810 in (let _ref_stat_20=_5813 in (let _5814 = _ref_stat_20 in (case _5814 of {(0,f) -> u f ((u (u fm_check_result (u maybe_some _ref_type_18)) (u (u list_cons (u fm_error_waiting _ref_name_17)) list_nil))); (1,f) -> u f ((u (u fm_check_result (u maybe_some _ref_type_18)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some _ref_type_18)) list_nil)); (3,f) -> u f (\_5815-> (u (u fm_check_result (u maybe_some _ref_type_18)) (u (u list_cons (u fm_error_indirect _ref_name_17)) list_nil))); }))))))); }))); }))); (2,f) -> u f ((u (u fm_check_result (u maybe_some fm_term_typ)) list_nil)); (3,f) -> u f (\_5816 _5817 _5818 _5819 _5820-> (let _ctx_size_12=(u list_length _ctx_4) in (let _self_var_13=(u (u fm_term_var _5817) _ctx_size_12) in (let _body_var_14=(u (u fm_term_var _5818) (u nat_succ _ctx_size_12)) in (let _body_ctx_15=(u (u list_cons (u (u pair_new _5818) _5819)) (u (u list_cons (u (u pair_new _5817) _term_1)) _ctx_4)) in (let _5821 = (u (u (u (u (u (u fm_term_check _5819) (u maybe_some fm_term_typ)) _defs_3) _ctx_4) (u fm_mpath_o _path_5)) _orig_6) in (case _5821 of {(0,f) -> u f (\_5822 _5823-> (let _5824 = _5822 in (case _5824 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5823)); (1,f) -> u f (\_5825-> (let _5826 = (let _5827 = (u (u (u (u (u (u fm_term_check (u (u _5820 _self_var_13) _body_var_14)) (u maybe_some fm_term_typ)) _defs_3) _body_ctx_15) (u fm_mpath_i _path_5)) _orig_6) in (case _5827 of {(0,f) -> u f (\_5828 _5829-> (let _5830 = _5828 in (case _5830 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5829)); (1,f) -> u f (\_5831-> (let _5832 = (u (u fm_check_result (u maybe_some fm_term_typ)) list_nil) in (case _5832 of {(0,f) -> u f (\_5833 _5834-> (u (u fm_check_result _5833) (u (u list_concat _5829) _5834))); }))); }))); })) in (case _5826 of {(0,f) -> u f (\_5835 _5836-> (u (u fm_check_result _5835) (u (u list_concat _5823) _5836))); }))); }))); }))))))); (4,f) -> u f (\_5837 _5838-> (let _5839 = _type_2 in (case _5839 of {(0,f) -> u f ((let _lam_type_9=(u fm_term_hol bits_e) in (let _lam_term_10=(u (u (u fm_term_ann bool_false) _term_1) _lam_type_9) in (u (u fm_check_result _type_2) (u (u list_cons (u (u fm_error_patch (u fm_mpath_to_bits _path_5)) _lam_term_10)) list_nil))))); (1,f) -> u f (\_5840-> (let _typv_10=(u (u fm_term_reduce _5840) _defs_3) in (let _5841 = _typv_10 in (case _5841 of {(0,f) -> u f (\_5842 _5843-> (let _expected_13=(u either_left "(function type)") in (let _detected_14=(u either_right _5840) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_13) _detected_14) _ctx_4)) list_nil))))); (1,f) -> u f (\_5844-> (let _expected_12=(u either_left "(function type)") in (let _detected_13=(u either_right _5840) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_12) _detected_13) _ctx_4)) list_nil))))); (2,f) -> u f ((let _expected_11=(u either_left "(function type)") in (let _detected_12=(u either_right _5840) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_11) _detected_12) _ctx_4)) list_nil))))); (3,f) -> u f (\_5845 _5846 _5847 _5848 _5849-> (let _ctx_size_16=(u list_length _ctx_4) in (let _self_var_17=_term_1 in (let _body_var_18=(u (u fm_term_var _5837) _ctx_size_16) in (let _body_typ_19=(u (u _5849 _self_var_17) _body_var_18) in (let _body_ctx_20=(u (u list_cons (u (u pair_new _5837) _5848)) _ctx_4) in (let _5850 = (u (u (u (u (u (u fm_term_check (u _5838 _body_var_18)) (u maybe_some _body_typ_19)) _defs_3) _body_ctx_20) (u fm_mpath_o _path_5)) _orig_6) in (case _5850 of {(0,f) -> u f (\_5851 _5852-> (let _5853 = _5851 in (case _5853 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5852)); (1,f) -> u f (\_5854-> (let _5855 = (u (u fm_check_result (u maybe_some _5840)) list_nil) in (case _5855 of {(0,f) -> u f (\_5856 _5857-> (u (u fm_check_result _5856) (u (u list_concat _5852) _5857))); }))); }))); })))))))); (4,f) -> u f (\_5858 _5859-> (let _expected_13=(u either_left "(function type)") in (let _detected_14=(u either_right _5840) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_13) _detected_14) _ctx_4)) list_nil))))); (5,f) -> u f (\_5860 _5861-> (let _expected_13=(u either_left "(function type)") in (let _detected_14=(u either_right _5840) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_13) _detected_14) _ctx_4)) list_nil))))); (6,f) -> u f (\_5862 _5863 _5864-> (let _expected_14=(u either_left "(function type)") in (let _detected_15=(u either_right _5840) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_14) _detected_15) _ctx_4)) list_nil))))); (7,f) -> u f (\_5865 _5866 _5867-> (let _expected_14=(u either_left "(function type)") in (let _detected_15=(u either_right _5840) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_14) _detected_15) _ctx_4)) list_nil))))); (8,f) -> u f (\_5868 _5869 _5870-> (let _expected_14=(u either_left "(function type)") in (let _detected_15=(u either_right _5840) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_14) _detected_15) _ctx_4)) list_nil))))); (9,f) -> u f (\_5871 _5872 _5873-> (let _expected_14=(u either_left "(function type)") in (let _detected_15=(u either_right _5840) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_14) _detected_15) _ctx_4)) list_nil))))); (10,f) -> u f (\_5874-> (let _expected_12=(u either_left "(function type)") in (let _detected_13=(u either_right _5840) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_12) _detected_13) _ctx_4)) list_nil))))); (11,f) -> u f (\_5875-> (let _expected_12=(u either_left "(function type)") in (let _detected_13=(u either_right _5840) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_12) _detected_13) _ctx_4)) list_nil))))); (12,f) -> u f (\_5876-> (let _expected_12=(u either_left "(function type)") in (let _detected_13=(u either_right _5840) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_12) _detected_13) _ctx_4)) list_nil))))); (13,f) -> u f (\_5877-> (let _expected_12=(u either_left "(function type)") in (let _detected_13=(u either_right _5840) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_12) _detected_13) _ctx_4)) list_nil))))); (14,f) -> u f (\_5878 _5879 _5880 _5881 _5882 _5883-> (let _expected_17=(u either_left "(function type)") in (let _detected_18=(u either_right _5840) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_17) _detected_18) _ctx_4)) list_nil))))); (15,f) -> u f (\_5884 _5885-> (let _expected_13=(u either_left "(function type)") in (let _detected_14=(u either_right _5840) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_13) _detected_14) _ctx_4)) list_nil))))); })))); }))); (5,f) -> u f (\_5886 _5887-> (let _5888 = (u (u (u (u (u (u fm_term_check _5886) maybe_none) _defs_3) _ctx_4) (u fm_mpath_o _path_5)) _orig_6) in (case _5888 of {(0,f) -> u f (\_5889 _5890-> (let _5891 = _5889 in (case _5891 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5890)); (1,f) -> u f (\_5892-> (let _func_typ_12=(u (u fm_term_reduce _5892) _defs_3) in (let _5893 = (let _5894 = _func_typ_12 in (case _5894 of {(0,f) -> u f (\_5895 _5896-> (let _expected_15=(u either_left "(function type)") in (let _detected_16=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_15) _detected_16) _ctx_4)) list_nil))))); (1,f) -> u f (\_5897-> (let _expected_14=(u either_left "(function type)") in (let _detected_15=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_14) _detected_15) _ctx_4)) list_nil))))); (2,f) -> u f ((let _expected_13=(u either_left "(function type)") in (let _detected_14=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_13) _detected_14) _ctx_4)) list_nil))))); (3,f) -> u f (\_5898 _5899 _5900 _5901 _5902-> (let _5903 = (u (u (u (u (u (u fm_term_check _5887) (u maybe_some _5901)) _defs_3) _ctx_4) (u fm_mpath_i _path_5)) _orig_6) in (case _5903 of {(0,f) -> u f (\_5904 _5905-> (let _5906 = _5904 in (case _5906 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5905)); (1,f) -> u f (\_5907-> (let _5908 = (u (u fm_check_result (u maybe_some (u (u _5902 _5886) _5887))) list_nil) in (case _5908 of {(0,f) -> u f (\_5909 _5910-> (u (u fm_check_result _5909) (u (u list_concat _5905) _5910))); }))); }))); }))); (4,f) -> u f (\_5911 _5912-> (let _expected_15=(u either_left "(function type)") in (let _detected_16=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_15) _detected_16) _ctx_4)) list_nil))))); (5,f) -> u f (\_5913 _5914-> (let _expected_15=(u either_left "(function type)") in (let _detected_16=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_15) _detected_16) _ctx_4)) list_nil))))); (6,f) -> u f (\_5915 _5916 _5917-> (let _expected_16=(u either_left "(function type)") in (let _detected_17=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_16) _detected_17) _ctx_4)) list_nil))))); (7,f) -> u f (\_5918 _5919 _5920-> (let _expected_16=(u either_left "(function type)") in (let _detected_17=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_16) _detected_17) _ctx_4)) list_nil))))); (8,f) -> u f (\_5921 _5922 _5923-> (let _expected_16=(u either_left "(function type)") in (let _detected_17=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_16) _detected_17) _ctx_4)) list_nil))))); (9,f) -> u f (\_5924 _5925 _5926-> (let _expected_16=(u either_left "(function type)") in (let _detected_17=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_16) _detected_17) _ctx_4)) list_nil))))); (10,f) -> u f (\_5927-> (let _expected_14=(u either_left "(function type)") in (let _detected_15=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_14) _detected_15) _ctx_4)) list_nil))))); (11,f) -> u f (\_5928-> (let _expected_14=(u either_left "(function type)") in (let _detected_15=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_14) _detected_15) _ctx_4)) list_nil))))); (12,f) -> u f (\_5929-> (let _expected_14=(u either_left "(function type)") in (let _detected_15=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_14) _detected_15) _ctx_4)) list_nil))))); (13,f) -> u f (\_5930-> (let _expected_14=(u either_left "(function type)") in (let _detected_15=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_14) _detected_15) _ctx_4)) list_nil))))); (14,f) -> u f (\_5931 _5932 _5933 _5934 _5935 _5936-> (let _expected_19=(u either_left "(function type)") in (let _detected_20=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_19) _detected_20) _ctx_4)) list_nil))))); (15,f) -> u f (\_5937 _5938-> (let _expected_15=(u either_left "(function type)") in (let _detected_16=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_15) _detected_16) _ctx_4)) list_nil))))); })) in (case _5893 of {(0,f) -> u f (\_5939 _5940-> (u (u fm_check_result _5939) (u (u list_concat _5890) _5940))); })))); }))); }))); (6,f) -> u f (\_5941 _5942 _5943-> (let _ctx_size_10=(u list_length _ctx_4) in (let _5944 = (u (u (u (u (u (u fm_term_check _5942) maybe_none) _defs_3) _ctx_4) (u fm_mpath_o _path_5)) _orig_6) in (case _5944 of {(0,f) -> u f (\_5945 _5946-> (let _5947 = _5945 in (case _5947 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5946)); (1,f) -> u f (\_5948-> (let _body_val_14=(u _5943 (u (u fm_term_var _5941) _ctx_size_10)) in (let _body_ctx_15=(u (u list_cons (u (u pair_new _5941) _5948)) _ctx_4) in (let _5949 = (let _5950 = (u (u (u (u (u (u fm_term_check _body_val_14) _type_2) _defs_3) _body_ctx_15) (u fm_mpath_i _path_5)) _orig_6) in (case _5950 of {(0,f) -> u f (\_5951 _5952-> (let _5953 = _5951 in (case _5953 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5952)); (1,f) -> u f (\_5954-> (let _5955 = (u (u fm_check_result (u maybe_some _5954)) list_nil) in (case _5955 of {(0,f) -> u f (\_5956 _5957-> (u (u fm_check_result _5956) (u (u list_concat _5952) _5957))); }))); }))); })) in (case _5949 of {(0,f) -> u f (\_5958 _5959-> (u (u fm_check_result _5958) (u (u list_concat _5946) _5959))); }))))); }))); })))); (7,f) -> u f (\_5960 _5961 _5962-> (let _ctx_size_10=(u list_length _ctx_4) in (let _5963 = (u (u (u (u (u (u fm_term_check _5961) maybe_none) _defs_3) _ctx_4) (u fm_mpath_o _path_5)) _orig_6) in (case _5963 of {(0,f) -> u f (\_5964 _5965-> (let _5966 = _5964 in (case _5966 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5965)); (1,f) -> u f (\_5967-> (let _body_val_14=(u _5962 (u (u (u fm_term_ann bool_true) _5961) _5967)) in (let _body_ctx_15=(u (u list_cons (u (u pair_new _5960) _5967)) _ctx_4) in (let _5968 = (let _5969 = (u (u (u (u (u (u fm_term_check _body_val_14) _type_2) _defs_3) _body_ctx_15) (u fm_mpath_i _path_5)) _orig_6) in (case _5969 of {(0,f) -> u f (\_5970 _5971-> (let _5972 = _5970 in (case _5972 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5971)); (1,f) -> u f (\_5973-> (let _5974 = (u (u fm_check_result (u maybe_some _5973)) list_nil) in (case _5974 of {(0,f) -> u f (\_5975 _5976-> (u (u fm_check_result _5975) (u (u list_concat _5971) _5976))); }))); }))); })) in (case _5968 of {(0,f) -> u f (\_5977 _5978-> (u (u fm_check_result _5977) (u (u list_concat _5965) _5978))); }))))); }))); })))); (8,f) -> u f (\_5979 _5980 _5981-> (let _5982 = _5979 in (if _5982 then (u (u fm_check_result (u maybe_some _5981)) list_nil) else (let _5983 = (u (u (u (u (u (u fm_term_check _5980) (u maybe_some _5981)) _defs_3) _ctx_4) (u fm_mpath_o _path_5)) _orig_6) in (case _5983 of {(0,f) -> u f (\_5984 _5985-> (let _5986 = _5984 in (case _5986 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5985)); (1,f) -> u f (\_5987-> (let _5988 = (let _5989 = (u (u (u (u (u (u fm_term_check _5981) (u maybe_some fm_term_typ)) _defs_3) _ctx_4) (u fm_mpath_i _path_5)) _orig_6) in (case _5989 of {(0,f) -> u f (\_5990 _5991-> (let _5992 = _5990 in (case _5992 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5991)); (1,f) -> u f (\_5993-> (let _5994 = (u (u fm_check_result (u maybe_some _5981)) list_nil) in (case _5994 of {(0,f) -> u f (\_5995 _5996-> (u (u fm_check_result _5995) (u (u list_concat _5991) _5996))); }))); }))); })) in (case _5988 of {(0,f) -> u f (\_5997 _5998-> (u (u fm_check_result _5997) (u (u list_concat _5985) _5998))); }))); }))); }))))); (9,f) -> u f (\_5999 _6000 _6001-> (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u (u fm_error_show_goal _5999) _6000) _6001) _type_2) _ctx_4)) list_nil))); (10,f) -> u f (\_6002-> (u (u fm_check_result _type_2) list_nil)); (11,f) -> u f (\_6003-> (u (u fm_check_result (u maybe_some (u fm_term_ref "Nat"))) list_nil)); (12,f) -> u f (\_6004-> (u (u fm_check_result (u maybe_some (u fm_term_ref "Char"))) list_nil)); (13,f) -> u f (\_6005-> (u (u fm_check_result (u maybe_some (u fm_term_ref "String"))) list_nil)); (14,f) -> u f (\_6006 _6007 _6008 _6009 _6010 _6011-> (let _expr_13=_6007 in (let _6012 = (u (u (u (u (u (u fm_term_check _expr_13) maybe_none) _defs_3) _ctx_4) (u fm_mpath_o _path_5)) _orig_6) in (case _6012 of {(0,f) -> u f (\_6013 _6014-> (let _6015 = _6013 in (case _6015 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _6014)); (1,f) -> u f (\_6016-> (let _dsug_17=(let _6017 = _6011 in (case _6017 of {(0,f) -> u f ((let _moti_17=(let _6018 = _type_2 in (case _6018 of {(0,f) -> u f ((u fm_term_hol bits_e)); (1,f) -> u f (\_6019-> (let _size_18=(u list_length _ctx_4) in (let _typv_19=(u (u fm_term_normalize _6019) map_new) in (let _moti_20=(u (u (u (u (u (u fm_smartmotive_make _6008) _6007) _6016) _typv_19) _size_18) _defs_3) in _moti_20)))); })) in (u maybe_some (u (u (u (u (u (u fm_term_cse _6006) _6007) _6008) _6009) _6010) (u maybe_some _moti_17))))); (1,f) -> u f (\_6020-> (u (u (u (u (u (u (u (u fm_term_desugar_cse _6007) _6008) _6009) _6010) _6020) _6016) _defs_3) _ctx_4)); })) in (let _6021 = (let _6022 = _dsug_17 in (case _6022 of {(0,f) -> u f ((u (u fm_check_result _type_2) (u (u list_cons (u (u (u fm_error_cant_infer _orig_6) _term_1) _ctx_4)) list_nil))); (1,f) -> u f (\_6023-> (u (u fm_check_result _type_2) (u (u list_cons (u (u fm_error_patch (u fm_mpath_to_bits _path_5)) _6023)) list_nil))); })) in (case _6021 of {(0,f) -> u f (\_6024 _6025-> (u (u fm_check_result _6024) (u (u list_concat _6014) _6025))); })))); }))); })))); (15,f) -> u f (\_6026 _6027-> (u (u (u (u (u (u fm_term_check _6027) _type_2) _defs_3) _ctx_4) _path_5) (u maybe_some _6026))); })) in (case _5793 of {(0,f) -> u f (\_6028 _6029-> (let _6030 = _6028 in (case _6030 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _6029)); (1,f) -> u f (\_6031-> (let _6032 = (let _6033 = _type_2 in (case _6033 of {(0,f) -> u f ((u (u fm_check_result (u maybe_some _6031)) list_nil)); (1,f) -> u f (\_6034-> (let _6035 = (u (u (u (u (u fm_term_equal _6034) _6031) _defs_3) (u list_length _ctx_4)) set_new) in (case _6035 of {(0,f) -> u f (\_6036 _6037-> (let _6038 = _6036 in (case _6038 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _6037)); (1,f) -> u f (\_6039-> (let _6040 = (let _6041 = _6039 in (if _6041 then (u (u fm_check_result (u maybe_some _6034)) list_nil) else (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) (u either_right _6034)) (u either_right _6031)) _ctx_4)) list_nil)))) in (case _6040 of {(0,f) -> u f (\_6042 _6043-> (u (u fm_check_result _6042) (u (u list_concat _6037) _6043))); }))); }))); }))); })) in (case _6032 of {(0,f) -> u f (\_6044 _6045-> (u (u fm_check_result _6044) (u (u list_concat _6029) _6045))); }))); }))); }))))))))
fm_path_nil = (\_x_1-> _x_1)
fm_mpath_nil = (u maybe_some fm_path_nil)
list_is_empty = (\_list_2-> (let _6046 = _list_2 in (case _6046 of {(0,f) -> u f (bool_true); (1,f) -> u f (\_6047 _6048-> bool_false); })))
io_print = (\_text_1-> (u (u (u io_ask "print") _text_1) (\_skip_2-> (u io_end unit_new))))
fm_term_patch_at = (\_path_1-> (\_term_2-> (\_fn_3-> (let _6049 = _term_2 in (case _6049 of {(0,f) -> u f (\_6050 _6051-> (let _6052 = _path_1 in (case _6052 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_6053-> _term_2); (2,f) -> u f (\_6054-> _term_2); }))); (1,f) -> u f (\_6055-> (let _6056 = _path_1 in (case _6056 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_6057-> _term_2); (2,f) -> u f (\_6058-> _term_2); }))); (2,f) -> u f ((let _6059 = _path_1 in (case _6059 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_6060-> _term_2); (2,f) -> u f (\_6061-> _term_2); }))); (3,f) -> u f (\_6062 _6063 _6064 _6065 _6066-> (let _6067 = _path_1 in (case _6067 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_6068-> (u (u (u (u (u fm_term_all _6062) _6063) _6064) (u (u (u fm_term_patch_at _6068) _6065) _fn_3)) _6066)); (2,f) -> u f (\_6069-> (u (u (u (u (u fm_term_all _6062) _6063) _6064) _6065) (\_s_10-> (\_x_11-> (u (u (u fm_term_patch_at _6069) (u (u _6066 _s_10) _x_11)) _fn_3))))); }))); (4,f) -> u f (\_6070 _6071-> (let _6072 = _path_1 in (case _6072 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_6073-> (u (u fm_term_lam _6070) (\_x_7-> (u (u (u fm_term_patch_at (u bits_tail _path_1)) (u _6071 _x_7)) _fn_3)))); (2,f) -> u f (\_6074-> (u (u fm_term_lam _6070) (\_x_7-> (u (u (u fm_term_patch_at (u bits_tail _path_1)) (u _6071 _x_7)) _fn_3)))); }))); (5,f) -> u f (\_6075 _6076-> (let _6077 = _path_1 in (case _6077 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_6078-> (u (u fm_term_app (u (u (u fm_term_patch_at _6078) _6075) _fn_3)) _6076)); (2,f) -> u f (\_6079-> (u (u fm_term_app _6075) (u (u (u fm_term_patch_at _6079) _6076) _fn_3))); }))); (6,f) -> u f (\_6080 _6081 _6082-> (let _6083 = _path_1 in (case _6083 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_6084-> (u (u (u fm_term_let _6080) (u (u (u fm_term_patch_at _6084) _6081) _fn_3)) _6082)); (2,f) -> u f (\_6085-> (u (u (u fm_term_let _6080) _6081) (\_x_8-> (u (u (u fm_term_patch_at _6085) (u _6082 _x_8)) _fn_3)))); }))); (7,f) -> u f (\_6086 _6087 _6088-> (let _6089 = _path_1 in (case _6089 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_6090-> (u (u (u fm_term_def _6086) (u (u (u fm_term_patch_at _6090) _6087) _fn_3)) _6088)); (2,f) -> u f (\_6091-> (u (u (u fm_term_def _6086) _6087) (\_x_8-> (u (u (u fm_term_patch_at _6091) (u _6088 _x_8)) _fn_3)))); }))); (8,f) -> u f (\_6092 _6093 _6094-> (let _6095 = _path_1 in (case _6095 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_6096-> (u (u (u fm_term_ann _6092) (u (u (u fm_term_patch_at _6096) _6093) _fn_3)) _6094)); (2,f) -> u f (\_6097-> (u (u (u fm_term_ann _6092) _6093) (u (u (u fm_term_patch_at _6097) _6094) _fn_3))); }))); (9,f) -> u f (\_6098 _6099 _6100-> (let _6101 = _path_1 in (case _6101 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_6102-> _term_2); (2,f) -> u f (\_6103-> _term_2); }))); (10,f) -> u f (\_6104-> (let _6105 = _path_1 in (case _6105 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_6106-> _term_2); (2,f) -> u f (\_6107-> _term_2); }))); (11,f) -> u f (\_6108-> (let _6109 = _path_1 in (case _6109 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_6110-> _term_2); (2,f) -> u f (\_6111-> _term_2); }))); (12,f) -> u f (\_6112-> (let _6113 = _path_1 in (case _6113 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_6114-> _term_2); (2,f) -> u f (\_6115-> _term_2); }))); (13,f) -> u f (\_6116-> (let _6117 = _path_1 in (case _6117 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_6118-> _term_2); (2,f) -> u f (\_6119-> _term_2); }))); (14,f) -> u f (\_6120 _6121 _6122 _6123 _6124 _6125-> (let _6126 = _path_1 in (case _6126 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_6127-> _term_2); (2,f) -> u f (\_6128-> _term_2); }))); (15,f) -> u f (\_6129 _6130-> (u (u fm_term_ori _6129) (u (u (u fm_term_patch_at _path_1) _6130) _fn_3))); })))))
fm_synth_fix = (\_file_1-> (\_code_2-> (\_orig_3-> (\_name_4-> (\_term_5-> (\_type_6-> (\_isct_7-> (\_defs_8-> (\_errs_9-> (\_fixd_10-> (\_log_11-> (let _6131 = _errs_9 in (case _6131 of {(0,f) -> u f ((let _6132 = _fixd_10 in (if _6132 then (let _type_12=(u (u (u fm_term_bind list_nil) (\_x_12-> (u bits_i _x_12))) _type_6) in (let _term_13=(u (u (u fm_term_bind list_nil) (\_x_13-> (u bits_o _x_13))) _term_5) in (let _defs_14=(u (u (u fm_set _name_4) (u (u (u (u (u (u (u (u fm_def_new _file_1) _code_2) _orig_3) _name_4) _term_13) _type_12) _isct_7) fm_status_init)) _defs_8) in (u (u io_monad (\_m_bind_15-> (\_m_pure_16-> _m_pure_16))) (u maybe_some _defs_14))))) else (u (u io_monad (\_m_bind_12-> (\_m_pure_13-> _m_pure_13))) maybe_none)))); (1,f) -> u f (\_6133 _6134-> (let _6135 = _6133 in (case _6135 of {(0,f) -> u f (\_6136 _6137 _6138 _6139-> (u (u (u (u (u (u (u (u (u (u (u fm_synth_fix _file_1) _code_2) _orig_3) _name_4) _term_5) _type_6) _isct_7) _defs_8) _6134) _fixd_10) _log_11)); (1,f) -> u f (\_6140 _6141 _6142 _6143 _6144-> (u (u (u (u (u (u (u (u (u (u (u fm_synth_fix _file_1) _code_2) _orig_3) _name_4) _term_5) _type_6) _isct_7) _defs_8) _6134) _fixd_10) _log_11)); (2,f) -> u f (\_6145-> (u (u (u io_monad (\_m_bind_15-> (\_m_pure_16-> _m_bind_15))) (u (u (u fm_synth_one _6145) _defs_8) _log_11)) (\_new_defs_15-> (let _6146 = _new_defs_15 in (case _6146 of {(0,f) -> u f ((u (u (u (u (u (u (u (u (u (u (u fm_synth_fix _file_1) _code_2) _orig_3) _name_4) _term_5) _type_6) _isct_7) _defs_8) _6134) _fixd_10) _log_11)); (1,f) -> u f (\_6147-> (u (u (u (u (u (u (u (u (u (u (u fm_synth_fix _file_1) _code_2) _orig_3) _name_4) _term_5) _type_6) _isct_7) _6147) _6134) bool_true) _log_11)); }))))); (3,f) -> u f (\_6148-> (u (u (u (u (u (u (u (u (u (u (u fm_synth_fix _file_1) _code_2) _orig_3) _name_4) _term_5) _type_6) _isct_7) _defs_8) _6134) _fixd_10) _log_11)); (4,f) -> u f (\_6149 _6150-> (let _6151 = _6149 in (case _6151 of {(0,f) -> u f ((u (u io_monad (\_m_bind_16-> (\_m_pure_17-> _m_pure_17))) maybe_none)); (1,f) -> u f (\_6152-> (let _term_17=(u (u (u fm_term_patch_at _6152) _term_5) (\_x_17-> _6150)) in (u (u (u (u (u (u (u (u (u (u (u fm_synth_fix _file_1) _code_2) _orig_3) _name_4) _term_17) _type_6) _isct_7) _defs_8) _6134) bool_true) _log_11))); (2,f) -> u f (\_6153-> (let _type_17=(u (u (u fm_term_patch_at _6153) _type_6) (\_x_17-> _6150)) in (u (u (u (u (u (u (u (u (u (u (u fm_synth_fix _file_1) _code_2) _orig_3) _name_4) _term_5) _type_17) _isct_7) _defs_8) _6134) bool_true) _log_11))); }))); (5,f) -> u f (\_6154 _6155-> (u (u (u io_monad (\_m_bind_16-> (\_m_pure_17-> _m_bind_16))) (u (u (u fm_synth_one _6155) _defs_8) _log_11)) (\_new_defs_16-> (let _6156 = _new_defs_16 in (case _6156 of {(0,f) -> u f ((u (u (u (u (u (u (u (u (u (u (u fm_synth_fix _file_1) _code_2) _orig_3) _name_4) _term_5) _type_6) _isct_7) _defs_8) _6134) _fixd_10) _log_11)); (1,f) -> u f (\_6157-> (u (u (u (u (u (u (u (u (u (u (u fm_synth_fix _file_1) _code_2) _orig_3) _name_4) _term_5) _type_6) _isct_7) _6157) _6134) bool_true) _log_11)); }))))); (6,f) -> u f (\_6158 _6159 _6160-> (u (u (u (u (u (u (u (u (u (u (u fm_synth_fix _file_1) _code_2) _orig_3) _name_4) _term_5) _type_6) _isct_7) _defs_8) _6134) _fixd_10) _log_11)); }))); })))))))))))))
fm_status_fail = (\_errors_1-> (3,\t-> t _errors_1))
fm_synth_one = (\_name_1-> (\_defs_2-> (\_log_3-> (let _6161 = (u (u fm_get _name_1) _defs_2) in (case _6161 of {(0,f) -> u f ((u (u (u io_monad (\_m_bind_4-> (\_m_pure_5-> _m_bind_4))) (u (u fm_synth_load _name_1) _defs_2)) (\_loaded_4-> (let _6162 = _loaded_4 in (case _6162 of {(0,f) -> u f ((u (u io_monad (\_m_bind_5-> (\_m_pure_6-> _m_pure_6))) maybe_none)); (1,f) -> u f (\_6163-> (u (u (u fm_synth_one _name_1) _6163) _log_3)); }))))); (1,f) -> u f (\_6164-> (let _6165 = _6164 in (case _6165 of {(0,f) -> u f (\_6166 _6167 _6168 _6169 _6170 _6171 _6172 _6173-> (let _file_13=_6166 in (let _code_14=_6167 in (let _orig_15=_6168 in (let _name_16=_6169 in (let _term_17=_6170 in (let _type_18=_6171 in (let _isct_19=_6172 in (let _stat_20=_6173 in (let _6174 = _stat_20 in (case _6174 of {(0,f) -> u f ((let _defs_21=(u (u (u fm_set _name_16) (u (u (u (u (u (u (u (u fm_def_new _file_13) _code_14) _orig_15) _name_16) _term_17) _type_18) _isct_19) fm_status_wait)) _defs_2) in (let _checked_22=(let _6175 = (u (u (u (u (u (u fm_term_check _type_18) (u maybe_some fm_term_typ)) _defs_21) list_nil) (u fm_mpath_i fm_mpath_nil)) maybe_none) in (case _6175 of {(0,f) -> u f (\_6176 _6177-> (let _6178 = _6176 in (case _6178 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _6177)); (1,f) -> u f (\_6179-> (let _6180 = (let _6181 = (u (u (u (u (u (u fm_term_check _term_17) (u maybe_some _type_18)) _defs_21) list_nil) (u fm_mpath_o fm_mpath_nil)) maybe_none) in (case _6181 of {(0,f) -> u f (\_6182 _6183-> (let _6184 = _6182 in (case _6184 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _6183)); (1,f) -> u f (\_6185-> (let _6186 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _6186 of {(0,f) -> u f (\_6187 _6188-> (u (u fm_check_result _6187) (u (u list_concat _6183) _6188))); }))); }))); })) in (case _6180 of {(0,f) -> u f (\_6189 _6190-> (u (u fm_check_result _6189) (u (u list_concat _6177) _6190))); }))); }))); })) in (let _6191 = _checked_22 in (case _6191 of {(0,f) -> u f (\_6192 _6193-> (let _6194 = (u list_is_empty _6193) in (if _6194 then (let _defs_25=(u (u (u (u (u (u (u (u (u fm_define _file_13) _code_14) _orig_15) _name_16) _term_17) _type_18) _isct_19) bool_true) _defs_21) in (u (u (u io_monad (\_m_bind_26-> (\_m_pure_27-> _m_bind_26))) (let _6195 = _log_3 in (if _6195 then (u io_print (((_name_16::String) ++ " ✓"))) else (u (u io_monad (\_m_bind_26-> (\_m_pure_27-> _m_pure_27))) unit_new)))) (\__26-> (u (u io_monad (\_m_bind_27-> (\_m_pure_28-> _m_pure_28))) (u maybe_some _defs_25))))) else (u (u (u io_monad (\_m_bind_25-> (\_m_pure_26-> _m_bind_25))) (u (u (u (u (u (u (u (u (u (u (u fm_synth_fix _file_13) _code_14) _orig_15) _name_16) _term_17) _type_18) _isct_19) _defs_21) _6193) bool_false) _log_3)) (\_fixed_25-> (let _6196 = _fixed_25 in (case _6196 of {(0,f) -> u f ((let _stat_26=(u fm_status_fail _6193) in (let _defs_27=(u (u (u fm_set _name_16) (u (u (u (u (u (u (u (u fm_def_new _file_13) _code_14) _orig_15) _name_16) _term_17) _type_18) _isct_19) _stat_26)) _defs_21) in (u (u io_monad (\_m_bind_28-> (\_m_pure_29-> _m_pure_29))) (u maybe_some _defs_27))))); (1,f) -> u f (\_6197-> (u (u (u fm_synth_one _name_16) _6197) _log_3)); }))))))); }))))); (1,f) -> u f ((u (u io_monad (\_m_bind_21-> (\_m_pure_22-> _m_pure_22))) (u maybe_some _defs_2))); (2,f) -> u f ((u (u io_monad (\_m_bind_21-> (\_m_pure_22-> _m_pure_22))) (u maybe_some _defs_2))); (3,f) -> u f (\_6198-> (u (u io_monad (\_m_bind_22-> (\_m_pure_23-> _m_pure_23))) (u maybe_some _defs_2))); }))))))))))); }))); })))))
map_map = (\_fn_3-> (\_map_4-> (let _6199 = _map_4 in (case _6199 of {(0,f) -> u f (map_new); (1,f) -> u f (\_6200 _6201 _6202-> (let _val_8=(let _6203 = _6200 in (case _6203 of {(0,f) -> u f (maybe_none); (1,f) -> u f (\_6204-> (u maybe_some (u _fn_3 _6204))); })) in (let _lft_9=(u (u map_map _fn_3) _6201) in (let _rgt_10=(u (u map_map _fn_3) _6202) in (u (u (u map_tie _val_8) _lft_9) _rgt_10))))); }))))
fm_term_inline_names = (let _inl_1=(u (u list_cons "Monad.pure") (u (u list_cons "Monad.bind") (u (u list_cons "Monad.new") (u (u list_cons "Parser.monad") (u (u list_cons "Parser.bind") (u (u list_cons "Parser.pure") (u (u list_cons "Fm.Check.pure") (u (u list_cons "Fm.Check.bind") (u (u list_cons "Fm.Check.monad") (u (u list_cons "Fm.Check.value") (u (u list_cons "Fm.Check.none") list_nil))))))))))) in (let _kvs_2=(u (u list_mapped _inl_1) (\_x_2-> (u (u pair_new (u fm_name_to_bits _x_2)) unit_new))) in (u map_from_list _kvs_2)))
fm_term_inline_reduce = (\_term_1-> (\_defs_2-> (let _6205 = _term_1 in (case _6205 of {(0,f) -> u f (\_6206 _6207-> _term_1); (1,f) -> u f (\_6208-> (let _inli_4=(u (u set_has (u fm_name_to_bits _6208)) fm_term_inline_names) in (let _6209 = _inli_4 in (if _6209 then (let _6210 = (u (u fm_get _6208) _defs_2) in (case _6210 of {(0,f) -> u f ((u fm_term_ref _6208)); (1,f) -> u f (\_6211-> (let _6212 = _6211 in (case _6212 of {(0,f) -> u f (\_6213 _6214 _6215 _6216 _6217 _6218 _6219 _6220-> (u (u fm_term_inline_reduce _6217) _defs_2)); }))); })) else _term_1)))); (2,f) -> u f (_term_1); (3,f) -> u f (\_6221 _6222 _6223 _6224 _6225-> _term_1); (4,f) -> u f (\_6226 _6227-> _term_1); (5,f) -> u f (\_6228 _6229-> (let _func_5=(u (u fm_term_inline_reduce _6228) _defs_2) in (let _6230 = _func_5 in (case _6230 of {(0,f) -> u f (\_6231 _6232-> _term_1); (1,f) -> u f (\_6233-> _term_1); (2,f) -> u f (_term_1); (3,f) -> u f (\_6234 _6235 _6236 _6237 _6238-> _term_1); (4,f) -> u f (\_6239 _6240-> (u (u fm_term_inline_reduce (u _6240 _6229)) _defs_2)); (5,f) -> u f (\_6241 _6242-> _term_1); (6,f) -> u f (\_6243 _6244 _6245-> (u (u (u fm_term_let _6243) _6244) (\_x_9-> (u (u fm_term_inline_reduce (u (u fm_term_app (u _6245 _x_9)) _6229)) _defs_2)))); (7,f) -> u f (\_6246 _6247 _6248-> _term_1); (8,f) -> u f (\_6249 _6250 _6251-> _term_1); (9,f) -> u f (\_6252 _6253 _6254-> _term_1); (10,f) -> u f (\_6255-> _term_1); (11,f) -> u f (\_6256-> _term_1); (12,f) -> u f (\_6257-> _term_1); (13,f) -> u f (\_6258-> _term_1); (14,f) -> u f (\_6259 _6260 _6261 _6262 _6263 _6264-> _term_1); (15,f) -> u f (\_6265 _6266-> _term_1); })))); (6,f) -> u f (\_6267 _6268 _6269-> _term_1); (7,f) -> u f (\_6270 _6271 _6272-> _term_1); (8,f) -> u f (\_6273 _6274 _6275-> _term_1); (9,f) -> u f (\_6276 _6277 _6278-> _term_1); (10,f) -> u f (\_6279-> _term_1); (11,f) -> u f (\_6280-> _term_1); (12,f) -> u f (\_6281-> _term_1); (13,f) -> u f (\_6282-> _term_1); (14,f) -> u f (\_6283 _6284 _6285 _6286 _6287 _6288-> _term_1); (15,f) -> u f (\_6289 _6290-> (u (u fm_term_inline_reduce _6290) _defs_2)); }))))
fm_term_inline = (\_term_1-> (\_defs_2-> (let _6291 = (u (u fm_term_inline_reduce _term_1) _defs_2) in (case _6291 of {(0,f) -> u f (\_6292 _6293-> (u (u fm_term_var _6292) _6293)); (1,f) -> u f (\_6294-> (u fm_term_ref _6294)); (2,f) -> u f (fm_term_typ); (3,f) -> u f (\_6295 _6296 _6297 _6298 _6299-> (u (u (u (u (u fm_term_all _6295) _6296) _6297) (u (u fm_term_inline _6298) _defs_2)) (\_s_8-> (\_x_9-> (u (u fm_term_inline (u (u _6299 _s_8) _x_9)) _defs_2))))); (4,f) -> u f (\_6300 _6301-> (u (u fm_term_lam _6300) (\_x_5-> (u (u fm_term_inline (u _6301 _x_5)) _defs_2)))); (5,f) -> u f (\_6302 _6303-> (u (u fm_term_app (u (u fm_term_inline _6302) _defs_2)) (u (u fm_term_inline _6303) _defs_2))); (6,f) -> u f (\_6304 _6305 _6306-> (u (u (u fm_term_let _6304) (u (u fm_term_inline _6305) _defs_2)) (\_x_6-> (u (u fm_term_inline (u _6306 _x_6)) _defs_2)))); (7,f) -> u f (\_6307 _6308 _6309-> (u (u (u fm_term_def _6307) (u (u fm_term_inline _6308) _defs_2)) (\_x_6-> (u (u fm_term_inline (u _6309 _x_6)) _defs_2)))); (8,f) -> u f (\_6310 _6311 _6312-> (u (u (u fm_term_ann _6310) (u (u fm_term_inline _6311) _defs_2)) (u (u fm_term_inline _6312) _defs_2))); (9,f) -> u f (\_6313 _6314 _6315-> (u (u (u fm_term_gol _6313) _6314) _6315)); (10,f) -> u f (\_6316-> (u fm_term_hol _6316)); (11,f) -> u f (\_6317-> (u fm_term_nat _6317)); (12,f) -> u f (\_6318-> (u fm_term_chr _6318)); (13,f) -> u f (\_6319-> (u fm_term_str _6319)); (14,f) -> u f (\_6320 _6321 _6322 _6323 _6324 _6325-> _term_1); (15,f) -> u f (\_6326 _6327-> (u (u fm_term_inline _6327) _defs_2)); }))))
map_values_go = (\_xs_2-> (\_list_3-> (let _6328 = _xs_2 in (case _6328 of {(0,f) -> u f (_list_3); (1,f) -> u f (\_6329 _6330 _6331-> (let _list0_7=(let _6332 = _6329 in (case _6332 of {(0,f) -> u f (_list_3); (1,f) -> u f (\_6333-> (u (u list_cons _6333) _list_3)); })) in (let _list1_8=(u (u map_values_go _6330) _list0_7) in (let _list2_9=(u (u map_values_go _6331) _list1_8) in _list2_9)))); }))))
map_values = (\_xs_2-> (u (u map_values_go _xs_2) list_nil))
fm_core_var_name = (\_indx_1-> (\_name_2-> (\_brui_3-> (\_vars_4-> (let _6334 = _indx_1 in (if _6334==0 then (let _6335 = _brui_3 in (if _6335==0 then _name_2 else (((_name_2::String) ++ ((("^"::String) ++ (u nat_show _brui_3))))))) else (let _6336 = _vars_4 in (case _6336 of {(0,f) -> u f ("unbound"); (1,f) -> u f (\_6337 _6338-> (let _brui_8=(let _6339 = (((_name_2::String) == _6337)) in (if _6339 then (u nat_succ _brui_3) else _brui_3)) in (u (u (u (u fm_core_var_name (_6334-1)) _name_2) _brui_8) _6338))); }))))))))
fm_name_show = (\_name_1-> _name_1)
bits_to_nat = (\_b_1-> (let _6340 = _b_1 in (case _6340 of {(0,f) -> u f (0); (1,f) -> u f (\_6341-> (((2::Integer) * (u bits_to_nat _6341)))); (2,f) -> u f (\_6342-> (u nat_succ (((2::Integer) * (u bits_to_nat _6342))))); })))
u16_show_hex = (\_a_1-> (let _6343 = _a_1 in (u (u nat_to_string_base 16) (u bits_to_nat (u word_to_bits (u16_to_word _6343))))))
fm_escape_char = (\_chr_1-> (let _6344 = (((_chr_1::Word16) == fm_backslash)) in (if _6344 then (u (u string_cons fm_backslash) (u (u string_cons _chr_1) string_nil)) else (let _6345 = (((_chr_1::Word16) == 34)) in (if _6345 then (u (u string_cons fm_backslash) (u (u string_cons _chr_1) string_nil)) else (let _6346 = (((_chr_1::Word16) == 39)) in (if _6346 then (u (u string_cons fm_backslash) (u (u string_cons _chr_1) string_nil)) else (let _6347 = (u (u (u u16_btw 32) _chr_1) 126) in (if _6347 then (u (u string_cons _chr_1) string_nil) else (u string_flatten (u (u list_cons (u (u string_cons fm_backslash) string_nil)) (u (u list_cons "u{") (u (u list_cons (u u16_show_hex _chr_1)) (u (u list_cons "}") (u (u list_cons string_nil) list_nil)))))))))))))))
fm_escape = (\_str_1-> (let _6348 = _str_1 in (if null (_6348::String) then string_nil else (let _head_4=(u fm_escape_char (fromIntegral (fromEnum (head _6348 :: Char)) :: Word16)) in (let _tail_5=(u fm_escape (tail _6348)) in (((_head_4::String) ++ _tail_5)))))))
fm_core_show = (\_term_1-> (\_indx_2-> (\_vars_3-> (let _6349 = _term_1 in (case _6349 of {(0,f) -> u f (\_6350 _6351-> (u (u (u (u fm_core_var_name (u nat_pred (((_indx_2::Integer) - _6351)))) _6350) 0) _vars_3)); (1,f) -> u f (\_6352-> (u fm_name_show _6352)); (2,f) -> u f ("*"); (3,f) -> u f (\_6353 _6354 _6355 _6356 _6357-> (let _eras_9=_6353 in (let _init_10=(let _6358 = _eras_9 in (if _6358 then "%" else "@")) in (let _self_11=(u fm_name_show _6354) in (let _name_12=(u fm_name_show _6355) in (let _xtyp_13=(u (u (u fm_core_show _6356) _indx_2) _vars_3) in (let _body_14=(u (u (u fm_core_show (u (u _6357 (u (u fm_term_var _6354) _indx_2)) (u (u fm_term_var _6355) (u nat_succ _indx_2)))) (u nat_succ (u nat_succ _indx_2))) (u (u list_cons _6355) (u (u list_cons _6354) _vars_3))) in (u string_flatten (u (u list_cons _init_10) (u (u list_cons _self_11) (u (u list_cons "(") (u (u list_cons _name_12) (u (u list_cons ":") (u (u list_cons _xtyp_13) (u (u list_cons ") ") (u (u list_cons _body_14) list_nil)))))))))))))))); (4,f) -> u f (\_6359 _6360-> (let _name_6=(u fm_name_show _6359) in (let _body_7=(u (u (u fm_core_show (u _6360 (u (u fm_term_var _6359) _indx_2))) (u nat_succ _indx_2)) (u (u list_cons _6359) _vars_3)) in (u string_flatten (u (u list_cons "#") (u (u list_cons _name_6) (u (u list_cons " ") (u (u list_cons _body_7) list_nil)))))))); (5,f) -> u f (\_6361 _6362-> (let _func_6=(u (u (u fm_core_show _6361) _indx_2) _vars_3) in (let _argm_7=(u (u (u fm_core_show _6362) _indx_2) _vars_3) in (u string_flatten (u (u list_cons "(") (u (u list_cons _func_6) (u (u list_cons " ") (u (u list_cons _argm_7) (u (u list_cons ")") list_nil))))))))); (6,f) -> u f (\_6363 _6364 _6365-> (let _name_7=(u fm_name_show _6363) in (let _expr_8=(u (u (u fm_core_show _6364) _indx_2) _vars_3) in (let _body_9=(u (u (u fm_core_show (u _6365 (u (u fm_term_var _6363) _indx_2))) (u nat_succ _indx_2)) (u (u list_cons _6363) _vars_3)) in (u string_flatten (u (u list_cons "!") (u (u list_cons _name_7) (u (u list_cons " = ") (u (u list_cons _expr_8) (u (u list_cons "; ") (u (u list_cons _body_9) list_nil))))))))))); (7,f) -> u f (\_6366 _6367 _6368-> (let _name_7=(u fm_name_show _6366) in (let _expr_8=(u (u (u fm_core_show _6367) _indx_2) _vars_3) in (let _body_9=(u (u (u fm_core_show (u _6368 (u (u fm_term_var _6366) _indx_2))) (u nat_succ _indx_2)) (u (u list_cons _6366) _vars_3)) in (u string_flatten (u (u list_cons "$") (u (u list_cons _name_7) (u (u list_cons " = ") (u (u list_cons _expr_8) (u (u list_cons "; ") (u (u list_cons _body_9) list_nil))))))))))); (8,f) -> u f (\_6369 _6370 _6371-> (let _term_7=(u (u (u fm_core_show _6370) _indx_2) _vars_3) in (let _type_8=(u (u (u fm_core_show _6371) _indx_2) _vars_3) in (u string_flatten (u (u list_cons "{") (u (u list_cons _term_7) (u (u list_cons ":") (u (u list_cons _type_8) (u (u list_cons "}") list_nil))))))))); (9,f) -> u f (\_6372 _6373 _6374-> "<GOL>"); (10,f) -> u f (\_6375-> "<HOL>"); (11,f) -> u f (\_6376-> (u string_flatten (u (u list_cons "+") (u (u list_cons (u nat_show _6376)) list_nil)))); (12,f) -> u f (\_6377-> (u string_flatten (u (u list_cons "'") (u (u list_cons (u fm_escape_char _6377)) (u (u list_cons "'") list_nil))))); (13,f) -> u f (\_6378-> (u string_flatten (u (u list_cons "\"") (u (u list_cons (u fm_escape _6378)) (u (u list_cons "\"") list_nil))))); (14,f) -> u f (\_6379 _6380 _6381 _6382 _6383 _6384-> "<CSE>"); (15,f) -> u f (\_6385 _6386-> (u (u (u fm_core_show _6386) _indx_2) _vars_3)); })))))
fm_defs_core = (\_defs_1-> (let _result_2="" in (let _result_3=(u (u (u list_for (u map_values _defs_1)) _result_2) (\_defn_3-> (\_result_4-> (let _6387 = _defn_3 in (case _6387 of {(0,f) -> u f (\_6388 _6389 _6390 _6391 _6392 _6393 _6394 _6395-> (let _6396 = _6395 in (case _6396 of {(0,f) -> u f (_result_4); (1,f) -> u f (_result_4); (2,f) -> u f ((let _name_13=_6391 in (let _term_14=(u (u (u fm_core_show _6392) 0) list_nil) in (let _type_15=(u (u (u fm_core_show _6393) 0) list_nil) in (u string_flatten (u (u list_cons _result_4) (u (u list_cons _name_13) (u (u list_cons " : ") (u (u list_cons _type_15) (u (u list_cons " = ") (u (u list_cons _term_14) (u (u list_cons ";\n") list_nil)))))))))))); (3,f) -> u f (\_6397-> _result_4); }))); }))))) in _result_3)))
fm_to_core_io_one = (\_name_1-> (u (u (u io_monad (\_m_bind_2-> (\_m_pure_3-> _m_bind_2))) (u (u (u fm_synth_one _name_1) map_new) bool_false)) (\_new_defs_2-> (let _defs_3=(let _6398 = _new_defs_2 in (case _6398 of {(0,f) -> u f (map_new); (1,f) -> u f (\_6399-> _6399); })) in (let _defs_4=(u (u map_map (\_defn_4-> (let _6400 = _defn_4 in (case _6400 of {(0,f) -> u f (\_6401 _6402 _6403 _6404 _6405 _6406 _6407 _6408-> (let _term_13=(u (u fm_term_inline _6405) _defs_3) in (let _type_14=(u (u fm_term_inline _6406) _defs_3) in (u (u (u (u (u (u (u (u fm_def_new _6401) _6402) _6403) _6404) _term_13) _type_14) _6407) _6408)))); })))) _defs_3) in (u (u io_monad (\_m_bind_5-> (\_m_pure_6-> _m_pure_6))) (u fm_defs_core _defs_4)))))))
maybe_bind = (\_m_3-> (\_f_4-> (let _6409 = _m_3 in (case _6409 of {(0,f) -> u f (maybe_none); (1,f) -> u f (\_6410-> (u _f_4 _6410)); }))))
maybe_monad = (\_new_2-> (u (u _new_2 maybe_bind) maybe_some))
fm_term_show_as_nat_go = (\_term_1-> (let _6411 = _term_1 in (case _6411 of {(0,f) -> u f (\_6412 _6413-> maybe_none); (1,f) -> u f (\_6414-> (let _6415 = (((_6414::String) == "Nat.zero")) in (if _6415 then (u maybe_some 0) else maybe_none))); (2,f) -> u f (maybe_none); (3,f) -> u f (\_6416 _6417 _6418 _6419 _6420-> maybe_none); (4,f) -> u f (\_6421 _6422-> maybe_none); (5,f) -> u f (\_6423 _6424-> (let _6425 = _6423 in (case _6425 of {(0,f) -> u f (\_6426 _6427-> maybe_none); (1,f) -> u f (\_6428-> (let _6429 = (((_6428::String) == "Nat.succ")) in (if _6429 then (u (u (u maybe_monad (\_m_bind_5-> (\_m_pure_6-> _m_bind_5))) (u fm_term_show_as_nat_go _6424)) (\_pred_5-> (u (u maybe_monad (\_m_bind_6-> (\_m_pure_7-> _m_pure_7))) (u nat_succ _pred_5)))) else maybe_none))); (2,f) -> u f (maybe_none); (3,f) -> u f (\_6430 _6431 _6432 _6433 _6434-> maybe_none); (4,f) -> u f (\_6435 _6436-> maybe_none); (5,f) -> u f (\_6437 _6438-> maybe_none); (6,f) -> u f (\_6439 _6440 _6441-> maybe_none); (7,f) -> u f (\_6442 _6443 _6444-> maybe_none); (8,f) -> u f (\_6445 _6446 _6447-> maybe_none); (9,f) -> u f (\_6448 _6449 _6450-> maybe_none); (10,f) -> u f (\_6451-> maybe_none); (11,f) -> u f (\_6452-> maybe_none); (12,f) -> u f (\_6453-> maybe_none); (13,f) -> u f (\_6454-> maybe_none); (14,f) -> u f (\_6455 _6456 _6457 _6458 _6459 _6460-> maybe_none); (15,f) -> u f (\_6461 _6462-> maybe_none); }))); (6,f) -> u f (\_6463 _6464 _6465-> maybe_none); (7,f) -> u f (\_6466 _6467 _6468-> maybe_none); (8,f) -> u f (\_6469 _6470 _6471-> maybe_none); (9,f) -> u f (\_6472 _6473 _6474-> maybe_none); (10,f) -> u f (\_6475-> maybe_none); (11,f) -> u f (\_6476-> maybe_none); (12,f) -> u f (\_6477-> maybe_none); (13,f) -> u f (\_6478-> maybe_none); (14,f) -> u f (\_6479 _6480 _6481 _6482 _6483 _6484-> maybe_none); (15,f) -> u f (\_6485 _6486-> maybe_none); })))
fm_term_show_as_nat = (\_term_1-> (u (u maybe_mapped (u fm_term_show_as_nat_go _term_1)) nat_show))
fm_term_show_is_ref = (\_term_1-> (\_name_2-> (let _6487 = _term_1 in (case _6487 of {(0,f) -> u f (\_6488 _6489-> bool_false); (1,f) -> u f (\_6490-> (((_name_2::String) == _6490))); (2,f) -> u f (bool_false); (3,f) -> u f (\_6491 _6492 _6493 _6494 _6495-> bool_false); (4,f) -> u f (\_6496 _6497-> bool_false); (5,f) -> u f (\_6498 _6499-> bool_false); (6,f) -> u f (\_6500 _6501 _6502-> bool_false); (7,f) -> u f (\_6503 _6504 _6505-> bool_false); (8,f) -> u f (\_6506 _6507 _6508-> bool_false); (9,f) -> u f (\_6509 _6510 _6511-> bool_false); (10,f) -> u f (\_6512-> bool_false); (11,f) -> u f (\_6513-> bool_false); (12,f) -> u f (\_6514-> bool_false); (13,f) -> u f (\_6515-> bool_false); (14,f) -> u f (\_6516 _6517 _6518 _6519 _6520 _6521-> bool_false); (15,f) -> u f (\_6522 _6523-> bool_false); }))))
fm_term_show_app_done = (\_term_1-> (\_path_2-> (\_args_3-> (let _arity_4=(u list_length _args_3) in (let _6524 = (((u (u fm_term_show_is_ref _term_1) "Equal") && (((_arity_4::Integer) == 3)))) in (if _6524 then (let _func_5=(u (u fm_term_show_go _term_1) _path_2) in (let _eq_lft_6=(u (u maybe_default "?") (u (u list_at 1) _args_3)) in (let _eq_rgt_7=(u (u maybe_default "?") (u (u list_at 2) _args_3)) in (u string_flatten (u (u list_cons _eq_lft_6) (u (u list_cons " == ") (u (u list_cons _eq_rgt_7) list_nil))))))) else (let _func_5=(u (u fm_term_show_go _term_1) _path_2) in (let _wrap_6=(let _6525 = _func_5 in (if null (_6525::String) then bool_false else ((((fromIntegral (fromEnum (head _6525 :: Char)) :: Word16)::Word16) == 40)))) in (let _args_7=(u (u string_join ",") _args_3) in (let _func_8=(let _6526 = _wrap_6 in (if _6526 then (u string_flatten (u (u list_cons "(") (u (u list_cons _func_5) (u (u list_cons ")") list_nil)))) else _func_5)) in (u string_flatten (u (u list_cons _func_8) (u (u list_cons "(") (u (u list_cons _args_7) (u (u list_cons ")") list_nil)))))))))))))))
fm_term_show_app = (\_term_1-> (\_path_2-> (\_args_3-> (let _6527 = _term_1 in (case _6527 of {(0,f) -> u f (\_6528 _6529-> (u (u (u fm_term_show_app_done _term_1) _path_2) _args_3)); (1,f) -> u f (\_6530-> (u (u (u fm_term_show_app_done _term_1) _path_2) _args_3)); (2,f) -> u f ((u (u (u fm_term_show_app_done _term_1) _path_2) _args_3)); (3,f) -> u f (\_6531 _6532 _6533 _6534 _6535-> (u (u (u fm_term_show_app_done _term_1) _path_2) _args_3)); (4,f) -> u f (\_6536 _6537-> (u (u (u fm_term_show_app_done _term_1) _path_2) _args_3)); (5,f) -> u f (\_6538 _6539-> (u (u (u fm_term_show_app _6538) (u fm_mpath_o _path_2)) (u (u list_cons (u (u fm_term_show_go _6539) (u fm_mpath_i _path_2))) _args_3))); (6,f) -> u f (\_6540 _6541 _6542-> (u (u (u fm_term_show_app_done _term_1) _path_2) _args_3)); (7,f) -> u f (\_6543 _6544 _6545-> (u (u (u fm_term_show_app_done _term_1) _path_2) _args_3)); (8,f) -> u f (\_6546 _6547 _6548-> (u (u (u fm_term_show_app_done _term_1) _path_2) _args_3)); (9,f) -> u f (\_6549 _6550 _6551-> (u (u (u fm_term_show_app_done _term_1) _path_2) _args_3)); (10,f) -> u f (\_6552-> (u (u (u fm_term_show_app_done _term_1) _path_2) _args_3)); (11,f) -> u f (\_6553-> (u (u (u fm_term_show_app_done _term_1) _path_2) _args_3)); (12,f) -> u f (\_6554-> (u (u (u fm_term_show_app_done _term_1) _path_2) _args_3)); (13,f) -> u f (\_6555-> (u (u (u fm_term_show_app_done _term_1) _path_2) _args_3)); (14,f) -> u f (\_6556 _6557 _6558 _6559 _6560 _6561-> (u (u (u fm_term_show_app_done _term_1) _path_2) _args_3)); (15,f) -> u f (\_6562 _6563-> (u (u (u fm_term_show_app _6563) _path_2) _args_3)); })))))
map_to_list_go = (\_xs_2-> (\_key_3-> (\_list_4-> (let _6564 = _xs_2 in (case _6564 of {(0,f) -> u f (_list_4); (1,f) -> u f (\_6565 _6566 _6567-> (let _list0_8=(let _6568 = _6565 in (case _6568 of {(0,f) -> u f (_list_4); (1,f) -> u f (\_6569-> (u (u list_cons (u (u pair_new (u bits_reverse _key_3)) _6569)) _list_4)); })) in (let _list1_9=(u (u (u map_to_list_go _6566) (u bits_o _key_3)) _list0_8) in (let _list2_10=(u (u (u map_to_list_go _6567) (u bits_i _key_3)) _list1_9) in _list2_10)))); })))))
map_to_list = (\_xs_2-> (u list_reverse (u (u (u map_to_list_go _xs_2) bits_e) list_nil)))
bits_chunks_of_go = (\_len_1-> (\_bits_2-> (\_need_3-> (\_chunk_4-> (let _6570 = _bits_2 in (case _6570 of {(0,f) -> u f ((u (u list_cons (u bits_reverse _chunk_4)) list_nil)); (1,f) -> u f (\_6571-> (let _6572 = _need_3 in (if _6572==0 then (let _head_6=(u bits_reverse _chunk_4) in (let _tail_7=(u (u (u (u bits_chunks_of_go _len_1) _bits_2) _len_1) bits_e) in (u (u list_cons _head_6) _tail_7))) else (let _chunk_7=(u bits_o _chunk_4) in (u (u (u (u bits_chunks_of_go _len_1) _6571) (_6572-1)) _chunk_7))))); (2,f) -> u f (\_6573-> (let _6574 = _need_3 in (if _6574==0 then (let _head_6=(u bits_reverse _chunk_4) in (let _tail_7=(u (u (u (u bits_chunks_of_go _len_1) _bits_2) _len_1) bits_e) in (u (u list_cons _head_6) _tail_7))) else (let _chunk_7=(u bits_i _chunk_4) in (u (u (u (u bits_chunks_of_go _len_1) _6573) (_6574-1)) _chunk_7))))); }))))))
bits_chunks_of = (\_len_1-> (\_bits_2-> (u (u (u (u bits_chunks_of_go _len_1) _bits_2) _len_1) bits_e)))
word_from_bits = (\_size_1-> (\_bits_2-> (let _6575 = _size_1 in (if _6575==0 then word_e else (let _6576 = _bits_2 in (case _6576 of {(0,f) -> u f ((u word_o (u (u word_from_bits (_6575-1)) bits_e))); (1,f) -> u f (\_6577-> (u word_o (u (u word_from_bits (_6575-1)) _6577))); (2,f) -> u f (\_6578-> (u word_i (u (u word_from_bits (_6575-1)) _6578))); }))))))
fm_name_from_bits = (\_bits_1-> (let _list_2=(u (u bits_chunks_of 6) _bits_1) in (let _name_3=(u (u (u list_fold _list_2) string_nil) (\_bts_3-> (\_name_4-> (let _u16_5=(u u16_new (u (u word_from_bits 16) (u bits_reverse _bts_3))) in (let _chr_6=(let _6579 = (u (u (u u16_btw 0) _u16_5) 25) in (if _6579 then (((_u16_5::Word16) + 65)) else (let _6580 = (u (u (u u16_btw 26) _u16_5) 51) in (if _6580 then (((_u16_5::Word16) + 71)) else (let _6581 = (u (u (u u16_btw 52) _u16_5) 61) in (if _6581 then (((_u16_5::Word16) - 4)) else (let _6582 = (((62::Word16) == _u16_5)) in (if _6582 then 46 else 95)))))))) in (u (u string_cons _chr_6) _name_4)))))) in _name_3)))
fm_term_show_go = (\_term_1-> (\_path_2-> (let _6583 = (u fm_term_show_as_nat _term_1) in (case _6583 of {(0,f) -> u f ((let _6584 = _term_1 in (case _6584 of {(0,f) -> u f (\_6585 _6586-> (u fm_name_show _6585)); (1,f) -> u f (\_6587-> (let _name_4=(u fm_name_show _6587) in (let _6588 = _path_2 in (case _6588 of {(0,f) -> u f (_name_4); (1,f) -> u f (\_6589-> (let _path_val_6=(u (u bits_concat (u fm_path_to_bits _6589)) (u bits_i bits_e)) in (let _path_str_7=(u nat_show (u bits_to_nat _path_val_6)) in (u string_flatten (u (u list_cons _name_4) (u (u list_cons (u (u fm_color "2") ((("-"::String) ++ _path_str_7)))) list_nil)))))); })))); (2,f) -> u f ("Type"); (3,f) -> u f (\_6590 _6591 _6592 _6593 _6594-> (let _eras_8=_6590 in (let _self_9=(u fm_name_show _6591) in (let _name_10=(u fm_name_show _6592) in (let _type_11=(u (u fm_term_show_go _6593) (u fm_mpath_o _path_2)) in (let _open_12=(let _6595 = _eras_8 in (if _6595 then "<" else "(")) in (let _clos_13=(let _6596 = _eras_8 in (if _6596 then ">" else ")")) in (let _body_14=(u (u fm_term_show_go (u (u _6594 (u (u fm_term_var _6591) 0)) (u (u fm_term_var _6592) 0))) (u fm_mpath_i _path_2)) in (u string_flatten (u (u list_cons _self_9) (u (u list_cons _open_12) (u (u list_cons _name_10) (u (u list_cons ":") (u (u list_cons _type_11) (u (u list_cons _clos_13) (u (u list_cons " ") (u (u list_cons _body_14) list_nil))))))))))))))))); (4,f) -> u f (\_6597 _6598-> (let _name_5=(u fm_name_show _6597) in (let _body_6=(u (u fm_term_show_go (u _6598 (u (u fm_term_var _6597) 0))) (u fm_mpath_o _path_2)) in (u string_flatten (u (u list_cons "(") (u (u list_cons _name_5) (u (u list_cons ") ") (u (u list_cons _body_6) list_nil)))))))); (5,f) -> u f (\_6599 _6600-> (u (u (u fm_term_show_app _term_1) _path_2) list_nil)); (6,f) -> u f (\_6601 _6602 _6603-> (let _name_6=(u fm_name_show _6601) in (let _expr_7=(u (u fm_term_show_go _6602) (u fm_mpath_o _path_2)) in (let _body_8=(u (u fm_term_show_go (u _6603 (u (u fm_term_var _6601) 0))) (u fm_mpath_i _path_2)) in (u string_flatten (u (u list_cons "let ") (u (u list_cons _name_6) (u (u list_cons " = ") (u (u list_cons _expr_7) (u (u list_cons "; ") (u (u list_cons _body_8) list_nil))))))))))); (7,f) -> u f (\_6604 _6605 _6606-> (let _name_6=(u fm_name_show _6604) in (let _expr_7=(u (u fm_term_show_go _6605) (u fm_mpath_o _path_2)) in (let _body_8=(u (u fm_term_show_go (u _6606 (u (u fm_term_var _6604) 0))) (u fm_mpath_i _path_2)) in (u string_flatten (u (u list_cons "def ") (u (u list_cons _name_6) (u (u list_cons " = ") (u (u list_cons _expr_7) (u (u list_cons "; ") (u (u list_cons _body_8) list_nil))))))))))); (8,f) -> u f (\_6607 _6608 _6609-> (let _term_6=(u (u fm_term_show_go _6608) (u fm_mpath_o _path_2)) in (let _type_7=(u (u fm_term_show_go _6609) (u fm_mpath_i _path_2)) in (u string_flatten (u (u list_cons _term_6) (u (u list_cons "::") (u (u list_cons _type_7) list_nil))))))); (9,f) -> u f (\_6610 _6611 _6612-> (let _name_6=(u fm_name_show _6610) in (u string_flatten (u (u list_cons "?") (u (u list_cons _name_6) list_nil))))); (10,f) -> u f (\_6613-> "_"); (11,f) -> u f (\_6614-> (u string_flatten (u (u list_cons (u nat_show _6614)) list_nil))); (12,f) -> u f (\_6615-> (u string_flatten (u (u list_cons "'") (u (u list_cons (u fm_escape_char _6615)) (u (u list_cons "'") list_nil))))); (13,f) -> u f (\_6616-> (u string_flatten (u (u list_cons "\"") (u (u list_cons (u fm_escape _6616)) (u (u list_cons "\"") list_nil))))); (14,f) -> u f (\_6617 _6618 _6619 _6620 _6621 _6622-> (let _expr_9=(u (u fm_term_show_go _6618) (u fm_mpath_o _path_2)) in (let _name_10=(u fm_name_show _6619) in (let _wyth_11=(u (u string_join "") (u (u list_mapped _6620) (\_defn_11-> (let _6623 = _defn_11 in (case _6623 of {(0,f) -> u f (\_6624 _6625 _6626 _6627 _6628 _6629 _6630 _6631-> (let _name_20=(u fm_name_show _6627) in (let _type_21=(u (u fm_term_show_go _6629) maybe_none) in (let _term_22=(u (u fm_term_show_go _6628) maybe_none) in (u string_flatten (u (u list_cons _name_20) (u (u list_cons ": ") (u (u list_cons _type_21) (u (u list_cons " = ") (u (u list_cons _term_22) (u (u list_cons ";") list_nil))))))))))); }))))) in (let _cses_12=(u map_to_list _6621) in (let _cses_13=(u (u string_join "") (u (u list_mapped _cses_12) (\_x_13-> (let _name_14=(u fm_name_from_bits (u pair_fst _x_13)) in (let _term_15=(u (u fm_term_show_go (u pair_snd _x_13)) maybe_none) in (u string_flatten (u (u list_cons _name_14) (u (u list_cons ": ") (u (u list_cons _term_15) (u (u list_cons "; ") list_nil)))))))))) in (let _moti_14=(let _6632 = _6622 in (case _6632 of {(0,f) -> u f (""); (1,f) -> u f (\_6633-> (u string_flatten (u (u list_cons ": ") (u (u list_cons (u (u fm_term_show_go _6633) maybe_none)) list_nil)))); })) in (u string_flatten (u (u list_cons "case ") (u (u list_cons _expr_9) (u (u list_cons " as ") (u (u list_cons _name_10) (u (u list_cons _wyth_11) (u (u list_cons " { ") (u (u list_cons _cses_13) (u (u list_cons "}") (u (u list_cons _moti_14) list_nil))))))))))))))))); (15,f) -> u f (\_6634 _6635-> (u (u fm_term_show_go _6635) _path_2)); }))); (1,f) -> u f (\_6636-> _6636); }))))
fm_term_show = (\_term_1-> (u (u fm_term_show_go _term_1) maybe_none))
fm_defs_report_types = (\_defs_1-> (\_names_2-> (let _types_3="" in (let _types_4=(u (u (u list_for _names_2) _types_3) (\_name_4-> (\_types_5-> (let _6637 = (u (u fm_get _name_4) _defs_1) in (case _6637 of {(0,f) -> u f (_types_5); (1,f) -> u f (\_6638-> (let _6639 = _6638 in (case _6639 of {(0,f) -> u f (\_6640 _6641 _6642 _6643 _6644 _6645 _6646 _6647-> (((_types_5::String) ++ (((_name_4::String) ++ (((": "::String) ++ ((((u fm_term_show _6645)::String) ++ "\n"))))))))); }))); }))))) in _types_4))))
map_keys_go = (\_xs_2-> (\_key_3-> (\_list_4-> (let _6648 = _xs_2 in (case _6648 of {(0,f) -> u f (_list_4); (1,f) -> u f (\_6649 _6650 _6651-> (let _list0_8=(let _6652 = _6649 in (case _6652 of {(0,f) -> u f (_list_4); (1,f) -> u f (\_6653-> (u (u list_cons (u bits_reverse _key_3)) _list_4)); })) in (let _list1_9=(u (u (u map_keys_go _6650) (u bits_o _key_3)) _list0_8) in (let _list2_10=(u (u (u map_keys_go _6651) (u bits_i _key_3)) _list1_9) in _list2_10)))); })))))
map_keys = (\_xs_2-> (u list_reverse (u (u (u map_keys_go _xs_2) bits_e) list_nil)))
fm_error_relevant = (\_errors_1-> (\_got_2-> (let _6654 = _errors_1 in (case _6654 of {(0,f) -> u f (list_nil); (1,f) -> u f (\_6655 _6656-> (let _keep_5=(let _6657 = _6655 in (case _6657 of {(0,f) -> u f (\_6658 _6659 _6660 _6661-> ((not _got_2))); (1,f) -> u f (\_6662 _6663 _6664 _6665 _6666-> bool_true); (2,f) -> u f (\_6667-> bool_false); (3,f) -> u f (\_6668-> bool_false); (4,f) -> u f (\_6669 _6670-> bool_false); (5,f) -> u f (\_6671 _6672-> ((not _got_2))); (6,f) -> u f (\_6673 _6674 _6675-> ((not _got_2))); })) in (let _got_6=(let _6676 = _6655 in (case _6676 of {(0,f) -> u f (\_6677 _6678 _6679 _6680-> bool_true); (1,f) -> u f (\_6681 _6682 _6683 _6684 _6685-> _got_2); (2,f) -> u f (\_6686-> _got_2); (3,f) -> u f (\_6687-> _got_2); (4,f) -> u f (\_6688 _6689-> _got_2); (5,f) -> u f (\_6690 _6691-> bool_true); (6,f) -> u f (\_6692 _6693 _6694-> _got_2); })) in (let _tail_7=(u (u fm_error_relevant _6656) _got_6) in (let _6695 = _keep_5 in (if _6695 then (u (u list_cons _6655) _tail_7) else _tail_7)))))); }))))
fm_context_show = (\_context_1-> (let _6696 = _context_1 in (case _6696 of {(0,f) -> u f (""); (1,f) -> u f (\_6697 _6698-> (let _6699 = _6697 in (case _6699 of {(0,f) -> u f (\_6700 _6701-> (let _name_6=(u fm_name_show _6700) in (let _type_7=(u fm_term_show (u (u fm_term_normalize _6701) map_new)) in (let _rest_8=(u fm_context_show _6698) in (u string_flatten (u (u list_cons _rest_8) (u (u list_cons "- ") (u (u list_cons _name_6) (u (u list_cons ": ") (u (u list_cons _type_7) (u (u list_cons "\n") list_nil))))))))))); }))); })))
fm_term_expand_at = (\_path_1-> (\_term_2-> (\_defs_3-> (u (u (u fm_term_patch_at _path_1) _term_2) (\_term_4-> (let _6702 = _term_4 in (case _6702 of {(0,f) -> u f (\_6703 _6704-> _term_4); (1,f) -> u f (\_6705-> (let _6706 = (u (u fm_get _6705) _defs_3) in (case _6706 of {(0,f) -> u f ((u fm_term_ref _6705)); (1,f) -> u f (\_6707-> (let _6708 = _6707 in (case _6708 of {(0,f) -> u f (\_6709 _6710 _6711 _6712 _6713 _6714 _6715 _6716-> _6713); }))); }))); (2,f) -> u f (_term_4); (3,f) -> u f (\_6717 _6718 _6719 _6720 _6721-> _term_4); (4,f) -> u f (\_6722 _6723-> _term_4); (5,f) -> u f (\_6724 _6725-> _term_4); (6,f) -> u f (\_6726 _6727 _6728-> _term_4); (7,f) -> u f (\_6729 _6730 _6731-> _term_4); (8,f) -> u f (\_6732 _6733 _6734-> _term_4); (9,f) -> u f (\_6735 _6736 _6737-> _term_4); (10,f) -> u f (\_6738-> _term_4); (11,f) -> u f (\_6739-> _term_4); (12,f) -> u f (\_6740-> _term_4); (13,f) -> u f (\_6741-> _term_4); (14,f) -> u f (\_6742 _6743 _6744 _6745 _6746 _6747-> _term_4); (15,f) -> u f (\_6748 _6749-> _term_4); })))))))
fm_term_expand_ct = (\_term_1-> (\_defs_2-> (\_arity_3-> (let _6750 = _term_1 in (case _6750 of {(0,f) -> u f (\_6751 _6752-> (u (u fm_term_var _6751) _6752)); (1,f) -> u f (\_6753-> (let _6754 = (u (u fm_get _6753) _defs_2) in (case _6754 of {(0,f) -> u f ((u fm_term_ref _6753)); (1,f) -> u f (\_6755-> (let _6756 = _6755 in (case _6756 of {(0,f) -> u f (\_6757 _6758 _6759 _6760 _6761 _6762 _6763 _6764-> (let _6765 = _6763 in (if _6765 then (u fm_term_ref _6753) else _6761))); }))); }))); (2,f) -> u f (fm_term_typ); (3,f) -> u f (\_6766 _6767 _6768 _6769 _6770-> (u (u (u (u (u fm_term_all _6766) _6767) _6768) (u (u (u fm_term_expand_ct _6769) _defs_2) 0)) (\_s_9-> (\_x_10-> (u (u (u fm_term_expand_ct (u (u _6770 _s_9) _x_10)) _defs_2) 0))))); (4,f) -> u f (\_6771 _6772-> (u (u fm_term_lam _6771) (\_x_6-> (u (u (u fm_term_expand_ct (u _6772 _x_6)) _defs_2) 0)))); (5,f) -> u f (\_6773 _6774-> (u (u fm_term_app (u (u (u fm_term_expand_ct _6773) _defs_2) (u nat_succ _arity_3))) (u (u (u fm_term_expand_ct _6774) _defs_2) 0))); (6,f) -> u f (\_6775 _6776 _6777-> (u (u (u fm_term_let _6775) (u (u (u fm_term_expand_ct _6776) _defs_2) 0)) (\_x_7-> (u (u (u fm_term_expand_ct (u _6777 _x_7)) _defs_2) 0)))); (7,f) -> u f (\_6778 _6779 _6780-> (u (u (u fm_term_def _6778) (u (u (u fm_term_expand_ct _6779) _defs_2) 0)) (\_x_7-> (u (u (u fm_term_expand_ct (u _6780 _x_7)) _defs_2) 0)))); (8,f) -> u f (\_6781 _6782 _6783-> (u (u (u fm_term_ann _6781) (u (u (u fm_term_expand_ct _6782) _defs_2) 0)) (u (u (u fm_term_expand_ct _6783) _defs_2) 0))); (9,f) -> u f (\_6784 _6785 _6786-> (u (u (u fm_term_gol _6784) _6785) _6786)); (10,f) -> u f (\_6787-> (u fm_term_hol _6787)); (11,f) -> u f (\_6788-> (u fm_term_nat _6788)); (12,f) -> u f (\_6789-> (u fm_term_chr _6789)); (13,f) -> u f (\_6790-> (u fm_term_str _6790)); (14,f) -> u f (\_6791 _6792 _6793 _6794 _6795 _6796-> _term_1); (15,f) -> u f (\_6797 _6798-> (u (u fm_term_ori _6797) _6798)); })))))
fm_term_expand = (\_dref_1-> (\_term_2-> (\_defs_3-> (let _term_4=(u (u fm_term_normalize _term_2) map_new) in (let _term_5=(u (u (u list_for _dref_1) _term_4) (\_path_5-> (\_term_6-> (let _term_7=(u (u (u fm_term_expand_at _path_5) _term_6) _defs_3) in (let _term_8=(u (u fm_term_normalize _term_7) map_new) in (let _term_9=(u (u (u fm_term_expand_ct _term_8) _defs_3) 0) in (let _term_10=(u (u fm_term_normalize _term_9) map_new) in _term_10))))))) in _term_5)))))
fm_error_show = (\_error_1-> (\_defs_2-> (let _6799 = _error_1 in (case _6799 of {(0,f) -> u f (\_6800 _6801 _6802 _6803-> (let _expected_7=(let _6804 = _6801 in (case _6804 of {(0,f) -> u f (\_6805-> _6805); (1,f) -> u f (\_6806-> (u fm_term_show (u (u fm_term_normalize _6806) map_new))); })) in (let _detected_8=(let _6807 = _6802 in (case _6807 of {(0,f) -> u f (\_6808-> _6808); (1,f) -> u f (\_6809-> (u fm_term_show (u (u fm_term_normalize _6809) map_new))); })) in (u string_flatten (u (u list_cons "Type mismatch.\n") (u (u list_cons "- Expected: ") (u (u list_cons _expected_7) (u (u list_cons "\n") (u (u list_cons "- Detected: ") (u (u list_cons _detected_8) (u (u list_cons "\n") (u (u list_cons (let _6810 = _6803 in (case _6810 of {(0,f) -> u f (""); (1,f) -> u f (\_6811 _6812-> (u string_flatten (u (u list_cons "With context:\n") (u (u list_cons (u fm_context_show _6803)) list_nil)))); }))) list_nil)))))))))))); (1,f) -> u f (\_6813 _6814 _6815 _6816 _6817-> (let _goal_name_8=(u string_flatten (u (u list_cons "Goal ?") (u (u list_cons (u fm_name_show _6813)) (u (u list_cons ":\n") list_nil)))) in (let _with_type_9=(let _6818 = _6816 in (case _6818 of {(0,f) -> u f (""); (1,f) -> u f (\_6819-> (let _goal_10=(u (u (u fm_term_expand _6814) _6819) _defs_2) in (u string_flatten (u (u list_cons "With type: ") (u (u list_cons (let _6820 = _6815 in (if _6820 then (u (u fm_term_show_go _goal_10) (u maybe_some (\_x_11-> _x_11))) else (u fm_term_show _goal_10)))) (u (u list_cons "\n") list_nil)))))); })) in (let _with_ctxt_10=(let _6821 = _6817 in (case _6821 of {(0,f) -> u f (""); (1,f) -> u f (\_6822 _6823-> (u string_flatten (u (u list_cons "With ctxt:\n") (u (u list_cons (u fm_context_show _6817)) list_nil)))); })) in (u string_flatten (u (u list_cons _goal_name_8) (u (u list_cons _with_type_9) (u (u list_cons _with_ctxt_10) list_nil)))))))); (2,f) -> u f (\_6824-> (u string_flatten (u (u list_cons "Waiting for '") (u (u list_cons _6824) (u (u list_cons "'.") list_nil))))); (3,f) -> u f (\_6825-> (u string_flatten (u (u list_cons "Error on dependency '") (u (u list_cons _6825) (u (u list_cons "'.") list_nil))))); (4,f) -> u f (\_6826 _6827-> (u string_flatten (u (u list_cons "Patching: ") (u (u list_cons (u fm_term_show _6827)) list_nil)))); (5,f) -> u f (\_6828 _6829-> (u string_flatten (u (u list_cons "Undefined reference: ") (u (u list_cons (u fm_name_show _6829)) (u (u list_cons "\n") list_nil))))); (6,f) -> u f (\_6830 _6831 _6832-> (let _term_6=(u fm_term_show _6831) in (let _context_7=(u fm_context_show _6832) in (u string_flatten (u (u list_cons "Can't infer type of: ") (u (u list_cons _term_6) (u (u list_cons "\n") (u (u list_cons "With ctxt:\n") (u (u list_cons _context_7) list_nil))))))))); }))))
fm_error_origin = (\_error_1-> (let _6833 = _error_1 in (case _6833 of {(0,f) -> u f (\_6834 _6835 _6836 _6837-> _6834); (1,f) -> u f (\_6838 _6839 _6840 _6841 _6842-> maybe_none); (2,f) -> u f (\_6843-> maybe_none); (3,f) -> u f (\_6844-> maybe_none); (4,f) -> u f (\_6845 _6846-> maybe_none); (5,f) -> u f (\_6847 _6848-> _6847); (6,f) -> u f (\_6849 _6850 _6851-> _6849); })))
fm_defs_report_errors = (\_defs_1-> (let _errors_2="" in (let _errors_3=(u (u (u list_for (u map_keys _defs_1)) _errors_2) (\_key_3-> (\_errors_4-> (let _name_5=(u fm_name_from_bits _key_3) in (let _6852 = (u (u fm_get _name_5) _defs_1) in (case _6852 of {(0,f) -> u f (_errors_4); (1,f) -> u f (\_6853-> (let _6854 = _6853 in (case _6854 of {(0,f) -> u f (\_6855 _6856 _6857 _6858 _6859 _6860 _6861 _6862-> (let _6863 = _6862 in (case _6863 of {(0,f) -> u f (_errors_4); (1,f) -> u f (_errors_4); (2,f) -> u f (_errors_4); (3,f) -> u f (\_6864-> (let _6865 = _6864 in (case _6865 of {(0,f) -> u f (_errors_4); (1,f) -> u f (\_6866 _6867-> (let _name_str_18=_6858 in (let _rel_errs_19=(u (u fm_error_relevant _6864) bool_false) in (let _errors_20=(u (u (u list_for _rel_errs_19) _errors_4) (\_err_20-> (\_errors_21-> (let _err_msg_22=(u (u fm_error_show _err_20) _defs_1) in (let _ori_msg_23=(let _6868 = (u fm_error_origin _err_20) in (case _6868 of {(0,f) -> u f (_errors_21); (1,f) -> u f (\_6869-> (let _6870 = _6869 in (case _6870 of {(0,f) -> u f (\_6871 _6872-> (let _inside_26=((("Inside '"::String) ++ (((_6855::String) ++ "':\n")))) in (let _source_27=(u (u (u fm_highlight _6856) _6871) _6872) in (((_inside_26::String) ++ _source_27))))); }))); })) in (((_errors_21::String) ++ (((_err_msg_22::String) ++ (((_ori_msg_23::String) ++ "\n\n"))))))))))) in _errors_20)))); }))); }))); }))); })))))) in _errors_3)))
fm_defs_report = (\_defs_1-> (\_names_2-> (let _types_3=(u (u fm_defs_report_types _defs_1) _names_2) in (let _errors_4=(u fm_defs_report_errors _defs_1) in (let _errors_5=(let _6873 = _errors_4 in (if null (_6873::String) then "All terms check." else _errors_4)) in (((_types_3::String) ++ ((("\n"::String) ++ _errors_5)))))))))
fm_checker_io_one = (\_name_1-> (u (u (u io_monad (\_m_bind_2-> (\_m_pure_3-> _m_bind_2))) (u (u (u fm_synth_one _name_1) map_new) bool_true)) (\_new_defs_2-> (u (u (u io_monad (\_m_bind_3-> (\_m_pure_4-> _m_bind_3))) (u io_print "")) (\__3-> (let _6874 = _new_defs_2 in (case _6874 of {(0,f) -> u f ((u io_print (u (u fm_defs_report map_new) (u (u list_cons _name_1) list_nil)))); (1,f) -> u f (\_6875-> (u io_print (u (u fm_defs_report _6875) (u (u list_cons _name_1) list_nil)))); })))))))
fm_synth_many = (\_names_1-> (\_defs_2-> (\_log_3-> (let _6876 = _names_1 in (case _6876 of {(0,f) -> u f ((u (u io_monad (\_m_bind_4-> (\_m_pure_5-> _m_pure_5))) _defs_2)); (1,f) -> u f (\_6877 _6878-> (u (u (u io_monad (\_m_bind_6-> (\_m_pure_7-> _m_bind_6))) (u (u (u fm_synth_one _6877) _defs_2) _log_3)) (\_new_defs_6-> (let _6879 = _new_defs_6 in (case _6879 of {(0,f) -> u f ((u (u (u fm_synth_many _6878) _defs_2) _log_3)); (1,f) -> u f (\_6880-> (u (u (u fm_synth_many _6878) _6880) _log_3)); }))))); })))))
fm_synth_file = (\_file_1-> (\_defs_2-> (\_log_3-> (u (u (u io_monad (\_m_bind_4-> (\_m_pure_5-> _m_bind_4))) (u io_get_file _file_1)) (\_code_4-> (let _read_5=(u (u (u fm_defs_read _file_1) _code_4) _defs_2) in (let _6881 = _read_5 in (case _6881 of {(0,f) -> u f (\_6882-> (u (u io_monad (\_m_bind_7-> (\_m_pure_8-> _m_pure_8))) (u either_left _6882))); (1,f) -> u f (\_6883-> (let _file_defs_7=_6883 in (let _file_keys_8=(u map_keys _file_defs_7) in (let _file_nams_9=(u (u list_mapped _file_keys_8) fm_name_from_bits) in (u (u (u io_monad (\_m_bind_10-> (\_m_pure_11-> _m_bind_10))) (u (u (u fm_synth_many _file_nams_9) _file_defs_7) _log_3)) (\_defs_10-> (u (u io_monad (\_m_bind_11-> (\_m_pure_12-> _m_pure_12))) (u either_right (u (u pair_new _file_nams_9) _defs_10))))))))); }))))))))
fm_checker_io_file = (\_file_1-> (u (u (u io_monad (\_m_bind_2-> (\_m_pure_3-> _m_bind_2))) (u (u (u fm_synth_file _file_1) map_new) bool_true)) (\_loaded_2-> (let _6884 = _loaded_2 in (case _6884 of {(0,f) -> u f (\_6885-> (u (u (u io_monad (\_m_bind_4-> (\_m_pure_5-> _m_bind_4))) (u io_print (u string_flatten (u (u list_cons "On '") (u (u list_cons _file_1) (u (u list_cons "':") list_nil)))))) (\__4-> (u io_print _6885)))); (1,f) -> u f (\_6886-> (let _6887 = _6886 in (case _6887 of {(0,f) -> u f (\_6888 _6889-> (let _nams_6=_6888 in (let _defs_7=_6889 in (u (u (u io_monad (\_m_bind_8-> (\_m_pure_9-> _m_bind_8))) (u io_print "")) (\__8-> (u io_print (u (u fm_defs_report _defs_7) _nams_6))))))); }))); })))))
io_purify = (\_io_2-> (let _6890 = _io_2 in (case _6890 of {(0,f) -> u f (\_6891-> _6891); (1,f) -> u f (\_6892 _6893 _6894-> (u io_purify (u _6894 ""))); })))
fm_checker_code = (\_code_1-> (let _6895 = (u (u (u fm_defs_read "Main.fm") _code_1) map_new) in (case _6895 of {(0,f) -> u f (\_6896-> _6896); (1,f) -> u f (\_6897-> (u io_purify (let _defs_3=_6897 in (let _nams_4=(u (u list_mapped (u map_keys _defs_3)) fm_name_from_bits) in (u (u (u io_monad (\_m_bind_5-> (\_m_pure_6-> _m_bind_5))) (u (u (u fm_synth_many _nams_4) _defs_3) bool_false)) (\_defs_5-> (u (u io_monad (\_m_bind_6-> (\_m_pure_7-> _m_pure_7))) (u (u fm_defs_report _defs_5) _nams_4)))))))); })))
fm_term_read = (\_code_1-> (let _6898 = (u (u fm_parser_term 0) _code_1) in (case _6898 of {(0,f) -> u f (\_6899 _6900 _6901-> maybe_none); (1,f) -> u f (\_6902 _6903 _6904-> (u maybe_some _6904)); })))
fm = (let ___1=fm_to_core_io_one in (let ___2=fm_checker_io_one in (let ___3=fm_checker_io_file in (let ___4=fm_checker_code in (let ___5=fm_term_read in (u (u io_monad (\_m_bind_6-> (\_m_pure_7-> _m_pure_7))) unit_new))))))


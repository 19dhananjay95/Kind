module FormalityInternal where
import Unsafe.Coerce
import Data.Word
import Data.Bits
import Data.List (intercalate)
import Debug.Trace
import System.Exit
import System.Directory
import System.FilePath.Posix (takeDirectory)
u = unsafeCoerce
setFile :: String -> IO ()
setFile param = do
  let path = takeWhile (/= '=') param
  let file = drop (length path + 1) param
  createDirectoryIfMissing True (takeDirectory path)
  writeFile path file
delFile :: String -> IO ()
delFile param = do
  isDir <- doesDirectoryExist param
  if isDir then do
    removeDirectory param
  else do
    removeFile param
getDir :: String -> IO String
getDir param = do
  dir <- listDirectory param
  return $ intercalate ";" dir
run p = case p of {
  (1,f) -> (u f (\query param cont-> case query of {
    "print"    -> do { putStrLn param; run (cont ()); };
    "exit"     -> do { exitFailure; run (cont ()); };
    "get_line" -> do { line <- getLine; run (u cont line); };
    "set_file" -> do { setFile param; run (u cont ""); };
    "get_file" -> do { line <- readFile param; run (u cont line); };
    "del_file" -> do { delFile param; run (u cont ""); };
    "get_dir" -> do { dir <- getDir param; run (u cont dir); };
    otherwise  -> do { u cont (); };
  }));
  (0,f) -> (u f (\value-> do { (return :: a -> IO a) value; }));
}
word_to_u16       w        = u word_to_u16_go 0 w 0
word_to_u16_go 16 w      x = u x
word_to_u16_go  i (0,f)  x = u word_to_u16_go (i+1) (0,\t-> t) (x::Word16)
word_to_u16_go  i (1,f)  x = u f (\w-> word_to_u16_go (i+1) w x)
word_to_u16_go  i (2,f)  x = u f (\w-> word_to_u16_go (i+1) w (x .|. (shiftL 1 i)))
u16_to_word       x        = u u16_to_word_go 0 x (0,\t-> t)
u16_to_word_go 16 x      w = u w
u16_to_word_go  i x      w = u u16_to_word_go (i+1) (x::Word16) (if (shiftR x (16-i-1) .&. 1) > 0 then (2,\t-> t w) else (1,\t-> t w))
io = (\_a_1-> ())
io_ask = (\_query_2-> (\_param_3-> (\_then_4-> (1,\t-> t _query_2 _param_3 _then_4))))
io_bind = (\_a_3-> (\_f_4-> (let _0 = _a_3 in (case _0 of {(0,f) -> u f (\_1-> (u _f_4 _1)); (1,f) -> u f (\_2 _3 _4-> (u (u (u io_ask _2) _3) (\_x_8-> (u (u io_bind (u _4 _x_8)) _f_4)))); }))))
io_end = (\_value_2-> (0,\t-> t _value_2))
io_monad = (\_new_2-> (u (u _new_2 io_bind) io_end))
maybe = (\_a_1-> ())
map = (\_a_1-> ())
maybe_none = (0,\t-> t)
map_get = (\_bits_2-> (\_map_3-> (let _5 = _bits_2 in (case _5 of {(0,f) -> u f ((let _6 = _map_3 in (case _6 of {(0,f) -> u f (maybe_none); (1,f) -> u f (\_7 _8 _9-> _7); }))); (1,f) -> u f (\_10-> (let _11 = _map_3 in (case _11 of {(0,f) -> u f (maybe_none); (1,f) -> u f (\_12 _13 _14-> (u (u map_get _10) _13)); }))); (2,f) -> u f (\_15-> (let _16 = _map_3 in (case _16 of {(0,f) -> u f (maybe_none); (1,f) -> u f (\_17 _18 _19-> (u (u map_get _15) _19)); }))); }))))
bits_e = (0,\t-> t)
bool_false = False
bool_and = (\a0-> \a1-> (a0 && a1))
bool_true = True
cmp_as_lte = (\_cmp_1-> (let _20 = _cmp_1 in (case _20 of {(0,f) -> u f (bool_true); (1,f) -> u f (bool_true); (2,f) -> u f (bool_false); })))
cmp_ltn = (0,\t-> t)
cmp_gtn = (2,\t-> t)
word_cmp_go = (\_a_2-> (\_b_3-> (\_c_4-> (let _21 = _a_2 in (case _21 of {(0,f) -> u f ((\_b_5-> _c_4)); (1,f) -> u f (\_22-> (\_b_7-> (let _23 = _b_7 in (case _23 of {(0,f) -> u f ((\_a_pred_8-> _c_4)); (1,f) -> u f (\_24-> (\_a_pred_10-> (u (u (u word_cmp_go _a_pred_10) _24) _c_4))); (2,f) -> u f (\_25-> (\_a_pred_10-> (u (u (u word_cmp_go _a_pred_10) _25) cmp_ltn))); })) _22)); (2,f) -> u f (\_26-> (\_b_7-> (let _27 = _b_7 in (case _27 of {(0,f) -> u f ((\_a_pred_8-> _c_4)); (1,f) -> u f (\_28-> (\_a_pred_10-> (u (u (u word_cmp_go _a_pred_10) _28) cmp_gtn))); (2,f) -> u f (\_29-> (\_a_pred_10-> (u (u (u word_cmp_go _a_pred_10) _29) _c_4))); })) _26)); })) _b_3)))
cmp_eql = (1,\t-> t)
word_cmp = (\_a_2-> (\_b_3-> (u (u (u word_cmp_go _a_2) _b_3) cmp_eql)))
word_lte = (\_a_2-> (\_b_3-> (u cmp_as_lte (u (u word_cmp _a_2) _b_3))))
nat_succ = (\_pred_1-> 1+_pred_1)
nat_zero = 0
u16_lte = (\a0-> \a1-> ((a0::Word16) <= a1))
u16_btw = (\_a_1-> (\_b_2-> (\_c_3-> (((((_a_1::Word16) <= _b_2)) && (((_b_2::Word16) <= _c_3)))))))
u16_new = (\_value_1-> (word_to_u16 _value_1))
word_e = (0,\t-> t)
word = (\_size_1-> ())
word_i = (\_pred_2-> (2,\t-> t _pred_2))
word_o = (\_pred_2-> (1,\t-> t _pred_2))
word_subber = (\_a_2-> (\_b_3-> (\_c_4-> (let _30 = _a_2 in (case _30 of {(0,f) -> u f ((\_b_5-> word_e)); (1,f) -> u f (\_31-> (\_b_7-> (let _32 = _b_7 in (case _32 of {(0,f) -> u f ((\_a_pred_8-> word_e)); (1,f) -> u f (\_33-> (\_a_pred_10-> (let _34 = _c_4 in (if _34 then (u word_i (u (u (u word_subber _a_pred_10) _33) bool_true)) else (u word_o (u (u (u word_subber _a_pred_10) _33) bool_false)))))); (2,f) -> u f (\_35-> (\_a_pred_10-> (let _36 = _c_4 in (if _36 then (u word_o (u (u (u word_subber _a_pred_10) _35) bool_true)) else (u word_i (u (u (u word_subber _a_pred_10) _35) bool_true)))))); })) _31)); (2,f) -> u f (\_37-> (\_b_7-> (let _38 = _b_7 in (case _38 of {(0,f) -> u f ((\_a_pred_8-> word_e)); (1,f) -> u f (\_39-> (\_a_pred_10-> (let _40 = _c_4 in (if _40 then (u word_o (u (u (u word_subber _a_pred_10) _39) bool_false)) else (u word_i (u (u (u word_subber _a_pred_10) _39) bool_false)))))); (2,f) -> u f (\_41-> (\_a_pred_10-> (let _42 = _c_4 in (if _42 then (u word_i (u (u (u word_subber _a_pred_10) _41) bool_true)) else (u word_o (u (u (u word_subber _a_pred_10) _41) bool_false)))))); })) _37)); })) _b_3)))
word_sub = (\_a_2-> (\_b_3-> (u (u (u word_subber _a_2) _b_3) bool_false)))
u16_sub = (\a0-> \a1-> ((a0::Word16) - a1))
nat_apply = (\_n_2-> (\_f_3-> (\_x_4-> (let _43 = _n_2 in (if _43==0 then _x_4 else (u (u (u nat_apply (_43-1)) _f_3) (u _f_3 _x_4)))))))
word_inc = (\_word_2-> (let _44 = _word_2 in (case _44 of {(0,f) -> u f (word_e); (1,f) -> u f (\_45-> (u word_i _45)); (2,f) -> u f (\_46-> (u word_o (u word_inc _46))); })))
u16_inc = (\_a_1-> (let _47 = _a_1 in (u u16_new (u word_inc (u16_to_word _47)))))
word_zero = (\_size_1-> (let _48 = _size_1 in (if _48==0 then word_e else (u word_o (u word_zero (_48-1))))))
u16_zero = (u u16_new (u word_zero 16))
nat_to_u16 = (\a0-> (fromIntegral (a0::Integer)))
word_adder = (\_a_2-> (\_b_3-> (\_c_4-> (let _49 = _a_2 in (case _49 of {(0,f) -> u f ((\_b_5-> word_e)); (1,f) -> u f (\_50-> (\_b_7-> (let _51 = _b_7 in (case _51 of {(0,f) -> u f ((\_a_pred_8-> word_e)); (1,f) -> u f (\_52-> (\_a_pred_10-> (let _53 = _c_4 in (if _53 then (u word_i (u (u (u word_adder _a_pred_10) _52) bool_false)) else (u word_o (u (u (u word_adder _a_pred_10) _52) bool_false)))))); (2,f) -> u f (\_54-> (\_a_pred_10-> (let _55 = _c_4 in (if _55 then (u word_o (u (u (u word_adder _a_pred_10) _54) bool_true)) else (u word_i (u (u (u word_adder _a_pred_10) _54) bool_false)))))); })) _50)); (2,f) -> u f (\_56-> (\_b_7-> (let _57 = _b_7 in (case _57 of {(0,f) -> u f ((\_a_pred_8-> word_e)); (1,f) -> u f (\_58-> (\_a_pred_10-> (let _59 = _c_4 in (if _59 then (u word_o (u (u (u word_adder _a_pred_10) _58) bool_true)) else (u word_i (u (u (u word_adder _a_pred_10) _58) bool_false)))))); (2,f) -> u f (\_60-> (\_a_pred_10-> (let _61 = _c_4 in (if _61 then (u word_i (u (u (u word_adder _a_pred_10) _60) bool_true)) else (u word_o (u (u (u word_adder _a_pred_10) _60) bool_true)))))); })) _56)); })) _b_3)))
word_add = (\_a_2-> (\_b_3-> (u (u (u word_adder _a_2) _b_3) bool_false)))
u16_add = (\a0-> \a1-> ((a0::Word16) + a1))
cmp_as_eql = (\_cmp_1-> (let _62 = _cmp_1 in (case _62 of {(0,f) -> u f (bool_false); (1,f) -> u f (bool_true); (2,f) -> u f (bool_false); })))
word_eql = (\_a_2-> (\_b_3-> (u cmp_as_eql (u (u word_cmp _a_2) _b_3))))
u16_eql = (\a0-> \a1-> ((a0::Word16) == a1))
bits_o = (\_pred_1-> (1,\t-> t _pred_1))
bits_i = (\_pred_1-> (2,\t-> t _pred_1))
word_to_bits = (\_a_2-> (let _63 = _a_2 in (case _63 of {(0,f) -> u f (bits_e); (1,f) -> u f (\_64-> (u bits_o (u word_to_bits _64))); (2,f) -> u f (\_65-> (u bits_i (u word_to_bits _65))); })))
word_trim = (\_new_size_2-> (\_word_3-> (let _66 = _new_size_2 in (if _66==0 then word_e else (let _67 = _word_3 in (case _67 of {(0,f) -> u f ((u word_o (u (u word_trim (_66-1)) word_e))); (1,f) -> u f (\_68-> (u word_o (u (u word_trim (_66-1)) _68))); (2,f) -> u f (\_69-> (u word_i (u (u word_trim (_66-1)) _69))); }))))))
bits_concat = (\_a_1-> (\_b_2-> (let _70 = _a_1 in (case _70 of {(0,f) -> u f (_b_2); (1,f) -> u f (\_71-> (u bits_o (u (u bits_concat _71) _b_2))); (2,f) -> u f (\_72-> (u bits_i (u (u bits_concat _72) _b_2))); }))))
bits_reverse_tco = (\_a_1-> (\_r_2-> (let _73 = _a_1 in (case _73 of {(0,f) -> u f (_r_2); (1,f) -> u f (\_74-> (u (u bits_reverse_tco _74) (u bits_o _r_2))); (2,f) -> u f (\_75-> (u (u bits_reverse_tco _75) (u bits_i _r_2))); }))))
bits_reverse = (\_a_1-> (u (u bits_reverse_tco _a_1) bits_e))
fm_name_to_bits = (\_name_1-> (let _76 = _name_1 in (if null (_76::String) then bits_e else (let _chr_4=(fromIntegral (fromEnum (head _76 :: Char)) :: Word16) in (let _u16_5=(let _77 = (u (u (u u16_btw 65) _chr_4) 90) in (if _77 then (((_chr_4::Word16) - 65)) else (let _78 = (u (u (u u16_btw 97) _chr_4) 122) in (if _78 then (((_chr_4::Word16) - 71)) else (let _79 = (u (u (u u16_btw 48) _chr_4) 57) in (if _79 then (((_chr_4::Word16) + 4)) else (let _80 = (((46::Word16) == _chr_4)) in (if _80 then 62 else (let _81 = (((95::Word16) == _chr_4)) in (if _81 then 63 else 0)))))))))) in (let _bts_6=(let _82 = _u16_5 in (u word_to_bits (u (u word_trim 6) (u16_to_word _82)))) in (u (u bits_concat (u bits_reverse _bts_6)) (u fm_name_to_bits (tail _76)))))))))
fm_get = (\_name_2-> (\_map_3-> (u (u map_get (u fm_name_to_bits _name_2)) _map_3)))
io_get_file = (\_name_1-> (u (u (u io_ask "get_file") _name_1) (\_file_2-> (u io_end _file_2))))
parser_reply = (\_v_1-> ())
parser_reply_value = (\_idx_2-> (\_code_3-> (\_val_4-> (1,\t-> t _idx_2 _code_3 _val_4))))
parser_is_eof = (\_idx_1-> (\_code_2-> (let _83 = _code_2 in (if null (_83::String) then (u (u (u parser_reply_value _idx_1) _code_2) bool_true) else (u (u (u parser_reply_value _idx_1) _code_2) bool_false)))))
parser_reply_error = (\_idx_2-> (\_code_3-> (\_err_4-> (0,\t-> t _idx_2 _code_3 _err_4))))
parser = (\_v_1-> ())
maybe_some = (\_value_2-> (1,\t-> t _value_2))
parser_errorat_new = (\_idx_1-> (\_code_2-> (\_err_3-> (0,\t-> t _idx_1 _code_2 _err_3))))
nat_gtn = (\a0-> \a1-> ((a0::Integer) > a1))
parser_errorat_combine = (\_a_1-> (\_b_2-> (let _84 = _a_1 in (case _84 of {(0,f) -> u f (_b_2); (1,f) -> u f (\_85-> (let _86 = _b_2 in (case _86 of {(0,f) -> u f (_a_1); (1,f) -> u f (\_87-> (let _88 = _85 in (case _88 of {(0,f) -> u f (\_89 _90 _91-> (let _92 = _87 in (case _92 of {(0,f) -> u f (\_93 _94 _95-> (let _96 = (((_89::Integer) > _93)) in (if _96 then _a_1 else _b_2))); }))); }))); }))); }))))
parser_first_of_go = (\_pars_2-> (\_err_3-> (\_idx_4-> (\_code_5-> (let _97 = _pars_2 in (case _97 of {(0,f) -> u f ((let _98 = _err_3 in (case _98 of {(0,f) -> u f ((u (u (u parser_reply_error _idx_4) _code_5) "No parse.")); (1,f) -> u f (\_99-> (let _100 = _99 in (case _100 of {(0,f) -> u f (\_101 _102 _103-> (u (u (u parser_reply_error _101) _102) _103)); }))); }))); (1,f) -> u f (\_104 _105-> (let _parsed_8=(u (u _104 _idx_4) _code_5) in (let _106 = _parsed_8 in (case _106 of {(0,f) -> u f (\_107 _108 _109-> (let _neo_12=(u maybe_some (u (u (u parser_errorat_new _107) _108) _109)) in (let _err_13=(u (u parser_errorat_combine _neo_12) _err_3) in (u (u (u (u parser_first_of_go _105) _err_13) _idx_4) _code_5)))); (1,f) -> u f (\_110 _111 _112-> (u (u (u parser_reply_value _110) _111) _112)); })))); }))))))
parser_first_of = (\_pars_2-> (u (u parser_first_of_go _pars_2) maybe_none))
list_cons = (\_head_2-> (\_tail_3-> (1,\t-> t _head_2 _tail_3)))
list = (\_a_1-> ())
list_nil = (0,\t-> t)
parser_many_go = (\_parse_2-> (\_values_3-> (\_idx_4-> (\_code_5-> (let _113 = (u (u _parse_2 _idx_4) _code_5) in (case _113 of {(0,f) -> u f (\_114 _115 _116-> (u (u (u parser_reply_value _idx_4) _code_5) (u _values_3 list_nil))); (1,f) -> u f (\_117 _118 _119-> (u (u (u (u parser_many_go _parse_2) (\_xs_9-> (u _values_3 (u (u list_cons _119) _xs_9)))) _117) _118)); }))))))
parser_many = (\_parser_2-> (u (u parser_many_go _parser_2) (\_x_3-> _x_3)))
unit_new = ()
string_cons = (\_head_1-> (\_tail_2-> ((toEnum (fromIntegral _head_1 :: Int) :: Char) : _tail_2)))
string_concat = (\a0-> \a1-> ((a0::String) ++ a1))
string_flatten_go = (\_xs_1-> (\_res_2-> (let _120 = _xs_1 in (case _120 of {(0,f) -> u f (_res_2); (1,f) -> u f (\_121 _122-> (u (u string_flatten_go _122) (((_res_2::String) ++ _121)))); }))))
string_flatten = (\_xs_1-> (u (u string_flatten_go _xs_1) ""))
string_nil = []
parser_text_go = (\_text_1-> (\_idx_2-> (\_code_3-> (let _123 = _text_1 in (if null (_123::String) then (u (u (u parser_reply_value _idx_2) _code_3) unit_new) else (let _124 = _code_3 in (if null (_124::String) then (let _error_6=(u string_flatten (u (u list_cons "Expected '") (u (u list_cons _text_1) (u (u list_cons "', found end of file.") list_nil)))) in (u (u (u parser_reply_error _idx_2) _code_3) _error_6)) else (let _125 = ((((fromIntegral (fromEnum (head _123 :: Char)) :: Word16)::Word16) == (fromIntegral (fromEnum (head _124 :: Char)) :: Word16))) in (if _125 then (u (u (u parser_text (tail _123)) (u nat_succ _idx_2)) (tail _124)) else (let _error_8=(u string_flatten (u (u list_cons "Expected '") (u (u list_cons _text_1) (u (u list_cons "', found '") (u (u list_cons (u (u string_cons (fromIntegral (fromEnum (head _124 :: Char)) :: Word16)) string_nil)) (u (u list_cons "'.") list_nil)))))) in (u (u (u parser_reply_error _idx_2) _code_3) _error_8)))))))))))
parser_text = (\_text_1-> (\_idx_2-> (\_code_3-> (let _126 = (u (u (u parser_text_go _text_1) _idx_2) _code_3) in (case _126 of {(0,f) -> u f (\_127 _128 _129-> (u (u (u parser_reply_error _idx_2) _code_3) _129)); (1,f) -> u f (\_130 _131 _132-> (u (u (u parser_reply_value _130) _131) _132)); })))))
parser_until_go = (\_until_2-> (\_parse_3-> (\_values_4-> (\_idx_5-> (\_code_6-> (let _until_reply_7=(u (u _until_2 _idx_5) _code_6) in (let _133 = _until_reply_7 in (case _133 of {(0,f) -> u f (\_134 _135 _136-> (let _reply_11=(u (u _parse_3 _idx_5) _code_6) in (let _137 = _reply_11 in (case _137 of {(0,f) -> u f (\_138 _139 _140-> (u (u (u parser_reply_error _138) _139) _140)); (1,f) -> u f (\_141 _142 _143-> (u (u (u (u (u parser_until_go _until_2) _parse_3) (\_xs_15-> (u _values_4 (u (u list_cons _143) _xs_15)))) _141) _142)); })))); (1,f) -> u f (\_144 _145 _146-> (u (u (u parser_reply_value _144) _145) (u _values_4 list_nil))); }))))))))
parser_until = (\_until_2-> (\_parse_3-> (u (u (u parser_until_go _until_2) _parse_3) (\_x_4-> _x_4))))
parser_one = (\_idx_1-> (\_code_2-> (let _147 = _code_2 in (if null (_147::String) then (u (u (u parser_reply_error _idx_1) _code_2) "Unexpected end of file.") else (u (u (u parser_reply_value (u nat_succ _idx_1)) (tail _147)) (fromIntegral (fromEnum (head _147 :: Char)) :: Word16))))))
fm_parser_spaces = (u parser_many (u parser_first_of (u (u list_cons (u parser_text " ")) (u (u list_cons (u parser_text "\t")) (u (u list_cons (u parser_text "\n")) (u (u list_cons (\_idx_1-> (\_code_2-> (let _148 = (u (u (u parser_text "//") _idx_1) _code_2) in (case _148 of {(0,f) -> u f (\_149 _150 _151-> (u (u (u parser_reply_error _149) _150) _151)); (1,f) -> u f (\_152 _153 _154-> (let _155 = (u (u (u (u parser_until (u parser_text "\n")) parser_one) _152) _153) in (case _155 of {(0,f) -> u f (\_156 _157 _158-> (u (u (u parser_reply_error _156) _157) _158)); (1,f) -> u f (\_159 _160 _161-> (u (u (u parser_reply_value _159) _160) unit_new)); }))); }))))) list_nil))))))
parser_get_index = (\_idx_1-> (\_code_2-> (u (u (u parser_reply_value _idx_1) _code_2) _idx_1)))
fm_parser_init = (\_idx_1-> (\_code_2-> (let _162 = (u (u fm_parser_spaces _idx_1) _code_2) in (case _162 of {(0,f) -> u f (\_163 _164 _165-> (u (u (u parser_reply_error _163) _164) _165)); (1,f) -> u f (\_166 _167 _168-> (let _169 = (u (u parser_get_index _166) _167) in (case _169 of {(0,f) -> u f (\_170 _171 _172-> (u (u (u parser_reply_error _170) _171) _172)); (1,f) -> u f (\_173 _174 _175-> (u (u (u parser_reply_value _173) _174) _175)); }))); }))))
parser_many1 = (\_parser_2-> (\_idx_3-> (\_code_4-> (let _176 = (u (u _parser_2 _idx_3) _code_4) in (case _176 of {(0,f) -> u f (\_177 _178 _179-> (u (u (u parser_reply_error _177) _178) _179)); (1,f) -> u f (\_180 _181 _182-> (let _183 = (u (u (u parser_many _parser_2) _180) _181) in (case _183 of {(0,f) -> u f (\_184 _185 _186-> (u (u (u parser_reply_error _184) _185) _186)); (1,f) -> u f (\_187 _188 _189-> (u (u (u parser_reply_value _187) _188) (u (u list_cons _182) _189))); }))); })))))
fm_name_is_letter = (\_chr_1-> (let _190 = (u (u (u u16_btw 65) _chr_1) 90) in (if _190 then bool_true else (let _191 = (u (u (u u16_btw 97) _chr_1) 122) in (if _191 then bool_true else (let _192 = (u (u (u u16_btw 48) _chr_1) 57) in (if _192 then bool_true else (let _193 = (((46::Word16) == _chr_1)) in (if _193 then bool_true else (let _194 = (((95::Word16) == _chr_1)) in (if _194 then bool_true else (let _195 = (((94::Word16) == _chr_1)) in (if _195 then bool_true else bool_false)))))))))))))
fm_parser_letter = (\_idx_1-> (\_code_2-> (let _196 = _code_2 in (if null (_196::String) then (u (u (u parser_reply_error _idx_1) _code_2) "Unexpected eof.") else (let _197 = (u fm_name_is_letter (fromIntegral (fromEnum (head _196 :: Char)) :: Word16)) in (if _197 then (u (u (u parser_reply_value (u nat_succ _idx_1)) (tail _196)) (fromIntegral (fromEnum (head _196 :: Char)) :: Word16)) else (u (u (u parser_reply_error _idx_1) _code_2) "Expected letter.")))))))
list_fold = (\_list_2-> (\_nil_4-> (\_cons_5-> (let _198 = _list_2 in (case _198 of {(0,f) -> u f (_nil_4); (1,f) -> u f (\_199 _200-> (u (u _cons_5 _199) (u (u (u list_fold _200) _nil_4) _cons_5))); })))))
fm_parser_name1 = (\_idx_1-> (\_code_2-> (let _201 = (u (u fm_parser_spaces _idx_1) _code_2) in (case _201 of {(0,f) -> u f (\_202 _203 _204-> (u (u (u parser_reply_error _202) _203) _204)); (1,f) -> u f (\_205 _206 _207-> (let _208 = (u (u (u parser_many1 fm_parser_letter) _205) _206) in (case _208 of {(0,f) -> u f (\_209 _210 _211-> (u (u (u parser_reply_error _209) _210) _211)); (1,f) -> u f (\_212 _213 _214-> (u (u (u parser_reply_value _212) _213) (u (u (u list_fold _214) string_nil) string_cons))); }))); }))))
fm_parser_text = (\_text_1-> (\_idx_2-> (\_code_3-> (let _215 = (u (u fm_parser_spaces _idx_2) _code_3) in (case _215 of {(0,f) -> u f (\_216 _217 _218-> (u (u (u parser_reply_error _216) _217) _218)); (1,f) -> u f (\_219 _220 _221-> (u (u (u parser_text _text_1) _219) _220)); })))))
parser_until1 = (\_cond_2-> (\_parser_3-> (\_idx_4-> (\_code_5-> (let _222 = (u (u _parser_3 _idx_4) _code_5) in (case _222 of {(0,f) -> u f (\_223 _224 _225-> (u (u (u parser_reply_error _223) _224) _225)); (1,f) -> u f (\_226 _227 _228-> (let _229 = (u (u (u (u parser_until _cond_2) _parser_3) _226) _227) in (case _229 of {(0,f) -> u f (\_230 _231 _232-> (u (u (u parser_reply_error _230) _231) _232)); (1,f) -> u f (\_233 _234 _235-> (u (u (u parser_reply_value _233) _234) (u (u list_cons _228) _235))); }))); }))))))
pair = (\_a_1-> (\_b_2-> ()))
parser_maybe = (\_parse_2-> (\_idx_3-> (\_code_4-> (let _236 = (u (u _parse_2 _idx_3) _code_4) in (case _236 of {(0,f) -> u f (\_237 _238 _239-> (u (u (u parser_reply_value _idx_3) _code_4) maybe_none)); (1,f) -> u f (\_240 _241 _242-> (u (u (u parser_reply_value _240) _241) (u maybe_some _242))); })))))
fm_parser_item = (\_parser_2-> (\_idx_3-> (\_code_4-> (let _243 = (u (u fm_parser_spaces _idx_3) _code_4) in (case _243 of {(0,f) -> u f (\_244 _245 _246-> (u (u (u parser_reply_error _244) _245) _246)); (1,f) -> u f (\_247 _248 _249-> (let _250 = (u (u _parser_2 _247) _248) in (case _250 of {(0,f) -> u f (\_251 _252 _253-> (u (u (u parser_reply_error _251) _252) _253)); (1,f) -> u f (\_254 _255 _256-> (let _257 = (u (u (u parser_maybe (u fm_parser_text ",")) _254) _255) in (case _257 of {(0,f) -> u f (\_258 _259 _260-> (u (u (u parser_reply_error _258) _259) _260)); (1,f) -> u f (\_261 _262 _263-> (u (u (u parser_reply_value _261) _262) _256)); }))); }))); })))))
fm_parser_name = (\_idx_1-> (\_code_2-> (let _264 = (u (u fm_parser_spaces _idx_1) _code_2) in (case _264 of {(0,f) -> u f (\_265 _266 _267-> (u (u (u parser_reply_error _265) _266) _267)); (1,f) -> u f (\_268 _269 _270-> (let _271 = (u (u (u parser_many fm_parser_letter) _268) _269) in (case _271 of {(0,f) -> u f (\_272 _273 _274-> (u (u (u parser_reply_error _272) _273) _274)); (1,f) -> u f (\_275 _276 _277-> (u (u (u parser_reply_value _275) _276) (u (u (u list_fold _277) string_nil) string_cons))); }))); }))))
pair_new = (\_fst_3-> (\_snd_4-> (0,\t-> t _fst_3 _snd_4)))
fm_parser_stop = (\_from_1-> (\_idx_2-> (\_code_3-> (let _278 = (u (u parser_get_index _idx_2) _code_3) in (case _278 of {(0,f) -> u f (\_279 _280 _281-> (u (u (u parser_reply_error _279) _280) _281)); (1,f) -> u f (\_282 _283 _284-> (let _orig_7=(u (u pair_new _from_1) _284) in (u (u (u parser_reply_value _282) _283) _orig_7))); })))))
fm_term_ori = (\_orig_1-> (\_expr_2-> (15,\t-> t _orig_1 _expr_2)))
fm_term_typ = (2,\t-> t)
fm_parser_type = (\_idx_1-> (\_code_2-> (let _285 = (u (u fm_parser_init _idx_1) _code_2) in (case _285 of {(0,f) -> u f (\_286 _287 _288-> (u (u (u parser_reply_error _286) _287) _288)); (1,f) -> u f (\_289 _290 _291-> (let _292 = (u (u (u fm_parser_text "Type") _289) _290) in (case _292 of {(0,f) -> u f (\_293 _294 _295-> (u (u (u parser_reply_error _293) _294) _295)); (1,f) -> u f (\_296 _297 _298-> (let _299 = (u (u (u fm_parser_stop _291) _296) _297) in (case _299 of {(0,f) -> u f (\_300 _301 _302-> (u (u (u parser_reply_error _300) _301) _302)); (1,f) -> u f (\_303 _304 _305-> (u (u (u parser_reply_value _303) _304) (u (u fm_term_ori _305) fm_term_typ))); }))); }))); }))))
fm_term_all = (\_eras_1-> (\_self_2-> (\_name_3-> (\_xtyp_4-> (\_body_5-> (3,\t-> t _eras_1 _self_2 _name_3 _xtyp_4 _body_5))))))
fm_parser_forall = (\_idx_1-> (\_code_2-> (let _306 = (u (u fm_parser_init _idx_1) _code_2) in (case _306 of {(0,f) -> u f (\_307 _308 _309-> (u (u (u parser_reply_error _307) _308) _309)); (1,f) -> u f (\_310 _311 _312-> (let _313 = (u (u fm_parser_name _310) _311) in (case _313 of {(0,f) -> u f (\_314 _315 _316-> (u (u (u parser_reply_error _314) _315) _316)); (1,f) -> u f (\_317 _318 _319-> (let _320 = (u (u fm_parser_binder _317) _318) in (case _320 of {(0,f) -> u f (\_321 _322 _323-> (u (u (u parser_reply_error _321) _322) _323)); (1,f) -> u f (\_324 _325 _326-> (let _327 = (u (u (u parser_maybe (u fm_parser_text "->")) _324) _325) in (case _327 of {(0,f) -> u f (\_328 _329 _330-> (u (u (u parser_reply_error _328) _329) _330)); (1,f) -> u f (\_331 _332 _333-> (let _334 = (u (u fm_parser_term _331) _332) in (case _334 of {(0,f) -> u f (\_335 _336 _337-> (u (u (u parser_reply_error _335) _336) _337)); (1,f) -> u f (\_338 _339 _340-> (let _term_18=(u (u (u list_fold _326) _340) (\_x_18-> (\_t_19-> (let _341 = _x_18 in (case _341 of {(0,f) -> u f (\_342 _343 _344-> (u (u (u (u (u fm_term_all _342) "") _343) _344) (\_s_23-> (\_x_24-> _t_19)))); }))))) in (let _345 = (u (u (u fm_parser_stop _312) _338) _339) in (case _345 of {(0,f) -> u f (\_346 _347 _348-> (u (u (u parser_reply_error _346) _347) _348)); (1,f) -> u f (\_349 _350 _351-> (u (u (u parser_reply_value _349) _350) (let _352 = _term_18 in (case _352 of {(0,f) -> u f (\_353 _354-> _term_18); (1,f) -> u f (\_355-> _term_18); (2,f) -> u f (_term_18); (3,f) -> u f (\_356 _357 _358 _359 _360-> (u (u fm_term_ori _351) (u (u (u (u (u fm_term_all _356) _319) _358) _359) _360))); (4,f) -> u f (\_361 _362-> _term_18); (5,f) -> u f (\_363 _364-> _term_18); (6,f) -> u f (\_365 _366 _367-> _term_18); (7,f) -> u f (\_368 _369 _370-> _term_18); (8,f) -> u f (\_371 _372 _373-> _term_18); (9,f) -> u f (\_374 _375 _376-> _term_18); (10,f) -> u f (\_377-> _term_18); (11,f) -> u f (\_378-> _term_18); (12,f) -> u f (\_379-> _term_18); (13,f) -> u f (\_380-> _term_18); (14,f) -> u f (\_381 _382 _383 _384 _385 _386-> _term_18); (15,f) -> u f (\_387 _388-> _term_18); })))); })))); }))); }))); }))); }))); }))))
fm_term_lam = (\_name_1-> (\_body_2-> (4,\t-> t _name_1 _body_2)))
fm_parser_make_lambda = (\_names_1-> (\_body_2-> (let _389 = _names_1 in (case _389 of {(0,f) -> u f (_body_2); (1,f) -> u f (\_390 _391-> (u (u fm_term_lam _390) (\_x_5-> (u (u fm_parser_make_lambda _391) _body_2)))); }))))
fm_parser_lambda = (\_idx_1-> (\_code_2-> (let _392 = (u (u fm_parser_init _idx_1) _code_2) in (case _392 of {(0,f) -> u f (\_393 _394 _395-> (u (u (u parser_reply_error _393) _394) _395)); (1,f) -> u f (\_396 _397 _398-> (let _399 = (u (u (u fm_parser_text "(") _396) _397) in (case _399 of {(0,f) -> u f (\_400 _401 _402-> (u (u (u parser_reply_error _400) _401) _402)); (1,f) -> u f (\_403 _404 _405-> (let _406 = (u (u (u (u parser_until1 (u fm_parser_text ")")) (u fm_parser_item fm_parser_name1)) _403) _404) in (case _406 of {(0,f) -> u f (\_407 _408 _409-> (u (u (u parser_reply_error _407) _408) _409)); (1,f) -> u f (\_410 _411 _412-> (let _413 = (u (u fm_parser_term _410) _411) in (case _413 of {(0,f) -> u f (\_414 _415 _416-> (u (u (u parser_reply_error _414) _415) _416)); (1,f) -> u f (\_417 _418 _419-> (let _420 = (u (u (u fm_parser_stop _398) _417) _418) in (case _420 of {(0,f) -> u f (\_421 _422 _423-> (u (u (u parser_reply_error _421) _422) _423)); (1,f) -> u f (\_424 _425 _426-> (let _expr_18=(u (u fm_parser_make_lambda _412) _419) in (u (u (u parser_reply_value _424) _425) (u (u fm_term_ori _426) _expr_18)))); }))); }))); }))); }))); }))))
fm_parser_lambda_erased = (\_idx_1-> (\_code_2-> (let _427 = (u (u fm_parser_init _idx_1) _code_2) in (case _427 of {(0,f) -> u f (\_428 _429 _430-> (u (u (u parser_reply_error _428) _429) _430)); (1,f) -> u f (\_431 _432 _433-> (let _434 = (u (u (u fm_parser_text "<") _431) _432) in (case _434 of {(0,f) -> u f (\_435 _436 _437-> (u (u (u parser_reply_error _435) _436) _437)); (1,f) -> u f (\_438 _439 _440-> (let _441 = (u (u (u (u parser_until1 (u fm_parser_text ">")) (u fm_parser_item fm_parser_name1)) _438) _439) in (case _441 of {(0,f) -> u f (\_442 _443 _444-> (u (u (u parser_reply_error _442) _443) _444)); (1,f) -> u f (\_445 _446 _447-> (let _448 = (u (u fm_parser_term _445) _446) in (case _448 of {(0,f) -> u f (\_449 _450 _451-> (u (u (u parser_reply_error _449) _450) _451)); (1,f) -> u f (\_452 _453 _454-> (let _455 = (u (u (u fm_parser_stop _433) _452) _453) in (case _455 of {(0,f) -> u f (\_456 _457 _458-> (u (u (u parser_reply_error _456) _457) _458)); (1,f) -> u f (\_459 _460 _461-> (let _expr_18=(u (u fm_parser_make_lambda _447) _454) in (u (u (u parser_reply_value _459) _460) (u (u fm_term_ori _461) _expr_18)))); }))); }))); }))); }))); }))))
fm_parser_lambda_nameless = (\_idx_1-> (\_code_2-> (let _462 = (u (u fm_parser_init _idx_1) _code_2) in (case _462 of {(0,f) -> u f (\_463 _464 _465-> (u (u (u parser_reply_error _463) _464) _465)); (1,f) -> u f (\_466 _467 _468-> (let _469 = (u (u (u fm_parser_text "()") _466) _467) in (case _469 of {(0,f) -> u f (\_470 _471 _472-> (u (u (u parser_reply_error _470) _471) _472)); (1,f) -> u f (\_473 _474 _475-> (let _476 = (u (u fm_parser_term _473) _474) in (case _476 of {(0,f) -> u f (\_477 _478 _479-> (u (u (u parser_reply_error _477) _478) _479)); (1,f) -> u f (\_480 _481 _482-> (let _483 = (u (u (u fm_parser_stop _468) _480) _481) in (case _483 of {(0,f) -> u f (\_484 _485 _486-> (u (u (u parser_reply_error _484) _485) _486)); (1,f) -> u f (\_487 _488 _489-> (let _expr_15=(u (u fm_term_lam "") (\_x_15-> _482)) in (u (u (u parser_reply_value _487) _488) (u (u fm_term_ori _489) _expr_15)))); }))); }))); }))); }))))
fm_parser_parenthesis = (\_idx_1-> (\_code_2-> (let _490 = (u (u (u fm_parser_text "(") _idx_1) _code_2) in (case _490 of {(0,f) -> u f (\_491 _492 _493-> (u (u (u parser_reply_error _491) _492) _493)); (1,f) -> u f (\_494 _495 _496-> (let _497 = (u (u fm_parser_term _494) _495) in (case _497 of {(0,f) -> u f (\_498 _499 _500-> (u (u (u parser_reply_error _498) _499) _500)); (1,f) -> u f (\_501 _502 _503-> (let _504 = (u (u (u fm_parser_text ")") _501) _502) in (case _504 of {(0,f) -> u f (\_505 _506 _507-> (u (u (u parser_reply_error _505) _506) _507)); (1,f) -> u f (\_508 _509 _510-> (u (u (u parser_reply_value _508) _509) _503)); }))); }))); }))))
fm_term_ref = (\_name_1-> (1,\t-> t _name_1))
fm_term_app = (\_func_1-> (\_argm_2-> (5,\t-> t _func_1 _argm_2)))
fm_term_hol = (\_path_1-> (10,\t-> t _path_1))
fm_term_let = (\_name_1-> (\_expr_2-> (\_body_3-> (6,\t-> t _name_1 _expr_2 _body_3))))
fm_parser_letforrange_u32 = (\_idx_1-> (\_code_2-> (let _511 = (u (u fm_parser_init _idx_1) _code_2) in (case _511 of {(0,f) -> u f (\_512 _513 _514-> (u (u (u parser_reply_error _512) _513) _514)); (1,f) -> u f (\_515 _516 _517-> (let _518 = (u (u (u fm_parser_text "let ") _515) _516) in (case _518 of {(0,f) -> u f (\_519 _520 _521-> (u (u (u parser_reply_error _519) _520) _521)); (1,f) -> u f (\_522 _523 _524-> (let _525 = (u (u fm_parser_name1 _522) _523) in (case _525 of {(0,f) -> u f (\_526 _527 _528-> (u (u (u parser_reply_error _526) _527) _528)); (1,f) -> u f (\_529 _530 _531-> (let _532 = (u (u (u fm_parser_text "=") _529) _530) in (case _532 of {(0,f) -> u f (\_533 _534 _535-> (u (u (u parser_reply_error _533) _534) _535)); (1,f) -> u f (\_536 _537 _538-> (let _539 = (u (u (u fm_parser_text "for ") _536) _537) in (case _539 of {(0,f) -> u f (\_540 _541 _542-> (u (u (u parser_reply_error _540) _541) _542)); (1,f) -> u f (\_543 _544 _545-> (let _546 = (u (u fm_parser_name1 _543) _544) in (case _546 of {(0,f) -> u f (\_547 _548 _549-> (u (u (u parser_reply_error _547) _548) _549)); (1,f) -> u f (\_550 _551 _552-> (let _553 = (u (u (u fm_parser_text ":") _550) _551) in (case _553 of {(0,f) -> u f (\_554 _555 _556-> (u (u (u parser_reply_error _554) _555) _556)); (1,f) -> u f (\_557 _558 _559-> (let _560 = (u (u (u fm_parser_text "U32") _557) _558) in (case _560 of {(0,f) -> u f (\_561 _562 _563-> (u (u (u parser_reply_error _561) _562) _563)); (1,f) -> u f (\_564 _565 _566-> (let _567 = (u (u (u fm_parser_text "=") _564) _565) in (case _567 of {(0,f) -> u f (\_568 _569 _570-> (u (u (u parser_reply_error _568) _569) _570)); (1,f) -> u f (\_571 _572 _573-> (let _574 = (u (u fm_parser_term _571) _572) in (case _574 of {(0,f) -> u f (\_575 _576 _577-> (u (u (u parser_reply_error _575) _576) _577)); (1,f) -> u f (\_578 _579 _580-> (let _581 = (u (u (u fm_parser_text "..") _578) _579) in (case _581 of {(0,f) -> u f (\_582 _583 _584-> (u (u (u parser_reply_error _582) _583) _584)); (1,f) -> u f (\_585 _586 _587-> (let _588 = (u (u fm_parser_term _585) _586) in (case _588 of {(0,f) -> u f (\_589 _590 _591-> (u (u (u parser_reply_error _589) _590) _591)); (1,f) -> u f (\_592 _593 _594-> (let _595 = (u (u (u fm_parser_text ":") _592) _593) in (case _595 of {(0,f) -> u f (\_596 _597 _598-> (u (u (u parser_reply_error _596) _597) _598)); (1,f) -> u f (\_599 _600 _601-> (let _602 = (u (u fm_parser_term _599) _600) in (case _602 of {(0,f) -> u f (\_603 _604 _605-> (u (u (u parser_reply_error _603) _604) _605)); (1,f) -> u f (\_606 _607 _608-> (let _609 = (u (u (u parser_maybe (u fm_parser_text ";")) _606) _607) in (case _609 of {(0,f) -> u f (\_610 _611 _612-> (u (u (u parser_reply_error _610) _611) _612)); (1,f) -> u f (\_613 _614 _615-> (let _616 = (u (u fm_parser_term _613) _614) in (case _616 of {(0,f) -> u f (\_617 _618 _619-> (u (u (u parser_reply_error _617) _618) _619)); (1,f) -> u f (\_620 _621 _622-> (let _623 = (u (u (u fm_parser_stop _517) _620) _621) in (case _623 of {(0,f) -> u f (\_624 _625 _626-> (u (u (u parser_reply_error _624) _625) _626)); (1,f) -> u f (\_627 _628 _629-> (let _term_54=(u fm_term_ref "U32.for") in (let _term_55=(u (u fm_term_app _term_54) (u fm_term_hol bits_e)) in (let _term_56=(u (u fm_term_app _term_55) (u fm_term_ref _531)) in (let _term_57=(u (u fm_term_app _term_56) _580) in (let _term_58=(u (u fm_term_app _term_57) _594) in (let _lamb_59=(u (u fm_term_lam _552) (\_e_59-> (u (u fm_term_lam _531) (\_s_60-> _608)))) in (let _term_60=(u (u fm_term_app _term_58) _lamb_59) in (let _term_61=(u (u (u fm_term_let _531) _term_60) (\_x_61-> _622)) in (u (u (u parser_reply_value _627) _628) (u (u fm_term_ori _629) _term_61))))))))))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))))
fm_parser_letforin = (\_idx_1-> (\_code_2-> (let _630 = (u (u fm_parser_init _idx_1) _code_2) in (case _630 of {(0,f) -> u f (\_631 _632 _633-> (u (u (u parser_reply_error _631) _632) _633)); (1,f) -> u f (\_634 _635 _636-> (let _637 = (u (u (u fm_parser_text "let ") _634) _635) in (case _637 of {(0,f) -> u f (\_638 _639 _640-> (u (u (u parser_reply_error _638) _639) _640)); (1,f) -> u f (\_641 _642 _643-> (let _644 = (u (u fm_parser_name1 _641) _642) in (case _644 of {(0,f) -> u f (\_645 _646 _647-> (u (u (u parser_reply_error _645) _646) _647)); (1,f) -> u f (\_648 _649 _650-> (let _651 = (u (u (u fm_parser_text "=") _648) _649) in (case _651 of {(0,f) -> u f (\_652 _653 _654-> (u (u (u parser_reply_error _652) _653) _654)); (1,f) -> u f (\_655 _656 _657-> (let _658 = (u (u (u fm_parser_text "for ") _655) _656) in (case _658 of {(0,f) -> u f (\_659 _660 _661-> (u (u (u parser_reply_error _659) _660) _661)); (1,f) -> u f (\_662 _663 _664-> (let _665 = (u (u fm_parser_name1 _662) _663) in (case _665 of {(0,f) -> u f (\_666 _667 _668-> (u (u (u parser_reply_error _666) _667) _668)); (1,f) -> u f (\_669 _670 _671-> (let _672 = (u (u (u fm_parser_text "in") _669) _670) in (case _672 of {(0,f) -> u f (\_673 _674 _675-> (u (u (u parser_reply_error _673) _674) _675)); (1,f) -> u f (\_676 _677 _678-> (let _679 = (u (u fm_parser_term _676) _677) in (case _679 of {(0,f) -> u f (\_680 _681 _682-> (u (u (u parser_reply_error _680) _681) _682)); (1,f) -> u f (\_683 _684 _685-> (let _686 = (u (u (u fm_parser_text ":") _683) _684) in (case _686 of {(0,f) -> u f (\_687 _688 _689-> (u (u (u parser_reply_error _687) _688) _689)); (1,f) -> u f (\_690 _691 _692-> (let _693 = (u (u fm_parser_term _690) _691) in (case _693 of {(0,f) -> u f (\_694 _695 _696-> (u (u (u parser_reply_error _694) _695) _696)); (1,f) -> u f (\_697 _698 _699-> (let _700 = (u (u (u parser_maybe (u fm_parser_text ";")) _697) _698) in (case _700 of {(0,f) -> u f (\_701 _702 _703-> (u (u (u parser_reply_error _701) _702) _703)); (1,f) -> u f (\_704 _705 _706-> (let _707 = (u (u fm_parser_term _704) _705) in (case _707 of {(0,f) -> u f (\_708 _709 _710-> (u (u (u parser_reply_error _708) _709) _710)); (1,f) -> u f (\_711 _712 _713-> (let _714 = (u (u (u fm_parser_stop _636) _711) _712) in (case _714 of {(0,f) -> u f (\_715 _716 _717-> (u (u (u parser_reply_error _715) _716) _717)); (1,f) -> u f (\_718 _719 _720-> (let _term_42=(u fm_term_ref "List.for") in (let _term_43=(u (u fm_term_app _term_42) (u fm_term_hol bits_e)) in (let _term_44=(u (u fm_term_app _term_43) _685) in (let _term_45=(u (u fm_term_app _term_44) (u fm_term_hol bits_e)) in (let _term_46=(u (u fm_term_app _term_45) (u fm_term_ref _650)) in (let _lamb_47=(u (u fm_term_lam _671) (\_i_47-> (u (u fm_term_lam _650) (\_x_48-> _699)))) in (let _term_48=(u (u fm_term_app _term_46) _lamb_47) in (let _term_49=(u (u (u fm_term_let _650) _term_48) (\_x_49-> _713)) in (u (u (u parser_reply_value _718) _719) (u (u fm_term_ori _720) _term_49))))))))))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))))
fm_parser_let = (\_idx_1-> (\_code_2-> (let _721 = (u (u fm_parser_init _idx_1) _code_2) in (case _721 of {(0,f) -> u f (\_722 _723 _724-> (u (u (u parser_reply_error _722) _723) _724)); (1,f) -> u f (\_725 _726 _727-> (let _728 = (u (u (u fm_parser_text "let ") _725) _726) in (case _728 of {(0,f) -> u f (\_729 _730 _731-> (u (u (u parser_reply_error _729) _730) _731)); (1,f) -> u f (\_732 _733 _734-> (let _735 = (u (u fm_parser_name _732) _733) in (case _735 of {(0,f) -> u f (\_736 _737 _738-> (u (u (u parser_reply_error _736) _737) _738)); (1,f) -> u f (\_739 _740 _741-> (let _742 = (u (u (u fm_parser_text "=") _739) _740) in (case _742 of {(0,f) -> u f (\_743 _744 _745-> (u (u (u parser_reply_error _743) _744) _745)); (1,f) -> u f (\_746 _747 _748-> (let _749 = (u (u fm_parser_term _746) _747) in (case _749 of {(0,f) -> u f (\_750 _751 _752-> (u (u (u parser_reply_error _750) _751) _752)); (1,f) -> u f (\_753 _754 _755-> (let _756 = (u (u (u parser_maybe (u fm_parser_text ";")) _753) _754) in (case _756 of {(0,f) -> u f (\_757 _758 _759-> (u (u (u parser_reply_error _757) _758) _759)); (1,f) -> u f (\_760 _761 _762-> (let _763 = (u (u fm_parser_term _760) _761) in (case _763 of {(0,f) -> u f (\_764 _765 _766-> (u (u (u parser_reply_error _764) _765) _766)); (1,f) -> u f (\_767 _768 _769-> (let _770 = (u (u (u fm_parser_stop _727) _767) _768) in (case _770 of {(0,f) -> u f (\_771 _772 _773-> (u (u (u parser_reply_error _771) _772) _773)); (1,f) -> u f (\_774 _775 _776-> (u (u (u parser_reply_value _774) _775) (u (u fm_term_ori _776) (u (u (u fm_term_let _741) _755) (\_x_27-> _769))))); }))); }))); }))); }))); }))); }))); }))); }))))
fm_parser_get = (\_idx_1-> (\_code_2-> (let _777 = (u (u fm_parser_init _idx_1) _code_2) in (case _777 of {(0,f) -> u f (\_778 _779 _780-> (u (u (u parser_reply_error _778) _779) _780)); (1,f) -> u f (\_781 _782 _783-> (let _784 = (u (u (u fm_parser_text "let ") _781) _782) in (case _784 of {(0,f) -> u f (\_785 _786 _787-> (u (u (u parser_reply_error _785) _786) _787)); (1,f) -> u f (\_788 _789 _790-> (let _791 = (u (u (u fm_parser_text "{") _788) _789) in (case _791 of {(0,f) -> u f (\_792 _793 _794-> (u (u (u parser_reply_error _792) _793) _794)); (1,f) -> u f (\_795 _796 _797-> (let _798 = (u (u fm_parser_name _795) _796) in (case _798 of {(0,f) -> u f (\_799 _800 _801-> (u (u (u parser_reply_error _799) _800) _801)); (1,f) -> u f (\_802 _803 _804-> (let _805 = (u (u (u fm_parser_text ",") _802) _803) in (case _805 of {(0,f) -> u f (\_806 _807 _808-> (u (u (u parser_reply_error _806) _807) _808)); (1,f) -> u f (\_809 _810 _811-> (let _812 = (u (u fm_parser_name _809) _810) in (case _812 of {(0,f) -> u f (\_813 _814 _815-> (u (u (u parser_reply_error _813) _814) _815)); (1,f) -> u f (\_816 _817 _818-> (let _819 = (u (u (u fm_parser_text "}") _816) _817) in (case _819 of {(0,f) -> u f (\_820 _821 _822-> (u (u (u parser_reply_error _820) _821) _822)); (1,f) -> u f (\_823 _824 _825-> (let _826 = (u (u (u fm_parser_text "=") _823) _824) in (case _826 of {(0,f) -> u f (\_827 _828 _829-> (u (u (u parser_reply_error _827) _828) _829)); (1,f) -> u f (\_830 _831 _832-> (let _833 = (u (u fm_parser_term _830) _831) in (case _833 of {(0,f) -> u f (\_834 _835 _836-> (u (u (u parser_reply_error _834) _835) _836)); (1,f) -> u f (\_837 _838 _839-> (let _840 = (u (u (u parser_maybe (u fm_parser_text ";")) _837) _838) in (case _840 of {(0,f) -> u f (\_841 _842 _843-> (u (u (u parser_reply_error _841) _842) _843)); (1,f) -> u f (\_844 _845 _846-> (let _847 = (u (u fm_parser_term _844) _845) in (case _847 of {(0,f) -> u f (\_848 _849 _850-> (u (u (u parser_reply_error _848) _849) _850)); (1,f) -> u f (\_851 _852 _853-> (let _854 = (u (u (u fm_parser_stop _783) _851) _852) in (case _854 of {(0,f) -> u f (\_855 _856 _857-> (u (u (u parser_reply_error _855) _856) _857)); (1,f) -> u f (\_858 _859 _860-> (let _term_39=_839 in (let _term_40=(u (u fm_term_app _term_39) (u (u fm_term_lam "x") (\_x_40-> (u fm_term_hol bits_e)))) in (let _term_41=(u (u fm_term_app _term_40) (u (u fm_term_lam _804) (\_x_41-> (u (u fm_term_lam _818) (\_y_42-> _853))))) in (u (u (u parser_reply_value _858) _859) (u (u fm_term_ori _860) _term_41)))))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))))
fm_term_def = (\_name_1-> (\_expr_2-> (\_body_3-> (7,\t-> t _name_1 _expr_2 _body_3))))
fm_parser_def = (\_idx_1-> (\_code_2-> (let _861 = (u (u fm_parser_init _idx_1) _code_2) in (case _861 of {(0,f) -> u f (\_862 _863 _864-> (u (u (u parser_reply_error _862) _863) _864)); (1,f) -> u f (\_865 _866 _867-> (let _868 = (u (u (u fm_parser_text "def ") _865) _866) in (case _868 of {(0,f) -> u f (\_869 _870 _871-> (u (u (u parser_reply_error _869) _870) _871)); (1,f) -> u f (\_872 _873 _874-> (let _875 = (u (u fm_parser_name _872) _873) in (case _875 of {(0,f) -> u f (\_876 _877 _878-> (u (u (u parser_reply_error _876) _877) _878)); (1,f) -> u f (\_879 _880 _881-> (let _882 = (u (u (u fm_parser_text "=") _879) _880) in (case _882 of {(0,f) -> u f (\_883 _884 _885-> (u (u (u parser_reply_error _883) _884) _885)); (1,f) -> u f (\_886 _887 _888-> (let _889 = (u (u fm_parser_term _886) _887) in (case _889 of {(0,f) -> u f (\_890 _891 _892-> (u (u (u parser_reply_error _890) _891) _892)); (1,f) -> u f (\_893 _894 _895-> (let _896 = (u (u (u parser_maybe (u fm_parser_text ";")) _893) _894) in (case _896 of {(0,f) -> u f (\_897 _898 _899-> (u (u (u parser_reply_error _897) _898) _899)); (1,f) -> u f (\_900 _901 _902-> (let _903 = (u (u fm_parser_term _900) _901) in (case _903 of {(0,f) -> u f (\_904 _905 _906-> (u (u (u parser_reply_error _904) _905) _906)); (1,f) -> u f (\_907 _908 _909-> (let _910 = (u (u (u fm_parser_stop _867) _907) _908) in (case _910 of {(0,f) -> u f (\_911 _912 _913-> (u (u (u parser_reply_error _911) _912) _913)); (1,f) -> u f (\_914 _915 _916-> (u (u (u parser_reply_value _914) _915) (u (u fm_term_ori _916) (u (u (u fm_term_def _881) _895) (\_x_27-> _909))))); }))); }))); }))); }))); }))); }))); }))); }))))
fm_parser_if = (\_idx_1-> (\_code_2-> (let _917 = (u (u fm_parser_init _idx_1) _code_2) in (case _917 of {(0,f) -> u f (\_918 _919 _920-> (u (u (u parser_reply_error _918) _919) _920)); (1,f) -> u f (\_921 _922 _923-> (let _924 = (u (u (u fm_parser_text "if ") _921) _922) in (case _924 of {(0,f) -> u f (\_925 _926 _927-> (u (u (u parser_reply_error _925) _926) _927)); (1,f) -> u f (\_928 _929 _930-> (let _931 = (u (u fm_parser_term _928) _929) in (case _931 of {(0,f) -> u f (\_932 _933 _934-> (u (u (u parser_reply_error _932) _933) _934)); (1,f) -> u f (\_935 _936 _937-> (let _938 = (u (u (u fm_parser_text "then") _935) _936) in (case _938 of {(0,f) -> u f (\_939 _940 _941-> (u (u (u parser_reply_error _939) _940) _941)); (1,f) -> u f (\_942 _943 _944-> (let _945 = (u (u fm_parser_term _942) _943) in (case _945 of {(0,f) -> u f (\_946 _947 _948-> (u (u (u parser_reply_error _946) _947) _948)); (1,f) -> u f (\_949 _950 _951-> (let _952 = (u (u (u fm_parser_text "else") _949) _950) in (case _952 of {(0,f) -> u f (\_953 _954 _955-> (u (u (u parser_reply_error _953) _954) _955)); (1,f) -> u f (\_956 _957 _958-> (let _959 = (u (u fm_parser_term _956) _957) in (case _959 of {(0,f) -> u f (\_960 _961 _962-> (u (u (u parser_reply_error _960) _961) _962)); (1,f) -> u f (\_963 _964 _965-> (let _966 = (u (u (u fm_parser_stop _923) _963) _964) in (case _966 of {(0,f) -> u f (\_967 _968 _969-> (u (u (u parser_reply_error _967) _968) _969)); (1,f) -> u f (\_970 _971 _972-> (let _term_27=_937 in (let _term_28=(u (u fm_term_app _term_27) (u (u fm_term_lam "") (\_x_28-> (u fm_term_hol bits_e)))) in (let _term_29=(u (u fm_term_app _term_28) _951) in (let _term_30=(u (u fm_term_app _term_29) _965) in (u (u (u parser_reply_value _970) _971) (u (u fm_term_ori _972) _term_30))))))); }))); }))); }))); }))); }))); }))); }))); }))))
list_mapped = (\_as_2-> (\_f_4-> (let _973 = _as_2 in (case _973 of {(0,f) -> u f (list_nil); (1,f) -> u f (\_974 _975-> (u (u list_cons (u _f_4 _974)) (u (u list_mapped _975) _f_4))); }))))
fm_backslash = 92
fm_escapes = (u (u list_cons (u (u pair_new "\\b") 8)) (u (u list_cons (u (u pair_new "\\f") 12)) (u (u list_cons (u (u pair_new "\\n") 10)) (u (u list_cons (u (u pair_new "\\r") 13)) (u (u list_cons (u (u pair_new "\\t") 9)) (u (u list_cons (u (u pair_new "\\v") 11)) (u (u list_cons (u (u pair_new (u (u string_cons fm_backslash) (u (u string_cons fm_backslash) string_nil))) fm_backslash)) (u (u list_cons (u (u pair_new "\\\"") 34)) (u (u list_cons (u (u pair_new "\\0") 0)) (u (u list_cons (u (u pair_new "\\'") 39)) list_nil))))))))))
fm_parser_char_single = (u parser_first_of (u (u list_cons (u parser_first_of (u (u list_mapped fm_escapes) (\_esc_1-> (let _976 = _esc_1 in (case _976 of {(0,f) -> u f (\_977 _978-> (\_idx_4-> (\_code_5-> (let _979 = (u (u (u parser_text _977) _idx_4) _code_5) in (case _979 of {(0,f) -> u f (\_980 _981 _982-> (u (u (u parser_reply_error _980) _981) _982)); (1,f) -> u f (\_983 _984 _985-> (u (u (u parser_reply_value _983) _984) _978)); }))))); })))))) (u (u list_cons parser_one) list_nil)))
fm_term_chr = (\_chrx_1-> (12,\t-> t _chrx_1))
fm_parser_char = (\_idx_1-> (\_code_2-> (let _986 = (u (u fm_parser_init _idx_1) _code_2) in (case _986 of {(0,f) -> u f (\_987 _988 _989-> (u (u (u parser_reply_error _987) _988) _989)); (1,f) -> u f (\_990 _991 _992-> (let _993 = (u (u (u fm_parser_text "'") _990) _991) in (case _993 of {(0,f) -> u f (\_994 _995 _996-> (u (u (u parser_reply_error _994) _995) _996)); (1,f) -> u f (\_997 _998 _999-> (let _1000 = (u (u fm_parser_char_single _997) _998) in (case _1000 of {(0,f) -> u f (\_1001 _1002 _1003-> (u (u (u parser_reply_error _1001) _1002) _1003)); (1,f) -> u f (\_1004 _1005 _1006-> (let _1007 = (u (u (u parser_text "'") _1004) _1005) in (case _1007 of {(0,f) -> u f (\_1008 _1009 _1010-> (u (u (u parser_reply_error _1008) _1009) _1010)); (1,f) -> u f (\_1011 _1012 _1013-> (let _1014 = (u (u (u fm_parser_stop _992) _1011) _1012) in (case _1014 of {(0,f) -> u f (\_1015 _1016 _1017-> (u (u (u parser_reply_error _1015) _1016) _1017)); (1,f) -> u f (\_1018 _1019 _1020-> (u (u (u parser_reply_value _1018) _1019) (u (u fm_term_ori _1020) (u fm_term_chr _1006)))); }))); }))); }))); }))); }))))
fm_term_str = (\_strx_1-> (13,\t-> t _strx_1))
fm_parser_string = (\_idx_1-> (\_code_2-> (let _1021 = (u (u fm_parser_init _idx_1) _code_2) in (case _1021 of {(0,f) -> u f (\_1022 _1023 _1024-> (u (u (u parser_reply_error _1022) _1023) _1024)); (1,f) -> u f (\_1025 _1026 _1027-> (let _quot_6=(u (u string_cons 34) string_nil) in (let _1028 = (u (u (u fm_parser_text _quot_6) _1025) _1026) in (case _1028 of {(0,f) -> u f (\_1029 _1030 _1031-> (u (u (u parser_reply_error _1029) _1030) _1031)); (1,f) -> u f (\_1032 _1033 _1034-> (let _1035 = (u (u (u (u parser_until (u parser_text _quot_6)) fm_parser_char_single) _1032) _1033) in (case _1035 of {(0,f) -> u f (\_1036 _1037 _1038-> (u (u (u parser_reply_error _1036) _1037) _1038)); (1,f) -> u f (\_1039 _1040 _1041-> (let _strx_13=(u (u (u list_fold _1041) string_nil) string_cons) in (let _1042 = (u (u (u fm_parser_stop _1027) _1039) _1040) in (case _1042 of {(0,f) -> u f (\_1043 _1044 _1045-> (u (u (u parser_reply_error _1043) _1044) _1045)); (1,f) -> u f (\_1046 _1047 _1048-> (u (u (u parser_reply_value _1046) _1047) (u (u fm_term_ori _1048) (u fm_term_str _strx_13)))); })))); }))); })))); }))))
fm_parser_pair = (\_idx_1-> (\_code_2-> (let _1049 = (u (u fm_parser_init _idx_1) _code_2) in (case _1049 of {(0,f) -> u f (\_1050 _1051 _1052-> (u (u (u parser_reply_error _1050) _1051) _1052)); (1,f) -> u f (\_1053 _1054 _1055-> (let _1056 = (u (u (u fm_parser_text "{") _1053) _1054) in (case _1056 of {(0,f) -> u f (\_1057 _1058 _1059-> (u (u (u parser_reply_error _1057) _1058) _1059)); (1,f) -> u f (\_1060 _1061 _1062-> (let _1063 = (u (u fm_parser_term _1060) _1061) in (case _1063 of {(0,f) -> u f (\_1064 _1065 _1066-> (u (u (u parser_reply_error _1064) _1065) _1066)); (1,f) -> u f (\_1067 _1068 _1069-> (let _1070 = (u (u (u fm_parser_text ",") _1067) _1068) in (case _1070 of {(0,f) -> u f (\_1071 _1072 _1073-> (u (u (u parser_reply_error _1071) _1072) _1073)); (1,f) -> u f (\_1074 _1075 _1076-> (let _1077 = (u (u fm_parser_term _1074) _1075) in (case _1077 of {(0,f) -> u f (\_1078 _1079 _1080-> (u (u (u parser_reply_error _1078) _1079) _1080)); (1,f) -> u f (\_1081 _1082 _1083-> (let _1084 = (u (u (u fm_parser_text "}") _1081) _1082) in (case _1084 of {(0,f) -> u f (\_1085 _1086 _1087-> (u (u (u parser_reply_error _1085) _1086) _1087)); (1,f) -> u f (\_1088 _1089 _1090-> (let _1091 = (u (u (u fm_parser_stop _1055) _1088) _1089) in (case _1091 of {(0,f) -> u f (\_1092 _1093 _1094-> (u (u (u parser_reply_error _1092) _1093) _1094)); (1,f) -> u f (\_1095 _1096 _1097-> (let _term_24=(u fm_term_ref "Pair.new") in (let _term_25=(u (u fm_term_app _term_24) (u fm_term_hol bits_e)) in (let _term_26=(u (u fm_term_app _term_25) (u fm_term_hol bits_e)) in (let _term_27=(u (u fm_term_app _term_26) _1069) in (let _term_28=(u (u fm_term_app _term_27) _1083) in (u (u (u parser_reply_value _1095) _1096) (u (u fm_term_ori _1097) _term_28)))))))); }))); }))); }))); }))); }))); }))); }))))
fm_parser_sigma_type = (\_idx_1-> (\_code_2-> (let _1098 = (u (u fm_parser_init _idx_1) _code_2) in (case _1098 of {(0,f) -> u f (\_1099 _1100 _1101-> (u (u (u parser_reply_error _1099) _1100) _1101)); (1,f) -> u f (\_1102 _1103 _1104-> (let _1105 = (u (u (u fm_parser_text "{") _1102) _1103) in (case _1105 of {(0,f) -> u f (\_1106 _1107 _1108-> (u (u (u parser_reply_error _1106) _1107) _1108)); (1,f) -> u f (\_1109 _1110 _1111-> (let _1112 = (u (u fm_parser_name1 _1109) _1110) in (case _1112 of {(0,f) -> u f (\_1113 _1114 _1115-> (u (u (u parser_reply_error _1113) _1114) _1115)); (1,f) -> u f (\_1116 _1117 _1118-> (let _1119 = (u (u (u fm_parser_text ":") _1116) _1117) in (case _1119 of {(0,f) -> u f (\_1120 _1121 _1122-> (u (u (u parser_reply_error _1120) _1121) _1122)); (1,f) -> u f (\_1123 _1124 _1125-> (let _1126 = (u (u fm_parser_term _1123) _1124) in (case _1126 of {(0,f) -> u f (\_1127 _1128 _1129-> (u (u (u parser_reply_error _1127) _1128) _1129)); (1,f) -> u f (\_1130 _1131 _1132-> (let _1133 = (u (u (u fm_parser_text "}") _1130) _1131) in (case _1133 of {(0,f) -> u f (\_1134 _1135 _1136-> (u (u (u parser_reply_error _1134) _1135) _1136)); (1,f) -> u f (\_1137 _1138 _1139-> (let _1140 = (u (u fm_parser_term _1137) _1138) in (case _1140 of {(0,f) -> u f (\_1141 _1142 _1143-> (u (u (u parser_reply_error _1141) _1142) _1143)); (1,f) -> u f (\_1144 _1145 _1146-> (let _1147 = (u (u (u fm_parser_stop _1104) _1144) _1145) in (case _1147 of {(0,f) -> u f (\_1148 _1149 _1150-> (u (u (u parser_reply_error _1148) _1149) _1150)); (1,f) -> u f (\_1151 _1152 _1153-> (let _term_27=(u fm_term_ref "Sigma") in (let _term_28=(u (u fm_term_app _term_27) _1132) in (let _term_29=(u (u fm_term_app _term_28) (u (u fm_term_lam "x") (\_x_29-> _1146))) in (u (u (u parser_reply_value _1151) _1152) (u (u fm_term_ori _1153) _term_29)))))); }))); }))); }))); }))); }))); }))); }))); }))))
fm_parser_some = (\_idx_1-> (\_code_2-> (let _1154 = (u (u fm_parser_init _idx_1) _code_2) in (case _1154 of {(0,f) -> u f (\_1155 _1156 _1157-> (u (u (u parser_reply_error _1155) _1156) _1157)); (1,f) -> u f (\_1158 _1159 _1160-> (let _1161 = (u (u (u fm_parser_text "some(") _1158) _1159) in (case _1161 of {(0,f) -> u f (\_1162 _1163 _1164-> (u (u (u parser_reply_error _1162) _1163) _1164)); (1,f) -> u f (\_1165 _1166 _1167-> (let _1168 = (u (u fm_parser_term _1165) _1166) in (case _1168 of {(0,f) -> u f (\_1169 _1170 _1171-> (u (u (u parser_reply_error _1169) _1170) _1171)); (1,f) -> u f (\_1172 _1173 _1174-> (let _1175 = (u (u (u fm_parser_text ")") _1172) _1173) in (case _1175 of {(0,f) -> u f (\_1176 _1177 _1178-> (u (u (u parser_reply_error _1176) _1177) _1178)); (1,f) -> u f (\_1179 _1180 _1181-> (let _1182 = (u (u (u fm_parser_stop _1160) _1179) _1180) in (case _1182 of {(0,f) -> u f (\_1183 _1184 _1185-> (u (u (u parser_reply_error _1183) _1184) _1185)); (1,f) -> u f (\_1186 _1187 _1188-> (let _term_18=(u fm_term_ref "Maybe.some") in (let _term_19=(u (u fm_term_app _term_18) (u fm_term_hol bits_e)) in (let _term_20=(u (u fm_term_app _term_19) _1174) in (u (u (u parser_reply_value _1186) _1187) (u (u fm_term_ori _1188) _term_20)))))); }))); }))); }))); }))); }))))
fm_parser_apply = (\_idx_1-> (\_code_2-> (let _1189 = (u (u fm_parser_init _idx_1) _code_2) in (case _1189 of {(0,f) -> u f (\_1190 _1191 _1192-> (u (u (u parser_reply_error _1190) _1191) _1192)); (1,f) -> u f (\_1193 _1194 _1195-> (let _1196 = (u (u (u fm_parser_text "apply(") _1193) _1194) in (case _1196 of {(0,f) -> u f (\_1197 _1198 _1199-> (u (u (u parser_reply_error _1197) _1198) _1199)); (1,f) -> u f (\_1200 _1201 _1202-> (let _1203 = (u (u fm_parser_term _1200) _1201) in (case _1203 of {(0,f) -> u f (\_1204 _1205 _1206-> (u (u (u parser_reply_error _1204) _1205) _1206)); (1,f) -> u f (\_1207 _1208 _1209-> (let _1210 = (u (u (u fm_parser_text ",") _1207) _1208) in (case _1210 of {(0,f) -> u f (\_1211 _1212 _1213-> (u (u (u parser_reply_error _1211) _1212) _1213)); (1,f) -> u f (\_1214 _1215 _1216-> (let _1217 = (u (u fm_parser_term _1214) _1215) in (case _1217 of {(0,f) -> u f (\_1218 _1219 _1220-> (u (u (u parser_reply_error _1218) _1219) _1220)); (1,f) -> u f (\_1221 _1222 _1223-> (let _1224 = (u (u (u fm_parser_text ")") _1221) _1222) in (case _1224 of {(0,f) -> u f (\_1225 _1226 _1227-> (u (u (u parser_reply_error _1225) _1226) _1227)); (1,f) -> u f (\_1228 _1229 _1230-> (let _1231 = (u (u (u fm_parser_stop _1195) _1228) _1229) in (case _1231 of {(0,f) -> u f (\_1232 _1233 _1234-> (u (u (u parser_reply_error _1232) _1233) _1234)); (1,f) -> u f (\_1235 _1236 _1237-> (let _term_24=(u fm_term_ref "Equal.apply") in (let _term_25=(u (u fm_term_app _term_24) (u fm_term_hol bits_e)) in (let _term_26=(u (u fm_term_app _term_25) (u fm_term_hol bits_e)) in (let _term_27=(u (u fm_term_app _term_26) (u fm_term_hol bits_e)) in (let _term_28=(u (u fm_term_app _term_27) (u fm_term_hol bits_e)) in (let _term_29=(u (u fm_term_app _term_28) _1209) in (let _term_30=(u (u fm_term_app _term_29) _1223) in (u (u (u parser_reply_value _1235) _1236) (u (u fm_term_ori _1237) _term_30)))))))))); }))); }))); }))); }))); }))); }))); }))))
fm_parser_mirror = (\_idx_1-> (\_code_2-> (let _1238 = (u (u fm_parser_init _idx_1) _code_2) in (case _1238 of {(0,f) -> u f (\_1239 _1240 _1241-> (u (u (u parser_reply_error _1239) _1240) _1241)); (1,f) -> u f (\_1242 _1243 _1244-> (let _1245 = (u (u (u fm_parser_text "mirror(") _1242) _1243) in (case _1245 of {(0,f) -> u f (\_1246 _1247 _1248-> (u (u (u parser_reply_error _1246) _1247) _1248)); (1,f) -> u f (\_1249 _1250 _1251-> (let _1252 = (u (u fm_parser_term _1249) _1250) in (case _1252 of {(0,f) -> u f (\_1253 _1254 _1255-> (u (u (u parser_reply_error _1253) _1254) _1255)); (1,f) -> u f (\_1256 _1257 _1258-> (let _1259 = (u (u (u fm_parser_text ")") _1256) _1257) in (case _1259 of {(0,f) -> u f (\_1260 _1261 _1262-> (u (u (u parser_reply_error _1260) _1261) _1262)); (1,f) -> u f (\_1263 _1264 _1265-> (let _1266 = (u (u (u fm_parser_stop _1244) _1263) _1264) in (case _1266 of {(0,f) -> u f (\_1267 _1268 _1269-> (u (u (u parser_reply_error _1267) _1268) _1269)); (1,f) -> u f (\_1270 _1271 _1272-> (let _term_18=(u fm_term_ref "Equal.mirror") in (let _term_19=(u (u fm_term_app _term_18) (u fm_term_hol bits_e)) in (let _term_20=(u (u fm_term_app _term_19) (u fm_term_hol bits_e)) in (let _term_21=(u (u fm_term_app _term_20) (u fm_term_hol bits_e)) in (let _term_22=(u (u fm_term_app _term_21) _1258) in (u (u (u parser_reply_value _1270) _1271) (u (u fm_term_ori _1272) _term_22)))))))); }))); }))); }))); }))); }))))
fm_name_read = (\_str_1-> _str_1)
fm_parser_list = (\_idx_1-> (\_code_2-> (let _1273 = (u (u fm_parser_init _idx_1) _code_2) in (case _1273 of {(0,f) -> u f (\_1274 _1275 _1276-> (u (u (u parser_reply_error _1274) _1275) _1276)); (1,f) -> u f (\_1277 _1278 _1279-> (let _1280 = (u (u (u fm_parser_text "[") _1277) _1278) in (case _1280 of {(0,f) -> u f (\_1281 _1282 _1283-> (u (u (u parser_reply_error _1281) _1282) _1283)); (1,f) -> u f (\_1284 _1285 _1286-> (let _1287 = (u (u (u (u parser_until (u fm_parser_text "]")) (u fm_parser_item fm_parser_term)) _1284) _1285) in (case _1287 of {(0,f) -> u f (\_1288 _1289 _1290-> (u (u (u parser_reply_error _1288) _1289) _1290)); (1,f) -> u f (\_1291 _1292 _1293-> (let _1294 = (u (u (u fm_parser_stop _1279) _1291) _1292) in (case _1294 of {(0,f) -> u f (\_1295 _1296 _1297-> (u (u (u parser_reply_error _1295) _1296) _1297)); (1,f) -> u f (\_1298 _1299 _1300-> (u (u (u parser_reply_value _1298) _1299) (u (u (u list_fold _1293) (u (u fm_term_app (u fm_term_ref (u fm_name_read "List.nil"))) (u fm_term_hol bits_e))) (\_x_15-> (\_xs_16-> (let _term_17=(u fm_term_ref (u fm_name_read "List.cons")) in (let _term_18=(u (u fm_term_app _term_17) (u fm_term_hol bits_e)) in (let _term_19=(u (u fm_term_app _term_18) _x_15) in (let _term_20=(u (u fm_term_app _term_19) _xs_16) in (u (u fm_term_ori _1300) _term_20)))))))))); }))); }))); }))); }))))
fm_parser_log = (\_idx_1-> (\_code_2-> (let _1301 = (u (u fm_parser_init _idx_1) _code_2) in (case _1301 of {(0,f) -> u f (\_1302 _1303 _1304-> (u (u (u parser_reply_error _1302) _1303) _1304)); (1,f) -> u f (\_1305 _1306 _1307-> (let _1308 = (u (u (u fm_parser_text "log(") _1305) _1306) in (case _1308 of {(0,f) -> u f (\_1309 _1310 _1311-> (u (u (u parser_reply_error _1309) _1310) _1311)); (1,f) -> u f (\_1312 _1313 _1314-> (let _1315 = (u (u (u (u parser_until (u fm_parser_text ")")) (u fm_parser_item fm_parser_term)) _1312) _1313) in (case _1315 of {(0,f) -> u f (\_1316 _1317 _1318-> (u (u (u parser_reply_error _1316) _1317) _1318)); (1,f) -> u f (\_1319 _1320 _1321-> (let _1322 = (u (u fm_parser_term _1319) _1320) in (case _1322 of {(0,f) -> u f (\_1323 _1324 _1325-> (u (u (u parser_reply_error _1323) _1324) _1325)); (1,f) -> u f (\_1326 _1327 _1328-> (let _term_15=(u fm_term_ref "Debug.log") in (let _term_16=(u (u fm_term_app _term_15) (u fm_term_hol bits_e)) in (let _args_17=(u (u (u list_fold _1321) (u fm_term_ref "String.nil")) (\_x_17-> (\_xs_18-> (let _arg_19=(u fm_term_ref "String.concat") in (let _arg_20=(u (u fm_term_app _arg_19) _x_17) in (let _arg_21=(u (u fm_term_app _arg_20) _xs_18) in _arg_21)))))) in (let _term_18=(u (u fm_term_app _term_16) _args_17) in (let _term_19=(u (u fm_term_app _term_18) (u (u fm_term_lam "x") (\_x_19-> _1328))) in (let _1329 = (u (u (u fm_parser_stop _1307) _1326) _1327) in (case _1329 of {(0,f) -> u f (\_1330 _1331 _1332-> (u (u (u parser_reply_error _1330) _1331) _1332)); (1,f) -> u f (\_1333 _1334 _1335-> (u (u (u parser_reply_value _1333) _1334) (u (u fm_term_ori _1335) _term_19))); })))))))); }))); }))); }))); }))))
fm_parser_forrange_u32 = (\_idx_1-> (\_code_2-> (let _1336 = (u (u fm_parser_init _idx_1) _code_2) in (case _1336 of {(0,f) -> u f (\_1337 _1338 _1339-> (u (u (u parser_reply_error _1337) _1338) _1339)); (1,f) -> u f (\_1340 _1341 _1342-> (let _1343 = (u (u (u fm_parser_text "for ") _1340) _1341) in (case _1343 of {(0,f) -> u f (\_1344 _1345 _1346-> (u (u (u parser_reply_error _1344) _1345) _1346)); (1,f) -> u f (\_1347 _1348 _1349-> (let _1350 = (u (u fm_parser_name1 _1347) _1348) in (case _1350 of {(0,f) -> u f (\_1351 _1352 _1353-> (u (u (u parser_reply_error _1351) _1352) _1353)); (1,f) -> u f (\_1354 _1355 _1356-> (let _1357 = (u (u (u fm_parser_text ":") _1354) _1355) in (case _1357 of {(0,f) -> u f (\_1358 _1359 _1360-> (u (u (u parser_reply_error _1358) _1359) _1360)); (1,f) -> u f (\_1361 _1362 _1363-> (let _1364 = (u (u (u fm_parser_text "U32") _1361) _1362) in (case _1364 of {(0,f) -> u f (\_1365 _1366 _1367-> (u (u (u parser_reply_error _1365) _1366) _1367)); (1,f) -> u f (\_1368 _1369 _1370-> (let _1371 = (u (u (u fm_parser_text "=") _1368) _1369) in (case _1371 of {(0,f) -> u f (\_1372 _1373 _1374-> (u (u (u parser_reply_error _1372) _1373) _1374)); (1,f) -> u f (\_1375 _1376 _1377-> (let _1378 = (u (u fm_parser_term _1375) _1376) in (case _1378 of {(0,f) -> u f (\_1379 _1380 _1381-> (u (u (u parser_reply_error _1379) _1380) _1381)); (1,f) -> u f (\_1382 _1383 _1384-> (let _1385 = (u (u (u fm_parser_text "..") _1382) _1383) in (case _1385 of {(0,f) -> u f (\_1386 _1387 _1388-> (u (u (u parser_reply_error _1386) _1387) _1388)); (1,f) -> u f (\_1389 _1390 _1391-> (let _1392 = (u (u fm_parser_term _1389) _1390) in (case _1392 of {(0,f) -> u f (\_1393 _1394 _1395-> (u (u (u parser_reply_error _1393) _1394) _1395)); (1,f) -> u f (\_1396 _1397 _1398-> (let _1399 = (u (u (u fm_parser_text "with") _1396) _1397) in (case _1399 of {(0,f) -> u f (\_1400 _1401 _1402-> (u (u (u parser_reply_error _1400) _1401) _1402)); (1,f) -> u f (\_1403 _1404 _1405-> (let _1406 = (u (u fm_parser_name1 _1403) _1404) in (case _1406 of {(0,f) -> u f (\_1407 _1408 _1409-> (u (u (u parser_reply_error _1407) _1408) _1409)); (1,f) -> u f (\_1410 _1411 _1412-> (let _1413 = (u (u (u fm_parser_text ":") _1410) _1411) in (case _1413 of {(0,f) -> u f (\_1414 _1415 _1416-> (u (u (u parser_reply_error _1414) _1415) _1416)); (1,f) -> u f (\_1417 _1418 _1419-> (let _1420 = (u (u fm_parser_term _1417) _1418) in (case _1420 of {(0,f) -> u f (\_1421 _1422 _1423-> (u (u (u parser_reply_error _1421) _1422) _1423)); (1,f) -> u f (\_1424 _1425 _1426-> (let _1427 = (u (u (u fm_parser_stop _1342) _1424) _1425) in (case _1427 of {(0,f) -> u f (\_1428 _1429 _1430-> (u (u (u parser_reply_error _1428) _1429) _1430)); (1,f) -> u f (\_1431 _1432 _1433-> (let _term_45=(u fm_term_ref "U32.for") in (let _term_46=(u (u fm_term_app _term_45) (u fm_term_hol bits_e)) in (let _term_47=(u (u fm_term_app _term_46) (u fm_term_ref _1412)) in (let _term_48=(u (u fm_term_app _term_47) _1384) in (let _term_49=(u (u fm_term_app _term_48) _1398) in (let _lamb_50=(u (u fm_term_lam _1356) (\_e_50-> (u (u fm_term_lam _1412) (\_s_51-> _1426)))) in (let _term_51=(u (u fm_term_app _term_49) _lamb_50) in (let _term_52=(u (u (u fm_term_let _1412) _term_51) (\_x_52-> (u fm_term_ref _1412))) in (u (u (u parser_reply_value _1431) _1432) (u (u fm_term_ori _1433) _term_52))))))))))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))))
fm_parser_forrange_u32_2 = (\_idx_1-> (\_code_2-> (let _1434 = (u (u fm_parser_init _idx_1) _code_2) in (case _1434 of {(0,f) -> u f (\_1435 _1436 _1437-> (u (u (u parser_reply_error _1435) _1436) _1437)); (1,f) -> u f (\_1438 _1439 _1440-> (let _1441 = (u (u (u fm_parser_text "for ") _1438) _1439) in (case _1441 of {(0,f) -> u f (\_1442 _1443 _1444-> (u (u (u parser_reply_error _1442) _1443) _1444)); (1,f) -> u f (\_1445 _1446 _1447-> (let _1448 = (u (u fm_parser_name1 _1445) _1446) in (case _1448 of {(0,f) -> u f (\_1449 _1450 _1451-> (u (u (u parser_reply_error _1449) _1450) _1451)); (1,f) -> u f (\_1452 _1453 _1454-> (let _1455 = (u (u (u fm_parser_text ":") _1452) _1453) in (case _1455 of {(0,f) -> u f (\_1456 _1457 _1458-> (u (u (u parser_reply_error _1456) _1457) _1458)); (1,f) -> u f (\_1459 _1460 _1461-> (let _1462 = (u (u (u fm_parser_text "U32") _1459) _1460) in (case _1462 of {(0,f) -> u f (\_1463 _1464 _1465-> (u (u (u parser_reply_error _1463) _1464) _1465)); (1,f) -> u f (\_1466 _1467 _1468-> (let _1469 = (u (u (u fm_parser_text "=") _1466) _1467) in (case _1469 of {(0,f) -> u f (\_1470 _1471 _1472-> (u (u (u parser_reply_error _1470) _1471) _1472)); (1,f) -> u f (\_1473 _1474 _1475-> (let _1476 = (u (u fm_parser_term _1473) _1474) in (case _1476 of {(0,f) -> u f (\_1477 _1478 _1479-> (u (u (u parser_reply_error _1477) _1478) _1479)); (1,f) -> u f (\_1480 _1481 _1482-> (let _1483 = (u (u (u fm_parser_text "..") _1480) _1481) in (case _1483 of {(0,f) -> u f (\_1484 _1485 _1486-> (u (u (u parser_reply_error _1484) _1485) _1486)); (1,f) -> u f (\_1487 _1488 _1489-> (let _1490 = (u (u fm_parser_term _1487) _1488) in (case _1490 of {(0,f) -> u f (\_1491 _1492 _1493-> (u (u (u parser_reply_error _1491) _1492) _1493)); (1,f) -> u f (\_1494 _1495 _1496-> (let _1497 = (u (u (u fm_parser_text ":") _1494) _1495) in (case _1497 of {(0,f) -> u f (\_1498 _1499 _1500-> (u (u (u parser_reply_error _1498) _1499) _1500)); (1,f) -> u f (\_1501 _1502 _1503-> (let _1504 = (u (u fm_parser_name1 _1501) _1502) in (case _1504 of {(0,f) -> u f (\_1505 _1506 _1507-> (u (u (u parser_reply_error _1505) _1506) _1507)); (1,f) -> u f (\_1508 _1509 _1510-> (let _1511 = (u (u (u fm_parser_text "=") _1508) _1509) in (case _1511 of {(0,f) -> u f (\_1512 _1513 _1514-> (u (u (u parser_reply_error _1512) _1513) _1514)); (1,f) -> u f (\_1515 _1516 _1517-> (let _1518 = (u (u fm_parser_term _1515) _1516) in (case _1518 of {(0,f) -> u f (\_1519 _1520 _1521-> (u (u (u parser_reply_error _1519) _1520) _1521)); (1,f) -> u f (\_1522 _1523 _1524-> (let _1525 = (u (u (u parser_maybe (u fm_parser_text ";")) _1522) _1523) in (case _1525 of {(0,f) -> u f (\_1526 _1527 _1528-> (u (u (u parser_reply_error _1526) _1527) _1528)); (1,f) -> u f (\_1529 _1530 _1531-> (let _1532 = (u (u fm_parser_term _1529) _1530) in (case _1532 of {(0,f) -> u f (\_1533 _1534 _1535-> (u (u (u parser_reply_error _1533) _1534) _1535)); (1,f) -> u f (\_1536 _1537 _1538-> (let _1539 = (u (u (u fm_parser_stop _1440) _1536) _1537) in (case _1539 of {(0,f) -> u f (\_1540 _1541 _1542-> (u (u (u parser_reply_error _1540) _1541) _1542)); (1,f) -> u f (\_1543 _1544 _1545-> (let _term_51=(u fm_term_ref "U32.for") in (let _term_52=(u (u fm_term_app _term_51) (u fm_term_hol bits_e)) in (let _term_53=(u (u fm_term_app _term_52) (u fm_term_ref _1510)) in (let _term_54=(u (u fm_term_app _term_53) _1482) in (let _term_55=(u (u fm_term_app _term_54) _1496) in (let _lamb_56=(u (u fm_term_lam _1454) (\_e_56-> (u (u fm_term_lam _1510) (\_s_57-> _1524)))) in (let _term_57=(u (u fm_term_app _term_55) _lamb_56) in (let _term_58=(u (u (u fm_term_let _1510) _term_57) (\_x_58-> _1538)) in (u (u (u parser_reply_value _1543) _1544) (u (u fm_term_ori _1545) _term_58))))))))))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))))
fm_parser_forin = (\_idx_1-> (\_code_2-> (let _1546 = (u (u fm_parser_init _idx_1) _code_2) in (case _1546 of {(0,f) -> u f (\_1547 _1548 _1549-> (u (u (u parser_reply_error _1547) _1548) _1549)); (1,f) -> u f (\_1550 _1551 _1552-> (let _1553 = (u (u (u fm_parser_text "for ") _1550) _1551) in (case _1553 of {(0,f) -> u f (\_1554 _1555 _1556-> (u (u (u parser_reply_error _1554) _1555) _1556)); (1,f) -> u f (\_1557 _1558 _1559-> (let _1560 = (u (u fm_parser_name1 _1557) _1558) in (case _1560 of {(0,f) -> u f (\_1561 _1562 _1563-> (u (u (u parser_reply_error _1561) _1562) _1563)); (1,f) -> u f (\_1564 _1565 _1566-> (let _1567 = (u (u (u fm_parser_text "in") _1564) _1565) in (case _1567 of {(0,f) -> u f (\_1568 _1569 _1570-> (u (u (u parser_reply_error _1568) _1569) _1570)); (1,f) -> u f (\_1571 _1572 _1573-> (let _1574 = (u (u fm_parser_term _1571) _1572) in (case _1574 of {(0,f) -> u f (\_1575 _1576 _1577-> (u (u (u parser_reply_error _1575) _1576) _1577)); (1,f) -> u f (\_1578 _1579 _1580-> (let _1581 = (u (u (u fm_parser_text "with") _1578) _1579) in (case _1581 of {(0,f) -> u f (\_1582 _1583 _1584-> (u (u (u parser_reply_error _1582) _1583) _1584)); (1,f) -> u f (\_1585 _1586 _1587-> (let _1588 = (u (u fm_parser_name1 _1585) _1586) in (case _1588 of {(0,f) -> u f (\_1589 _1590 _1591-> (u (u (u parser_reply_error _1589) _1590) _1591)); (1,f) -> u f (\_1592 _1593 _1594-> (let _1595 = (u (u (u fm_parser_text ":") _1592) _1593) in (case _1595 of {(0,f) -> u f (\_1596 _1597 _1598-> (u (u (u parser_reply_error _1596) _1597) _1598)); (1,f) -> u f (\_1599 _1600 _1601-> (let _1602 = (u (u fm_parser_term _1599) _1600) in (case _1602 of {(0,f) -> u f (\_1603 _1604 _1605-> (u (u (u parser_reply_error _1603) _1604) _1605)); (1,f) -> u f (\_1606 _1607 _1608-> (let _1609 = (u (u (u fm_parser_stop _1552) _1606) _1607) in (case _1609 of {(0,f) -> u f (\_1610 _1611 _1612-> (u (u (u parser_reply_error _1610) _1611) _1612)); (1,f) -> u f (\_1613 _1614 _1615-> (let _term_33=(u fm_term_ref "List.for") in (let _term_34=(u (u fm_term_app _term_33) (u fm_term_hol bits_e)) in (let _term_35=(u (u fm_term_app _term_34) _1580) in (let _term_36=(u (u fm_term_app _term_35) (u fm_term_hol bits_e)) in (let _term_37=(u (u fm_term_app _term_36) (u fm_term_ref _1594)) in (let _lamb_38=(u (u fm_term_lam _1566) (\_i_38-> (u (u fm_term_lam _1594) (\_x_39-> _1608)))) in (let _term_39=(u (u fm_term_app _term_37) _lamb_38) in (let _term_40=(u (u (u fm_term_let _1594) _term_39) (\_x_40-> (u fm_term_ref _1594))) in (u (u (u parser_reply_value _1613) _1614) (u (u fm_term_ori _1615) _term_40))))))))))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))))
fm_parser_forin_2 = (\_idx_1-> (\_code_2-> (let _1616 = (u (u fm_parser_init _idx_1) _code_2) in (case _1616 of {(0,f) -> u f (\_1617 _1618 _1619-> (u (u (u parser_reply_error _1617) _1618) _1619)); (1,f) -> u f (\_1620 _1621 _1622-> (let _1623 = (u (u (u fm_parser_text "for ") _1620) _1621) in (case _1623 of {(0,f) -> u f (\_1624 _1625 _1626-> (u (u (u parser_reply_error _1624) _1625) _1626)); (1,f) -> u f (\_1627 _1628 _1629-> (let _1630 = (u (u fm_parser_name1 _1627) _1628) in (case _1630 of {(0,f) -> u f (\_1631 _1632 _1633-> (u (u (u parser_reply_error _1631) _1632) _1633)); (1,f) -> u f (\_1634 _1635 _1636-> (let _1637 = (u (u (u fm_parser_text "in") _1634) _1635) in (case _1637 of {(0,f) -> u f (\_1638 _1639 _1640-> (u (u (u parser_reply_error _1638) _1639) _1640)); (1,f) -> u f (\_1641 _1642 _1643-> (let _1644 = (u (u fm_parser_term _1641) _1642) in (case _1644 of {(0,f) -> u f (\_1645 _1646 _1647-> (u (u (u parser_reply_error _1645) _1646) _1647)); (1,f) -> u f (\_1648 _1649 _1650-> (let _1651 = (u (u (u fm_parser_text ":") _1648) _1649) in (case _1651 of {(0,f) -> u f (\_1652 _1653 _1654-> (u (u (u parser_reply_error _1652) _1653) _1654)); (1,f) -> u f (\_1655 _1656 _1657-> (let _1658 = (u (u fm_parser_name1 _1655) _1656) in (case _1658 of {(0,f) -> u f (\_1659 _1660 _1661-> (u (u (u parser_reply_error _1659) _1660) _1661)); (1,f) -> u f (\_1662 _1663 _1664-> (let _1665 = (u (u (u fm_parser_text "=") _1662) _1663) in (case _1665 of {(0,f) -> u f (\_1666 _1667 _1668-> (u (u (u parser_reply_error _1666) _1667) _1668)); (1,f) -> u f (\_1669 _1670 _1671-> (let _1672 = (u (u fm_parser_term _1669) _1670) in (case _1672 of {(0,f) -> u f (\_1673 _1674 _1675-> (u (u (u parser_reply_error _1673) _1674) _1675)); (1,f) -> u f (\_1676 _1677 _1678-> (let _1679 = (u (u (u parser_maybe (u fm_parser_text ";")) _1676) _1677) in (case _1679 of {(0,f) -> u f (\_1680 _1681 _1682-> (u (u (u parser_reply_error _1680) _1681) _1682)); (1,f) -> u f (\_1683 _1684 _1685-> (let _1686 = (u (u fm_parser_term _1683) _1684) in (case _1686 of {(0,f) -> u f (\_1687 _1688 _1689-> (u (u (u parser_reply_error _1687) _1688) _1689)); (1,f) -> u f (\_1690 _1691 _1692-> (let _1693 = (u (u (u fm_parser_stop _1622) _1690) _1691) in (case _1693 of {(0,f) -> u f (\_1694 _1695 _1696-> (u (u (u parser_reply_error _1694) _1695) _1696)); (1,f) -> u f (\_1697 _1698 _1699-> (let _term_39=(u fm_term_ref "List.for") in (let _term_40=(u (u fm_term_app _term_39) (u fm_term_hol bits_e)) in (let _term_41=(u (u fm_term_app _term_40) _1650) in (let _term_42=(u (u fm_term_app _term_41) (u fm_term_hol bits_e)) in (let _term_43=(u (u fm_term_app _term_42) (u fm_term_ref _1664)) in (let _lamb_44=(u (u fm_term_lam _1636) (\_i_44-> (u (u fm_term_lam _1664) (\_x_45-> _1678)))) in (let _term_45=(u (u fm_term_app _term_43) _lamb_44) in (let _term_46=(u (u (u fm_term_let _1664) _term_45) (\_x_46-> _1692)) in (u (u (u parser_reply_value _1697) _1698) (u (u fm_term_ori _1699) _term_46))))))))))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))))
fm_parser_do_statements = (\_monad_name_1-> (u parser_first_of (u (u list_cons (\_idx_2-> (\_code_3-> (let _1700 = (u (u fm_parser_init _idx_2) _code_3) in (case _1700 of {(0,f) -> u f (\_1701 _1702 _1703-> (u (u (u parser_reply_error _1701) _1702) _1703)); (1,f) -> u f (\_1704 _1705 _1706-> (let _1707 = (u (u (u fm_parser_text "var ") _1704) _1705) in (case _1707 of {(0,f) -> u f (\_1708 _1709 _1710-> (u (u (u parser_reply_error _1708) _1709) _1710)); (1,f) -> u f (\_1711 _1712 _1713-> (let _1714 = (u (u fm_parser_name1 _1711) _1712) in (case _1714 of {(0,f) -> u f (\_1715 _1716 _1717-> (u (u (u parser_reply_error _1715) _1716) _1717)); (1,f) -> u f (\_1718 _1719 _1720-> (let _1721 = (u (u (u fm_parser_text "=") _1718) _1719) in (case _1721 of {(0,f) -> u f (\_1722 _1723 _1724-> (u (u (u parser_reply_error _1722) _1723) _1724)); (1,f) -> u f (\_1725 _1726 _1727-> (let _1728 = (u (u fm_parser_term _1725) _1726) in (case _1728 of {(0,f) -> u f (\_1729 _1730 _1731-> (u (u (u parser_reply_error _1729) _1730) _1731)); (1,f) -> u f (\_1732 _1733 _1734-> (let _1735 = (u (u (u parser_maybe (u fm_parser_text ";")) _1732) _1733) in (case _1735 of {(0,f) -> u f (\_1736 _1737 _1738-> (u (u (u parser_reply_error _1736) _1737) _1738)); (1,f) -> u f (\_1739 _1740 _1741-> (let _1742 = (u (u (u fm_parser_do_statements _monad_name_1) _1739) _1740) in (case _1742 of {(0,f) -> u f (\_1743 _1744 _1745-> (u (u (u parser_reply_error _1743) _1744) _1745)); (1,f) -> u f (\_1746 _1747 _1748-> (let _1749 = (u (u (u fm_parser_stop _1706) _1746) _1747) in (case _1749 of {(0,f) -> u f (\_1750 _1751 _1752-> (u (u (u parser_reply_error _1750) _1751) _1752)); (1,f) -> u f (\_1753 _1754 _1755-> (let _term_28=(u (u fm_term_app (u fm_term_ref "Monad.bind")) (u fm_term_ref _monad_name_1)) in (let _term_29=(u (u fm_term_app _term_28) (u fm_term_ref (((_monad_name_1::String) ++ ".monad")))) in (let _term_30=(u (u fm_term_app _term_29) (u fm_term_hol bits_e)) in (let _term_31=(u (u fm_term_app _term_30) (u fm_term_hol bits_e)) in (let _term_32=(u (u fm_term_app _term_31) _1734) in (let _term_33=(u (u fm_term_app _term_32) (u (u fm_term_lam _1720) (\_x_33-> _1748))) in (u (u (u parser_reply_value _1753) _1754) (u (u fm_term_ori _1755) _term_33))))))))); }))); }))); }))); }))); }))); }))); }))); }))))) (u (u list_cons (\_idx_2-> (\_code_3-> (let _1756 = (u (u fm_parser_init _idx_2) _code_3) in (case _1756 of {(0,f) -> u f (\_1757 _1758 _1759-> (u (u (u parser_reply_error _1757) _1758) _1759)); (1,f) -> u f (\_1760 _1761 _1762-> (let _1763 = (u (u (u fm_parser_text "let ") _1760) _1761) in (case _1763 of {(0,f) -> u f (\_1764 _1765 _1766-> (u (u (u parser_reply_error _1764) _1765) _1766)); (1,f) -> u f (\_1767 _1768 _1769-> (let _1770 = (u (u fm_parser_name1 _1767) _1768) in (case _1770 of {(0,f) -> u f (\_1771 _1772 _1773-> (u (u (u parser_reply_error _1771) _1772) _1773)); (1,f) -> u f (\_1774 _1775 _1776-> (let _1777 = (u (u (u fm_parser_text "=") _1774) _1775) in (case _1777 of {(0,f) -> u f (\_1778 _1779 _1780-> (u (u (u parser_reply_error _1778) _1779) _1780)); (1,f) -> u f (\_1781 _1782 _1783-> (let _1784 = (u (u fm_parser_term _1781) _1782) in (case _1784 of {(0,f) -> u f (\_1785 _1786 _1787-> (u (u (u parser_reply_error _1785) _1786) _1787)); (1,f) -> u f (\_1788 _1789 _1790-> (let _1791 = (u (u (u parser_maybe (u fm_parser_text ";")) _1788) _1789) in (case _1791 of {(0,f) -> u f (\_1792 _1793 _1794-> (u (u (u parser_reply_error _1792) _1793) _1794)); (1,f) -> u f (\_1795 _1796 _1797-> (let _1798 = (u (u (u fm_parser_do_statements _monad_name_1) _1795) _1796) in (case _1798 of {(0,f) -> u f (\_1799 _1800 _1801-> (u (u (u parser_reply_error _1799) _1800) _1801)); (1,f) -> u f (\_1802 _1803 _1804-> (let _1805 = (u (u (u fm_parser_stop _1762) _1802) _1803) in (case _1805 of {(0,f) -> u f (\_1806 _1807 _1808-> (u (u (u parser_reply_error _1806) _1807) _1808)); (1,f) -> u f (\_1809 _1810 _1811-> (u (u (u parser_reply_value _1809) _1810) (u (u fm_term_ori _1811) (u (u (u fm_term_let _1776) _1790) (\_x_28-> _1804))))); }))); }))); }))); }))); }))); }))); }))); }))))) (u (u list_cons (\_idx_2-> (\_code_3-> (let _1812 = (u (u fm_parser_init _idx_2) _code_3) in (case _1812 of {(0,f) -> u f (\_1813 _1814 _1815-> (u (u (u parser_reply_error _1813) _1814) _1815)); (1,f) -> u f (\_1816 _1817 _1818-> (let _1819 = (u (u (u fm_parser_text "return ") _1816) _1817) in (case _1819 of {(0,f) -> u f (\_1820 _1821 _1822-> (u (u (u parser_reply_error _1820) _1821) _1822)); (1,f) -> u f (\_1823 _1824 _1825-> (let _1826 = (u (u fm_parser_term _1823) _1824) in (case _1826 of {(0,f) -> u f (\_1827 _1828 _1829-> (u (u (u parser_reply_error _1827) _1828) _1829)); (1,f) -> u f (\_1830 _1831 _1832-> (let _1833 = (u (u (u parser_maybe (u fm_parser_text ";")) _1830) _1831) in (case _1833 of {(0,f) -> u f (\_1834 _1835 _1836-> (u (u (u parser_reply_error _1834) _1835) _1836)); (1,f) -> u f (\_1837 _1838 _1839-> (let _1840 = (u (u (u fm_parser_stop _1818) _1837) _1838) in (case _1840 of {(0,f) -> u f (\_1841 _1842 _1843-> (u (u (u parser_reply_error _1841) _1842) _1843)); (1,f) -> u f (\_1844 _1845 _1846-> (let _term_19=(u (u fm_term_app (u fm_term_ref "Monad.pure")) (u fm_term_ref _monad_name_1)) in (let _term_20=(u (u fm_term_app _term_19) (u fm_term_ref (((_monad_name_1::String) ++ ".monad")))) in (let _term_21=(u (u fm_term_app _term_20) (u fm_term_hol bits_e)) in (let _term_22=(u (u fm_term_app _term_21) _1832) in (u (u (u parser_reply_value _1844) _1845) (u (u fm_term_ori _1846) _term_22))))))); }))); }))); }))); }))); }))))) (u (u list_cons (\_idx_2-> (\_code_3-> (let _1847 = (u (u fm_parser_init _idx_2) _code_3) in (case _1847 of {(0,f) -> u f (\_1848 _1849 _1850-> (u (u (u parser_reply_error _1848) _1849) _1850)); (1,f) -> u f (\_1851 _1852 _1853-> (let _1854 = (u (u fm_parser_term _1851) _1852) in (case _1854 of {(0,f) -> u f (\_1855 _1856 _1857-> (u (u (u parser_reply_error _1855) _1856) _1857)); (1,f) -> u f (\_1858 _1859 _1860-> (let _1861 = (u (u (u parser_maybe (u fm_parser_text ";")) _1858) _1859) in (case _1861 of {(0,f) -> u f (\_1862 _1863 _1864-> (u (u (u parser_reply_error _1862) _1863) _1864)); (1,f) -> u f (\_1865 _1866 _1867-> (let _1868 = (u (u (u fm_parser_do_statements _monad_name_1) _1865) _1866) in (case _1868 of {(0,f) -> u f (\_1869 _1870 _1871-> (u (u (u parser_reply_error _1869) _1870) _1871)); (1,f) -> u f (\_1872 _1873 _1874-> (let _1875 = (u (u (u fm_parser_stop _1853) _1872) _1873) in (case _1875 of {(0,f) -> u f (\_1876 _1877 _1878-> (u (u (u parser_reply_error _1876) _1877) _1878)); (1,f) -> u f (\_1879 _1880 _1881-> (let _term_19=(u (u fm_term_app (u fm_term_ref "Monad.bind")) (u fm_term_ref _monad_name_1)) in (let _term_20=(u (u fm_term_app _term_19) (u fm_term_ref (((_monad_name_1::String) ++ ".monad")))) in (let _term_21=(u (u fm_term_app _term_20) (u fm_term_hol bits_e)) in (let _term_22=(u (u fm_term_app _term_21) (u fm_term_hol bits_e)) in (let _term_23=(u (u fm_term_app _term_22) _1860) in (let _term_24=(u (u fm_term_app _term_23) (u (u fm_term_lam "") (\_x_24-> _1874))) in (u (u (u parser_reply_value _1879) _1880) (u (u fm_term_ori _1881) _term_24))))))))); }))); }))); }))); }))); }))))) (u (u list_cons (\_idx_2-> (\_code_3-> (let _1882 = (u (u fm_parser_term _idx_2) _code_3) in (case _1882 of {(0,f) -> u f (\_1883 _1884 _1885-> (u (u (u parser_reply_error _1883) _1884) _1885)); (1,f) -> u f (\_1886 _1887 _1888-> (let _1889 = (u (u (u parser_maybe (u fm_parser_text ";")) _1886) _1887) in (case _1889 of {(0,f) -> u f (\_1890 _1891 _1892-> (u (u (u parser_reply_error _1890) _1891) _1892)); (1,f) -> u f (\_1893 _1894 _1895-> (u (u (u parser_reply_value _1893) _1894) _1888)); }))); }))))) list_nil)))))))
fm_parser_do = (\_idx_1-> (\_code_2-> (let _1896 = (u (u (u fm_parser_text "do ") _idx_1) _code_2) in (case _1896 of {(0,f) -> u f (\_1897 _1898 _1899-> (u (u (u parser_reply_error _1897) _1898) _1899)); (1,f) -> u f (\_1900 _1901 _1902-> (let _1903 = (u (u fm_parser_name1 _1900) _1901) in (case _1903 of {(0,f) -> u f (\_1904 _1905 _1906-> (u (u (u parser_reply_error _1904) _1905) _1906)); (1,f) -> u f (\_1907 _1908 _1909-> (let _1910 = (u (u (u fm_parser_text "{") _1907) _1908) in (case _1910 of {(0,f) -> u f (\_1911 _1912 _1913-> (u (u (u parser_reply_error _1911) _1912) _1913)); (1,f) -> u f (\_1914 _1915 _1916-> (let _1917 = (u (u (u fm_parser_do_statements _1909) _1914) _1915) in (case _1917 of {(0,f) -> u f (\_1918 _1919 _1920-> (u (u (u parser_reply_error _1918) _1919) _1920)); (1,f) -> u f (\_1921 _1922 _1923-> (let _1924 = (u (u (u fm_parser_text "}") _1921) _1922) in (case _1924 of {(0,f) -> u f (\_1925 _1926 _1927-> (u (u (u parser_reply_error _1925) _1926) _1927)); (1,f) -> u f (\_1928 _1929 _1930-> (u (u (u parser_reply_value _1928) _1929) _1923)); }))); }))); }))); }))); }))))
fm_term_nat = (\_natx_1-> (11,\t-> t _natx_1))
fm_term_unroll_nat = (\_natx_1-> (let _1931 = _natx_1 in (if _1931==0 then (u fm_term_ref (u fm_name_read "Nat.zero")) else (let _func_3=(u fm_term_ref (u fm_name_read "Nat.succ")) in (let _argm_4=(u fm_term_nat (_1931-1)) in (u (u fm_term_app _func_3) _argm_4))))))
u16_to_bits = (\_a_1-> (let _1932 = _a_1 in (u word_to_bits (u16_to_word _1932))))
fm_term_unroll_chr_bits = (\_bits_1-> (let _1933 = _bits_1 in (case _1933 of {(0,f) -> u f ((u fm_term_ref (u fm_name_read "Bits.e"))); (1,f) -> u f (\_1934-> (u (u fm_term_app (u fm_term_ref (u fm_name_read "Bits.o"))) (u fm_term_unroll_chr_bits _1934))); (2,f) -> u f (\_1935-> (u (u fm_term_app (u fm_term_ref (u fm_name_read "Bits.i"))) (u fm_term_unroll_chr_bits _1935))); })))
fm_term_unroll_chr = (\_chrx_1-> (let _bits_2=(u u16_to_bits _chrx_1) in (let _term_3=(u fm_term_ref (u fm_name_read "Word.from_bits")) in (let _term_4=(u (u fm_term_app _term_3) (u fm_term_nat 16)) in (let _term_5=(u (u fm_term_app _term_4) (u fm_term_unroll_chr_bits _bits_2)) in (let _term_6=(u (u fm_term_app (u fm_term_ref (u fm_name_read "U16.new"))) _term_5) in _term_6))))))
fm_term_unroll_str = (\_strx_1-> (let _1936 = _strx_1 in (if null (_1936::String) then (u fm_term_ref (u fm_name_read "String.nil")) else (let _char_4=(u fm_term_chr (fromIntegral (fromEnum (head _1936 :: Char)) :: Word16)) in (let _term_5=(u fm_term_ref (u fm_name_read "String.cons")) in (let _term_6=(u (u fm_term_app _term_5) _char_4) in (let _term_7=(u (u fm_term_app _term_6) (u fm_term_str (tail _1936))) in _term_7)))))))
fm_term_reduce = (\_term_1-> (\_defs_2-> (let _1937 = _term_1 in (case _1937 of {(0,f) -> u f (\_1938 _1939-> _term_1); (1,f) -> u f (\_1940-> (let _1941 = (u (u fm_get _1940) _defs_2) in (case _1941 of {(0,f) -> u f ((u fm_term_ref _1940)); (1,f) -> u f (\_1942-> (let _1943 = _1942 in (case _1943 of {(0,f) -> u f (\_1944 _1945 _1946 _1947 _1948 _1949 _1950 _1951 _1952-> (u (u fm_term_reduce _1948) _defs_2)); }))); }))); (2,f) -> u f (_term_1); (3,f) -> u f (\_1953 _1954 _1955 _1956 _1957-> _term_1); (4,f) -> u f (\_1958 _1959-> _term_1); (5,f) -> u f (\_1960 _1961-> (let _func_5=(u (u fm_term_reduce _1960) _defs_2) in (let _1962 = _func_5 in (case _1962 of {(0,f) -> u f (\_1963 _1964-> _term_1); (1,f) -> u f (\_1965-> _term_1); (2,f) -> u f (_term_1); (3,f) -> u f (\_1966 _1967 _1968 _1969 _1970-> _term_1); (4,f) -> u f (\_1971 _1972-> (u (u fm_term_reduce (u _1972 _1961)) _defs_2)); (5,f) -> u f (\_1973 _1974-> _term_1); (6,f) -> u f (\_1975 _1976 _1977-> _term_1); (7,f) -> u f (\_1978 _1979 _1980-> _term_1); (8,f) -> u f (\_1981 _1982 _1983-> _term_1); (9,f) -> u f (\_1984 _1985 _1986-> _term_1); (10,f) -> u f (\_1987-> _term_1); (11,f) -> u f (\_1988-> _term_1); (12,f) -> u f (\_1989-> _term_1); (13,f) -> u f (\_1990-> _term_1); (14,f) -> u f (\_1991 _1992 _1993 _1994 _1995 _1996-> _term_1); (15,f) -> u f (\_1997 _1998-> _term_1); })))); (6,f) -> u f (\_1999 _2000 _2001-> (u (u fm_term_reduce (u _2001 _2000)) _defs_2)); (7,f) -> u f (\_2002 _2003 _2004-> (u (u fm_term_reduce (u _2004 _2003)) _defs_2)); (8,f) -> u f (\_2005 _2006 _2007-> (u (u fm_term_reduce _2006) _defs_2)); (9,f) -> u f (\_2008 _2009 _2010-> _term_1); (10,f) -> u f (\_2011-> _term_1); (11,f) -> u f (\_2012-> (u (u fm_term_reduce (u fm_term_unroll_nat _2012)) _defs_2)); (12,f) -> u f (\_2013-> (u (u fm_term_reduce (u fm_term_unroll_chr _2013)) _defs_2)); (13,f) -> u f (\_2014-> (u (u fm_term_reduce (u fm_term_unroll_str _2014)) _defs_2)); (14,f) -> u f (\_2015 _2016 _2017 _2018 _2019 _2020-> _term_1); (15,f) -> u f (\_2021 _2022-> (u (u fm_term_reduce _2022) _defs_2)); }))))
map_new = (0,\t-> t)
fm_def_new = (\_file_1-> (\_code_2-> (\_orig_3-> (\_name_4-> (\_term_5-> (\_type_6-> (\_isct_7-> (\_arit_8-> (\_stat_9-> (0,\t-> t _file_1 _code_2 _orig_3 _name_4 _term_5 _type_6 _isct_7 _arit_8 _stat_9))))))))))
fm_status_init = (0,\t-> t)
fm_parser_case_with = (\_idx_1-> (\_code_2-> (let _2023 = (u (u (u fm_parser_text "with") _idx_1) _code_2) in (case _2023 of {(0,f) -> u f (\_2024 _2025 _2026-> (u (u (u parser_reply_error _2024) _2025) _2026)); (1,f) -> u f (\_2027 _2028 _2029-> (let _2030 = (u (u fm_parser_name1 _2027) _2028) in (case _2030 of {(0,f) -> u f (\_2031 _2032 _2033-> (u (u (u parser_reply_error _2031) _2032) _2033)); (1,f) -> u f (\_2034 _2035 _2036-> (let _2037 = (u (u (u fm_parser_text ":") _2034) _2035) in (case _2037 of {(0,f) -> u f (\_2038 _2039 _2040-> (u (u (u parser_reply_error _2038) _2039) _2040)); (1,f) -> u f (\_2041 _2042 _2043-> (let _2044 = (u (u fm_parser_term _2041) _2042) in (case _2044 of {(0,f) -> u f (\_2045 _2046 _2047-> (u (u (u parser_reply_error _2045) _2046) _2047)); (1,f) -> u f (\_2048 _2049 _2050-> (let _2051 = (u (u (u fm_parser_text "=") _2048) _2049) in (case _2051 of {(0,f) -> u f (\_2052 _2053 _2054-> (u (u (u parser_reply_error _2052) _2053) _2054)); (1,f) -> u f (\_2055 _2056 _2057-> (let _2058 = (u (u fm_parser_term _2055) _2056) in (case _2058 of {(0,f) -> u f (\_2059 _2060 _2061-> (u (u (u parser_reply_error _2059) _2060) _2061)); (1,f) -> u f (\_2062 _2063 _2064-> (u (u (u parser_reply_value _2062) _2063) (u (u (u (u (u (u (u (u (u fm_def_new "") "") (u (u pair_new 0) 0)) _2036) _2064) _2050) bool_false) 0) fm_status_init))); }))); }))); }))); }))); }))); }))))
fm_parser_case_case = (\_idx_1-> (\_code_2-> (let _2065 = (u (u fm_parser_name1 _idx_1) _code_2) in (case _2065 of {(0,f) -> u f (\_2066 _2067 _2068-> (u (u (u parser_reply_error _2066) _2067) _2068)); (1,f) -> u f (\_2069 _2070 _2071-> (let _2072 = (u (u (u fm_parser_text ":") _2069) _2070) in (case _2072 of {(0,f) -> u f (\_2073 _2074 _2075-> (u (u (u parser_reply_error _2073) _2074) _2075)); (1,f) -> u f (\_2076 _2077 _2078-> (let _2079 = (u (u fm_parser_term _2076) _2077) in (case _2079 of {(0,f) -> u f (\_2080 _2081 _2082-> (u (u (u parser_reply_error _2080) _2081) _2082)); (1,f) -> u f (\_2083 _2084 _2085-> (let _2086 = (u (u (u parser_maybe (u fm_parser_text ",")) _2083) _2084) in (case _2086 of {(0,f) -> u f (\_2087 _2088 _2089-> (u (u (u parser_reply_error _2087) _2088) _2089)); (1,f) -> u f (\_2090 _2091 _2092-> (u (u (u parser_reply_value _2090) _2091) (u (u pair_new _2071) _2085))); }))); }))); }))); }))))
map_tie = (\_val_2-> (\_lft_3-> (\_rgt_4-> (1,\t-> t _val_2 _lft_3 _rgt_4))))
map_set = (\_bits_2-> (\_val_3-> (\_map_4-> (let _2093 = _bits_2 in (case _2093 of {(0,f) -> u f ((let _2094 = _map_4 in (case _2094 of {(0,f) -> u f ((u (u (u map_tie (u maybe_some _val_3)) map_new) map_new)); (1,f) -> u f (\_2095 _2096 _2097-> (u (u (u map_tie (u maybe_some _val_3)) _2096) _2097)); }))); (1,f) -> u f (\_2098-> (let _2099 = _map_4 in (case _2099 of {(0,f) -> u f ((u (u (u map_tie maybe_none) (u (u (u map_set _2098) _val_3) map_new)) map_new)); (1,f) -> u f (\_2100 _2101 _2102-> (u (u (u map_tie _2100) (u (u (u map_set _2098) _val_3) _2101)) _2102)); }))); (2,f) -> u f (\_2103-> (let _2104 = _map_4 in (case _2104 of {(0,f) -> u f ((u (u (u map_tie maybe_none) map_new) (u (u (u map_set _2103) _val_3) map_new))); (1,f) -> u f (\_2105 _2106 _2107-> (u (u (u map_tie _2105) _2106) (u (u (u map_set _2103) _val_3) _2107))); }))); })))))
map_from_list = (\_xs_2-> (let _2108 = _xs_2 in (case _2108 of {(0,f) -> u f (map_new); (1,f) -> u f (\_2109 _2110-> (let _2111 = _2109 in (case _2111 of {(0,f) -> u f (\_2112 _2113-> (u (u (u map_set _2112) _2113) (u map_from_list _2110))); }))); })))
pair_fst = (\_pair_3-> (let _2114 = _pair_3 in (case _2114 of {(0,f) -> u f (\_2115 _2116-> _2115); })))
pair_snd = (\_pair_3-> (let _2117 = _pair_3 in (case _2117 of {(0,f) -> u f (\_2118 _2119-> _2119); })))
fm_term_cse = (\_path_1-> (\_expr_2-> (\_name_3-> (\_with_4-> (\_cses_5-> (\_moti_6-> (14,\t-> t _path_1 _expr_2 _name_3 _with_4 _cses_5 _moti_6)))))))
fm_parser_case = (\_idx_1-> (\_code_2-> (let _2120 = (u (u fm_parser_init _idx_1) _code_2) in (case _2120 of {(0,f) -> u f (\_2121 _2122 _2123-> (u (u (u parser_reply_error _2121) _2122) _2123)); (1,f) -> u f (\_2124 _2125 _2126-> (let _2127 = (u (u (u fm_parser_text "case ") _2124) _2125) in (case _2127 of {(0,f) -> u f (\_2128 _2129 _2130-> (u (u (u parser_reply_error _2128) _2129) _2130)); (1,f) -> u f (\_2131 _2132 _2133-> (let _2134 = (u (u fm_parser_spaces _2131) _2132) in (case _2134 of {(0,f) -> u f (\_2135 _2136 _2137-> (u (u (u parser_reply_error _2135) _2136) _2137)); (1,f) -> u f (\_2138 _2139 _2140-> (let _2141 = (u (u fm_parser_term _2138) _2139) in (case _2141 of {(0,f) -> u f (\_2142 _2143 _2144-> (u (u (u parser_reply_error _2142) _2143) _2144)); (1,f) -> u f (\_2145 _2146 _2147-> (let _2148 = (u (u (u parser_maybe (\_idx_15-> (\_code_16-> (let _2149 = (u (u (u fm_parser_text "as") _idx_15) _code_16) in (case _2149 of {(0,f) -> u f (\_2150 _2151 _2152-> (u (u (u parser_reply_error _2150) _2151) _2152)); (1,f) -> u f (\_2153 _2154 _2155-> (u (u fm_parser_name1 _2153) _2154)); }))))) _2145) _2146) in (case _2148 of {(0,f) -> u f (\_2156 _2157 _2158-> (u (u (u parser_reply_error _2156) _2157) _2158)); (1,f) -> u f (\_2159 _2160 _2161-> (let _name_18=(let _2162 = _2161 in (case _2162 of {(0,f) -> u f ((let _2163 = (u (u fm_term_reduce _2147) map_new) in (case _2163 of {(0,f) -> u f (\_2164 _2165-> _2164); (1,f) -> u f (\_2166-> _2166); (2,f) -> u f ((u fm_name_read "self")); (3,f) -> u f (\_2167 _2168 _2169 _2170 _2171-> (u fm_name_read "self")); (4,f) -> u f (\_2172 _2173-> (u fm_name_read "self")); (5,f) -> u f (\_2174 _2175-> (u fm_name_read "self")); (6,f) -> u f (\_2176 _2177 _2178-> (u fm_name_read "self")); (7,f) -> u f (\_2179 _2180 _2181-> (u fm_name_read "self")); (8,f) -> u f (\_2182 _2183 _2184-> (u fm_name_read "self")); (9,f) -> u f (\_2185 _2186 _2187-> (u fm_name_read "self")); (10,f) -> u f (\_2188-> (u fm_name_read "self")); (11,f) -> u f (\_2189-> (u fm_name_read "self")); (12,f) -> u f (\_2190-> (u fm_name_read "self")); (13,f) -> u f (\_2191-> (u fm_name_read "self")); (14,f) -> u f (\_2192 _2193 _2194 _2195 _2196 _2197-> (u fm_name_read "self")); (15,f) -> u f (\_2198 _2199-> (u fm_name_read "self")); }))); (1,f) -> u f (\_2200-> _2200); })) in (let _2201 = (u (u (u parser_many fm_parser_case_with) _2159) _2160) in (case _2201 of {(0,f) -> u f (\_2202 _2203 _2204-> (u (u (u parser_reply_error _2202) _2203) _2204)); (1,f) -> u f (\_2205 _2206 _2207-> (let _2208 = (u (u (u fm_parser_text "{") _2205) _2206) in (case _2208 of {(0,f) -> u f (\_2209 _2210 _2211-> (u (u (u parser_reply_error _2209) _2210) _2211)); (1,f) -> u f (\_2212 _2213 _2214-> (let _2215 = (u (u (u (u parser_until (u fm_parser_text "}")) fm_parser_case_case) _2212) _2213) in (case _2215 of {(0,f) -> u f (\_2216 _2217 _2218-> (u (u (u parser_reply_error _2216) _2217) _2218)); (1,f) -> u f (\_2219 _2220 _2221-> (let _cses_28=(u map_from_list (u (u list_mapped _2221) (\_x_28-> (u (u pair_new (u fm_name_to_bits (u pair_fst _x_28))) (u pair_snd _x_28))))) in (let _2222 = (u (u (u parser_first_of (u (u list_cons (\_idx_29-> (\_code_30-> (let _2223 = (u (u (u fm_parser_text ":") _idx_29) _code_30) in (case _2223 of {(0,f) -> u f (\_2224 _2225 _2226-> (u (u (u parser_reply_error _2224) _2225) _2226)); (1,f) -> u f (\_2227 _2228 _2229-> (let _2230 = (u (u fm_parser_term _2227) _2228) in (case _2230 of {(0,f) -> u f (\_2231 _2232 _2233-> (u (u (u parser_reply_error _2231) _2232) _2233)); (1,f) -> u f (\_2234 _2235 _2236-> (u (u (u parser_reply_value _2234) _2235) (u maybe_some _2236))); }))); }))))) (u (u list_cons (\_idx_29-> (\_code_30-> (let _2237 = (u (u (u fm_parser_text "!") _idx_29) _code_30) in (case _2237 of {(0,f) -> u f (\_2238 _2239 _2240-> (u (u (u parser_reply_error _2238) _2239) _2240)); (1,f) -> u f (\_2241 _2242 _2243-> (u (u (u parser_reply_value _2241) _2242) maybe_none)); }))))) (u (u list_cons (\_idx_29-> (\_code_30-> (u (u (u parser_reply_value _idx_29) _code_30) (u maybe_some (u fm_term_hol bits_e)))))) list_nil)))) _2219) _2220) in (case _2222 of {(0,f) -> u f (\_2244 _2245 _2246-> (u (u (u parser_reply_error _2244) _2245) _2246)); (1,f) -> u f (\_2247 _2248 _2249-> (let _2250 = (u (u (u fm_parser_stop _2126) _2247) _2248) in (case _2250 of {(0,f) -> u f (\_2251 _2252 _2253-> (u (u (u parser_reply_error _2251) _2252) _2253)); (1,f) -> u f (\_2254 _2255 _2256-> (u (u (u parser_reply_value _2254) _2255) (u (u fm_term_ori _2256) (u (u (u (u (u (u fm_term_cse bits_e) _2147) _name_18) _2207) _cses_28) _2249)))); }))); })))); }))); }))); })))); }))); }))); }))); }))); }))))
fm_set = (\_name_2-> (\_val_3-> (\_map_4-> (u (u (u map_set (u fm_name_to_bits _name_2)) _val_3) _map_4))))
fm_parser_open = (\_idx_1-> (\_code_2-> (let _2257 = (u (u fm_parser_init _idx_1) _code_2) in (case _2257 of {(0,f) -> u f (\_2258 _2259 _2260-> (u (u (u parser_reply_error _2258) _2259) _2260)); (1,f) -> u f (\_2261 _2262 _2263-> (let _2264 = (u (u (u fm_parser_text "open ") _2261) _2262) in (case _2264 of {(0,f) -> u f (\_2265 _2266 _2267-> (u (u (u parser_reply_error _2265) _2266) _2267)); (1,f) -> u f (\_2268 _2269 _2270-> (let _2271 = (u (u fm_parser_spaces _2268) _2269) in (case _2271 of {(0,f) -> u f (\_2272 _2273 _2274-> (u (u (u parser_reply_error _2272) _2273) _2274)); (1,f) -> u f (\_2275 _2276 _2277-> (let _2278 = (u (u fm_parser_term _2275) _2276) in (case _2278 of {(0,f) -> u f (\_2279 _2280 _2281-> (u (u (u parser_reply_error _2279) _2280) _2281)); (1,f) -> u f (\_2282 _2283 _2284-> (let _2285 = (u (u (u parser_maybe (\_idx_15-> (\_code_16-> (let _2286 = (u (u (u fm_parser_text "as") _idx_15) _code_16) in (case _2286 of {(0,f) -> u f (\_2287 _2288 _2289-> (u (u (u parser_reply_error _2287) _2288) _2289)); (1,f) -> u f (\_2290 _2291 _2292-> (u (u fm_parser_name1 _2290) _2291)); }))))) _2282) _2283) in (case _2285 of {(0,f) -> u f (\_2293 _2294 _2295-> (u (u (u parser_reply_error _2293) _2294) _2295)); (1,f) -> u f (\_2296 _2297 _2298-> (let _2299 = (u (u (u parser_maybe (u fm_parser_text ";")) _2296) _2297) in (case _2299 of {(0,f) -> u f (\_2300 _2301 _2302-> (u (u (u parser_reply_error _2300) _2301) _2302)); (1,f) -> u f (\_2303 _2304 _2305-> (let _name_21=(let _2306 = _2298 in (case _2306 of {(0,f) -> u f ((let _2307 = (u (u fm_term_reduce _2284) map_new) in (case _2307 of {(0,f) -> u f (\_2308 _2309-> _2308); (1,f) -> u f (\_2310-> _2310); (2,f) -> u f ((u fm_name_read "self")); (3,f) -> u f (\_2311 _2312 _2313 _2314 _2315-> (u fm_name_read "self")); (4,f) -> u f (\_2316 _2317-> (u fm_name_read "self")); (5,f) -> u f (\_2318 _2319-> (u fm_name_read "self")); (6,f) -> u f (\_2320 _2321 _2322-> (u fm_name_read "self")); (7,f) -> u f (\_2323 _2324 _2325-> (u fm_name_read "self")); (8,f) -> u f (\_2326 _2327 _2328-> (u fm_name_read "self")); (9,f) -> u f (\_2329 _2330 _2331-> (u fm_name_read "self")); (10,f) -> u f (\_2332-> (u fm_name_read "self")); (11,f) -> u f (\_2333-> (u fm_name_read "self")); (12,f) -> u f (\_2334-> (u fm_name_read "self")); (13,f) -> u f (\_2335-> (u fm_name_read "self")); (14,f) -> u f (\_2336 _2337 _2338 _2339 _2340 _2341-> (u fm_name_read "self")); (15,f) -> u f (\_2342 _2343-> (u fm_name_read "self")); }))); (1,f) -> u f (\_2344-> _2344); })) in (let _wyth_22=list_nil in (let _2345 = (u (u fm_parser_term _2303) _2304) in (case _2345 of {(0,f) -> u f (\_2346 _2347 _2348-> (u (u (u parser_reply_error _2346) _2347) _2348)); (1,f) -> u f (\_2349 _2350 _2351-> (let _cses_26=(u (u (u fm_set "_") _2351) map_new) in (let _moti_27=(u maybe_some (u fm_term_hol bits_e)) in (let _2352 = (u (u (u fm_parser_stop _2263) _2349) _2350) in (case _2352 of {(0,f) -> u f (\_2353 _2354 _2355-> (u (u (u parser_reply_error _2353) _2354) _2355)); (1,f) -> u f (\_2356 _2357 _2358-> (u (u (u parser_reply_value _2356) _2357) (u (u fm_term_ori _2358) (u (u (u (u (u (u fm_term_cse bits_e) _2284) _name_21) _wyth_22) _cses_26) _moti_27)))); }))))); }))))); }))); }))); }))); }))); }))); }))))
parser_digit = (\_idx_1-> (\_code_2-> (let _2359 = _code_2 in (if null (_2359::String) then (u (u (u parser_reply_error _idx_1) _code_2) "Not a digit.") else (let _sidx_5=(u nat_succ _idx_1) in (let _2360 = ((((fromIntegral (fromEnum (head _2359 :: Char)) :: Word16)::Word16) == 48)) in (if _2360 then (u (u (u parser_reply_value _sidx_5) (tail _2359)) 0) else (let _2361 = ((((fromIntegral (fromEnum (head _2359 :: Char)) :: Word16)::Word16) == 49)) in (if _2361 then (u (u (u parser_reply_value _sidx_5) (tail _2359)) 1) else (let _2362 = ((((fromIntegral (fromEnum (head _2359 :: Char)) :: Word16)::Word16) == 50)) in (if _2362 then (u (u (u parser_reply_value _sidx_5) (tail _2359)) 2) else (let _2363 = ((((fromIntegral (fromEnum (head _2359 :: Char)) :: Word16)::Word16) == 51)) in (if _2363 then (u (u (u parser_reply_value _sidx_5) (tail _2359)) 3) else (let _2364 = ((((fromIntegral (fromEnum (head _2359 :: Char)) :: Word16)::Word16) == 52)) in (if _2364 then (u (u (u parser_reply_value _sidx_5) (tail _2359)) 4) else (let _2365 = ((((fromIntegral (fromEnum (head _2359 :: Char)) :: Word16)::Word16) == 53)) in (if _2365 then (u (u (u parser_reply_value _sidx_5) (tail _2359)) 5) else (let _2366 = ((((fromIntegral (fromEnum (head _2359 :: Char)) :: Word16)::Word16) == 54)) in (if _2366 then (u (u (u parser_reply_value _sidx_5) (tail _2359)) 6) else (let _2367 = ((((fromIntegral (fromEnum (head _2359 :: Char)) :: Word16)::Word16) == 55)) in (if _2367 then (u (u (u parser_reply_value _sidx_5) (tail _2359)) 7) else (let _2368 = ((((fromIntegral (fromEnum (head _2359 :: Char)) :: Word16)::Word16) == 56)) in (if _2368 then (u (u (u parser_reply_value _sidx_5) (tail _2359)) 8) else (let _2369 = ((((fromIntegral (fromEnum (head _2359 :: Char)) :: Word16)::Word16) == 57)) in (if _2369 then (u (u (u parser_reply_value _sidx_5) (tail _2359)) 9) else (u (u (u parser_reply_error _idx_1) _code_2) "Not a digit."))))))))))))))))))))))))))
nat_add = (\a0-> \a1-> ((a0::Integer) + a1))
nat_mul = (\a0-> \a1-> ((a0::Integer) * a1))
nat_from_base_go = (\_b_1-> (\_ds_2-> (\_p_3-> (\_res_4-> (let _2370 = _ds_2 in (case _2370 of {(0,f) -> u f (_res_4); (1,f) -> u f (\_2371 _2372-> (u (u (u (u nat_from_base_go _b_1) _2372) (((_b_1::Integer) * _p_3))) ((((((_2371::Integer) * _p_3))::Integer) + _res_4)))); }))))))
list_reverse_go = (\_xs_2-> (\_res_3-> (let _2373 = _xs_2 in (case _2373 of {(0,f) -> u f (_res_3); (1,f) -> u f (\_2374 _2375-> (u (u list_reverse_go _2375) (u (u list_cons _2374) _res_3))); }))))
list_reverse = (\_xs_2-> (u (u list_reverse_go _xs_2) list_nil))
nat_from_base = (\_base_1-> (\_ds_2-> (u (u (u (u nat_from_base_go _base_1) (u list_reverse _ds_2)) 1) 0)))
parser_nat = (\_idx_1-> (\_code_2-> (let _2376 = (u (u (u parser_many1 parser_digit) _idx_1) _code_2) in (case _2376 of {(0,f) -> u f (\_2377 _2378 _2379-> (u (u (u parser_reply_error _2377) _2378) _2379)); (1,f) -> u f (\_2380 _2381 _2382-> (u (u (u parser_reply_value _2380) _2381) (u (u nat_from_base 10) _2382))); }))))
bits_tail = (\_a_1-> (let _2383 = _a_1 in (case _2383 of {(0,f) -> u f (bits_e); (1,f) -> u f (\_2384-> _2384); (2,f) -> u f (\_2385-> _2385); })))
bits_inc = (\_a_1-> (let _2386 = _a_1 in (case _2386 of {(0,f) -> u f ((u bits_i bits_e)); (1,f) -> u f (\_2387-> (u bits_i _2387)); (2,f) -> u f (\_2388-> (u bits_o (u bits_inc _2388))); })))
nat_to_bits = (\_n_1-> (let _2389 = _n_1 in (if _2389==0 then bits_e else (u bits_inc (u nat_to_bits (_2389-1))))))
maybe_to_bool = (\_m_2-> (let _2390 = _m_2 in (case _2390 of {(0,f) -> u f (bool_false); (1,f) -> u f (\_2391-> bool_true); })))
fm_term_gol = (\_name_1-> (\_dref_2-> (\_verb_3-> (9,\t-> t _name_1 _dref_2 _verb_3))))
fm_parser_goal = (\_idx_1-> (\_code_2-> (let _2392 = (u (u fm_parser_init _idx_1) _code_2) in (case _2392 of {(0,f) -> u f (\_2393 _2394 _2395-> (u (u (u parser_reply_error _2393) _2394) _2395)); (1,f) -> u f (\_2396 _2397 _2398-> (let _2399 = (u (u (u fm_parser_text "?") _2396) _2397) in (case _2399 of {(0,f) -> u f (\_2400 _2401 _2402-> (u (u (u parser_reply_error _2400) _2401) _2402)); (1,f) -> u f (\_2403 _2404 _2405-> (let _2406 = (u (u fm_parser_name _2403) _2404) in (case _2406 of {(0,f) -> u f (\_2407 _2408 _2409-> (u (u (u parser_reply_error _2407) _2408) _2409)); (1,f) -> u f (\_2410 _2411 _2412-> (let _2413 = (u (u (u parser_many (\_idx_12-> (\_code_13-> (let _2414 = (u (u (u fm_parser_text "-") _idx_12) _code_13) in (case _2414 of {(0,f) -> u f (\_2415 _2416 _2417-> (u (u (u parser_reply_error _2415) _2416) _2417)); (1,f) -> u f (\_2418 _2419 _2420-> (let _2421 = (u (u parser_nat _2418) _2419) in (case _2421 of {(0,f) -> u f (\_2422 _2423 _2424-> (u (u (u parser_reply_error _2422) _2423) _2424)); (1,f) -> u f (\_2425 _2426 _2427-> (let _bits_20=(u bits_reverse (u bits_tail (u bits_reverse (u nat_to_bits _2427)))) in (u (u (u parser_reply_value _2425) _2426) _bits_20))); }))); }))))) _2410) _2411) in (case _2413 of {(0,f) -> u f (\_2428 _2429 _2430-> (u (u (u parser_reply_error _2428) _2429) _2430)); (1,f) -> u f (\_2431 _2432 _2433-> (let _2434 = (let _2435 = (u (u (u parser_maybe (u parser_text "-")) _2431) _2432) in (case _2435 of {(0,f) -> u f (\_2436 _2437 _2438-> (u (u (u parser_reply_error _2436) _2437) _2438)); (1,f) -> u f (\_2439 _2440 _2441-> (u (u (u parser_reply_value _2439) _2440) (u maybe_to_bool _2441))); })) in (case _2434 of {(0,f) -> u f (\_2442 _2443 _2444-> (u (u (u parser_reply_error _2442) _2443) _2444)); (1,f) -> u f (\_2445 _2446 _2447-> (let _2448 = (u (u (u fm_parser_stop _2398) _2445) _2446) in (case _2448 of {(0,f) -> u f (\_2449 _2450 _2451-> (u (u (u parser_reply_error _2449) _2450) _2451)); (1,f) -> u f (\_2452 _2453 _2454-> (u (u (u parser_reply_value _2452) _2453) (u (u fm_term_ori _2454) (u (u (u fm_term_gol _2412) _2433) _2447)))); }))); }))); }))); }))); }))); }))))
fm_parser_hole = (\_idx_1-> (\_code_2-> (let _2455 = (u (u fm_parser_init _idx_1) _code_2) in (case _2455 of {(0,f) -> u f (\_2456 _2457 _2458-> (u (u (u parser_reply_error _2456) _2457) _2458)); (1,f) -> u f (\_2459 _2460 _2461-> (let _2462 = (u (u (u fm_parser_text "_") _2459) _2460) in (case _2462 of {(0,f) -> u f (\_2463 _2464 _2465-> (u (u (u parser_reply_error _2463) _2464) _2465)); (1,f) -> u f (\_2466 _2467 _2468-> (let _2469 = (u (u (u fm_parser_stop _2461) _2466) _2467) in (case _2469 of {(0,f) -> u f (\_2470 _2471 _2472-> (u (u (u parser_reply_error _2470) _2471) _2472)); (1,f) -> u f (\_2473 _2474 _2475-> (u (u (u parser_reply_value _2473) _2474) (u (u fm_term_ori _2475) (u fm_term_hol bits_e)))); }))); }))); }))))
fm_parser_u8 = (\_idx_1-> (\_code_2-> (let _2476 = (u (u fm_parser_init _idx_1) _code_2) in (case _2476 of {(0,f) -> u f (\_2477 _2478 _2479-> (u (u (u parser_reply_error _2477) _2478) _2479)); (1,f) -> u f (\_2480 _2481 _2482-> (let _2483 = (u (u fm_parser_spaces _2480) _2481) in (case _2483 of {(0,f) -> u f (\_2484 _2485 _2486-> (u (u (u parser_reply_error _2484) _2485) _2486)); (1,f) -> u f (\_2487 _2488 _2489-> (let _2490 = (u (u parser_nat _2487) _2488) in (case _2490 of {(0,f) -> u f (\_2491 _2492 _2493-> (u (u (u parser_reply_error _2491) _2492) _2493)); (1,f) -> u f (\_2494 _2495 _2496-> (let _2497 = (u (u (u parser_text "b") _2494) _2495) in (case _2497 of {(0,f) -> u f (\_2498 _2499 _2500-> (u (u (u parser_reply_error _2498) _2499) _2500)); (1,f) -> u f (\_2501 _2502 _2503-> (let _term_15=(u fm_term_ref "Nat.to_u8") in (let _term_16=(u (u fm_term_app _term_15) (u fm_term_nat _2496)) in (let _2504 = (u (u (u fm_parser_stop _2482) _2501) _2502) in (case _2504 of {(0,f) -> u f (\_2505 _2506 _2507-> (u (u (u parser_reply_error _2505) _2506) _2507)); (1,f) -> u f (\_2508 _2509 _2510-> (u (u (u parser_reply_value _2508) _2509) (u (u fm_term_ori _2510) _term_16))); }))))); }))); }))); }))); }))))
fm_parser_u16 = (\_idx_1-> (\_code_2-> (let _2511 = (u (u fm_parser_init _idx_1) _code_2) in (case _2511 of {(0,f) -> u f (\_2512 _2513 _2514-> (u (u (u parser_reply_error _2512) _2513) _2514)); (1,f) -> u f (\_2515 _2516 _2517-> (let _2518 = (u (u fm_parser_spaces _2515) _2516) in (case _2518 of {(0,f) -> u f (\_2519 _2520 _2521-> (u (u (u parser_reply_error _2519) _2520) _2521)); (1,f) -> u f (\_2522 _2523 _2524-> (let _2525 = (u (u parser_nat _2522) _2523) in (case _2525 of {(0,f) -> u f (\_2526 _2527 _2528-> (u (u (u parser_reply_error _2526) _2527) _2528)); (1,f) -> u f (\_2529 _2530 _2531-> (let _2532 = (u (u (u parser_text "s") _2529) _2530) in (case _2532 of {(0,f) -> u f (\_2533 _2534 _2535-> (u (u (u parser_reply_error _2533) _2534) _2535)); (1,f) -> u f (\_2536 _2537 _2538-> (let _term_15=(u fm_term_ref "Nat.to_u16") in (let _term_16=(u (u fm_term_app _term_15) (u fm_term_nat _2531)) in (let _2539 = (u (u (u fm_parser_stop _2517) _2536) _2537) in (case _2539 of {(0,f) -> u f (\_2540 _2541 _2542-> (u (u (u parser_reply_error _2540) _2541) _2542)); (1,f) -> u f (\_2543 _2544 _2545-> (u (u (u parser_reply_value _2543) _2544) (u (u fm_term_ori _2545) _term_16))); }))))); }))); }))); }))); }))))
fm_parser_u32 = (\_idx_1-> (\_code_2-> (let _2546 = (u (u fm_parser_init _idx_1) _code_2) in (case _2546 of {(0,f) -> u f (\_2547 _2548 _2549-> (u (u (u parser_reply_error _2547) _2548) _2549)); (1,f) -> u f (\_2550 _2551 _2552-> (let _2553 = (u (u fm_parser_spaces _2550) _2551) in (case _2553 of {(0,f) -> u f (\_2554 _2555 _2556-> (u (u (u parser_reply_error _2554) _2555) _2556)); (1,f) -> u f (\_2557 _2558 _2559-> (let _2560 = (u (u parser_nat _2557) _2558) in (case _2560 of {(0,f) -> u f (\_2561 _2562 _2563-> (u (u (u parser_reply_error _2561) _2562) _2563)); (1,f) -> u f (\_2564 _2565 _2566-> (let _2567 = (u (u (u parser_text "u") _2564) _2565) in (case _2567 of {(0,f) -> u f (\_2568 _2569 _2570-> (u (u (u parser_reply_error _2568) _2569) _2570)); (1,f) -> u f (\_2571 _2572 _2573-> (let _term_15=(u fm_term_ref "Nat.to_u32") in (let _term_16=(u (u fm_term_app _term_15) (u fm_term_nat _2566)) in (let _2574 = (u (u (u fm_parser_stop _2552) _2571) _2572) in (case _2574 of {(0,f) -> u f (\_2575 _2576 _2577-> (u (u (u parser_reply_error _2575) _2576) _2577)); (1,f) -> u f (\_2578 _2579 _2580-> (u (u (u parser_reply_value _2578) _2579) (u (u fm_term_ori _2580) _term_16))); }))))); }))); }))); }))); }))))
fm_parser_u64 = (\_idx_1-> (\_code_2-> (let _2581 = (u (u fm_parser_init _idx_1) _code_2) in (case _2581 of {(0,f) -> u f (\_2582 _2583 _2584-> (u (u (u parser_reply_error _2582) _2583) _2584)); (1,f) -> u f (\_2585 _2586 _2587-> (let _2588 = (u (u fm_parser_spaces _2585) _2586) in (case _2588 of {(0,f) -> u f (\_2589 _2590 _2591-> (u (u (u parser_reply_error _2589) _2590) _2591)); (1,f) -> u f (\_2592 _2593 _2594-> (let _2595 = (u (u parser_nat _2592) _2593) in (case _2595 of {(0,f) -> u f (\_2596 _2597 _2598-> (u (u (u parser_reply_error _2596) _2597) _2598)); (1,f) -> u f (\_2599 _2600 _2601-> (let _2602 = (u (u (u parser_text "l") _2599) _2600) in (case _2602 of {(0,f) -> u f (\_2603 _2604 _2605-> (u (u (u parser_reply_error _2603) _2604) _2605)); (1,f) -> u f (\_2606 _2607 _2608-> (let _term_15=(u fm_term_ref "Nat.to_u64") in (let _term_16=(u (u fm_term_app _term_15) (u fm_term_nat _2601)) in (let _2609 = (u (u (u fm_parser_stop _2587) _2606) _2607) in (case _2609 of {(0,f) -> u f (\_2610 _2611 _2612-> (u (u (u parser_reply_error _2610) _2611) _2612)); (1,f) -> u f (\_2613 _2614 _2615-> (u (u (u parser_reply_value _2613) _2614) (u (u fm_term_ori _2615) _term_16))); }))))); }))); }))); }))); }))))
fm_parser_nat = (\_idx_1-> (\_code_2-> (let _2616 = (u (u fm_parser_init _idx_1) _code_2) in (case _2616 of {(0,f) -> u f (\_2617 _2618 _2619-> (u (u (u parser_reply_error _2617) _2618) _2619)); (1,f) -> u f (\_2620 _2621 _2622-> (let _2623 = (u (u fm_parser_spaces _2620) _2621) in (case _2623 of {(0,f) -> u f (\_2624 _2625 _2626-> (u (u (u parser_reply_error _2624) _2625) _2626)); (1,f) -> u f (\_2627 _2628 _2629-> (let _2630 = (u (u parser_nat _2627) _2628) in (case _2630 of {(0,f) -> u f (\_2631 _2632 _2633-> (u (u (u parser_reply_error _2631) _2632) _2633)); (1,f) -> u f (\_2634 _2635 _2636-> (let _2637 = (u (u (u fm_parser_stop _2622) _2634) _2635) in (case _2637 of {(0,f) -> u f (\_2638 _2639 _2640-> (u (u (u parser_reply_error _2638) _2639) _2640)); (1,f) -> u f (\_2641 _2642 _2643-> (u (u (u parser_reply_value _2641) _2642) (u (u fm_term_ori _2643) (u fm_term_nat _2636)))); }))); }))); }))); }))))
string_eql = (\a0-> \a1-> ((a0::String) == a1))
parser_fail = (\_error_2-> (\_idx_3-> (\_code_4-> (u (u (u parser_reply_error _idx_3) _code_4) _error_2))))
fm_parser_reference = (\_idx_1-> (\_code_2-> (let _2644 = (u (u fm_parser_init _idx_1) _code_2) in (case _2644 of {(0,f) -> u f (\_2645 _2646 _2647-> (u (u (u parser_reply_error _2645) _2646) _2647)); (1,f) -> u f (\_2648 _2649 _2650-> (let _2651 = (u (u fm_parser_name1 _2648) _2649) in (case _2651 of {(0,f) -> u f (\_2652 _2653 _2654-> (u (u (u parser_reply_error _2652) _2653) _2654)); (1,f) -> u f (\_2655 _2656 _2657-> (let _2658 = (((_2657::String) == "case")) in (if _2658 then (u parser_fail "Reserved keyword.") else (let _2659 = (((_2657::String) == "do")) in (if _2659 then (u parser_fail "Reserved keyword.") else (let _2660 = (((_2657::String) == "if")) in (if _2660 then (u parser_fail "Reserved keyword.") else (let _2661 = (((_2657::String) == "with")) in (if _2661 then (u parser_fail "Reserved keyword.") else (let _2662 = (((_2657::String) == "let")) in (if _2662 then (u parser_fail "Reserved keyword.") else (let _2663 = (((_2657::String) == "def")) in (if _2663 then (u parser_fail "Reserved keyword.") else (let _2664 = (((_2657::String) == "true")) in (if _2664 then (\_idx_9-> (\_code_10-> (u (u (u parser_reply_value _idx_9) _code_10) (u fm_term_ref "Bool.true")))) else (let _2665 = (((_2657::String) == "false")) in (if _2665 then (\_idx_9-> (\_code_10-> (u (u (u parser_reply_value _idx_9) _code_10) (u fm_term_ref "Bool.false")))) else (let _2666 = (((_2657::String) == "unit")) in (if _2666 then (\_idx_9-> (\_code_10-> (u (u (u parser_reply_value _idx_9) _code_10) (u fm_term_ref "Unit.new")))) else (let _2667 = (((_2657::String) == "none")) in (if _2667 then (let _term_9=(u fm_term_ref "Maybe.none") in (let _term_10=(u (u fm_term_app _term_9) (u fm_term_hol bits_e)) in (\_idx_11-> (\_code_12-> (u (u (u parser_reply_value _idx_11) _code_12) _term_10))))) else (let _2668 = (((_2657::String) == "refl")) in (if _2668 then (let _term_9=(u fm_term_ref "Equal.refl") in (let _term_10=(u (u fm_term_app _term_9) (u fm_term_hol bits_e)) in (let _term_11=(u (u fm_term_app _term_10) (u fm_term_hol bits_e)) in (\_idx_12-> (\_code_13-> (u (u (u parser_reply_value _idx_12) _code_13) _term_11)))))) else (\_idx_9-> (\_code_10-> (let _2669 = (u (u (u fm_parser_stop _2650) _idx_9) _code_10) in (case _2669 of {(0,f) -> u f (\_2670 _2671 _2672-> (u (u (u parser_reply_error _2670) _2671) _2672)); (1,f) -> u f (\_2673 _2674 _2675-> (u (u (u parser_reply_value _2673) _2674) (u (u fm_term_ori _2675) (u fm_term_ref _2657)))); })))))))))))))))))))))))))) _2655 _2656); }))); }))))
list_for = (\_xs_2-> (\_b_4-> (\_f_5-> (let _2676 = _xs_2 in (case _2676 of {(0,f) -> u f (_b_4); (1,f) -> u f (\_2677 _2678-> (u (u (u list_for _2678) (u (u _f_5 _2677) _b_4)) _f_5)); })))))
fm_parser_application = (\_init_1-> (\_func_2-> (\_idx_3-> (\_code_4-> (let _2679 = (u (u (u parser_text "(") _idx_3) _code_4) in (case _2679 of {(0,f) -> u f (\_2680 _2681 _2682-> (u (u (u parser_reply_error _2680) _2681) _2682)); (1,f) -> u f (\_2683 _2684 _2685-> (let _2686 = (u (u (u (u parser_until1 (u fm_parser_text ")")) (u fm_parser_item fm_parser_term)) _2683) _2684) in (case _2686 of {(0,f) -> u f (\_2687 _2688 _2689-> (u (u (u parser_reply_error _2687) _2688) _2689)); (1,f) -> u f (\_2690 _2691 _2692-> (let _2693 = (u (u (u fm_parser_stop _init_1) _2690) _2691) in (case _2693 of {(0,f) -> u f (\_2694 _2695 _2696-> (u (u (u parser_reply_error _2694) _2695) _2696)); (1,f) -> u f (\_2697 _2698 _2699-> (let _expr_14=(u (u (u list_for _2692) _func_2) (\_x_14-> (\_f_15-> (u (u fm_term_app _f_15) _x_14)))) in (u (u (u parser_reply_value _2697) _2698) (u (u fm_term_ori _2699) _expr_14)))); }))); }))); }))))))
parser_spaces = (u parser_many (u parser_first_of (u (u list_cons (u parser_text " ")) (u (u list_cons (u parser_text "\n")) list_nil))))
parser_spaces_text = (\_text_1-> (\_idx_2-> (\_code_3-> (let _2700 = (u (u parser_spaces _idx_2) _code_3) in (case _2700 of {(0,f) -> u f (\_2701 _2702 _2703-> (u (u (u parser_reply_error _2701) _2702) _2703)); (1,f) -> u f (\_2704 _2705 _2706-> (u (u (u parser_text _text_1) _2704) _2705)); })))))
fm_parser_application_erased = (\_init_1-> (\_func_2-> (\_idx_3-> (\_code_4-> (let _2707 = (u (u parser_get_index _idx_3) _code_4) in (case _2707 of {(0,f) -> u f (\_2708 _2709 _2710-> (u (u (u parser_reply_error _2708) _2709) _2710)); (1,f) -> u f (\_2711 _2712 _2713-> (let _2714 = (u (u (u parser_text "<") _2711) _2712) in (case _2714 of {(0,f) -> u f (\_2715 _2716 _2717-> (u (u (u parser_reply_error _2715) _2716) _2717)); (1,f) -> u f (\_2718 _2719 _2720-> (let _2721 = (u (u (u (u parser_until1 (u parser_spaces_text ">")) (u fm_parser_item fm_parser_term)) _2718) _2719) in (case _2721 of {(0,f) -> u f (\_2722 _2723 _2724-> (u (u (u parser_reply_error _2722) _2723) _2724)); (1,f) -> u f (\_2725 _2726 _2727-> (let _2728 = (u (u (u fm_parser_stop _2713) _2725) _2726) in (case _2728 of {(0,f) -> u f (\_2729 _2730 _2731-> (u (u (u parser_reply_error _2729) _2730) _2731)); (1,f) -> u f (\_2732 _2733 _2734-> (let _expr_17=(u (u (u list_for _2727) _func_2) (\_x_17-> (\_f_18-> (u (u fm_term_app _f_18) _x_17)))) in (u (u (u parser_reply_value _2732) _2733) (u (u fm_term_ori _2734) _expr_17)))); }))); }))); }))); }))))))
fm_parser_arrow = (\_init_1-> (\_xtyp_2-> (\_idx_3-> (\_code_4-> (let _2735 = (u (u (u fm_parser_text "->") _idx_3) _code_4) in (case _2735 of {(0,f) -> u f (\_2736 _2737 _2738-> (u (u (u parser_reply_error _2736) _2737) _2738)); (1,f) -> u f (\_2739 _2740 _2741-> (let _2742 = (u (u fm_parser_term _2739) _2740) in (case _2742 of {(0,f) -> u f (\_2743 _2744 _2745-> (u (u (u parser_reply_error _2743) _2744) _2745)); (1,f) -> u f (\_2746 _2747 _2748-> (let _2749 = (u (u (u fm_parser_stop _init_1) _2746) _2747) in (case _2749 of {(0,f) -> u f (\_2750 _2751 _2752-> (u (u (u parser_reply_error _2750) _2751) _2752)); (1,f) -> u f (\_2753 _2754 _2755-> (u (u (u parser_reply_value _2753) _2754) (u (u fm_term_ori _2755) (u (u (u (u (u fm_term_all bool_false) "") "") _xtyp_2) (\_s_14-> (\_x_15-> _2748)))))); }))); }))); }))))))
fm_parser_op = (\_sym_1-> (\_ref_2-> (\_init_3-> (\_val0_4-> (\_idx_5-> (\_code_6-> (let _2756 = (u (u (u fm_parser_text _sym_1) _idx_5) _code_6) in (case _2756 of {(0,f) -> u f (\_2757 _2758 _2759-> (u (u (u parser_reply_error _2757) _2758) _2759)); (1,f) -> u f (\_2760 _2761 _2762-> (let _2763 = (u (u fm_parser_term _2760) _2761) in (case _2763 of {(0,f) -> u f (\_2764 _2765 _2766-> (u (u (u parser_reply_error _2764) _2765) _2766)); (1,f) -> u f (\_2767 _2768 _2769-> (let _2770 = (u (u (u fm_parser_stop _init_3) _2767) _2768) in (case _2770 of {(0,f) -> u f (\_2771 _2772 _2773-> (u (u (u parser_reply_error _2771) _2772) _2773)); (1,f) -> u f (\_2774 _2775 _2776-> (let _term_16=(u fm_term_ref _ref_2) in (let _term_17=(u (u fm_term_app _term_16) _val0_4) in (let _term_18=(u (u fm_term_app _term_17) _2769) in (u (u (u parser_reply_value _2774) _2775) (u (u fm_term_ori _2776) _term_18)))))); }))); }))); }))))))))
fm_parser_add = (u (u fm_parser_op "+") "Nat.add")
fm_parser_sub = (u (u fm_parser_op "+") "Nat.add")
fm_parser_mul = (u (u fm_parser_op "*") "Nat.mul")
fm_parser_div = (u (u fm_parser_op "/") "Nat.div")
fm_parser_mod = (u (u fm_parser_op "%") "Nat.mod")
fm_parser_cons = (\_init_1-> (\_head_2-> (\_idx_3-> (\_code_4-> (let _2777 = (u (u (u fm_parser_text "&") _idx_3) _code_4) in (case _2777 of {(0,f) -> u f (\_2778 _2779 _2780-> (u (u (u parser_reply_error _2778) _2779) _2780)); (1,f) -> u f (\_2781 _2782 _2783-> (let _2784 = (u (u fm_parser_term _2781) _2782) in (case _2784 of {(0,f) -> u f (\_2785 _2786 _2787-> (u (u (u parser_reply_error _2785) _2786) _2787)); (1,f) -> u f (\_2788 _2789 _2790-> (let _2791 = (u (u (u fm_parser_stop _init_1) _2788) _2789) in (case _2791 of {(0,f) -> u f (\_2792 _2793 _2794-> (u (u (u parser_reply_error _2792) _2793) _2794)); (1,f) -> u f (\_2795 _2796 _2797-> (let _term_14=(u fm_term_ref "List.cons") in (let _term_15=(u (u fm_term_app _term_14) (u fm_term_hol bits_e)) in (let _term_16=(u (u fm_term_app _term_15) _head_2) in (let _term_17=(u (u fm_term_app _term_16) _2790) in (let _2798 = (u (u (u fm_parser_stop _init_1) _2795) _2796) in (case _2798 of {(0,f) -> u f (\_2799 _2800 _2801-> (u (u (u parser_reply_error _2799) _2800) _2801)); (1,f) -> u f (\_2802 _2803 _2804-> (u (u (u parser_reply_value _2802) _2803) (u (u fm_term_ori _2804) _term_17))); }))))))); }))); }))); }))))))
fm_parser_concat = (\_init_1-> (\_lst0_2-> (\_idx_3-> (\_code_4-> (let _2805 = (u (u (u fm_parser_text "++") _idx_3) _code_4) in (case _2805 of {(0,f) -> u f (\_2806 _2807 _2808-> (u (u (u parser_reply_error _2806) _2807) _2808)); (1,f) -> u f (\_2809 _2810 _2811-> (let _2812 = (u (u fm_parser_term _2809) _2810) in (case _2812 of {(0,f) -> u f (\_2813 _2814 _2815-> (u (u (u parser_reply_error _2813) _2814) _2815)); (1,f) -> u f (\_2816 _2817 _2818-> (let _2819 = (u (u (u fm_parser_stop _init_1) _2816) _2817) in (case _2819 of {(0,f) -> u f (\_2820 _2821 _2822-> (u (u (u parser_reply_error _2820) _2821) _2822)); (1,f) -> u f (\_2823 _2824 _2825-> (let _term_14=(u fm_term_ref "List.concat") in (let _term_15=(u (u fm_term_app _term_14) (u fm_term_hol bits_e)) in (let _term_16=(u (u fm_term_app _term_15) _lst0_2) in (let _term_17=(u (u fm_term_app _term_16) _2818) in (let _2826 = (u (u (u fm_parser_stop _init_1) _2823) _2824) in (case _2826 of {(0,f) -> u f (\_2827 _2828 _2829-> (u (u (u parser_reply_error _2827) _2828) _2829)); (1,f) -> u f (\_2830 _2831 _2832-> (u (u (u parser_reply_value _2830) _2831) (u (u fm_term_ori _2832) _term_17))); }))))))); }))); }))); }))))))
fm_parser_string_concat = (\_init_1-> (\_str0_2-> (\_idx_3-> (\_code_4-> (let _2833 = (u (u (u fm_parser_text "|") _idx_3) _code_4) in (case _2833 of {(0,f) -> u f (\_2834 _2835 _2836-> (u (u (u parser_reply_error _2834) _2835) _2836)); (1,f) -> u f (\_2837 _2838 _2839-> (let _2840 = (u (u fm_parser_term _2837) _2838) in (case _2840 of {(0,f) -> u f (\_2841 _2842 _2843-> (u (u (u parser_reply_error _2841) _2842) _2843)); (1,f) -> u f (\_2844 _2845 _2846-> (let _2847 = (u (u (u fm_parser_stop _init_1) _2844) _2845) in (case _2847 of {(0,f) -> u f (\_2848 _2849 _2850-> (u (u (u parser_reply_error _2848) _2849) _2850)); (1,f) -> u f (\_2851 _2852 _2853-> (let _term_14=(u fm_term_ref "String.concat") in (let _term_15=(u (u fm_term_app _term_14) _str0_2) in (let _term_16=(u (u fm_term_app _term_15) _2846) in (let _2854 = (u (u (u fm_parser_stop _init_1) _2851) _2852) in (case _2854 of {(0,f) -> u f (\_2855 _2856 _2857-> (u (u (u parser_reply_error _2855) _2856) _2857)); (1,f) -> u f (\_2858 _2859 _2860-> (u (u (u parser_reply_value _2858) _2859) (u (u fm_term_ori _2860) _term_16))); })))))); }))); }))); }))))))
fm_parser_sigma = (\_init_1-> (\_val0_2-> (\_idx_3-> (\_code_4-> (let _2861 = (u (u (u fm_parser_text "~") _idx_3) _code_4) in (case _2861 of {(0,f) -> u f (\_2862 _2863 _2864-> (u (u (u parser_reply_error _2862) _2863) _2864)); (1,f) -> u f (\_2865 _2866 _2867-> (let _2868 = (u (u fm_parser_term _2865) _2866) in (case _2868 of {(0,f) -> u f (\_2869 _2870 _2871-> (u (u (u parser_reply_error _2869) _2870) _2871)); (1,f) -> u f (\_2872 _2873 _2874-> (let _2875 = (u (u (u fm_parser_stop _init_1) _2872) _2873) in (case _2875 of {(0,f) -> u f (\_2876 _2877 _2878-> (u (u (u parser_reply_error _2876) _2877) _2878)); (1,f) -> u f (\_2879 _2880 _2881-> (let _term_14=(u fm_term_ref "Sigma.new") in (let _term_15=(u (u fm_term_app _term_14) (u fm_term_hol bits_e)) in (let _term_16=(u (u fm_term_app _term_15) (u fm_term_hol bits_e)) in (let _term_17=(u (u fm_term_app _term_16) _val0_2) in (let _term_18=(u (u fm_term_app _term_17) _2874) in (u (u (u parser_reply_value _2879) _2880) (u (u fm_term_ori _2881) _term_18)))))))); }))); }))); }))))))
fm_parser_equality = (\_init_1-> (\_val0_2-> (\_idx_3-> (\_code_4-> (let _2882 = (u (u (u fm_parser_text "==") _idx_3) _code_4) in (case _2882 of {(0,f) -> u f (\_2883 _2884 _2885-> (u (u (u parser_reply_error _2883) _2884) _2885)); (1,f) -> u f (\_2886 _2887 _2888-> (let _2889 = (u (u fm_parser_term _2886) _2887) in (case _2889 of {(0,f) -> u f (\_2890 _2891 _2892-> (u (u (u parser_reply_error _2890) _2891) _2892)); (1,f) -> u f (\_2893 _2894 _2895-> (let _2896 = (u (u (u fm_parser_stop _init_1) _2893) _2894) in (case _2896 of {(0,f) -> u f (\_2897 _2898 _2899-> (u (u (u parser_reply_error _2897) _2898) _2899)); (1,f) -> u f (\_2900 _2901 _2902-> (let _term_14=(u fm_term_ref "Equal") in (let _term_15=(u (u fm_term_app _term_14) (u fm_term_hol bits_e)) in (let _term_16=(u (u fm_term_app _term_15) _val0_2) in (let _term_17=(u (u fm_term_app _term_16) _2895) in (u (u (u parser_reply_value _2900) _2901) (u (u fm_term_ori _2902) _term_17))))))); }))); }))); }))))))
fm_parser_inequality = (\_init_1-> (\_val0_2-> (\_idx_3-> (\_code_4-> (let _2903 = (u (u (u fm_parser_text "!=") _idx_3) _code_4) in (case _2903 of {(0,f) -> u f (\_2904 _2905 _2906-> (u (u (u parser_reply_error _2904) _2905) _2906)); (1,f) -> u f (\_2907 _2908 _2909-> (let _2910 = (u (u fm_parser_term _2907) _2908) in (case _2910 of {(0,f) -> u f (\_2911 _2912 _2913-> (u (u (u parser_reply_error _2911) _2912) _2913)); (1,f) -> u f (\_2914 _2915 _2916-> (let _2917 = (u (u (u fm_parser_stop _init_1) _2914) _2915) in (case _2917 of {(0,f) -> u f (\_2918 _2919 _2920-> (u (u (u parser_reply_error _2918) _2919) _2920)); (1,f) -> u f (\_2921 _2922 _2923-> (let _term_14=(u fm_term_ref "Equal") in (let _term_15=(u (u fm_term_app _term_14) (u fm_term_hol bits_e)) in (let _term_16=(u (u fm_term_app _term_15) _val0_2) in (let _term_17=(u (u fm_term_app _term_16) _2916) in (let _term_18=(u (u fm_term_app (u fm_term_ref "Not")) _term_17) in (u (u (u parser_reply_value _2921) _2922) (u (u fm_term_ori _2923) _term_18)))))))); }))); }))); }))))))
fm_parser_rewrite = (\_init_1-> (\_subt_2-> (\_idx_3-> (\_code_4-> (let _2924 = (u (u (u fm_parser_text "::") _idx_3) _code_4) in (case _2924 of {(0,f) -> u f (\_2925 _2926 _2927-> (u (u (u parser_reply_error _2925) _2926) _2927)); (1,f) -> u f (\_2928 _2929 _2930-> (let _2931 = (u (u (u fm_parser_text "rewrite") _2928) _2929) in (case _2931 of {(0,f) -> u f (\_2932 _2933 _2934-> (u (u (u parser_reply_error _2932) _2933) _2934)); (1,f) -> u f (\_2935 _2936 _2937-> (let _2938 = (u (u fm_parser_name1 _2935) _2936) in (case _2938 of {(0,f) -> u f (\_2939 _2940 _2941-> (u (u (u parser_reply_error _2939) _2940) _2941)); (1,f) -> u f (\_2942 _2943 _2944-> (let _2945 = (u (u (u fm_parser_text "in") _2942) _2943) in (case _2945 of {(0,f) -> u f (\_2946 _2947 _2948-> (u (u (u parser_reply_error _2946) _2947) _2948)); (1,f) -> u f (\_2949 _2950 _2951-> (let _2952 = (u (u fm_parser_term _2949) _2950) in (case _2952 of {(0,f) -> u f (\_2953 _2954 _2955-> (u (u (u parser_reply_error _2953) _2954) _2955)); (1,f) -> u f (\_2956 _2957 _2958-> (let _2959 = (u (u (u fm_parser_text "with") _2956) _2957) in (case _2959 of {(0,f) -> u f (\_2960 _2961 _2962-> (u (u (u parser_reply_error _2960) _2961) _2962)); (1,f) -> u f (\_2963 _2964 _2965-> (let _2966 = (u (u fm_parser_term _2963) _2964) in (case _2966 of {(0,f) -> u f (\_2967 _2968 _2969-> (u (u (u parser_reply_error _2967) _2968) _2969)); (1,f) -> u f (\_2970 _2971 _2972-> (let _2973 = (u (u (u fm_parser_stop _init_1) _2970) _2971) in (case _2973 of {(0,f) -> u f (\_2974 _2975 _2976-> (u (u (u parser_reply_error _2974) _2975) _2976)); (1,f) -> u f (\_2977 _2978 _2979-> (let _term_29=(u fm_term_ref "Equal.rewrite") in (let _term_30=(u (u fm_term_app _term_29) (u fm_term_hol bits_e)) in (let _term_31=(u (u fm_term_app _term_30) (u fm_term_hol bits_e)) in (let _term_32=(u (u fm_term_app _term_31) (u fm_term_hol bits_e)) in (let _term_33=(u (u fm_term_app _term_32) _2972) in (let _term_34=(u (u fm_term_app _term_33) (u (u fm_term_lam _2944) (\_x_34-> _2958))) in (let _term_35=(u (u fm_term_app _term_34) _subt_2) in (u (u (u parser_reply_value _2977) _2978) (u (u fm_term_ori _2979) _term_35)))))))))); }))); }))); }))); }))); }))); }))); }))); }))))))
fm_term_ann = (\_done_1-> (\_term_2-> (\_type_3-> (8,\t-> t _done_1 _term_2 _type_3))))
fm_parser_annotation = (\_init_1-> (\_term_2-> (\_idx_3-> (\_code_4-> (let _2980 = (u (u (u fm_parser_text "::") _idx_3) _code_4) in (case _2980 of {(0,f) -> u f (\_2981 _2982 _2983-> (u (u (u parser_reply_error _2981) _2982) _2983)); (1,f) -> u f (\_2984 _2985 _2986-> (let _2987 = (u (u fm_parser_term _2984) _2985) in (case _2987 of {(0,f) -> u f (\_2988 _2989 _2990-> (u (u (u parser_reply_error _2988) _2989) _2990)); (1,f) -> u f (\_2991 _2992 _2993-> (let _2994 = (u (u (u fm_parser_stop _init_1) _2991) _2992) in (case _2994 of {(0,f) -> u f (\_2995 _2996 _2997-> (u (u (u parser_reply_error _2995) _2996) _2997)); (1,f) -> u f (\_2998 _2999 _3000-> (u (u (u parser_reply_value _2998) _2999) (u (u fm_term_ori _3000) (u (u (u fm_term_ann bool_false) _term_2) _2993)))); }))); }))); }))))))
fm_parser_application_hole = (\_init_1-> (\_term_2-> (\_idx_3-> (\_code_4-> (let _3001 = (u (u (u fm_parser_text "!") _idx_3) _code_4) in (case _3001 of {(0,f) -> u f (\_3002 _3003 _3004-> (u (u (u parser_reply_error _3002) _3003) _3004)); (1,f) -> u f (\_3005 _3006 _3007-> (let _3008 = (u (u (u fm_parser_stop _init_1) _3005) _3006) in (case _3008 of {(0,f) -> u f (\_3009 _3010 _3011-> (u (u (u parser_reply_error _3009) _3010) _3011)); (1,f) -> u f (\_3012 _3013 _3014-> (u (u (u parser_reply_value _3012) _3013) (u (u fm_term_ori _3014) (u (u fm_term_app _term_2) (u fm_term_hol bits_e))))); }))); }))))))
fm_parser_suffix = (\_init_1-> (\_term_2-> (\_idx_3-> (\_code_4-> (let _suffix_parser_5=(u parser_first_of (u (u list_cons (u (u fm_parser_application _init_1) _term_2)) (u (u list_cons (u (u fm_parser_application_erased _init_1) _term_2)) (u (u list_cons (u (u fm_parser_arrow _init_1) _term_2)) (u (u list_cons (u (u fm_parser_add _init_1) _term_2)) (u (u list_cons (u (u fm_parser_sub _init_1) _term_2)) (u (u list_cons (u (u fm_parser_mul _init_1) _term_2)) (u (u list_cons (u (u fm_parser_div _init_1) _term_2)) (u (u list_cons (u (u fm_parser_mod _init_1) _term_2)) (u (u list_cons (u (u fm_parser_cons _init_1) _term_2)) (u (u list_cons (u (u fm_parser_concat _init_1) _term_2)) (u (u list_cons (u (u fm_parser_string_concat _init_1) _term_2)) (u (u list_cons (u (u fm_parser_sigma _init_1) _term_2)) (u (u list_cons (u (u fm_parser_equality _init_1) _term_2)) (u (u list_cons (u (u fm_parser_inequality _init_1) _term_2)) (u (u list_cons (u (u fm_parser_rewrite _init_1) _term_2)) (u (u list_cons (u (u fm_parser_annotation _init_1) _term_2)) (u (u list_cons (u (u fm_parser_application_hole _init_1) _term_2)) list_nil)))))))))))))))))) in (let _3015 = (u (u _suffix_parser_5 _idx_3) _code_4) in (case _3015 of {(0,f) -> u f (\_3016 _3017 _3018-> (u (u (u parser_reply_value _idx_3) _code_4) _term_2)); (1,f) -> u f (\_3019 _3020 _3021-> (u (u (u (u fm_parser_suffix _init_1) _3021) _3019) _3020)); })))))))
fm_parser_term = (\_idx_1-> (\_code_2-> (let _3022 = (u (u fm_parser_init _idx_1) _code_2) in (case _3022 of {(0,f) -> u f (\_3023 _3024 _3025-> (u (u (u parser_reply_error _3023) _3024) _3025)); (1,f) -> u f (\_3026 _3027 _3028-> (let _3029 = (u (u (u parser_first_of (u (u list_cons fm_parser_type) (u (u list_cons fm_parser_forall) (u (u list_cons fm_parser_lambda) (u (u list_cons fm_parser_lambda_erased) (u (u list_cons fm_parser_lambda_nameless) (u (u list_cons fm_parser_parenthesis) (u (u list_cons fm_parser_letforrange_u32) (u (u list_cons fm_parser_letforin) (u (u list_cons fm_parser_let) (u (u list_cons fm_parser_get) (u (u list_cons fm_parser_def) (u (u list_cons fm_parser_if) (u (u list_cons fm_parser_char) (u (u list_cons fm_parser_string) (u (u list_cons fm_parser_pair) (u (u list_cons fm_parser_sigma_type) (u (u list_cons fm_parser_some) (u (u list_cons fm_parser_apply) (u (u list_cons fm_parser_mirror) (u (u list_cons fm_parser_list) (u (u list_cons fm_parser_log) (u (u list_cons fm_parser_forrange_u32) (u (u list_cons fm_parser_forrange_u32_2) (u (u list_cons fm_parser_forin) (u (u list_cons fm_parser_forin_2) (u (u list_cons fm_parser_do) (u (u list_cons fm_parser_case) (u (u list_cons fm_parser_open) (u (u list_cons fm_parser_goal) (u (u list_cons fm_parser_hole) (u (u list_cons fm_parser_u8) (u (u list_cons fm_parser_u16) (u (u list_cons fm_parser_u32) (u (u list_cons fm_parser_u64) (u (u list_cons fm_parser_nat) (u (u list_cons fm_parser_reference) list_nil))))))))))))))))))))))))))))))))))))) _3026) _3027) in (case _3029 of {(0,f) -> u f (\_3030 _3031 _3032-> (u (u (u parser_reply_error _3030) _3031) _3032)); (1,f) -> u f (\_3033 _3034 _3035-> (u (u (u (u fm_parser_suffix _3028) _3035) _3033) _3034)); }))); }))))
fm_parser_name_term = (\_idx_1-> (\_code_2-> (let _3036 = (u (u fm_parser_name _idx_1) _code_2) in (case _3036 of {(0,f) -> u f (\_3037 _3038 _3039-> (u (u (u parser_reply_error _3037) _3038) _3039)); (1,f) -> u f (\_3040 _3041 _3042-> (let _3043 = (u (u (u fm_parser_text ":") _3040) _3041) in (case _3043 of {(0,f) -> u f (\_3044 _3045 _3046-> (u (u (u parser_reply_error _3044) _3045) _3046)); (1,f) -> u f (\_3047 _3048 _3049-> (let _3050 = (u (u fm_parser_term _3047) _3048) in (case _3050 of {(0,f) -> u f (\_3051 _3052 _3053-> (u (u (u parser_reply_error _3051) _3052) _3053)); (1,f) -> u f (\_3054 _3055 _3056-> (u (u (u parser_reply_value _3054) _3055) (u (u pair_new _3042) _3056))); }))); }))); }))))
fm_binder_new = (\_eras_1-> (\_name_2-> (\_term_3-> (0,\t-> t _eras_1 _name_2 _term_3))))
fm_parser_binder_homo = (\_eras_1-> (\_idx_2-> (\_code_3-> (let _3057 = (u (u (u fm_parser_text (let _3058 = _eras_1 in (if _3058 then "<" else "("))) _idx_2) _code_3) in (case _3057 of {(0,f) -> u f (\_3059 _3060 _3061-> (u (u (u parser_reply_error _3059) _3060) _3061)); (1,f) -> u f (\_3062 _3063 _3064-> (let _3065 = (u (u (u (u parser_until1 (u fm_parser_text (let _3066 = _eras_1 in (if _3066 then ">" else ")")))) (u fm_parser_item fm_parser_name_term)) _3062) _3063) in (case _3065 of {(0,f) -> u f (\_3067 _3068 _3069-> (u (u (u parser_reply_error _3067) _3068) _3069)); (1,f) -> u f (\_3070 _3071 _3072-> (u (u (u parser_reply_value _3070) _3071) (u (u list_mapped _3072) (\_pair_10-> (let _3073 = _pair_10 in (case _3073 of {(0,f) -> u f (\_3074 _3075-> (u (u (u fm_binder_new _eras_1) _3074) _3075)); })))))); }))); })))))
list_concat = (\_as_2-> (\_bs_3-> (let _3076 = _as_2 in (case _3076 of {(0,f) -> u f (_bs_3); (1,f) -> u f (\_3077 _3078-> (u (u list_cons _3077) (u (u list_concat _3078) _bs_3))); }))))
list_flatten = (\_xs_2-> (let _3079 = _xs_2 in (case _3079 of {(0,f) -> u f (list_nil); (1,f) -> u f (\_3080 _3081-> (u (u list_concat _3080) (u list_flatten _3081))); })))
fm_parser_binder = (\_idx_1-> (\_code_2-> (let _3082 = (u (u (u parser_many1 (u parser_first_of (u (u list_cons (u fm_parser_binder_homo bool_true)) (u (u list_cons (u fm_parser_binder_homo bool_false)) list_nil)))) _idx_1) _code_2) in (case _3082 of {(0,f) -> u f (\_3083 _3084 _3085-> (u (u (u parser_reply_error _3083) _3084) _3085)); (1,f) -> u f (\_3086 _3087 _3088-> (u (u (u parser_reply_value _3086) _3087) (u list_flatten _3088))); }))))
list_length = (\_xs_2-> (let _3089 = _xs_2 in (case _3089 of {(0,f) -> u f (0); (1,f) -> u f (\_3090 _3091-> (u nat_succ (u list_length _3091))); })))
fm_parser_make_forall = (\_binds_1-> (\_body_2-> (let _3092 = _binds_1 in (case _3092 of {(0,f) -> u f (_body_2); (1,f) -> u f (\_3093 _3094-> (let _3095 = _3093 in (case _3095 of {(0,f) -> u f (\_3096 _3097 _3098-> (u (u (u (u (u fm_term_all _3096) "") _3097) _3098) (\_s_8-> (\_x_9-> (u (u fm_parser_make_forall _3094) _body_2))))); }))); }))))
list_at = (\_index_2-> (\_list_3-> (let _3099 = _list_3 in (case _3099 of {(0,f) -> u f (maybe_none); (1,f) -> u f (\_3100 _3101-> (let _3102 = _index_2 in (if _3102==0 then (u maybe_some _3100) else (u (u list_at (_3102-1)) _3101)))); }))))
list_at_last = (\_index_2-> (\_list_3-> (u (u list_at _index_2) (u list_reverse _list_3))))
fm_term_var = (\_name_1-> (\_indx_2-> (0,\t-> t _name_1 _indx_2)))
fm_context_get_name_skips = (\_name_1-> (let _3103 = _name_1 in (if null (_3103::String) then (u (u pair_new "") 0) else (let _name_skips_4=(u fm_context_get_name_skips (tail _3103)) in (let _3104 = _name_skips_4 in (case _3104 of {(0,f) -> u f (\_3105 _3106-> (let _3107 = ((((fromIntegral (fromEnum (head _3103 :: Char)) :: Word16)::Word16) == 94)) in (if _3107 then (u (u pair_new _3105) (u nat_succ _3106)) else (u (u pair_new (u (u string_cons (fromIntegral (fromEnum (head _3103 :: Char)) :: Word16)) _3105)) _3106)))); }))))))
fm_name_eql = (\_a_1-> (\_b_2-> (((_a_1::String) == _b_2))))
fm_context_find_go = (\_name_1-> (\_skip_2-> (\_ctx_3-> (let _3108 = _ctx_3 in (case _3108 of {(0,f) -> u f (maybe_none); (1,f) -> u f (\_3109 _3110-> (let _3111 = _3109 in (case _3111 of {(0,f) -> u f (\_3112 _3113-> (let _3114 = (u (u fm_name_eql _name_1) _3112) in (if _3114 then (let _3115 = _skip_2 in (if _3115==0 then (u maybe_some _3113) else (u (u (u fm_context_find_go _name_1) (_3115-1)) _3110))) else (u (u (u fm_context_find_go _name_1) _skip_2) _3110)))); }))); })))))
fm_context_find = (\_name_1-> (\_ctx_2-> (let _3116 = (u fm_context_get_name_skips _name_1) in (case _3116 of {(0,f) -> u f (\_3117 _3118-> (u (u (u fm_context_find_go _3117) _3118) _ctx_2)); }))))
fm_path_o = (\_path_1-> (\_x_2-> (u _path_1 (u bits_o _x_2))))
fm_path_i = (\_path_1-> (\_x_2-> (u _path_1 (u bits_i _x_2))))
fm_path_to_bits = (\_path_1-> (u _path_1 bits_e))
fm_term_bind = (\_vars_1-> (\_path_2-> (\_term_3-> (let _3119 = _term_3 in (case _3119 of {(0,f) -> u f (\_3120 _3121-> (let _3122 = (u (u list_at_last _3121) _vars_1) in (case _3122 of {(0,f) -> u f ((u (u fm_term_var _3120) _3121)); (1,f) -> u f (\_3123-> (u pair_snd _3123)); }))); (1,f) -> u f (\_3124-> (let _3125 = (u (u fm_context_find _3124) _vars_1) in (case _3125 of {(0,f) -> u f ((u fm_term_ref _3124)); (1,f) -> u f (\_3126-> _3126); }))); (2,f) -> u f (fm_term_typ); (3,f) -> u f (\_3127 _3128 _3129 _3130 _3131-> (let _vlen_9=(u list_length _vars_1) in (u (u (u (u (u fm_term_all _3127) _3128) _3129) (u (u (u fm_term_bind _vars_1) (u fm_path_o _path_2)) _3130)) (\_s_10-> (\_x_11-> (u (u (u fm_term_bind (u (u list_cons (u (u pair_new _3129) _x_11)) (u (u list_cons (u (u pair_new _3128) _s_10)) _vars_1))) (u fm_path_i _path_2)) (u (u _3131 (u (u fm_term_var _3128) _vlen_9)) (u (u fm_term_var _3129) (u nat_succ _vlen_9))))))))); (4,f) -> u f (\_3132 _3133-> (let _vlen_6=(u list_length _vars_1) in (u (u fm_term_lam _3132) (\_x_7-> (u (u (u fm_term_bind (u (u list_cons (u (u pair_new _3132) _x_7)) _vars_1)) (u fm_path_o _path_2)) (u _3133 (u (u fm_term_var _3132) _vlen_6))))))); (5,f) -> u f (\_3134 _3135-> (u (u fm_term_app (u (u (u fm_term_bind _vars_1) (u fm_path_o _path_2)) _3134)) (u (u (u fm_term_bind _vars_1) (u fm_path_i _path_2)) _3135))); (6,f) -> u f (\_3136 _3137 _3138-> (let _vlen_7=(u list_length _vars_1) in (u (u (u fm_term_let _3136) (u (u (u fm_term_bind _vars_1) (u fm_path_o _path_2)) _3137)) (\_x_8-> (u (u (u fm_term_bind (u (u list_cons (u (u pair_new _3136) _x_8)) _vars_1)) (u fm_path_i _path_2)) (u _3138 (u (u fm_term_var _3136) _vlen_7))))))); (7,f) -> u f (\_3139 _3140 _3141-> (let _vlen_7=(u list_length _vars_1) in (u (u (u fm_term_def _3139) (u (u (u fm_term_bind _vars_1) (u fm_path_o _path_2)) _3140)) (\_x_8-> (u (u (u fm_term_bind (u (u list_cons (u (u pair_new _3139) _x_8)) _vars_1)) (u fm_path_i _path_2)) (u _3141 (u (u fm_term_var _3139) _vlen_7))))))); (8,f) -> u f (\_3142 _3143 _3144-> (u (u (u fm_term_ann _3142) (u (u (u fm_term_bind _vars_1) (u fm_path_o _path_2)) _3143)) (u (u (u fm_term_bind _vars_1) (u fm_path_i _path_2)) _3144))); (9,f) -> u f (\_3145 _3146 _3147-> (u (u (u fm_term_gol _3145) _3146) _3147)); (10,f) -> u f (\_3148-> (u fm_term_hol (u fm_path_to_bits _path_2))); (11,f) -> u f (\_3149-> (u fm_term_nat _3149)); (12,f) -> u f (\_3150-> (u fm_term_chr _3150)); (13,f) -> u f (\_3151-> (u fm_term_str _3151)); (14,f) -> u f (\_3152 _3153 _3154 _3155 _3156 _3157-> (let _expr_10=(u (u (u fm_term_bind _vars_1) (u fm_path_o _path_2)) _3153) in (let _name_11=_3154 in (let _wyth_12=_3155 in (let _cses_13=_3156 in (let _moti_14=_3157 in (u (u (u (u (u (u fm_term_cse (u fm_path_to_bits _path_2)) _expr_10) _name_11) _wyth_12) _cses_13) _moti_14))))))); (15,f) -> u f (\_3158 _3159-> (u (u fm_term_ori _3158) (u (u (u fm_term_bind _vars_1) _path_2) _3159))); })))))
fm_status_done = (2,\t-> t)
fm_define = (\_file_1-> (\_code_2-> (\_orig_3-> (\_name_4-> (\_term_5-> (\_type_6-> (\_isct_7-> (\_arit_8-> (\_done_9-> (\_defs_10-> (let _stat_11=(let _3160 = _done_9 in (if _3160 then fm_status_done else fm_status_init)) in (u (u (u fm_set _name_4) (u (u (u (u (u (u (u (u (u fm_def_new _file_1) _code_2) _orig_3) _name_4) _term_5) _type_6) _isct_7) _arit_8) _stat_11)) _defs_10))))))))))))
fm_parser_file_def = (\_file_1-> (\_code_2-> (\_defs_3-> (\_idx_4-> (\_code_5-> (let _3161 = (u (u fm_parser_init _idx_4) _code_5) in (case _3161 of {(0,f) -> u f (\_3162 _3163 _3164-> (u (u (u parser_reply_error _3162) _3163) _3164)); (1,f) -> u f (\_3165 _3166 _3167-> (let _3168 = (u (u fm_parser_name1 _3165) _3166) in (case _3168 of {(0,f) -> u f (\_3169 _3170 _3171-> (u (u (u parser_reply_error _3169) _3170) _3171)); (1,f) -> u f (\_3172 _3173 _3174-> (let _3175 = (u (u (u parser_many fm_parser_binder) _3172) _3173) in (case _3175 of {(0,f) -> u f (\_3176 _3177 _3178-> (u (u (u parser_reply_error _3176) _3177) _3178)); (1,f) -> u f (\_3179 _3180 _3181-> (let _args_15=(u list_flatten _3181) in (let _3182 = (u (u (u fm_parser_text ":") _3179) _3180) in (case _3182 of {(0,f) -> u f (\_3183 _3184 _3185-> (u (u (u parser_reply_error _3183) _3184) _3185)); (1,f) -> u f (\_3186 _3187 _3188-> (let _3189 = (u (u fm_parser_term _3186) _3187) in (case _3189 of {(0,f) -> u f (\_3190 _3191 _3192-> (u (u (u parser_reply_error _3190) _3191) _3192)); (1,f) -> u f (\_3193 _3194 _3195-> (let _3196 = (u (u fm_parser_term _3193) _3194) in (case _3196 of {(0,f) -> u f (\_3197 _3198 _3199-> (u (u (u parser_reply_error _3197) _3198) _3199)); (1,f) -> u f (\_3200 _3201 _3202-> (let _3203 = (u (u (u fm_parser_stop _3167) _3200) _3201) in (case _3203 of {(0,f) -> u f (\_3204 _3205 _3206-> (u (u (u parser_reply_error _3204) _3205) _3206)); (1,f) -> u f (\_3207 _3208 _3209-> (let _arit_28=(u list_length _args_15) in (let _type_29=(u (u fm_parser_make_forall _args_15) _3195) in (let _term_30=(u (u fm_parser_make_lambda (u (u list_mapped _args_15) (\_x_30-> (let _3210 = _x_30 in (case _3210 of {(0,f) -> u f (\_3211 _3212 _3213-> _3212); }))))) _3202) in (let _type_31=(u (u (u fm_term_bind list_nil) (\_x_31-> (u bits_i _x_31))) _type_29) in (let _term_32=(u (u (u fm_term_bind list_nil) (\_x_32-> (u bits_o _x_32))) _term_30) in (let _defs_33=(u (u (u (u (u (u (u (u (u (u fm_define _file_1) _code_2) _3209) _3174) _term_32) _type_31) bool_false) _arit_28) bool_false) _defs_3) in (u (u (u parser_reply_value _3207) _3208) _defs_33)))))))); }))); }))); }))); })))); }))); }))); })))))))
maybe_default = (\_a_2-> (\_m_3-> (let _3214 = _m_3 in (case _3214 of {(0,f) -> u f (_a_2); (1,f) -> u f (\_3215-> _3215); }))))
fm_constructor_new = (\_name_1-> (\_args_2-> (\_inds_3-> (0,\t-> t _name_1 _args_2 _inds_3))))
fm_parser_constructor = (\_namespace_1-> (\_idx_2-> (\_code_3-> (let _3216 = (u (u fm_parser_name1 _idx_2) _code_3) in (case _3216 of {(0,f) -> u f (\_3217 _3218 _3219-> (u (u (u parser_reply_error _3217) _3218) _3219)); (1,f) -> u f (\_3220 _3221 _3222-> (let _3223 = (u (u (u parser_maybe fm_parser_binder) _3220) _3221) in (case _3223 of {(0,f) -> u f (\_3224 _3225 _3226-> (u (u (u parser_reply_error _3224) _3225) _3226)); (1,f) -> u f (\_3227 _3228 _3229-> (let _3230 = (u (u (u parser_maybe (\_idx_10-> (\_code_11-> (let _3231 = (u (u (u fm_parser_text "~") _idx_10) _code_11) in (case _3231 of {(0,f) -> u f (\_3232 _3233 _3234-> (u (u (u parser_reply_error _3232) _3233) _3234)); (1,f) -> u f (\_3235 _3236 _3237-> (u (u fm_parser_binder _3235) _3236)); }))))) _3227) _3228) in (case _3230 of {(0,f) -> u f (\_3238 _3239 _3240-> (u (u (u parser_reply_error _3238) _3239) _3240)); (1,f) -> u f (\_3241 _3242 _3243-> (let _args_13=(u (u maybe_default list_nil) _3229) in (let _inds_14=(u (u maybe_default list_nil) _3243) in (u (u (u parser_reply_value _3241) _3242) (u (u (u fm_constructor_new _3222) _args_13) _inds_14))))); }))); }))); })))))
fm_datatype_new = (\_name_1-> (\_pars_2-> (\_inds_3-> (\_ctrs_4-> (0,\t-> t _name_1 _pars_2 _inds_3 _ctrs_4)))))
fm_parser_datatype = (\_idx_1-> (\_code_2-> (let _3244 = (u (u (u fm_parser_text "type ") _idx_1) _code_2) in (case _3244 of {(0,f) -> u f (\_3245 _3246 _3247-> (u (u (u parser_reply_error _3245) _3246) _3247)); (1,f) -> u f (\_3248 _3249 _3250-> (let _3251 = (u (u fm_parser_name1 _3248) _3249) in (case _3251 of {(0,f) -> u f (\_3252 _3253 _3254-> (u (u (u parser_reply_error _3252) _3253) _3254)); (1,f) -> u f (\_3255 _3256 _3257-> (let _3258 = (u (u (u parser_maybe fm_parser_binder) _3255) _3256) in (case _3258 of {(0,f) -> u f (\_3259 _3260 _3261-> (u (u (u parser_reply_error _3259) _3260) _3261)); (1,f) -> u f (\_3262 _3263 _3264-> (let _3265 = (u (u (u parser_maybe (\_idx_12-> (\_code_13-> (let _3266 = (u (u (u fm_parser_text "~") _idx_12) _code_13) in (case _3266 of {(0,f) -> u f (\_3267 _3268 _3269-> (u (u (u parser_reply_error _3267) _3268) _3269)); (1,f) -> u f (\_3270 _3271 _3272-> (u (u fm_parser_binder _3270) _3271)); }))))) _3262) _3263) in (case _3265 of {(0,f) -> u f (\_3273 _3274 _3275-> (u (u (u parser_reply_error _3273) _3274) _3275)); (1,f) -> u f (\_3276 _3277 _3278-> (let _pars_15=(u (u maybe_default list_nil) _3264) in (let _inds_16=(u (u maybe_default list_nil) _3278) in (let _3279 = (u (u (u fm_parser_text "{") _3276) _3277) in (case _3279 of {(0,f) -> u f (\_3280 _3281 _3282-> (u (u (u parser_reply_error _3280) _3281) _3282)); (1,f) -> u f (\_3283 _3284 _3285-> (let _3286 = (u (u (u (u parser_until (u fm_parser_text "}")) (u fm_parser_item (u fm_parser_constructor _3257))) _3283) _3284) in (case _3286 of {(0,f) -> u f (\_3287 _3288 _3289-> (u (u (u parser_reply_error _3287) _3288) _3289)); (1,f) -> u f (\_3290 _3291 _3292-> (u (u (u parser_reply_value _3290) _3291) (u (u (u (u fm_datatype_new _3257) _pars_15) _inds_16) _3292))); }))); }))))); }))); }))); }))); }))))
fm_datatype_build_term_motive_go = (\_type_1-> (\_name_2-> (\_inds_3-> (let _3293 = _inds_3 in (case _3293 of {(0,f) -> u f ((let _3294 = _type_1 in (case _3294 of {(0,f) -> u f (\_3295 _3296 _3297 _3298-> (let _slf_8=(u fm_term_ref _name_2) in (let _slf_9=(u (u (u list_for _3296) _slf_8) (\_var_9-> (\_slf_10-> (u (u fm_term_app _slf_10) (u fm_term_ref (let _3299 = _var_9 in (case _3299 of {(0,f) -> u f (\_3300 _3301 _3302-> _3301); }))))))) in (let _slf_10=(u (u (u list_for _3297) _slf_9) (\_var_10-> (\_slf_11-> (u (u fm_term_app _slf_11) (u fm_term_ref (let _3303 = _var_10 in (case _3303 of {(0,f) -> u f (\_3304 _3305 _3306-> _3305); }))))))) in (u (u (u (u (u fm_term_all bool_false) "") "") _slf_10) (\_s_11-> (\_x_12-> fm_term_typ))))))); }))); (1,f) -> u f (\_3307 _3308-> (let _3309 = _3307 in (case _3309 of {(0,f) -> u f (\_3310 _3311 _3312-> (u (u (u (u (u fm_term_all _3310) "") _3311) _3312) (\_s_9-> (\_x_10-> (u (u (u fm_datatype_build_term_motive_go _type_1) _name_2) _3308))))); }))); })))))
fm_datatype_build_term_motive = (\_type_1-> (let _3313 = _type_1 in (case _3313 of {(0,f) -> u f (\_3314 _3315 _3316 _3317-> (u (u (u fm_datatype_build_term_motive_go _type_1) _3314) _3316)); })))
fm_datatype_build_term_constructor_go = (\_type_1-> (\_ctor_2-> (\_args_3-> (let _3318 = _args_3 in (case _3318 of {(0,f) -> u f ((let _3319 = _type_1 in (case _3319 of {(0,f) -> u f (\_3320 _3321 _3322 _3323-> (let _3324 = _ctor_2 in (case _3324 of {(0,f) -> u f (\_3325 _3326 _3327-> (let _ret_11=(u fm_term_ref (u fm_name_read "P")) in (let _ret_12=(u (u (u list_for _3327) _ret_11) (\_var_12-> (\_ret_13-> (u (u fm_term_app _ret_13) (let _3328 = _var_12 in (case _3328 of {(0,f) -> u f (\_3329 _3330 _3331-> _3331); })))))) in (let _ctr_13=(u string_flatten (u (u list_cons _3320) (u (u list_cons (u fm_name_read ".")) (u (u list_cons _3325) list_nil)))) in (let _slf_14=(u fm_term_ref _ctr_13) in (let _slf_15=(u (u (u list_for _3321) _slf_14) (\_var_15-> (\_slf_16-> (u (u fm_term_app _slf_16) (u fm_term_ref (let _3332 = _var_15 in (case _3332 of {(0,f) -> u f (\_3333 _3334 _3335-> _3334); }))))))) in (let _slf_16=(u (u (u list_for _3326) _slf_15) (\_var_16-> (\_slf_17-> (u (u fm_term_app _slf_17) (u fm_term_ref (let _3336 = _var_16 in (case _3336 of {(0,f) -> u f (\_3337 _3338 _3339-> _3338); }))))))) in (u (u fm_term_app _ret_12) _slf_16)))))))); }))); }))); (1,f) -> u f (\_3340 _3341-> (let _3342 = _3340 in (case _3342 of {(0,f) -> u f (\_3343 _3344 _3345-> (let _eras_9=_3343 in (let _name_10=_3344 in (let _xtyp_11=_3345 in (let _body_12=(u (u (u fm_datatype_build_term_constructor_go _type_1) _ctor_2) _3341) in (u (u (u (u (u fm_term_all _eras_9) "") _name_10) _xtyp_11) (\_s_13-> (\_x_14-> _body_12)))))))); }))); })))))
fm_datatype_build_term_constructor = (\_type_1-> (\_ctor_2-> (let _3346 = _ctor_2 in (case _3346 of {(0,f) -> u f (\_3347 _3348 _3349-> (u (u (u fm_datatype_build_term_constructor_go _type_1) _ctor_2) _3348)); }))))
fm_datatype_build_term_constructors_go = (\_type_1-> (\_name_2-> (\_ctrs_3-> (let _3350 = _ctrs_3 in (case _3350 of {(0,f) -> u f ((let _3351 = _type_1 in (case _3351 of {(0,f) -> u f (\_3352 _3353 _3354 _3355-> (let _ret_8=(u fm_term_ref (u fm_name_read "P")) in (let _ret_9=(u (u (u list_for _3354) _ret_8) (\_var_9-> (\_ret_10-> (u (u fm_term_app _ret_10) (u fm_term_ref (let _3356 = _var_9 in (case _3356 of {(0,f) -> u f (\_3357 _3358 _3359-> _3358); }))))))) in (u (u fm_term_app _ret_9) (u fm_term_ref (((_name_2::String) ++ ".Self"))))))); }))); (1,f) -> u f (\_3360 _3361-> (let _3362 = _3360 in (case _3362 of {(0,f) -> u f (\_3363 _3364 _3365-> (u (u (u (u (u fm_term_all bool_false) "") _3363) (u (u fm_datatype_build_term_constructor _type_1) _3360)) (\_s_9-> (\_x_10-> (u (u (u fm_datatype_build_term_constructors_go _type_1) _name_2) _3361))))); }))); })))))
fm_datatype_build_term_constructors = (\_type_1-> (let _3366 = _type_1 in (case _3366 of {(0,f) -> u f (\_3367 _3368 _3369 _3370-> (u (u (u fm_datatype_build_term_constructors_go _type_1) _3367) _3370)); })))
fm_datatype_build_term_go = (\_type_1-> (\_name_2-> (\_pars_3-> (\_inds_4-> (let _3371 = _pars_3 in (case _3371 of {(0,f) -> u f ((let _3372 = _inds_4 in (case _3372 of {(0,f) -> u f ((u (u (u (u (u fm_term_all bool_true) (((_name_2::String) ++ ".Self"))) (u fm_name_read "P")) (u fm_datatype_build_term_motive _type_1)) (\_s_5-> (\_x_6-> (u fm_datatype_build_term_constructors _type_1))))); (1,f) -> u f (\_3373 _3374-> (let _3375 = _3373 in (case _3375 of {(0,f) -> u f (\_3376 _3377 _3378-> (u (u fm_term_lam _3377) (\_x_10-> (u (u (u (u fm_datatype_build_term_go _type_1) _name_2) _pars_3) _3374)))); }))); }))); (1,f) -> u f (\_3379 _3380-> (let _3381 = _3379 in (case _3381 of {(0,f) -> u f (\_3382 _3383 _3384-> (u (u fm_term_lam _3383) (\_x_10-> (u (u (u (u fm_datatype_build_term_go _type_1) _name_2) _3380) _inds_4)))); }))); }))))))
fm_datatype_build_term = (\_type_1-> (let _3385 = _type_1 in (case _3385 of {(0,f) -> u f (\_3386 _3387 _3388 _3389-> (u (u (u (u fm_datatype_build_term_go _type_1) _3386) _3387) _3388)); })))
fm_datatype_build_type_go = (\_type_1-> (\_name_2-> (\_pars_3-> (\_inds_4-> (let _3390 = _pars_3 in (case _3390 of {(0,f) -> u f ((let _3391 = _inds_4 in (case _3391 of {(0,f) -> u f (fm_term_typ); (1,f) -> u f (\_3392 _3393-> (let _3394 = _3392 in (case _3394 of {(0,f) -> u f (\_3395 _3396 _3397-> (u (u (u (u (u fm_term_all bool_false) "") _3396) _3397) (\_s_10-> (\_x_11-> (u (u (u (u fm_datatype_build_type_go _type_1) _name_2) _pars_3) _3393))))); }))); }))); (1,f) -> u f (\_3398 _3399-> (let _3400 = _3398 in (case _3400 of {(0,f) -> u f (\_3401 _3402 _3403-> (u (u (u (u (u fm_term_all bool_false) "") _3402) _3403) (\_s_10-> (\_x_11-> (u (u (u (u fm_datatype_build_type_go _type_1) _name_2) _3399) _inds_4))))); }))); }))))))
fm_datatype_build_type = (\_type_1-> (let _3404 = _type_1 in (case _3404 of {(0,f) -> u f (\_3405 _3406 _3407 _3408-> (u (u (u (u fm_datatype_build_type_go _type_1) _3405) _3406) _3407)); })))
fm_constructor_build_term_opt_go = (\_type_1-> (\_ctor_2-> (\_ctrs_3-> (let _3409 = _ctrs_3 in (case _3409 of {(0,f) -> u f ((let _3410 = _ctor_2 in (case _3410 of {(0,f) -> u f (\_3411 _3412 _3413-> (let _ret_7=(u fm_term_ref _3411) in (let _ret_8=(u (u (u list_for _3412) _ret_7) (\_arg_8-> (\_ret_9-> (u (u fm_term_app _ret_9) (u fm_term_ref (let _3414 = _arg_8 in (case _3414 of {(0,f) -> u f (\_3415 _3416 _3417-> _3416); }))))))) in _ret_8))); }))); (1,f) -> u f (\_3418 _3419-> (let _3420 = _3418 in (case _3420 of {(0,f) -> u f (\_3421 _3422 _3423-> (u (u fm_term_lam _3421) (\_x_9-> (u (u (u fm_constructor_build_term_opt_go _type_1) _ctor_2) _3419)))); }))); })))))
fm_constructor_build_term_opt = (\_type_1-> (\_ctor_2-> (let _3424 = _type_1 in (case _3424 of {(0,f) -> u f (\_3425 _3426 _3427 _3428-> (u (u (u fm_constructor_build_term_opt_go _type_1) _ctor_2) _3428)); }))))
fm_constructor_build_term_go = (\_type_1-> (\_ctor_2-> (\_name_3-> (\_pars_4-> (\_args_5-> (let _3429 = _pars_4 in (case _3429 of {(0,f) -> u f ((let _3430 = _args_5 in (case _3430 of {(0,f) -> u f ((u (u fm_term_lam (u fm_name_read "P")) (\_x_6-> (u (u fm_constructor_build_term_opt _type_1) _ctor_2)))); (1,f) -> u f (\_3431 _3432-> (let _3433 = _3431 in (case _3433 of {(0,f) -> u f (\_3434 _3435 _3436-> (u (u fm_term_lam _3435) (\_x_11-> (u (u (u (u (u fm_constructor_build_term_go _type_1) _ctor_2) _name_3) _pars_4) _3432)))); }))); }))); (1,f) -> u f (\_3437 _3438-> (let _3439 = _3437 in (case _3439 of {(0,f) -> u f (\_3440 _3441 _3442-> (u (u fm_term_lam _3441) (\_x_11-> (u (u (u (u (u fm_constructor_build_term_go _type_1) _ctor_2) _name_3) _3438) _args_5)))); }))); })))))))
fm_constructor_build_term = (\_type_1-> (\_ctor_2-> (let _3443 = _type_1 in (case _3443 of {(0,f) -> u f (\_3444 _3445 _3446 _3447-> (let _3448 = _ctor_2 in (case _3448 of {(0,f) -> u f (\_3449 _3450 _3451-> (u (u (u (u (u fm_constructor_build_term_go _type_1) _ctor_2) _3444) _3445) _3450)); }))); }))))
fm_constructor_build_type_go = (\_type_1-> (\_ctor_2-> (\_name_3-> (\_pars_4-> (\_args_5-> (let _3452 = _pars_4 in (case _3452 of {(0,f) -> u f ((let _3453 = _args_5 in (case _3453 of {(0,f) -> u f ((let _3454 = _type_1 in (case _3454 of {(0,f) -> u f (\_3455 _3456 _3457 _3458-> (let _3459 = _ctor_2 in (case _3459 of {(0,f) -> u f (\_3460 _3461 _3462-> (let _type_13=(u fm_term_ref _name_3) in (let _type_14=(u (u (u list_for _3456) _type_13) (\_var_14-> (\_type_15-> (u (u fm_term_app _type_15) (u fm_term_ref (let _3463 = _var_14 in (case _3463 of {(0,f) -> u f (\_3464 _3465 _3466-> _3465); }))))))) in (let _type_15=(u (u (u list_for _3462) _type_14) (\_var_15-> (\_type_16-> (u (u fm_term_app _type_16) (let _3467 = _var_15 in (case _3467 of {(0,f) -> u f (\_3468 _3469 _3470-> _3470); })))))) in _type_15)))); }))); }))); (1,f) -> u f (\_3471 _3472-> (let _3473 = _3471 in (case _3473 of {(0,f) -> u f (\_3474 _3475 _3476-> (u (u (u (u (u fm_term_all _3474) "") _3475) _3476) (\_s_11-> (\_x_12-> (u (u (u (u (u fm_constructor_build_type_go _type_1) _ctor_2) _name_3) _pars_4) _3472))))); }))); }))); (1,f) -> u f (\_3477 _3478-> (let _3479 = _3477 in (case _3479 of {(0,f) -> u f (\_3480 _3481 _3482-> (u (u (u (u (u fm_term_all _3480) "") _3481) _3482) (\_s_11-> (\_x_12-> (u (u (u (u (u fm_constructor_build_type_go _type_1) _ctor_2) _name_3) _3478) _args_5))))); }))); })))))))
fm_constructor_build_type = (\_type_1-> (\_ctor_2-> (let _3483 = _type_1 in (case _3483 of {(0,f) -> u f (\_3484 _3485 _3486 _3487-> (let _3488 = _ctor_2 in (case _3488 of {(0,f) -> u f (\_3489 _3490 _3491-> (u (u (u (u (u fm_constructor_build_type_go _type_1) _ctor_2) _3484) _3485) _3490)); }))); }))))
fm_parser_file_adt = (\_file_1-> (\_code_2-> (\_defs_3-> (\_idx_4-> (\_code_5-> (let _3492 = (u (u fm_parser_init _idx_4) _code_5) in (case _3492 of {(0,f) -> u f (\_3493 _3494 _3495-> (u (u (u parser_reply_error _3493) _3494) _3495)); (1,f) -> u f (\_3496 _3497 _3498-> (let _3499 = (u (u fm_parser_datatype _3496) _3497) in (case _3499 of {(0,f) -> u f (\_3500 _3501 _3502-> (u (u (u parser_reply_error _3500) _3501) _3502)); (1,f) -> u f (\_3503 _3504 _3505-> (let _3506 = (u (u (u fm_parser_stop _3498) _3503) _3504) in (case _3506 of {(0,f) -> u f (\_3507 _3508 _3509-> (u (u (u parser_reply_error _3507) _3508) _3509)); (1,f) -> u f (\_3510 _3511 _3512-> (let _3513 = _3505 in (case _3513 of {(0,f) -> u f (\_3514 _3515 _3516 _3517-> (let _term_19=(u fm_datatype_build_term _3505) in (let _term_20=(u (u (u fm_term_bind list_nil) (\_x_20-> (u bits_i _x_20))) _term_19) in (let _type_21=(u fm_datatype_build_type _3505) in (let _type_22=(u (u (u fm_term_bind list_nil) (\_x_22-> (u bits_o _x_22))) _type_21) in (let _arit_23=((((u list_length _3515)::Integer) + (u list_length _3516))) in (let _defs_24=(u (u (u (u (u (u (u (u (u (u fm_define _file_1) _code_2) _3512) _3514) _term_20) _type_22) bool_false) _arit_23) bool_false) _defs_3) in (let _defs_25=(u (u (u list_fold _3517) _defs_24) (\_ctr_25-> (\_defs_26-> (let _typ_name_27=_3514 in (let _ctr_arit_28=(((_arit_23::Integer) + (u list_length (let _3518 = _ctr_25 in (case _3518 of {(0,f) -> u f (\_3519 _3520 _3521-> _3520); }))))) in (let _ctr_name_29=(u string_flatten (u (u list_cons _typ_name_27) (u (u list_cons (u fm_name_read ".")) (u (u list_cons (let _3522 = _ctr_25 in (case _3522 of {(0,f) -> u f (\_3523 _3524 _3525-> _3523); }))) list_nil)))) in (let _ctr_term_30=(u (u fm_constructor_build_term _3505) _ctr_25) in (let _ctr_term_31=(u (u (u fm_term_bind list_nil) (\_x_31-> (u bits_i _x_31))) _ctr_term_30) in (let _ctr_type_32=(u (u fm_constructor_build_type _3505) _ctr_25) in (let _ctr_type_33=(u (u (u fm_term_bind list_nil) (\_x_33-> (u bits_o _x_33))) _ctr_type_32) in (u (u (u (u (u (u (u (u (u (u fm_define _file_1) _code_2) _3512) _ctr_name_29) _ctr_term_31) _ctr_type_33) bool_true) _ctr_arit_28) bool_false) _defs_26))))))))))) in (\_idx_26-> (\_code_27-> (u (u (u parser_reply_value _idx_26) _code_27) _defs_25))))))))))); })) _3510 _3511); }))); }))); })))))))
parser_eof = (\_idx_1-> (\_code_2-> (let _3526 = _code_2 in (if null (_3526::String) then (u (u (u parser_reply_value _idx_1) _code_2) unit_new) else (u (u (u parser_reply_error _idx_1) _code_2) "Expected end-of-file.")))))
fm_parser_file_end = (\_file_1-> (\_code_2-> (\_defs_3-> (\_idx_4-> (\_code_5-> (let _3527 = (u (u fm_parser_spaces _idx_4) _code_5) in (case _3527 of {(0,f) -> u f (\_3528 _3529 _3530-> (u (u (u parser_reply_error _3528) _3529) _3530)); (1,f) -> u f (\_3531 _3532 _3533-> (let _3534 = (u (u parser_eof _3531) _3532) in (case _3534 of {(0,f) -> u f (\_3535 _3536 _3537-> (u (u (u parser_reply_error _3535) _3536) _3537)); (1,f) -> u f (\_3538 _3539 _3540-> (u (u (u parser_reply_value _3538) _3539) _defs_3)); }))); })))))))
fm_parser_file = (\_file_1-> (\_code_2-> (\_defs_3-> (\_idx_4-> (\_code_5-> (let _3541 = (u (u parser_is_eof _idx_4) _code_5) in (case _3541 of {(0,f) -> u f (\_3542 _3543 _3544-> (u (u (u parser_reply_error _3542) _3543) _3544)); (1,f) -> u f (\_3545 _3546 _3547-> (let _3548 = _3547 in (if _3548 then (\_idx_9-> (\_code_10-> (u (u (u parser_reply_value _idx_9) _code_10) _defs_3))) else (\_idx_9-> (\_code_10-> (let _3549 = (u (u (u parser_first_of (u (u list_cons (u (u (u fm_parser_file_def _file_1) _code_2) _defs_3)) (u (u list_cons (u (u (u fm_parser_file_adt _file_1) _code_2) _defs_3)) (u (u list_cons (u (u (u fm_parser_file_end _file_1) _code_2) _defs_3)) list_nil)))) _idx_9) _code_10) in (case _3549 of {(0,f) -> u f (\_3550 _3551 _3552-> (u (u (u parser_reply_error _3550) _3551) _3552)); (1,f) -> u f (\_3553 _3554 _3555-> (u (u (u (u (u fm_parser_file _file_1) _code_2) _3555) _3553) _3554)); })))))) _3545 _3546); })))))))
either = (\_a_1-> (\_b_2-> ()))
string_join_go = (\_sep_1-> (\_list_2-> (\_fst_3-> (let _3556 = _list_2 in (case _3556 of {(0,f) -> u f (""); (1,f) -> u f (\_3557 _3558-> (u string_flatten (u (u list_cons (let _3559 = _fst_3 in (if _3559 then "" else _sep_1))) (u (u list_cons _3557) (u (u list_cons (u (u (u string_join_go _sep_1) _3558) bool_false)) list_nil))))); })))))
string_join = (\_sep_1-> (\_list_2-> (u (u (u string_join_go _sep_1) _list_2) bool_true)))
fm_highlight_end = (\_col_1-> (\_row_2-> (\_res_3-> (u (u string_join "\n") _res_3))))
maybe_extract = (\_m_2-> (\_a_4-> (\_f_5-> (let _3560 = _m_2 in (case _3560 of {(0,f) -> u f (_a_4); (1,f) -> u f (\_3561-> (u _f_5 _3561)); })))))
nat_is_zero = (\_n_1-> (let _3562 = _n_1 in (if _3562==0 then bool_true else bool_false)))
nat_double = (\_n_1-> (let _3563 = _n_1 in (if _3563==0 then nat_zero else (u nat_succ (u nat_succ (u nat_double (_3563-1)))))))
nat_pred = (\_n_1-> (let _3564 = _n_1 in (if _3564==0 then nat_zero else (_3564-1))))
string_reverse_go = (\_xs_1-> (\_res_2-> (let _3565 = _xs_1 in (if null (_3565::String) then _res_2 else (u (u string_reverse_go (tail _3565)) (u (u string_cons (fromIntegral (fromEnum (head _3565 :: Char)) :: Word16)) _res_2))))))
string_reverse = (\_xs_1-> (u (u string_reverse_go _xs_1) string_nil))
string_pad_right = (\_size_1-> (\_chr_2-> (\_str_3-> (let _3566 = _size_1 in (if _3566==0 then _str_3 else (let _3567 = _str_3 in (if null (_3567::String) then (u (u string_cons _chr_2) (u (u (u string_pad_right (_3566-1)) _chr_2) "")) else (u (u string_cons (fromIntegral (fromEnum (head _3567 :: Char)) :: Word16)) (u (u (u string_pad_right (_3566-1)) _chr_2) (tail _3567))))))))))
string_pad_left = (\_size_1-> (\_chr_2-> (\_str_3-> (u string_reverse (u (u (u string_pad_right _size_1) _chr_2) (u string_reverse _str_3))))))
either_left = (\_value_3-> (0,\t-> t _value_3))
either_right = (\_value_3-> (1,\t-> t _value_3))
nat_sub_rem = (\_n_1-> (\_m_2-> (let _3568 = _m_2 in (if _3568==0 then (u either_left _n_1) else (let _3569 = _n_1 in (if _3569==0 then (u either_right (u nat_succ (_3568-1))) else (u (u nat_sub_rem (_3569-1)) (_3568-1))))))))
nat_div_mod_go = (\_n_1-> (\_m_2-> (\_d_3-> (let _3570 = (u (u nat_sub_rem _n_1) _m_2) in (case _3570 of {(0,f) -> u f (\_3571-> (u (u (u nat_div_mod_go _3571) _m_2) (u nat_succ _d_3))); (1,f) -> u f (\_3572-> (u (u pair_new _d_3) _n_1)); })))))
nat_div_mod = (\_n_1-> (\_m_2-> (u (u (u nat_div_mod_go _n_1) _m_2) nat_zero)))
nat_to_base_go = (\_base_1-> (\_nat_2-> (\_res_3-> (let _3573 = (u (u nat_div_mod _nat_2) _base_1) in (case _3573 of {(0,f) -> u f (\_3574 _3575-> (let _3576 = _3574 in (if _3576==0 then (u (u list_cons _3575) _res_3) else (u (u (u nat_to_base_go _base_1) _3574) (u (u list_cons _3575) _res_3))))); })))))
nat_to_base = (\_base_1-> (\_nat_2-> (u (u (u nat_to_base_go _base_1) _nat_2) list_nil)))
nat_mod_go = (\_n_1-> (\_m_2-> (\_r_3-> (let _3577 = _m_2 in (if _3577==0 then (u (u (u nat_mod_go _n_1) _r_3) _m_2) else (let _3578 = _n_1 in (if _3578==0 then _r_3 else (u (u (u nat_mod_go (_3578-1)) (_3577-1)) (u nat_succ _r_3)))))))))
nat_mod = (\_n_1-> (\_m_2-> (u (u (u nat_mod_go _n_1) _m_2) 0)))
nat_lte = (\a0-> \a1-> ((a0::Integer) <= a1))
nat_show_digit = (\_base_1-> (\_n_2-> (let _m_3=(u (u nat_mod _n_2) _base_1) in (let _base64_4=(u (u list_cons 48) (u (u list_cons 49) (u (u list_cons 50) (u (u list_cons 51) (u (u list_cons 52) (u (u list_cons 53) (u (u list_cons 54) (u (u list_cons 55) (u (u list_cons 56) (u (u list_cons 57) (u (u list_cons 65) (u (u list_cons 66) (u (u list_cons 67) (u (u list_cons 68) (u (u list_cons 69) (u (u list_cons 70) (u (u list_cons 71) (u (u list_cons 72) (u (u list_cons 73) (u (u list_cons 74) (u (u list_cons 75) (u (u list_cons 76) (u (u list_cons 77) (u (u list_cons 78) (u (u list_cons 79) (u (u list_cons 80) (u (u list_cons 81) (u (u list_cons 82) (u (u list_cons 83) (u (u list_cons 84) (u (u list_cons 85) (u (u list_cons 86) (u (u list_cons 87) (u (u list_cons 88) (u (u list_cons 89) (u (u list_cons 90) (u (u list_cons 97) (u (u list_cons 98) (u (u list_cons 99) (u (u list_cons 100) (u (u list_cons 101) (u (u list_cons 102) (u (u list_cons 103) (u (u list_cons 104) (u (u list_cons 105) (u (u list_cons 106) (u (u list_cons 107) (u (u list_cons 108) (u (u list_cons 109) (u (u list_cons 110) (u (u list_cons 111) (u (u list_cons 112) (u (u list_cons 113) (u (u list_cons 114) (u (u list_cons 115) (u (u list_cons 116) (u (u list_cons 117) (u (u list_cons 118) (u (u list_cons 119) (u (u list_cons 120) (u (u list_cons 121) (u (u list_cons 122) (u (u list_cons 43) (u (u list_cons 47) list_nil)))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))) in (let _3579 = (((((_base_1::Integer) > 0)) && (((_base_1::Integer) <= 64)))) in (if _3579 then (let _3580 = (u (u list_at _m_3) _base64_4) in (case _3580 of {(0,f) -> u f (35); (1,f) -> u f (\_3581-> _3581); })) else 35))))))
nat_to_string_base = (\_base_1-> (\_nat_2-> (u (u (u list_fold (u (u nat_to_base _base_1) _nat_2)) string_nil) (\_n_3-> (\_str_4-> (u (u string_cons (u (u nat_show_digit _base_1) _n_3)) _str_4))))))
nat_show = (\_n_1-> (u (u nat_to_string_base 10) _n_1))
bool_not = (\a0-> (not a0))
fm_color = (\_col_1-> (\_str_2-> (u (u string_cons 27) (u (u string_cons 91) (((_col_1::String) ++ (u (u string_cons 109) (((_str_2::String) ++ (u (u string_cons 27) (u (u string_cons 91) (u (u string_cons 48) (u (u string_cons 109) string_nil)))))))))))))
nat_eql = (\a0-> \a1-> ((a0::Integer) == a1))
list_take = (\_n_2-> (\_xs_3-> (let _3582 = _xs_3 in (case _3582 of {(0,f) -> u f (list_nil); (1,f) -> u f (\_3583 _3584-> (let _3585 = _n_2 in (if _3585==0 then list_nil else (u (u list_cons _3583) (u (u list_take (_3585-1)) _3584))))); }))))
fm_highlight_tc = (\_code_1-> (\_ix0_2-> (\_ix1_3-> (\_col_4-> (\_row_5-> (\_lft_6-> (\_lin_7-> (\_res_8-> (let _spa_9=3 in (let _3586 = _code_1 in (if null (_3586::String) then (u (u (u fm_highlight_end _col_4) _row_5) (u list_reverse _res_8)) else (let _3587 = ((((fromIntegral (fromEnum (head _3586 :: Char)) :: Word16)::Word16) == 10)) in (if _3587 then (let _stp_12=(u (u (u maybe_extract _lft_6) bool_false) nat_is_zero) in (let _3588 = _stp_12 in (if _3588 then (u (u (u fm_highlight_end _col_4) _row_5) (u list_reverse _res_8)) else (let _siz_13=(u nat_succ (u nat_double _spa_9)) in (let _lft_14=(let _3589 = _ix1_3 in (if _3589==0 then (let _3590 = _lft_6 in (case _3590 of {(0,f) -> u f ((u maybe_some _spa_9)); (1,f) -> u f (\_3591-> (u maybe_some (u nat_pred _3591))); })) else _lft_6)) in (let _ix0_15=(u nat_pred _ix0_2) in (let _ix1_16=(u nat_pred _ix1_3) in (let _col_17=0 in (let _row_18=(u nat_succ _row_5) in (let _res_19=(u (u list_cons (u string_reverse _lin_7)) _res_8) in (let _lin_20=(u string_reverse (u string_flatten (u (u list_cons (u (u (u string_pad_left 4) 32) (u nat_show _row_18))) (u (u list_cons " | ") list_nil)))) in (u (u (u (u (u (u (u (u fm_highlight_tc (tail _3586)) _ix0_15) _ix1_16) _col_17) _row_18) _lft_14) _lin_20) _res_19)))))))))))) else (let _chr_12=(u (u string_cons (fromIntegral (fromEnum (head _3586 :: Char)) :: Word16)) string_nil) in (let _chr_13=(let _3592 = (((u nat_is_zero _ix0_2) && ((not (u nat_is_zero _ix1_3))))) in (if _3592 then (u string_reverse (u (u fm_color "31") (u (u fm_color "4") _chr_12))) else _chr_12)) in (let _res_14=(let _3593 = (((_ix0_2::Integer) == 1)) in (if _3593 then (u (u list_take _spa_9) _res_8) else _res_8)) in (let _ix0_15=(u nat_pred _ix0_2) in (let _ix1_16=(u nat_pred _ix1_3) in (let _col_17=(u nat_succ _col_4) in (let _lin_18=(u string_flatten (u (u list_cons _chr_13) (u (u list_cons _lin_7) list_nil))) in (u (u (u (u (u (u (u (u fm_highlight_tc (tail _3586)) _ix0_15) _ix1_16) _col_17) _row_5) _lft_6) _lin_18) _res_14)))))))))))))))))))))
fm_highlight = (\_code_1-> (\_idx0_2-> (\_idx1_3-> (u (u (u (u (u (u (u (u fm_highlight_tc _code_1) _idx0_2) _idx1_3) 0) 1) maybe_none) (u string_reverse "   1 | ")) list_nil))))
fm_defs_read = (\_file_1-> (\_code_2-> (\_defs_3-> (let _3594 = (u (u (u (u (u fm_parser_file _file_1) _code_2) _defs_3) 0) _code_2) in (case _3594 of {(0,f) -> u f (\_3595 _3596 _3597-> (let _err_7=_3597 in (let _hig_8=(u (u (u fm_highlight _code_2) _3595) (u nat_succ _3595)) in (let _str_9=(u string_flatten (u (u list_cons _err_7) (u (u list_cons "\n") (u (u list_cons _hig_8) list_nil)))) in (u either_left _str_9))))); (1,f) -> u f (\_3598 _3599 _3600-> (u either_right _3600)); })))))
fm_synth_load_go = (\_name_1-> (\_files_2-> (\_defs_3-> (let _3601 = _files_2 in (case _3601 of {(0,f) -> u f ((u (u io_monad (\_m_bind_4-> (\_m_pure_5-> _m_pure_5))) maybe_none)); (1,f) -> u f (\_3602 _3603-> (u (u (u io_monad (\_m_bind_6-> (\_m_pure_7-> _m_bind_6))) (u io_get_file _3602)) (\_code_6-> (let _read_7=(u (u (u fm_defs_read _3602) _code_6) _defs_3) in (let _3604 = _read_7 in (case _3604 of {(0,f) -> u f (\_3605-> (u (u (u fm_synth_load_go _name_1) _3603) _defs_3)); (1,f) -> u f (\_3606-> (let _defs_9=_3606 in (let _3607 = (u (u fm_get _name_1) _defs_9) in (case _3607 of {(0,f) -> u f ((u (u (u fm_synth_load_go _name_1) _3603) _defs_9)); (1,f) -> u f (\_3608-> (u (u io_monad (\_m_bind_11-> (\_m_pure_12-> _m_pure_12))) (u maybe_some _defs_9))); })))); })))))); })))))
fm_synth_files_of_make = (\_names_1-> (\_last_2-> (let _3609 = _names_1 in (case _3609 of {(0,f) -> u f (list_nil); (1,f) -> u f (\_3610 _3611-> (let _head_5=(((_last_2::String) ++ (((_3610::String) ++ ".fm")))) in (let _tail_6=(u (u fm_synth_files_of_make _3611) (((_last_2::String) ++ (((_3610::String) ++ "/"))))) in (u (u list_cons _head_5) _tail_6)))); }))))
char_eql = (\_a_1-> (\_b_2-> (((_a_1::Word16) == _b_2))))
string_starts_with = (\_xs_1-> (\_match_2-> (let _3612 = _match_2 in (if null (_3612::String) then bool_true else (let _3613 = _xs_1 in (if null (_3613::String) then bool_false else (let _3614 = (u (u char_eql (fromIntegral (fromEnum (head _3612 :: Char)) :: Word16)) (fromIntegral (fromEnum (head _3613 :: Char)) :: Word16)) in (if _3614 then (u (u string_starts_with (tail _3613)) (tail _3612)) else bool_false))))))))
string_drop = (\_n_1-> (\_xs_2-> (let _3615 = _n_1 in (if _3615==0 then _xs_2 else (let _3616 = _xs_2 in (if null (_3616::String) then string_nil else (u (u string_drop (_3615-1)) (tail _3616))))))))
string_length_go = (\_xs_1-> (\_n_2-> (let _3617 = _xs_1 in (if null (_3617::String) then _n_2 else (u (u string_length_go (tail _3617)) (u nat_succ _n_2))))))
string_length = (\_xs_1-> (u (u string_length_go _xs_1) 0))
string_split_go = (\_xs_1-> (\_match_2-> (\_last_3-> (let _3618 = _xs_1 in (if null (_3618::String) then (u (u list_cons _last_3) list_nil) else (let _3619 = (u (u string_starts_with _xs_1) _match_2) in (if _3619 then (let _rest_6=(u (u string_drop (u string_length _match_2)) _xs_1) in (u (u list_cons _last_3) (u (u (u string_split_go _rest_6) _match_2) ""))) else (let _next_6=(u (u string_cons (fromIntegral (fromEnum (head _3618 :: Char)) :: Word16)) string_nil) in (u (u (u string_split_go (tail _3618)) _match_2) (((_last_3::String) ++ _next_6)))))))))))
string_split = (\_xs_1-> (\_match_2-> (u (u (u string_split_go _xs_1) _match_2) "")))
fm_synth_files_of = (\_name_1-> (u list_reverse (u (u fm_synth_files_of_make (u (u string_split _name_1) ".")) "")))
fm_synth_load = (\_name_1-> (\_defs_2-> (u (u (u fm_synth_load_go _name_1) (u fm_synth_files_of _name_1)) _defs_2)))
fm_status_wait = (1,\t-> t)
fm_check = (\_v_1-> ())
fm_check_result = (\_value_2-> (\_errors_3-> (0,\t-> t _value_2 _errors_3)))
fm_error_undefined_reference = (\_origin_1-> (\_name_2-> (5,\t-> t _origin_1 _name_2)))
fm_error_waiting = (\_name_1-> (2,\t-> t _name_1))
fm_error_indirect = (\_name_1-> (3,\t-> t _name_1))
maybe_mapped = (\_m_2-> (\_f_4-> (let _3620 = _m_2 in (case _3620 of {(0,f) -> u f (maybe_none); (1,f) -> u f (\_3621-> (u maybe_some (u _f_4 _3621))); }))))
fm_mpath_o = (\_path_1-> (u (u maybe_mapped _path_1) fm_path_o))
fm_mpath_i = (\_path_1-> (u (u maybe_mapped _path_1) fm_path_i))
fm_error_patch = (\_path_1-> (\_term_2-> (4,\t-> t _path_1 _term_2)))
fm_mpath_to_bits = (\_path_1-> (let _3622 = _path_1 in (case _3622 of {(0,f) -> u f (bits_e); (1,f) -> u f (\_3623-> (u _3623 bits_e)); })))
fm_error_type_mismatch = (\_origin_1-> (\_expected_2-> (\_detected_3-> (\_context_4-> (0,\t-> t _origin_1 _expected_2 _detected_3 _context_4)))))
fm_error_show_goal = (\_name_1-> (\_dref_2-> (\_verb_3-> (\_goal_4-> (\_context_5-> (1,\t-> t _name_1 _dref_2 _verb_3 _goal_4 _context_5))))))
fm_term_normalize = (\_term_1-> (\_defs_2-> (let _3624 = (u (u fm_term_reduce _term_1) _defs_2) in (case _3624 of {(0,f) -> u f (\_3625 _3626-> (u (u fm_term_var _3625) _3626)); (1,f) -> u f (\_3627-> (u fm_term_ref _3627)); (2,f) -> u f (fm_term_typ); (3,f) -> u f (\_3628 _3629 _3630 _3631 _3632-> (u (u (u (u (u fm_term_all _3628) _3629) _3630) (u (u fm_term_normalize _3631) _defs_2)) (\_s_8-> (\_x_9-> (u (u fm_term_normalize (u (u _3632 _s_8) _x_9)) _defs_2))))); (4,f) -> u f (\_3633 _3634-> (u (u fm_term_lam _3633) (\_x_5-> (u (u fm_term_normalize (u _3634 _x_5)) _defs_2)))); (5,f) -> u f (\_3635 _3636-> (u (u fm_term_app (u (u fm_term_normalize _3635) _defs_2)) (u (u fm_term_normalize _3636) _defs_2))); (6,f) -> u f (\_3637 _3638 _3639-> (u (u (u fm_term_let _3637) (u (u fm_term_normalize _3638) _defs_2)) (\_x_6-> (u (u fm_term_normalize (u _3639 _x_6)) _defs_2)))); (7,f) -> u f (\_3640 _3641 _3642-> (u (u (u fm_term_def _3640) (u (u fm_term_normalize _3641) _defs_2)) (\_x_6-> (u (u fm_term_normalize (u _3642 _x_6)) _defs_2)))); (8,f) -> u f (\_3643 _3644 _3645-> (u (u (u fm_term_ann _3643) (u (u fm_term_normalize _3644) _defs_2)) (u (u fm_term_normalize _3645) _defs_2))); (9,f) -> u f (\_3646 _3647 _3648-> (u (u (u fm_term_gol _3646) _3647) _3648)); (10,f) -> u f (\_3649-> (u fm_term_hol _3649)); (11,f) -> u f (\_3650-> (u fm_term_nat _3650)); (12,f) -> u f (\_3651-> (u fm_term_chr _3651)); (13,f) -> u f (\_3652-> (u fm_term_str _3652)); (14,f) -> u f (\_3653 _3654 _3655 _3656 _3657 _3658-> _term_1); (15,f) -> u f (\_3659 _3660-> (u (u fm_term_normalize _3660) _defs_2)); }))))
list_tail = (\_xs_2-> (let _3661 = _xs_2 in (case _3661 of {(0,f) -> u f (list_nil); (1,f) -> u f (\_3662 _3663-> _3663); })))
fm_smartmotive_vals_cont = (\_expr_1-> (\_term_2-> (\_args_3-> (\_defs_4-> (let _3664 = (u (u fm_term_reduce _term_2) _defs_4) in (case _3664 of {(0,f) -> u f (\_3665 _3666-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (1,f) -> u f (\_3667-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (2,f) -> u f ((u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (3,f) -> u f (\_3668 _3669 _3670 _3671 _3672-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (4,f) -> u f (\_3673 _3674-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (5,f) -> u f (\_3675 _3676-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _3675) (u (u list_cons _3676) _args_3)) _defs_4)); (6,f) -> u f (\_3677 _3678 _3679-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (7,f) -> u f (\_3680 _3681 _3682-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (8,f) -> u f (\_3683 _3684 _3685-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (9,f) -> u f (\_3686 _3687 _3688-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (10,f) -> u f (\_3689-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (11,f) -> u f (\_3690-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (12,f) -> u f (\_3691-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (13,f) -> u f (\_3692-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (14,f) -> u f (\_3693 _3694 _3695 _3696 _3697 _3698-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (15,f) -> u f (\_3699 _3700-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); }))))))
fm_smartmotive_vals = (\_expr_1-> (\_type_2-> (\_defs_3-> (let _3701 = (u (u fm_term_reduce _type_2) _defs_3) in (case _3701 of {(0,f) -> u f (\_3702 _3703-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (1,f) -> u f (\_3704-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (2,f) -> u f ((u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (3,f) -> u f (\_3705 _3706 _3707 _3708 _3709-> (u (u (u fm_smartmotive_vals _expr_1) (u (u _3709 fm_term_typ) fm_term_typ)) _defs_3)); (4,f) -> u f (\_3710 _3711-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (5,f) -> u f (\_3712 _3713-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (6,f) -> u f (\_3714 _3715 _3716-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (7,f) -> u f (\_3717 _3718 _3719-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (8,f) -> u f (\_3720 _3721 _3722-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (9,f) -> u f (\_3723 _3724 _3725-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (10,f) -> u f (\_3726-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (11,f) -> u f (\_3727-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (12,f) -> u f (\_3728-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (13,f) -> u f (\_3729-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (14,f) -> u f (\_3730 _3731 _3732 _3733 _3734 _3735-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (15,f) -> u f (\_3736 _3737-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); })))))
fm_smartmotive_nams_cont = (\_name_1-> (\_term_2-> (\_binds_3-> (\_defs_4-> (let _3738 = (u (u fm_term_reduce _term_2) _defs_4) in (case _3738 of {(0,f) -> u f (\_3739 _3740-> (u (u list_cons _name_1) (u list_tail _binds_3))); (1,f) -> u f (\_3741-> (u (u list_cons _name_1) (u list_tail _binds_3))); (2,f) -> u f ((u (u list_cons _name_1) (u list_tail _binds_3))); (3,f) -> u f (\_3742 _3743 _3744 _3745 _3746-> (u (u (u (u fm_smartmotive_nams_cont _name_1) (u (u _3746 (u fm_term_ref _3743)) (u fm_term_ref _3744))) (u (u list_cons (u string_flatten (u (u list_cons _name_1) (u (u list_cons ".") (u (u list_cons _3744) list_nil))))) _binds_3)) _defs_4)); (4,f) -> u f (\_3747 _3748-> (u (u list_cons _name_1) (u list_tail _binds_3))); (5,f) -> u f (\_3749 _3750-> (u (u list_cons _name_1) (u list_tail _binds_3))); (6,f) -> u f (\_3751 _3752 _3753-> (u (u list_cons _name_1) (u list_tail _binds_3))); (7,f) -> u f (\_3754 _3755 _3756-> (u (u list_cons _name_1) (u list_tail _binds_3))); (8,f) -> u f (\_3757 _3758 _3759-> (u (u list_cons _name_1) (u list_tail _binds_3))); (9,f) -> u f (\_3760 _3761 _3762-> (u (u list_cons _name_1) (u list_tail _binds_3))); (10,f) -> u f (\_3763-> (u (u list_cons _name_1) (u list_tail _binds_3))); (11,f) -> u f (\_3764-> (u (u list_cons _name_1) (u list_tail _binds_3))); (12,f) -> u f (\_3765-> (u (u list_cons _name_1) (u list_tail _binds_3))); (13,f) -> u f (\_3766-> (u (u list_cons _name_1) (u list_tail _binds_3))); (14,f) -> u f (\_3767 _3768 _3769 _3770 _3771 _3772-> (u (u list_cons _name_1) (u list_tail _binds_3))); (15,f) -> u f (\_3773 _3774-> (u (u list_cons _name_1) (u list_tail _binds_3))); }))))))
fm_smartmotive_nams = (\_name_1-> (\_type_2-> (\_defs_3-> (let _3775 = (u (u fm_term_reduce _type_2) _defs_3) in (case _3775 of {(0,f) -> u f (\_3776 _3777-> list_nil); (1,f) -> u f (\_3778-> list_nil); (2,f) -> u f (list_nil); (3,f) -> u f (\_3779 _3780 _3781 _3782 _3783-> (u (u (u (u fm_smartmotive_nams_cont _name_1) _3782) list_nil) _defs_3)); (4,f) -> u f (\_3784 _3785-> list_nil); (5,f) -> u f (\_3786 _3787-> list_nil); (6,f) -> u f (\_3788 _3789 _3790-> list_nil); (7,f) -> u f (\_3791 _3792 _3793-> list_nil); (8,f) -> u f (\_3794 _3795 _3796-> list_nil); (9,f) -> u f (\_3797 _3798 _3799-> list_nil); (10,f) -> u f (\_3800-> list_nil); (11,f) -> u f (\_3801-> list_nil); (12,f) -> u f (\_3802-> list_nil); (13,f) -> u f (\_3803-> list_nil); (14,f) -> u f (\_3804 _3805 _3806 _3807 _3808 _3809-> list_nil); (15,f) -> u f (\_3810 _3811-> list_nil); })))))
list_zip = (\_as_3-> (\_bs_4-> (let _3812 = _as_3 in (case _3812 of {(0,f) -> u f (list_nil); (1,f) -> u f (\_3813 _3814-> (let _3815 = _bs_4 in (case _3815 of {(0,f) -> u f (list_nil); (1,f) -> u f (\_3816 _3817-> (u (u list_cons (u (u pair_new _3813) _3816)) (u (u list_zip _3814) _3817))); }))); }))))
nat_gte = (\a0-> \a1-> ((a0::Integer) >= a1))
nat_sub = (\a0-> \a1-> ((a0::Integer) - a1))
fm_term_serialize_name = (\_name_1-> (u fm_name_to_bits _name_1))
fm_term_serialize = (\_term_1-> (\_depth_2-> (\_init_3-> (\_diff_4-> (\_x_5-> (let _3818 = _term_1 in (case _3818 of {(0,f) -> u f (\_3819 _3820-> (let _3821 = (((_3820::Integer) >= _init_3)) in (if _3821 then (let _name_8=(u bits_concat (u nat_to_bits (u nat_pred (((_depth_2::Integer) - _3820))))) in (u bits_o (u bits_o (u bits_i (u _name_8 _x_5))))) else (let _name_8=(u bits_concat (u nat_to_bits _3820)) in (u bits_o (u bits_i (u bits_o (u _name_8 _x_5)))))))); (1,f) -> u f (\_3822-> (let _name_7=(u bits_concat (u fm_term_serialize_name _3822)) in (u bits_o (u bits_o (u bits_o (u _name_7 _x_5)))))); (2,f) -> u f ((u bits_o (u bits_i (u bits_i _x_5)))); (3,f) -> u f (\_3823 _3824 _3825 _3826 _3827-> (let _eras_11=(let _3828 = _3823 in (if _3828 then bits_i else bits_o)) in (let _self_12=(u bits_concat (u fm_name_to_bits _3824)) in (let _xtyp_13=(u (u (u (u fm_term_serialize _3826) _depth_2) _init_3) _diff_4) in (let _body_14=(u (u (u (u fm_term_serialize (u (u _3827 (u (u fm_term_var _3824) _depth_2)) (u (u fm_term_var _3825) (u nat_succ _depth_2)))) (u nat_succ (u nat_succ _depth_2))) _init_3) _diff_4) in (u bits_i (u bits_o (u bits_o (u _eras_11 (u _self_12 (u _xtyp_13 (u _body_14 _x_5)))))))))))); (4,f) -> u f (\_3829 _3830-> (let _body_8=(u (u (u (u fm_term_serialize (u _3830 (u (u fm_term_var _3829) _depth_2))) (u nat_succ _depth_2)) _init_3) _diff_4) in (u bits_i (u bits_o (u bits_i (u _body_8 _x_5)))))); (5,f) -> u f (\_3831 _3832-> (let _func_8=(u (u (u (u fm_term_serialize _3831) _depth_2) _init_3) _diff_4) in (let _argm_9=(u (u (u (u fm_term_serialize _3832) _depth_2) _init_3) _diff_4) in (u bits_i (u bits_i (u bits_o (u _func_8 (u _argm_9 _x_5)))))))); (6,f) -> u f (\_3833 _3834 _3835-> (let _expr_9=(u (u (u (u fm_term_serialize _3834) _depth_2) _init_3) _diff_4) in (let _body_10=(u (u (u (u fm_term_serialize (u _3835 (u (u fm_term_var _3833) _depth_2))) (u nat_succ _depth_2)) _init_3) _diff_4) in (u bits_i (u bits_i (u bits_i (u _expr_9 (u _body_10 _x_5)))))))); (7,f) -> u f (\_3836 _3837 _3838-> (u (u (u (u (u fm_term_serialize (u _3838 _3837)) _depth_2) _init_3) _diff_4) _x_5)); (8,f) -> u f (\_3839 _3840 _3841-> (u (u (u (u (u fm_term_serialize _3840) _depth_2) _init_3) _diff_4) _x_5)); (9,f) -> u f (\_3842 _3843 _3844-> (let _name_9=(u bits_concat (u fm_name_to_bits _3842)) in (u bits_o (u bits_o (u bits_o (u _name_9 _x_5)))))); (10,f) -> u f (\_3845-> _x_5); (11,f) -> u f (\_3846-> (u (u (u (u (u fm_term_serialize (u fm_term_unroll_nat _3846)) _depth_2) _init_3) _diff_4) _x_5)); (12,f) -> u f (\_3847-> (u (u (u (u (u fm_term_serialize (u fm_term_unroll_chr _3847)) _depth_2) _init_3) _diff_4) _x_5)); (13,f) -> u f (\_3848-> (u (u (u (u (u fm_term_serialize (u fm_term_unroll_str _3848)) _depth_2) _init_3) _diff_4) _x_5)); (14,f) -> u f (\_3849 _3850 _3851 _3852 _3853 _3854-> (u _diff_4 _x_5)); (15,f) -> u f (\_3855 _3856-> (u (u (u (u (u fm_term_serialize _3856) _depth_2) _init_3) _diff_4) _x_5)); })))))))
bits_eql = (\_a_1-> (\_b_2-> (let _3857 = _a_1 in (case _3857 of {(0,f) -> u f ((let _3858 = _b_2 in (case _3858 of {(0,f) -> u f (bool_true); (1,f) -> u f (\_3859-> bool_false); (2,f) -> u f (\_3860-> bool_false); }))); (1,f) -> u f (\_3861-> (let _3862 = _b_2 in (case _3862 of {(0,f) -> u f (bool_false); (1,f) -> u f (\_3863-> (u (u bits_eql _3861) _3863)); (2,f) -> u f (\_3864-> bool_false); }))); (2,f) -> u f (\_3865-> (let _3866 = _b_2 in (case _3866 of {(0,f) -> u f (bool_false); (1,f) -> u f (\_3867-> bool_false); (2,f) -> u f (\_3868-> (u (u bits_eql _3865) _3868)); }))); }))))
fm_term_identical = (\_a_1-> (\_b_2-> (\_lv_3-> (let _ah_4=(u (u (u (u (u fm_term_serialize _a_1) _lv_3) _lv_3) bits_o) bits_e) in (let _bh_5=(u (u (u (u (u fm_term_serialize _b_2) _lv_3) _lv_3) bits_i) bits_e) in (u (u bits_eql _ah_4) _bh_5))))))
fm_smartmotive_replace = (\_term_1-> (\_from_2-> (\_to_3-> (\_lv_4-> (let _3869 = (u (u (u fm_term_identical _term_1) _from_2) _lv_4) in (if _3869 then _to_3 else (let _3870 = _term_1 in (case _3870 of {(0,f) -> u f (\_3871 _3872-> (u (u fm_term_var _3871) _3872)); (1,f) -> u f (\_3873-> (u fm_term_ref _3873)); (2,f) -> u f (fm_term_typ); (3,f) -> u f (\_3874 _3875 _3876 _3877 _3878-> (let _xtyp_10=(u (u (u (u fm_smartmotive_replace _3877) _from_2) _to_3) _lv_4) in (let _body_11=(u (u _3878 (u fm_term_ref _3875)) (u fm_term_ref _3876)) in (let _body_12=(u (u (u (u fm_smartmotive_replace _body_11) _from_2) _to_3) (u nat_succ (u nat_succ _lv_4))) in (u (u (u (u (u fm_term_all _3874) _3875) _3876) _xtyp_10) (\_s_13-> (\_x_14-> _body_12))))))); (4,f) -> u f (\_3879 _3880-> (let _body_7=(u _3880 (u fm_term_ref _3879)) in (let _body_8=(u (u (u (u fm_smartmotive_replace _body_7) _from_2) _to_3) (u nat_succ _lv_4)) in (u (u fm_term_lam _3879) (\_x_9-> _body_8))))); (5,f) -> u f (\_3881 _3882-> (let _func_7=(u (u (u (u fm_smartmotive_replace _3881) _from_2) _to_3) _lv_4) in (let _argm_8=(u (u (u (u fm_smartmotive_replace _3882) _from_2) _to_3) _lv_4) in (u (u fm_term_app _func_7) _argm_8)))); (6,f) -> u f (\_3883 _3884 _3885-> (let _expr_8=(u (u (u (u fm_smartmotive_replace _3884) _from_2) _to_3) _lv_4) in (let _body_9=(u _3885 (u fm_term_ref _3883)) in (let _body_10=(u (u (u (u fm_smartmotive_replace _body_9) _from_2) _to_3) (u nat_succ _lv_4)) in (u (u (u fm_term_let _3883) _expr_8) (\_x_11-> _body_10)))))); (7,f) -> u f (\_3886 _3887 _3888-> (let _expr_8=(u (u (u (u fm_smartmotive_replace _3887) _from_2) _to_3) _lv_4) in (let _body_9=(u _3888 (u fm_term_ref _3886)) in (let _body_10=(u (u (u (u fm_smartmotive_replace _body_9) _from_2) _to_3) (u nat_succ _lv_4)) in (u (u (u fm_term_def _3886) _expr_8) (\_x_11-> _body_10)))))); (8,f) -> u f (\_3889 _3890 _3891-> (let _term_8=(u (u (u (u fm_smartmotive_replace _3890) _from_2) _to_3) _lv_4) in (let _type_9=(u (u (u (u fm_smartmotive_replace _3891) _from_2) _to_3) _lv_4) in (u (u (u fm_term_ann _3889) _term_8) _type_9)))); (9,f) -> u f (\_3892 _3893 _3894-> _term_1); (10,f) -> u f (\_3895-> _term_1); (11,f) -> u f (\_3896-> _term_1); (12,f) -> u f (\_3897-> _term_1); (13,f) -> u f (\_3898-> _term_1); (14,f) -> u f (\_3899 _3900 _3901 _3902 _3903 _3904-> _term_1); (15,f) -> u f (\_3905 _3906-> (u (u (u (u fm_smartmotive_replace _3906) _from_2) _to_3) _lv_4)); }))))))))
fm_smartmotive_make = (\_name_1-> (\_expr_2-> (\_type_3-> (\_moti_4-> (\_lv_5-> (\_defs_6-> (let _vals_7=(u (u (u fm_smartmotive_vals _expr_2) _type_3) _defs_6) in (let _nams_8=(u (u (u fm_smartmotive_nams _name_1) _type_3) _defs_6) in (let _subs_9=(u (u list_zip _nams_8) _vals_7) in (let _moti_10=(u (u (u list_fold _subs_9) _moti_4) (\_sub_10-> (\_moti_11-> (let _3907 = _sub_10 in (case _3907 of {(0,f) -> u f (\_3908 _3909-> (u (u (u (u fm_smartmotive_replace _moti_11) _3909) (u fm_term_ref _3908)) _lv_5)); }))))) in _moti_10))))))))))
fm_term_desugar_cse_motive = (\_wyth_1-> (\_moti_2-> (let _3910 = _wyth_1 in (case _3910 of {(0,f) -> u f (_moti_2); (1,f) -> u f (\_3911 _3912-> (let _3913 = _3911 in (case _3913 of {(0,f) -> u f (\_3914 _3915 _3916 _3917 _3918 _3919 _3920 _3921 _3922-> (u (u (u (u (u fm_term_all bool_false) "") _3917) _3919) (\_s_14-> (\_x_15-> (u (u fm_term_desugar_cse_motive _3912) _moti_2))))); }))); }))))
string_is_empty = (\_str_1-> (let _3923 = _str_1 in (if null (_3923::String) then bool_true else bool_false)))
fm_term_desugar_cse_argument = (\_name_1-> (\_wyth_2-> (\_type_3-> (\_body_4-> (\_defs_5-> (let _3924 = (u (u fm_term_reduce _type_3) _defs_5) in (case _3924 of {(0,f) -> u f (\_3925 _3926-> (let _3927 = _wyth_2 in (case _3927 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_3928 _3929-> (let _3930 = _3928 in (case _3930 of {(0,f) -> u f (\_3931 _3932 _3933 _3934 _3935 _3936 _3937 _3938 _3939-> (u (u fm_term_lam _3934) (\_x_19-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _3929) _type_3) _body_4) _defs_5)))); }))); }))); (1,f) -> u f (\_3940-> (let _3941 = _wyth_2 in (case _3941 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_3942 _3943-> (let _3944 = _3942 in (case _3944 of {(0,f) -> u f (\_3945 _3946 _3947 _3948 _3949 _3950 _3951 _3952 _3953-> (u (u fm_term_lam _3948) (\_x_18-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _3943) _type_3) _body_4) _defs_5)))); }))); }))); (2,f) -> u f ((let _3954 = _wyth_2 in (case _3954 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_3955 _3956-> (let _3957 = _3955 in (case _3957 of {(0,f) -> u f (\_3958 _3959 _3960 _3961 _3962 _3963 _3964 _3965 _3966-> (u (u fm_term_lam _3961) (\_x_17-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _3956) _type_3) _body_4) _defs_5)))); }))); }))); (3,f) -> u f (\_3967 _3968 _3969 _3970 _3971-> (u (u fm_term_lam (let _3972 = (u string_is_empty _3969) in (if _3972 then _name_1 else (u string_flatten (u (u list_cons _name_1) (u (u list_cons ".") (u (u list_cons _3969) list_nil))))))) (\_x_11-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _wyth_2) (u (u _3971 (u (u fm_term_var _3968) 0)) (u (u fm_term_var _3969) 0))) _body_4) _defs_5)))); (4,f) -> u f (\_3973 _3974-> (let _3975 = _wyth_2 in (case _3975 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_3976 _3977-> (let _3978 = _3976 in (case _3978 of {(0,f) -> u f (\_3979 _3980 _3981 _3982 _3983 _3984 _3985 _3986 _3987-> (u (u fm_term_lam _3982) (\_x_19-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _3977) _type_3) _body_4) _defs_5)))); }))); }))); (5,f) -> u f (\_3988 _3989-> (let _3990 = _wyth_2 in (case _3990 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_3991 _3992-> (let _3993 = _3991 in (case _3993 of {(0,f) -> u f (\_3994 _3995 _3996 _3997 _3998 _3999 _4000 _4001 _4002-> (u (u fm_term_lam _3997) (\_x_19-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _3992) _type_3) _body_4) _defs_5)))); }))); }))); (6,f) -> u f (\_4003 _4004 _4005-> (let _4006 = _wyth_2 in (case _4006 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_4007 _4008-> (let _4009 = _4007 in (case _4009 of {(0,f) -> u f (\_4010 _4011 _4012 _4013 _4014 _4015 _4016 _4017 _4018-> (u (u fm_term_lam _4013) (\_x_20-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _4008) _type_3) _body_4) _defs_5)))); }))); }))); (7,f) -> u f (\_4019 _4020 _4021-> (let _4022 = _wyth_2 in (case _4022 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_4023 _4024-> (let _4025 = _4023 in (case _4025 of {(0,f) -> u f (\_4026 _4027 _4028 _4029 _4030 _4031 _4032 _4033 _4034-> (u (u fm_term_lam _4029) (\_x_20-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _4024) _type_3) _body_4) _defs_5)))); }))); }))); (8,f) -> u f (\_4035 _4036 _4037-> (let _4038 = _wyth_2 in (case _4038 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_4039 _4040-> (let _4041 = _4039 in (case _4041 of {(0,f) -> u f (\_4042 _4043 _4044 _4045 _4046 _4047 _4048 _4049 _4050-> (u (u fm_term_lam _4045) (\_x_20-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _4040) _type_3) _body_4) _defs_5)))); }))); }))); (9,f) -> u f (\_4051 _4052 _4053-> (let _4054 = _wyth_2 in (case _4054 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_4055 _4056-> (let _4057 = _4055 in (case _4057 of {(0,f) -> u f (\_4058 _4059 _4060 _4061 _4062 _4063 _4064 _4065 _4066-> (u (u fm_term_lam _4061) (\_x_20-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _4056) _type_3) _body_4) _defs_5)))); }))); }))); (10,f) -> u f (\_4067-> (let _4068 = _wyth_2 in (case _4068 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_4069 _4070-> (let _4071 = _4069 in (case _4071 of {(0,f) -> u f (\_4072 _4073 _4074 _4075 _4076 _4077 _4078 _4079 _4080-> (u (u fm_term_lam _4075) (\_x_18-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _4070) _type_3) _body_4) _defs_5)))); }))); }))); (11,f) -> u f (\_4081-> (let _4082 = _wyth_2 in (case _4082 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_4083 _4084-> (let _4085 = _4083 in (case _4085 of {(0,f) -> u f (\_4086 _4087 _4088 _4089 _4090 _4091 _4092 _4093 _4094-> (u (u fm_term_lam _4089) (\_x_18-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _4084) _type_3) _body_4) _defs_5)))); }))); }))); (12,f) -> u f (\_4095-> (let _4096 = _wyth_2 in (case _4096 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_4097 _4098-> (let _4099 = _4097 in (case _4099 of {(0,f) -> u f (\_4100 _4101 _4102 _4103 _4104 _4105 _4106 _4107 _4108-> (u (u fm_term_lam _4103) (\_x_18-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _4098) _type_3) _body_4) _defs_5)))); }))); }))); (13,f) -> u f (\_4109-> (let _4110 = _wyth_2 in (case _4110 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_4111 _4112-> (let _4113 = _4111 in (case _4113 of {(0,f) -> u f (\_4114 _4115 _4116 _4117 _4118 _4119 _4120 _4121 _4122-> (u (u fm_term_lam _4117) (\_x_18-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _4112) _type_3) _body_4) _defs_5)))); }))); }))); (14,f) -> u f (\_4123 _4124 _4125 _4126 _4127 _4128-> (let _4129 = _wyth_2 in (case _4129 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_4130 _4131-> (let _4132 = _4130 in (case _4132 of {(0,f) -> u f (\_4133 _4134 _4135 _4136 _4137 _4138 _4139 _4140 _4141-> (u (u fm_term_lam _4136) (\_x_23-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _4131) _type_3) _body_4) _defs_5)))); }))); }))); (15,f) -> u f (\_4142 _4143-> (let _4144 = _wyth_2 in (case _4144 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_4145 _4146-> (let _4147 = _4145 in (case _4147 of {(0,f) -> u f (\_4148 _4149 _4150 _4151 _4152 _4153 _4154 _4155 _4156-> (u (u fm_term_lam _4151) (\_x_19-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _4146) _type_3) _body_4) _defs_5)))); }))); }))); })))))))
maybe_or = (\_a_2-> (\_b_3-> (let _4157 = _a_2 in (case _4157 of {(0,f) -> u f (_b_3); (1,f) -> u f (\_4158-> (u maybe_some _4158)); }))))
fm_term_desugar_cse_cases = (\_expr_1-> (\_name_2-> (\_wyth_3-> (\_cses_4-> (\_type_5-> (\_defs_6-> (\_ctxt_7-> (let _4159 = (u (u fm_term_reduce _type_5) _defs_6) in (case _4159 of {(0,f) -> u f (\_4160 _4161-> (let _expr_10=(u (u (u list_for _wyth_3) _expr_1) (\_defn_10-> (\_expr_11-> (u (u fm_term_app _expr_11) (let _4162 = _defn_10 in (case _4162 of {(0,f) -> u f (\_4163 _4164 _4165 _4166 _4167 _4168 _4169 _4170 _4171-> _4167); })))))) in _expr_10)); (1,f) -> u f (\_4172-> (let _expr_9=(u (u (u list_for _wyth_3) _expr_1) (\_defn_9-> (\_expr_10-> (u (u fm_term_app _expr_10) (let _4173 = _defn_9 in (case _4173 of {(0,f) -> u f (\_4174 _4175 _4176 _4177 _4178 _4179 _4180 _4181 _4182-> _4178); })))))) in _expr_9)); (2,f) -> u f ((let _expr_8=(u (u (u list_for _wyth_3) _expr_1) (\_defn_8-> (\_expr_9-> (u (u fm_term_app _expr_9) (let _4183 = _defn_8 in (case _4183 of {(0,f) -> u f (\_4184 _4185 _4186 _4187 _4188 _4189 _4190 _4191 _4192-> _4188); })))))) in _expr_8)); (3,f) -> u f (\_4193 _4194 _4195 _4196 _4197-> (let _got_13=(u (u maybe_or (u (u fm_get _4195) _cses_4)) (u (u fm_get "_") _cses_4)) in (let _4198 = _got_13 in (case _4198 of {(0,f) -> u f ((let _expr_14=(u (u (u list_for _wyth_3) _expr_1) (\_defn_14-> (\_expr_15-> (let _4199 = _defn_14 in (case _4199 of {(0,f) -> u f (\_4200 _4201 _4202 _4203 _4204 _4205 _4206 _4207 _4208-> (u (u fm_term_app _expr_15) _4204)); }))))) in _expr_14)); (1,f) -> u f (\_4209-> (let _argm_15=(u (u (u (u (u fm_term_desugar_cse_argument _name_2) _wyth_3) _4196) _4209) _defs_6) in (let _expr_16=(u (u fm_term_app _expr_1) _argm_15) in (let _type_17=(u (u _4197 (u (u fm_term_var _4194) 0)) (u (u fm_term_var _4195) 0)) in (u (u (u (u (u (u (u fm_term_desugar_cse_cases _expr_16) _name_2) _wyth_3) _cses_4) _type_17) _defs_6) _ctxt_7))))); })))); (4,f) -> u f (\_4210 _4211-> (let _expr_10=(u (u (u list_for _wyth_3) _expr_1) (\_defn_10-> (\_expr_11-> (u (u fm_term_app _expr_11) (let _4212 = _defn_10 in (case _4212 of {(0,f) -> u f (\_4213 _4214 _4215 _4216 _4217 _4218 _4219 _4220 _4221-> _4217); })))))) in _expr_10)); (5,f) -> u f (\_4222 _4223-> (let _expr_10=(u (u (u list_for _wyth_3) _expr_1) (\_defn_10-> (\_expr_11-> (u (u fm_term_app _expr_11) (let _4224 = _defn_10 in (case _4224 of {(0,f) -> u f (\_4225 _4226 _4227 _4228 _4229 _4230 _4231 _4232 _4233-> _4229); })))))) in _expr_10)); (6,f) -> u f (\_4234 _4235 _4236-> (let _expr_11=(u (u (u list_for _wyth_3) _expr_1) (\_defn_11-> (\_expr_12-> (u (u fm_term_app _expr_12) (let _4237 = _defn_11 in (case _4237 of {(0,f) -> u f (\_4238 _4239 _4240 _4241 _4242 _4243 _4244 _4245 _4246-> _4242); })))))) in _expr_11)); (7,f) -> u f (\_4247 _4248 _4249-> (let _expr_11=(u (u (u list_for _wyth_3) _expr_1) (\_defn_11-> (\_expr_12-> (u (u fm_term_app _expr_12) (let _4250 = _defn_11 in (case _4250 of {(0,f) -> u f (\_4251 _4252 _4253 _4254 _4255 _4256 _4257 _4258 _4259-> _4255); })))))) in _expr_11)); (8,f) -> u f (\_4260 _4261 _4262-> (let _expr_11=(u (u (u list_for _wyth_3) _expr_1) (\_defn_11-> (\_expr_12-> (u (u fm_term_app _expr_12) (let _4263 = _defn_11 in (case _4263 of {(0,f) -> u f (\_4264 _4265 _4266 _4267 _4268 _4269 _4270 _4271 _4272-> _4268); })))))) in _expr_11)); (9,f) -> u f (\_4273 _4274 _4275-> (let _expr_11=(u (u (u list_for _wyth_3) _expr_1) (\_defn_11-> (\_expr_12-> (u (u fm_term_app _expr_12) (let _4276 = _defn_11 in (case _4276 of {(0,f) -> u f (\_4277 _4278 _4279 _4280 _4281 _4282 _4283 _4284 _4285-> _4281); })))))) in _expr_11)); (10,f) -> u f (\_4286-> (let _expr_9=(u (u (u list_for _wyth_3) _expr_1) (\_defn_9-> (\_expr_10-> (u (u fm_term_app _expr_10) (let _4287 = _defn_9 in (case _4287 of {(0,f) -> u f (\_4288 _4289 _4290 _4291 _4292 _4293 _4294 _4295 _4296-> _4292); })))))) in _expr_9)); (11,f) -> u f (\_4297-> (let _expr_9=(u (u (u list_for _wyth_3) _expr_1) (\_defn_9-> (\_expr_10-> (u (u fm_term_app _expr_10) (let _4298 = _defn_9 in (case _4298 of {(0,f) -> u f (\_4299 _4300 _4301 _4302 _4303 _4304 _4305 _4306 _4307-> _4303); })))))) in _expr_9)); (12,f) -> u f (\_4308-> (let _expr_9=(u (u (u list_for _wyth_3) _expr_1) (\_defn_9-> (\_expr_10-> (u (u fm_term_app _expr_10) (let _4309 = _defn_9 in (case _4309 of {(0,f) -> u f (\_4310 _4311 _4312 _4313 _4314 _4315 _4316 _4317 _4318-> _4314); })))))) in _expr_9)); (13,f) -> u f (\_4319-> (let _expr_9=(u (u (u list_for _wyth_3) _expr_1) (\_defn_9-> (\_expr_10-> (u (u fm_term_app _expr_10) (let _4320 = _defn_9 in (case _4320 of {(0,f) -> u f (\_4321 _4322 _4323 _4324 _4325 _4326 _4327 _4328 _4329-> _4325); })))))) in _expr_9)); (14,f) -> u f (\_4330 _4331 _4332 _4333 _4334 _4335-> (let _expr_14=(u (u (u list_for _wyth_3) _expr_1) (\_defn_14-> (\_expr_15-> (u (u fm_term_app _expr_15) (let _4336 = _defn_14 in (case _4336 of {(0,f) -> u f (\_4337 _4338 _4339 _4340 _4341 _4342 _4343 _4344 _4345-> _4341); })))))) in _expr_14)); (15,f) -> u f (\_4346 _4347-> (let _expr_10=(u (u (u list_for _wyth_3) _expr_1) (\_defn_10-> (\_expr_11-> (u (u fm_term_app _expr_11) (let _4348 = _defn_10 in (case _4348 of {(0,f) -> u f (\_4349 _4350 _4351 _4352 _4353 _4354 _4355 _4356 _4357-> _4353); })))))) in _expr_10)); })))))))))
fm_term_desugar_cse = (\_expr_1-> (\_name_2-> (\_wyth_3-> (\_cses_4-> (\_moti_5-> (\_type_6-> (\_defs_7-> (\_ctxt_8-> (let _4358 = (u (u fm_term_reduce _type_6) _defs_7) in (case _4358 of {(0,f) -> u f (\_4359 _4360-> maybe_none); (1,f) -> u f (\_4361-> maybe_none); (2,f) -> u f (maybe_none); (3,f) -> u f (\_4362 _4363 _4364 _4365 _4366-> (let _moti_14=(u (u fm_term_desugar_cse_motive _wyth_3) _moti_5) in (let _argm_15=(u (u (u (u (u fm_term_desugar_cse_argument _name_2) list_nil) _4365) _moti_14) _defs_7) in (let _expr_16=(u (u fm_term_app _expr_1) _argm_15) in (let _type_17=(u (u _4366 (u (u fm_term_var _4363) 0)) (u (u fm_term_var _4364) 0)) in (u maybe_some (u (u (u (u (u (u (u fm_term_desugar_cse_cases _expr_16) _name_2) _wyth_3) _cses_4) _type_17) _defs_7) _ctxt_8))))))); (4,f) -> u f (\_4367 _4368-> maybe_none); (5,f) -> u f (\_4369 _4370-> maybe_none); (6,f) -> u f (\_4371 _4372 _4373-> maybe_none); (7,f) -> u f (\_4374 _4375 _4376-> maybe_none); (8,f) -> u f (\_4377 _4378 _4379-> maybe_none); (9,f) -> u f (\_4380 _4381 _4382-> maybe_none); (10,f) -> u f (\_4383-> maybe_none); (11,f) -> u f (\_4384-> maybe_none); (12,f) -> u f (\_4385-> maybe_none); (13,f) -> u f (\_4386-> maybe_none); (14,f) -> u f (\_4387 _4388 _4389 _4390 _4391 _4392-> maybe_none); (15,f) -> u f (\_4393 _4394-> maybe_none); }))))))))))
fm_error_cant_infer = (\_origin_1-> (\_term_2-> (\_context_3-> (6,\t-> t _origin_1 _term_2 _context_3))))
set_has = (\_bits_1-> (\_set_2-> (let _4395 = (u (u map_get _bits_1) _set_2) in (case _4395 of {(0,f) -> u f (bool_false); (1,f) -> u f (\_4396-> bool_true); }))))
bool_or = (\a0-> \a1-> (a0 || a1))
fm_term_has_holes = (\_term_1-> (let _4397 = _term_1 in (case _4397 of {(0,f) -> u f (\_4398 _4399-> bool_false); (1,f) -> u f (\_4400-> bool_false); (2,f) -> u f (bool_false); (3,f) -> u f (\_4401 _4402 _4403 _4404 _4405-> (((u fm_term_has_holes _4404) || (u fm_term_has_holes (u (u _4405 fm_term_typ) fm_term_typ))))); (4,f) -> u f (\_4406 _4407-> (u fm_term_has_holes (u _4407 fm_term_typ))); (5,f) -> u f (\_4408 _4409-> (((u fm_term_has_holes _4408) || (u fm_term_has_holes _4409)))); (6,f) -> u f (\_4410 _4411 _4412-> (((u fm_term_has_holes _4411) || (u fm_term_has_holes (u _4412 fm_term_typ))))); (7,f) -> u f (\_4413 _4414 _4415-> (((u fm_term_has_holes _4414) || (u fm_term_has_holes (u _4415 fm_term_typ))))); (8,f) -> u f (\_4416 _4417 _4418-> (((u fm_term_has_holes _4417) || (u fm_term_has_holes _4418)))); (9,f) -> u f (\_4419 _4420 _4421-> bool_false); (10,f) -> u f (\_4422-> bool_true); (11,f) -> u f (\_4423-> bool_false); (12,f) -> u f (\_4424-> bool_false); (13,f) -> u f (\_4425-> bool_false); (14,f) -> u f (\_4426 _4427 _4428 _4429 _4430 _4431-> bool_false); (15,f) -> u f (\_4432 _4433-> (u fm_term_has_holes _4433)); })))
fm_term_equal_hole = (\_path_1-> (\_term_2-> (let _4434 = _term_2 in (case _4434 of {(0,f) -> u f (\_4435 _4436-> (let _4437 = (u fm_term_has_holes _term_2) in (if _4437 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); (1,f) -> u f (\_4438-> (let _4439 = (u fm_term_has_holes _term_2) in (if _4439 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); (2,f) -> u f ((let _4440 = (u fm_term_has_holes _term_2) in (if _4440 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); (3,f) -> u f (\_4441 _4442 _4443 _4444 _4445-> (let _4446 = (u fm_term_has_holes _term_2) in (if _4446 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); (4,f) -> u f (\_4447 _4448-> (let _4449 = (u fm_term_has_holes _term_2) in (if _4449 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); (5,f) -> u f (\_4450 _4451-> (let _4452 = (u fm_term_has_holes _term_2) in (if _4452 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); (6,f) -> u f (\_4453 _4454 _4455-> (let _4456 = (u fm_term_has_holes _term_2) in (if _4456 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); (7,f) -> u f (\_4457 _4458 _4459-> (let _4460 = (u fm_term_has_holes _term_2) in (if _4460 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); (8,f) -> u f (\_4461 _4462 _4463-> (let _4464 = (u fm_term_has_holes _term_2) in (if _4464 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); (9,f) -> u f (\_4465 _4466 _4467-> (let _4468 = (u fm_term_has_holes _term_2) in (if _4468 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); (10,f) -> u f (\_4469-> (u (u fm_check_result (u maybe_some bool_true)) list_nil)); (11,f) -> u f (\_4470-> (let _4471 = (u fm_term_has_holes _term_2) in (if _4471 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); (12,f) -> u f (\_4472-> (let _4473 = (u fm_term_has_holes _term_2) in (if _4473 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); (13,f) -> u f (\_4474-> (let _4475 = (u fm_term_has_holes _term_2) in (if _4475 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); (14,f) -> u f (\_4476 _4477 _4478 _4479 _4480 _4481-> (let _4482 = (u fm_term_has_holes _term_2) in (if _4482 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); (15,f) -> u f (\_4483 _4484-> (let _4485 = (u fm_term_has_holes _term_2) in (if _4485 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); }))))
fm_term_equal_extra_holes = (\_a_1-> (\_b_2-> (let _4486 = _a_1 in (case _4486 of {(0,f) -> u f (\_4487 _4488-> (let _4489 = _b_2 in (case _4489 of {(0,f) -> u f (\_4490 _4491-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (1,f) -> u f (\_4492-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some unit_new)) list_nil)); (3,f) -> u f (\_4493 _4494 _4495 _4496 _4497-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (4,f) -> u f (\_4498 _4499-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (5,f) -> u f (\_4500 _4501-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (6,f) -> u f (\_4502 _4503 _4504-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (7,f) -> u f (\_4505 _4506 _4507-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (8,f) -> u f (\_4508 _4509 _4510-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (9,f) -> u f (\_4511 _4512 _4513-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (10,f) -> u f (\_4514-> (let _4515 = (u (u fm_term_equal_hole _4514) _a_1) in (case _4515 of {(0,f) -> u f (\_4516 _4517-> (let _4518 = _4516 in (case _4518 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _4517)); (1,f) -> u f (\_4519-> (let _4520 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _4520 of {(0,f) -> u f (\_4521 _4522-> (u (u fm_check_result _4521) (u (u list_concat _4517) _4522))); }))); }))); }))); (11,f) -> u f (\_4523-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (12,f) -> u f (\_4524-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (13,f) -> u f (\_4525-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (14,f) -> u f (\_4526 _4527 _4528 _4529 _4530 _4531-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (15,f) -> u f (\_4532 _4533-> (u (u fm_term_equal_extra_holes _a_1) _4533)); }))); (1,f) -> u f (\_4534-> (let _4535 = _b_2 in (case _4535 of {(0,f) -> u f (\_4536 _4537-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (1,f) -> u f (\_4538-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some unit_new)) list_nil)); (3,f) -> u f (\_4539 _4540 _4541 _4542 _4543-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (4,f) -> u f (\_4544 _4545-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (5,f) -> u f (\_4546 _4547-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (6,f) -> u f (\_4548 _4549 _4550-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (7,f) -> u f (\_4551 _4552 _4553-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (8,f) -> u f (\_4554 _4555 _4556-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (9,f) -> u f (\_4557 _4558 _4559-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (10,f) -> u f (\_4560-> (let _4561 = (u (u fm_term_equal_hole _4560) _a_1) in (case _4561 of {(0,f) -> u f (\_4562 _4563-> (let _4564 = _4562 in (case _4564 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _4563)); (1,f) -> u f (\_4565-> (let _4566 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _4566 of {(0,f) -> u f (\_4567 _4568-> (u (u fm_check_result _4567) (u (u list_concat _4563) _4568))); }))); }))); }))); (11,f) -> u f (\_4569-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (12,f) -> u f (\_4570-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (13,f) -> u f (\_4571-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (14,f) -> u f (\_4572 _4573 _4574 _4575 _4576 _4577-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (15,f) -> u f (\_4578 _4579-> (u (u fm_term_equal_extra_holes _a_1) _4579)); }))); (2,f) -> u f ((let _4580 = _b_2 in (case _4580 of {(0,f) -> u f (\_4581 _4582-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (1,f) -> u f (\_4583-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some unit_new)) list_nil)); (3,f) -> u f (\_4584 _4585 _4586 _4587 _4588-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (4,f) -> u f (\_4589 _4590-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (5,f) -> u f (\_4591 _4592-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (6,f) -> u f (\_4593 _4594 _4595-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (7,f) -> u f (\_4596 _4597 _4598-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (8,f) -> u f (\_4599 _4600 _4601-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (9,f) -> u f (\_4602 _4603 _4604-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (10,f) -> u f (\_4605-> (let _4606 = (u (u fm_term_equal_hole _4605) _a_1) in (case _4606 of {(0,f) -> u f (\_4607 _4608-> (let _4609 = _4607 in (case _4609 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _4608)); (1,f) -> u f (\_4610-> (let _4611 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _4611 of {(0,f) -> u f (\_4612 _4613-> (u (u fm_check_result _4612) (u (u list_concat _4608) _4613))); }))); }))); }))); (11,f) -> u f (\_4614-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (12,f) -> u f (\_4615-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (13,f) -> u f (\_4616-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (14,f) -> u f (\_4617 _4618 _4619 _4620 _4621 _4622-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (15,f) -> u f (\_4623 _4624-> (u (u fm_term_equal_extra_holes _a_1) _4624)); }))); (3,f) -> u f (\_4625 _4626 _4627 _4628 _4629-> (let _4630 = _b_2 in (case _4630 of {(0,f) -> u f (\_4631 _4632-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (1,f) -> u f (\_4633-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some unit_new)) list_nil)); (3,f) -> u f (\_4634 _4635 _4636 _4637 _4638-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (4,f) -> u f (\_4639 _4640-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (5,f) -> u f (\_4641 _4642-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (6,f) -> u f (\_4643 _4644 _4645-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (7,f) -> u f (\_4646 _4647 _4648-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (8,f) -> u f (\_4649 _4650 _4651-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (9,f) -> u f (\_4652 _4653 _4654-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (10,f) -> u f (\_4655-> (let _4656 = (u (u fm_term_equal_hole _4655) _a_1) in (case _4656 of {(0,f) -> u f (\_4657 _4658-> (let _4659 = _4657 in (case _4659 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _4658)); (1,f) -> u f (\_4660-> (let _4661 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _4661 of {(0,f) -> u f (\_4662 _4663-> (u (u fm_check_result _4662) (u (u list_concat _4658) _4663))); }))); }))); }))); (11,f) -> u f (\_4664-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (12,f) -> u f (\_4665-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (13,f) -> u f (\_4666-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (14,f) -> u f (\_4667 _4668 _4669 _4670 _4671 _4672-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (15,f) -> u f (\_4673 _4674-> (u (u fm_term_equal_extra_holes _a_1) _4674)); }))); (4,f) -> u f (\_4675 _4676-> (let _4677 = _b_2 in (case _4677 of {(0,f) -> u f (\_4678 _4679-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (1,f) -> u f (\_4680-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some unit_new)) list_nil)); (3,f) -> u f (\_4681 _4682 _4683 _4684 _4685-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (4,f) -> u f (\_4686 _4687-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (5,f) -> u f (\_4688 _4689-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (6,f) -> u f (\_4690 _4691 _4692-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (7,f) -> u f (\_4693 _4694 _4695-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (8,f) -> u f (\_4696 _4697 _4698-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (9,f) -> u f (\_4699 _4700 _4701-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (10,f) -> u f (\_4702-> (let _4703 = (u (u fm_term_equal_hole _4702) _a_1) in (case _4703 of {(0,f) -> u f (\_4704 _4705-> (let _4706 = _4704 in (case _4706 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _4705)); (1,f) -> u f (\_4707-> (let _4708 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _4708 of {(0,f) -> u f (\_4709 _4710-> (u (u fm_check_result _4709) (u (u list_concat _4705) _4710))); }))); }))); }))); (11,f) -> u f (\_4711-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (12,f) -> u f (\_4712-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (13,f) -> u f (\_4713-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (14,f) -> u f (\_4714 _4715 _4716 _4717 _4718 _4719-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (15,f) -> u f (\_4720 _4721-> (u (u fm_term_equal_extra_holes _a_1) _4721)); }))); (5,f) -> u f (\_4722 _4723-> (let _4724 = _b_2 in (case _4724 of {(0,f) -> u f (\_4725 _4726-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (1,f) -> u f (\_4727-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some unit_new)) list_nil)); (3,f) -> u f (\_4728 _4729 _4730 _4731 _4732-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (4,f) -> u f (\_4733 _4734-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (5,f) -> u f (\_4735 _4736-> (let _4737 = (u (u fm_term_equal_extra_holes _4722) _4735) in (case _4737 of {(0,f) -> u f (\_4738 _4739-> (let _4740 = _4738 in (case _4740 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _4739)); (1,f) -> u f (\_4741-> (let _4742 = (u (u fm_term_equal_extra_holes _4723) _4736) in (case _4742 of {(0,f) -> u f (\_4743 _4744-> (u (u fm_check_result _4743) (u (u list_concat _4739) _4744))); }))); }))); }))); (6,f) -> u f (\_4745 _4746 _4747-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (7,f) -> u f (\_4748 _4749 _4750-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (8,f) -> u f (\_4751 _4752 _4753-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (9,f) -> u f (\_4754 _4755 _4756-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (10,f) -> u f (\_4757-> (let _4758 = (u (u fm_term_equal_hole _4757) _a_1) in (case _4758 of {(0,f) -> u f (\_4759 _4760-> (let _4761 = _4759 in (case _4761 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _4760)); (1,f) -> u f (\_4762-> (let _4763 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _4763 of {(0,f) -> u f (\_4764 _4765-> (u (u fm_check_result _4764) (u (u list_concat _4760) _4765))); }))); }))); }))); (11,f) -> u f (\_4766-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (12,f) -> u f (\_4767-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (13,f) -> u f (\_4768-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (14,f) -> u f (\_4769 _4770 _4771 _4772 _4773 _4774-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (15,f) -> u f (\_4775 _4776-> (u (u fm_term_equal_extra_holes _a_1) _4776)); }))); (6,f) -> u f (\_4777 _4778 _4779-> (let _4780 = _b_2 in (case _4780 of {(0,f) -> u f (\_4781 _4782-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (1,f) -> u f (\_4783-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some unit_new)) list_nil)); (3,f) -> u f (\_4784 _4785 _4786 _4787 _4788-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (4,f) -> u f (\_4789 _4790-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (5,f) -> u f (\_4791 _4792-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (6,f) -> u f (\_4793 _4794 _4795-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (7,f) -> u f (\_4796 _4797 _4798-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (8,f) -> u f (\_4799 _4800 _4801-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (9,f) -> u f (\_4802 _4803 _4804-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (10,f) -> u f (\_4805-> (let _4806 = (u (u fm_term_equal_hole _4805) _a_1) in (case _4806 of {(0,f) -> u f (\_4807 _4808-> (let _4809 = _4807 in (case _4809 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _4808)); (1,f) -> u f (\_4810-> (let _4811 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _4811 of {(0,f) -> u f (\_4812 _4813-> (u (u fm_check_result _4812) (u (u list_concat _4808) _4813))); }))); }))); }))); (11,f) -> u f (\_4814-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (12,f) -> u f (\_4815-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (13,f) -> u f (\_4816-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (14,f) -> u f (\_4817 _4818 _4819 _4820 _4821 _4822-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (15,f) -> u f (\_4823 _4824-> (u (u fm_term_equal_extra_holes _a_1) _4824)); }))); (7,f) -> u f (\_4825 _4826 _4827-> (let _4828 = _b_2 in (case _4828 of {(0,f) -> u f (\_4829 _4830-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (1,f) -> u f (\_4831-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some unit_new)) list_nil)); (3,f) -> u f (\_4832 _4833 _4834 _4835 _4836-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (4,f) -> u f (\_4837 _4838-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (5,f) -> u f (\_4839 _4840-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (6,f) -> u f (\_4841 _4842 _4843-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (7,f) -> u f (\_4844 _4845 _4846-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (8,f) -> u f (\_4847 _4848 _4849-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (9,f) -> u f (\_4850 _4851 _4852-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (10,f) -> u f (\_4853-> (let _4854 = (u (u fm_term_equal_hole _4853) _a_1) in (case _4854 of {(0,f) -> u f (\_4855 _4856-> (let _4857 = _4855 in (case _4857 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _4856)); (1,f) -> u f (\_4858-> (let _4859 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _4859 of {(0,f) -> u f (\_4860 _4861-> (u (u fm_check_result _4860) (u (u list_concat _4856) _4861))); }))); }))); }))); (11,f) -> u f (\_4862-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (12,f) -> u f (\_4863-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (13,f) -> u f (\_4864-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (14,f) -> u f (\_4865 _4866 _4867 _4868 _4869 _4870-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (15,f) -> u f (\_4871 _4872-> (u (u fm_term_equal_extra_holes _a_1) _4872)); }))); (8,f) -> u f (\_4873 _4874 _4875-> (let _4876 = _b_2 in (case _4876 of {(0,f) -> u f (\_4877 _4878-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (1,f) -> u f (\_4879-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some unit_new)) list_nil)); (3,f) -> u f (\_4880 _4881 _4882 _4883 _4884-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (4,f) -> u f (\_4885 _4886-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (5,f) -> u f (\_4887 _4888-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (6,f) -> u f (\_4889 _4890 _4891-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (7,f) -> u f (\_4892 _4893 _4894-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (8,f) -> u f (\_4895 _4896 _4897-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (9,f) -> u f (\_4898 _4899 _4900-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (10,f) -> u f (\_4901-> (let _4902 = (u (u fm_term_equal_hole _4901) _a_1) in (case _4902 of {(0,f) -> u f (\_4903 _4904-> (let _4905 = _4903 in (case _4905 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _4904)); (1,f) -> u f (\_4906-> (let _4907 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _4907 of {(0,f) -> u f (\_4908 _4909-> (u (u fm_check_result _4908) (u (u list_concat _4904) _4909))); }))); }))); }))); (11,f) -> u f (\_4910-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (12,f) -> u f (\_4911-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (13,f) -> u f (\_4912-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (14,f) -> u f (\_4913 _4914 _4915 _4916 _4917 _4918-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (15,f) -> u f (\_4919 _4920-> (u (u fm_term_equal_extra_holes _a_1) _4920)); }))); (9,f) -> u f (\_4921 _4922 _4923-> (let _4924 = _b_2 in (case _4924 of {(0,f) -> u f (\_4925 _4926-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (1,f) -> u f (\_4927-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some unit_new)) list_nil)); (3,f) -> u f (\_4928 _4929 _4930 _4931 _4932-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (4,f) -> u f (\_4933 _4934-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (5,f) -> u f (\_4935 _4936-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (6,f) -> u f (\_4937 _4938 _4939-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (7,f) -> u f (\_4940 _4941 _4942-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (8,f) -> u f (\_4943 _4944 _4945-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (9,f) -> u f (\_4946 _4947 _4948-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (10,f) -> u f (\_4949-> (let _4950 = (u (u fm_term_equal_hole _4949) _a_1) in (case _4950 of {(0,f) -> u f (\_4951 _4952-> (let _4953 = _4951 in (case _4953 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _4952)); (1,f) -> u f (\_4954-> (let _4955 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _4955 of {(0,f) -> u f (\_4956 _4957-> (u (u fm_check_result _4956) (u (u list_concat _4952) _4957))); }))); }))); }))); (11,f) -> u f (\_4958-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (12,f) -> u f (\_4959-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (13,f) -> u f (\_4960-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (14,f) -> u f (\_4961 _4962 _4963 _4964 _4965 _4966-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (15,f) -> u f (\_4967 _4968-> (u (u fm_term_equal_extra_holes _a_1) _4968)); }))); (10,f) -> u f (\_4969-> (let _4970 = (u (u fm_term_equal_hole _4969) _b_2) in (case _4970 of {(0,f) -> u f (\_4971 _4972-> (let _4973 = _4971 in (case _4973 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _4972)); (1,f) -> u f (\_4974-> (let _4975 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _4975 of {(0,f) -> u f (\_4976 _4977-> (u (u fm_check_result _4976) (u (u list_concat _4972) _4977))); }))); }))); }))); (11,f) -> u f (\_4978-> (let _4979 = _b_2 in (case _4979 of {(0,f) -> u f (\_4980 _4981-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (1,f) -> u f (\_4982-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some unit_new)) list_nil)); (3,f) -> u f (\_4983 _4984 _4985 _4986 _4987-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (4,f) -> u f (\_4988 _4989-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (5,f) -> u f (\_4990 _4991-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (6,f) -> u f (\_4992 _4993 _4994-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (7,f) -> u f (\_4995 _4996 _4997-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (8,f) -> u f (\_4998 _4999 _5000-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (9,f) -> u f (\_5001 _5002 _5003-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (10,f) -> u f (\_5004-> (let _5005 = (u (u fm_term_equal_hole _5004) _a_1) in (case _5005 of {(0,f) -> u f (\_5006 _5007-> (let _5008 = _5006 in (case _5008 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5007)); (1,f) -> u f (\_5009-> (let _5010 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _5010 of {(0,f) -> u f (\_5011 _5012-> (u (u fm_check_result _5011) (u (u list_concat _5007) _5012))); }))); }))); }))); (11,f) -> u f (\_5013-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (12,f) -> u f (\_5014-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (13,f) -> u f (\_5015-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (14,f) -> u f (\_5016 _5017 _5018 _5019 _5020 _5021-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (15,f) -> u f (\_5022 _5023-> (u (u fm_term_equal_extra_holes _a_1) _5023)); }))); (12,f) -> u f (\_5024-> (let _5025 = _b_2 in (case _5025 of {(0,f) -> u f (\_5026 _5027-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (1,f) -> u f (\_5028-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some unit_new)) list_nil)); (3,f) -> u f (\_5029 _5030 _5031 _5032 _5033-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (4,f) -> u f (\_5034 _5035-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (5,f) -> u f (\_5036 _5037-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (6,f) -> u f (\_5038 _5039 _5040-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (7,f) -> u f (\_5041 _5042 _5043-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (8,f) -> u f (\_5044 _5045 _5046-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (9,f) -> u f (\_5047 _5048 _5049-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (10,f) -> u f (\_5050-> (let _5051 = (u (u fm_term_equal_hole _5050) _a_1) in (case _5051 of {(0,f) -> u f (\_5052 _5053-> (let _5054 = _5052 in (case _5054 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5053)); (1,f) -> u f (\_5055-> (let _5056 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _5056 of {(0,f) -> u f (\_5057 _5058-> (u (u fm_check_result _5057) (u (u list_concat _5053) _5058))); }))); }))); }))); (11,f) -> u f (\_5059-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (12,f) -> u f (\_5060-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (13,f) -> u f (\_5061-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (14,f) -> u f (\_5062 _5063 _5064 _5065 _5066 _5067-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (15,f) -> u f (\_5068 _5069-> (u (u fm_term_equal_extra_holes _a_1) _5069)); }))); (13,f) -> u f (\_5070-> (let _5071 = _b_2 in (case _5071 of {(0,f) -> u f (\_5072 _5073-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (1,f) -> u f (\_5074-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some unit_new)) list_nil)); (3,f) -> u f (\_5075 _5076 _5077 _5078 _5079-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (4,f) -> u f (\_5080 _5081-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (5,f) -> u f (\_5082 _5083-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (6,f) -> u f (\_5084 _5085 _5086-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (7,f) -> u f (\_5087 _5088 _5089-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (8,f) -> u f (\_5090 _5091 _5092-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (9,f) -> u f (\_5093 _5094 _5095-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (10,f) -> u f (\_5096-> (let _5097 = (u (u fm_term_equal_hole _5096) _a_1) in (case _5097 of {(0,f) -> u f (\_5098 _5099-> (let _5100 = _5098 in (case _5100 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5099)); (1,f) -> u f (\_5101-> (let _5102 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _5102 of {(0,f) -> u f (\_5103 _5104-> (u (u fm_check_result _5103) (u (u list_concat _5099) _5104))); }))); }))); }))); (11,f) -> u f (\_5105-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (12,f) -> u f (\_5106-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (13,f) -> u f (\_5107-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (14,f) -> u f (\_5108 _5109 _5110 _5111 _5112 _5113-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (15,f) -> u f (\_5114 _5115-> (u (u fm_term_equal_extra_holes _a_1) _5115)); }))); (14,f) -> u f (\_5116 _5117 _5118 _5119 _5120 _5121-> (let _5122 = _b_2 in (case _5122 of {(0,f) -> u f (\_5123 _5124-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (1,f) -> u f (\_5125-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some unit_new)) list_nil)); (3,f) -> u f (\_5126 _5127 _5128 _5129 _5130-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (4,f) -> u f (\_5131 _5132-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (5,f) -> u f (\_5133 _5134-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (6,f) -> u f (\_5135 _5136 _5137-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (7,f) -> u f (\_5138 _5139 _5140-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (8,f) -> u f (\_5141 _5142 _5143-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (9,f) -> u f (\_5144 _5145 _5146-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (10,f) -> u f (\_5147-> (let _5148 = (u (u fm_term_equal_hole _5147) _a_1) in (case _5148 of {(0,f) -> u f (\_5149 _5150-> (let _5151 = _5149 in (case _5151 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5150)); (1,f) -> u f (\_5152-> (let _5153 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _5153 of {(0,f) -> u f (\_5154 _5155-> (u (u fm_check_result _5154) (u (u list_concat _5150) _5155))); }))); }))); }))); (11,f) -> u f (\_5156-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (12,f) -> u f (\_5157-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (13,f) -> u f (\_5158-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (14,f) -> u f (\_5159 _5160 _5161 _5162 _5163 _5164-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (15,f) -> u f (\_5165 _5166-> (u (u fm_term_equal_extra_holes _a_1) _5166)); }))); (15,f) -> u f (\_5167 _5168-> (u (u fm_term_equal_extra_holes _5168) _b_2)); }))))
set_set = (\_bits_1-> (\_set_2-> (u (u (u map_set _bits_1) unit_new) _set_2)))
bool_eql = (\_a_1-> (\_b_2-> (let _5169 = _a_1 in (if _5169 then _b_2 else ((not _b_2))))))
fm_term_equal = (\_a_1-> (\_b_2-> (\_defs_3-> (\_lv_4-> (\_seen_5-> (let _ah_6=(u (u (u (u (u fm_term_serialize (u (u fm_term_reduce _a_1) map_new)) _lv_4) _lv_4) bits_o) bits_e) in (let _bh_7=(u (u (u (u (u fm_term_serialize (u (u fm_term_reduce _b_2) map_new)) _lv_4) _lv_4) bits_i) bits_e) in (let _5170 = (u (u bits_eql _ah_6) _bh_7) in (if _5170 then (u (u fm_check_result (u maybe_some bool_true)) list_nil) else (let _a1_8=(u (u fm_term_reduce _a_1) _defs_3) in (let _b1_9=(u (u fm_term_reduce _b_2) _defs_3) in (let _ah_10=(u (u (u (u (u fm_term_serialize _a1_8) _lv_4) _lv_4) bits_o) bits_e) in (let _bh_11=(u (u (u (u (u fm_term_serialize _b1_9) _lv_4) _lv_4) bits_i) bits_e) in (let _5171 = (u (u bits_eql _ah_10) _bh_11) in (if _5171 then (u (u fm_check_result (u maybe_some bool_true)) list_nil) else (let _id_12=(u (u bits_concat _ah_10) _bh_11) in (let _5172 = (u (u set_has _id_12) _seen_5) in (if _5172 then (let _5173 = (u (u fm_term_equal_extra_holes _a_1) _b_2) in (case _5173 of {(0,f) -> u f (\_5174 _5175-> (let _5176 = _5174 in (case _5176 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5175)); (1,f) -> u f (\_5177-> (let _5178 = (u (u fm_check_result (u maybe_some bool_true)) list_nil) in (case _5178 of {(0,f) -> u f (\_5179 _5180-> (u (u fm_check_result _5179) (u (u list_concat _5175) _5180))); }))); }))); })) else (let _5181 = _a1_8 in (case _5181 of {(0,f) -> u f (\_5182 _5183-> (let _5184 = _b1_9 in (case _5184 of {(0,f) -> u f (\_5185 _5186-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5187-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5188 _5189 _5190 _5191 _5192-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (4,f) -> u f (\_5193 _5194-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (5,f) -> u f (\_5195 _5196-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (6,f) -> u f (\_5197 _5198 _5199-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (7,f) -> u f (\_5200 _5201 _5202-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5203 _5204 _5205-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5206 _5207 _5208-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5209-> (u (u fm_term_equal_hole _5209) _a_1)); (11,f) -> u f (\_5210-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5211-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5212-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5213 _5214 _5215 _5216 _5217 _5218-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5219 _5220-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); (1,f) -> u f (\_5221-> (let _5222 = _b1_9 in (case _5222 of {(0,f) -> u f (\_5223 _5224-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5225-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5226 _5227 _5228 _5229 _5230-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (4,f) -> u f (\_5231 _5232-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (5,f) -> u f (\_5233 _5234-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (6,f) -> u f (\_5235 _5236 _5237-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (7,f) -> u f (\_5238 _5239 _5240-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5241 _5242 _5243-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5244 _5245 _5246-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5247-> (u (u fm_term_equal_hole _5247) _a_1)); (11,f) -> u f (\_5248-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5249-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5250-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5251 _5252 _5253 _5254 _5255 _5256-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5257 _5258-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); (2,f) -> u f ((let _5259 = _b1_9 in (case _5259 of {(0,f) -> u f (\_5260 _5261-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5262-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5263 _5264 _5265 _5266 _5267-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (4,f) -> u f (\_5268 _5269-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (5,f) -> u f (\_5270 _5271-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (6,f) -> u f (\_5272 _5273 _5274-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (7,f) -> u f (\_5275 _5276 _5277-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5278 _5279 _5280-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5281 _5282 _5283-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5284-> (u (u fm_term_equal_hole _5284) _a_1)); (11,f) -> u f (\_5285-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5286-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5287-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5288 _5289 _5290 _5291 _5292 _5293-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5294 _5295-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); (3,f) -> u f (\_5296 _5297 _5298 _5299 _5300-> (let _5301 = _b1_9 in (case _5301 of {(0,f) -> u f (\_5302 _5303-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5304-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5305 _5306 _5307 _5308 _5309-> (let _seen_23=(u (u set_set _id_12) _seen_5) in (let _a1_body_24=(u (u _5300 (u (u fm_term_var _5297) _lv_4)) (u (u fm_term_var _5298) (u nat_succ _lv_4))) in (let _b1_body_25=(u (u _5309 (u (u fm_term_var _5306) _lv_4)) (u (u fm_term_var _5307) (u nat_succ _lv_4))) in (let _eq_self_26=(((_5297::String) == _5306)) in (let _eq_eras_27=(u (u bool_eql _5296) _5305) in (let _5310 = ((_eq_self_26 && _eq_eras_27)) in (if _5310 then (let _5311 = (u (u (u (u (u fm_term_equal _5299) _5308) _defs_3) _lv_4) _seen_23) in (case _5311 of {(0,f) -> u f (\_5312 _5313-> (let _5314 = _5312 in (case _5314 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5313)); (1,f) -> u f (\_5315-> (let _5316 = (let _5317 = (u (u (u (u (u fm_term_equal _a1_body_24) _b1_body_25) _defs_3) (u nat_succ (u nat_succ _lv_4))) _seen_23) in (case _5317 of {(0,f) -> u f (\_5318 _5319-> (let _5320 = _5318 in (case _5320 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5319)); (1,f) -> u f (\_5321-> (let _5322 = (u (u fm_check_result (u maybe_some ((_5315 && _5321)))) list_nil) in (case _5322 of {(0,f) -> u f (\_5323 _5324-> (u (u fm_check_result _5323) (u (u list_concat _5319) _5324))); }))); }))); })) in (case _5316 of {(0,f) -> u f (\_5325 _5326-> (u (u fm_check_result _5325) (u (u list_concat _5313) _5326))); }))); }))); })) else (u (u fm_check_result (u maybe_some bool_false)) list_nil))))))))); (4,f) -> u f (\_5327 _5328-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (5,f) -> u f (\_5329 _5330-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (6,f) -> u f (\_5331 _5332 _5333-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (7,f) -> u f (\_5334 _5335 _5336-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5337 _5338 _5339-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5340 _5341 _5342-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5343-> (u (u fm_term_equal_hole _5343) _a_1)); (11,f) -> u f (\_5344-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5345-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5346-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5347 _5348 _5349 _5350 _5351 _5352-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5353 _5354-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); (4,f) -> u f (\_5355 _5356-> (let _5357 = _b1_9 in (case _5357 of {(0,f) -> u f (\_5358 _5359-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5360-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5361 _5362 _5363 _5364 _5365-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (4,f) -> u f (\_5366 _5367-> (let _seen_17=(u (u set_set _id_12) _seen_5) in (let _a1_body_18=(u _5356 (u (u fm_term_var _5355) _lv_4)) in (let _b1_body_19=(u _5367 (u (u fm_term_var _5366) _lv_4)) in (let _5368 = (u (u (u (u (u fm_term_equal _a1_body_18) _b1_body_19) _defs_3) (u nat_succ _lv_4)) _seen_17) in (case _5368 of {(0,f) -> u f (\_5369 _5370-> (let _5371 = _5369 in (case _5371 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5370)); (1,f) -> u f (\_5372-> (let _5373 = (u (u fm_check_result (u maybe_some _5372)) list_nil) in (case _5373 of {(0,f) -> u f (\_5374 _5375-> (u (u fm_check_result _5374) (u (u list_concat _5370) _5375))); }))); }))); })))))); (5,f) -> u f (\_5376 _5377-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (6,f) -> u f (\_5378 _5379 _5380-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (7,f) -> u f (\_5381 _5382 _5383-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5384 _5385 _5386-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5387 _5388 _5389-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5390-> (u (u fm_term_equal_hole _5390) _a_1)); (11,f) -> u f (\_5391-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5392-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5393-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5394 _5395 _5396 _5397 _5398 _5399-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5400 _5401-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); (5,f) -> u f (\_5402 _5403-> (let _5404 = _b1_9 in (case _5404 of {(0,f) -> u f (\_5405 _5406-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5407-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5408 _5409 _5410 _5411 _5412-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (4,f) -> u f (\_5413 _5414-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (5,f) -> u f (\_5415 _5416-> (let _seen_17=(u (u set_set _id_12) _seen_5) in (let _5417 = (u (u (u (u (u fm_term_equal _5402) _5415) _defs_3) _lv_4) _seen_17) in (case _5417 of {(0,f) -> u f (\_5418 _5419-> (let _5420 = _5418 in (case _5420 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5419)); (1,f) -> u f (\_5421-> (let _5422 = (let _5423 = (u (u (u (u (u fm_term_equal _5403) _5416) _defs_3) _lv_4) _seen_17) in (case _5423 of {(0,f) -> u f (\_5424 _5425-> (let _5426 = _5424 in (case _5426 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5425)); (1,f) -> u f (\_5427-> (let _5428 = (u (u fm_check_result (u maybe_some ((_5421 && _5427)))) list_nil) in (case _5428 of {(0,f) -> u f (\_5429 _5430-> (u (u fm_check_result _5429) (u (u list_concat _5425) _5430))); }))); }))); })) in (case _5422 of {(0,f) -> u f (\_5431 _5432-> (u (u fm_check_result _5431) (u (u list_concat _5419) _5432))); }))); }))); })))); (6,f) -> u f (\_5433 _5434 _5435-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (7,f) -> u f (\_5436 _5437 _5438-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5439 _5440 _5441-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5442 _5443 _5444-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5445-> (u (u fm_term_equal_hole _5445) _a_1)); (11,f) -> u f (\_5446-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5447-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5448-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5449 _5450 _5451 _5452 _5453 _5454-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5455 _5456-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); (6,f) -> u f (\_5457 _5458 _5459-> (let _5460 = _b1_9 in (case _5460 of {(0,f) -> u f (\_5461 _5462-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5463-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5464 _5465 _5466 _5467 _5468-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (4,f) -> u f (\_5469 _5470-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (5,f) -> u f (\_5471 _5472-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (6,f) -> u f (\_5473 _5474 _5475-> (let _seen_19=(u (u set_set _id_12) _seen_5) in (let _a1_body_20=(u _5459 (u (u fm_term_var _5457) _lv_4)) in (let _b1_body_21=(u _5475 (u (u fm_term_var _5473) _lv_4)) in (let _5476 = (u (u (u (u (u fm_term_equal _5458) _5474) _defs_3) _lv_4) _seen_19) in (case _5476 of {(0,f) -> u f (\_5477 _5478-> (let _5479 = _5477 in (case _5479 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5478)); (1,f) -> u f (\_5480-> (let _5481 = (let _5482 = (u (u (u (u (u fm_term_equal _a1_body_20) _b1_body_21) _defs_3) (u nat_succ _lv_4)) _seen_19) in (case _5482 of {(0,f) -> u f (\_5483 _5484-> (let _5485 = _5483 in (case _5485 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5484)); (1,f) -> u f (\_5486-> (let _5487 = (u (u fm_check_result (u maybe_some ((_5480 && _5486)))) list_nil) in (case _5487 of {(0,f) -> u f (\_5488 _5489-> (u (u fm_check_result _5488) (u (u list_concat _5484) _5489))); }))); }))); })) in (case _5481 of {(0,f) -> u f (\_5490 _5491-> (u (u fm_check_result _5490) (u (u list_concat _5478) _5491))); }))); }))); })))))); (7,f) -> u f (\_5492 _5493 _5494-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5495 _5496 _5497-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5498 _5499 _5500-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5501-> (u (u fm_term_equal_hole _5501) _a_1)); (11,f) -> u f (\_5502-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5503-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5504-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5505 _5506 _5507 _5508 _5509 _5510-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5511 _5512-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); (7,f) -> u f (\_5513 _5514 _5515-> (let _5516 = _b1_9 in (case _5516 of {(0,f) -> u f (\_5517 _5518-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5519-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5520 _5521 _5522 _5523 _5524-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (4,f) -> u f (\_5525 _5526-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (5,f) -> u f (\_5527 _5528-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (6,f) -> u f (\_5529 _5530 _5531-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (7,f) -> u f (\_5532 _5533 _5534-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5535 _5536 _5537-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5538 _5539 _5540-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5541-> (u (u fm_term_equal_hole _5541) _a_1)); (11,f) -> u f (\_5542-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5543-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5544-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5545 _5546 _5547 _5548 _5549 _5550-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5551 _5552-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); (8,f) -> u f (\_5553 _5554 _5555-> (let _5556 = _b1_9 in (case _5556 of {(0,f) -> u f (\_5557 _5558-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5559-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5560 _5561 _5562 _5563 _5564-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (4,f) -> u f (\_5565 _5566-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (5,f) -> u f (\_5567 _5568-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (6,f) -> u f (\_5569 _5570 _5571-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (7,f) -> u f (\_5572 _5573 _5574-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5575 _5576 _5577-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5578 _5579 _5580-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5581-> (u (u fm_term_equal_hole _5581) _a_1)); (11,f) -> u f (\_5582-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5583-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5584-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5585 _5586 _5587 _5588 _5589 _5590-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5591 _5592-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); (9,f) -> u f (\_5593 _5594 _5595-> (let _5596 = _b1_9 in (case _5596 of {(0,f) -> u f (\_5597 _5598-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5599-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5600 _5601 _5602 _5603 _5604-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (4,f) -> u f (\_5605 _5606-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (5,f) -> u f (\_5607 _5608-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (6,f) -> u f (\_5609 _5610 _5611-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (7,f) -> u f (\_5612 _5613 _5614-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5615 _5616 _5617-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5618 _5619 _5620-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5621-> (u (u fm_term_equal_hole _5621) _a_1)); (11,f) -> u f (\_5622-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5623-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5624-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5625 _5626 _5627 _5628 _5629 _5630-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5631 _5632-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); (10,f) -> u f (\_5633-> (u (u fm_term_equal_hole _5633) _b_2)); (11,f) -> u f (\_5634-> (let _5635 = _b1_9 in (case _5635 of {(0,f) -> u f (\_5636 _5637-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5638-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5639 _5640 _5641 _5642 _5643-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (4,f) -> u f (\_5644 _5645-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (5,f) -> u f (\_5646 _5647-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (6,f) -> u f (\_5648 _5649 _5650-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (7,f) -> u f (\_5651 _5652 _5653-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5654 _5655 _5656-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5657 _5658 _5659-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5660-> (u (u fm_term_equal_hole _5660) _a_1)); (11,f) -> u f (\_5661-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5662-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5663-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5664 _5665 _5666 _5667 _5668 _5669-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5670 _5671-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); (12,f) -> u f (\_5672-> (let _5673 = _b1_9 in (case _5673 of {(0,f) -> u f (\_5674 _5675-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5676-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5677 _5678 _5679 _5680 _5681-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (4,f) -> u f (\_5682 _5683-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (5,f) -> u f (\_5684 _5685-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (6,f) -> u f (\_5686 _5687 _5688-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (7,f) -> u f (\_5689 _5690 _5691-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5692 _5693 _5694-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5695 _5696 _5697-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5698-> (u (u fm_term_equal_hole _5698) _a_1)); (11,f) -> u f (\_5699-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5700-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5701-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5702 _5703 _5704 _5705 _5706 _5707-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5708 _5709-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); (13,f) -> u f (\_5710-> (let _5711 = _b1_9 in (case _5711 of {(0,f) -> u f (\_5712 _5713-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5714-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5715 _5716 _5717 _5718 _5719-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (4,f) -> u f (\_5720 _5721-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (5,f) -> u f (\_5722 _5723-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (6,f) -> u f (\_5724 _5725 _5726-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (7,f) -> u f (\_5727 _5728 _5729-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5730 _5731 _5732-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5733 _5734 _5735-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5736-> (u (u fm_term_equal_hole _5736) _a_1)); (11,f) -> u f (\_5737-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5738-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5739-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5740 _5741 _5742 _5743 _5744 _5745-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5746 _5747-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); (14,f) -> u f (\_5748 _5749 _5750 _5751 _5752 _5753-> (let _5754 = _b1_9 in (case _5754 of {(0,f) -> u f (\_5755 _5756-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5757-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5758 _5759 _5760 _5761 _5762-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (4,f) -> u f (\_5763 _5764-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (5,f) -> u f (\_5765 _5766-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (6,f) -> u f (\_5767 _5768 _5769-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (7,f) -> u f (\_5770 _5771 _5772-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5773 _5774 _5775-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5776 _5777 _5778-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5779-> (u (u fm_term_equal_hole _5779) _a_1)); (11,f) -> u f (\_5780-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5781-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5782-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5783 _5784 _5785 _5786 _5787 _5788-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5789 _5790-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); (15,f) -> u f (\_5791 _5792-> (let _5793 = _b1_9 in (case _5793 of {(0,f) -> u f (\_5794 _5795-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5796-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5797 _5798 _5799 _5800 _5801-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (4,f) -> u f (\_5802 _5803-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (5,f) -> u f (\_5804 _5805-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (6,f) -> u f (\_5806 _5807 _5808-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (7,f) -> u f (\_5809 _5810 _5811-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5812 _5813 _5814-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5815 _5816 _5817-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5818-> (u (u fm_term_equal_hole _5818) _a_1)); (11,f) -> u f (\_5819-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5820-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5821-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5822 _5823 _5824 _5825 _5826 _5827-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5828 _5829-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); }))))))))))))))))))))
set_new = map_new
fm_term_check = (\_term_1-> (\_type_2-> (\_defs_3-> (\_ctx_4-> (\_path_5-> (\_orig_6-> (let _5830 = (let _5831 = _term_1 in (case _5831 of {(0,f) -> u f (\_5832 _5833-> (let _5834 = (u (u list_at_last _5833) _ctx_4) in (case _5834 of {(0,f) -> u f ((u (u fm_check_result _type_2) (u (u list_cons (u (u fm_error_undefined_reference _orig_6) _5832)) list_nil))); (1,f) -> u f (\_5835-> (u (u fm_check_result (u maybe_some (let _5836 = _5835 in (case _5836 of {(0,f) -> u f (\_5837 _5838-> _5838); })))) list_nil)); }))); (1,f) -> u f (\_5839-> (let _5840 = (u (u fm_get _5839) _defs_3) in (case _5840 of {(0,f) -> u f ((u (u fm_check_result _type_2) (u (u list_cons (u (u fm_error_undefined_reference _orig_6) _5839)) list_nil))); (1,f) -> u f (\_5841-> (let _5842 = _5841 in (case _5842 of {(0,f) -> u f (\_5843 _5844 _5845 _5846 _5847 _5848 _5849 _5850 _5851-> (let _ref_name_18=_5846 in (let _ref_type_19=_5848 in (let _ref_term_20=_5847 in (let _ref_stat_21=_5851 in (let _5852 = _ref_stat_21 in (case _5852 of {(0,f) -> u f ((u (u fm_check_result (u maybe_some _ref_type_19)) (u (u list_cons (u fm_error_waiting _ref_name_18)) list_nil))); (1,f) -> u f ((u (u fm_check_result (u maybe_some _ref_type_19)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some _ref_type_19)) list_nil)); (3,f) -> u f (\_5853-> (u (u fm_check_result (u maybe_some _ref_type_19)) (u (u list_cons (u fm_error_indirect _ref_name_18)) list_nil))); }))))))); }))); }))); (2,f) -> u f ((u (u fm_check_result (u maybe_some fm_term_typ)) list_nil)); (3,f) -> u f (\_5854 _5855 _5856 _5857 _5858-> (let _ctx_size_12=(u list_length _ctx_4) in (let _self_var_13=(u (u fm_term_var _5855) _ctx_size_12) in (let _body_var_14=(u (u fm_term_var _5856) (u nat_succ _ctx_size_12)) in (let _body_ctx_15=(u (u list_cons (u (u pair_new _5856) _5857)) (u (u list_cons (u (u pair_new _5855) _term_1)) _ctx_4)) in (let _5859 = (u (u (u (u (u (u fm_term_check _5857) (u maybe_some fm_term_typ)) _defs_3) _ctx_4) (u fm_mpath_o _path_5)) _orig_6) in (case _5859 of {(0,f) -> u f (\_5860 _5861-> (let _5862 = _5860 in (case _5862 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5861)); (1,f) -> u f (\_5863-> (let _5864 = (let _5865 = (u (u (u (u (u (u fm_term_check (u (u _5858 _self_var_13) _body_var_14)) (u maybe_some fm_term_typ)) _defs_3) _body_ctx_15) (u fm_mpath_i _path_5)) _orig_6) in (case _5865 of {(0,f) -> u f (\_5866 _5867-> (let _5868 = _5866 in (case _5868 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5867)); (1,f) -> u f (\_5869-> (let _5870 = (u (u fm_check_result (u maybe_some fm_term_typ)) list_nil) in (case _5870 of {(0,f) -> u f (\_5871 _5872-> (u (u fm_check_result _5871) (u (u list_concat _5867) _5872))); }))); }))); })) in (case _5864 of {(0,f) -> u f (\_5873 _5874-> (u (u fm_check_result _5873) (u (u list_concat _5861) _5874))); }))); }))); }))))))); (4,f) -> u f (\_5875 _5876-> (let _5877 = _type_2 in (case _5877 of {(0,f) -> u f ((let _lam_type_9=(u fm_term_hol bits_e) in (let _lam_term_10=(u (u (u fm_term_ann bool_false) _term_1) _lam_type_9) in (u (u fm_check_result _type_2) (u (u list_cons (u (u fm_error_patch (u fm_mpath_to_bits _path_5)) _lam_term_10)) list_nil))))); (1,f) -> u f (\_5878-> (let _typv_10=(u (u fm_term_reduce _5878) _defs_3) in (let _5879 = _typv_10 in (case _5879 of {(0,f) -> u f (\_5880 _5881-> (let _expected_13=(u either_left "(function type)") in (let _detected_14=(u either_right _5878) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_13) _detected_14) _ctx_4)) list_nil))))); (1,f) -> u f (\_5882-> (let _expected_12=(u either_left "(function type)") in (let _detected_13=(u either_right _5878) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_12) _detected_13) _ctx_4)) list_nil))))); (2,f) -> u f ((let _expected_11=(u either_left "(function type)") in (let _detected_12=(u either_right _5878) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_11) _detected_12) _ctx_4)) list_nil))))); (3,f) -> u f (\_5883 _5884 _5885 _5886 _5887-> (let _ctx_size_16=(u list_length _ctx_4) in (let _self_var_17=_term_1 in (let _body_var_18=(u (u fm_term_var _5875) _ctx_size_16) in (let _body_typ_19=(u (u _5887 _self_var_17) _body_var_18) in (let _body_ctx_20=(u (u list_cons (u (u pair_new _5875) _5886)) _ctx_4) in (let _5888 = (u (u (u (u (u (u fm_term_check (u _5876 _body_var_18)) (u maybe_some _body_typ_19)) _defs_3) _body_ctx_20) (u fm_mpath_o _path_5)) _orig_6) in (case _5888 of {(0,f) -> u f (\_5889 _5890-> (let _5891 = _5889 in (case _5891 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5890)); (1,f) -> u f (\_5892-> (let _5893 = (u (u fm_check_result (u maybe_some _5878)) list_nil) in (case _5893 of {(0,f) -> u f (\_5894 _5895-> (u (u fm_check_result _5894) (u (u list_concat _5890) _5895))); }))); }))); })))))))); (4,f) -> u f (\_5896 _5897-> (let _expected_13=(u either_left "(function type)") in (let _detected_14=(u either_right _5878) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_13) _detected_14) _ctx_4)) list_nil))))); (5,f) -> u f (\_5898 _5899-> (let _expected_13=(u either_left "(function type)") in (let _detected_14=(u either_right _5878) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_13) _detected_14) _ctx_4)) list_nil))))); (6,f) -> u f (\_5900 _5901 _5902-> (let _expected_14=(u either_left "(function type)") in (let _detected_15=(u either_right _5878) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_14) _detected_15) _ctx_4)) list_nil))))); (7,f) -> u f (\_5903 _5904 _5905-> (let _expected_14=(u either_left "(function type)") in (let _detected_15=(u either_right _5878) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_14) _detected_15) _ctx_4)) list_nil))))); (8,f) -> u f (\_5906 _5907 _5908-> (let _expected_14=(u either_left "(function type)") in (let _detected_15=(u either_right _5878) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_14) _detected_15) _ctx_4)) list_nil))))); (9,f) -> u f (\_5909 _5910 _5911-> (let _expected_14=(u either_left "(function type)") in (let _detected_15=(u either_right _5878) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_14) _detected_15) _ctx_4)) list_nil))))); (10,f) -> u f (\_5912-> (let _expected_12=(u either_left "(function type)") in (let _detected_13=(u either_right _5878) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_12) _detected_13) _ctx_4)) list_nil))))); (11,f) -> u f (\_5913-> (let _expected_12=(u either_left "(function type)") in (let _detected_13=(u either_right _5878) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_12) _detected_13) _ctx_4)) list_nil))))); (12,f) -> u f (\_5914-> (let _expected_12=(u either_left "(function type)") in (let _detected_13=(u either_right _5878) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_12) _detected_13) _ctx_4)) list_nil))))); (13,f) -> u f (\_5915-> (let _expected_12=(u either_left "(function type)") in (let _detected_13=(u either_right _5878) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_12) _detected_13) _ctx_4)) list_nil))))); (14,f) -> u f (\_5916 _5917 _5918 _5919 _5920 _5921-> (let _expected_17=(u either_left "(function type)") in (let _detected_18=(u either_right _5878) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_17) _detected_18) _ctx_4)) list_nil))))); (15,f) -> u f (\_5922 _5923-> (let _expected_13=(u either_left "(function type)") in (let _detected_14=(u either_right _5878) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_13) _detected_14) _ctx_4)) list_nil))))); })))); }))); (5,f) -> u f (\_5924 _5925-> (let _5926 = (u (u (u (u (u (u fm_term_check _5924) maybe_none) _defs_3) _ctx_4) (u fm_mpath_o _path_5)) _orig_6) in (case _5926 of {(0,f) -> u f (\_5927 _5928-> (let _5929 = _5927 in (case _5929 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5928)); (1,f) -> u f (\_5930-> (let _func_typ_12=(u (u fm_term_reduce _5930) _defs_3) in (let _5931 = (let _5932 = _func_typ_12 in (case _5932 of {(0,f) -> u f (\_5933 _5934-> (let _expected_15=(u either_left "(function type)") in (let _detected_16=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_15) _detected_16) _ctx_4)) list_nil))))); (1,f) -> u f (\_5935-> (let _expected_14=(u either_left "(function type)") in (let _detected_15=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_14) _detected_15) _ctx_4)) list_nil))))); (2,f) -> u f ((let _expected_13=(u either_left "(function type)") in (let _detected_14=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_13) _detected_14) _ctx_4)) list_nil))))); (3,f) -> u f (\_5936 _5937 _5938 _5939 _5940-> (let _5941 = (u (u (u (u (u (u fm_term_check _5925) (u maybe_some _5939)) _defs_3) _ctx_4) (u fm_mpath_i _path_5)) _orig_6) in (case _5941 of {(0,f) -> u f (\_5942 _5943-> (let _5944 = _5942 in (case _5944 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5943)); (1,f) -> u f (\_5945-> (let _5946 = (u (u fm_check_result (u maybe_some (u (u _5940 _5924) _5925))) list_nil) in (case _5946 of {(0,f) -> u f (\_5947 _5948-> (u (u fm_check_result _5947) (u (u list_concat _5943) _5948))); }))); }))); }))); (4,f) -> u f (\_5949 _5950-> (let _expected_15=(u either_left "(function type)") in (let _detected_16=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_15) _detected_16) _ctx_4)) list_nil))))); (5,f) -> u f (\_5951 _5952-> (let _expected_15=(u either_left "(function type)") in (let _detected_16=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_15) _detected_16) _ctx_4)) list_nil))))); (6,f) -> u f (\_5953 _5954 _5955-> (let _expected_16=(u either_left "(function type)") in (let _detected_17=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_16) _detected_17) _ctx_4)) list_nil))))); (7,f) -> u f (\_5956 _5957 _5958-> (let _expected_16=(u either_left "(function type)") in (let _detected_17=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_16) _detected_17) _ctx_4)) list_nil))))); (8,f) -> u f (\_5959 _5960 _5961-> (let _expected_16=(u either_left "(function type)") in (let _detected_17=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_16) _detected_17) _ctx_4)) list_nil))))); (9,f) -> u f (\_5962 _5963 _5964-> (let _expected_16=(u either_left "(function type)") in (let _detected_17=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_16) _detected_17) _ctx_4)) list_nil))))); (10,f) -> u f (\_5965-> (let _expected_14=(u either_left "(function type)") in (let _detected_15=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_14) _detected_15) _ctx_4)) list_nil))))); (11,f) -> u f (\_5966-> (let _expected_14=(u either_left "(function type)") in (let _detected_15=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_14) _detected_15) _ctx_4)) list_nil))))); (12,f) -> u f (\_5967-> (let _expected_14=(u either_left "(function type)") in (let _detected_15=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_14) _detected_15) _ctx_4)) list_nil))))); (13,f) -> u f (\_5968-> (let _expected_14=(u either_left "(function type)") in (let _detected_15=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_14) _detected_15) _ctx_4)) list_nil))))); (14,f) -> u f (\_5969 _5970 _5971 _5972 _5973 _5974-> (let _expected_19=(u either_left "(function type)") in (let _detected_20=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_19) _detected_20) _ctx_4)) list_nil))))); (15,f) -> u f (\_5975 _5976-> (let _expected_15=(u either_left "(function type)") in (let _detected_16=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_15) _detected_16) _ctx_4)) list_nil))))); })) in (case _5931 of {(0,f) -> u f (\_5977 _5978-> (u (u fm_check_result _5977) (u (u list_concat _5928) _5978))); })))); }))); }))); (6,f) -> u f (\_5979 _5980 _5981-> (let _ctx_size_10=(u list_length _ctx_4) in (let _5982 = (u (u (u (u (u (u fm_term_check _5980) maybe_none) _defs_3) _ctx_4) (u fm_mpath_o _path_5)) _orig_6) in (case _5982 of {(0,f) -> u f (\_5983 _5984-> (let _5985 = _5983 in (case _5985 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5984)); (1,f) -> u f (\_5986-> (let _body_val_14=(u _5981 (u (u fm_term_var _5979) _ctx_size_10)) in (let _body_ctx_15=(u (u list_cons (u (u pair_new _5979) _5986)) _ctx_4) in (let _5987 = (let _5988 = (u (u (u (u (u (u fm_term_check _body_val_14) _type_2) _defs_3) _body_ctx_15) (u fm_mpath_i _path_5)) _orig_6) in (case _5988 of {(0,f) -> u f (\_5989 _5990-> (let _5991 = _5989 in (case _5991 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5990)); (1,f) -> u f (\_5992-> (let _5993 = (u (u fm_check_result (u maybe_some _5992)) list_nil) in (case _5993 of {(0,f) -> u f (\_5994 _5995-> (u (u fm_check_result _5994) (u (u list_concat _5990) _5995))); }))); }))); })) in (case _5987 of {(0,f) -> u f (\_5996 _5997-> (u (u fm_check_result _5996) (u (u list_concat _5984) _5997))); }))))); }))); })))); (7,f) -> u f (\_5998 _5999 _6000-> (let _ctx_size_10=(u list_length _ctx_4) in (let _6001 = (u (u (u (u (u (u fm_term_check _5999) maybe_none) _defs_3) _ctx_4) (u fm_mpath_o _path_5)) _orig_6) in (case _6001 of {(0,f) -> u f (\_6002 _6003-> (let _6004 = _6002 in (case _6004 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _6003)); (1,f) -> u f (\_6005-> (let _body_val_14=(u _6000 (u (u (u fm_term_ann bool_true) _5999) _6005)) in (let _body_ctx_15=(u (u list_cons (u (u pair_new _5998) _6005)) _ctx_4) in (let _6006 = (let _6007 = (u (u (u (u (u (u fm_term_check _body_val_14) _type_2) _defs_3) _body_ctx_15) (u fm_mpath_i _path_5)) _orig_6) in (case _6007 of {(0,f) -> u f (\_6008 _6009-> (let _6010 = _6008 in (case _6010 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _6009)); (1,f) -> u f (\_6011-> (let _6012 = (u (u fm_check_result (u maybe_some _6011)) list_nil) in (case _6012 of {(0,f) -> u f (\_6013 _6014-> (u (u fm_check_result _6013) (u (u list_concat _6009) _6014))); }))); }))); })) in (case _6006 of {(0,f) -> u f (\_6015 _6016-> (u (u fm_check_result _6015) (u (u list_concat _6003) _6016))); }))))); }))); })))); (8,f) -> u f (\_6017 _6018 _6019-> (let _6020 = _6017 in (if _6020 then (u (u fm_check_result (u maybe_some _6019)) list_nil) else (let _6021 = (u (u (u (u (u (u fm_term_check _6018) (u maybe_some _6019)) _defs_3) _ctx_4) (u fm_mpath_o _path_5)) _orig_6) in (case _6021 of {(0,f) -> u f (\_6022 _6023-> (let _6024 = _6022 in (case _6024 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _6023)); (1,f) -> u f (\_6025-> (let _6026 = (let _6027 = (u (u (u (u (u (u fm_term_check _6019) (u maybe_some fm_term_typ)) _defs_3) _ctx_4) (u fm_mpath_i _path_5)) _orig_6) in (case _6027 of {(0,f) -> u f (\_6028 _6029-> (let _6030 = _6028 in (case _6030 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _6029)); (1,f) -> u f (\_6031-> (let _6032 = (u (u fm_check_result (u maybe_some _6019)) list_nil) in (case _6032 of {(0,f) -> u f (\_6033 _6034-> (u (u fm_check_result _6033) (u (u list_concat _6029) _6034))); }))); }))); })) in (case _6026 of {(0,f) -> u f (\_6035 _6036-> (u (u fm_check_result _6035) (u (u list_concat _6023) _6036))); }))); }))); }))))); (9,f) -> u f (\_6037 _6038 _6039-> (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u (u fm_error_show_goal _6037) _6038) _6039) _type_2) _ctx_4)) list_nil))); (10,f) -> u f (\_6040-> (u (u fm_check_result _type_2) list_nil)); (11,f) -> u f (\_6041-> (u (u fm_check_result (u maybe_some (u fm_term_ref "Nat"))) list_nil)); (12,f) -> u f (\_6042-> (u (u fm_check_result (u maybe_some (u fm_term_ref "Char"))) list_nil)); (13,f) -> u f (\_6043-> (u (u fm_check_result (u maybe_some (u fm_term_ref "String"))) list_nil)); (14,f) -> u f (\_6044 _6045 _6046 _6047 _6048 _6049-> (let _expr_13=_6045 in (let _6050 = (u (u (u (u (u (u fm_term_check _expr_13) maybe_none) _defs_3) _ctx_4) (u fm_mpath_o _path_5)) _orig_6) in (case _6050 of {(0,f) -> u f (\_6051 _6052-> (let _6053 = _6051 in (case _6053 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _6052)); (1,f) -> u f (\_6054-> (let _dsug_17=(let _6055 = _6049 in (case _6055 of {(0,f) -> u f ((let _moti_17=(let _6056 = _type_2 in (case _6056 of {(0,f) -> u f ((u fm_term_hol bits_e)); (1,f) -> u f (\_6057-> (let _size_18=(u list_length _ctx_4) in (let _typv_19=(u (u fm_term_normalize _6057) map_new) in (let _moti_20=(u (u (u (u (u (u fm_smartmotive_make _6046) _6045) _6054) _typv_19) _size_18) _defs_3) in _moti_20)))); })) in (u maybe_some (u (u (u (u (u (u fm_term_cse _6044) _6045) _6046) _6047) _6048) (u maybe_some _moti_17))))); (1,f) -> u f (\_6058-> (u (u (u (u (u (u (u (u fm_term_desugar_cse _6045) _6046) _6047) _6048) _6058) _6054) _defs_3) _ctx_4)); })) in (let _6059 = (let _6060 = _dsug_17 in (case _6060 of {(0,f) -> u f ((u (u fm_check_result _type_2) (u (u list_cons (u (u (u fm_error_cant_infer _orig_6) _term_1) _ctx_4)) list_nil))); (1,f) -> u f (\_6061-> (u (u fm_check_result _type_2) (u (u list_cons (u (u fm_error_patch (u fm_mpath_to_bits _path_5)) _6061)) list_nil))); })) in (case _6059 of {(0,f) -> u f (\_6062 _6063-> (u (u fm_check_result _6062) (u (u list_concat _6052) _6063))); })))); }))); })))); (15,f) -> u f (\_6064 _6065-> (u (u (u (u (u (u fm_term_check _6065) _type_2) _defs_3) _ctx_4) _path_5) (u maybe_some _6064))); })) in (case _5830 of {(0,f) -> u f (\_6066 _6067-> (let _6068 = _6066 in (case _6068 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _6067)); (1,f) -> u f (\_6069-> (let _6070 = (let _6071 = _type_2 in (case _6071 of {(0,f) -> u f ((u (u fm_check_result (u maybe_some _6069)) list_nil)); (1,f) -> u f (\_6072-> (let _6073 = (u (u (u (u (u fm_term_equal _6072) _6069) _defs_3) (u list_length _ctx_4)) set_new) in (case _6073 of {(0,f) -> u f (\_6074 _6075-> (let _6076 = _6074 in (case _6076 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _6075)); (1,f) -> u f (\_6077-> (let _6078 = (let _6079 = _6077 in (if _6079 then (u (u fm_check_result (u maybe_some _6072)) list_nil) else (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) (u either_right _6072)) (u either_right _6069)) _ctx_4)) list_nil)))) in (case _6078 of {(0,f) -> u f (\_6080 _6081-> (u (u fm_check_result _6080) (u (u list_concat _6075) _6081))); }))); }))); }))); })) in (case _6070 of {(0,f) -> u f (\_6082 _6083-> (u (u fm_check_result _6082) (u (u list_concat _6067) _6083))); }))); }))); }))))))))
fm_path_nil = (\_x_1-> _x_1)
fm_mpath_nil = (u maybe_some fm_path_nil)
list_is_empty = (\_list_2-> (let _6084 = _list_2 in (case _6084 of {(0,f) -> u f (bool_true); (1,f) -> u f (\_6085 _6086-> bool_false); })))
fm_term_patch_at = (\_path_1-> (\_term_2-> (\_fn_3-> (let _6087 = _term_2 in (case _6087 of {(0,f) -> u f (\_6088 _6089-> (let _6090 = _path_1 in (case _6090 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_6091-> _term_2); (2,f) -> u f (\_6092-> _term_2); }))); (1,f) -> u f (\_6093-> (let _6094 = _path_1 in (case _6094 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_6095-> _term_2); (2,f) -> u f (\_6096-> _term_2); }))); (2,f) -> u f ((let _6097 = _path_1 in (case _6097 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_6098-> _term_2); (2,f) -> u f (\_6099-> _term_2); }))); (3,f) -> u f (\_6100 _6101 _6102 _6103 _6104-> (let _6105 = _path_1 in (case _6105 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_6106-> (u (u (u (u (u fm_term_all _6100) _6101) _6102) (u (u (u fm_term_patch_at _6106) _6103) _fn_3)) _6104)); (2,f) -> u f (\_6107-> (u (u (u (u (u fm_term_all _6100) _6101) _6102) _6103) (\_s_10-> (\_x_11-> (u (u (u fm_term_patch_at _6107) (u (u _6104 _s_10) _x_11)) _fn_3))))); }))); (4,f) -> u f (\_6108 _6109-> (let _6110 = _path_1 in (case _6110 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_6111-> (u (u fm_term_lam _6108) (\_x_7-> (u (u (u fm_term_patch_at (u bits_tail _path_1)) (u _6109 _x_7)) _fn_3)))); (2,f) -> u f (\_6112-> (u (u fm_term_lam _6108) (\_x_7-> (u (u (u fm_term_patch_at (u bits_tail _path_1)) (u _6109 _x_7)) _fn_3)))); }))); (5,f) -> u f (\_6113 _6114-> (let _6115 = _path_1 in (case _6115 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_6116-> (u (u fm_term_app (u (u (u fm_term_patch_at _6116) _6113) _fn_3)) _6114)); (2,f) -> u f (\_6117-> (u (u fm_term_app _6113) (u (u (u fm_term_patch_at _6117) _6114) _fn_3))); }))); (6,f) -> u f (\_6118 _6119 _6120-> (let _6121 = _path_1 in (case _6121 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_6122-> (u (u (u fm_term_let _6118) (u (u (u fm_term_patch_at _6122) _6119) _fn_3)) _6120)); (2,f) -> u f (\_6123-> (u (u (u fm_term_let _6118) _6119) (\_x_8-> (u (u (u fm_term_patch_at _6123) (u _6120 _x_8)) _fn_3)))); }))); (7,f) -> u f (\_6124 _6125 _6126-> (let _6127 = _path_1 in (case _6127 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_6128-> (u (u (u fm_term_def _6124) (u (u (u fm_term_patch_at _6128) _6125) _fn_3)) _6126)); (2,f) -> u f (\_6129-> (u (u (u fm_term_def _6124) _6125) (\_x_8-> (u (u (u fm_term_patch_at _6129) (u _6126 _x_8)) _fn_3)))); }))); (8,f) -> u f (\_6130 _6131 _6132-> (let _6133 = _path_1 in (case _6133 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_6134-> (u (u (u fm_term_ann _6130) (u (u (u fm_term_patch_at _6134) _6131) _fn_3)) _6132)); (2,f) -> u f (\_6135-> (u (u (u fm_term_ann _6130) _6131) (u (u (u fm_term_patch_at _6135) _6132) _fn_3))); }))); (9,f) -> u f (\_6136 _6137 _6138-> (let _6139 = _path_1 in (case _6139 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_6140-> _term_2); (2,f) -> u f (\_6141-> _term_2); }))); (10,f) -> u f (\_6142-> (let _6143 = _path_1 in (case _6143 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_6144-> _term_2); (2,f) -> u f (\_6145-> _term_2); }))); (11,f) -> u f (\_6146-> (let _6147 = _path_1 in (case _6147 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_6148-> _term_2); (2,f) -> u f (\_6149-> _term_2); }))); (12,f) -> u f (\_6150-> (let _6151 = _path_1 in (case _6151 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_6152-> _term_2); (2,f) -> u f (\_6153-> _term_2); }))); (13,f) -> u f (\_6154-> (let _6155 = _path_1 in (case _6155 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_6156-> _term_2); (2,f) -> u f (\_6157-> _term_2); }))); (14,f) -> u f (\_6158 _6159 _6160 _6161 _6162 _6163-> (let _6164 = _path_1 in (case _6164 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_6165-> _term_2); (2,f) -> u f (\_6166-> _term_2); }))); (15,f) -> u f (\_6167 _6168-> (u (u fm_term_ori _6167) (u (u (u fm_term_patch_at _path_1) _6168) _fn_3))); })))))
fm_synth_fix = (\_file_1-> (\_code_2-> (\_orig_3-> (\_name_4-> (\_term_5-> (\_type_6-> (\_isct_7-> (\_arit_8-> (\_defs_9-> (\_errs_10-> (\_fixd_11-> (let _6169 = _errs_10 in (case _6169 of {(0,f) -> u f ((let _6170 = _fixd_11 in (if _6170 then (let _type_12=(u (u (u fm_term_bind list_nil) (\_x_12-> (u bits_i _x_12))) _type_6) in (let _term_13=(u (u (u fm_term_bind list_nil) (\_x_13-> (u bits_o _x_13))) _term_5) in (let _defs_14=(u (u (u fm_set _name_4) (u (u (u (u (u (u (u (u (u fm_def_new _file_1) _code_2) _orig_3) _name_4) _term_13) _type_12) _isct_7) _arit_8) fm_status_init)) _defs_9) in (u (u io_monad (\_m_bind_15-> (\_m_pure_16-> _m_pure_16))) (u maybe_some _defs_14))))) else (u (u io_monad (\_m_bind_12-> (\_m_pure_13-> _m_pure_13))) maybe_none)))); (1,f) -> u f (\_6171 _6172-> (let _6173 = _6171 in (case _6173 of {(0,f) -> u f (\_6174 _6175 _6176 _6177-> (u (u (u (u (u (u (u (u (u (u (u fm_synth_fix _file_1) _code_2) _orig_3) _name_4) _term_5) _type_6) _isct_7) _arit_8) _defs_9) _6172) _fixd_11)); (1,f) -> u f (\_6178 _6179 _6180 _6181 _6182-> (u (u (u (u (u (u (u (u (u (u (u fm_synth_fix _file_1) _code_2) _orig_3) _name_4) _term_5) _type_6) _isct_7) _arit_8) _defs_9) _6172) _fixd_11)); (2,f) -> u f (\_6183-> (u (u (u io_monad (\_m_bind_15-> (\_m_pure_16-> _m_bind_15))) (u (u fm_synth_one _6183) _defs_9)) (\_new_defs_15-> (let _6184 = _new_defs_15 in (case _6184 of {(0,f) -> u f ((u (u (u (u (u (u (u (u (u (u (u fm_synth_fix _file_1) _code_2) _orig_3) _name_4) _term_5) _type_6) _isct_7) _arit_8) _defs_9) _6172) _fixd_11)); (1,f) -> u f (\_6185-> (u (u (u (u (u (u (u (u (u (u (u fm_synth_fix _file_1) _code_2) _orig_3) _name_4) _term_5) _type_6) _isct_7) _arit_8) _6185) _6172) bool_true)); }))))); (3,f) -> u f (\_6186-> (u (u (u (u (u (u (u (u (u (u (u fm_synth_fix _file_1) _code_2) _orig_3) _name_4) _term_5) _type_6) _isct_7) _arit_8) _defs_9) _6172) _fixd_11)); (4,f) -> u f (\_6187 _6188-> (let _6189 = _6187 in (case _6189 of {(0,f) -> u f ((u (u io_monad (\_m_bind_16-> (\_m_pure_17-> _m_pure_17))) maybe_none)); (1,f) -> u f (\_6190-> (let _term_17=(u (u (u fm_term_patch_at _6190) _term_5) (\_x_17-> _6188)) in (u (u (u (u (u (u (u (u (u (u (u fm_synth_fix _file_1) _code_2) _orig_3) _name_4) _term_17) _type_6) _isct_7) _arit_8) _defs_9) _6172) bool_true))); (2,f) -> u f (\_6191-> (let _type_17=(u (u (u fm_term_patch_at _6191) _type_6) (\_x_17-> _6188)) in (u (u (u (u (u (u (u (u (u (u (u fm_synth_fix _file_1) _code_2) _orig_3) _name_4) _term_5) _type_17) _isct_7) _arit_8) _defs_9) _6172) bool_true))); }))); (5,f) -> u f (\_6192 _6193-> (u (u (u io_monad (\_m_bind_16-> (\_m_pure_17-> _m_bind_16))) (u (u fm_synth_one _6193) _defs_9)) (\_new_defs_16-> (let _6194 = _new_defs_16 in (case _6194 of {(0,f) -> u f ((u (u (u (u (u (u (u (u (u (u (u fm_synth_fix _file_1) _code_2) _orig_3) _name_4) _term_5) _type_6) _isct_7) _arit_8) _defs_9) _6172) _fixd_11)); (1,f) -> u f (\_6195-> (u (u (u (u (u (u (u (u (u (u (u fm_synth_fix _file_1) _code_2) _orig_3) _name_4) _term_5) _type_6) _isct_7) _arit_8) _6195) _6172) bool_true)); }))))); (6,f) -> u f (\_6196 _6197 _6198-> (u (u (u (u (u (u (u (u (u (u (u fm_synth_fix _file_1) _code_2) _orig_3) _name_4) _term_5) _type_6) _isct_7) _arit_8) _defs_9) _6172) _fixd_11)); }))); })))))))))))))
fm_status_fail = (\_errors_1-> (3,\t-> t _errors_1))
fm_synth_one = (\_name_1-> (\_defs_2-> (let _6199 = (u (u fm_get _name_1) _defs_2) in (case _6199 of {(0,f) -> u f ((u (u (u io_monad (\_m_bind_3-> (\_m_pure_4-> _m_bind_3))) (u (u fm_synth_load _name_1) _defs_2)) (\_loaded_3-> (let _6200 = _loaded_3 in (case _6200 of {(0,f) -> u f ((u (u io_monad (\_m_bind_4-> (\_m_pure_5-> _m_pure_5))) maybe_none)); (1,f) -> u f (\_6201-> (u (u fm_synth_one _name_1) _6201)); }))))); (1,f) -> u f (\_6202-> (let _6203 = _6202 in (case _6203 of {(0,f) -> u f (\_6204 _6205 _6206 _6207 _6208 _6209 _6210 _6211 _6212-> (let _file_13=_6204 in (let _code_14=_6205 in (let _orig_15=_6206 in (let _name_16=_6207 in (let _term_17=_6208 in (let _type_18=_6209 in (let _isct_19=_6210 in (let _arit_20=_6211 in (let _stat_21=_6212 in (let _6213 = _stat_21 in (case _6213 of {(0,f) -> u f ((let _defs_22=(u (u (u fm_set _name_16) (u (u (u (u (u (u (u (u (u fm_def_new _file_13) _code_14) _orig_15) _name_16) _term_17) _type_18) _isct_19) _arit_20) fm_status_wait)) _defs_2) in (let _checked_23=(let _6214 = (u (u (u (u (u (u fm_term_check _type_18) (u maybe_some fm_term_typ)) _defs_22) list_nil) (u fm_mpath_i fm_mpath_nil)) maybe_none) in (case _6214 of {(0,f) -> u f (\_6215 _6216-> (let _6217 = _6215 in (case _6217 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _6216)); (1,f) -> u f (\_6218-> (let _6219 = (let _6220 = (u (u (u (u (u (u fm_term_check _term_17) (u maybe_some _type_18)) _defs_22) list_nil) (u fm_mpath_o fm_mpath_nil)) maybe_none) in (case _6220 of {(0,f) -> u f (\_6221 _6222-> (let _6223 = _6221 in (case _6223 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _6222)); (1,f) -> u f (\_6224-> (let _6225 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _6225 of {(0,f) -> u f (\_6226 _6227-> (u (u fm_check_result _6226) (u (u list_concat _6222) _6227))); }))); }))); })) in (case _6219 of {(0,f) -> u f (\_6228 _6229-> (u (u fm_check_result _6228) (u (u list_concat _6216) _6229))); }))); }))); })) in (let _6230 = _checked_23 in (case _6230 of {(0,f) -> u f (\_6231 _6232-> (let _6233 = (u list_is_empty _6232) in (if _6233 then (let _defs_26=(u (u (u (u (u (u (u (u (u (u fm_define _file_13) _code_14) _orig_15) _name_16) _term_17) _type_18) _isct_19) _arit_20) bool_true) _defs_22) in (u (u io_monad (\_m_bind_27-> (\_m_pure_28-> _m_pure_28))) (u maybe_some _defs_26))) else (u (u (u io_monad (\_m_bind_26-> (\_m_pure_27-> _m_bind_26))) (u (u (u (u (u (u (u (u (u (u (u fm_synth_fix _file_13) _code_14) _orig_15) _name_16) _term_17) _type_18) _isct_19) _arit_20) _defs_22) _6232) bool_false)) (\_fixed_26-> (let _6234 = _fixed_26 in (case _6234 of {(0,f) -> u f ((let _stat_27=(u fm_status_fail _6232) in (let _defs_28=(u (u (u fm_set _name_16) (u (u (u (u (u (u (u (u (u fm_def_new _file_13) _code_14) _orig_15) _name_16) _term_17) _type_18) _isct_19) _arit_20) _stat_27)) _defs_22) in (u (u io_monad (\_m_bind_29-> (\_m_pure_30-> _m_pure_30))) (u maybe_some _defs_28))))); (1,f) -> u f (\_6235-> (u (u fm_synth_one _name_16) _6235)); }))))))); }))))); (1,f) -> u f ((u (u io_monad (\_m_bind_22-> (\_m_pure_23-> _m_pure_23))) (u maybe_some _defs_2))); (2,f) -> u f ((u (u io_monad (\_m_bind_22-> (\_m_pure_23-> _m_pure_23))) (u maybe_some _defs_2))); (3,f) -> u f (\_6236-> (u (u io_monad (\_m_bind_23-> (\_m_pure_24-> _m_pure_24))) (u maybe_some _defs_2))); })))))))))))); }))); }))))
map_map = (\_fn_3-> (\_map_4-> (let _6237 = _map_4 in (case _6237 of {(0,f) -> u f (map_new); (1,f) -> u f (\_6238 _6239 _6240-> (let _val_8=(let _6241 = _6238 in (case _6241 of {(0,f) -> u f (maybe_none); (1,f) -> u f (\_6242-> (u maybe_some (u _fn_3 _6242))); })) in (let _lft_9=(u (u map_map _fn_3) _6239) in (let _rgt_10=(u (u map_map _fn_3) _6240) in (u (u (u map_tie _val_8) _lft_9) _rgt_10))))); }))))
fm_term_inline_names = (let _inl_1=(u (u list_cons "Monad.pure") (u (u list_cons "Monad.bind") (u (u list_cons "Monad.new") (u (u list_cons "Parser.monad") (u (u list_cons "Parser.bind") (u (u list_cons "Parser.pure") (u (u list_cons "Fm.Check.pure") (u (u list_cons "Fm.Check.bind") (u (u list_cons "Fm.Check.monad") (u (u list_cons "Fm.Check.value") (u (u list_cons "Fm.Check.none") list_nil))))))))))) in (let _kvs_2=(u (u list_mapped _inl_1) (\_x_2-> (u (u pair_new (u fm_name_to_bits _x_2)) unit_new))) in (u map_from_list _kvs_2)))
fm_term_inline_reduce = (\_term_1-> (\_defs_2-> (let _6243 = _term_1 in (case _6243 of {(0,f) -> u f (\_6244 _6245-> _term_1); (1,f) -> u f (\_6246-> (let _inli_4=(u (u set_has (u fm_name_to_bits _6246)) fm_term_inline_names) in (let _6247 = _inli_4 in (if _6247 then (let _6248 = (u (u fm_get _6246) _defs_2) in (case _6248 of {(0,f) -> u f ((u fm_term_ref _6246)); (1,f) -> u f (\_6249-> (let _6250 = _6249 in (case _6250 of {(0,f) -> u f (\_6251 _6252 _6253 _6254 _6255 _6256 _6257 _6258 _6259-> (u (u fm_term_inline_reduce _6255) _defs_2)); }))); })) else _term_1)))); (2,f) -> u f (_term_1); (3,f) -> u f (\_6260 _6261 _6262 _6263 _6264-> _term_1); (4,f) -> u f (\_6265 _6266-> _term_1); (5,f) -> u f (\_6267 _6268-> (let _func_5=(u (u fm_term_inline_reduce _6267) _defs_2) in (let _6269 = _func_5 in (case _6269 of {(0,f) -> u f (\_6270 _6271-> _term_1); (1,f) -> u f (\_6272-> _term_1); (2,f) -> u f (_term_1); (3,f) -> u f (\_6273 _6274 _6275 _6276 _6277-> _term_1); (4,f) -> u f (\_6278 _6279-> (u (u fm_term_inline_reduce (u _6279 _6268)) _defs_2)); (5,f) -> u f (\_6280 _6281-> _term_1); (6,f) -> u f (\_6282 _6283 _6284-> (u (u (u fm_term_let _6282) _6283) (\_x_9-> (u (u fm_term_inline_reduce (u (u fm_term_app (u _6284 _x_9)) _6268)) _defs_2)))); (7,f) -> u f (\_6285 _6286 _6287-> _term_1); (8,f) -> u f (\_6288 _6289 _6290-> _term_1); (9,f) -> u f (\_6291 _6292 _6293-> _term_1); (10,f) -> u f (\_6294-> _term_1); (11,f) -> u f (\_6295-> _term_1); (12,f) -> u f (\_6296-> _term_1); (13,f) -> u f (\_6297-> _term_1); (14,f) -> u f (\_6298 _6299 _6300 _6301 _6302 _6303-> _term_1); (15,f) -> u f (\_6304 _6305-> _term_1); })))); (6,f) -> u f (\_6306 _6307 _6308-> _term_1); (7,f) -> u f (\_6309 _6310 _6311-> _term_1); (8,f) -> u f (\_6312 _6313 _6314-> _term_1); (9,f) -> u f (\_6315 _6316 _6317-> _term_1); (10,f) -> u f (\_6318-> _term_1); (11,f) -> u f (\_6319-> _term_1); (12,f) -> u f (\_6320-> _term_1); (13,f) -> u f (\_6321-> _term_1); (14,f) -> u f (\_6322 _6323 _6324 _6325 _6326 _6327-> _term_1); (15,f) -> u f (\_6328 _6329-> (u (u fm_term_inline_reduce _6329) _defs_2)); }))))
fm_term_inline = (\_term_1-> (\_defs_2-> (let _6330 = (u (u fm_term_inline_reduce _term_1) _defs_2) in (case _6330 of {(0,f) -> u f (\_6331 _6332-> (u (u fm_term_var _6331) _6332)); (1,f) -> u f (\_6333-> (u fm_term_ref _6333)); (2,f) -> u f (fm_term_typ); (3,f) -> u f (\_6334 _6335 _6336 _6337 _6338-> (u (u (u (u (u fm_term_all _6334) _6335) _6336) (u (u fm_term_inline _6337) _defs_2)) (\_s_8-> (\_x_9-> (u (u fm_term_inline (u (u _6338 _s_8) _x_9)) _defs_2))))); (4,f) -> u f (\_6339 _6340-> (u (u fm_term_lam _6339) (\_x_5-> (u (u fm_term_inline (u _6340 _x_5)) _defs_2)))); (5,f) -> u f (\_6341 _6342-> (u (u fm_term_app (u (u fm_term_inline _6341) _defs_2)) (u (u fm_term_inline _6342) _defs_2))); (6,f) -> u f (\_6343 _6344 _6345-> (u (u (u fm_term_let _6343) (u (u fm_term_inline _6344) _defs_2)) (\_x_6-> (u (u fm_term_inline (u _6345 _x_6)) _defs_2)))); (7,f) -> u f (\_6346 _6347 _6348-> (u (u (u fm_term_def _6346) (u (u fm_term_inline _6347) _defs_2)) (\_x_6-> (u (u fm_term_inline (u _6348 _x_6)) _defs_2)))); (8,f) -> u f (\_6349 _6350 _6351-> (u (u (u fm_term_ann _6349) (u (u fm_term_inline _6350) _defs_2)) (u (u fm_term_inline _6351) _defs_2))); (9,f) -> u f (\_6352 _6353 _6354-> (u (u (u fm_term_gol _6352) _6353) _6354)); (10,f) -> u f (\_6355-> (u fm_term_hol _6355)); (11,f) -> u f (\_6356-> (u fm_term_nat _6356)); (12,f) -> u f (\_6357-> (u fm_term_chr _6357)); (13,f) -> u f (\_6358-> (u fm_term_str _6358)); (14,f) -> u f (\_6359 _6360 _6361 _6362 _6363 _6364-> _term_1); (15,f) -> u f (\_6365 _6366-> (u (u fm_term_inline _6366) _defs_2)); }))))
map_values_go = (\_xs_2-> (\_list_3-> (let _6367 = _xs_2 in (case _6367 of {(0,f) -> u f (_list_3); (1,f) -> u f (\_6368 _6369 _6370-> (let _list0_7=(let _6371 = _6368 in (case _6371 of {(0,f) -> u f (_list_3); (1,f) -> u f (\_6372-> (u (u list_cons _6372) _list_3)); })) in (let _list1_8=(u (u map_values_go _6369) _list0_7) in (let _list2_9=(u (u map_values_go _6370) _list1_8) in _list2_9)))); }))))
map_values = (\_xs_2-> (u (u map_values_go _xs_2) list_nil))
fm_core_var_name = (\_indx_1-> (\_name_2-> (\_brui_3-> (\_vars_4-> (let _6373 = _indx_1 in (if _6373==0 then (let _6374 = _brui_3 in (if _6374==0 then _name_2 else (((_name_2::String) ++ ((("^"::String) ++ (u nat_show _brui_3))))))) else (let _6375 = _vars_4 in (case _6375 of {(0,f) -> u f ("unbound"); (1,f) -> u f (\_6376 _6377-> (let _brui_8=(let _6378 = (((_name_2::String) == _6376)) in (if _6378 then (u nat_succ _brui_3) else _brui_3)) in (u (u (u (u fm_core_var_name (_6373-1)) _name_2) _brui_8) _6377))); }))))))))
fm_name_show = (\_name_1-> _name_1)
bits_to_nat = (\_b_1-> (let _6379 = _b_1 in (case _6379 of {(0,f) -> u f (0); (1,f) -> u f (\_6380-> (((2::Integer) * (u bits_to_nat _6380)))); (2,f) -> u f (\_6381-> (u nat_succ (((2::Integer) * (u bits_to_nat _6381))))); })))
u16_show_hex = (\_a_1-> (let _6382 = _a_1 in (u (u nat_to_string_base 16) (u bits_to_nat (u word_to_bits (u16_to_word _6382))))))
fm_escape_char = (\_chr_1-> (let _6383 = (((_chr_1::Word16) == fm_backslash)) in (if _6383 then (u (u string_cons fm_backslash) (u (u string_cons _chr_1) string_nil)) else (let _6384 = (((_chr_1::Word16) == 34)) in (if _6384 then (u (u string_cons fm_backslash) (u (u string_cons _chr_1) string_nil)) else (let _6385 = (((_chr_1::Word16) == 39)) in (if _6385 then (u (u string_cons fm_backslash) (u (u string_cons _chr_1) string_nil)) else (let _6386 = (u (u (u u16_btw 32) _chr_1) 126) in (if _6386 then (u (u string_cons _chr_1) string_nil) else (u string_flatten (u (u list_cons (u (u string_cons fm_backslash) string_nil)) (u (u list_cons "u{") (u (u list_cons (u u16_show_hex _chr_1)) (u (u list_cons "}") (u (u list_cons string_nil) list_nil)))))))))))))))
fm_escape = (\_str_1-> (let _6387 = _str_1 in (if null (_6387::String) then string_nil else (let _head_4=(u fm_escape_char (fromIntegral (fromEnum (head _6387 :: Char)) :: Word16)) in (let _tail_5=(u fm_escape (tail _6387)) in (((_head_4::String) ++ _tail_5)))))))
fm_core_show = (\_term_1-> (\_indx_2-> (\_vars_3-> (let _6388 = _term_1 in (case _6388 of {(0,f) -> u f (\_6389 _6390-> (u (u (u (u fm_core_var_name (u nat_pred (((_indx_2::Integer) - _6390)))) _6389) 0) _vars_3)); (1,f) -> u f (\_6391-> (u fm_name_show _6391)); (2,f) -> u f ("*"); (3,f) -> u f (\_6392 _6393 _6394 _6395 _6396-> (let _eras_9=_6392 in (let _init_10=(let _6397 = _eras_9 in (if _6397 then "%" else "@")) in (let _self_11=(u fm_name_show _6393) in (let _name_12=(u fm_name_show _6394) in (let _xtyp_13=(u (u (u fm_core_show _6395) _indx_2) _vars_3) in (let _body_14=(u (u (u fm_core_show (u (u _6396 (u (u fm_term_var _6393) _indx_2)) (u (u fm_term_var _6394) (u nat_succ _indx_2)))) (u nat_succ (u nat_succ _indx_2))) (u (u list_cons _6394) (u (u list_cons _6393) _vars_3))) in (u string_flatten (u (u list_cons _init_10) (u (u list_cons _self_11) (u (u list_cons "(") (u (u list_cons _name_12) (u (u list_cons ":") (u (u list_cons _xtyp_13) (u (u list_cons ") ") (u (u list_cons _body_14) list_nil)))))))))))))))); (4,f) -> u f (\_6398 _6399-> (let _name_6=(u fm_name_show _6398) in (let _body_7=(u (u (u fm_core_show (u _6399 (u (u fm_term_var _6398) _indx_2))) (u nat_succ _indx_2)) (u (u list_cons _6398) _vars_3)) in (u string_flatten (u (u list_cons "#") (u (u list_cons _name_6) (u (u list_cons " ") (u (u list_cons _body_7) list_nil)))))))); (5,f) -> u f (\_6400 _6401-> (let _func_6=(u (u (u fm_core_show _6400) _indx_2) _vars_3) in (let _argm_7=(u (u (u fm_core_show _6401) _indx_2) _vars_3) in (u string_flatten (u (u list_cons "(") (u (u list_cons _func_6) (u (u list_cons " ") (u (u list_cons _argm_7) (u (u list_cons ")") list_nil))))))))); (6,f) -> u f (\_6402 _6403 _6404-> (let _name_7=(u fm_name_show _6402) in (let _expr_8=(u (u (u fm_core_show _6403) _indx_2) _vars_3) in (let _body_9=(u (u (u fm_core_show (u _6404 (u (u fm_term_var _6402) _indx_2))) (u nat_succ _indx_2)) (u (u list_cons _6402) _vars_3)) in (u string_flatten (u (u list_cons "!") (u (u list_cons _name_7) (u (u list_cons " = ") (u (u list_cons _expr_8) (u (u list_cons "; ") (u (u list_cons _body_9) list_nil))))))))))); (7,f) -> u f (\_6405 _6406 _6407-> (let _name_7=(u fm_name_show _6405) in (let _expr_8=(u (u (u fm_core_show _6406) _indx_2) _vars_3) in (let _body_9=(u (u (u fm_core_show (u _6407 (u (u fm_term_var _6405) _indx_2))) (u nat_succ _indx_2)) (u (u list_cons _6405) _vars_3)) in (u string_flatten (u (u list_cons "$") (u (u list_cons _name_7) (u (u list_cons " = ") (u (u list_cons _expr_8) (u (u list_cons "; ") (u (u list_cons _body_9) list_nil))))))))))); (8,f) -> u f (\_6408 _6409 _6410-> (let _term_7=(u (u (u fm_core_show _6409) _indx_2) _vars_3) in (let _type_8=(u (u (u fm_core_show _6410) _indx_2) _vars_3) in (u string_flatten (u (u list_cons "{") (u (u list_cons _term_7) (u (u list_cons ":") (u (u list_cons _type_8) (u (u list_cons "}") list_nil))))))))); (9,f) -> u f (\_6411 _6412 _6413-> "<GOL>"); (10,f) -> u f (\_6414-> "<HOL>"); (11,f) -> u f (\_6415-> (u string_flatten (u (u list_cons "+") (u (u list_cons (u nat_show _6415)) list_nil)))); (12,f) -> u f (\_6416-> (u string_flatten (u (u list_cons "'") (u (u list_cons (u fm_escape_char _6416)) (u (u list_cons "'") list_nil))))); (13,f) -> u f (\_6417-> (u string_flatten (u (u list_cons "\"") (u (u list_cons (u fm_escape _6417)) (u (u list_cons "\"") list_nil))))); (14,f) -> u f (\_6418 _6419 _6420 _6421 _6422 _6423-> "<CSE>"); (15,f) -> u f (\_6424 _6425-> (u (u (u fm_core_show _6425) _indx_2) _vars_3)); })))))
fm_defs_core = (\_defs_1-> (let _result_2="" in (let _result_3=(u (u (u list_for (u map_values _defs_1)) _result_2) (\_defn_3-> (\_result_4-> (let _6426 = _defn_3 in (case _6426 of {(0,f) -> u f (\_6427 _6428 _6429 _6430 _6431 _6432 _6433 _6434 _6435-> (let _6436 = _6435 in (case _6436 of {(0,f) -> u f (_result_4); (1,f) -> u f (_result_4); (2,f) -> u f ((let _name_14=_6430 in (let _term_15=(u (u (u fm_core_show _6431) 0) list_nil) in (let _type_16=(u (u (u fm_core_show _6432) 0) list_nil) in (u string_flatten (u (u list_cons _result_4) (u (u list_cons _name_14) (u (u list_cons " : ") (u (u list_cons _type_16) (u (u list_cons " = ") (u (u list_cons _term_15) (u (u list_cons ";\n") list_nil)))))))))))); (3,f) -> u f (\_6437-> _result_4); }))); }))))) in _result_3)))
fm_to_core_io_one = (\_name_1-> (u (u (u io_monad (\_m_bind_2-> (\_m_pure_3-> _m_bind_2))) (u (u fm_synth_one _name_1) map_new)) (\_new_defs_2-> (let _defs_3=(let _6438 = _new_defs_2 in (case _6438 of {(0,f) -> u f (map_new); (1,f) -> u f (\_6439-> _6439); })) in (let _defs_4=(u (u map_map (\_defn_4-> (let _6440 = _defn_4 in (case _6440 of {(0,f) -> u f (\_6441 _6442 _6443 _6444 _6445 _6446 _6447 _6448 _6449-> (let _term_14=(u (u fm_term_inline _6445) _defs_3) in (let _type_15=(u (u fm_term_inline _6446) _defs_3) in (u (u (u (u (u (u (u (u (u fm_def_new _6441) _6442) _6443) _6444) _term_14) _type_15) _6447) _6448) _6449)))); })))) _defs_3) in (u (u io_monad (\_m_bind_5-> (\_m_pure_6-> _m_pure_6))) (u fm_defs_core _defs_4)))))))
io_print = (\_text_1-> (u (u (u io_ask "print") _text_1) (\_skip_2-> (u io_end unit_new))))
maybe_bind = (\_m_3-> (\_f_4-> (let _6450 = _m_3 in (case _6450 of {(0,f) -> u f (maybe_none); (1,f) -> u f (\_6451-> (u _f_4 _6451)); }))))
maybe_monad = (\_new_2-> (u (u _new_2 maybe_bind) maybe_some))
fm_term_show_as_nat_go = (\_term_1-> (let _6452 = _term_1 in (case _6452 of {(0,f) -> u f (\_6453 _6454-> maybe_none); (1,f) -> u f (\_6455-> (let _6456 = (((_6455::String) == "Nat.zero")) in (if _6456 then (u maybe_some 0) else maybe_none))); (2,f) -> u f (maybe_none); (3,f) -> u f (\_6457 _6458 _6459 _6460 _6461-> maybe_none); (4,f) -> u f (\_6462 _6463-> maybe_none); (5,f) -> u f (\_6464 _6465-> (let _6466 = _6464 in (case _6466 of {(0,f) -> u f (\_6467 _6468-> maybe_none); (1,f) -> u f (\_6469-> (let _6470 = (((_6469::String) == "Nat.succ")) in (if _6470 then (u (u (u maybe_monad (\_m_bind_5-> (\_m_pure_6-> _m_bind_5))) (u fm_term_show_as_nat_go _6465)) (\_pred_5-> (u (u maybe_monad (\_m_bind_6-> (\_m_pure_7-> _m_pure_7))) (u nat_succ _pred_5)))) else maybe_none))); (2,f) -> u f (maybe_none); (3,f) -> u f (\_6471 _6472 _6473 _6474 _6475-> maybe_none); (4,f) -> u f (\_6476 _6477-> maybe_none); (5,f) -> u f (\_6478 _6479-> maybe_none); (6,f) -> u f (\_6480 _6481 _6482-> maybe_none); (7,f) -> u f (\_6483 _6484 _6485-> maybe_none); (8,f) -> u f (\_6486 _6487 _6488-> maybe_none); (9,f) -> u f (\_6489 _6490 _6491-> maybe_none); (10,f) -> u f (\_6492-> maybe_none); (11,f) -> u f (\_6493-> maybe_none); (12,f) -> u f (\_6494-> maybe_none); (13,f) -> u f (\_6495-> maybe_none); (14,f) -> u f (\_6496 _6497 _6498 _6499 _6500 _6501-> maybe_none); (15,f) -> u f (\_6502 _6503-> maybe_none); }))); (6,f) -> u f (\_6504 _6505 _6506-> maybe_none); (7,f) -> u f (\_6507 _6508 _6509-> maybe_none); (8,f) -> u f (\_6510 _6511 _6512-> maybe_none); (9,f) -> u f (\_6513 _6514 _6515-> maybe_none); (10,f) -> u f (\_6516-> maybe_none); (11,f) -> u f (\_6517-> maybe_none); (12,f) -> u f (\_6518-> maybe_none); (13,f) -> u f (\_6519-> maybe_none); (14,f) -> u f (\_6520 _6521 _6522 _6523 _6524 _6525-> maybe_none); (15,f) -> u f (\_6526 _6527-> maybe_none); })))
fm_term_show_as_nat = (\_term_1-> (u (u maybe_mapped (u fm_term_show_as_nat_go _term_1)) nat_show))
fm_term_show_is_ref = (\_term_1-> (\_name_2-> (let _6528 = _term_1 in (case _6528 of {(0,f) -> u f (\_6529 _6530-> bool_false); (1,f) -> u f (\_6531-> (((_name_2::String) == _6531))); (2,f) -> u f (bool_false); (3,f) -> u f (\_6532 _6533 _6534 _6535 _6536-> bool_false); (4,f) -> u f (\_6537 _6538-> bool_false); (5,f) -> u f (\_6539 _6540-> bool_false); (6,f) -> u f (\_6541 _6542 _6543-> bool_false); (7,f) -> u f (\_6544 _6545 _6546-> bool_false); (8,f) -> u f (\_6547 _6548 _6549-> bool_false); (9,f) -> u f (\_6550 _6551 _6552-> bool_false); (10,f) -> u f (\_6553-> bool_false); (11,f) -> u f (\_6554-> bool_false); (12,f) -> u f (\_6555-> bool_false); (13,f) -> u f (\_6556-> bool_false); (14,f) -> u f (\_6557 _6558 _6559 _6560 _6561 _6562-> bool_false); (15,f) -> u f (\_6563 _6564-> bool_false); }))))
fm_term_show_app_done = (\_term_1-> (\_path_2-> (\_args_3-> (let _arity_4=(u list_length _args_3) in (let _6565 = (((u (u fm_term_show_is_ref _term_1) "Equal") && (((_arity_4::Integer) == 3)))) in (if _6565 then (let _func_5=(u (u fm_term_show_go _term_1) _path_2) in (let _eq_lft_6=(u (u maybe_default "?") (u (u list_at 1) _args_3)) in (let _eq_rgt_7=(u (u maybe_default "?") (u (u list_at 2) _args_3)) in (u string_flatten (u (u list_cons _eq_lft_6) (u (u list_cons " == ") (u (u list_cons _eq_rgt_7) list_nil))))))) else (let _func_5=(u (u fm_term_show_go _term_1) _path_2) in (let _wrap_6=(let _6566 = _func_5 in (if null (_6566::String) then bool_false else ((((fromIntegral (fromEnum (head _6566 :: Char)) :: Word16)::Word16) == 40)))) in (let _args_7=(u (u string_join ",") _args_3) in (let _func_8=(let _6567 = _wrap_6 in (if _6567 then (u string_flatten (u (u list_cons "(") (u (u list_cons _func_5) (u (u list_cons ")") list_nil)))) else _func_5)) in (u string_flatten (u (u list_cons _func_8) (u (u list_cons "(") (u (u list_cons _args_7) (u (u list_cons ")") list_nil)))))))))))))))
fm_term_show_app = (\_term_1-> (\_path_2-> (\_args_3-> (let _6568 = _term_1 in (case _6568 of {(0,f) -> u f (\_6569 _6570-> (u (u (u fm_term_show_app_done _term_1) _path_2) _args_3)); (1,f) -> u f (\_6571-> (u (u (u fm_term_show_app_done _term_1) _path_2) _args_3)); (2,f) -> u f ((u (u (u fm_term_show_app_done _term_1) _path_2) _args_3)); (3,f) -> u f (\_6572 _6573 _6574 _6575 _6576-> (u (u (u fm_term_show_app_done _term_1) _path_2) _args_3)); (4,f) -> u f (\_6577 _6578-> (u (u (u fm_term_show_app_done _term_1) _path_2) _args_3)); (5,f) -> u f (\_6579 _6580-> (u (u (u fm_term_show_app _6579) (u fm_mpath_o _path_2)) (u (u list_cons (u (u fm_term_show_go _6580) (u fm_mpath_i _path_2))) _args_3))); (6,f) -> u f (\_6581 _6582 _6583-> (u (u (u fm_term_show_app_done _term_1) _path_2) _args_3)); (7,f) -> u f (\_6584 _6585 _6586-> (u (u (u fm_term_show_app_done _term_1) _path_2) _args_3)); (8,f) -> u f (\_6587 _6588 _6589-> (u (u (u fm_term_show_app_done _term_1) _path_2) _args_3)); (9,f) -> u f (\_6590 _6591 _6592-> (u (u (u fm_term_show_app_done _term_1) _path_2) _args_3)); (10,f) -> u f (\_6593-> (u (u (u fm_term_show_app_done _term_1) _path_2) _args_3)); (11,f) -> u f (\_6594-> (u (u (u fm_term_show_app_done _term_1) _path_2) _args_3)); (12,f) -> u f (\_6595-> (u (u (u fm_term_show_app_done _term_1) _path_2) _args_3)); (13,f) -> u f (\_6596-> (u (u (u fm_term_show_app_done _term_1) _path_2) _args_3)); (14,f) -> u f (\_6597 _6598 _6599 _6600 _6601 _6602-> (u (u (u fm_term_show_app_done _term_1) _path_2) _args_3)); (15,f) -> u f (\_6603 _6604-> (u (u (u fm_term_show_app _6604) _path_2) _args_3)); })))))
map_to_list_go = (\_xs_2-> (\_key_3-> (\_list_4-> (let _6605 = _xs_2 in (case _6605 of {(0,f) -> u f (_list_4); (1,f) -> u f (\_6606 _6607 _6608-> (let _list0_8=(let _6609 = _6606 in (case _6609 of {(0,f) -> u f (_list_4); (1,f) -> u f (\_6610-> (u (u list_cons (u (u pair_new (u bits_reverse _key_3)) _6610)) _list_4)); })) in (let _list1_9=(u (u (u map_to_list_go _6607) (u bits_o _key_3)) _list0_8) in (let _list2_10=(u (u (u map_to_list_go _6608) (u bits_i _key_3)) _list1_9) in _list2_10)))); })))))
map_to_list = (\_xs_2-> (u list_reverse (u (u (u map_to_list_go _xs_2) bits_e) list_nil)))
bits_chunks_of_go = (\_len_1-> (\_bits_2-> (\_need_3-> (\_chunk_4-> (let _6611 = _bits_2 in (case _6611 of {(0,f) -> u f ((u (u list_cons (u bits_reverse _chunk_4)) list_nil)); (1,f) -> u f (\_6612-> (let _6613 = _need_3 in (if _6613==0 then (let _head_6=(u bits_reverse _chunk_4) in (let _tail_7=(u (u (u (u bits_chunks_of_go _len_1) _bits_2) _len_1) bits_e) in (u (u list_cons _head_6) _tail_7))) else (let _chunk_7=(u bits_o _chunk_4) in (u (u (u (u bits_chunks_of_go _len_1) _6612) (_6613-1)) _chunk_7))))); (2,f) -> u f (\_6614-> (let _6615 = _need_3 in (if _6615==0 then (let _head_6=(u bits_reverse _chunk_4) in (let _tail_7=(u (u (u (u bits_chunks_of_go _len_1) _bits_2) _len_1) bits_e) in (u (u list_cons _head_6) _tail_7))) else (let _chunk_7=(u bits_i _chunk_4) in (u (u (u (u bits_chunks_of_go _len_1) _6614) (_6615-1)) _chunk_7))))); }))))))
bits_chunks_of = (\_len_1-> (\_bits_2-> (u (u (u (u bits_chunks_of_go _len_1) _bits_2) _len_1) bits_e)))
word_from_bits = (\_size_1-> (\_bits_2-> (let _6616 = _size_1 in (if _6616==0 then word_e else (let _6617 = _bits_2 in (case _6617 of {(0,f) -> u f ((u word_o (u (u word_from_bits (_6616-1)) bits_e))); (1,f) -> u f (\_6618-> (u word_o (u (u word_from_bits (_6616-1)) _6618))); (2,f) -> u f (\_6619-> (u word_i (u (u word_from_bits (_6616-1)) _6619))); }))))))
fm_name_from_bits = (\_bits_1-> (let _list_2=(u (u bits_chunks_of 6) _bits_1) in (let _name_3=(u (u (u list_fold _list_2) string_nil) (\_bts_3-> (\_name_4-> (let _u16_5=(u u16_new (u (u word_from_bits 16) (u bits_reverse _bts_3))) in (let _chr_6=(let _6620 = (u (u (u u16_btw 0) _u16_5) 25) in (if _6620 then (((_u16_5::Word16) + 65)) else (let _6621 = (u (u (u u16_btw 26) _u16_5) 51) in (if _6621 then (((_u16_5::Word16) + 71)) else (let _6622 = (u (u (u u16_btw 52) _u16_5) 61) in (if _6622 then (((_u16_5::Word16) - 4)) else (let _6623 = (((62::Word16) == _u16_5)) in (if _6623 then 46 else 95)))))))) in (u (u string_cons _chr_6) _name_4)))))) in _name_3)))
fm_term_show_go = (\_term_1-> (\_path_2-> (let _6624 = (u fm_term_show_as_nat _term_1) in (case _6624 of {(0,f) -> u f ((let _6625 = _term_1 in (case _6625 of {(0,f) -> u f (\_6626 _6627-> (u fm_name_show _6626)); (1,f) -> u f (\_6628-> (let _name_4=(u fm_name_show _6628) in (let _6629 = _path_2 in (case _6629 of {(0,f) -> u f (_name_4); (1,f) -> u f (\_6630-> (let _path_val_6=(u (u bits_concat (u fm_path_to_bits _6630)) (u bits_i bits_e)) in (let _path_str_7=(u nat_show (u bits_to_nat _path_val_6)) in (u string_flatten (u (u list_cons _name_4) (u (u list_cons (u (u fm_color "2") ((("-"::String) ++ _path_str_7)))) list_nil)))))); })))); (2,f) -> u f ("Type"); (3,f) -> u f (\_6631 _6632 _6633 _6634 _6635-> (let _eras_8=_6631 in (let _self_9=(u fm_name_show _6632) in (let _name_10=(u fm_name_show _6633) in (let _type_11=(u (u fm_term_show_go _6634) (u fm_mpath_o _path_2)) in (let _open_12=(let _6636 = _eras_8 in (if _6636 then "<" else "(")) in (let _clos_13=(let _6637 = _eras_8 in (if _6637 then ">" else ")")) in (let _body_14=(u (u fm_term_show_go (u (u _6635 (u (u fm_term_var _6632) 0)) (u (u fm_term_var _6633) 0))) (u fm_mpath_i _path_2)) in (u string_flatten (u (u list_cons _self_9) (u (u list_cons _open_12) (u (u list_cons _name_10) (u (u list_cons ":") (u (u list_cons _type_11) (u (u list_cons _clos_13) (u (u list_cons " ") (u (u list_cons _body_14) list_nil))))))))))))))))); (4,f) -> u f (\_6638 _6639-> (let _name_5=(u fm_name_show _6638) in (let _body_6=(u (u fm_term_show_go (u _6639 (u (u fm_term_var _6638) 0))) (u fm_mpath_o _path_2)) in (u string_flatten (u (u list_cons "(") (u (u list_cons _name_5) (u (u list_cons ") ") (u (u list_cons _body_6) list_nil)))))))); (5,f) -> u f (\_6640 _6641-> (u (u (u fm_term_show_app _term_1) _path_2) list_nil)); (6,f) -> u f (\_6642 _6643 _6644-> (let _name_6=(u fm_name_show _6642) in (let _expr_7=(u (u fm_term_show_go _6643) (u fm_mpath_o _path_2)) in (let _body_8=(u (u fm_term_show_go (u _6644 (u (u fm_term_var _6642) 0))) (u fm_mpath_i _path_2)) in (u string_flatten (u (u list_cons "let ") (u (u list_cons _name_6) (u (u list_cons " = ") (u (u list_cons _expr_7) (u (u list_cons "; ") (u (u list_cons _body_8) list_nil))))))))))); (7,f) -> u f (\_6645 _6646 _6647-> (let _name_6=(u fm_name_show _6645) in (let _expr_7=(u (u fm_term_show_go _6646) (u fm_mpath_o _path_2)) in (let _body_8=(u (u fm_term_show_go (u _6647 (u (u fm_term_var _6645) 0))) (u fm_mpath_i _path_2)) in (u string_flatten (u (u list_cons "def ") (u (u list_cons _name_6) (u (u list_cons " = ") (u (u list_cons _expr_7) (u (u list_cons "; ") (u (u list_cons _body_8) list_nil))))))))))); (8,f) -> u f (\_6648 _6649 _6650-> (let _term_6=(u (u fm_term_show_go _6649) (u fm_mpath_o _path_2)) in (let _type_7=(u (u fm_term_show_go _6650) (u fm_mpath_i _path_2)) in (u string_flatten (u (u list_cons _term_6) (u (u list_cons "::") (u (u list_cons _type_7) list_nil))))))); (9,f) -> u f (\_6651 _6652 _6653-> (let _name_6=(u fm_name_show _6651) in (u string_flatten (u (u list_cons "?") (u (u list_cons _name_6) list_nil))))); (10,f) -> u f (\_6654-> "_"); (11,f) -> u f (\_6655-> (u string_flatten (u (u list_cons (u nat_show _6655)) list_nil))); (12,f) -> u f (\_6656-> (u string_flatten (u (u list_cons "'") (u (u list_cons (u fm_escape_char _6656)) (u (u list_cons "'") list_nil))))); (13,f) -> u f (\_6657-> (u string_flatten (u (u list_cons "\"") (u (u list_cons (u fm_escape _6657)) (u (u list_cons "\"") list_nil))))); (14,f) -> u f (\_6658 _6659 _6660 _6661 _6662 _6663-> (let _expr_9=(u (u fm_term_show_go _6659) (u fm_mpath_o _path_2)) in (let _name_10=(u fm_name_show _6660) in (let _wyth_11=(u (u string_join "") (u (u list_mapped _6661) (\_defn_11-> (let _6664 = _defn_11 in (case _6664 of {(0,f) -> u f (\_6665 _6666 _6667 _6668 _6669 _6670 _6671 _6672 _6673-> (let _name_21=(u fm_name_show _6668) in (let _type_22=(u (u fm_term_show_go _6670) maybe_none) in (let _term_23=(u (u fm_term_show_go _6669) maybe_none) in (u string_flatten (u (u list_cons _name_21) (u (u list_cons ": ") (u (u list_cons _type_22) (u (u list_cons " = ") (u (u list_cons _term_23) (u (u list_cons ";") list_nil))))))))))); }))))) in (let _cses_12=(u map_to_list _6662) in (let _cses_13=(u (u string_join "") (u (u list_mapped _cses_12) (\_x_13-> (let _name_14=(u fm_name_from_bits (u pair_fst _x_13)) in (let _term_15=(u (u fm_term_show_go (u pair_snd _x_13)) maybe_none) in (u string_flatten (u (u list_cons _name_14) (u (u list_cons ": ") (u (u list_cons _term_15) (u (u list_cons "; ") list_nil)))))))))) in (let _moti_14=(let _6674 = _6663 in (case _6674 of {(0,f) -> u f (""); (1,f) -> u f (\_6675-> (u string_flatten (u (u list_cons ": ") (u (u list_cons (u (u fm_term_show_go _6675) maybe_none)) list_nil)))); })) in (u string_flatten (u (u list_cons "case ") (u (u list_cons _expr_9) (u (u list_cons " as ") (u (u list_cons _name_10) (u (u list_cons _wyth_11) (u (u list_cons " { ") (u (u list_cons _cses_13) (u (u list_cons "}") (u (u list_cons _moti_14) list_nil))))))))))))))))); (15,f) -> u f (\_6676 _6677-> (u (u fm_term_show_go _6677) _path_2)); }))); (1,f) -> u f (\_6678-> _6678); }))))
fm_term_show = (\_term_1-> (u (u fm_term_show_go _term_1) maybe_none))
fm_defs_report_types = (\_defs_1-> (\_names_2-> (let _types_3="" in (let _types_4=(u (u (u list_for _names_2) _types_3) (\_name_4-> (\_types_5-> (let _6679 = (u (u fm_get _name_4) _defs_1) in (case _6679 of {(0,f) -> u f (_types_5); (1,f) -> u f (\_6680-> (let _6681 = _6680 in (case _6681 of {(0,f) -> u f (\_6682 _6683 _6684 _6685 _6686 _6687 _6688 _6689 _6690-> (((_types_5::String) ++ (((_name_4::String) ++ (((": "::String) ++ ((((u fm_term_show _6687)::String) ++ "\n"))))))))); }))); }))))) in _types_4))))
map_keys_go = (\_xs_2-> (\_key_3-> (\_list_4-> (let _6691 = _xs_2 in (case _6691 of {(0,f) -> u f (_list_4); (1,f) -> u f (\_6692 _6693 _6694-> (let _list0_8=(let _6695 = _6692 in (case _6695 of {(0,f) -> u f (_list_4); (1,f) -> u f (\_6696-> (u (u list_cons (u bits_reverse _key_3)) _list_4)); })) in (let _list1_9=(u (u (u map_keys_go _6693) (u bits_o _key_3)) _list0_8) in (let _list2_10=(u (u (u map_keys_go _6694) (u bits_i _key_3)) _list1_9) in _list2_10)))); })))))
map_keys = (\_xs_2-> (u list_reverse (u (u (u map_keys_go _xs_2) bits_e) list_nil)))
fm_error_relevant = (\_errors_1-> (\_got_2-> (let _6697 = _errors_1 in (case _6697 of {(0,f) -> u f (list_nil); (1,f) -> u f (\_6698 _6699-> (let _keep_5=(let _6700 = _6698 in (case _6700 of {(0,f) -> u f (\_6701 _6702 _6703 _6704-> ((not _got_2))); (1,f) -> u f (\_6705 _6706 _6707 _6708 _6709-> bool_true); (2,f) -> u f (\_6710-> bool_false); (3,f) -> u f (\_6711-> bool_false); (4,f) -> u f (\_6712 _6713-> bool_false); (5,f) -> u f (\_6714 _6715-> ((not _got_2))); (6,f) -> u f (\_6716 _6717 _6718-> ((not _got_2))); })) in (let _got_6=(let _6719 = _6698 in (case _6719 of {(0,f) -> u f (\_6720 _6721 _6722 _6723-> bool_true); (1,f) -> u f (\_6724 _6725 _6726 _6727 _6728-> _got_2); (2,f) -> u f (\_6729-> _got_2); (3,f) -> u f (\_6730-> _got_2); (4,f) -> u f (\_6731 _6732-> _got_2); (5,f) -> u f (\_6733 _6734-> bool_true); (6,f) -> u f (\_6735 _6736 _6737-> _got_2); })) in (let _tail_7=(u (u fm_error_relevant _6699) _got_6) in (let _6738 = _keep_5 in (if _6738 then (u (u list_cons _6698) _tail_7) else _tail_7)))))); }))))
fm_context_show = (\_context_1-> (let _6739 = _context_1 in (case _6739 of {(0,f) -> u f (""); (1,f) -> u f (\_6740 _6741-> (let _6742 = _6740 in (case _6742 of {(0,f) -> u f (\_6743 _6744-> (let _name_6=(u fm_name_show _6743) in (let _type_7=(u fm_term_show (u (u fm_term_normalize _6744) map_new)) in (let _rest_8=(u fm_context_show _6741) in (u string_flatten (u (u list_cons _rest_8) (u (u list_cons "- ") (u (u list_cons _name_6) (u (u list_cons ": ") (u (u list_cons _type_7) (u (u list_cons "\n") list_nil))))))))))); }))); })))
fm_term_expand_at = (\_path_1-> (\_term_2-> (\_defs_3-> (u (u (u fm_term_patch_at _path_1) _term_2) (\_term_4-> (let _6745 = _term_4 in (case _6745 of {(0,f) -> u f (\_6746 _6747-> _term_4); (1,f) -> u f (\_6748-> (let _6749 = (u (u fm_get _6748) _defs_3) in (case _6749 of {(0,f) -> u f ((u fm_term_ref _6748)); (1,f) -> u f (\_6750-> (let _6751 = _6750 in (case _6751 of {(0,f) -> u f (\_6752 _6753 _6754 _6755 _6756 _6757 _6758 _6759 _6760-> _6756); }))); }))); (2,f) -> u f (_term_4); (3,f) -> u f (\_6761 _6762 _6763 _6764 _6765-> _term_4); (4,f) -> u f (\_6766 _6767-> _term_4); (5,f) -> u f (\_6768 _6769-> _term_4); (6,f) -> u f (\_6770 _6771 _6772-> _term_4); (7,f) -> u f (\_6773 _6774 _6775-> _term_4); (8,f) -> u f (\_6776 _6777 _6778-> _term_4); (9,f) -> u f (\_6779 _6780 _6781-> _term_4); (10,f) -> u f (\_6782-> _term_4); (11,f) -> u f (\_6783-> _term_4); (12,f) -> u f (\_6784-> _term_4); (13,f) -> u f (\_6785-> _term_4); (14,f) -> u f (\_6786 _6787 _6788 _6789 _6790 _6791-> _term_4); (15,f) -> u f (\_6792 _6793-> _term_4); })))))))
fm_term_expand_ct = (\_term_1-> (\_defs_2-> (\_arity_3-> (let _6794 = _term_1 in (case _6794 of {(0,f) -> u f (\_6795 _6796-> (u (u fm_term_var _6795) _6796)); (1,f) -> u f (\_6797-> (let _6798 = (u (u fm_get _6797) _defs_2) in (case _6798 of {(0,f) -> u f ((u fm_term_ref _6797)); (1,f) -> u f (\_6799-> (let _6800 = _6799 in (case _6800 of {(0,f) -> u f (\_6801 _6802 _6803 _6804 _6805 _6806 _6807 _6808 _6809-> (let _6810 = ((_6807 && (((_arity_3::Integer) > _6808)))) in (if _6810 then _6805 else (u fm_term_ref _6797)))); }))); }))); (2,f) -> u f (fm_term_typ); (3,f) -> u f (\_6811 _6812 _6813 _6814 _6815-> (u (u (u (u (u fm_term_all _6811) _6812) _6813) (u (u (u fm_term_expand_ct _6814) _defs_2) 0)) (\_s_9-> (\_x_10-> (u (u (u fm_term_expand_ct (u (u _6815 _s_9) _x_10)) _defs_2) 0))))); (4,f) -> u f (\_6816 _6817-> (u (u fm_term_lam _6816) (\_x_6-> (u (u (u fm_term_expand_ct (u _6817 _x_6)) _defs_2) 0)))); (5,f) -> u f (\_6818 _6819-> (u (u fm_term_app (u (u (u fm_term_expand_ct _6818) _defs_2) (u nat_succ _arity_3))) (u (u (u fm_term_expand_ct _6819) _defs_2) 0))); (6,f) -> u f (\_6820 _6821 _6822-> (u (u (u fm_term_let _6820) (u (u (u fm_term_expand_ct _6821) _defs_2) 0)) (\_x_7-> (u (u (u fm_term_expand_ct (u _6822 _x_7)) _defs_2) 0)))); (7,f) -> u f (\_6823 _6824 _6825-> (u (u (u fm_term_def _6823) (u (u (u fm_term_expand_ct _6824) _defs_2) 0)) (\_x_7-> (u (u (u fm_term_expand_ct (u _6825 _x_7)) _defs_2) 0)))); (8,f) -> u f (\_6826 _6827 _6828-> (u (u (u fm_term_ann _6826) (u (u (u fm_term_expand_ct _6827) _defs_2) 0)) (u (u (u fm_term_expand_ct _6828) _defs_2) 0))); (9,f) -> u f (\_6829 _6830 _6831-> (u (u (u fm_term_gol _6829) _6830) _6831)); (10,f) -> u f (\_6832-> (u fm_term_hol _6832)); (11,f) -> u f (\_6833-> (u fm_term_nat _6833)); (12,f) -> u f (\_6834-> (u fm_term_chr _6834)); (13,f) -> u f (\_6835-> (u fm_term_str _6835)); (14,f) -> u f (\_6836 _6837 _6838 _6839 _6840 _6841-> _term_1); (15,f) -> u f (\_6842 _6843-> (u (u fm_term_ori _6842) _6843)); })))))
fm_term_expand = (\_dref_1-> (\_term_2-> (\_defs_3-> (let _term_4=(u (u fm_term_normalize _term_2) map_new) in (let _term_5=(u (u (u list_for _dref_1) _term_4) (\_path_5-> (\_term_6-> (let _term_7=(u (u (u fm_term_expand_at _path_5) _term_6) _defs_3) in (let _term_8=(u (u fm_term_normalize _term_7) map_new) in (let _term_9=(u (u (u fm_term_expand_ct _term_8) _defs_3) 0) in (let _term_10=(u (u fm_term_normalize _term_9) map_new) in _term_10))))))) in _term_5)))))
fm_error_show = (\_error_1-> (\_defs_2-> (let _6844 = _error_1 in (case _6844 of {(0,f) -> u f (\_6845 _6846 _6847 _6848-> (let _expected_7=(let _6849 = _6846 in (case _6849 of {(0,f) -> u f (\_6850-> _6850); (1,f) -> u f (\_6851-> (u fm_term_show (u (u fm_term_normalize _6851) map_new))); })) in (let _detected_8=(let _6852 = _6847 in (case _6852 of {(0,f) -> u f (\_6853-> _6853); (1,f) -> u f (\_6854-> (u fm_term_show (u (u fm_term_normalize _6854) map_new))); })) in (u string_flatten (u (u list_cons "Type mismatch.\n") (u (u list_cons "- Expected: ") (u (u list_cons _expected_7) (u (u list_cons "\n") (u (u list_cons "- Detected: ") (u (u list_cons _detected_8) (u (u list_cons "\n") (u (u list_cons (let _6855 = _6848 in (case _6855 of {(0,f) -> u f (""); (1,f) -> u f (\_6856 _6857-> (u string_flatten (u (u list_cons "With context:\n") (u (u list_cons (u fm_context_show _6848)) list_nil)))); }))) list_nil)))))))))))); (1,f) -> u f (\_6858 _6859 _6860 _6861 _6862-> (let _goal_name_8=(u string_flatten (u (u list_cons "Goal ?") (u (u list_cons (u fm_name_show _6858)) (u (u list_cons ":\n") list_nil)))) in (let _with_type_9=(let _6863 = _6861 in (case _6863 of {(0,f) -> u f (""); (1,f) -> u f (\_6864-> (let _goal_10=(u (u (u fm_term_expand _6859) _6864) _defs_2) in (u string_flatten (u (u list_cons "With type: ") (u (u list_cons (let _6865 = _6860 in (if _6865 then (u (u fm_term_show_go _goal_10) (u maybe_some (\_x_11-> _x_11))) else (u fm_term_show _goal_10)))) (u (u list_cons "\n") list_nil)))))); })) in (let _with_ctxt_10=(let _6866 = _6862 in (case _6866 of {(0,f) -> u f (""); (1,f) -> u f (\_6867 _6868-> (u string_flatten (u (u list_cons "With ctxt:\n") (u (u list_cons (u fm_context_show _6862)) list_nil)))); })) in (u string_flatten (u (u list_cons _goal_name_8) (u (u list_cons _with_type_9) (u (u list_cons _with_ctxt_10) list_nil)))))))); (2,f) -> u f (\_6869-> (u string_flatten (u (u list_cons "Waiting for '") (u (u list_cons _6869) (u (u list_cons "'.") list_nil))))); (3,f) -> u f (\_6870-> (u string_flatten (u (u list_cons "Error on dependency '") (u (u list_cons _6870) (u (u list_cons "'.") list_nil))))); (4,f) -> u f (\_6871 _6872-> (u string_flatten (u (u list_cons "Patching: ") (u (u list_cons (u fm_term_show _6872)) list_nil)))); (5,f) -> u f (\_6873 _6874-> (u string_flatten (u (u list_cons "Undefined reference: ") (u (u list_cons (u fm_name_show _6874)) (u (u list_cons "\n") list_nil))))); (6,f) -> u f (\_6875 _6876 _6877-> (let _term_6=(u fm_term_show _6876) in (let _context_7=(u fm_context_show _6877) in (u string_flatten (u (u list_cons "Can't infer type of: ") (u (u list_cons _term_6) (u (u list_cons "\n") (u (u list_cons "With ctxt:\n") (u (u list_cons _context_7) list_nil))))))))); }))))
fm_error_origin = (\_error_1-> (let _6878 = _error_1 in (case _6878 of {(0,f) -> u f (\_6879 _6880 _6881 _6882-> _6879); (1,f) -> u f (\_6883 _6884 _6885 _6886 _6887-> maybe_none); (2,f) -> u f (\_6888-> maybe_none); (3,f) -> u f (\_6889-> maybe_none); (4,f) -> u f (\_6890 _6891-> maybe_none); (5,f) -> u f (\_6892 _6893-> _6892); (6,f) -> u f (\_6894 _6895 _6896-> _6894); })))
fm_defs_report_errors = (\_defs_1-> (let _errors_2="" in (let _errors_3=(u (u (u list_for (u map_keys _defs_1)) _errors_2) (\_key_3-> (\_errors_4-> (let _name_5=(u fm_name_from_bits _key_3) in (let _6897 = (u (u fm_get _name_5) _defs_1) in (case _6897 of {(0,f) -> u f (_errors_4); (1,f) -> u f (\_6898-> (let _6899 = _6898 in (case _6899 of {(0,f) -> u f (\_6900 _6901 _6902 _6903 _6904 _6905 _6906 _6907 _6908-> (let _6909 = _6908 in (case _6909 of {(0,f) -> u f (_errors_4); (1,f) -> u f (_errors_4); (2,f) -> u f (_errors_4); (3,f) -> u f (\_6910-> (let _6911 = _6910 in (case _6911 of {(0,f) -> u f (_errors_4); (1,f) -> u f (\_6912 _6913-> (let _name_str_19=_6903 in (let _rel_errs_20=(u (u fm_error_relevant _6910) bool_false) in (let _errors_21=(u (u (u list_for _rel_errs_20) _errors_4) (\_err_21-> (\_errors_22-> (let _err_msg_23=(u (u fm_error_show _err_21) _defs_1) in (let _ori_msg_24=(let _6914 = (u fm_error_origin _err_21) in (case _6914 of {(0,f) -> u f (""); (1,f) -> u f (\_6915-> (let _6916 = _6915 in (case _6916 of {(0,f) -> u f (\_6917 _6918-> (let _inside_27=((("Inside '"::String) ++ (((_6900::String) ++ "':\n")))) in (let _source_28=(u (u (u fm_highlight _6901) _6917) _6918) in (((_inside_27::String) ++ (((_source_28::String) ++ "\n"))))))); }))); })) in (((_errors_22::String) ++ (((_err_msg_23::String) ++ (((_ori_msg_24::String) ++ "\n"))))))))))) in _errors_21)))); }))); }))); }))); })))))) in _errors_3)))
fm_defs_report = (\_defs_1-> (\_names_2-> (let _types_3=(u (u fm_defs_report_types _defs_1) _names_2) in (let _errors_4=(u fm_defs_report_errors _defs_1) in (let _errors_5=(let _6919 = _errors_4 in (if null (_6919::String) then "All terms check." else _errors_4)) in (((_types_3::String) ++ ((("\n"::String) ++ _errors_5)))))))))
fm_checker_io_one = (\_name_1-> (u (u (u io_monad (\_m_bind_2-> (\_m_pure_3-> _m_bind_2))) (u (u fm_synth_one _name_1) map_new)) (\_new_defs_2-> (let _6920 = _new_defs_2 in (case _6920 of {(0,f) -> u f ((u io_print (u (u fm_defs_report map_new) (u (u list_cons _name_1) list_nil)))); (1,f) -> u f (\_6921-> (u io_print (u (u fm_defs_report _6921) (u (u list_cons _name_1) list_nil)))); })))))
fm_synth_many = (\_names_1-> (\_defs_2-> (let _6922 = _names_1 in (case _6922 of {(0,f) -> u f ((u (u io_monad (\_m_bind_3-> (\_m_pure_4-> _m_pure_4))) _defs_2)); (1,f) -> u f (\_6923 _6924-> (u (u (u io_monad (\_m_bind_5-> (\_m_pure_6-> _m_bind_5))) (u (u fm_synth_one _6923) _defs_2)) (\_new_defs_5-> (let _6925 = _new_defs_5 in (case _6925 of {(0,f) -> u f ((u (u fm_synth_many _6924) _defs_2)); (1,f) -> u f (\_6926-> (u (u fm_synth_many _6924) _6926)); }))))); }))))
fm_synth_file = (\_file_1-> (\_defs_2-> (u (u (u io_monad (\_m_bind_3-> (\_m_pure_4-> _m_bind_3))) (u io_get_file _file_1)) (\_code_3-> (let _read_4=(u (u (u fm_defs_read _file_1) _code_3) _defs_2) in (let _6927 = _read_4 in (case _6927 of {(0,f) -> u f (\_6928-> (u (u io_monad (\_m_bind_6-> (\_m_pure_7-> _m_pure_7))) (u either_left _6928))); (1,f) -> u f (\_6929-> (let _file_defs_6=_6929 in (let _file_keys_7=(u map_keys _file_defs_6) in (let _file_nams_8=(u (u list_mapped _file_keys_7) fm_name_from_bits) in (u (u (u io_monad (\_m_bind_9-> (\_m_pure_10-> _m_bind_9))) (u (u fm_synth_many _file_nams_8) _file_defs_6)) (\_defs_9-> (u (u io_monad (\_m_bind_10-> (\_m_pure_11-> _m_pure_11))) (u either_right (u (u pair_new _file_nams_8) _defs_9))))))))); })))))))
fm_checker_io_file = (\_file_1-> (u (u (u io_monad (\_m_bind_2-> (\_m_pure_3-> _m_bind_2))) (u (u fm_synth_file _file_1) map_new)) (\_loaded_2-> (let _6930 = _loaded_2 in (case _6930 of {(0,f) -> u f (\_6931-> (u (u (u io_monad (\_m_bind_4-> (\_m_pure_5-> _m_bind_4))) (u io_print (u string_flatten (u (u list_cons "On '") (u (u list_cons _file_1) (u (u list_cons "':") list_nil)))))) (\__4-> (u io_print _6931)))); (1,f) -> u f (\_6932-> (let _6933 = _6932 in (case _6933 of {(0,f) -> u f (\_6934 _6935-> (let _nams_6=_6934 in (let _defs_7=_6935 in (u io_print (u (u fm_defs_report _defs_7) _nams_6))))); }))); })))))
io_purify = (\_io_2-> (let _6936 = _io_2 in (case _6936 of {(0,f) -> u f (\_6937-> _6937); (1,f) -> u f (\_6938 _6939 _6940-> (u io_purify (u _6940 ""))); })))
fm_checker_code = (\_code_1-> (let _6941 = (u (u (u fm_defs_read "Main.fm") _code_1) map_new) in (case _6941 of {(0,f) -> u f (\_6942-> _6942); (1,f) -> u f (\_6943-> (u io_purify (let _defs_3=_6943 in (let _nams_4=(u (u list_mapped (u map_keys _defs_3)) fm_name_from_bits) in (u (u (u io_monad (\_m_bind_5-> (\_m_pure_6-> _m_bind_5))) (u (u fm_synth_many _nams_4) _defs_3)) (\_defs_5-> (u (u io_monad (\_m_bind_6-> (\_m_pure_7-> _m_pure_7))) (u (u fm_defs_report _defs_5) _nams_4)))))))); })))
fm_term_read = (\_code_1-> (let _6944 = (u (u fm_parser_term 0) _code_1) in (case _6944 of {(0,f) -> u f (\_6945 _6946 _6947-> maybe_none); (1,f) -> u f (\_6948 _6949 _6950-> (u maybe_some _6950)); })))
fm = (let ___1=fm_to_core_io_one in (let ___2=fm_checker_io_one in (let ___3=fm_checker_io_file in (let ___4=fm_checker_code in (let ___5=fm_term_read in (u (u io_monad (\_m_bind_6-> (\_m_pure_7-> _m_pure_7))) unit_new))))))


Ether.RLP.encode(tree: Ether.RLP): Bytes
  case tree {
    data:
      if Bool.and(Nat.eql(List.length!(tree.value),1), Nat.lte(U8.to_nat((List.head_with_default!(0#8,tree.value))), 127)) then
        tree.value
      else
        List.concat!(Ether.RLP.encode.length(128, List.length!(tree.value)), tree.value)
    node:
      let rest = Ether.RLP.encode.many(tree.child)
      List.concat!(Ether.RLP.encode.length(192, List.length!(rest)), rest)
  }

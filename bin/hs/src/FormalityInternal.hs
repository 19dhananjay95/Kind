module FormalityInternal where
import Unsafe.Coerce
import Data.Word
import Data.Bits
import Debug.Trace
import System.Exit
u = unsafeCoerce
run p = case p of {
  (1,f) -> (u f (\query param cont-> case query of {
    "print"    -> do { putStrLn param; run (cont ()); };
    "exit"     -> do { exitFailure; run (cont ()); };
    "get_line" -> do { line <- getLine; run (u cont line); };
    "get_file" -> do { line <- readFile param; run (u cont line); };
    otherwise  -> do { u cont (); };
  }));
  (0,f) -> (u f (\value-> do { (return :: a -> IO a) value; }));
}
word_to_u16       w        = u word_to_u16_go 0 w 0
word_to_u16_go 16 w      x = u x
word_to_u16_go  i (0,f)  x = u word_to_u16_go (i+1) (0,\t-> t) (x::Word16)
word_to_u16_go  i (1,f)  x = u f (\w-> word_to_u16_go (i+1) w x)
word_to_u16_go  i (2,f)  x = u f (\w-> word_to_u16_go (i+1) w (x .|. (shiftL 1 i)))
u16_to_word       x        = u u16_to_word_go 0 x (0,\t-> t)
u16_to_word_go 16 x      w = u w
u16_to_word_go  i x      w = u u16_to_word_go (i+1) (x::Word16) (if (shiftR x (16-i-1) .&. 1) > 0 then (2,\t-> t w) else (1,\t-> t w))
io = (\_a_1-> ())
io_ask = (\_query_2-> (\_param_3-> (\_then_4-> (1,\t-> t _query_2 _param_3 _then_4))))
io_bind = (\_a_3-> (\_f_4-> (let _0 = _a_3 in (case _0 of {(0,f) -> u f (\_1-> (u _f_4 _1)); (1,f) -> u f (\_2 _3 _4-> (u (u (u io_ask _2) _3) (\_x_8-> (u (u io_bind (u _4 _x_8)) _f_4)))); }))))
io_end = (\_value_2-> (0,\t-> t _value_2))
io_monad = (\_new_2-> (u (u _new_2 io_bind) io_end))
maybe = (\_a_1-> ())
map = (\_a_1-> ())
maybe_none = (0,\t-> t)
map_get = (\_bits_2-> (\_map_3-> (let _5 = _bits_2 in (case _5 of {(0,f) -> u f ((let _6 = _map_3 in (case _6 of {(0,f) -> u f (maybe_none); (1,f) -> u f (\_7 _8 _9-> _7); }))); (1,f) -> u f (\_10-> (let _11 = _map_3 in (case _11 of {(0,f) -> u f (maybe_none); (1,f) -> u f (\_12 _13 _14-> (u (u map_get _10) _13)); }))); (2,f) -> u f (\_15-> (let _16 = _map_3 in (case _16 of {(0,f) -> u f (maybe_none); (1,f) -> u f (\_17 _18 _19-> (u (u map_get _15) _19)); }))); }))))
bits_e = (0,\t-> t)
bool_false = False
bool_and = (\a0-> \a1-> (a0 && a1))
bool_true = True
cmp_as_lte = (\_cmp_1-> (let _20 = _cmp_1 in (case _20 of {(0,f) -> u f (bool_true); (1,f) -> u f (bool_true); (2,f) -> u f (bool_false); })))
cmp_ltn = (0,\t-> t)
cmp_gtn = (2,\t-> t)
word_cmp_go = (\_a_2-> (\_b_3-> (\_c_4-> (let _21 = _a_2 in (case _21 of {(0,f) -> u f ((\_b_5-> _c_4)); (1,f) -> u f (\_22-> (\_b_7-> (let _23 = _b_7 in (case _23 of {(0,f) -> u f ((\_a_pred_8-> _c_4)); (1,f) -> u f (\_24-> (\_a_pred_10-> (u (u (u word_cmp_go _a_pred_10) _24) _c_4))); (2,f) -> u f (\_25-> (\_a_pred_10-> (u (u (u word_cmp_go _a_pred_10) _25) cmp_ltn))); })) _22)); (2,f) -> u f (\_26-> (\_b_7-> (let _27 = _b_7 in (case _27 of {(0,f) -> u f ((\_a_pred_8-> _c_4)); (1,f) -> u f (\_28-> (\_a_pred_10-> (u (u (u word_cmp_go _a_pred_10) _28) cmp_gtn))); (2,f) -> u f (\_29-> (\_a_pred_10-> (u (u (u word_cmp_go _a_pred_10) _29) _c_4))); })) _26)); })) _b_3)))
cmp_eql = (1,\t-> t)
word_cmp = (\_a_2-> (\_b_3-> (u (u (u word_cmp_go _a_2) _b_3) cmp_eql)))
word_lte = (\_a_2-> (\_b_3-> (u cmp_as_lte (u (u word_cmp _a_2) _b_3))))
nat_succ = (\_pred_1-> 1+_pred_1)
nat_zero = 0
u16_lte = (\a0-> \a1-> ((a0::Word16) <= a1))
u16_btw = (\_a_1-> (\_b_2-> (\_c_3-> (((((_a_1::Word16) <= _b_2)) && (((_b_2::Word16) <= _c_3)))))))
u16_new = (\_value_1-> (word_to_u16 _value_1))
word_e = (0,\t-> t)
word = (\_size_1-> ())
word_i = (\_pred_2-> (2,\t-> t _pred_2))
word_o = (\_pred_2-> (1,\t-> t _pred_2))
word_subber = (\_a_2-> (\_b_3-> (\_c_4-> (let _30 = _a_2 in (case _30 of {(0,f) -> u f ((\_b_5-> word_e)); (1,f) -> u f (\_31-> (\_b_7-> (let _32 = _b_7 in (case _32 of {(0,f) -> u f ((\_a_pred_8-> word_e)); (1,f) -> u f (\_33-> (\_a_pred_10-> (let _34 = _c_4 in (if _34 then (u word_i (u (u (u word_subber _a_pred_10) _33) bool_true)) else (u word_o (u (u (u word_subber _a_pred_10) _33) bool_false)))))); (2,f) -> u f (\_35-> (\_a_pred_10-> (let _36 = _c_4 in (if _36 then (u word_o (u (u (u word_subber _a_pred_10) _35) bool_true)) else (u word_i (u (u (u word_subber _a_pred_10) _35) bool_true)))))); })) _31)); (2,f) -> u f (\_37-> (\_b_7-> (let _38 = _b_7 in (case _38 of {(0,f) -> u f ((\_a_pred_8-> word_e)); (1,f) -> u f (\_39-> (\_a_pred_10-> (let _40 = _c_4 in (if _40 then (u word_o (u (u (u word_subber _a_pred_10) _39) bool_false)) else (u word_i (u (u (u word_subber _a_pred_10) _39) bool_false)))))); (2,f) -> u f (\_41-> (\_a_pred_10-> (let _42 = _c_4 in (if _42 then (u word_i (u (u (u word_subber _a_pred_10) _41) bool_true)) else (u word_o (u (u (u word_subber _a_pred_10) _41) bool_false)))))); })) _37)); })) _b_3)))
word_sub = (\_a_2-> (\_b_3-> (u (u (u word_subber _a_2) _b_3) bool_false)))
u16_sub = (\a0-> \a1-> ((a0::Word16) - a1))
nat_apply = (\_n_2-> (\_f_3-> (\_x_4-> (let _43 = _n_2 in (if _43==0 then _x_4 else (u (u (u nat_apply (_43-1)) _f_3) (u _f_3 _x_4)))))))
word_inc = (\_word_2-> (let _44 = _word_2 in (case _44 of {(0,f) -> u f (word_e); (1,f) -> u f (\_45-> (u word_i _45)); (2,f) -> u f (\_46-> (u word_o (u word_inc _46))); })))
u16_inc = (\_a_1-> (let _47 = _a_1 in (u u16_new (u word_inc (u16_to_word _47)))))
word_zero = (\_size_1-> (let _48 = _size_1 in (if _48==0 then word_e else (u word_o (u word_zero (_48-1))))))
u16_zero = (u u16_new (u word_zero 16))
nat_to_u16 = (\a0-> (fromIntegral (a0::Integer)))
word_adder = (\_a_2-> (\_b_3-> (\_c_4-> (let _49 = _a_2 in (case _49 of {(0,f) -> u f ((\_b_5-> word_e)); (1,f) -> u f (\_50-> (\_b_7-> (let _51 = _b_7 in (case _51 of {(0,f) -> u f ((\_a_pred_8-> word_e)); (1,f) -> u f (\_52-> (\_a_pred_10-> (let _53 = _c_4 in (if _53 then (u word_i (u (u (u word_adder _a_pred_10) _52) bool_false)) else (u word_o (u (u (u word_adder _a_pred_10) _52) bool_false)))))); (2,f) -> u f (\_54-> (\_a_pred_10-> (let _55 = _c_4 in (if _55 then (u word_o (u (u (u word_adder _a_pred_10) _54) bool_true)) else (u word_i (u (u (u word_adder _a_pred_10) _54) bool_false)))))); })) _50)); (2,f) -> u f (\_56-> (\_b_7-> (let _57 = _b_7 in (case _57 of {(0,f) -> u f ((\_a_pred_8-> word_e)); (1,f) -> u f (\_58-> (\_a_pred_10-> (let _59 = _c_4 in (if _59 then (u word_o (u (u (u word_adder _a_pred_10) _58) bool_true)) else (u word_i (u (u (u word_adder _a_pred_10) _58) bool_false)))))); (2,f) -> u f (\_60-> (\_a_pred_10-> (let _61 = _c_4 in (if _61 then (u word_i (u (u (u word_adder _a_pred_10) _60) bool_true)) else (u word_o (u (u (u word_adder _a_pred_10) _60) bool_true)))))); })) _56)); })) _b_3)))
word_add = (\_a_2-> (\_b_3-> (u (u (u word_adder _a_2) _b_3) bool_false)))
u16_add = (\a0-> \a1-> ((a0::Word16) + a1))
cmp_as_eql = (\_cmp_1-> (let _62 = _cmp_1 in (case _62 of {(0,f) -> u f (bool_false); (1,f) -> u f (bool_true); (2,f) -> u f (bool_false); })))
word_eql = (\_a_2-> (\_b_3-> (u cmp_as_eql (u (u word_cmp _a_2) _b_3))))
u16_eql = (\a0-> \a1-> ((a0::Word16) == a1))
bits_o = (\_pred_1-> (1,\t-> t _pred_1))
bits_i = (\_pred_1-> (2,\t-> t _pred_1))
word_to_bits = (\_a_2-> (let _63 = _a_2 in (case _63 of {(0,f) -> u f (bits_e); (1,f) -> u f (\_64-> (u bits_o (u word_to_bits _64))); (2,f) -> u f (\_65-> (u bits_i (u word_to_bits _65))); })))
word_trim = (\_new_size_2-> (\_word_3-> (let _66 = _new_size_2 in (if _66==0 then word_e else (let _67 = _word_3 in (case _67 of {(0,f) -> u f ((u word_o (u (u word_trim (_66-1)) word_e))); (1,f) -> u f (\_68-> (u word_o (u (u word_trim (_66-1)) _68))); (2,f) -> u f (\_69-> (u word_i (u (u word_trim (_66-1)) _69))); }))))))
bits_concat = (\_a_1-> (\_b_2-> (let _70 = _a_1 in (case _70 of {(0,f) -> u f (_b_2); (1,f) -> u f (\_71-> (u bits_o (u (u bits_concat _71) _b_2))); (2,f) -> u f (\_72-> (u bits_i (u (u bits_concat _72) _b_2))); }))))
bits_reverse_tco = (\_a_1-> (\_r_2-> (let _73 = _a_1 in (case _73 of {(0,f) -> u f (_r_2); (1,f) -> u f (\_74-> (u (u bits_reverse_tco _74) (u bits_o _r_2))); (2,f) -> u f (\_75-> (u (u bits_reverse_tco _75) (u bits_i _r_2))); }))))
bits_reverse = (\_a_1-> (u (u bits_reverse_tco _a_1) bits_e))
fm_name_to_bits = (\_name_1-> (let _76 = _name_1 in (if null (_76::String) then bits_e else (let _chr_4=(fromIntegral (fromEnum (head _76 :: Char)) :: Word16) in (let _u16_5=(let _77 = (u (u (u u16_btw 65) _chr_4) 90) in (if _77 then (((_chr_4::Word16) - 65)) else (let _78 = (u (u (u u16_btw 97) _chr_4) 122) in (if _78 then (((_chr_4::Word16) - 71)) else (let _79 = (u (u (u u16_btw 48) _chr_4) 57) in (if _79 then (((_chr_4::Word16) + 4)) else (let _80 = (((46::Word16) == _chr_4)) in (if _80 then 62 else (let _81 = (((95::Word16) == _chr_4)) in (if _81 then 63 else 0)))))))))) in (let _bts_6=(let _82 = _u16_5 in (u word_to_bits (u (u word_trim 6) (u16_to_word _82)))) in (u (u bits_concat (u bits_reverse _bts_6)) (u fm_name_to_bits (tail _76)))))))))
fm_get = (\_name_2-> (\_map_3-> (u (u map_get (u fm_name_to_bits _name_2)) _map_3)))
string_cons = (\_head_1-> (\_tail_2-> ((toEnum (fromIntegral _head_1 :: Int) :: Char) : _tail_2)))
fm_synth_file_of = (\_name_1-> (let _83 = _name_1 in (if null (_83::String) then ".fm" else (let _84 = ((((fromIntegral (fromEnum (head _83 :: Char)) :: Word16)::Word16) == 46)) in (if _84 then ".fm" else (u (u string_cons (fromIntegral (fromEnum (head _83 :: Char)) :: Word16)) (u fm_synth_file_of (tail _83))))))))
io_get_file = (\_name_1-> (u (u (u io_ask "get_file") _name_1) (\_file_2-> (u io_end _file_2))))
parser_reply = (\_v_1-> ())
parser_reply_value = (\_idx_2-> (\_code_3-> (\_val_4-> (1,\t-> t _idx_2 _code_3 _val_4))))
parser_is_eof = (\_idx_1-> (\_code_2-> (let _85 = _code_2 in (if null (_85::String) then (u (u (u parser_reply_value _idx_1) _code_2) bool_true) else (u (u (u parser_reply_value _idx_1) _code_2) bool_false)))))
parser_reply_error = (\_idx_2-> (\_code_3-> (\_err_4-> (0,\t-> t _idx_2 _code_3 _err_4))))
parser = (\_v_1-> ())
maybe_some = (\_value_2-> (1,\t-> t _value_2))
parser_errorat_new = (\_idx_1-> (\_code_2-> (\_err_3-> (0,\t-> t _idx_1 _code_2 _err_3))))
nat_gtn = (\a0-> \a1-> ((a0::Integer) > a1))
parser_errorat_combine = (\_a_1-> (\_b_2-> (let _86 = _a_1 in (case _86 of {(0,f) -> u f (_b_2); (1,f) -> u f (\_87-> (let _88 = _b_2 in (case _88 of {(0,f) -> u f (_a_1); (1,f) -> u f (\_89-> (let _90 = _87 in (case _90 of {(0,f) -> u f (\_91 _92 _93-> (let _94 = _89 in (case _94 of {(0,f) -> u f (\_95 _96 _97-> (let _98 = (((_91::Integer) > _95)) in (if _98 then _a_1 else _b_2))); }))); }))); }))); }))))
parser_first_of_go = (\_pars_2-> (\_err_3-> (\_idx_4-> (\_code_5-> (let _99 = _pars_2 in (case _99 of {(0,f) -> u f ((let _100 = _err_3 in (case _100 of {(0,f) -> u f ((u (u (u parser_reply_error _idx_4) _code_5) "No parse.")); (1,f) -> u f (\_101-> (let _102 = _101 in (case _102 of {(0,f) -> u f (\_103 _104 _105-> (u (u (u parser_reply_error _103) _104) _105)); }))); }))); (1,f) -> u f (\_106 _107-> (let _parsed_8=(u (u _106 _idx_4) _code_5) in (let _108 = _parsed_8 in (case _108 of {(0,f) -> u f (\_109 _110 _111-> (let _neo_12=(u maybe_some (u (u (u parser_errorat_new _109) _110) _111)) in (let _err_13=(u (u parser_errorat_combine _neo_12) _err_3) in (u (u (u (u parser_first_of_go _107) _err_13) _idx_4) _code_5)))); (1,f) -> u f (\_112 _113 _114-> (u (u (u parser_reply_value _112) _113) _114)); })))); }))))))
parser_first_of = (\_pars_2-> (u (u parser_first_of_go _pars_2) maybe_none))
list_cons = (\_head_2-> (\_tail_3-> (1,\t-> t _head_2 _tail_3)))
list = (\_a_1-> ())
list_nil = (0,\t-> t)
parser_many_go = (\_parse_2-> (\_values_3-> (\_idx_4-> (\_code_5-> (let _115 = (u (u _parse_2 _idx_4) _code_5) in (case _115 of {(0,f) -> u f (\_116 _117 _118-> (u (u (u parser_reply_value _idx_4) _code_5) (u _values_3 list_nil))); (1,f) -> u f (\_119 _120 _121-> (u (u (u (u parser_many_go _parse_2) (\_xs_9-> (u _values_3 (u (u list_cons _121) _xs_9)))) _119) _120)); }))))))
parser_many = (\_parser_2-> (u (u parser_many_go _parser_2) (\_x_3-> _x_3)))
unit_new = ()
string_concat = (\a0-> \a1-> ((a0::String) ++ a1))
string_flatten_go = (\_xs_1-> (\_res_2-> (let _122 = _xs_1 in (case _122 of {(0,f) -> u f (_res_2); (1,f) -> u f (\_123 _124-> (u (u string_flatten_go _124) (((_res_2::String) ++ _123)))); }))))
string_flatten = (\_xs_1-> (u (u string_flatten_go _xs_1) ""))
string_nil = []
parser_text_go = (\_text_1-> (\_idx_2-> (\_code_3-> (let _125 = _text_1 in (if null (_125::String) then (u (u (u parser_reply_value _idx_2) _code_3) unit_new) else (let _126 = _code_3 in (if null (_126::String) then (let _error_6=(u string_flatten (u (u list_cons "Expected '") (u (u list_cons _text_1) (u (u list_cons "', found end of file.") list_nil)))) in (u (u (u parser_reply_error _idx_2) _code_3) _error_6)) else (let _127 = ((((fromIntegral (fromEnum (head _125 :: Char)) :: Word16)::Word16) == (fromIntegral (fromEnum (head _126 :: Char)) :: Word16))) in (if _127 then (u (u (u parser_text (tail _125)) (u nat_succ _idx_2)) (tail _126)) else (let _error_8=(u string_flatten (u (u list_cons "Expected '") (u (u list_cons _text_1) (u (u list_cons "', found '") (u (u list_cons (u (u string_cons (fromIntegral (fromEnum (head _126 :: Char)) :: Word16)) string_nil)) (u (u list_cons "'.") list_nil)))))) in (u (u (u parser_reply_error _idx_2) _code_3) _error_8)))))))))))
parser_text = (\_text_1-> (\_idx_2-> (\_code_3-> (let _128 = (u (u (u parser_text_go _text_1) _idx_2) _code_3) in (case _128 of {(0,f) -> u f (\_129 _130 _131-> (u (u (u parser_reply_error _idx_2) _code_3) _131)); (1,f) -> u f (\_132 _133 _134-> (u (u (u parser_reply_value _132) _133) _134)); })))))
parser_until_go = (\_until_2-> (\_parse_3-> (\_values_4-> (\_idx_5-> (\_code_6-> (let _until_reply_7=(u (u _until_2 _idx_5) _code_6) in (let _135 = _until_reply_7 in (case _135 of {(0,f) -> u f (\_136 _137 _138-> (let _reply_11=(u (u _parse_3 _idx_5) _code_6) in (let _139 = _reply_11 in (case _139 of {(0,f) -> u f (\_140 _141 _142-> (u (u (u parser_reply_error _140) _141) _142)); (1,f) -> u f (\_143 _144 _145-> (u (u (u (u (u parser_until_go _until_2) _parse_3) (\_xs_15-> (u _values_4 (u (u list_cons _145) _xs_15)))) _143) _144)); })))); (1,f) -> u f (\_146 _147 _148-> (u (u (u parser_reply_value _146) _147) (u _values_4 list_nil))); }))))))))
parser_until = (\_until_2-> (\_parse_3-> (u (u (u parser_until_go _until_2) _parse_3) (\_x_4-> _x_4))))
parser_one = (\_idx_1-> (\_code_2-> (let _149 = _code_2 in (if null (_149::String) then (u (u (u parser_reply_error _idx_1) _code_2) "Unexpected end of file.") else (u (u (u parser_reply_value (u nat_succ _idx_1)) (tail _149)) (fromIntegral (fromEnum (head _149 :: Char)) :: Word16))))))
fm_parser_spaces = (u parser_many (u parser_first_of (u (u list_cons (u parser_text " ")) (u (u list_cons (u parser_text "\n")) (u (u list_cons (\_idx_1-> (\_code_2-> (let _150 = (u (u (u parser_text "//") _idx_1) _code_2) in (case _150 of {(0,f) -> u f (\_151 _152 _153-> (u (u (u parser_reply_error _151) _152) _153)); (1,f) -> u f (\_154 _155 _156-> (let _157 = (u (u (u (u parser_until (u parser_text "\n")) parser_one) _154) _155) in (case _157 of {(0,f) -> u f (\_158 _159 _160-> (u (u (u parser_reply_error _158) _159) _160)); (1,f) -> u f (\_161 _162 _163-> (u (u (u parser_reply_value _161) _162) unit_new)); }))); }))))) list_nil)))))
fm_parser_text = (\_text_1-> (\_idx_2-> (\_code_3-> (let _164 = (u (u fm_parser_spaces _idx_2) _code_3) in (case _164 of {(0,f) -> u f (\_165 _166 _167-> (u (u (u parser_reply_error _165) _166) _167)); (1,f) -> u f (\_168 _169 _170-> (u (u (u parser_text _text_1) _168) _169)); })))))
parser_many1 = (\_parser_2-> (\_idx_3-> (\_code_4-> (let _171 = (u (u _parser_2 _idx_3) _code_4) in (case _171 of {(0,f) -> u f (\_172 _173 _174-> (u (u (u parser_reply_error _172) _173) _174)); (1,f) -> u f (\_175 _176 _177-> (let _178 = (u (u (u parser_many _parser_2) _175) _176) in (case _178 of {(0,f) -> u f (\_179 _180 _181-> (u (u (u parser_reply_error _179) _180) _181)); (1,f) -> u f (\_182 _183 _184-> (u (u (u parser_reply_value _182) _183) (u (u list_cons _177) _184))); }))); })))))
fm_name_is_letter = (\_chr_1-> (let _185 = (u (u (u u16_btw 65) _chr_1) 90) in (if _185 then bool_true else (let _186 = (u (u (u u16_btw 97) _chr_1) 122) in (if _186 then bool_true else (let _187 = (u (u (u u16_btw 48) _chr_1) 57) in (if _187 then bool_true else (let _188 = (((46::Word16) == _chr_1)) in (if _188 then bool_true else (let _189 = (((95::Word16) == _chr_1)) in (if _189 then bool_true else (let _190 = (((94::Word16) == _chr_1)) in (if _190 then bool_true else bool_false)))))))))))))
fm_parser_letter = (\_idx_1-> (\_code_2-> (let _191 = _code_2 in (if null (_191::String) then (u (u (u parser_reply_error _idx_1) _code_2) "Unexpected eof.") else (let _192 = (u fm_name_is_letter (fromIntegral (fromEnum (head _191 :: Char)) :: Word16)) in (if _192 then (u (u (u parser_reply_value (u nat_succ _idx_1)) (tail _191)) (fromIntegral (fromEnum (head _191 :: Char)) :: Word16)) else (u (u (u parser_reply_error _idx_1) _code_2) "Expected letter.")))))))
list_fold = (\_list_2-> (\_nil_4-> (\_cons_5-> (let _193 = _list_2 in (case _193 of {(0,f) -> u f (_nil_4); (1,f) -> u f (\_194 _195-> (u (u _cons_5 _194) (u (u (u list_fold _195) _nil_4) _cons_5))); })))))
fm_parser_name1 = (\_idx_1-> (\_code_2-> (let _196 = (u (u fm_parser_spaces _idx_1) _code_2) in (case _196 of {(0,f) -> u f (\_197 _198 _199-> (u (u (u parser_reply_error _197) _198) _199)); (1,f) -> u f (\_200 _201 _202-> (let _203 = (u (u (u parser_many1 fm_parser_letter) _200) _201) in (case _203 of {(0,f) -> u f (\_204 _205 _206-> (u (u (u parser_reply_error _204) _205) _206)); (1,f) -> u f (\_207 _208 _209-> (u (u (u parser_reply_value _207) _208) (u (u (u list_fold _209) string_nil) string_cons))); }))); }))))
parser_until1 = (\_cond_2-> (\_parser_3-> (\_idx_4-> (\_code_5-> (let _210 = (u (u _parser_3 _idx_4) _code_5) in (case _210 of {(0,f) -> u f (\_211 _212 _213-> (u (u (u parser_reply_error _211) _212) _213)); (1,f) -> u f (\_214 _215 _216-> (let _217 = (u (u (u (u parser_until _cond_2) _parser_3) _214) _215) in (case _217 of {(0,f) -> u f (\_218 _219 _220-> (u (u (u parser_reply_error _218) _219) _220)); (1,f) -> u f (\_221 _222 _223-> (u (u (u parser_reply_value _221) _222) (u (u list_cons _216) _223))); }))); }))))))
pair = (\_a_1-> (\_b_2-> ()))
parser_maybe = (\_parse_2-> (\_idx_3-> (\_code_4-> (let _224 = (u (u _parse_2 _idx_3) _code_4) in (case _224 of {(0,f) -> u f (\_225 _226 _227-> (u (u (u parser_reply_value _idx_3) _code_4) maybe_none)); (1,f) -> u f (\_228 _229 _230-> (u (u (u parser_reply_value _228) _229) (u maybe_some _230))); })))))
fm_parser_item = (\_parser_2-> (\_idx_3-> (\_code_4-> (let _231 = (u (u fm_parser_spaces _idx_3) _code_4) in (case _231 of {(0,f) -> u f (\_232 _233 _234-> (u (u (u parser_reply_error _232) _233) _234)); (1,f) -> u f (\_235 _236 _237-> (let _238 = (u (u _parser_2 _235) _236) in (case _238 of {(0,f) -> u f (\_239 _240 _241-> (u (u (u parser_reply_error _239) _240) _241)); (1,f) -> u f (\_242 _243 _244-> (let _245 = (u (u (u parser_maybe (u fm_parser_text ",")) _242) _243) in (case _245 of {(0,f) -> u f (\_246 _247 _248-> (u (u (u parser_reply_error _246) _247) _248)); (1,f) -> u f (\_249 _250 _251-> (u (u (u parser_reply_value _249) _250) _244)); }))); }))); })))))
fm_parser_name = (\_idx_1-> (\_code_2-> (let _252 = (u (u fm_parser_spaces _idx_1) _code_2) in (case _252 of {(0,f) -> u f (\_253 _254 _255-> (u (u (u parser_reply_error _253) _254) _255)); (1,f) -> u f (\_256 _257 _258-> (let _259 = (u (u (u parser_many fm_parser_letter) _256) _257) in (case _259 of {(0,f) -> u f (\_260 _261 _262-> (u (u (u parser_reply_error _260) _261) _262)); (1,f) -> u f (\_263 _264 _265-> (u (u (u parser_reply_value _263) _264) (u (u (u list_fold _265) string_nil) string_cons))); }))); }))))
parser_get_code = (\_idx_1-> (\_code_2-> (u (u (u parser_reply_value _idx_1) _code_2) _code_2)))
parser_get_index = (\_idx_1-> (\_code_2-> (u (u (u parser_reply_value _idx_1) _code_2) _idx_1)))
fm_parser_init = (\_idx_1-> (\_code_2-> (let _266 = (u (u fm_parser_spaces _idx_1) _code_2) in (case _266 of {(0,f) -> u f (\_267 _268 _269-> (u (u (u parser_reply_error _267) _268) _269)); (1,f) -> u f (\_270 _271 _272-> (let _273 = (u (u parser_get_index _270) _271) in (case _273 of {(0,f) -> u f (\_274 _275 _276-> (u (u (u parser_reply_error _274) _275) _276)); (1,f) -> u f (\_277 _278 _279-> (u (u (u parser_reply_value _277) _278) _279)); }))); }))))
fm_origin_new = (\_file_1-> (\_from_2-> (\_upto_3-> (0,\t-> t _file_1 _from_2 _upto_3))))
fm_parser_stop = (\_from_1-> (\_idx_2-> (\_code_3-> (let _280 = (u (u parser_get_index _idx_2) _code_3) in (case _280 of {(0,f) -> u f (\_281 _282 _283-> (u (u (u parser_reply_error _281) _282) _283)); (1,f) -> u f (\_284 _285 _286-> (let _orig_7=(u (u (u fm_origin_new "") _from_1) _286) in (u (u (u parser_reply_value _284) _285) _orig_7))); })))))
fm_term_ori = (\_orig_1-> (\_expr_2-> (15,\t-> t _orig_1 _expr_2)))
fm_term_typ = (2,\t-> t)
fm_parser_type = (\_idx_1-> (\_code_2-> (let _287 = (u (u fm_parser_init _idx_1) _code_2) in (case _287 of {(0,f) -> u f (\_288 _289 _290-> (u (u (u parser_reply_error _288) _289) _290)); (1,f) -> u f (\_291 _292 _293-> (let _294 = (u (u (u fm_parser_text "Type") _291) _292) in (case _294 of {(0,f) -> u f (\_295 _296 _297-> (u (u (u parser_reply_error _295) _296) _297)); (1,f) -> u f (\_298 _299 _300-> (let _301 = (u (u (u fm_parser_stop _293) _298) _299) in (case _301 of {(0,f) -> u f (\_302 _303 _304-> (u (u (u parser_reply_error _302) _303) _304)); (1,f) -> u f (\_305 _306 _307-> (u (u (u parser_reply_value _305) _306) (u (u fm_term_ori _307) fm_term_typ))); }))); }))); }))))
fm_term_all = (\_eras_1-> (\_self_2-> (\_name_3-> (\_xtyp_4-> (\_body_5-> (3,\t-> t _eras_1 _self_2 _name_3 _xtyp_4 _body_5))))))
fm_parser_forall = (\_idx_1-> (\_code_2-> (let _308 = (u (u fm_parser_init _idx_1) _code_2) in (case _308 of {(0,f) -> u f (\_309 _310 _311-> (u (u (u parser_reply_error _309) _310) _311)); (1,f) -> u f (\_312 _313 _314-> (let _315 = (u (u fm_parser_name _312) _313) in (case _315 of {(0,f) -> u f (\_316 _317 _318-> (u (u (u parser_reply_error _316) _317) _318)); (1,f) -> u f (\_319 _320 _321-> (let _322 = (u (u fm_parser_binder _319) _320) in (case _322 of {(0,f) -> u f (\_323 _324 _325-> (u (u (u parser_reply_error _323) _324) _325)); (1,f) -> u f (\_326 _327 _328-> (let _329 = (u (u (u parser_maybe (u fm_parser_text "->")) _326) _327) in (case _329 of {(0,f) -> u f (\_330 _331 _332-> (u (u (u parser_reply_error _330) _331) _332)); (1,f) -> u f (\_333 _334 _335-> (let _336 = (u (u fm_parser_term _333) _334) in (case _336 of {(0,f) -> u f (\_337 _338 _339-> (u (u (u parser_reply_error _337) _338) _339)); (1,f) -> u f (\_340 _341 _342-> (let _term_18=(u (u (u list_fold _328) _342) (\_x_18-> (\_t_19-> (let _343 = _x_18 in (case _343 of {(0,f) -> u f (\_344 _345 _346-> (u (u (u (u (u fm_term_all _344) "") _345) _346) (\_s_23-> (\_x_24-> _t_19)))); }))))) in (let _347 = (u (u (u fm_parser_stop _314) _340) _341) in (case _347 of {(0,f) -> u f (\_348 _349 _350-> (u (u (u parser_reply_error _348) _349) _350)); (1,f) -> u f (\_351 _352 _353-> (u (u (u parser_reply_value _351) _352) (let _354 = _term_18 in (case _354 of {(0,f) -> u f (\_355 _356-> _term_18); (1,f) -> u f (\_357-> _term_18); (2,f) -> u f (_term_18); (3,f) -> u f (\_358 _359 _360 _361 _362-> (u (u fm_term_ori _353) (u (u (u (u (u fm_term_all _358) _321) _360) _361) _362))); (4,f) -> u f (\_363 _364-> _term_18); (5,f) -> u f (\_365 _366-> _term_18); (6,f) -> u f (\_367 _368 _369-> _term_18); (7,f) -> u f (\_370 _371 _372-> _term_18); (8,f) -> u f (\_373 _374 _375-> _term_18); (9,f) -> u f (\_376 _377 _378-> _term_18); (10,f) -> u f (\_379-> _term_18); (11,f) -> u f (\_380-> _term_18); (12,f) -> u f (\_381-> _term_18); (13,f) -> u f (\_382-> _term_18); (14,f) -> u f (\_383 _384 _385 _386 _387 _388-> _term_18); (15,f) -> u f (\_389 _390-> _term_18); })))); })))); }))); }))); }))); }))); }))))
fm_term_lam = (\_name_1-> (\_body_2-> (4,\t-> t _name_1 _body_2)))
fm_parser_make_lambda = (\_names_1-> (\_body_2-> (let _391 = _names_1 in (case _391 of {(0,f) -> u f (_body_2); (1,f) -> u f (\_392 _393-> (u (u fm_term_lam _392) (\_x_5-> (u (u fm_parser_make_lambda _393) _body_2)))); }))))
fm_parser_lambda = (\_idx_1-> (\_code_2-> (let _394 = (u (u fm_parser_init _idx_1) _code_2) in (case _394 of {(0,f) -> u f (\_395 _396 _397-> (u (u (u parser_reply_error _395) _396) _397)); (1,f) -> u f (\_398 _399 _400-> (let _401 = (u (u (u fm_parser_text "(") _398) _399) in (case _401 of {(0,f) -> u f (\_402 _403 _404-> (u (u (u parser_reply_error _402) _403) _404)); (1,f) -> u f (\_405 _406 _407-> (let _408 = (u (u (u (u parser_until1 (u fm_parser_text ")")) (u fm_parser_item fm_parser_name1)) _405) _406) in (case _408 of {(0,f) -> u f (\_409 _410 _411-> (u (u (u parser_reply_error _409) _410) _411)); (1,f) -> u f (\_412 _413 _414-> (let _415 = (u (u fm_parser_term _412) _413) in (case _415 of {(0,f) -> u f (\_416 _417 _418-> (u (u (u parser_reply_error _416) _417) _418)); (1,f) -> u f (\_419 _420 _421-> (let _422 = (u (u (u fm_parser_stop _400) _419) _420) in (case _422 of {(0,f) -> u f (\_423 _424 _425-> (u (u (u parser_reply_error _423) _424) _425)); (1,f) -> u f (\_426 _427 _428-> (let _expr_18=(u (u fm_parser_make_lambda _414) _421) in (u (u (u parser_reply_value _426) _427) (u (u fm_term_ori _428) _expr_18)))); }))); }))); }))); }))); }))))
fm_parser_lambda_erased = (\_idx_1-> (\_code_2-> (let _429 = (u (u fm_parser_init _idx_1) _code_2) in (case _429 of {(0,f) -> u f (\_430 _431 _432-> (u (u (u parser_reply_error _430) _431) _432)); (1,f) -> u f (\_433 _434 _435-> (let _436 = (u (u (u fm_parser_text "<") _433) _434) in (case _436 of {(0,f) -> u f (\_437 _438 _439-> (u (u (u parser_reply_error _437) _438) _439)); (1,f) -> u f (\_440 _441 _442-> (let _443 = (u (u (u (u parser_until1 (u fm_parser_text ">")) (u fm_parser_item fm_parser_name1)) _440) _441) in (case _443 of {(0,f) -> u f (\_444 _445 _446-> (u (u (u parser_reply_error _444) _445) _446)); (1,f) -> u f (\_447 _448 _449-> (let _450 = (u (u fm_parser_term _447) _448) in (case _450 of {(0,f) -> u f (\_451 _452 _453-> (u (u (u parser_reply_error _451) _452) _453)); (1,f) -> u f (\_454 _455 _456-> (let _457 = (u (u (u fm_parser_stop _435) _454) _455) in (case _457 of {(0,f) -> u f (\_458 _459 _460-> (u (u (u parser_reply_error _458) _459) _460)); (1,f) -> u f (\_461 _462 _463-> (let _expr_18=(u (u fm_parser_make_lambda _449) _456) in (u (u (u parser_reply_value _461) _462) (u (u fm_term_ori _463) _expr_18)))); }))); }))); }))); }))); }))))
fm_parser_lambda_nameless = (\_idx_1-> (\_code_2-> (let _464 = (u (u fm_parser_init _idx_1) _code_2) in (case _464 of {(0,f) -> u f (\_465 _466 _467-> (u (u (u parser_reply_error _465) _466) _467)); (1,f) -> u f (\_468 _469 _470-> (let _471 = (u (u (u fm_parser_text "()") _468) _469) in (case _471 of {(0,f) -> u f (\_472 _473 _474-> (u (u (u parser_reply_error _472) _473) _474)); (1,f) -> u f (\_475 _476 _477-> (let _478 = (u (u fm_parser_term _475) _476) in (case _478 of {(0,f) -> u f (\_479 _480 _481-> (u (u (u parser_reply_error _479) _480) _481)); (1,f) -> u f (\_482 _483 _484-> (let _485 = (u (u (u fm_parser_stop _470) _482) _483) in (case _485 of {(0,f) -> u f (\_486 _487 _488-> (u (u (u parser_reply_error _486) _487) _488)); (1,f) -> u f (\_489 _490 _491-> (let _expr_15=(u (u fm_term_lam "") (\_x_15-> _484)) in (u (u (u parser_reply_value _489) _490) (u (u fm_term_ori _491) _expr_15)))); }))); }))); }))); }))))
fm_parser_parenthesis = (\_idx_1-> (\_code_2-> (let _492 = (u (u (u fm_parser_text "(") _idx_1) _code_2) in (case _492 of {(0,f) -> u f (\_493 _494 _495-> (u (u (u parser_reply_error _493) _494) _495)); (1,f) -> u f (\_496 _497 _498-> (let _499 = (u (u fm_parser_term _496) _497) in (case _499 of {(0,f) -> u f (\_500 _501 _502-> (u (u (u parser_reply_error _500) _501) _502)); (1,f) -> u f (\_503 _504 _505-> (let _506 = (u (u (u fm_parser_text ")") _503) _504) in (case _506 of {(0,f) -> u f (\_507 _508 _509-> (u (u (u parser_reply_error _507) _508) _509)); (1,f) -> u f (\_510 _511 _512-> (u (u (u parser_reply_value _510) _511) _505)); }))); }))); }))))
fm_term_ref = (\_name_1-> (1,\t-> t _name_1))
fm_term_app = (\_func_1-> (\_argm_2-> (5,\t-> t _func_1 _argm_2)))
fm_term_hol = (\_path_1-> (10,\t-> t _path_1))
fm_term_let = (\_name_1-> (\_expr_2-> (\_body_3-> (6,\t-> t _name_1 _expr_2 _body_3))))
fm_parser_letforrange_u32 = (\_idx_1-> (\_code_2-> (let _513 = (u (u fm_parser_init _idx_1) _code_2) in (case _513 of {(0,f) -> u f (\_514 _515 _516-> (u (u (u parser_reply_error _514) _515) _516)); (1,f) -> u f (\_517 _518 _519-> (let _520 = (u (u (u fm_parser_text "let ") _517) _518) in (case _520 of {(0,f) -> u f (\_521 _522 _523-> (u (u (u parser_reply_error _521) _522) _523)); (1,f) -> u f (\_524 _525 _526-> (let _527 = (u (u fm_parser_name1 _524) _525) in (case _527 of {(0,f) -> u f (\_528 _529 _530-> (u (u (u parser_reply_error _528) _529) _530)); (1,f) -> u f (\_531 _532 _533-> (let _534 = (u (u (u fm_parser_text "=") _531) _532) in (case _534 of {(0,f) -> u f (\_535 _536 _537-> (u (u (u parser_reply_error _535) _536) _537)); (1,f) -> u f (\_538 _539 _540-> (let _541 = (u (u (u fm_parser_text "for ") _538) _539) in (case _541 of {(0,f) -> u f (\_542 _543 _544-> (u (u (u parser_reply_error _542) _543) _544)); (1,f) -> u f (\_545 _546 _547-> (let _548 = (u (u fm_parser_name1 _545) _546) in (case _548 of {(0,f) -> u f (\_549 _550 _551-> (u (u (u parser_reply_error _549) _550) _551)); (1,f) -> u f (\_552 _553 _554-> (let _555 = (u (u (u fm_parser_text ":") _552) _553) in (case _555 of {(0,f) -> u f (\_556 _557 _558-> (u (u (u parser_reply_error _556) _557) _558)); (1,f) -> u f (\_559 _560 _561-> (let _562 = (u (u (u fm_parser_text "U32") _559) _560) in (case _562 of {(0,f) -> u f (\_563 _564 _565-> (u (u (u parser_reply_error _563) _564) _565)); (1,f) -> u f (\_566 _567 _568-> (let _569 = (u (u (u fm_parser_text "=") _566) _567) in (case _569 of {(0,f) -> u f (\_570 _571 _572-> (u (u (u parser_reply_error _570) _571) _572)); (1,f) -> u f (\_573 _574 _575-> (let _576 = (u (u fm_parser_term _573) _574) in (case _576 of {(0,f) -> u f (\_577 _578 _579-> (u (u (u parser_reply_error _577) _578) _579)); (1,f) -> u f (\_580 _581 _582-> (let _583 = (u (u (u fm_parser_text "..") _580) _581) in (case _583 of {(0,f) -> u f (\_584 _585 _586-> (u (u (u parser_reply_error _584) _585) _586)); (1,f) -> u f (\_587 _588 _589-> (let _590 = (u (u fm_parser_term _587) _588) in (case _590 of {(0,f) -> u f (\_591 _592 _593-> (u (u (u parser_reply_error _591) _592) _593)); (1,f) -> u f (\_594 _595 _596-> (let _597 = (u (u (u fm_parser_text ":") _594) _595) in (case _597 of {(0,f) -> u f (\_598 _599 _600-> (u (u (u parser_reply_error _598) _599) _600)); (1,f) -> u f (\_601 _602 _603-> (let _604 = (u (u fm_parser_term _601) _602) in (case _604 of {(0,f) -> u f (\_605 _606 _607-> (u (u (u parser_reply_error _605) _606) _607)); (1,f) -> u f (\_608 _609 _610-> (let _611 = (u (u (u parser_maybe (u fm_parser_text ";")) _608) _609) in (case _611 of {(0,f) -> u f (\_612 _613 _614-> (u (u (u parser_reply_error _612) _613) _614)); (1,f) -> u f (\_615 _616 _617-> (let _618 = (u (u fm_parser_term _615) _616) in (case _618 of {(0,f) -> u f (\_619 _620 _621-> (u (u (u parser_reply_error _619) _620) _621)); (1,f) -> u f (\_622 _623 _624-> (let _625 = (u (u (u fm_parser_stop _519) _622) _623) in (case _625 of {(0,f) -> u f (\_626 _627 _628-> (u (u (u parser_reply_error _626) _627) _628)); (1,f) -> u f (\_629 _630 _631-> (let _term_54=(u fm_term_ref "U32.for") in (let _term_55=(u (u fm_term_app _term_54) (u fm_term_hol bits_e)) in (let _term_56=(u (u fm_term_app _term_55) (u fm_term_ref _533)) in (let _term_57=(u (u fm_term_app _term_56) _582) in (let _term_58=(u (u fm_term_app _term_57) _596) in (let _lamb_59=(u (u fm_term_lam _554) (\_e_59-> (u (u fm_term_lam _533) (\_s_60-> _610)))) in (let _term_60=(u (u fm_term_app _term_58) _lamb_59) in (let _term_61=(u (u (u fm_term_let _533) _term_60) (\_x_61-> _624)) in (u (u (u parser_reply_value _629) _630) (u (u fm_term_ori _631) _term_61))))))))))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))))
fm_parser_letforin = (\_idx_1-> (\_code_2-> (let _632 = (u (u fm_parser_init _idx_1) _code_2) in (case _632 of {(0,f) -> u f (\_633 _634 _635-> (u (u (u parser_reply_error _633) _634) _635)); (1,f) -> u f (\_636 _637 _638-> (let _639 = (u (u (u fm_parser_text "let ") _636) _637) in (case _639 of {(0,f) -> u f (\_640 _641 _642-> (u (u (u parser_reply_error _640) _641) _642)); (1,f) -> u f (\_643 _644 _645-> (let _646 = (u (u fm_parser_name1 _643) _644) in (case _646 of {(0,f) -> u f (\_647 _648 _649-> (u (u (u parser_reply_error _647) _648) _649)); (1,f) -> u f (\_650 _651 _652-> (let _653 = (u (u (u fm_parser_text "=") _650) _651) in (case _653 of {(0,f) -> u f (\_654 _655 _656-> (u (u (u parser_reply_error _654) _655) _656)); (1,f) -> u f (\_657 _658 _659-> (let _660 = (u (u (u fm_parser_text "for ") _657) _658) in (case _660 of {(0,f) -> u f (\_661 _662 _663-> (u (u (u parser_reply_error _661) _662) _663)); (1,f) -> u f (\_664 _665 _666-> (let _667 = (u (u fm_parser_name1 _664) _665) in (case _667 of {(0,f) -> u f (\_668 _669 _670-> (u (u (u parser_reply_error _668) _669) _670)); (1,f) -> u f (\_671 _672 _673-> (let _674 = (u (u (u fm_parser_text "in") _671) _672) in (case _674 of {(0,f) -> u f (\_675 _676 _677-> (u (u (u parser_reply_error _675) _676) _677)); (1,f) -> u f (\_678 _679 _680-> (let _681 = (u (u fm_parser_term _678) _679) in (case _681 of {(0,f) -> u f (\_682 _683 _684-> (u (u (u parser_reply_error _682) _683) _684)); (1,f) -> u f (\_685 _686 _687-> (let _688 = (u (u (u fm_parser_text ":") _685) _686) in (case _688 of {(0,f) -> u f (\_689 _690 _691-> (u (u (u parser_reply_error _689) _690) _691)); (1,f) -> u f (\_692 _693 _694-> (let _695 = (u (u fm_parser_term _692) _693) in (case _695 of {(0,f) -> u f (\_696 _697 _698-> (u (u (u parser_reply_error _696) _697) _698)); (1,f) -> u f (\_699 _700 _701-> (let _702 = (u (u (u parser_maybe (u fm_parser_text ";")) _699) _700) in (case _702 of {(0,f) -> u f (\_703 _704 _705-> (u (u (u parser_reply_error _703) _704) _705)); (1,f) -> u f (\_706 _707 _708-> (let _709 = (u (u fm_parser_term _706) _707) in (case _709 of {(0,f) -> u f (\_710 _711 _712-> (u (u (u parser_reply_error _710) _711) _712)); (1,f) -> u f (\_713 _714 _715-> (let _716 = (u (u (u fm_parser_stop _638) _713) _714) in (case _716 of {(0,f) -> u f (\_717 _718 _719-> (u (u (u parser_reply_error _717) _718) _719)); (1,f) -> u f (\_720 _721 _722-> (let _term_42=(u fm_term_ref "List.for") in (let _term_43=(u (u fm_term_app _term_42) (u fm_term_hol bits_e)) in (let _term_44=(u (u fm_term_app _term_43) _687) in (let _term_45=(u (u fm_term_app _term_44) (u fm_term_hol bits_e)) in (let _term_46=(u (u fm_term_app _term_45) (u fm_term_ref _652)) in (let _lamb_47=(u (u fm_term_lam _673) (\_i_47-> (u (u fm_term_lam _652) (\_x_48-> _701)))) in (let _term_48=(u (u fm_term_app _term_46) _lamb_47) in (let _term_49=(u (u (u fm_term_let _652) _term_48) (\_x_49-> _715)) in (u (u (u parser_reply_value _720) _721) (u (u fm_term_ori _722) _term_49))))))))))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))))
fm_parser_let = (\_idx_1-> (\_code_2-> (let _723 = (u (u fm_parser_init _idx_1) _code_2) in (case _723 of {(0,f) -> u f (\_724 _725 _726-> (u (u (u parser_reply_error _724) _725) _726)); (1,f) -> u f (\_727 _728 _729-> (let _730 = (u (u (u fm_parser_text "let ") _727) _728) in (case _730 of {(0,f) -> u f (\_731 _732 _733-> (u (u (u parser_reply_error _731) _732) _733)); (1,f) -> u f (\_734 _735 _736-> (let _737 = (u (u fm_parser_name _734) _735) in (case _737 of {(0,f) -> u f (\_738 _739 _740-> (u (u (u parser_reply_error _738) _739) _740)); (1,f) -> u f (\_741 _742 _743-> (let _744 = (u (u (u fm_parser_text "=") _741) _742) in (case _744 of {(0,f) -> u f (\_745 _746 _747-> (u (u (u parser_reply_error _745) _746) _747)); (1,f) -> u f (\_748 _749 _750-> (let _751 = (u (u fm_parser_term _748) _749) in (case _751 of {(0,f) -> u f (\_752 _753 _754-> (u (u (u parser_reply_error _752) _753) _754)); (1,f) -> u f (\_755 _756 _757-> (let _758 = (u (u (u parser_maybe (u fm_parser_text ";")) _755) _756) in (case _758 of {(0,f) -> u f (\_759 _760 _761-> (u (u (u parser_reply_error _759) _760) _761)); (1,f) -> u f (\_762 _763 _764-> (let _765 = (u (u fm_parser_term _762) _763) in (case _765 of {(0,f) -> u f (\_766 _767 _768-> (u (u (u parser_reply_error _766) _767) _768)); (1,f) -> u f (\_769 _770 _771-> (let _772 = (u (u (u fm_parser_stop _729) _769) _770) in (case _772 of {(0,f) -> u f (\_773 _774 _775-> (u (u (u parser_reply_error _773) _774) _775)); (1,f) -> u f (\_776 _777 _778-> (u (u (u parser_reply_value _776) _777) (u (u fm_term_ori _778) (u (u (u fm_term_let _743) _757) (\_x_27-> _771))))); }))); }))); }))); }))); }))); }))); }))); }))))
fm_parser_get = (\_idx_1-> (\_code_2-> (let _779 = (u (u fm_parser_init _idx_1) _code_2) in (case _779 of {(0,f) -> u f (\_780 _781 _782-> (u (u (u parser_reply_error _780) _781) _782)); (1,f) -> u f (\_783 _784 _785-> (let _786 = (u (u (u fm_parser_text "let ") _783) _784) in (case _786 of {(0,f) -> u f (\_787 _788 _789-> (u (u (u parser_reply_error _787) _788) _789)); (1,f) -> u f (\_790 _791 _792-> (let _793 = (u (u (u fm_parser_text "{") _790) _791) in (case _793 of {(0,f) -> u f (\_794 _795 _796-> (u (u (u parser_reply_error _794) _795) _796)); (1,f) -> u f (\_797 _798 _799-> (let _800 = (u (u fm_parser_name _797) _798) in (case _800 of {(0,f) -> u f (\_801 _802 _803-> (u (u (u parser_reply_error _801) _802) _803)); (1,f) -> u f (\_804 _805 _806-> (let _807 = (u (u (u fm_parser_text ",") _804) _805) in (case _807 of {(0,f) -> u f (\_808 _809 _810-> (u (u (u parser_reply_error _808) _809) _810)); (1,f) -> u f (\_811 _812 _813-> (let _814 = (u (u fm_parser_name _811) _812) in (case _814 of {(0,f) -> u f (\_815 _816 _817-> (u (u (u parser_reply_error _815) _816) _817)); (1,f) -> u f (\_818 _819 _820-> (let _821 = (u (u (u fm_parser_text "}") _818) _819) in (case _821 of {(0,f) -> u f (\_822 _823 _824-> (u (u (u parser_reply_error _822) _823) _824)); (1,f) -> u f (\_825 _826 _827-> (let _828 = (u (u (u fm_parser_text "=") _825) _826) in (case _828 of {(0,f) -> u f (\_829 _830 _831-> (u (u (u parser_reply_error _829) _830) _831)); (1,f) -> u f (\_832 _833 _834-> (let _835 = (u (u fm_parser_term _832) _833) in (case _835 of {(0,f) -> u f (\_836 _837 _838-> (u (u (u parser_reply_error _836) _837) _838)); (1,f) -> u f (\_839 _840 _841-> (let _842 = (u (u (u parser_maybe (u fm_parser_text ";")) _839) _840) in (case _842 of {(0,f) -> u f (\_843 _844 _845-> (u (u (u parser_reply_error _843) _844) _845)); (1,f) -> u f (\_846 _847 _848-> (let _849 = (u (u fm_parser_term _846) _847) in (case _849 of {(0,f) -> u f (\_850 _851 _852-> (u (u (u parser_reply_error _850) _851) _852)); (1,f) -> u f (\_853 _854 _855-> (let _856 = (u (u (u fm_parser_stop _785) _853) _854) in (case _856 of {(0,f) -> u f (\_857 _858 _859-> (u (u (u parser_reply_error _857) _858) _859)); (1,f) -> u f (\_860 _861 _862-> (let _term_39=_841 in (let _term_40=(u (u fm_term_app _term_39) (u (u fm_term_lam "x") (\_x_40-> (u fm_term_hol bits_e)))) in (let _term_41=(u (u fm_term_app _term_40) (u (u fm_term_lam _806) (\_x_41-> (u (u fm_term_lam _820) (\_y_42-> _855))))) in (u (u (u parser_reply_value _860) _861) (u (u fm_term_ori _862) _term_41)))))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))))
fm_term_def = (\_name_1-> (\_expr_2-> (\_body_3-> (7,\t-> t _name_1 _expr_2 _body_3))))
fm_parser_def = (\_idx_1-> (\_code_2-> (let _863 = (u (u fm_parser_init _idx_1) _code_2) in (case _863 of {(0,f) -> u f (\_864 _865 _866-> (u (u (u parser_reply_error _864) _865) _866)); (1,f) -> u f (\_867 _868 _869-> (let _870 = (u (u (u fm_parser_text "def ") _867) _868) in (case _870 of {(0,f) -> u f (\_871 _872 _873-> (u (u (u parser_reply_error _871) _872) _873)); (1,f) -> u f (\_874 _875 _876-> (let _877 = (u (u fm_parser_name _874) _875) in (case _877 of {(0,f) -> u f (\_878 _879 _880-> (u (u (u parser_reply_error _878) _879) _880)); (1,f) -> u f (\_881 _882 _883-> (let _884 = (u (u (u fm_parser_text "=") _881) _882) in (case _884 of {(0,f) -> u f (\_885 _886 _887-> (u (u (u parser_reply_error _885) _886) _887)); (1,f) -> u f (\_888 _889 _890-> (let _891 = (u (u fm_parser_term _888) _889) in (case _891 of {(0,f) -> u f (\_892 _893 _894-> (u (u (u parser_reply_error _892) _893) _894)); (1,f) -> u f (\_895 _896 _897-> (let _898 = (u (u (u parser_maybe (u fm_parser_text ";")) _895) _896) in (case _898 of {(0,f) -> u f (\_899 _900 _901-> (u (u (u parser_reply_error _899) _900) _901)); (1,f) -> u f (\_902 _903 _904-> (let _905 = (u (u fm_parser_term _902) _903) in (case _905 of {(0,f) -> u f (\_906 _907 _908-> (u (u (u parser_reply_error _906) _907) _908)); (1,f) -> u f (\_909 _910 _911-> (let _912 = (u (u (u fm_parser_stop _869) _909) _910) in (case _912 of {(0,f) -> u f (\_913 _914 _915-> (u (u (u parser_reply_error _913) _914) _915)); (1,f) -> u f (\_916 _917 _918-> (u (u (u parser_reply_value _916) _917) (u (u fm_term_ori _918) (u (u (u fm_term_def _883) _897) (\_x_27-> _911))))); }))); }))); }))); }))); }))); }))); }))); }))))
fm_parser_if = (\_idx_1-> (\_code_2-> (let _919 = (u (u fm_parser_init _idx_1) _code_2) in (case _919 of {(0,f) -> u f (\_920 _921 _922-> (u (u (u parser_reply_error _920) _921) _922)); (1,f) -> u f (\_923 _924 _925-> (let _926 = (u (u (u fm_parser_text "if ") _923) _924) in (case _926 of {(0,f) -> u f (\_927 _928 _929-> (u (u (u parser_reply_error _927) _928) _929)); (1,f) -> u f (\_930 _931 _932-> (let _933 = (u (u fm_parser_term _930) _931) in (case _933 of {(0,f) -> u f (\_934 _935 _936-> (u (u (u parser_reply_error _934) _935) _936)); (1,f) -> u f (\_937 _938 _939-> (let _940 = (u (u (u fm_parser_text "then") _937) _938) in (case _940 of {(0,f) -> u f (\_941 _942 _943-> (u (u (u parser_reply_error _941) _942) _943)); (1,f) -> u f (\_944 _945 _946-> (let _947 = (u (u fm_parser_term _944) _945) in (case _947 of {(0,f) -> u f (\_948 _949 _950-> (u (u (u parser_reply_error _948) _949) _950)); (1,f) -> u f (\_951 _952 _953-> (let _954 = (u (u (u fm_parser_text "else") _951) _952) in (case _954 of {(0,f) -> u f (\_955 _956 _957-> (u (u (u parser_reply_error _955) _956) _957)); (1,f) -> u f (\_958 _959 _960-> (let _961 = (u (u fm_parser_term _958) _959) in (case _961 of {(0,f) -> u f (\_962 _963 _964-> (u (u (u parser_reply_error _962) _963) _964)); (1,f) -> u f (\_965 _966 _967-> (let _968 = (u (u (u fm_parser_stop _925) _965) _966) in (case _968 of {(0,f) -> u f (\_969 _970 _971-> (u (u (u parser_reply_error _969) _970) _971)); (1,f) -> u f (\_972 _973 _974-> (let _term_27=_939 in (let _term_28=(u (u fm_term_app _term_27) (u (u fm_term_lam "") (\_x_28-> (u fm_term_hol bits_e)))) in (let _term_29=(u (u fm_term_app _term_28) _953) in (let _term_30=(u (u fm_term_app _term_29) _967) in (u (u (u parser_reply_value _972) _973) (u (u fm_term_ori _974) _term_30))))))); }))); }))); }))); }))); }))); }))); }))); }))))
list_mapped = (\_as_2-> (\_f_4-> (let _975 = _as_2 in (case _975 of {(0,f) -> u f (list_nil); (1,f) -> u f (\_976 _977-> (u (u list_cons (u _f_4 _976)) (u (u list_mapped _977) _f_4))); }))))
pair_new = (\_fst_3-> (\_snd_4-> (0,\t-> t _fst_3 _snd_4)))
fm_backslash = 92
fm_escapes = (u (u list_cons (u (u pair_new "\\b") 8)) (u (u list_cons (u (u pair_new "\\f") 12)) (u (u list_cons (u (u pair_new "\\n") 10)) (u (u list_cons (u (u pair_new "\\r") 13)) (u (u list_cons (u (u pair_new "\\t") 9)) (u (u list_cons (u (u pair_new "\\v") 11)) (u (u list_cons (u (u pair_new (u (u string_cons fm_backslash) (u (u string_cons fm_backslash) string_nil))) fm_backslash)) (u (u list_cons (u (u pair_new "\\\"") 34)) (u (u list_cons (u (u pair_new "\\0") 0)) (u (u list_cons (u (u pair_new "\\'") 39)) list_nil))))))))))
fm_parser_char_single = (u parser_first_of (u (u list_cons (u parser_first_of (u (u list_mapped fm_escapes) (\_esc_1-> (let _978 = _esc_1 in (case _978 of {(0,f) -> u f (\_979 _980-> (\_idx_4-> (\_code_5-> (let _981 = (u (u (u parser_text _979) _idx_4) _code_5) in (case _981 of {(0,f) -> u f (\_982 _983 _984-> (u (u (u parser_reply_error _982) _983) _984)); (1,f) -> u f (\_985 _986 _987-> (u (u (u parser_reply_value _985) _986) _980)); }))))); })))))) (u (u list_cons parser_one) list_nil)))
fm_term_chr = (\_chrx_1-> (12,\t-> t _chrx_1))
fm_parser_char = (\_idx_1-> (\_code_2-> (let _988 = (u (u fm_parser_init _idx_1) _code_2) in (case _988 of {(0,f) -> u f (\_989 _990 _991-> (u (u (u parser_reply_error _989) _990) _991)); (1,f) -> u f (\_992 _993 _994-> (let _995 = (u (u (u fm_parser_text "'") _992) _993) in (case _995 of {(0,f) -> u f (\_996 _997 _998-> (u (u (u parser_reply_error _996) _997) _998)); (1,f) -> u f (\_999 _1000 _1001-> (let _1002 = (u (u fm_parser_char_single _999) _1000) in (case _1002 of {(0,f) -> u f (\_1003 _1004 _1005-> (u (u (u parser_reply_error _1003) _1004) _1005)); (1,f) -> u f (\_1006 _1007 _1008-> (let _1009 = (u (u (u parser_text "'") _1006) _1007) in (case _1009 of {(0,f) -> u f (\_1010 _1011 _1012-> (u (u (u parser_reply_error _1010) _1011) _1012)); (1,f) -> u f (\_1013 _1014 _1015-> (let _1016 = (u (u (u fm_parser_stop _994) _1013) _1014) in (case _1016 of {(0,f) -> u f (\_1017 _1018 _1019-> (u (u (u parser_reply_error _1017) _1018) _1019)); (1,f) -> u f (\_1020 _1021 _1022-> (u (u (u parser_reply_value _1020) _1021) (u (u fm_term_ori _1022) (u fm_term_chr _1008)))); }))); }))); }))); }))); }))))
fm_term_str = (\_strx_1-> (13,\t-> t _strx_1))
fm_parser_string = (\_idx_1-> (\_code_2-> (let _1023 = (u (u fm_parser_init _idx_1) _code_2) in (case _1023 of {(0,f) -> u f (\_1024 _1025 _1026-> (u (u (u parser_reply_error _1024) _1025) _1026)); (1,f) -> u f (\_1027 _1028 _1029-> (let _quot_6=(u (u string_cons 34) string_nil) in (let _1030 = (u (u (u fm_parser_text _quot_6) _1027) _1028) in (case _1030 of {(0,f) -> u f (\_1031 _1032 _1033-> (u (u (u parser_reply_error _1031) _1032) _1033)); (1,f) -> u f (\_1034 _1035 _1036-> (let _1037 = (u (u (u (u parser_until (u parser_text _quot_6)) fm_parser_char_single) _1034) _1035) in (case _1037 of {(0,f) -> u f (\_1038 _1039 _1040-> (u (u (u parser_reply_error _1038) _1039) _1040)); (1,f) -> u f (\_1041 _1042 _1043-> (let _strx_13=(u (u (u list_fold _1043) string_nil) string_cons) in (let _1044 = (u (u (u fm_parser_stop _1029) _1041) _1042) in (case _1044 of {(0,f) -> u f (\_1045 _1046 _1047-> (u (u (u parser_reply_error _1045) _1046) _1047)); (1,f) -> u f (\_1048 _1049 _1050-> (u (u (u parser_reply_value _1048) _1049) (u (u fm_term_ori _1050) (u fm_term_str _strx_13)))); })))); }))); })))); }))))
fm_parser_pair = (\_idx_1-> (\_code_2-> (let _1051 = (u (u fm_parser_init _idx_1) _code_2) in (case _1051 of {(0,f) -> u f (\_1052 _1053 _1054-> (u (u (u parser_reply_error _1052) _1053) _1054)); (1,f) -> u f (\_1055 _1056 _1057-> (let _1058 = (u (u (u fm_parser_text "{") _1055) _1056) in (case _1058 of {(0,f) -> u f (\_1059 _1060 _1061-> (u (u (u parser_reply_error _1059) _1060) _1061)); (1,f) -> u f (\_1062 _1063 _1064-> (let _1065 = (u (u fm_parser_term _1062) _1063) in (case _1065 of {(0,f) -> u f (\_1066 _1067 _1068-> (u (u (u parser_reply_error _1066) _1067) _1068)); (1,f) -> u f (\_1069 _1070 _1071-> (let _1072 = (u (u (u fm_parser_text ",") _1069) _1070) in (case _1072 of {(0,f) -> u f (\_1073 _1074 _1075-> (u (u (u parser_reply_error _1073) _1074) _1075)); (1,f) -> u f (\_1076 _1077 _1078-> (let _1079 = (u (u fm_parser_term _1076) _1077) in (case _1079 of {(0,f) -> u f (\_1080 _1081 _1082-> (u (u (u parser_reply_error _1080) _1081) _1082)); (1,f) -> u f (\_1083 _1084 _1085-> (let _1086 = (u (u (u fm_parser_text "}") _1083) _1084) in (case _1086 of {(0,f) -> u f (\_1087 _1088 _1089-> (u (u (u parser_reply_error _1087) _1088) _1089)); (1,f) -> u f (\_1090 _1091 _1092-> (let _1093 = (u (u (u fm_parser_stop _1057) _1090) _1091) in (case _1093 of {(0,f) -> u f (\_1094 _1095 _1096-> (u (u (u parser_reply_error _1094) _1095) _1096)); (1,f) -> u f (\_1097 _1098 _1099-> (let _term_24=(u fm_term_ref "Pair.new") in (let _term_25=(u (u fm_term_app _term_24) (u fm_term_hol bits_e)) in (let _term_26=(u (u fm_term_app _term_25) (u fm_term_hol bits_e)) in (let _term_27=(u (u fm_term_app _term_26) _1071) in (let _term_28=(u (u fm_term_app _term_27) _1085) in (u (u (u parser_reply_value _1097) _1098) (u (u fm_term_ori _1099) _term_28)))))))); }))); }))); }))); }))); }))); }))); }))))
fm_parser_sigma_type = (\_idx_1-> (\_code_2-> (let _1100 = (u (u fm_parser_init _idx_1) _code_2) in (case _1100 of {(0,f) -> u f (\_1101 _1102 _1103-> (u (u (u parser_reply_error _1101) _1102) _1103)); (1,f) -> u f (\_1104 _1105 _1106-> (let _1107 = (u (u (u fm_parser_text "{") _1104) _1105) in (case _1107 of {(0,f) -> u f (\_1108 _1109 _1110-> (u (u (u parser_reply_error _1108) _1109) _1110)); (1,f) -> u f (\_1111 _1112 _1113-> (let _1114 = (u (u fm_parser_name1 _1111) _1112) in (case _1114 of {(0,f) -> u f (\_1115 _1116 _1117-> (u (u (u parser_reply_error _1115) _1116) _1117)); (1,f) -> u f (\_1118 _1119 _1120-> (let _1121 = (u (u (u fm_parser_text ":") _1118) _1119) in (case _1121 of {(0,f) -> u f (\_1122 _1123 _1124-> (u (u (u parser_reply_error _1122) _1123) _1124)); (1,f) -> u f (\_1125 _1126 _1127-> (let _1128 = (u (u fm_parser_term _1125) _1126) in (case _1128 of {(0,f) -> u f (\_1129 _1130 _1131-> (u (u (u parser_reply_error _1129) _1130) _1131)); (1,f) -> u f (\_1132 _1133 _1134-> (let _1135 = (u (u (u fm_parser_text "}") _1132) _1133) in (case _1135 of {(0,f) -> u f (\_1136 _1137 _1138-> (u (u (u parser_reply_error _1136) _1137) _1138)); (1,f) -> u f (\_1139 _1140 _1141-> (let _1142 = (u (u fm_parser_term _1139) _1140) in (case _1142 of {(0,f) -> u f (\_1143 _1144 _1145-> (u (u (u parser_reply_error _1143) _1144) _1145)); (1,f) -> u f (\_1146 _1147 _1148-> (let _1149 = (u (u (u fm_parser_stop _1106) _1146) _1147) in (case _1149 of {(0,f) -> u f (\_1150 _1151 _1152-> (u (u (u parser_reply_error _1150) _1151) _1152)); (1,f) -> u f (\_1153 _1154 _1155-> (let _term_27=(u fm_term_ref "Sigma") in (let _term_28=(u (u fm_term_app _term_27) _1134) in (let _term_29=(u (u fm_term_app _term_28) (u (u fm_term_lam "x") (\_x_29-> _1148))) in (u (u (u parser_reply_value _1153) _1154) (u (u fm_term_ori _1155) _term_29)))))); }))); }))); }))); }))); }))); }))); }))); }))))
fm_parser_some = (\_idx_1-> (\_code_2-> (let _1156 = (u (u fm_parser_init _idx_1) _code_2) in (case _1156 of {(0,f) -> u f (\_1157 _1158 _1159-> (u (u (u parser_reply_error _1157) _1158) _1159)); (1,f) -> u f (\_1160 _1161 _1162-> (let _1163 = (u (u (u fm_parser_text "some(") _1160) _1161) in (case _1163 of {(0,f) -> u f (\_1164 _1165 _1166-> (u (u (u parser_reply_error _1164) _1165) _1166)); (1,f) -> u f (\_1167 _1168 _1169-> (let _1170 = (u (u fm_parser_term _1167) _1168) in (case _1170 of {(0,f) -> u f (\_1171 _1172 _1173-> (u (u (u parser_reply_error _1171) _1172) _1173)); (1,f) -> u f (\_1174 _1175 _1176-> (let _1177 = (u (u (u fm_parser_text ")") _1174) _1175) in (case _1177 of {(0,f) -> u f (\_1178 _1179 _1180-> (u (u (u parser_reply_error _1178) _1179) _1180)); (1,f) -> u f (\_1181 _1182 _1183-> (let _1184 = (u (u (u fm_parser_stop _1162) _1181) _1182) in (case _1184 of {(0,f) -> u f (\_1185 _1186 _1187-> (u (u (u parser_reply_error _1185) _1186) _1187)); (1,f) -> u f (\_1188 _1189 _1190-> (let _term_18=(u fm_term_ref "Maybe.some") in (let _term_19=(u (u fm_term_app _term_18) (u fm_term_hol bits_e)) in (let _term_20=(u (u fm_term_app _term_19) _1176) in (u (u (u parser_reply_value _1188) _1189) (u (u fm_term_ori _1190) _term_20)))))); }))); }))); }))); }))); }))))
fm_parser_apply = (\_idx_1-> (\_code_2-> (let _1191 = (u (u fm_parser_init _idx_1) _code_2) in (case _1191 of {(0,f) -> u f (\_1192 _1193 _1194-> (u (u (u parser_reply_error _1192) _1193) _1194)); (1,f) -> u f (\_1195 _1196 _1197-> (let _1198 = (u (u (u fm_parser_text "apply(") _1195) _1196) in (case _1198 of {(0,f) -> u f (\_1199 _1200 _1201-> (u (u (u parser_reply_error _1199) _1200) _1201)); (1,f) -> u f (\_1202 _1203 _1204-> (let _1205 = (u (u fm_parser_term _1202) _1203) in (case _1205 of {(0,f) -> u f (\_1206 _1207 _1208-> (u (u (u parser_reply_error _1206) _1207) _1208)); (1,f) -> u f (\_1209 _1210 _1211-> (let _1212 = (u (u (u fm_parser_text ",") _1209) _1210) in (case _1212 of {(0,f) -> u f (\_1213 _1214 _1215-> (u (u (u parser_reply_error _1213) _1214) _1215)); (1,f) -> u f (\_1216 _1217 _1218-> (let _1219 = (u (u fm_parser_term _1216) _1217) in (case _1219 of {(0,f) -> u f (\_1220 _1221 _1222-> (u (u (u parser_reply_error _1220) _1221) _1222)); (1,f) -> u f (\_1223 _1224 _1225-> (let _1226 = (u (u (u fm_parser_text ")") _1223) _1224) in (case _1226 of {(0,f) -> u f (\_1227 _1228 _1229-> (u (u (u parser_reply_error _1227) _1228) _1229)); (1,f) -> u f (\_1230 _1231 _1232-> (let _1233 = (u (u (u fm_parser_stop _1197) _1230) _1231) in (case _1233 of {(0,f) -> u f (\_1234 _1235 _1236-> (u (u (u parser_reply_error _1234) _1235) _1236)); (1,f) -> u f (\_1237 _1238 _1239-> (let _term_24=(u fm_term_ref "Equal.apply") in (let _term_25=(u (u fm_term_app _term_24) (u fm_term_hol bits_e)) in (let _term_26=(u (u fm_term_app _term_25) (u fm_term_hol bits_e)) in (let _term_27=(u (u fm_term_app _term_26) (u fm_term_hol bits_e)) in (let _term_28=(u (u fm_term_app _term_27) (u fm_term_hol bits_e)) in (let _term_29=(u (u fm_term_app _term_28) _1211) in (let _term_30=(u (u fm_term_app _term_29) _1225) in (u (u (u parser_reply_value _1237) _1238) (u (u fm_term_ori _1239) _term_30)))))))))); }))); }))); }))); }))); }))); }))); }))))
fm_name_read = (\_str_1-> _str_1)
fm_parser_list = (\_idx_1-> (\_code_2-> (let _1240 = (u (u fm_parser_init _idx_1) _code_2) in (case _1240 of {(0,f) -> u f (\_1241 _1242 _1243-> (u (u (u parser_reply_error _1241) _1242) _1243)); (1,f) -> u f (\_1244 _1245 _1246-> (let _1247 = (u (u (u fm_parser_text "[") _1244) _1245) in (case _1247 of {(0,f) -> u f (\_1248 _1249 _1250-> (u (u (u parser_reply_error _1248) _1249) _1250)); (1,f) -> u f (\_1251 _1252 _1253-> (let _1254 = (u (u (u (u parser_until (u fm_parser_text "]")) (u fm_parser_item fm_parser_term)) _1251) _1252) in (case _1254 of {(0,f) -> u f (\_1255 _1256 _1257-> (u (u (u parser_reply_error _1255) _1256) _1257)); (1,f) -> u f (\_1258 _1259 _1260-> (let _1261 = (u (u (u fm_parser_stop _1246) _1258) _1259) in (case _1261 of {(0,f) -> u f (\_1262 _1263 _1264-> (u (u (u parser_reply_error _1262) _1263) _1264)); (1,f) -> u f (\_1265 _1266 _1267-> (u (u (u parser_reply_value _1265) _1266) (u (u (u list_fold _1260) (u (u fm_term_app (u fm_term_ref (u fm_name_read "List.nil"))) (u fm_term_hol bits_e))) (\_x_15-> (\_xs_16-> (let _term_17=(u fm_term_ref (u fm_name_read "List.cons")) in (let _term_18=(u (u fm_term_app _term_17) (u fm_term_hol bits_e)) in (let _term_19=(u (u fm_term_app _term_18) _x_15) in (let _term_20=(u (u fm_term_app _term_19) _xs_16) in (u (u fm_term_ori _1267) _term_20)))))))))); }))); }))); }))); }))))
fm_parser_log = (\_idx_1-> (\_code_2-> (let _1268 = (u (u fm_parser_init _idx_1) _code_2) in (case _1268 of {(0,f) -> u f (\_1269 _1270 _1271-> (u (u (u parser_reply_error _1269) _1270) _1271)); (1,f) -> u f (\_1272 _1273 _1274-> (let _1275 = (u (u (u fm_parser_text "log(") _1272) _1273) in (case _1275 of {(0,f) -> u f (\_1276 _1277 _1278-> (u (u (u parser_reply_error _1276) _1277) _1278)); (1,f) -> u f (\_1279 _1280 _1281-> (let _1282 = (u (u (u (u parser_until (u fm_parser_text ")")) (u fm_parser_item fm_parser_term)) _1279) _1280) in (case _1282 of {(0,f) -> u f (\_1283 _1284 _1285-> (u (u (u parser_reply_error _1283) _1284) _1285)); (1,f) -> u f (\_1286 _1287 _1288-> (let _1289 = (u (u fm_parser_term _1286) _1287) in (case _1289 of {(0,f) -> u f (\_1290 _1291 _1292-> (u (u (u parser_reply_error _1290) _1291) _1292)); (1,f) -> u f (\_1293 _1294 _1295-> (let _term_15=(u fm_term_ref "Debug.log") in (let _term_16=(u (u fm_term_app _term_15) (u fm_term_hol bits_e)) in (let _args_17=(u (u (u list_fold _1288) (u fm_term_ref "String.nil")) (\_x_17-> (\_xs_18-> (let _arg_19=(u fm_term_ref "String.concat") in (let _arg_20=(u (u fm_term_app _arg_19) _x_17) in (let _arg_21=(u (u fm_term_app _arg_20) _xs_18) in _arg_21)))))) in (let _term_18=(u (u fm_term_app _term_16) _args_17) in (let _term_19=(u (u fm_term_app _term_18) (u (u fm_term_lam "x") (\_x_19-> _1295))) in (let _1296 = (u (u (u fm_parser_stop _1274) _1293) _1294) in (case _1296 of {(0,f) -> u f (\_1297 _1298 _1299-> (u (u (u parser_reply_error _1297) _1298) _1299)); (1,f) -> u f (\_1300 _1301 _1302-> (u (u (u parser_reply_value _1300) _1301) (u (u fm_term_ori _1302) _term_19))); })))))))); }))); }))); }))); }))))
fm_parser_forrange_u32 = (\_idx_1-> (\_code_2-> (let _1303 = (u (u fm_parser_init _idx_1) _code_2) in (case _1303 of {(0,f) -> u f (\_1304 _1305 _1306-> (u (u (u parser_reply_error _1304) _1305) _1306)); (1,f) -> u f (\_1307 _1308 _1309-> (let _1310 = (u (u (u fm_parser_text "for ") _1307) _1308) in (case _1310 of {(0,f) -> u f (\_1311 _1312 _1313-> (u (u (u parser_reply_error _1311) _1312) _1313)); (1,f) -> u f (\_1314 _1315 _1316-> (let _1317 = (u (u fm_parser_name1 _1314) _1315) in (case _1317 of {(0,f) -> u f (\_1318 _1319 _1320-> (u (u (u parser_reply_error _1318) _1319) _1320)); (1,f) -> u f (\_1321 _1322 _1323-> (let _1324 = (u (u (u fm_parser_text ":") _1321) _1322) in (case _1324 of {(0,f) -> u f (\_1325 _1326 _1327-> (u (u (u parser_reply_error _1325) _1326) _1327)); (1,f) -> u f (\_1328 _1329 _1330-> (let _1331 = (u (u (u fm_parser_text "U32") _1328) _1329) in (case _1331 of {(0,f) -> u f (\_1332 _1333 _1334-> (u (u (u parser_reply_error _1332) _1333) _1334)); (1,f) -> u f (\_1335 _1336 _1337-> (let _1338 = (u (u (u fm_parser_text "=") _1335) _1336) in (case _1338 of {(0,f) -> u f (\_1339 _1340 _1341-> (u (u (u parser_reply_error _1339) _1340) _1341)); (1,f) -> u f (\_1342 _1343 _1344-> (let _1345 = (u (u fm_parser_term _1342) _1343) in (case _1345 of {(0,f) -> u f (\_1346 _1347 _1348-> (u (u (u parser_reply_error _1346) _1347) _1348)); (1,f) -> u f (\_1349 _1350 _1351-> (let _1352 = (u (u (u fm_parser_text "..") _1349) _1350) in (case _1352 of {(0,f) -> u f (\_1353 _1354 _1355-> (u (u (u parser_reply_error _1353) _1354) _1355)); (1,f) -> u f (\_1356 _1357 _1358-> (let _1359 = (u (u fm_parser_term _1356) _1357) in (case _1359 of {(0,f) -> u f (\_1360 _1361 _1362-> (u (u (u parser_reply_error _1360) _1361) _1362)); (1,f) -> u f (\_1363 _1364 _1365-> (let _1366 = (u (u (u fm_parser_text "with") _1363) _1364) in (case _1366 of {(0,f) -> u f (\_1367 _1368 _1369-> (u (u (u parser_reply_error _1367) _1368) _1369)); (1,f) -> u f (\_1370 _1371 _1372-> (let _1373 = (u (u fm_parser_name1 _1370) _1371) in (case _1373 of {(0,f) -> u f (\_1374 _1375 _1376-> (u (u (u parser_reply_error _1374) _1375) _1376)); (1,f) -> u f (\_1377 _1378 _1379-> (let _1380 = (u (u (u fm_parser_text ":") _1377) _1378) in (case _1380 of {(0,f) -> u f (\_1381 _1382 _1383-> (u (u (u parser_reply_error _1381) _1382) _1383)); (1,f) -> u f (\_1384 _1385 _1386-> (let _1387 = (u (u fm_parser_term _1384) _1385) in (case _1387 of {(0,f) -> u f (\_1388 _1389 _1390-> (u (u (u parser_reply_error _1388) _1389) _1390)); (1,f) -> u f (\_1391 _1392 _1393-> (let _1394 = (u (u (u fm_parser_stop _1309) _1391) _1392) in (case _1394 of {(0,f) -> u f (\_1395 _1396 _1397-> (u (u (u parser_reply_error _1395) _1396) _1397)); (1,f) -> u f (\_1398 _1399 _1400-> (let _term_45=(u fm_term_ref "U32.for") in (let _term_46=(u (u fm_term_app _term_45) (u fm_term_hol bits_e)) in (let _term_47=(u (u fm_term_app _term_46) (u fm_term_ref _1379)) in (let _term_48=(u (u fm_term_app _term_47) _1351) in (let _term_49=(u (u fm_term_app _term_48) _1365) in (let _lamb_50=(u (u fm_term_lam _1323) (\_e_50-> (u (u fm_term_lam _1379) (\_s_51-> _1393)))) in (let _term_51=(u (u fm_term_app _term_49) _lamb_50) in (let _term_52=(u (u (u fm_term_let _1379) _term_51) (\_x_52-> (u fm_term_ref _1379))) in (u (u (u parser_reply_value _1398) _1399) (u (u fm_term_ori _1400) _term_52))))))))))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))))
fm_parser_forrange_u32_2 = (\_idx_1-> (\_code_2-> (let _1401 = (u (u fm_parser_init _idx_1) _code_2) in (case _1401 of {(0,f) -> u f (\_1402 _1403 _1404-> (u (u (u parser_reply_error _1402) _1403) _1404)); (1,f) -> u f (\_1405 _1406 _1407-> (let _1408 = (u (u (u fm_parser_text "for ") _1405) _1406) in (case _1408 of {(0,f) -> u f (\_1409 _1410 _1411-> (u (u (u parser_reply_error _1409) _1410) _1411)); (1,f) -> u f (\_1412 _1413 _1414-> (let _1415 = (u (u fm_parser_name1 _1412) _1413) in (case _1415 of {(0,f) -> u f (\_1416 _1417 _1418-> (u (u (u parser_reply_error _1416) _1417) _1418)); (1,f) -> u f (\_1419 _1420 _1421-> (let _1422 = (u (u (u fm_parser_text ":") _1419) _1420) in (case _1422 of {(0,f) -> u f (\_1423 _1424 _1425-> (u (u (u parser_reply_error _1423) _1424) _1425)); (1,f) -> u f (\_1426 _1427 _1428-> (let _1429 = (u (u (u fm_parser_text "U32") _1426) _1427) in (case _1429 of {(0,f) -> u f (\_1430 _1431 _1432-> (u (u (u parser_reply_error _1430) _1431) _1432)); (1,f) -> u f (\_1433 _1434 _1435-> (let _1436 = (u (u (u fm_parser_text "=") _1433) _1434) in (case _1436 of {(0,f) -> u f (\_1437 _1438 _1439-> (u (u (u parser_reply_error _1437) _1438) _1439)); (1,f) -> u f (\_1440 _1441 _1442-> (let _1443 = (u (u fm_parser_term _1440) _1441) in (case _1443 of {(0,f) -> u f (\_1444 _1445 _1446-> (u (u (u parser_reply_error _1444) _1445) _1446)); (1,f) -> u f (\_1447 _1448 _1449-> (let _1450 = (u (u (u fm_parser_text "..") _1447) _1448) in (case _1450 of {(0,f) -> u f (\_1451 _1452 _1453-> (u (u (u parser_reply_error _1451) _1452) _1453)); (1,f) -> u f (\_1454 _1455 _1456-> (let _1457 = (u (u fm_parser_term _1454) _1455) in (case _1457 of {(0,f) -> u f (\_1458 _1459 _1460-> (u (u (u parser_reply_error _1458) _1459) _1460)); (1,f) -> u f (\_1461 _1462 _1463-> (let _1464 = (u (u (u fm_parser_text ":") _1461) _1462) in (case _1464 of {(0,f) -> u f (\_1465 _1466 _1467-> (u (u (u parser_reply_error _1465) _1466) _1467)); (1,f) -> u f (\_1468 _1469 _1470-> (let _1471 = (u (u fm_parser_name1 _1468) _1469) in (case _1471 of {(0,f) -> u f (\_1472 _1473 _1474-> (u (u (u parser_reply_error _1472) _1473) _1474)); (1,f) -> u f (\_1475 _1476 _1477-> (let _1478 = (u (u (u fm_parser_text "=") _1475) _1476) in (case _1478 of {(0,f) -> u f (\_1479 _1480 _1481-> (u (u (u parser_reply_error _1479) _1480) _1481)); (1,f) -> u f (\_1482 _1483 _1484-> (let _1485 = (u (u fm_parser_term _1482) _1483) in (case _1485 of {(0,f) -> u f (\_1486 _1487 _1488-> (u (u (u parser_reply_error _1486) _1487) _1488)); (1,f) -> u f (\_1489 _1490 _1491-> (let _1492 = (u (u (u parser_maybe (u fm_parser_text ";")) _1489) _1490) in (case _1492 of {(0,f) -> u f (\_1493 _1494 _1495-> (u (u (u parser_reply_error _1493) _1494) _1495)); (1,f) -> u f (\_1496 _1497 _1498-> (let _1499 = (u (u fm_parser_term _1496) _1497) in (case _1499 of {(0,f) -> u f (\_1500 _1501 _1502-> (u (u (u parser_reply_error _1500) _1501) _1502)); (1,f) -> u f (\_1503 _1504 _1505-> (let _1506 = (u (u (u fm_parser_stop _1407) _1503) _1504) in (case _1506 of {(0,f) -> u f (\_1507 _1508 _1509-> (u (u (u parser_reply_error _1507) _1508) _1509)); (1,f) -> u f (\_1510 _1511 _1512-> (let _term_51=(u fm_term_ref "U32.for") in (let _term_52=(u (u fm_term_app _term_51) (u fm_term_hol bits_e)) in (let _term_53=(u (u fm_term_app _term_52) (u fm_term_ref _1477)) in (let _term_54=(u (u fm_term_app _term_53) _1449) in (let _term_55=(u (u fm_term_app _term_54) _1463) in (let _lamb_56=(u (u fm_term_lam _1421) (\_e_56-> (u (u fm_term_lam _1477) (\_s_57-> _1491)))) in (let _term_57=(u (u fm_term_app _term_55) _lamb_56) in (let _term_58=(u (u (u fm_term_let _1477) _term_57) (\_x_58-> _1505)) in (u (u (u parser_reply_value _1510) _1511) (u (u fm_term_ori _1512) _term_58))))))))))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))))
fm_parser_forin = (\_idx_1-> (\_code_2-> (let _1513 = (u (u fm_parser_init _idx_1) _code_2) in (case _1513 of {(0,f) -> u f (\_1514 _1515 _1516-> (u (u (u parser_reply_error _1514) _1515) _1516)); (1,f) -> u f (\_1517 _1518 _1519-> (let _1520 = (u (u (u fm_parser_text "for ") _1517) _1518) in (case _1520 of {(0,f) -> u f (\_1521 _1522 _1523-> (u (u (u parser_reply_error _1521) _1522) _1523)); (1,f) -> u f (\_1524 _1525 _1526-> (let _1527 = (u (u fm_parser_name1 _1524) _1525) in (case _1527 of {(0,f) -> u f (\_1528 _1529 _1530-> (u (u (u parser_reply_error _1528) _1529) _1530)); (1,f) -> u f (\_1531 _1532 _1533-> (let _1534 = (u (u (u fm_parser_text "in") _1531) _1532) in (case _1534 of {(0,f) -> u f (\_1535 _1536 _1537-> (u (u (u parser_reply_error _1535) _1536) _1537)); (1,f) -> u f (\_1538 _1539 _1540-> (let _1541 = (u (u fm_parser_term _1538) _1539) in (case _1541 of {(0,f) -> u f (\_1542 _1543 _1544-> (u (u (u parser_reply_error _1542) _1543) _1544)); (1,f) -> u f (\_1545 _1546 _1547-> (let _1548 = (u (u (u fm_parser_text "with") _1545) _1546) in (case _1548 of {(0,f) -> u f (\_1549 _1550 _1551-> (u (u (u parser_reply_error _1549) _1550) _1551)); (1,f) -> u f (\_1552 _1553 _1554-> (let _1555 = (u (u fm_parser_name1 _1552) _1553) in (case _1555 of {(0,f) -> u f (\_1556 _1557 _1558-> (u (u (u parser_reply_error _1556) _1557) _1558)); (1,f) -> u f (\_1559 _1560 _1561-> (let _1562 = (u (u (u fm_parser_text ":") _1559) _1560) in (case _1562 of {(0,f) -> u f (\_1563 _1564 _1565-> (u (u (u parser_reply_error _1563) _1564) _1565)); (1,f) -> u f (\_1566 _1567 _1568-> (let _1569 = (u (u fm_parser_term _1566) _1567) in (case _1569 of {(0,f) -> u f (\_1570 _1571 _1572-> (u (u (u parser_reply_error _1570) _1571) _1572)); (1,f) -> u f (\_1573 _1574 _1575-> (let _1576 = (u (u (u fm_parser_stop _1519) _1573) _1574) in (case _1576 of {(0,f) -> u f (\_1577 _1578 _1579-> (u (u (u parser_reply_error _1577) _1578) _1579)); (1,f) -> u f (\_1580 _1581 _1582-> (let _term_33=(u fm_term_ref "List.for") in (let _term_34=(u (u fm_term_app _term_33) (u fm_term_hol bits_e)) in (let _term_35=(u (u fm_term_app _term_34) _1547) in (let _term_36=(u (u fm_term_app _term_35) (u fm_term_hol bits_e)) in (let _term_37=(u (u fm_term_app _term_36) (u fm_term_ref _1561)) in (let _lamb_38=(u (u fm_term_lam _1533) (\_i_38-> (u (u fm_term_lam _1561) (\_x_39-> _1575)))) in (let _term_39=(u (u fm_term_app _term_37) _lamb_38) in (let _term_40=(u (u (u fm_term_let _1561) _term_39) (\_x_40-> (u fm_term_ref _1561))) in (u (u (u parser_reply_value _1580) _1581) (u (u fm_term_ori _1582) _term_40))))))))))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))))
fm_parser_forin_2 = (\_idx_1-> (\_code_2-> (let _1583 = (u (u fm_parser_init _idx_1) _code_2) in (case _1583 of {(0,f) -> u f (\_1584 _1585 _1586-> (u (u (u parser_reply_error _1584) _1585) _1586)); (1,f) -> u f (\_1587 _1588 _1589-> (let _1590 = (u (u (u fm_parser_text "for ") _1587) _1588) in (case _1590 of {(0,f) -> u f (\_1591 _1592 _1593-> (u (u (u parser_reply_error _1591) _1592) _1593)); (1,f) -> u f (\_1594 _1595 _1596-> (let _1597 = (u (u fm_parser_name1 _1594) _1595) in (case _1597 of {(0,f) -> u f (\_1598 _1599 _1600-> (u (u (u parser_reply_error _1598) _1599) _1600)); (1,f) -> u f (\_1601 _1602 _1603-> (let _1604 = (u (u (u fm_parser_text "in") _1601) _1602) in (case _1604 of {(0,f) -> u f (\_1605 _1606 _1607-> (u (u (u parser_reply_error _1605) _1606) _1607)); (1,f) -> u f (\_1608 _1609 _1610-> (let _1611 = (u (u fm_parser_term _1608) _1609) in (case _1611 of {(0,f) -> u f (\_1612 _1613 _1614-> (u (u (u parser_reply_error _1612) _1613) _1614)); (1,f) -> u f (\_1615 _1616 _1617-> (let _1618 = (u (u (u fm_parser_text ":") _1615) _1616) in (case _1618 of {(0,f) -> u f (\_1619 _1620 _1621-> (u (u (u parser_reply_error _1619) _1620) _1621)); (1,f) -> u f (\_1622 _1623 _1624-> (let _1625 = (u (u fm_parser_name1 _1622) _1623) in (case _1625 of {(0,f) -> u f (\_1626 _1627 _1628-> (u (u (u parser_reply_error _1626) _1627) _1628)); (1,f) -> u f (\_1629 _1630 _1631-> (let _1632 = (u (u (u fm_parser_text "=") _1629) _1630) in (case _1632 of {(0,f) -> u f (\_1633 _1634 _1635-> (u (u (u parser_reply_error _1633) _1634) _1635)); (1,f) -> u f (\_1636 _1637 _1638-> (let _1639 = (u (u fm_parser_term _1636) _1637) in (case _1639 of {(0,f) -> u f (\_1640 _1641 _1642-> (u (u (u parser_reply_error _1640) _1641) _1642)); (1,f) -> u f (\_1643 _1644 _1645-> (let _1646 = (u (u (u parser_maybe (u fm_parser_text ";")) _1643) _1644) in (case _1646 of {(0,f) -> u f (\_1647 _1648 _1649-> (u (u (u parser_reply_error _1647) _1648) _1649)); (1,f) -> u f (\_1650 _1651 _1652-> (let _1653 = (u (u fm_parser_term _1650) _1651) in (case _1653 of {(0,f) -> u f (\_1654 _1655 _1656-> (u (u (u parser_reply_error _1654) _1655) _1656)); (1,f) -> u f (\_1657 _1658 _1659-> (let _1660 = (u (u (u fm_parser_stop _1589) _1657) _1658) in (case _1660 of {(0,f) -> u f (\_1661 _1662 _1663-> (u (u (u parser_reply_error _1661) _1662) _1663)); (1,f) -> u f (\_1664 _1665 _1666-> (let _term_39=(u fm_term_ref "List.for") in (let _term_40=(u (u fm_term_app _term_39) (u fm_term_hol bits_e)) in (let _term_41=(u (u fm_term_app _term_40) _1617) in (let _term_42=(u (u fm_term_app _term_41) (u fm_term_hol bits_e)) in (let _term_43=(u (u fm_term_app _term_42) (u fm_term_ref _1631)) in (let _lamb_44=(u (u fm_term_lam _1603) (\_i_44-> (u (u fm_term_lam _1631) (\_x_45-> _1645)))) in (let _term_45=(u (u fm_term_app _term_43) _lamb_44) in (let _term_46=(u (u (u fm_term_let _1631) _term_45) (\_x_46-> _1659)) in (u (u (u parser_reply_value _1664) _1665) (u (u fm_term_ori _1666) _term_46))))))))))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))))
fm_parser_do_statements = (\_monad_name_1-> (u parser_first_of (u (u list_cons (\_idx_2-> (\_code_3-> (let _1667 = (u (u fm_parser_init _idx_2) _code_3) in (case _1667 of {(0,f) -> u f (\_1668 _1669 _1670-> (u (u (u parser_reply_error _1668) _1669) _1670)); (1,f) -> u f (\_1671 _1672 _1673-> (let _1674 = (u (u (u fm_parser_text "var ") _1671) _1672) in (case _1674 of {(0,f) -> u f (\_1675 _1676 _1677-> (u (u (u parser_reply_error _1675) _1676) _1677)); (1,f) -> u f (\_1678 _1679 _1680-> (let _1681 = (u (u fm_parser_name1 _1678) _1679) in (case _1681 of {(0,f) -> u f (\_1682 _1683 _1684-> (u (u (u parser_reply_error _1682) _1683) _1684)); (1,f) -> u f (\_1685 _1686 _1687-> (let _1688 = (u (u (u fm_parser_text "=") _1685) _1686) in (case _1688 of {(0,f) -> u f (\_1689 _1690 _1691-> (u (u (u parser_reply_error _1689) _1690) _1691)); (1,f) -> u f (\_1692 _1693 _1694-> (let _1695 = (u (u fm_parser_term _1692) _1693) in (case _1695 of {(0,f) -> u f (\_1696 _1697 _1698-> (u (u (u parser_reply_error _1696) _1697) _1698)); (1,f) -> u f (\_1699 _1700 _1701-> (let _1702 = (u (u (u parser_maybe (u fm_parser_text ";")) _1699) _1700) in (case _1702 of {(0,f) -> u f (\_1703 _1704 _1705-> (u (u (u parser_reply_error _1703) _1704) _1705)); (1,f) -> u f (\_1706 _1707 _1708-> (let _1709 = (u (u (u fm_parser_do_statements _monad_name_1) _1706) _1707) in (case _1709 of {(0,f) -> u f (\_1710 _1711 _1712-> (u (u (u parser_reply_error _1710) _1711) _1712)); (1,f) -> u f (\_1713 _1714 _1715-> (let _1716 = (u (u (u fm_parser_stop _1673) _1713) _1714) in (case _1716 of {(0,f) -> u f (\_1717 _1718 _1719-> (u (u (u parser_reply_error _1717) _1718) _1719)); (1,f) -> u f (\_1720 _1721 _1722-> (let _term_28=(u (u fm_term_app (u fm_term_ref "Monad.bind")) (u fm_term_ref _monad_name_1)) in (let _term_29=(u (u fm_term_app _term_28) (u fm_term_ref (((_monad_name_1::String) ++ ".monad")))) in (let _term_30=(u (u fm_term_app _term_29) (u fm_term_hol bits_e)) in (let _term_31=(u (u fm_term_app _term_30) (u fm_term_hol bits_e)) in (let _term_32=(u (u fm_term_app _term_31) _1701) in (let _term_33=(u (u fm_term_app _term_32) (u (u fm_term_lam _1687) (\_x_33-> _1715))) in (u (u (u parser_reply_value _1720) _1721) (u (u fm_term_ori _1722) _term_33))))))))); }))); }))); }))); }))); }))); }))); }))); }))))) (u (u list_cons (\_idx_2-> (\_code_3-> (let _1723 = (u (u fm_parser_init _idx_2) _code_3) in (case _1723 of {(0,f) -> u f (\_1724 _1725 _1726-> (u (u (u parser_reply_error _1724) _1725) _1726)); (1,f) -> u f (\_1727 _1728 _1729-> (let _1730 = (u (u (u fm_parser_text "let ") _1727) _1728) in (case _1730 of {(0,f) -> u f (\_1731 _1732 _1733-> (u (u (u parser_reply_error _1731) _1732) _1733)); (1,f) -> u f (\_1734 _1735 _1736-> (let _1737 = (u (u fm_parser_name1 _1734) _1735) in (case _1737 of {(0,f) -> u f (\_1738 _1739 _1740-> (u (u (u parser_reply_error _1738) _1739) _1740)); (1,f) -> u f (\_1741 _1742 _1743-> (let _1744 = (u (u (u fm_parser_text "=") _1741) _1742) in (case _1744 of {(0,f) -> u f (\_1745 _1746 _1747-> (u (u (u parser_reply_error _1745) _1746) _1747)); (1,f) -> u f (\_1748 _1749 _1750-> (let _1751 = (u (u fm_parser_term _1748) _1749) in (case _1751 of {(0,f) -> u f (\_1752 _1753 _1754-> (u (u (u parser_reply_error _1752) _1753) _1754)); (1,f) -> u f (\_1755 _1756 _1757-> (let _1758 = (u (u (u parser_maybe (u fm_parser_text ";")) _1755) _1756) in (case _1758 of {(0,f) -> u f (\_1759 _1760 _1761-> (u (u (u parser_reply_error _1759) _1760) _1761)); (1,f) -> u f (\_1762 _1763 _1764-> (let _1765 = (u (u (u fm_parser_do_statements _monad_name_1) _1762) _1763) in (case _1765 of {(0,f) -> u f (\_1766 _1767 _1768-> (u (u (u parser_reply_error _1766) _1767) _1768)); (1,f) -> u f (\_1769 _1770 _1771-> (let _1772 = (u (u (u fm_parser_stop _1729) _1769) _1770) in (case _1772 of {(0,f) -> u f (\_1773 _1774 _1775-> (u (u (u parser_reply_error _1773) _1774) _1775)); (1,f) -> u f (\_1776 _1777 _1778-> (u (u (u parser_reply_value _1776) _1777) (u (u fm_term_ori _1778) (u (u (u fm_term_let _1743) _1757) (\_x_28-> _1771))))); }))); }))); }))); }))); }))); }))); }))); }))))) (u (u list_cons (\_idx_2-> (\_code_3-> (let _1779 = (u (u fm_parser_init _idx_2) _code_3) in (case _1779 of {(0,f) -> u f (\_1780 _1781 _1782-> (u (u (u parser_reply_error _1780) _1781) _1782)); (1,f) -> u f (\_1783 _1784 _1785-> (let _1786 = (u (u (u fm_parser_text "return ") _1783) _1784) in (case _1786 of {(0,f) -> u f (\_1787 _1788 _1789-> (u (u (u parser_reply_error _1787) _1788) _1789)); (1,f) -> u f (\_1790 _1791 _1792-> (let _1793 = (u (u fm_parser_term _1790) _1791) in (case _1793 of {(0,f) -> u f (\_1794 _1795 _1796-> (u (u (u parser_reply_error _1794) _1795) _1796)); (1,f) -> u f (\_1797 _1798 _1799-> (let _1800 = (u (u (u parser_maybe (u fm_parser_text ";")) _1797) _1798) in (case _1800 of {(0,f) -> u f (\_1801 _1802 _1803-> (u (u (u parser_reply_error _1801) _1802) _1803)); (1,f) -> u f (\_1804 _1805 _1806-> (let _1807 = (u (u (u fm_parser_stop _1785) _1804) _1805) in (case _1807 of {(0,f) -> u f (\_1808 _1809 _1810-> (u (u (u parser_reply_error _1808) _1809) _1810)); (1,f) -> u f (\_1811 _1812 _1813-> (let _term_19=(u (u fm_term_app (u fm_term_ref "Monad.pure")) (u fm_term_ref _monad_name_1)) in (let _term_20=(u (u fm_term_app _term_19) (u fm_term_ref (((_monad_name_1::String) ++ ".monad")))) in (let _term_21=(u (u fm_term_app _term_20) (u fm_term_hol bits_e)) in (let _term_22=(u (u fm_term_app _term_21) _1799) in (u (u (u parser_reply_value _1811) _1812) (u (u fm_term_ori _1813) _term_22))))))); }))); }))); }))); }))); }))))) (u (u list_cons (\_idx_2-> (\_code_3-> (let _1814 = (u (u fm_parser_init _idx_2) _code_3) in (case _1814 of {(0,f) -> u f (\_1815 _1816 _1817-> (u (u (u parser_reply_error _1815) _1816) _1817)); (1,f) -> u f (\_1818 _1819 _1820-> (let _1821 = (u (u fm_parser_term _1818) _1819) in (case _1821 of {(0,f) -> u f (\_1822 _1823 _1824-> (u (u (u parser_reply_error _1822) _1823) _1824)); (1,f) -> u f (\_1825 _1826 _1827-> (let _1828 = (u (u (u parser_maybe (u fm_parser_text ";")) _1825) _1826) in (case _1828 of {(0,f) -> u f (\_1829 _1830 _1831-> (u (u (u parser_reply_error _1829) _1830) _1831)); (1,f) -> u f (\_1832 _1833 _1834-> (let _1835 = (u (u (u fm_parser_do_statements _monad_name_1) _1832) _1833) in (case _1835 of {(0,f) -> u f (\_1836 _1837 _1838-> (u (u (u parser_reply_error _1836) _1837) _1838)); (1,f) -> u f (\_1839 _1840 _1841-> (let _1842 = (u (u (u fm_parser_stop _1820) _1839) _1840) in (case _1842 of {(0,f) -> u f (\_1843 _1844 _1845-> (u (u (u parser_reply_error _1843) _1844) _1845)); (1,f) -> u f (\_1846 _1847 _1848-> (let _term_19=(u (u fm_term_app (u fm_term_ref "Monad.bind")) (u fm_term_ref _monad_name_1)) in (let _term_20=(u (u fm_term_app _term_19) (u fm_term_ref (((_monad_name_1::String) ++ ".monad")))) in (let _term_21=(u (u fm_term_app _term_20) (u fm_term_hol bits_e)) in (let _term_22=(u (u fm_term_app _term_21) (u fm_term_hol bits_e)) in (let _term_23=(u (u fm_term_app _term_22) _1827) in (let _term_24=(u (u fm_term_app _term_23) (u (u fm_term_lam "") (\_x_24-> _1841))) in (u (u (u parser_reply_value _1846) _1847) (u (u fm_term_ori _1848) _term_24))))))))); }))); }))); }))); }))); }))))) (u (u list_cons (\_idx_2-> (\_code_3-> (let _1849 = (u (u fm_parser_term _idx_2) _code_3) in (case _1849 of {(0,f) -> u f (\_1850 _1851 _1852-> (u (u (u parser_reply_error _1850) _1851) _1852)); (1,f) -> u f (\_1853 _1854 _1855-> (let _1856 = (u (u (u parser_maybe (u fm_parser_text ";")) _1853) _1854) in (case _1856 of {(0,f) -> u f (\_1857 _1858 _1859-> (u (u (u parser_reply_error _1857) _1858) _1859)); (1,f) -> u f (\_1860 _1861 _1862-> (u (u (u parser_reply_value _1860) _1861) _1855)); }))); }))))) list_nil)))))))
fm_parser_do = (\_idx_1-> (\_code_2-> (let _1863 = (u (u (u fm_parser_text "do ") _idx_1) _code_2) in (case _1863 of {(0,f) -> u f (\_1864 _1865 _1866-> (u (u (u parser_reply_error _1864) _1865) _1866)); (1,f) -> u f (\_1867 _1868 _1869-> (let _1870 = (u (u fm_parser_name1 _1867) _1868) in (case _1870 of {(0,f) -> u f (\_1871 _1872 _1873-> (u (u (u parser_reply_error _1871) _1872) _1873)); (1,f) -> u f (\_1874 _1875 _1876-> (let _1877 = (u (u (u fm_parser_text "{") _1874) _1875) in (case _1877 of {(0,f) -> u f (\_1878 _1879 _1880-> (u (u (u parser_reply_error _1878) _1879) _1880)); (1,f) -> u f (\_1881 _1882 _1883-> (let _1884 = (u (u (u fm_parser_do_statements _1876) _1881) _1882) in (case _1884 of {(0,f) -> u f (\_1885 _1886 _1887-> (u (u (u parser_reply_error _1885) _1886) _1887)); (1,f) -> u f (\_1888 _1889 _1890-> (let _1891 = (u (u (u fm_parser_text "}") _1888) _1889) in (case _1891 of {(0,f) -> u f (\_1892 _1893 _1894-> (u (u (u parser_reply_error _1892) _1893) _1894)); (1,f) -> u f (\_1895 _1896 _1897-> (u (u (u parser_reply_value _1895) _1896) _1890)); }))); }))); }))); }))); }))))
fm_term_nat = (\_natx_1-> (11,\t-> t _natx_1))
fm_term_unroll_nat = (\_natx_1-> (let _1898 = _natx_1 in (if _1898==0 then (u fm_term_ref (u fm_name_read "Nat.zero")) else (let _func_3=(u fm_term_ref (u fm_name_read "Nat.succ")) in (let _argm_4=(u fm_term_nat (_1898-1)) in (u (u fm_term_app _func_3) _argm_4))))))
u16_to_bits = (\_a_1-> (let _1899 = _a_1 in (u word_to_bits (u16_to_word _1899))))
fm_term_unroll_chr_bits = (\_bits_1-> (let _1900 = _bits_1 in (case _1900 of {(0,f) -> u f ((u fm_term_ref (u fm_name_read "Bits.e"))); (1,f) -> u f (\_1901-> (u (u fm_term_app (u fm_term_ref (u fm_name_read "Bits.o"))) (u fm_term_unroll_chr_bits _1901))); (2,f) -> u f (\_1902-> (u (u fm_term_app (u fm_term_ref (u fm_name_read "Bits.i"))) (u fm_term_unroll_chr_bits _1902))); })))
fm_term_unroll_chr = (\_chrx_1-> (let _bits_2=(u u16_to_bits _chrx_1) in (let _term_3=(u fm_term_ref (u fm_name_read "Word.from_bits")) in (let _term_4=(u (u fm_term_app _term_3) (u fm_term_nat 16)) in (let _term_5=(u (u fm_term_app _term_4) (u fm_term_unroll_chr_bits _bits_2)) in (let _term_6=(u (u fm_term_app (u fm_term_ref (u fm_name_read "U16.new"))) _term_5) in _term_6))))))
fm_term_unroll_str = (\_strx_1-> (let _1903 = _strx_1 in (if null (_1903::String) then (u fm_term_ref (u fm_name_read "String.nil")) else (let _char_4=(u fm_term_chr (fromIntegral (fromEnum (head _1903 :: Char)) :: Word16)) in (let _term_5=(u fm_term_ref (u fm_name_read "String.cons")) in (let _term_6=(u (u fm_term_app _term_5) _char_4) in (let _term_7=(u (u fm_term_app _term_6) (u fm_term_str (tail _1903))) in _term_7)))))))
fm_term_reduce = (\_term_1-> (\_defs_2-> (let _1904 = _term_1 in (case _1904 of {(0,f) -> u f (\_1905 _1906-> _term_1); (1,f) -> u f (\_1907-> (let _1908 = (u (u fm_get _1907) _defs_2) in (case _1908 of {(0,f) -> u f ((u fm_term_ref _1907)); (1,f) -> u f (\_1909-> (let _1910 = _1909 in (case _1910 of {(0,f) -> u f (\_1911 _1912 _1913 _1914 _1915 _1916-> (u (u fm_term_reduce _1914) _defs_2)); }))); }))); (2,f) -> u f (_term_1); (3,f) -> u f (\_1917 _1918 _1919 _1920 _1921-> _term_1); (4,f) -> u f (\_1922 _1923-> _term_1); (5,f) -> u f (\_1924 _1925-> (let _func_5=(u (u fm_term_reduce _1924) _defs_2) in (let _1926 = _func_5 in (case _1926 of {(0,f) -> u f (\_1927 _1928-> _term_1); (1,f) -> u f (\_1929-> _term_1); (2,f) -> u f (_term_1); (3,f) -> u f (\_1930 _1931 _1932 _1933 _1934-> _term_1); (4,f) -> u f (\_1935 _1936-> (u (u fm_term_reduce (u _1936 _1925)) _defs_2)); (5,f) -> u f (\_1937 _1938-> _term_1); (6,f) -> u f (\_1939 _1940 _1941-> _term_1); (7,f) -> u f (\_1942 _1943 _1944-> _term_1); (8,f) -> u f (\_1945 _1946 _1947-> _term_1); (9,f) -> u f (\_1948 _1949 _1950-> _term_1); (10,f) -> u f (\_1951-> _term_1); (11,f) -> u f (\_1952-> _term_1); (12,f) -> u f (\_1953-> _term_1); (13,f) -> u f (\_1954-> _term_1); (14,f) -> u f (\_1955 _1956 _1957 _1958 _1959 _1960-> _term_1); (15,f) -> u f (\_1961 _1962-> _term_1); })))); (6,f) -> u f (\_1963 _1964 _1965-> (u (u fm_term_reduce (u _1965 _1964)) _defs_2)); (7,f) -> u f (\_1966 _1967 _1968-> (u (u fm_term_reduce (u _1968 _1967)) _defs_2)); (8,f) -> u f (\_1969 _1970 _1971-> (u (u fm_term_reduce _1970) _defs_2)); (9,f) -> u f (\_1972 _1973 _1974-> _term_1); (10,f) -> u f (\_1975-> _term_1); (11,f) -> u f (\_1976-> (u (u fm_term_reduce (u fm_term_unroll_nat _1976)) _defs_2)); (12,f) -> u f (\_1977-> (u (u fm_term_reduce (u fm_term_unroll_chr _1977)) _defs_2)); (13,f) -> u f (\_1978-> (u (u fm_term_reduce (u fm_term_unroll_str _1978)) _defs_2)); (14,f) -> u f (\_1979 _1980 _1981 _1982 _1983 _1984-> _term_1); (15,f) -> u f (\_1985 _1986-> (u (u fm_term_reduce _1986) _defs_2)); }))))
map_new = (0,\t-> t)
fm_def_new = (\_file_1-> (\_code_2-> (\_name_3-> (\_term_4-> (\_type_5-> (\_stat_6-> (0,\t-> t _file_1 _code_2 _name_3 _term_4 _type_5 _stat_6)))))))
fm_status_init = (0,\t-> t)
fm_parser_case_with = (\_idx_1-> (\_code_2-> (let _1987 = (u (u (u fm_parser_text "with") _idx_1) _code_2) in (case _1987 of {(0,f) -> u f (\_1988 _1989 _1990-> (u (u (u parser_reply_error _1988) _1989) _1990)); (1,f) -> u f (\_1991 _1992 _1993-> (let _1994 = (u (u fm_parser_name1 _1991) _1992) in (case _1994 of {(0,f) -> u f (\_1995 _1996 _1997-> (u (u (u parser_reply_error _1995) _1996) _1997)); (1,f) -> u f (\_1998 _1999 _2000-> (let _2001 = (u (u (u fm_parser_text ":") _1998) _1999) in (case _2001 of {(0,f) -> u f (\_2002 _2003 _2004-> (u (u (u parser_reply_error _2002) _2003) _2004)); (1,f) -> u f (\_2005 _2006 _2007-> (let _2008 = (u (u fm_parser_term _2005) _2006) in (case _2008 of {(0,f) -> u f (\_2009 _2010 _2011-> (u (u (u parser_reply_error _2009) _2010) _2011)); (1,f) -> u f (\_2012 _2013 _2014-> (let _2015 = (u (u (u fm_parser_text "=") _2012) _2013) in (case _2015 of {(0,f) -> u f (\_2016 _2017 _2018-> (u (u (u parser_reply_error _2016) _2017) _2018)); (1,f) -> u f (\_2019 _2020 _2021-> (let _2022 = (u (u fm_parser_term _2019) _2020) in (case _2022 of {(0,f) -> u f (\_2023 _2024 _2025-> (u (u (u parser_reply_error _2023) _2024) _2025)); (1,f) -> u f (\_2026 _2027 _2028-> (u (u (u parser_reply_value _2026) _2027) (u (u (u (u (u (u fm_def_new "") "") _2000) _2028) _2014) fm_status_init))); }))); }))); }))); }))); }))); }))))
fm_parser_case_case = (\_idx_1-> (\_code_2-> (let _2029 = (u (u fm_parser_name1 _idx_1) _code_2) in (case _2029 of {(0,f) -> u f (\_2030 _2031 _2032-> (u (u (u parser_reply_error _2030) _2031) _2032)); (1,f) -> u f (\_2033 _2034 _2035-> (let _2036 = (u (u (u fm_parser_text ":") _2033) _2034) in (case _2036 of {(0,f) -> u f (\_2037 _2038 _2039-> (u (u (u parser_reply_error _2037) _2038) _2039)); (1,f) -> u f (\_2040 _2041 _2042-> (let _2043 = (u (u fm_parser_term _2040) _2041) in (case _2043 of {(0,f) -> u f (\_2044 _2045 _2046-> (u (u (u parser_reply_error _2044) _2045) _2046)); (1,f) -> u f (\_2047 _2048 _2049-> (let _2050 = (u (u (u parser_maybe (u fm_parser_text ",")) _2047) _2048) in (case _2050 of {(0,f) -> u f (\_2051 _2052 _2053-> (u (u (u parser_reply_error _2051) _2052) _2053)); (1,f) -> u f (\_2054 _2055 _2056-> (u (u (u parser_reply_value _2054) _2055) (u (u pair_new _2035) _2049))); }))); }))); }))); }))))
map_tie = (\_val_2-> (\_lft_3-> (\_rgt_4-> (1,\t-> t _val_2 _lft_3 _rgt_4))))
map_set = (\_bits_2-> (\_val_3-> (\_map_4-> (let _2057 = _bits_2 in (case _2057 of {(0,f) -> u f ((let _2058 = _map_4 in (case _2058 of {(0,f) -> u f ((u (u (u map_tie (u maybe_some _val_3)) map_new) map_new)); (1,f) -> u f (\_2059 _2060 _2061-> (u (u (u map_tie (u maybe_some _val_3)) _2060) _2061)); }))); (1,f) -> u f (\_2062-> (let _2063 = _map_4 in (case _2063 of {(0,f) -> u f ((u (u (u map_tie maybe_none) (u (u (u map_set _2062) _val_3) map_new)) map_new)); (1,f) -> u f (\_2064 _2065 _2066-> (u (u (u map_tie _2064) (u (u (u map_set _2062) _val_3) _2065)) _2066)); }))); (2,f) -> u f (\_2067-> (let _2068 = _map_4 in (case _2068 of {(0,f) -> u f ((u (u (u map_tie maybe_none) map_new) (u (u (u map_set _2067) _val_3) map_new))); (1,f) -> u f (\_2069 _2070 _2071-> (u (u (u map_tie _2069) _2070) (u (u (u map_set _2067) _val_3) _2071))); }))); })))))
map_from_list = (\_xs_2-> (let _2072 = _xs_2 in (case _2072 of {(0,f) -> u f (map_new); (1,f) -> u f (\_2073 _2074-> (let _2075 = _2073 in (case _2075 of {(0,f) -> u f (\_2076 _2077-> (u (u (u map_set _2076) _2077) (u map_from_list _2074))); }))); })))
pair_fst = (\_pair_3-> (let _2078 = _pair_3 in (case _2078 of {(0,f) -> u f (\_2079 _2080-> _2079); })))
pair_snd = (\_pair_3-> (let _2081 = _pair_3 in (case _2081 of {(0,f) -> u f (\_2082 _2083-> _2083); })))
fm_term_cse = (\_path_1-> (\_expr_2-> (\_name_3-> (\_with_4-> (\_cses_5-> (\_moti_6-> (14,\t-> t _path_1 _expr_2 _name_3 _with_4 _cses_5 _moti_6)))))))
fm_parser_case = (\_idx_1-> (\_code_2-> (let _2084 = (u (u fm_parser_init _idx_1) _code_2) in (case _2084 of {(0,f) -> u f (\_2085 _2086 _2087-> (u (u (u parser_reply_error _2085) _2086) _2087)); (1,f) -> u f (\_2088 _2089 _2090-> (let _2091 = (u (u (u fm_parser_text "case ") _2088) _2089) in (case _2091 of {(0,f) -> u f (\_2092 _2093 _2094-> (u (u (u parser_reply_error _2092) _2093) _2094)); (1,f) -> u f (\_2095 _2096 _2097-> (let _2098 = (u (u fm_parser_spaces _2095) _2096) in (case _2098 of {(0,f) -> u f (\_2099 _2100 _2101-> (u (u (u parser_reply_error _2099) _2100) _2101)); (1,f) -> u f (\_2102 _2103 _2104-> (let _2105 = (u (u fm_parser_term _2102) _2103) in (case _2105 of {(0,f) -> u f (\_2106 _2107 _2108-> (u (u (u parser_reply_error _2106) _2107) _2108)); (1,f) -> u f (\_2109 _2110 _2111-> (let _2112 = (u (u (u parser_maybe (\_idx_15-> (\_code_16-> (let _2113 = (u (u (u fm_parser_text "as") _idx_15) _code_16) in (case _2113 of {(0,f) -> u f (\_2114 _2115 _2116-> (u (u (u parser_reply_error _2114) _2115) _2116)); (1,f) -> u f (\_2117 _2118 _2119-> (u (u fm_parser_name1 _2117) _2118)); }))))) _2109) _2110) in (case _2112 of {(0,f) -> u f (\_2120 _2121 _2122-> (u (u (u parser_reply_error _2120) _2121) _2122)); (1,f) -> u f (\_2123 _2124 _2125-> (let _name_18=(let _2126 = _2125 in (case _2126 of {(0,f) -> u f ((let _2127 = (u (u fm_term_reduce _2111) map_new) in (case _2127 of {(0,f) -> u f (\_2128 _2129-> _2128); (1,f) -> u f (\_2130-> _2130); (2,f) -> u f ((u fm_name_read "self")); (3,f) -> u f (\_2131 _2132 _2133 _2134 _2135-> (u fm_name_read "self")); (4,f) -> u f (\_2136 _2137-> (u fm_name_read "self")); (5,f) -> u f (\_2138 _2139-> (u fm_name_read "self")); (6,f) -> u f (\_2140 _2141 _2142-> (u fm_name_read "self")); (7,f) -> u f (\_2143 _2144 _2145-> (u fm_name_read "self")); (8,f) -> u f (\_2146 _2147 _2148-> (u fm_name_read "self")); (9,f) -> u f (\_2149 _2150 _2151-> (u fm_name_read "self")); (10,f) -> u f (\_2152-> (u fm_name_read "self")); (11,f) -> u f (\_2153-> (u fm_name_read "self")); (12,f) -> u f (\_2154-> (u fm_name_read "self")); (13,f) -> u f (\_2155-> (u fm_name_read "self")); (14,f) -> u f (\_2156 _2157 _2158 _2159 _2160 _2161-> (u fm_name_read "self")); (15,f) -> u f (\_2162 _2163-> (u fm_name_read "self")); }))); (1,f) -> u f (\_2164-> _2164); })) in (let _2165 = (u (u (u parser_many fm_parser_case_with) _2123) _2124) in (case _2165 of {(0,f) -> u f (\_2166 _2167 _2168-> (u (u (u parser_reply_error _2166) _2167) _2168)); (1,f) -> u f (\_2169 _2170 _2171-> (let _2172 = (u (u (u fm_parser_text "{") _2169) _2170) in (case _2172 of {(0,f) -> u f (\_2173 _2174 _2175-> (u (u (u parser_reply_error _2173) _2174) _2175)); (1,f) -> u f (\_2176 _2177 _2178-> (let _2179 = (u (u (u (u parser_until (u fm_parser_text "}")) fm_parser_case_case) _2176) _2177) in (case _2179 of {(0,f) -> u f (\_2180 _2181 _2182-> (u (u (u parser_reply_error _2180) _2181) _2182)); (1,f) -> u f (\_2183 _2184 _2185-> (let _cses_28=(u map_from_list (u (u list_mapped _2185) (\_x_28-> (u (u pair_new (u fm_name_to_bits (u pair_fst _x_28))) (u pair_snd _x_28))))) in (let _2186 = (u (u (u parser_first_of (u (u list_cons (\_idx_29-> (\_code_30-> (let _2187 = (u (u (u fm_parser_text ":") _idx_29) _code_30) in (case _2187 of {(0,f) -> u f (\_2188 _2189 _2190-> (u (u (u parser_reply_error _2188) _2189) _2190)); (1,f) -> u f (\_2191 _2192 _2193-> (let _2194 = (u (u fm_parser_term _2191) _2192) in (case _2194 of {(0,f) -> u f (\_2195 _2196 _2197-> (u (u (u parser_reply_error _2195) _2196) _2197)); (1,f) -> u f (\_2198 _2199 _2200-> (u (u (u parser_reply_value _2198) _2199) (u maybe_some _2200))); }))); }))))) (u (u list_cons (\_idx_29-> (\_code_30-> (let _2201 = (u (u (u fm_parser_text "!") _idx_29) _code_30) in (case _2201 of {(0,f) -> u f (\_2202 _2203 _2204-> (u (u (u parser_reply_error _2202) _2203) _2204)); (1,f) -> u f (\_2205 _2206 _2207-> (u (u (u parser_reply_value _2205) _2206) maybe_none)); }))))) (u (u list_cons (\_idx_29-> (\_code_30-> (u (u (u parser_reply_value _idx_29) _code_30) (u maybe_some (u fm_term_hol bits_e)))))) list_nil)))) _2183) _2184) in (case _2186 of {(0,f) -> u f (\_2208 _2209 _2210-> (u (u (u parser_reply_error _2208) _2209) _2210)); (1,f) -> u f (\_2211 _2212 _2213-> (let _2214 = (u (u (u fm_parser_stop _2090) _2211) _2212) in (case _2214 of {(0,f) -> u f (\_2215 _2216 _2217-> (u (u (u parser_reply_error _2215) _2216) _2217)); (1,f) -> u f (\_2218 _2219 _2220-> (u (u (u parser_reply_value _2218) _2219) (u (u fm_term_ori _2220) (u (u (u (u (u (u fm_term_cse bits_e) _2111) _name_18) _2171) _cses_28) _2213)))); }))); })))); }))); }))); })))); }))); }))); }))); }))); }))))
fm_set = (\_name_2-> (\_val_3-> (\_map_4-> (u (u (u map_set (u fm_name_to_bits _name_2)) _val_3) _map_4))))
fm_parser_open = (\_idx_1-> (\_code_2-> (let _2221 = (u (u fm_parser_init _idx_1) _code_2) in (case _2221 of {(0,f) -> u f (\_2222 _2223 _2224-> (u (u (u parser_reply_error _2222) _2223) _2224)); (1,f) -> u f (\_2225 _2226 _2227-> (let _2228 = (u (u (u fm_parser_text "open ") _2225) _2226) in (case _2228 of {(0,f) -> u f (\_2229 _2230 _2231-> (u (u (u parser_reply_error _2229) _2230) _2231)); (1,f) -> u f (\_2232 _2233 _2234-> (let _2235 = (u (u fm_parser_spaces _2232) _2233) in (case _2235 of {(0,f) -> u f (\_2236 _2237 _2238-> (u (u (u parser_reply_error _2236) _2237) _2238)); (1,f) -> u f (\_2239 _2240 _2241-> (let _2242 = (u (u fm_parser_term _2239) _2240) in (case _2242 of {(0,f) -> u f (\_2243 _2244 _2245-> (u (u (u parser_reply_error _2243) _2244) _2245)); (1,f) -> u f (\_2246 _2247 _2248-> (let _2249 = (u (u (u parser_maybe (\_idx_15-> (\_code_16-> (let _2250 = (u (u (u fm_parser_text "as") _idx_15) _code_16) in (case _2250 of {(0,f) -> u f (\_2251 _2252 _2253-> (u (u (u parser_reply_error _2251) _2252) _2253)); (1,f) -> u f (\_2254 _2255 _2256-> (u (u fm_parser_name1 _2254) _2255)); }))))) _2246) _2247) in (case _2249 of {(0,f) -> u f (\_2257 _2258 _2259-> (u (u (u parser_reply_error _2257) _2258) _2259)); (1,f) -> u f (\_2260 _2261 _2262-> (let _2263 = (u (u (u parser_maybe (u fm_parser_text ";")) _2260) _2261) in (case _2263 of {(0,f) -> u f (\_2264 _2265 _2266-> (u (u (u parser_reply_error _2264) _2265) _2266)); (1,f) -> u f (\_2267 _2268 _2269-> (let _name_21=(let _2270 = _2262 in (case _2270 of {(0,f) -> u f ((let _2271 = (u (u fm_term_reduce _2248) map_new) in (case _2271 of {(0,f) -> u f (\_2272 _2273-> _2272); (1,f) -> u f (\_2274-> _2274); (2,f) -> u f ((u fm_name_read "self")); (3,f) -> u f (\_2275 _2276 _2277 _2278 _2279-> (u fm_name_read "self")); (4,f) -> u f (\_2280 _2281-> (u fm_name_read "self")); (5,f) -> u f (\_2282 _2283-> (u fm_name_read "self")); (6,f) -> u f (\_2284 _2285 _2286-> (u fm_name_read "self")); (7,f) -> u f (\_2287 _2288 _2289-> (u fm_name_read "self")); (8,f) -> u f (\_2290 _2291 _2292-> (u fm_name_read "self")); (9,f) -> u f (\_2293 _2294 _2295-> (u fm_name_read "self")); (10,f) -> u f (\_2296-> (u fm_name_read "self")); (11,f) -> u f (\_2297-> (u fm_name_read "self")); (12,f) -> u f (\_2298-> (u fm_name_read "self")); (13,f) -> u f (\_2299-> (u fm_name_read "self")); (14,f) -> u f (\_2300 _2301 _2302 _2303 _2304 _2305-> (u fm_name_read "self")); (15,f) -> u f (\_2306 _2307-> (u fm_name_read "self")); }))); (1,f) -> u f (\_2308-> _2308); })) in (let _wyth_22=list_nil in (let _2309 = (u (u fm_parser_term _2267) _2268) in (case _2309 of {(0,f) -> u f (\_2310 _2311 _2312-> (u (u (u parser_reply_error _2310) _2311) _2312)); (1,f) -> u f (\_2313 _2314 _2315-> (let _cses_26=(u (u (u fm_set "_") _2315) map_new) in (let _moti_27=(u maybe_some (u fm_term_hol bits_e)) in (let _2316 = (u (u (u fm_parser_stop _2227) _2313) _2314) in (case _2316 of {(0,f) -> u f (\_2317 _2318 _2319-> (u (u (u parser_reply_error _2317) _2318) _2319)); (1,f) -> u f (\_2320 _2321 _2322-> (u (u (u parser_reply_value _2320) _2321) (u (u fm_term_ori _2322) (u (u (u (u (u (u fm_term_cse bits_e) _2248) _name_21) _wyth_22) _cses_26) _moti_27)))); }))))); }))))); }))); }))); }))); }))); }))); }))))
parser_digit = (\_idx_1-> (\_code_2-> (let _2323 = _code_2 in (if null (_2323::String) then (u (u (u parser_reply_error _idx_1) _code_2) "Not a digit.") else (let _sidx_5=(u nat_succ _idx_1) in (let _2324 = ((((fromIntegral (fromEnum (head _2323 :: Char)) :: Word16)::Word16) == 48)) in (if _2324 then (u (u (u parser_reply_value _sidx_5) (tail _2323)) 0) else (let _2325 = ((((fromIntegral (fromEnum (head _2323 :: Char)) :: Word16)::Word16) == 49)) in (if _2325 then (u (u (u parser_reply_value _sidx_5) (tail _2323)) 1) else (let _2326 = ((((fromIntegral (fromEnum (head _2323 :: Char)) :: Word16)::Word16) == 50)) in (if _2326 then (u (u (u parser_reply_value _sidx_5) (tail _2323)) 2) else (let _2327 = ((((fromIntegral (fromEnum (head _2323 :: Char)) :: Word16)::Word16) == 51)) in (if _2327 then (u (u (u parser_reply_value _sidx_5) (tail _2323)) 3) else (let _2328 = ((((fromIntegral (fromEnum (head _2323 :: Char)) :: Word16)::Word16) == 52)) in (if _2328 then (u (u (u parser_reply_value _sidx_5) (tail _2323)) 4) else (let _2329 = ((((fromIntegral (fromEnum (head _2323 :: Char)) :: Word16)::Word16) == 53)) in (if _2329 then (u (u (u parser_reply_value _sidx_5) (tail _2323)) 5) else (let _2330 = ((((fromIntegral (fromEnum (head _2323 :: Char)) :: Word16)::Word16) == 54)) in (if _2330 then (u (u (u parser_reply_value _sidx_5) (tail _2323)) 6) else (let _2331 = ((((fromIntegral (fromEnum (head _2323 :: Char)) :: Word16)::Word16) == 55)) in (if _2331 then (u (u (u parser_reply_value _sidx_5) (tail _2323)) 7) else (let _2332 = ((((fromIntegral (fromEnum (head _2323 :: Char)) :: Word16)::Word16) == 56)) in (if _2332 then (u (u (u parser_reply_value _sidx_5) (tail _2323)) 8) else (let _2333 = ((((fromIntegral (fromEnum (head _2323 :: Char)) :: Word16)::Word16) == 57)) in (if _2333 then (u (u (u parser_reply_value _sidx_5) (tail _2323)) 9) else (u (u (u parser_reply_error _idx_1) _code_2) "Not a digit."))))))))))))))))))))))))))
nat_add = (\a0-> \a1-> ((a0::Integer) + a1))
nat_mul = (\a0-> \a1-> ((a0::Integer) * a1))
nat_from_base_go = (\_b_1-> (\_ds_2-> (\_p_3-> (\_res_4-> (let _2334 = _ds_2 in (case _2334 of {(0,f) -> u f (_res_4); (1,f) -> u f (\_2335 _2336-> (u (u (u (u nat_from_base_go _b_1) _2336) (((_b_1::Integer) * _p_3))) ((((((_2335::Integer) * _p_3))::Integer) + _res_4)))); }))))))
list_reverse_go = (\_xs_2-> (\_res_3-> (let _2337 = _xs_2 in (case _2337 of {(0,f) -> u f (_res_3); (1,f) -> u f (\_2338 _2339-> (u (u list_reverse_go _2339) (u (u list_cons _2338) _res_3))); }))))
list_reverse = (\_xs_2-> (u (u list_reverse_go _xs_2) list_nil))
nat_from_base = (\_base_1-> (\_ds_2-> (u (u (u (u nat_from_base_go _base_1) (u list_reverse _ds_2)) 1) 0)))
parser_nat = (\_idx_1-> (\_code_2-> (let _2340 = (u (u (u parser_many1 parser_digit) _idx_1) _code_2) in (case _2340 of {(0,f) -> u f (\_2341 _2342 _2343-> (u (u (u parser_reply_error _2341) _2342) _2343)); (1,f) -> u f (\_2344 _2345 _2346-> (u (u (u parser_reply_value _2344) _2345) (u (u nat_from_base 10) _2346))); }))))
bits_tail = (\_a_1-> (let _2347 = _a_1 in (case _2347 of {(0,f) -> u f (bits_e); (1,f) -> u f (\_2348-> _2348); (2,f) -> u f (\_2349-> _2349); })))
bits_inc = (\_a_1-> (let _2350 = _a_1 in (case _2350 of {(0,f) -> u f ((u bits_i bits_e)); (1,f) -> u f (\_2351-> (u bits_i _2351)); (2,f) -> u f (\_2352-> (u bits_o (u bits_inc _2352))); })))
nat_to_bits = (\_n_1-> (let _2353 = _n_1 in (if _2353==0 then bits_e else (u bits_inc (u nat_to_bits (_2353-1))))))
maybe_to_bool = (\_m_2-> (let _2354 = _m_2 in (case _2354 of {(0,f) -> u f (bool_false); (1,f) -> u f (\_2355-> bool_true); })))
fm_term_gol = (\_name_1-> (\_dref_2-> (\_verb_3-> (9,\t-> t _name_1 _dref_2 _verb_3))))
fm_parser_goal = (\_idx_1-> (\_code_2-> (let _2356 = (u (u fm_parser_init _idx_1) _code_2) in (case _2356 of {(0,f) -> u f (\_2357 _2358 _2359-> (u (u (u parser_reply_error _2357) _2358) _2359)); (1,f) -> u f (\_2360 _2361 _2362-> (let _2363 = (u (u (u fm_parser_text "?") _2360) _2361) in (case _2363 of {(0,f) -> u f (\_2364 _2365 _2366-> (u (u (u parser_reply_error _2364) _2365) _2366)); (1,f) -> u f (\_2367 _2368 _2369-> (let _2370 = (u (u fm_parser_name _2367) _2368) in (case _2370 of {(0,f) -> u f (\_2371 _2372 _2373-> (u (u (u parser_reply_error _2371) _2372) _2373)); (1,f) -> u f (\_2374 _2375 _2376-> (let _2377 = (u (u (u parser_many (\_idx_12-> (\_code_13-> (let _2378 = (u (u (u fm_parser_text "-") _idx_12) _code_13) in (case _2378 of {(0,f) -> u f (\_2379 _2380 _2381-> (u (u (u parser_reply_error _2379) _2380) _2381)); (1,f) -> u f (\_2382 _2383 _2384-> (let _2385 = (u (u parser_nat _2382) _2383) in (case _2385 of {(0,f) -> u f (\_2386 _2387 _2388-> (u (u (u parser_reply_error _2386) _2387) _2388)); (1,f) -> u f (\_2389 _2390 _2391-> (let _bits_20=(u bits_reverse (u bits_tail (u bits_reverse (u nat_to_bits _2391)))) in (u (u (u parser_reply_value _2389) _2390) _bits_20))); }))); }))))) _2374) _2375) in (case _2377 of {(0,f) -> u f (\_2392 _2393 _2394-> (u (u (u parser_reply_error _2392) _2393) _2394)); (1,f) -> u f (\_2395 _2396 _2397-> (let _2398 = (let _2399 = (u (u (u parser_maybe (u parser_text "-")) _2395) _2396) in (case _2399 of {(0,f) -> u f (\_2400 _2401 _2402-> (u (u (u parser_reply_error _2400) _2401) _2402)); (1,f) -> u f (\_2403 _2404 _2405-> (u (u (u parser_reply_value _2403) _2404) (u maybe_to_bool _2405))); })) in (case _2398 of {(0,f) -> u f (\_2406 _2407 _2408-> (u (u (u parser_reply_error _2406) _2407) _2408)); (1,f) -> u f (\_2409 _2410 _2411-> (let _2412 = (u (u (u fm_parser_stop _2362) _2409) _2410) in (case _2412 of {(0,f) -> u f (\_2413 _2414 _2415-> (u (u (u parser_reply_error _2413) _2414) _2415)); (1,f) -> u f (\_2416 _2417 _2418-> (u (u (u parser_reply_value _2416) _2417) (u (u fm_term_ori _2418) (u (u (u fm_term_gol _2376) _2397) _2411)))); }))); }))); }))); }))); }))); }))))
fm_parser_hole = (\_idx_1-> (\_code_2-> (let _2419 = (u (u fm_parser_init _idx_1) _code_2) in (case _2419 of {(0,f) -> u f (\_2420 _2421 _2422-> (u (u (u parser_reply_error _2420) _2421) _2422)); (1,f) -> u f (\_2423 _2424 _2425-> (let _2426 = (u (u (u fm_parser_text "_") _2423) _2424) in (case _2426 of {(0,f) -> u f (\_2427 _2428 _2429-> (u (u (u parser_reply_error _2427) _2428) _2429)); (1,f) -> u f (\_2430 _2431 _2432-> (let _2433 = (u (u (u fm_parser_stop _2425) _2430) _2431) in (case _2433 of {(0,f) -> u f (\_2434 _2435 _2436-> (u (u (u parser_reply_error _2434) _2435) _2436)); (1,f) -> u f (\_2437 _2438 _2439-> (u (u (u parser_reply_value _2437) _2438) (u (u fm_term_ori _2439) (u fm_term_hol bits_e)))); }))); }))); }))))
fm_parser_u8 = (\_idx_1-> (\_code_2-> (let _2440 = (u (u fm_parser_init _idx_1) _code_2) in (case _2440 of {(0,f) -> u f (\_2441 _2442 _2443-> (u (u (u parser_reply_error _2441) _2442) _2443)); (1,f) -> u f (\_2444 _2445 _2446-> (let _2447 = (u (u fm_parser_spaces _2444) _2445) in (case _2447 of {(0,f) -> u f (\_2448 _2449 _2450-> (u (u (u parser_reply_error _2448) _2449) _2450)); (1,f) -> u f (\_2451 _2452 _2453-> (let _2454 = (u (u parser_nat _2451) _2452) in (case _2454 of {(0,f) -> u f (\_2455 _2456 _2457-> (u (u (u parser_reply_error _2455) _2456) _2457)); (1,f) -> u f (\_2458 _2459 _2460-> (let _2461 = (u (u (u parser_text "b") _2458) _2459) in (case _2461 of {(0,f) -> u f (\_2462 _2463 _2464-> (u (u (u parser_reply_error _2462) _2463) _2464)); (1,f) -> u f (\_2465 _2466 _2467-> (let _term_15=(u fm_term_ref "Nat.to_u8") in (let _term_16=(u (u fm_term_app _term_15) (u fm_term_nat _2460)) in (let _2468 = (u (u (u fm_parser_stop _2446) _2465) _2466) in (case _2468 of {(0,f) -> u f (\_2469 _2470 _2471-> (u (u (u parser_reply_error _2469) _2470) _2471)); (1,f) -> u f (\_2472 _2473 _2474-> (u (u (u parser_reply_value _2472) _2473) (u (u fm_term_ori _2474) _term_16))); }))))); }))); }))); }))); }))))
fm_parser_u16 = (\_idx_1-> (\_code_2-> (let _2475 = (u (u fm_parser_init _idx_1) _code_2) in (case _2475 of {(0,f) -> u f (\_2476 _2477 _2478-> (u (u (u parser_reply_error _2476) _2477) _2478)); (1,f) -> u f (\_2479 _2480 _2481-> (let _2482 = (u (u fm_parser_spaces _2479) _2480) in (case _2482 of {(0,f) -> u f (\_2483 _2484 _2485-> (u (u (u parser_reply_error _2483) _2484) _2485)); (1,f) -> u f (\_2486 _2487 _2488-> (let _2489 = (u (u parser_nat _2486) _2487) in (case _2489 of {(0,f) -> u f (\_2490 _2491 _2492-> (u (u (u parser_reply_error _2490) _2491) _2492)); (1,f) -> u f (\_2493 _2494 _2495-> (let _2496 = (u (u (u parser_text "s") _2493) _2494) in (case _2496 of {(0,f) -> u f (\_2497 _2498 _2499-> (u (u (u parser_reply_error _2497) _2498) _2499)); (1,f) -> u f (\_2500 _2501 _2502-> (let _term_15=(u fm_term_ref "Nat.to_u16") in (let _term_16=(u (u fm_term_app _term_15) (u fm_term_nat _2495)) in (let _2503 = (u (u (u fm_parser_stop _2481) _2500) _2501) in (case _2503 of {(0,f) -> u f (\_2504 _2505 _2506-> (u (u (u parser_reply_error _2504) _2505) _2506)); (1,f) -> u f (\_2507 _2508 _2509-> (u (u (u parser_reply_value _2507) _2508) (u (u fm_term_ori _2509) _term_16))); }))))); }))); }))); }))); }))))
fm_parser_u32 = (\_idx_1-> (\_code_2-> (let _2510 = (u (u fm_parser_init _idx_1) _code_2) in (case _2510 of {(0,f) -> u f (\_2511 _2512 _2513-> (u (u (u parser_reply_error _2511) _2512) _2513)); (1,f) -> u f (\_2514 _2515 _2516-> (let _2517 = (u (u fm_parser_spaces _2514) _2515) in (case _2517 of {(0,f) -> u f (\_2518 _2519 _2520-> (u (u (u parser_reply_error _2518) _2519) _2520)); (1,f) -> u f (\_2521 _2522 _2523-> (let _2524 = (u (u parser_nat _2521) _2522) in (case _2524 of {(0,f) -> u f (\_2525 _2526 _2527-> (u (u (u parser_reply_error _2525) _2526) _2527)); (1,f) -> u f (\_2528 _2529 _2530-> (let _2531 = (u (u (u parser_text "u") _2528) _2529) in (case _2531 of {(0,f) -> u f (\_2532 _2533 _2534-> (u (u (u parser_reply_error _2532) _2533) _2534)); (1,f) -> u f (\_2535 _2536 _2537-> (let _term_15=(u fm_term_ref "Nat.to_u32") in (let _term_16=(u (u fm_term_app _term_15) (u fm_term_nat _2530)) in (let _2538 = (u (u (u fm_parser_stop _2516) _2535) _2536) in (case _2538 of {(0,f) -> u f (\_2539 _2540 _2541-> (u (u (u parser_reply_error _2539) _2540) _2541)); (1,f) -> u f (\_2542 _2543 _2544-> (u (u (u parser_reply_value _2542) _2543) (u (u fm_term_ori _2544) _term_16))); }))))); }))); }))); }))); }))))
fm_parser_u64 = (\_idx_1-> (\_code_2-> (let _2545 = (u (u fm_parser_init _idx_1) _code_2) in (case _2545 of {(0,f) -> u f (\_2546 _2547 _2548-> (u (u (u parser_reply_error _2546) _2547) _2548)); (1,f) -> u f (\_2549 _2550 _2551-> (let _2552 = (u (u fm_parser_spaces _2549) _2550) in (case _2552 of {(0,f) -> u f (\_2553 _2554 _2555-> (u (u (u parser_reply_error _2553) _2554) _2555)); (1,f) -> u f (\_2556 _2557 _2558-> (let _2559 = (u (u parser_nat _2556) _2557) in (case _2559 of {(0,f) -> u f (\_2560 _2561 _2562-> (u (u (u parser_reply_error _2560) _2561) _2562)); (1,f) -> u f (\_2563 _2564 _2565-> (let _2566 = (u (u (u parser_text "l") _2563) _2564) in (case _2566 of {(0,f) -> u f (\_2567 _2568 _2569-> (u (u (u parser_reply_error _2567) _2568) _2569)); (1,f) -> u f (\_2570 _2571 _2572-> (let _term_15=(u fm_term_ref "Nat.to_u64") in (let _term_16=(u (u fm_term_app _term_15) (u fm_term_nat _2565)) in (let _2573 = (u (u (u fm_parser_stop _2551) _2570) _2571) in (case _2573 of {(0,f) -> u f (\_2574 _2575 _2576-> (u (u (u parser_reply_error _2574) _2575) _2576)); (1,f) -> u f (\_2577 _2578 _2579-> (u (u (u parser_reply_value _2577) _2578) (u (u fm_term_ori _2579) _term_16))); }))))); }))); }))); }))); }))))
fm_parser_nat = (\_idx_1-> (\_code_2-> (let _2580 = (u (u fm_parser_init _idx_1) _code_2) in (case _2580 of {(0,f) -> u f (\_2581 _2582 _2583-> (u (u (u parser_reply_error _2581) _2582) _2583)); (1,f) -> u f (\_2584 _2585 _2586-> (let _2587 = (u (u fm_parser_spaces _2584) _2585) in (case _2587 of {(0,f) -> u f (\_2588 _2589 _2590-> (u (u (u parser_reply_error _2588) _2589) _2590)); (1,f) -> u f (\_2591 _2592 _2593-> (let _2594 = (u (u parser_nat _2591) _2592) in (case _2594 of {(0,f) -> u f (\_2595 _2596 _2597-> (u (u (u parser_reply_error _2595) _2596) _2597)); (1,f) -> u f (\_2598 _2599 _2600-> (let _2601 = (u (u (u fm_parser_stop _2586) _2598) _2599) in (case _2601 of {(0,f) -> u f (\_2602 _2603 _2604-> (u (u (u parser_reply_error _2602) _2603) _2604)); (1,f) -> u f (\_2605 _2606 _2607-> (u (u (u parser_reply_value _2605) _2606) (u (u fm_term_ori _2607) (u fm_term_nat _2600)))); }))); }))); }))); }))))
string_eql = (\a0-> \a1-> ((a0::String) == a1))
parser_fail = (\_error_2-> (\_idx_3-> (\_code_4-> (u (u (u parser_reply_error _idx_3) _code_4) _error_2))))
fm_parser_reference = (\_idx_1-> (\_code_2-> (let _2608 = (u (u fm_parser_init _idx_1) _code_2) in (case _2608 of {(0,f) -> u f (\_2609 _2610 _2611-> (u (u (u parser_reply_error _2609) _2610) _2611)); (1,f) -> u f (\_2612 _2613 _2614-> (let _2615 = (u (u fm_parser_name1 _2612) _2613) in (case _2615 of {(0,f) -> u f (\_2616 _2617 _2618-> (u (u (u parser_reply_error _2616) _2617) _2618)); (1,f) -> u f (\_2619 _2620 _2621-> (let _2622 = (((_2621::String) == "case")) in (if _2622 then (u parser_fail "Reserved keyword.") else (let _2623 = (((_2621::String) == "do")) in (if _2623 then (u parser_fail "Reserved keyword.") else (let _2624 = (((_2621::String) == "if")) in (if _2624 then (u parser_fail "Reserved keyword.") else (let _2625 = (((_2621::String) == "let")) in (if _2625 then (u parser_fail "Reserved keyword.") else (let _2626 = (((_2621::String) == "def")) in (if _2626 then (u parser_fail "Reserved keyword.") else (let _2627 = (((_2621::String) == "true")) in (if _2627 then (\_idx_9-> (\_code_10-> (u (u (u parser_reply_value _idx_9) _code_10) (u fm_term_ref "Bool.true")))) else (let _2628 = (((_2621::String) == "false")) in (if _2628 then (\_idx_9-> (\_code_10-> (u (u (u parser_reply_value _idx_9) _code_10) (u fm_term_ref "Bool.false")))) else (let _2629 = (((_2621::String) == "unit")) in (if _2629 then (\_idx_9-> (\_code_10-> (u (u (u parser_reply_value _idx_9) _code_10) (u fm_term_ref "Unit.new")))) else (let _2630 = (((_2621::String) == "none")) in (if _2630 then (let _term_9=(u fm_term_ref "Maybe.none") in (let _term_10=(u (u fm_term_app _term_9) (u fm_term_hol bits_e)) in (\_idx_11-> (\_code_12-> (u (u (u parser_reply_value _idx_11) _code_12) _term_10))))) else (let _2631 = (((_2621::String) == "refl")) in (if _2631 then (let _term_9=(u fm_term_ref "Equal.refl") in (let _term_10=(u (u fm_term_app _term_9) (u fm_term_hol bits_e)) in (let _term_11=(u (u fm_term_app _term_10) (u fm_term_hol bits_e)) in (\_idx_12-> (\_code_13-> (u (u (u parser_reply_value _idx_12) _code_13) _term_11)))))) else (\_idx_9-> (\_code_10-> (let _2632 = (u (u (u fm_parser_stop _2614) _idx_9) _code_10) in (case _2632 of {(0,f) -> u f (\_2633 _2634 _2635-> (u (u (u parser_reply_error _2633) _2634) _2635)); (1,f) -> u f (\_2636 _2637 _2638-> (u (u (u parser_reply_value _2636) _2637) (u (u fm_term_ori _2638) (u fm_term_ref _2621)))); })))))))))))))))))))))))) _2619 _2620); }))); }))))
list_for = (\_xs_2-> (\_b_4-> (\_f_5-> (let _2639 = _xs_2 in (case _2639 of {(0,f) -> u f (_b_4); (1,f) -> u f (\_2640 _2641-> (u (u (u list_for _2641) (u (u _f_5 _2640) _b_4)) _f_5)); })))))
fm_parser_application = (\_init_1-> (\_func_2-> (\_idx_3-> (\_code_4-> (let _2642 = (u (u (u parser_text "(") _idx_3) _code_4) in (case _2642 of {(0,f) -> u f (\_2643 _2644 _2645-> (u (u (u parser_reply_error _2643) _2644) _2645)); (1,f) -> u f (\_2646 _2647 _2648-> (let _2649 = (u (u (u (u parser_until1 (u fm_parser_text ")")) (u fm_parser_item fm_parser_term)) _2646) _2647) in (case _2649 of {(0,f) -> u f (\_2650 _2651 _2652-> (u (u (u parser_reply_error _2650) _2651) _2652)); (1,f) -> u f (\_2653 _2654 _2655-> (let _2656 = (u (u (u fm_parser_stop _init_1) _2653) _2654) in (case _2656 of {(0,f) -> u f (\_2657 _2658 _2659-> (u (u (u parser_reply_error _2657) _2658) _2659)); (1,f) -> u f (\_2660 _2661 _2662-> (let _expr_14=(u (u (u list_for _2655) _func_2) (\_x_14-> (\_f_15-> (u (u fm_term_app _f_15) _x_14)))) in (u (u (u parser_reply_value _2660) _2661) (u (u fm_term_ori _2662) _expr_14)))); }))); }))); }))))))
parser_spaces = (u parser_many (u parser_first_of (u (u list_cons (u parser_text " ")) (u (u list_cons (u parser_text "\n")) list_nil))))
parser_spaces_text = (\_text_1-> (\_idx_2-> (\_code_3-> (let _2663 = (u (u parser_spaces _idx_2) _code_3) in (case _2663 of {(0,f) -> u f (\_2664 _2665 _2666-> (u (u (u parser_reply_error _2664) _2665) _2666)); (1,f) -> u f (\_2667 _2668 _2669-> (u (u (u parser_text _text_1) _2667) _2668)); })))))
fm_parser_application_erased = (\_init_1-> (\_func_2-> (\_idx_3-> (\_code_4-> (let _2670 = (u (u parser_get_index _idx_3) _code_4) in (case _2670 of {(0,f) -> u f (\_2671 _2672 _2673-> (u (u (u parser_reply_error _2671) _2672) _2673)); (1,f) -> u f (\_2674 _2675 _2676-> (let _2677 = (u (u (u parser_text "<") _2674) _2675) in (case _2677 of {(0,f) -> u f (\_2678 _2679 _2680-> (u (u (u parser_reply_error _2678) _2679) _2680)); (1,f) -> u f (\_2681 _2682 _2683-> (let _2684 = (u (u (u (u parser_until1 (u parser_spaces_text ">")) (u fm_parser_item fm_parser_term)) _2681) _2682) in (case _2684 of {(0,f) -> u f (\_2685 _2686 _2687-> (u (u (u parser_reply_error _2685) _2686) _2687)); (1,f) -> u f (\_2688 _2689 _2690-> (let _2691 = (u (u (u fm_parser_stop _2676) _2688) _2689) in (case _2691 of {(0,f) -> u f (\_2692 _2693 _2694-> (u (u (u parser_reply_error _2692) _2693) _2694)); (1,f) -> u f (\_2695 _2696 _2697-> (let _expr_17=(u (u (u list_for _2690) _func_2) (\_x_17-> (\_f_18-> (u (u fm_term_app _f_18) _x_17)))) in (u (u (u parser_reply_value _2695) _2696) (u (u fm_term_ori _2697) _expr_17)))); }))); }))); }))); }))))))
fm_parser_arrow = (\_init_1-> (\_xtyp_2-> (\_idx_3-> (\_code_4-> (let _2698 = (u (u (u fm_parser_text "->") _idx_3) _code_4) in (case _2698 of {(0,f) -> u f (\_2699 _2700 _2701-> (u (u (u parser_reply_error _2699) _2700) _2701)); (1,f) -> u f (\_2702 _2703 _2704-> (let _2705 = (u (u fm_parser_term _2702) _2703) in (case _2705 of {(0,f) -> u f (\_2706 _2707 _2708-> (u (u (u parser_reply_error _2706) _2707) _2708)); (1,f) -> u f (\_2709 _2710 _2711-> (let _2712 = (u (u (u fm_parser_stop _init_1) _2709) _2710) in (case _2712 of {(0,f) -> u f (\_2713 _2714 _2715-> (u (u (u parser_reply_error _2713) _2714) _2715)); (1,f) -> u f (\_2716 _2717 _2718-> (u (u (u parser_reply_value _2716) _2717) (u (u fm_term_ori _2718) (u (u (u (u (u fm_term_all bool_false) "") "") _xtyp_2) (\_s_14-> (\_x_15-> _2711)))))); }))); }))); }))))))
fm_parser_op = (\_sym_1-> (\_ref_2-> (\_init_3-> (\_val0_4-> (\_idx_5-> (\_code_6-> (let _2719 = (u (u (u fm_parser_text _sym_1) _idx_5) _code_6) in (case _2719 of {(0,f) -> u f (\_2720 _2721 _2722-> (u (u (u parser_reply_error _2720) _2721) _2722)); (1,f) -> u f (\_2723 _2724 _2725-> (let _2726 = (u (u fm_parser_term _2723) _2724) in (case _2726 of {(0,f) -> u f (\_2727 _2728 _2729-> (u (u (u parser_reply_error _2727) _2728) _2729)); (1,f) -> u f (\_2730 _2731 _2732-> (let _2733 = (u (u (u fm_parser_stop _init_3) _2730) _2731) in (case _2733 of {(0,f) -> u f (\_2734 _2735 _2736-> (u (u (u parser_reply_error _2734) _2735) _2736)); (1,f) -> u f (\_2737 _2738 _2739-> (let _term_16=(u fm_term_ref _ref_2) in (let _term_17=(u (u fm_term_app _term_16) _val0_4) in (let _term_18=(u (u fm_term_app _term_17) _2732) in (u (u (u parser_reply_value _2737) _2738) (u (u fm_term_ori _2739) _term_18)))))); }))); }))); }))))))))
fm_parser_add = (u (u fm_parser_op "+") "Nat.add")
fm_parser_sub = (u (u fm_parser_op "+") "Nat.add")
fm_parser_mul = (u (u fm_parser_op "*") "Nat.mul")
fm_parser_div = (u (u fm_parser_op "/") "Nat.div")
fm_parser_mod = (u (u fm_parser_op "%") "Nat.mod")
fm_parser_cons = (\_init_1-> (\_head_2-> (\_idx_3-> (\_code_4-> (let _2740 = (u (u (u fm_parser_text "&") _idx_3) _code_4) in (case _2740 of {(0,f) -> u f (\_2741 _2742 _2743-> (u (u (u parser_reply_error _2741) _2742) _2743)); (1,f) -> u f (\_2744 _2745 _2746-> (let _2747 = (u (u fm_parser_term _2744) _2745) in (case _2747 of {(0,f) -> u f (\_2748 _2749 _2750-> (u (u (u parser_reply_error _2748) _2749) _2750)); (1,f) -> u f (\_2751 _2752 _2753-> (let _2754 = (u (u (u fm_parser_stop _init_1) _2751) _2752) in (case _2754 of {(0,f) -> u f (\_2755 _2756 _2757-> (u (u (u parser_reply_error _2755) _2756) _2757)); (1,f) -> u f (\_2758 _2759 _2760-> (let _term_14=(u fm_term_ref "List.cons") in (let _term_15=(u (u fm_term_app _term_14) (u fm_term_hol bits_e)) in (let _term_16=(u (u fm_term_app _term_15) _head_2) in (let _term_17=(u (u fm_term_app _term_16) _2753) in (let _2761 = (u (u (u fm_parser_stop _init_1) _2758) _2759) in (case _2761 of {(0,f) -> u f (\_2762 _2763 _2764-> (u (u (u parser_reply_error _2762) _2763) _2764)); (1,f) -> u f (\_2765 _2766 _2767-> (u (u (u parser_reply_value _2765) _2766) (u (u fm_term_ori _2767) _term_17))); }))))))); }))); }))); }))))))
fm_parser_concat = (\_init_1-> (\_lst0_2-> (\_idx_3-> (\_code_4-> (let _2768 = (u (u (u fm_parser_text "++") _idx_3) _code_4) in (case _2768 of {(0,f) -> u f (\_2769 _2770 _2771-> (u (u (u parser_reply_error _2769) _2770) _2771)); (1,f) -> u f (\_2772 _2773 _2774-> (let _2775 = (u (u fm_parser_term _2772) _2773) in (case _2775 of {(0,f) -> u f (\_2776 _2777 _2778-> (u (u (u parser_reply_error _2776) _2777) _2778)); (1,f) -> u f (\_2779 _2780 _2781-> (let _2782 = (u (u (u fm_parser_stop _init_1) _2779) _2780) in (case _2782 of {(0,f) -> u f (\_2783 _2784 _2785-> (u (u (u parser_reply_error _2783) _2784) _2785)); (1,f) -> u f (\_2786 _2787 _2788-> (let _term_14=(u fm_term_ref "List.concat") in (let _term_15=(u (u fm_term_app _term_14) (u fm_term_hol bits_e)) in (let _term_16=(u (u fm_term_app _term_15) _lst0_2) in (let _term_17=(u (u fm_term_app _term_16) _2781) in (let _2789 = (u (u (u fm_parser_stop _init_1) _2786) _2787) in (case _2789 of {(0,f) -> u f (\_2790 _2791 _2792-> (u (u (u parser_reply_error _2790) _2791) _2792)); (1,f) -> u f (\_2793 _2794 _2795-> (u (u (u parser_reply_value _2793) _2794) (u (u fm_term_ori _2795) _term_17))); }))))))); }))); }))); }))))))
fm_parser_string_concat = (\_init_1-> (\_str0_2-> (\_idx_3-> (\_code_4-> (let _2796 = (u (u (u fm_parser_text "|") _idx_3) _code_4) in (case _2796 of {(0,f) -> u f (\_2797 _2798 _2799-> (u (u (u parser_reply_error _2797) _2798) _2799)); (1,f) -> u f (\_2800 _2801 _2802-> (let _2803 = (u (u fm_parser_term _2800) _2801) in (case _2803 of {(0,f) -> u f (\_2804 _2805 _2806-> (u (u (u parser_reply_error _2804) _2805) _2806)); (1,f) -> u f (\_2807 _2808 _2809-> (let _2810 = (u (u (u fm_parser_stop _init_1) _2807) _2808) in (case _2810 of {(0,f) -> u f (\_2811 _2812 _2813-> (u (u (u parser_reply_error _2811) _2812) _2813)); (1,f) -> u f (\_2814 _2815 _2816-> (let _term_14=(u fm_term_ref "String.concat") in (let _term_15=(u (u fm_term_app _term_14) _str0_2) in (let _term_16=(u (u fm_term_app _term_15) _2809) in (let _2817 = (u (u (u fm_parser_stop _init_1) _2814) _2815) in (case _2817 of {(0,f) -> u f (\_2818 _2819 _2820-> (u (u (u parser_reply_error _2818) _2819) _2820)); (1,f) -> u f (\_2821 _2822 _2823-> (u (u (u parser_reply_value _2821) _2822) (u (u fm_term_ori _2823) _term_16))); })))))); }))); }))); }))))))
fm_parser_sigma = (\_init_1-> (\_val0_2-> (\_idx_3-> (\_code_4-> (let _2824 = (u (u (u fm_parser_text "~") _idx_3) _code_4) in (case _2824 of {(0,f) -> u f (\_2825 _2826 _2827-> (u (u (u parser_reply_error _2825) _2826) _2827)); (1,f) -> u f (\_2828 _2829 _2830-> (let _2831 = (u (u fm_parser_term _2828) _2829) in (case _2831 of {(0,f) -> u f (\_2832 _2833 _2834-> (u (u (u parser_reply_error _2832) _2833) _2834)); (1,f) -> u f (\_2835 _2836 _2837-> (let _2838 = (u (u (u fm_parser_stop _init_1) _2835) _2836) in (case _2838 of {(0,f) -> u f (\_2839 _2840 _2841-> (u (u (u parser_reply_error _2839) _2840) _2841)); (1,f) -> u f (\_2842 _2843 _2844-> (let _term_14=(u fm_term_ref "Sigma.new") in (let _term_15=(u (u fm_term_app _term_14) (u fm_term_hol bits_e)) in (let _term_16=(u (u fm_term_app _term_15) (u fm_term_hol bits_e)) in (let _term_17=(u (u fm_term_app _term_16) _val0_2) in (let _term_18=(u (u fm_term_app _term_17) _2837) in (u (u (u parser_reply_value _2842) _2843) (u (u fm_term_ori _2844) _term_18)))))))); }))); }))); }))))))
fm_parser_equality = (\_init_1-> (\_val0_2-> (\_idx_3-> (\_code_4-> (let _2845 = (u (u (u fm_parser_text "==") _idx_3) _code_4) in (case _2845 of {(0,f) -> u f (\_2846 _2847 _2848-> (u (u (u parser_reply_error _2846) _2847) _2848)); (1,f) -> u f (\_2849 _2850 _2851-> (let _2852 = (u (u fm_parser_term _2849) _2850) in (case _2852 of {(0,f) -> u f (\_2853 _2854 _2855-> (u (u (u parser_reply_error _2853) _2854) _2855)); (1,f) -> u f (\_2856 _2857 _2858-> (let _2859 = (u (u (u fm_parser_stop _init_1) _2856) _2857) in (case _2859 of {(0,f) -> u f (\_2860 _2861 _2862-> (u (u (u parser_reply_error _2860) _2861) _2862)); (1,f) -> u f (\_2863 _2864 _2865-> (let _term_14=(u fm_term_ref "Equal") in (let _term_15=(u (u fm_term_app _term_14) (u fm_term_hol bits_e)) in (let _term_16=(u (u fm_term_app _term_15) _val0_2) in (let _term_17=(u (u fm_term_app _term_16) _2858) in (u (u (u parser_reply_value _2863) _2864) (u (u fm_term_ori _2865) _term_17))))))); }))); }))); }))))))
fm_parser_inequality = (\_init_1-> (\_val0_2-> (\_idx_3-> (\_code_4-> (let _2866 = (u (u (u fm_parser_text "!=") _idx_3) _code_4) in (case _2866 of {(0,f) -> u f (\_2867 _2868 _2869-> (u (u (u parser_reply_error _2867) _2868) _2869)); (1,f) -> u f (\_2870 _2871 _2872-> (let _2873 = (u (u fm_parser_term _2870) _2871) in (case _2873 of {(0,f) -> u f (\_2874 _2875 _2876-> (u (u (u parser_reply_error _2874) _2875) _2876)); (1,f) -> u f (\_2877 _2878 _2879-> (let _2880 = (u (u (u fm_parser_stop _init_1) _2877) _2878) in (case _2880 of {(0,f) -> u f (\_2881 _2882 _2883-> (u (u (u parser_reply_error _2881) _2882) _2883)); (1,f) -> u f (\_2884 _2885 _2886-> (let _term_14=(u fm_term_ref "Equal") in (let _term_15=(u (u fm_term_app _term_14) (u fm_term_hol bits_e)) in (let _term_16=(u (u fm_term_app _term_15) _val0_2) in (let _term_17=(u (u fm_term_app _term_16) _2879) in (let _term_18=(u (u fm_term_app (u fm_term_ref "Not")) _term_17) in (u (u (u parser_reply_value _2884) _2885) (u (u fm_term_ori _2886) _term_18)))))))); }))); }))); }))))))
fm_parser_rewrite = (\_init_1-> (\_subt_2-> (\_idx_3-> (\_code_4-> (let _2887 = (u (u (u fm_parser_text "::") _idx_3) _code_4) in (case _2887 of {(0,f) -> u f (\_2888 _2889 _2890-> (u (u (u parser_reply_error _2888) _2889) _2890)); (1,f) -> u f (\_2891 _2892 _2893-> (let _2894 = (u (u (u fm_parser_text "rewrite") _2891) _2892) in (case _2894 of {(0,f) -> u f (\_2895 _2896 _2897-> (u (u (u parser_reply_error _2895) _2896) _2897)); (1,f) -> u f (\_2898 _2899 _2900-> (let _2901 = (u (u fm_parser_name1 _2898) _2899) in (case _2901 of {(0,f) -> u f (\_2902 _2903 _2904-> (u (u (u parser_reply_error _2902) _2903) _2904)); (1,f) -> u f (\_2905 _2906 _2907-> (let _2908 = (u (u (u fm_parser_text "in") _2905) _2906) in (case _2908 of {(0,f) -> u f (\_2909 _2910 _2911-> (u (u (u parser_reply_error _2909) _2910) _2911)); (1,f) -> u f (\_2912 _2913 _2914-> (let _2915 = (u (u fm_parser_term _2912) _2913) in (case _2915 of {(0,f) -> u f (\_2916 _2917 _2918-> (u (u (u parser_reply_error _2916) _2917) _2918)); (1,f) -> u f (\_2919 _2920 _2921-> (let _2922 = (u (u (u fm_parser_text "with") _2919) _2920) in (case _2922 of {(0,f) -> u f (\_2923 _2924 _2925-> (u (u (u parser_reply_error _2923) _2924) _2925)); (1,f) -> u f (\_2926 _2927 _2928-> (let _2929 = (u (u fm_parser_term _2926) _2927) in (case _2929 of {(0,f) -> u f (\_2930 _2931 _2932-> (u (u (u parser_reply_error _2930) _2931) _2932)); (1,f) -> u f (\_2933 _2934 _2935-> (let _2936 = (u (u (u fm_parser_stop _init_1) _2933) _2934) in (case _2936 of {(0,f) -> u f (\_2937 _2938 _2939-> (u (u (u parser_reply_error _2937) _2938) _2939)); (1,f) -> u f (\_2940 _2941 _2942-> (let _term_29=(u fm_term_ref "Equal.rewrite") in (let _term_30=(u (u fm_term_app _term_29) (u fm_term_hol bits_e)) in (let _term_31=(u (u fm_term_app _term_30) (u fm_term_hol bits_e)) in (let _term_32=(u (u fm_term_app _term_31) (u fm_term_hol bits_e)) in (let _term_33=(u (u fm_term_app _term_32) (u (u fm_term_lam _2907) (\_x_33-> _2921))) in (let _term_34=(u (u fm_term_app _term_33) _2935) in (let _term_35=(u (u fm_term_app _term_34) _subt_2) in (u (u (u parser_reply_value _2940) _2941) (u (u fm_term_ori _2942) _term_35)))))))))); }))); }))); }))); }))); }))); }))); }))); }))))))
fm_term_ann = (\_done_1-> (\_term_2-> (\_type_3-> (8,\t-> t _done_1 _term_2 _type_3))))
fm_parser_annotation = (\_init_1-> (\_term_2-> (\_idx_3-> (\_code_4-> (let _2943 = (u (u (u fm_parser_text "::") _idx_3) _code_4) in (case _2943 of {(0,f) -> u f (\_2944 _2945 _2946-> (u (u (u parser_reply_error _2944) _2945) _2946)); (1,f) -> u f (\_2947 _2948 _2949-> (let _2950 = (u (u fm_parser_term _2947) _2948) in (case _2950 of {(0,f) -> u f (\_2951 _2952 _2953-> (u (u (u parser_reply_error _2951) _2952) _2953)); (1,f) -> u f (\_2954 _2955 _2956-> (let _2957 = (u (u (u fm_parser_stop _init_1) _2954) _2955) in (case _2957 of {(0,f) -> u f (\_2958 _2959 _2960-> (u (u (u parser_reply_error _2958) _2959) _2960)); (1,f) -> u f (\_2961 _2962 _2963-> (u (u (u parser_reply_value _2961) _2962) (u (u fm_term_ori _2963) (u (u (u fm_term_ann bool_false) _term_2) _2956)))); }))); }))); }))))))
fm_parser_application_hole = (\_init_1-> (\_term_2-> (\_idx_3-> (\_code_4-> (let _2964 = (u (u (u fm_parser_text "!") _idx_3) _code_4) in (case _2964 of {(0,f) -> u f (\_2965 _2966 _2967-> (u (u (u parser_reply_error _2965) _2966) _2967)); (1,f) -> u f (\_2968 _2969 _2970-> (let _2971 = (u (u (u fm_parser_stop _init_1) _2968) _2969) in (case _2971 of {(0,f) -> u f (\_2972 _2973 _2974-> (u (u (u parser_reply_error _2972) _2973) _2974)); (1,f) -> u f (\_2975 _2976 _2977-> (u (u (u parser_reply_value _2975) _2976) (u (u fm_term_ori _2977) (u (u fm_term_app _term_2) (u fm_term_hol bits_e))))); }))); }))))))
fm_parser_suffix = (\_init_1-> (\_term_2-> (\_idx_3-> (\_code_4-> (let _suffix_parser_5=(u parser_first_of (u (u list_cons (u (u fm_parser_application _init_1) _term_2)) (u (u list_cons (u (u fm_parser_application_erased _init_1) _term_2)) (u (u list_cons (u (u fm_parser_arrow _init_1) _term_2)) (u (u list_cons (u (u fm_parser_add _init_1) _term_2)) (u (u list_cons (u (u fm_parser_sub _init_1) _term_2)) (u (u list_cons (u (u fm_parser_mul _init_1) _term_2)) (u (u list_cons (u (u fm_parser_div _init_1) _term_2)) (u (u list_cons (u (u fm_parser_mod _init_1) _term_2)) (u (u list_cons (u (u fm_parser_cons _init_1) _term_2)) (u (u list_cons (u (u fm_parser_concat _init_1) _term_2)) (u (u list_cons (u (u fm_parser_string_concat _init_1) _term_2)) (u (u list_cons (u (u fm_parser_sigma _init_1) _term_2)) (u (u list_cons (u (u fm_parser_equality _init_1) _term_2)) (u (u list_cons (u (u fm_parser_inequality _init_1) _term_2)) (u (u list_cons (u (u fm_parser_rewrite _init_1) _term_2)) (u (u list_cons (u (u fm_parser_annotation _init_1) _term_2)) (u (u list_cons (u (u fm_parser_application_hole _init_1) _term_2)) list_nil)))))))))))))))))) in (let _2978 = (u (u _suffix_parser_5 _idx_3) _code_4) in (case _2978 of {(0,f) -> u f (\_2979 _2980 _2981-> (u (u (u parser_reply_value _idx_3) _code_4) _term_2)); (1,f) -> u f (\_2982 _2983 _2984-> (u (u (u (u fm_parser_suffix _init_1) _2984) _2982) _2983)); })))))))
fm_parser_term = (\_idx_1-> (\_code_2-> (let _2985 = (u (u parser_get_code _idx_1) _code_2) in (case _2985 of {(0,f) -> u f (\_2986 _2987 _2988-> (u (u (u parser_reply_error _2986) _2987) _2988)); (1,f) -> u f (\_2989 _2990 _2991-> (let _2992 = (u (u fm_parser_init _2989) _2990) in (case _2992 of {(0,f) -> u f (\_2993 _2994 _2995-> (u (u (u parser_reply_error _2993) _2994) _2995)); (1,f) -> u f (\_2996 _2997 _2998-> (let _2999 = (u (u (u parser_first_of (u (u list_cons fm_parser_type) (u (u list_cons fm_parser_forall) (u (u list_cons fm_parser_lambda) (u (u list_cons fm_parser_lambda_erased) (u (u list_cons fm_parser_lambda_nameless) (u (u list_cons fm_parser_parenthesis) (u (u list_cons fm_parser_letforrange_u32) (u (u list_cons fm_parser_letforin) (u (u list_cons fm_parser_let) (u (u list_cons fm_parser_get) (u (u list_cons fm_parser_def) (u (u list_cons fm_parser_if) (u (u list_cons fm_parser_char) (u (u list_cons fm_parser_string) (u (u list_cons fm_parser_pair) (u (u list_cons fm_parser_sigma_type) (u (u list_cons fm_parser_some) (u (u list_cons fm_parser_apply) (u (u list_cons fm_parser_list) (u (u list_cons fm_parser_log) (u (u list_cons fm_parser_forrange_u32) (u (u list_cons fm_parser_forrange_u32_2) (u (u list_cons fm_parser_forin) (u (u list_cons fm_parser_forin_2) (u (u list_cons fm_parser_do) (u (u list_cons fm_parser_case) (u (u list_cons fm_parser_open) (u (u list_cons fm_parser_goal) (u (u list_cons fm_parser_hole) (u (u list_cons fm_parser_u8) (u (u list_cons fm_parser_u16) (u (u list_cons fm_parser_u32) (u (u list_cons fm_parser_u64) (u (u list_cons fm_parser_nat) (u (u list_cons fm_parser_reference) list_nil)))))))))))))))))))))))))))))))))))) _2996) _2997) in (case _2999 of {(0,f) -> u f (\_3000 _3001 _3002-> (u (u (u parser_reply_error _3000) _3001) _3002)); (1,f) -> u f (\_3003 _3004 _3005-> (u (u (u (u fm_parser_suffix _2998) _3005) _3003) _3004)); }))); }))); }))))
fm_parser_name_term = (\_idx_1-> (\_code_2-> (let _3006 = (u (u fm_parser_name _idx_1) _code_2) in (case _3006 of {(0,f) -> u f (\_3007 _3008 _3009-> (u (u (u parser_reply_error _3007) _3008) _3009)); (1,f) -> u f (\_3010 _3011 _3012-> (let _3013 = (u (u (u fm_parser_text ":") _3010) _3011) in (case _3013 of {(0,f) -> u f (\_3014 _3015 _3016-> (u (u (u parser_reply_error _3014) _3015) _3016)); (1,f) -> u f (\_3017 _3018 _3019-> (let _3020 = (u (u fm_parser_term _3017) _3018) in (case _3020 of {(0,f) -> u f (\_3021 _3022 _3023-> (u (u (u parser_reply_error _3021) _3022) _3023)); (1,f) -> u f (\_3024 _3025 _3026-> (u (u (u parser_reply_value _3024) _3025) (u (u pair_new _3012) _3026))); }))); }))); }))))
fm_binder_new = (\_eras_1-> (\_name_2-> (\_term_3-> (0,\t-> t _eras_1 _name_2 _term_3))))
fm_parser_binder_homo = (\_eras_1-> (\_idx_2-> (\_code_3-> (let _3027 = (u (u (u fm_parser_text (let _3028 = _eras_1 in (if _3028 then "<" else "("))) _idx_2) _code_3) in (case _3027 of {(0,f) -> u f (\_3029 _3030 _3031-> (u (u (u parser_reply_error _3029) _3030) _3031)); (1,f) -> u f (\_3032 _3033 _3034-> (let _3035 = (u (u (u (u parser_until1 (u fm_parser_text (let _3036 = _eras_1 in (if _3036 then ">" else ")")))) (u fm_parser_item fm_parser_name_term)) _3032) _3033) in (case _3035 of {(0,f) -> u f (\_3037 _3038 _3039-> (u (u (u parser_reply_error _3037) _3038) _3039)); (1,f) -> u f (\_3040 _3041 _3042-> (u (u (u parser_reply_value _3040) _3041) (u (u list_mapped _3042) (\_pair_10-> (let _3043 = _pair_10 in (case _3043 of {(0,f) -> u f (\_3044 _3045-> (u (u (u fm_binder_new _eras_1) _3044) _3045)); })))))); }))); })))))
list_concat = (\_as_2-> (\_bs_3-> (let _3046 = _as_2 in (case _3046 of {(0,f) -> u f (_bs_3); (1,f) -> u f (\_3047 _3048-> (u (u list_cons _3047) (u (u list_concat _3048) _bs_3))); }))))
list_flatten = (\_xs_2-> (let _3049 = _xs_2 in (case _3049 of {(0,f) -> u f (list_nil); (1,f) -> u f (\_3050 _3051-> (u (u list_concat _3050) (u list_flatten _3051))); })))
fm_parser_binder = (\_idx_1-> (\_code_2-> (let _3052 = (u (u (u parser_many1 (u parser_first_of (u (u list_cons (u fm_parser_binder_homo bool_true)) (u (u list_cons (u fm_parser_binder_homo bool_false)) list_nil)))) _idx_1) _code_2) in (case _3052 of {(0,f) -> u f (\_3053 _3054 _3055-> (u (u (u parser_reply_error _3053) _3054) _3055)); (1,f) -> u f (\_3056 _3057 _3058-> (u (u (u parser_reply_value _3056) _3057) (u list_flatten _3058))); }))))
fm_parser_make_forall = (\_binds_1-> (\_body_2-> (let _3059 = _binds_1 in (case _3059 of {(0,f) -> u f (_body_2); (1,f) -> u f (\_3060 _3061-> (let _3062 = _3060 in (case _3062 of {(0,f) -> u f (\_3063 _3064 _3065-> (u (u (u (u (u fm_term_all _3063) "") _3064) _3065) (\_s_8-> (\_x_9-> (u (u fm_parser_make_forall _3061) _body_2))))); }))); }))))
list_at = (\_index_2-> (\_list_3-> (let _3066 = _list_3 in (case _3066 of {(0,f) -> u f (maybe_none); (1,f) -> u f (\_3067 _3068-> (let _3069 = _index_2 in (if _3069==0 then (u maybe_some _3067) else (u (u list_at (_3069-1)) _3068)))); }))))
list_at_last = (\_index_2-> (\_list_3-> (u (u list_at _index_2) (u list_reverse _list_3))))
fm_term_var = (\_name_1-> (\_indx_2-> (0,\t-> t _name_1 _indx_2)))
fm_context_get_name_skips = (\_name_1-> (let _3070 = _name_1 in (if null (_3070::String) then (u (u pair_new "") 0) else (let _name_skips_4=(u fm_context_get_name_skips (tail _3070)) in (let _3071 = _name_skips_4 in (case _3071 of {(0,f) -> u f (\_3072 _3073-> (let _3074 = ((((fromIntegral (fromEnum (head _3070 :: Char)) :: Word16)::Word16) == 94)) in (if _3074 then (u (u pair_new _3072) (u nat_succ _3073)) else (u (u pair_new (u (u string_cons (fromIntegral (fromEnum (head _3070 :: Char)) :: Word16)) _3072)) _3073)))); }))))))
fm_name_eql = (\_a_1-> (\_b_2-> (((_a_1::String) == _b_2))))
fm_context_find_go = (\_name_1-> (\_skip_2-> (\_ctx_3-> (let _3075 = _ctx_3 in (case _3075 of {(0,f) -> u f (maybe_none); (1,f) -> u f (\_3076 _3077-> (let _3078 = _3076 in (case _3078 of {(0,f) -> u f (\_3079 _3080-> (let _3081 = (u (u fm_name_eql _name_1) _3079) in (if _3081 then (let _3082 = _skip_2 in (if _3082==0 then (u maybe_some _3080) else (u (u (u fm_context_find_go _name_1) (_3082-1)) _3077))) else (u (u (u fm_context_find_go _name_1) _skip_2) _3077)))); }))); })))))
fm_context_find = (\_name_1-> (\_ctx_2-> (let _3083 = (u fm_context_get_name_skips _name_1) in (case _3083 of {(0,f) -> u f (\_3084 _3085-> (u (u (u fm_context_find_go _3084) _3085) _ctx_2)); }))))
list_length = (\_xs_2-> (let _3086 = _xs_2 in (case _3086 of {(0,f) -> u f (0); (1,f) -> u f (\_3087 _3088-> (u nat_succ (u list_length _3088))); })))
fm_path_o = (\_path_1-> (\_x_2-> (u _path_1 (u bits_o _x_2))))
fm_path_i = (\_path_1-> (\_x_2-> (u _path_1 (u bits_i _x_2))))
fm_path_to_bits = (\_path_1-> (u _path_1 bits_e))
fm_term_bind = (\_vars_1-> (\_path_2-> (\_term_3-> (let _3089 = _term_3 in (case _3089 of {(0,f) -> u f (\_3090 _3091-> (let _3092 = (u (u list_at_last _3091) _vars_1) in (case _3092 of {(0,f) -> u f ((u (u fm_term_var _3090) _3091)); (1,f) -> u f (\_3093-> (u pair_snd _3093)); }))); (1,f) -> u f (\_3094-> (let _3095 = (u (u fm_context_find _3094) _vars_1) in (case _3095 of {(0,f) -> u f ((u fm_term_ref _3094)); (1,f) -> u f (\_3096-> _3096); }))); (2,f) -> u f (fm_term_typ); (3,f) -> u f (\_3097 _3098 _3099 _3100 _3101-> (let _vlen_9=(u list_length _vars_1) in (u (u (u (u (u fm_term_all _3097) _3098) _3099) (u (u (u fm_term_bind _vars_1) (u fm_path_o _path_2)) _3100)) (\_s_10-> (\_x_11-> (u (u (u fm_term_bind (u (u list_cons (u (u pair_new _3099) _x_11)) (u (u list_cons (u (u pair_new _3098) _s_10)) _vars_1))) (u fm_path_i _path_2)) (u (u _3101 (u (u fm_term_var _3098) _vlen_9)) (u (u fm_term_var _3099) (u nat_succ _vlen_9))))))))); (4,f) -> u f (\_3102 _3103-> (let _vlen_6=(u list_length _vars_1) in (u (u fm_term_lam _3102) (\_x_7-> (u (u (u fm_term_bind (u (u list_cons (u (u pair_new _3102) _x_7)) _vars_1)) (u fm_path_o _path_2)) (u _3103 (u (u fm_term_var _3102) _vlen_6))))))); (5,f) -> u f (\_3104 _3105-> (u (u fm_term_app (u (u (u fm_term_bind _vars_1) (u fm_path_o _path_2)) _3104)) (u (u (u fm_term_bind _vars_1) (u fm_path_i _path_2)) _3105))); (6,f) -> u f (\_3106 _3107 _3108-> (let _vlen_7=(u list_length _vars_1) in (u (u (u fm_term_let _3106) (u (u (u fm_term_bind _vars_1) (u fm_path_o _path_2)) _3107)) (\_x_8-> (u (u (u fm_term_bind (u (u list_cons (u (u pair_new _3106) _x_8)) _vars_1)) (u fm_path_i _path_2)) (u _3108 (u (u fm_term_var _3106) _vlen_7))))))); (7,f) -> u f (\_3109 _3110 _3111-> (let _vlen_7=(u list_length _vars_1) in (u (u (u fm_term_def _3109) (u (u (u fm_term_bind _vars_1) (u fm_path_o _path_2)) _3110)) (\_x_8-> (u (u (u fm_term_bind (u (u list_cons (u (u pair_new _3109) _x_8)) _vars_1)) (u fm_path_i _path_2)) (u _3111 (u (u fm_term_var _3109) _vlen_7))))))); (8,f) -> u f (\_3112 _3113 _3114-> (u (u (u fm_term_ann _3112) (u (u (u fm_term_bind _vars_1) (u fm_path_o _path_2)) _3113)) (u (u (u fm_term_bind _vars_1) (u fm_path_i _path_2)) _3114))); (9,f) -> u f (\_3115 _3116 _3117-> (u (u (u fm_term_gol _3115) _3116) _3117)); (10,f) -> u f (\_3118-> (u fm_term_hol (u fm_path_to_bits _path_2))); (11,f) -> u f (\_3119-> (u fm_term_nat _3119)); (12,f) -> u f (\_3120-> (u fm_term_chr _3120)); (13,f) -> u f (\_3121-> (u fm_term_str _3121)); (14,f) -> u f (\_3122 _3123 _3124 _3125 _3126 _3127-> (let _expr_10=(u (u (u fm_term_bind _vars_1) (u fm_path_o _path_2)) _3123) in (let _name_11=_3124 in (let _wyth_12=_3125 in (let _cses_13=_3126 in (let _moti_14=_3127 in (u (u (u (u (u (u fm_term_cse (u fm_path_to_bits _path_2)) _expr_10) _name_11) _wyth_12) _cses_13) _moti_14))))))); (15,f) -> u f (\_3128 _3129-> (u (u fm_term_ori _3128) (u (u (u fm_term_bind _vars_1) _path_2) _3129))); })))))
fm_status_done = (2,\t-> t)
fm_define = (\_file_1-> (\_code_2-> (\_name_3-> (\_term_4-> (\_type_5-> (\_done_6-> (\_defs_7-> (let _stat_8=(let _3130 = _done_6 in (if _3130 then fm_status_done else fm_status_init)) in (u (u (u fm_set _name_3) (u (u (u (u (u (u fm_def_new _file_1) _code_2) _name_3) _term_4) _type_5) _stat_8)) _defs_7)))))))))
fm_parser_file_def = (\_file_1-> (\_code_2-> (\_defs_3-> (\_idx_4-> (\_code_5-> (let _3131 = (u (u fm_parser_name1 _idx_4) _code_5) in (case _3131 of {(0,f) -> u f (\_3132 _3133 _3134-> (u (u (u parser_reply_error _3132) _3133) _3134)); (1,f) -> u f (\_3135 _3136 _3137-> (let _3138 = (u (u (u parser_many fm_parser_binder) _3135) _3136) in (case _3138 of {(0,f) -> u f (\_3139 _3140 _3141-> (u (u (u parser_reply_error _3139) _3140) _3141)); (1,f) -> u f (\_3142 _3143 _3144-> (let _args_12=(u list_flatten _3144) in (let _3145 = (u (u (u fm_parser_text ":") _3142) _3143) in (case _3145 of {(0,f) -> u f (\_3146 _3147 _3148-> (u (u (u parser_reply_error _3146) _3147) _3148)); (1,f) -> u f (\_3149 _3150 _3151-> (let _3152 = (u (u fm_parser_term _3149) _3150) in (case _3152 of {(0,f) -> u f (\_3153 _3154 _3155-> (u (u (u parser_reply_error _3153) _3154) _3155)); (1,f) -> u f (\_3156 _3157 _3158-> (let _3159 = (u (u fm_parser_term _3156) _3157) in (case _3159 of {(0,f) -> u f (\_3160 _3161 _3162-> (u (u (u parser_reply_error _3160) _3161) _3162)); (1,f) -> u f (\_3163 _3164 _3165-> (let _type_22=(u (u fm_parser_make_forall _args_12) _3158) in (let _term_23=(u (u fm_parser_make_lambda (u (u list_mapped _args_12) (\_x_23-> (let _3166 = _x_23 in (case _3166 of {(0,f) -> u f (\_3167 _3168 _3169-> _3168); }))))) _3165) in (let _type_24=(u (u (u fm_term_bind list_nil) (\_x_24-> (u bits_i _x_24))) _type_22) in (let _term_25=(u (u (u fm_term_bind list_nil) (\_x_25-> (u bits_o _x_25))) _term_23) in (let _defs_26=(u (u (u (u (u (u (u fm_define _file_1) _code_2) _3137) _term_25) _type_24) bool_false) _defs_3) in (u (u (u parser_reply_value _3163) _3164) _defs_26))))))); }))); }))); })))); }))); })))))))
maybe_default = (\_a_2-> (\_m_3-> (let _3170 = _m_3 in (case _3170 of {(0,f) -> u f (_a_2); (1,f) -> u f (\_3171-> _3171); }))))
fm_constructor_new = (\_name_1-> (\_args_2-> (\_inds_3-> (0,\t-> t _name_1 _args_2 _inds_3))))
fm_parser_constructor = (\_namespace_1-> (\_idx_2-> (\_code_3-> (let _3172 = (u (u fm_parser_name1 _idx_2) _code_3) in (case _3172 of {(0,f) -> u f (\_3173 _3174 _3175-> (u (u (u parser_reply_error _3173) _3174) _3175)); (1,f) -> u f (\_3176 _3177 _3178-> (let _3179 = (u (u (u parser_maybe fm_parser_binder) _3176) _3177) in (case _3179 of {(0,f) -> u f (\_3180 _3181 _3182-> (u (u (u parser_reply_error _3180) _3181) _3182)); (1,f) -> u f (\_3183 _3184 _3185-> (let _3186 = (u (u (u parser_maybe (\_idx_10-> (\_code_11-> (let _3187 = (u (u (u fm_parser_text "~") _idx_10) _code_11) in (case _3187 of {(0,f) -> u f (\_3188 _3189 _3190-> (u (u (u parser_reply_error _3188) _3189) _3190)); (1,f) -> u f (\_3191 _3192 _3193-> (u (u fm_parser_binder _3191) _3192)); }))))) _3183) _3184) in (case _3186 of {(0,f) -> u f (\_3194 _3195 _3196-> (u (u (u parser_reply_error _3194) _3195) _3196)); (1,f) -> u f (\_3197 _3198 _3199-> (let _args_13=(u (u maybe_default list_nil) _3185) in (let _inds_14=(u (u maybe_default list_nil) _3199) in (u (u (u parser_reply_value _3197) _3198) (u (u (u fm_constructor_new _3178) _args_13) _inds_14))))); }))); }))); })))))
fm_datatype_new = (\_name_1-> (\_pars_2-> (\_inds_3-> (\_ctrs_4-> (0,\t-> t _name_1 _pars_2 _inds_3 _ctrs_4)))))
fm_parser_datatype = (\_idx_1-> (\_code_2-> (let _3200 = (u (u (u fm_parser_text "type ") _idx_1) _code_2) in (case _3200 of {(0,f) -> u f (\_3201 _3202 _3203-> (u (u (u parser_reply_error _3201) _3202) _3203)); (1,f) -> u f (\_3204 _3205 _3206-> (let _3207 = (u (u fm_parser_name1 _3204) _3205) in (case _3207 of {(0,f) -> u f (\_3208 _3209 _3210-> (u (u (u parser_reply_error _3208) _3209) _3210)); (1,f) -> u f (\_3211 _3212 _3213-> (let _3214 = (u (u (u parser_maybe fm_parser_binder) _3211) _3212) in (case _3214 of {(0,f) -> u f (\_3215 _3216 _3217-> (u (u (u parser_reply_error _3215) _3216) _3217)); (1,f) -> u f (\_3218 _3219 _3220-> (let _3221 = (u (u (u parser_maybe (\_idx_12-> (\_code_13-> (let _3222 = (u (u (u fm_parser_text "~") _idx_12) _code_13) in (case _3222 of {(0,f) -> u f (\_3223 _3224 _3225-> (u (u (u parser_reply_error _3223) _3224) _3225)); (1,f) -> u f (\_3226 _3227 _3228-> (u (u fm_parser_binder _3226) _3227)); }))))) _3218) _3219) in (case _3221 of {(0,f) -> u f (\_3229 _3230 _3231-> (u (u (u parser_reply_error _3229) _3230) _3231)); (1,f) -> u f (\_3232 _3233 _3234-> (let _pars_15=(u (u maybe_default list_nil) _3220) in (let _inds_16=(u (u maybe_default list_nil) _3234) in (let _3235 = (u (u (u fm_parser_text "{") _3232) _3233) in (case _3235 of {(0,f) -> u f (\_3236 _3237 _3238-> (u (u (u parser_reply_error _3236) _3237) _3238)); (1,f) -> u f (\_3239 _3240 _3241-> (let _3242 = (u (u (u (u parser_until (u fm_parser_text "}")) (u fm_parser_item (u fm_parser_constructor _3213))) _3239) _3240) in (case _3242 of {(0,f) -> u f (\_3243 _3244 _3245-> (u (u (u parser_reply_error _3243) _3244) _3245)); (1,f) -> u f (\_3246 _3247 _3248-> (u (u (u parser_reply_value _3246) _3247) (u (u (u (u fm_datatype_new _3213) _pars_15) _inds_16) _3248))); }))); }))))); }))); }))); }))); }))))
fm_datatype_build_term_motive_go = (\_type_1-> (\_name_2-> (\_inds_3-> (let _3249 = _inds_3 in (case _3249 of {(0,f) -> u f ((let _3250 = _type_1 in (case _3250 of {(0,f) -> u f (\_3251 _3252 _3253 _3254-> (let _slf_8=(u fm_term_ref _name_2) in (let _slf_9=(u (u (u list_for _3252) _slf_8) (\_var_9-> (\_slf_10-> (u (u fm_term_app _slf_10) (u fm_term_ref (let _3255 = _var_9 in (case _3255 of {(0,f) -> u f (\_3256 _3257 _3258-> _3257); }))))))) in (let _slf_10=(u (u (u list_for _3253) _slf_9) (\_var_10-> (\_slf_11-> (u (u fm_term_app _slf_11) (u fm_term_ref (let _3259 = _var_10 in (case _3259 of {(0,f) -> u f (\_3260 _3261 _3262-> _3261); }))))))) in (u (u (u (u (u fm_term_all bool_false) "") "") _slf_10) (\_s_11-> (\_x_12-> fm_term_typ))))))); }))); (1,f) -> u f (\_3263 _3264-> (let _3265 = _3263 in (case _3265 of {(0,f) -> u f (\_3266 _3267 _3268-> (u (u (u (u (u fm_term_all _3266) "") _3267) _3268) (\_s_9-> (\_x_10-> (u (u (u fm_datatype_build_term_motive_go _type_1) _name_2) _3264))))); }))); })))))
fm_datatype_build_term_motive = (\_type_1-> (let _3269 = _type_1 in (case _3269 of {(0,f) -> u f (\_3270 _3271 _3272 _3273-> (u (u (u fm_datatype_build_term_motive_go _type_1) _3270) _3272)); })))
fm_datatype_build_term_constructor_go = (\_type_1-> (\_ctor_2-> (\_args_3-> (let _3274 = _args_3 in (case _3274 of {(0,f) -> u f ((let _3275 = _type_1 in (case _3275 of {(0,f) -> u f (\_3276 _3277 _3278 _3279-> (let _3280 = _ctor_2 in (case _3280 of {(0,f) -> u f (\_3281 _3282 _3283-> (let _ret_11=(u fm_term_ref (u fm_name_read "P")) in (let _ret_12=(u (u (u list_for _3283) _ret_11) (\_var_12-> (\_ret_13-> (u (u fm_term_app _ret_13) (let _3284 = _var_12 in (case _3284 of {(0,f) -> u f (\_3285 _3286 _3287-> _3287); })))))) in (let _ctr_13=(u string_flatten (u (u list_cons _3276) (u (u list_cons (u fm_name_read ".")) (u (u list_cons _3281) list_nil)))) in (let _slf_14=(u fm_term_ref _ctr_13) in (let _slf_15=(u (u (u list_for _3277) _slf_14) (\_var_15-> (\_slf_16-> (u (u fm_term_app _slf_16) (u fm_term_ref (let _3288 = _var_15 in (case _3288 of {(0,f) -> u f (\_3289 _3290 _3291-> _3290); }))))))) in (let _slf_16=(u (u (u list_for _3282) _slf_15) (\_var_16-> (\_slf_17-> (u (u fm_term_app _slf_17) (u fm_term_ref (let _3292 = _var_16 in (case _3292 of {(0,f) -> u f (\_3293 _3294 _3295-> _3294); }))))))) in (u (u fm_term_app _ret_12) _slf_16)))))))); }))); }))); (1,f) -> u f (\_3296 _3297-> (let _3298 = _3296 in (case _3298 of {(0,f) -> u f (\_3299 _3300 _3301-> (let _eras_9=_3299 in (let _name_10=_3300 in (let _xtyp_11=_3301 in (let _body_12=(u (u (u fm_datatype_build_term_constructor_go _type_1) _ctor_2) _3297) in (u (u (u (u (u fm_term_all _eras_9) "") _name_10) _xtyp_11) (\_s_13-> (\_x_14-> _body_12)))))))); }))); })))))
fm_datatype_build_term_constructor = (\_type_1-> (\_ctor_2-> (let _3302 = _ctor_2 in (case _3302 of {(0,f) -> u f (\_3303 _3304 _3305-> (u (u (u fm_datatype_build_term_constructor_go _type_1) _ctor_2) _3304)); }))))
fm_datatype_build_term_constructors_go = (\_type_1-> (\_name_2-> (\_ctrs_3-> (let _3306 = _ctrs_3 in (case _3306 of {(0,f) -> u f ((let _3307 = _type_1 in (case _3307 of {(0,f) -> u f (\_3308 _3309 _3310 _3311-> (let _ret_8=(u fm_term_ref (u fm_name_read "P")) in (let _ret_9=(u (u (u list_for _3310) _ret_8) (\_var_9-> (\_ret_10-> (u (u fm_term_app _ret_10) (u fm_term_ref (let _3312 = _var_9 in (case _3312 of {(0,f) -> u f (\_3313 _3314 _3315-> _3314); }))))))) in (u (u fm_term_app _ret_9) (u fm_term_ref (((_name_2::String) ++ ".Self"))))))); }))); (1,f) -> u f (\_3316 _3317-> (let _3318 = _3316 in (case _3318 of {(0,f) -> u f (\_3319 _3320 _3321-> (u (u (u (u (u fm_term_all bool_false) "") _3319) (u (u fm_datatype_build_term_constructor _type_1) _3316)) (\_s_9-> (\_x_10-> (u (u (u fm_datatype_build_term_constructors_go _type_1) _name_2) _3317))))); }))); })))))
fm_datatype_build_term_constructors = (\_type_1-> (let _3322 = _type_1 in (case _3322 of {(0,f) -> u f (\_3323 _3324 _3325 _3326-> (u (u (u fm_datatype_build_term_constructors_go _type_1) _3323) _3326)); })))
fm_datatype_build_term_go = (\_type_1-> (\_name_2-> (\_pars_3-> (\_inds_4-> (let _3327 = _pars_3 in (case _3327 of {(0,f) -> u f ((let _3328 = _inds_4 in (case _3328 of {(0,f) -> u f ((u (u (u (u (u fm_term_all bool_true) (((_name_2::String) ++ ".Self"))) (u fm_name_read "P")) (u fm_datatype_build_term_motive _type_1)) (\_s_5-> (\_x_6-> (u fm_datatype_build_term_constructors _type_1))))); (1,f) -> u f (\_3329 _3330-> (let _3331 = _3329 in (case _3331 of {(0,f) -> u f (\_3332 _3333 _3334-> (u (u fm_term_lam _3333) (\_x_10-> (u (u (u (u fm_datatype_build_term_go _type_1) _name_2) _pars_3) _3330)))); }))); }))); (1,f) -> u f (\_3335 _3336-> (let _3337 = _3335 in (case _3337 of {(0,f) -> u f (\_3338 _3339 _3340-> (u (u fm_term_lam _3339) (\_x_10-> (u (u (u (u fm_datatype_build_term_go _type_1) _name_2) _3336) _inds_4)))); }))); }))))))
fm_datatype_build_term = (\_type_1-> (let _3341 = _type_1 in (case _3341 of {(0,f) -> u f (\_3342 _3343 _3344 _3345-> (u (u (u (u fm_datatype_build_term_go _type_1) _3342) _3343) _3344)); })))
fm_datatype_build_type_go = (\_type_1-> (\_name_2-> (\_pars_3-> (\_inds_4-> (let _3346 = _pars_3 in (case _3346 of {(0,f) -> u f ((let _3347 = _inds_4 in (case _3347 of {(0,f) -> u f (fm_term_typ); (1,f) -> u f (\_3348 _3349-> (let _3350 = _3348 in (case _3350 of {(0,f) -> u f (\_3351 _3352 _3353-> (u (u (u (u (u fm_term_all bool_false) "") _3352) _3353) (\_s_10-> (\_x_11-> (u (u (u (u fm_datatype_build_type_go _type_1) _name_2) _pars_3) _3349))))); }))); }))); (1,f) -> u f (\_3354 _3355-> (let _3356 = _3354 in (case _3356 of {(0,f) -> u f (\_3357 _3358 _3359-> (u (u (u (u (u fm_term_all bool_false) "") _3358) _3359) (\_s_10-> (\_x_11-> (u (u (u (u fm_datatype_build_type_go _type_1) _name_2) _3355) _inds_4))))); }))); }))))))
fm_datatype_build_type = (\_type_1-> (let _3360 = _type_1 in (case _3360 of {(0,f) -> u f (\_3361 _3362 _3363 _3364-> (u (u (u (u fm_datatype_build_type_go _type_1) _3361) _3362) _3363)); })))
fm_constructor_build_term_opt_go = (\_type_1-> (\_ctor_2-> (\_ctrs_3-> (let _3365 = _ctrs_3 in (case _3365 of {(0,f) -> u f ((let _3366 = _ctor_2 in (case _3366 of {(0,f) -> u f (\_3367 _3368 _3369-> (let _ret_7=(u fm_term_ref _3367) in (let _ret_8=(u (u (u list_for _3368) _ret_7) (\_arg_8-> (\_ret_9-> (u (u fm_term_app _ret_9) (u fm_term_ref (let _3370 = _arg_8 in (case _3370 of {(0,f) -> u f (\_3371 _3372 _3373-> _3372); }))))))) in _ret_8))); }))); (1,f) -> u f (\_3374 _3375-> (let _3376 = _3374 in (case _3376 of {(0,f) -> u f (\_3377 _3378 _3379-> (u (u fm_term_lam _3377) (\_x_9-> (u (u (u fm_constructor_build_term_opt_go _type_1) _ctor_2) _3375)))); }))); })))))
fm_constructor_build_term_opt = (\_type_1-> (\_ctor_2-> (let _3380 = _type_1 in (case _3380 of {(0,f) -> u f (\_3381 _3382 _3383 _3384-> (u (u (u fm_constructor_build_term_opt_go _type_1) _ctor_2) _3384)); }))))
fm_constructor_build_term_go = (\_type_1-> (\_ctor_2-> (\_name_3-> (\_pars_4-> (\_args_5-> (let _3385 = _pars_4 in (case _3385 of {(0,f) -> u f ((let _3386 = _args_5 in (case _3386 of {(0,f) -> u f ((u (u fm_term_lam (u fm_name_read "P")) (\_x_6-> (u (u fm_constructor_build_term_opt _type_1) _ctor_2)))); (1,f) -> u f (\_3387 _3388-> (let _3389 = _3387 in (case _3389 of {(0,f) -> u f (\_3390 _3391 _3392-> (u (u fm_term_lam _3391) (\_x_11-> (u (u (u (u (u fm_constructor_build_term_go _type_1) _ctor_2) _name_3) _pars_4) _3388)))); }))); }))); (1,f) -> u f (\_3393 _3394-> (let _3395 = _3393 in (case _3395 of {(0,f) -> u f (\_3396 _3397 _3398-> (u (u fm_term_lam _3397) (\_x_11-> (u (u (u (u (u fm_constructor_build_term_go _type_1) _ctor_2) _name_3) _3394) _args_5)))); }))); })))))))
fm_constructor_build_term = (\_type_1-> (\_ctor_2-> (let _3399 = _type_1 in (case _3399 of {(0,f) -> u f (\_3400 _3401 _3402 _3403-> (let _3404 = _ctor_2 in (case _3404 of {(0,f) -> u f (\_3405 _3406 _3407-> (u (u (u (u (u fm_constructor_build_term_go _type_1) _ctor_2) _3400) _3401) _3406)); }))); }))))
fm_constructor_build_type_go = (\_type_1-> (\_ctor_2-> (\_name_3-> (\_pars_4-> (\_args_5-> (let _3408 = _pars_4 in (case _3408 of {(0,f) -> u f ((let _3409 = _args_5 in (case _3409 of {(0,f) -> u f ((let _3410 = _type_1 in (case _3410 of {(0,f) -> u f (\_3411 _3412 _3413 _3414-> (let _3415 = _ctor_2 in (case _3415 of {(0,f) -> u f (\_3416 _3417 _3418-> (let _type_13=(u fm_term_ref _name_3) in (let _type_14=(u (u (u list_for _3412) _type_13) (\_var_14-> (\_type_15-> (u (u fm_term_app _type_15) (u fm_term_ref (let _3419 = _var_14 in (case _3419 of {(0,f) -> u f (\_3420 _3421 _3422-> _3421); }))))))) in (let _type_15=(u (u (u list_for _3418) _type_14) (\_var_15-> (\_type_16-> (u (u fm_term_app _type_16) (let _3423 = _var_15 in (case _3423 of {(0,f) -> u f (\_3424 _3425 _3426-> _3426); })))))) in _type_15)))); }))); }))); (1,f) -> u f (\_3427 _3428-> (let _3429 = _3427 in (case _3429 of {(0,f) -> u f (\_3430 _3431 _3432-> (u (u (u (u (u fm_term_all _3430) "") _3431) _3432) (\_s_11-> (\_x_12-> (u (u (u (u (u fm_constructor_build_type_go _type_1) _ctor_2) _name_3) _pars_4) _3428))))); }))); }))); (1,f) -> u f (\_3433 _3434-> (let _3435 = _3433 in (case _3435 of {(0,f) -> u f (\_3436 _3437 _3438-> (u (u (u (u (u fm_term_all _3436) "") _3437) _3438) (\_s_11-> (\_x_12-> (u (u (u (u (u fm_constructor_build_type_go _type_1) _ctor_2) _name_3) _3434) _args_5))))); }))); })))))))
fm_constructor_build_type = (\_type_1-> (\_ctor_2-> (let _3439 = _type_1 in (case _3439 of {(0,f) -> u f (\_3440 _3441 _3442 _3443-> (let _3444 = _ctor_2 in (case _3444 of {(0,f) -> u f (\_3445 _3446 _3447-> (u (u (u (u (u fm_constructor_build_type_go _type_1) _ctor_2) _3440) _3441) _3446)); }))); }))))
fm_parser_file_adt = (\_file_1-> (\_code_2-> (\_defs_3-> (\_idx_4-> (\_code_5-> (let _3448 = (u (u fm_parser_datatype _idx_4) _code_5) in (case _3448 of {(0,f) -> u f (\_3449 _3450 _3451-> (u (u (u parser_reply_error _3449) _3450) _3451)); (1,f) -> u f (\_3452 _3453 _3454-> (let _3455 = _3454 in (case _3455 of {(0,f) -> u f (\_3456 _3457 _3458 _3459-> (let _term_13=(u fm_datatype_build_term _3454) in (let _term_14=(u (u (u fm_term_bind list_nil) (\_x_14-> (u bits_i _x_14))) _term_13) in (let _type_15=(u fm_datatype_build_type _3454) in (let _type_16=(u (u (u fm_term_bind list_nil) (\_x_16-> (u bits_o _x_16))) _type_15) in (let _defs_17=(u (u (u (u (u (u (u fm_define _file_1) _code_2) _3456) _term_14) _type_16) bool_false) _defs_3) in (let _defs_18=(u (u (u list_fold _3459) _defs_17) (\_ctr_18-> (\_defs_19-> (let _typ_name_20=_3456 in (let _ctr_name_21=(u string_flatten (u (u list_cons _typ_name_20) (u (u list_cons (u fm_name_read ".")) (u (u list_cons (let _3460 = _ctr_18 in (case _3460 of {(0,f) -> u f (\_3461 _3462 _3463-> _3461); }))) list_nil)))) in (let _ctr_term_22=(u (u fm_constructor_build_term _3454) _ctr_18) in (let _ctr_term_23=(u (u (u fm_term_bind list_nil) (\_x_23-> (u bits_i _x_23))) _ctr_term_22) in (let _ctr_type_24=(u (u fm_constructor_build_type _3454) _ctr_18) in (let _ctr_type_25=(u (u (u fm_term_bind list_nil) (\_x_25-> (u bits_o _x_25))) _ctr_type_24) in (u (u (u (u (u (u (u fm_define _file_1) _code_2) _ctr_name_21) _ctr_term_23) _ctr_type_25) bool_false) _defs_19)))))))))) in (\_idx_19-> (\_code_20-> (u (u (u parser_reply_value _idx_19) _code_20) _defs_18)))))))))); })) _3452 _3453); })))))))
parser_eof = (\_idx_1-> (\_code_2-> (let _3464 = _code_2 in (if null (_3464::String) then (u (u (u parser_reply_value _idx_1) _code_2) unit_new) else (u (u (u parser_reply_error _idx_1) _code_2) "Expected end-of-file.")))))
fm_parser_file_end = (\_file_1-> (\_code_2-> (\_defs_3-> (\_idx_4-> (\_code_5-> (let _3465 = (u (u fm_parser_spaces _idx_4) _code_5) in (case _3465 of {(0,f) -> u f (\_3466 _3467 _3468-> (u (u (u parser_reply_error _3466) _3467) _3468)); (1,f) -> u f (\_3469 _3470 _3471-> (let _3472 = (u (u parser_eof _3469) _3470) in (case _3472 of {(0,f) -> u f (\_3473 _3474 _3475-> (u (u (u parser_reply_error _3473) _3474) _3475)); (1,f) -> u f (\_3476 _3477 _3478-> (u (u (u parser_reply_value _3476) _3477) _defs_3)); }))); })))))))
fm_parser_file = (\_file_1-> (\_code_2-> (\_defs_3-> (\_idx_4-> (\_code_5-> (let _3479 = (u (u parser_is_eof _idx_4) _code_5) in (case _3479 of {(0,f) -> u f (\_3480 _3481 _3482-> (u (u (u parser_reply_error _3480) _3481) _3482)); (1,f) -> u f (\_3483 _3484 _3485-> (let _3486 = _3485 in (if _3486 then (\_idx_9-> (\_code_10-> (u (u (u parser_reply_value _idx_9) _code_10) _defs_3))) else (u parser_first_of (u (u list_cons (\_idx_9-> (\_code_10-> (let _3487 = (u (u (u fm_parser_text "#") _idx_9) _code_10) in (case _3487 of {(0,f) -> u f (\_3488 _3489 _3490-> (u (u (u parser_reply_error _3488) _3489) _3490)); (1,f) -> u f (\_3491 _3492 _3493-> (let _3494 = (u (u fm_parser_name1 _3491) _3492) in (case _3494 of {(0,f) -> u f (\_3495 _3496 _3497-> (u (u (u parser_reply_error _3495) _3496) _3497)); (1,f) -> u f (\_3498 _3499 _3500-> (u (u (u (u (u fm_parser_file _3500) _code_2) _defs_3) _3498) _3499)); }))); }))))) (u (u list_cons (\_idx_9-> (\_code_10-> (let _3501 = (u (u (u parser_first_of (u (u list_cons (u (u (u fm_parser_file_def _file_1) _code_2) _defs_3)) (u (u list_cons (u (u (u fm_parser_file_adt _file_1) _code_2) _defs_3)) (u (u list_cons (u (u (u fm_parser_file_end _file_1) _code_2) _defs_3)) list_nil)))) _idx_9) _code_10) in (case _3501 of {(0,f) -> u f (\_3502 _3503 _3504-> (u (u (u parser_reply_error _3502) _3503) _3504)); (1,f) -> u f (\_3505 _3506 _3507-> (u (u (u (u (u fm_parser_file _file_1) _code_2) _3507) _3505) _3506)); }))))) list_nil))))) _3483 _3484); })))))))
either = (\_a_1-> (\_b_2-> ()))
string_join_go = (\_sep_1-> (\_list_2-> (\_fst_3-> (let _3508 = _list_2 in (case _3508 of {(0,f) -> u f (""); (1,f) -> u f (\_3509 _3510-> (u string_flatten (u (u list_cons (let _3511 = _fst_3 in (if _3511 then "" else _sep_1))) (u (u list_cons _3509) (u (u list_cons (u (u (u string_join_go _sep_1) _3510) bool_false)) list_nil))))); })))))
string_join = (\_sep_1-> (\_list_2-> (u (u (u string_join_go _sep_1) _list_2) bool_true)))
fm_highlight_end = (\_col_1-> (\_row_2-> (\_res_3-> (u (u string_join "\n") _res_3))))
maybe_extract = (\_m_2-> (\_a_4-> (\_f_5-> (let _3512 = _m_2 in (case _3512 of {(0,f) -> u f (_a_4); (1,f) -> u f (\_3513-> (u _f_5 _3513)); })))))
nat_is_zero = (\_n_1-> (let _3514 = _n_1 in (if _3514==0 then bool_true else bool_false)))
nat_double = (\_n_1-> (let _3515 = _n_1 in (if _3515==0 then nat_zero else (u nat_succ (u nat_succ (u nat_double (_3515-1)))))))
nat_pred = (\_n_1-> (let _3516 = _n_1 in (if _3516==0 then nat_zero else (_3516-1))))
string_reverse_go = (\_xs_1-> (\_res_2-> (let _3517 = _xs_1 in (if null (_3517::String) then _res_2 else (u (u string_reverse_go (tail _3517)) (u (u string_cons (fromIntegral (fromEnum (head _3517 :: Char)) :: Word16)) _res_2))))))
string_reverse = (\_xs_1-> (u (u string_reverse_go _xs_1) string_nil))
string_pad_right = (\_size_1-> (\_chr_2-> (\_str_3-> (let _3518 = _size_1 in (if _3518==0 then _str_3 else (let _3519 = _str_3 in (if null (_3519::String) then (u (u string_cons _chr_2) (u (u (u string_pad_right (_3518-1)) _chr_2) "")) else (u (u string_cons (fromIntegral (fromEnum (head _3519 :: Char)) :: Word16)) (u (u (u string_pad_right (_3518-1)) _chr_2) (tail _3519))))))))))
string_pad_left = (\_size_1-> (\_chr_2-> (\_str_3-> (u string_reverse (u (u (u string_pad_right _size_1) _chr_2) (u string_reverse _str_3))))))
either_left = (\_value_3-> (0,\t-> t _value_3))
either_right = (\_value_3-> (1,\t-> t _value_3))
nat_sub_rem = (\_n_1-> (\_m_2-> (let _3520 = _m_2 in (if _3520==0 then (u either_left _n_1) else (let _3521 = _n_1 in (if _3521==0 then (u either_right (u nat_succ (_3520-1))) else (u (u nat_sub_rem (_3521-1)) (_3520-1))))))))
nat_div_mod_go = (\_n_1-> (\_m_2-> (\_d_3-> (let _3522 = (u (u nat_sub_rem _n_1) _m_2) in (case _3522 of {(0,f) -> u f (\_3523-> (u (u (u nat_div_mod_go _3523) _m_2) (u nat_succ _d_3))); (1,f) -> u f (\_3524-> (u (u pair_new _d_3) _n_1)); })))))
nat_div_mod = (\_n_1-> (\_m_2-> (u (u (u nat_div_mod_go _n_1) _m_2) nat_zero)))
nat_to_base_go = (\_base_1-> (\_nat_2-> (\_res_3-> (let _3525 = (u (u nat_div_mod _nat_2) _base_1) in (case _3525 of {(0,f) -> u f (\_3526 _3527-> (let _3528 = _3526 in (if _3528==0 then (u (u list_cons _3527) _res_3) else (u (u (u nat_to_base_go _base_1) _3526) (u (u list_cons _3527) _res_3))))); })))))
nat_to_base = (\_base_1-> (\_nat_2-> (u (u (u nat_to_base_go _base_1) _nat_2) list_nil)))
nat_mod_go = (\_n_1-> (\_m_2-> (\_r_3-> (let _3529 = _m_2 in (if _3529==0 then (u (u (u nat_mod_go _n_1) _r_3) _m_2) else (let _3530 = _n_1 in (if _3530==0 then _r_3 else (u (u (u nat_mod_go (_3530-1)) (_3529-1)) (u nat_succ _r_3)))))))))
nat_mod = (\_n_1-> (\_m_2-> (u (u (u nat_mod_go _n_1) _m_2) 0)))
nat_lte = (\a0-> \a1-> ((a0::Integer) <= a1))
nat_show_digit = (\_base_1-> (\_n_2-> (let _m_3=(u (u nat_mod _n_2) _base_1) in (let _base64_4=(u (u list_cons 48) (u (u list_cons 49) (u (u list_cons 50) (u (u list_cons 51) (u (u list_cons 52) (u (u list_cons 53) (u (u list_cons 54) (u (u list_cons 55) (u (u list_cons 56) (u (u list_cons 57) (u (u list_cons 65) (u (u list_cons 66) (u (u list_cons 67) (u (u list_cons 68) (u (u list_cons 69) (u (u list_cons 70) (u (u list_cons 71) (u (u list_cons 72) (u (u list_cons 73) (u (u list_cons 74) (u (u list_cons 75) (u (u list_cons 76) (u (u list_cons 77) (u (u list_cons 78) (u (u list_cons 79) (u (u list_cons 80) (u (u list_cons 81) (u (u list_cons 82) (u (u list_cons 83) (u (u list_cons 84) (u (u list_cons 85) (u (u list_cons 86) (u (u list_cons 87) (u (u list_cons 88) (u (u list_cons 89) (u (u list_cons 90) (u (u list_cons 97) (u (u list_cons 98) (u (u list_cons 99) (u (u list_cons 100) (u (u list_cons 101) (u (u list_cons 102) (u (u list_cons 103) (u (u list_cons 104) (u (u list_cons 105) (u (u list_cons 106) (u (u list_cons 107) (u (u list_cons 108) (u (u list_cons 109) (u (u list_cons 110) (u (u list_cons 111) (u (u list_cons 112) (u (u list_cons 113) (u (u list_cons 114) (u (u list_cons 115) (u (u list_cons 116) (u (u list_cons 117) (u (u list_cons 118) (u (u list_cons 119) (u (u list_cons 120) (u (u list_cons 121) (u (u list_cons 122) (u (u list_cons 43) (u (u list_cons 47) list_nil)))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))) in (let _3531 = (((((_base_1::Integer) > 0)) && (((_base_1::Integer) <= 64)))) in (if _3531 then (let _3532 = (u (u list_at _m_3) _base64_4) in (case _3532 of {(0,f) -> u f (35); (1,f) -> u f (\_3533-> _3533); })) else 35))))))
nat_to_string_base = (\_base_1-> (\_nat_2-> (u (u (u list_fold (u (u nat_to_base _base_1) _nat_2)) string_nil) (\_n_3-> (\_str_4-> (u (u string_cons (u (u nat_show_digit _base_1) _n_3)) _str_4))))))
nat_show = (\_n_1-> (u (u nat_to_string_base 10) _n_1))
bool_not = (\a0-> (not a0))
fm_color = (\_col_1-> (\_str_2-> (u (u string_cons 27) (u (u string_cons 91) (((_col_1::String) ++ (u (u string_cons 109) (((_str_2::String) ++ (u (u string_cons 27) (u (u string_cons 91) (u (u string_cons 48) (u (u string_cons 109) string_nil)))))))))))))
nat_eql = (\a0-> \a1-> ((a0::Integer) == a1))
list_take = (\_n_2-> (\_xs_3-> (let _3534 = _xs_3 in (case _3534 of {(0,f) -> u f (list_nil); (1,f) -> u f (\_3535 _3536-> (let _3537 = _n_2 in (if _3537==0 then list_nil else (u (u list_cons _3535) (u (u list_take (_3537-1)) _3536))))); }))))
fm_highlight_tc = (\_code_1-> (\_ix0_2-> (\_ix1_3-> (\_col_4-> (\_row_5-> (\_lft_6-> (\_lin_7-> (\_res_8-> (let _spa_9=3 in (let _3538 = _code_1 in (if null (_3538::String) then (u (u (u fm_highlight_end _col_4) _row_5) (u list_reverse _res_8)) else (let _3539 = ((((fromIntegral (fromEnum (head _3538 :: Char)) :: Word16)::Word16) == 10)) in (if _3539 then (let _stp_12=(u (u (u maybe_extract _lft_6) bool_false) nat_is_zero) in (let _3540 = _stp_12 in (if _3540 then (u (u (u fm_highlight_end _col_4) _row_5) (u list_reverse _res_8)) else (let _siz_13=(u nat_succ (u nat_double _spa_9)) in (let _lft_14=(let _3541 = _ix1_3 in (if _3541==0 then (let _3542 = _lft_6 in (case _3542 of {(0,f) -> u f ((u maybe_some _spa_9)); (1,f) -> u f (\_3543-> (u maybe_some (u nat_pred _3543))); })) else _lft_6)) in (let _ix0_15=(u nat_pred _ix0_2) in (let _ix1_16=(u nat_pred _ix1_3) in (let _col_17=0 in (let _row_18=(u nat_succ _row_5) in (let _res_19=(u (u list_cons (u string_reverse _lin_7)) _res_8) in (let _lin_20=(u string_reverse (u string_flatten (u (u list_cons (u (u (u string_pad_left 4) 32) (u nat_show _row_18))) (u (u list_cons " | ") list_nil)))) in (u (u (u (u (u (u (u (u fm_highlight_tc (tail _3538)) _ix0_15) _ix1_16) _col_17) _row_18) _lft_14) _lin_20) _res_19)))))))))))) else (let _chr_12=(u (u string_cons (fromIntegral (fromEnum (head _3538 :: Char)) :: Word16)) string_nil) in (let _chr_13=(let _3544 = (((u nat_is_zero _ix0_2) && ((not (u nat_is_zero _ix1_3))))) in (if _3544 then (u string_reverse (u (u fm_color "31") (u (u fm_color "4") _chr_12))) else _chr_12)) in (let _res_14=(let _3545 = (((_ix0_2::Integer) == 1)) in (if _3545 then (u (u list_take _spa_9) _res_8) else _res_8)) in (let _ix0_15=(u nat_pred _ix0_2) in (let _ix1_16=(u nat_pred _ix1_3) in (let _col_17=(u nat_succ _col_4) in (let _lin_18=(u string_flatten (u (u list_cons _chr_13) (u (u list_cons _lin_7) list_nil))) in (u (u (u (u (u (u (u (u fm_highlight_tc (tail _3538)) _ix0_15) _ix1_16) _col_17) _row_5) _lft_6) _lin_18) _res_14)))))))))))))))))))))
fm_highlight = (\_code_1-> (\_idx0_2-> (\_idx1_3-> (u (u (u (u (u (u (u (u fm_highlight_tc _code_1) _idx0_2) _idx1_3) 0) 1) maybe_none) (u string_reverse "   1 | ")) list_nil))))
fm_defs_read = (\_file_1-> (\_code_2-> (\_defs_3-> (let _3546 = (u (u (u (u (u fm_parser_file _file_1) _code_2) _defs_3) 0) _code_2) in (case _3546 of {(0,f) -> u f (\_3547 _3548 _3549-> (let _err_7=_3549 in (let _hig_8=(u (u (u fm_highlight _code_2) _3547) (u nat_succ _3547)) in (let _str_9=(u string_flatten (u (u list_cons _err_7) (u (u list_cons "\n") (u (u list_cons _hig_8) list_nil)))) in (u either_left _str_9))))); (1,f) -> u f (\_3550 _3551 _3552-> (u either_right _3552)); })))))
fm_synth_load = (\_name_1-> (\_defs_2-> (let _file_3=(u fm_synth_file_of _name_1) in (u (u (u io_monad (\_m_bind_4-> (\_m_pure_5-> _m_bind_4))) (u io_get_file _file_3)) (\_code_4-> (let _read_5=(u (u (u fm_defs_read _file_3) _code_4) _defs_2) in (let _3553 = _read_5 in (case _3553 of {(0,f) -> u f (\_3554-> (u (u io_monad (\_m_bind_7-> (\_m_pure_8-> _m_pure_8))) maybe_none)); (1,f) -> u f (\_3555-> (let _defs_7=_3555 in (let _3556 = (u (u fm_get _name_1) _defs_7) in (case _3556 of {(0,f) -> u f ((u (u io_monad (\_m_bind_8-> (\_m_pure_9-> _m_pure_9))) maybe_none)); (1,f) -> u f (\_3557-> (u (u io_monad (\_m_bind_9-> (\_m_pure_10-> _m_pure_10))) (u maybe_some _defs_7))); })))); }))))))))
fm_status_wait = (1,\t-> t)
fm_check = (\_v_1-> ())
fm_check_result = (\_value_2-> (\_errors_3-> (0,\t-> t _value_2 _errors_3)))
fm_error_undefined_reference = (\_origin_1-> (\_name_2-> (5,\t-> t _origin_1 _name_2)))
fm_error_waiting = (\_name_1-> (2,\t-> t _name_1))
fm_error_indirect = (\_name_1-> (3,\t-> t _name_1))
maybe_mapped = (\_m_2-> (\_f_4-> (let _3558 = _m_2 in (case _3558 of {(0,f) -> u f (maybe_none); (1,f) -> u f (\_3559-> (u maybe_some (u _f_4 _3559))); }))))
fm_mpath_o = (\_path_1-> (u (u maybe_mapped _path_1) fm_path_o))
fm_mpath_i = (\_path_1-> (u (u maybe_mapped _path_1) fm_path_i))
fm_error_patch = (\_path_1-> (\_term_2-> (4,\t-> t _path_1 _term_2)))
fm_mpath_to_bits = (\_path_1-> (let _3560 = _path_1 in (case _3560 of {(0,f) -> u f (bits_e); (1,f) -> u f (\_3561-> (u _3561 bits_e)); })))
fm_error_type_mismatch = (\_origin_1-> (\_expected_2-> (\_detected_3-> (\_context_4-> (0,\t-> t _origin_1 _expected_2 _detected_3 _context_4)))))
fm_error_show_goal = (\_name_1-> (\_dref_2-> (\_verb_3-> (\_goal_4-> (\_context_5-> (1,\t-> t _name_1 _dref_2 _verb_3 _goal_4 _context_5))))))
fm_term_normalize = (\_term_1-> (\_defs_2-> (let _3562 = (u (u fm_term_reduce _term_1) _defs_2) in (case _3562 of {(0,f) -> u f (\_3563 _3564-> (u (u fm_term_var _3563) _3564)); (1,f) -> u f (\_3565-> (u fm_term_ref _3565)); (2,f) -> u f (fm_term_typ); (3,f) -> u f (\_3566 _3567 _3568 _3569 _3570-> (u (u (u (u (u fm_term_all _3566) _3567) _3568) (u (u fm_term_normalize _3569) _defs_2)) (\_s_8-> (\_x_9-> (u (u fm_term_normalize (u (u _3570 _s_8) _x_9)) _defs_2))))); (4,f) -> u f (\_3571 _3572-> (u (u fm_term_lam _3571) (\_x_5-> (u (u fm_term_normalize (u _3572 _x_5)) _defs_2)))); (5,f) -> u f (\_3573 _3574-> (u (u fm_term_app (u (u fm_term_normalize _3573) _defs_2)) (u (u fm_term_normalize _3574) _defs_2))); (6,f) -> u f (\_3575 _3576 _3577-> (u (u (u fm_term_let _3575) (u (u fm_term_normalize _3576) _defs_2)) (\_x_6-> (u (u fm_term_normalize (u _3577 _x_6)) _defs_2)))); (7,f) -> u f (\_3578 _3579 _3580-> (u (u (u fm_term_def _3578) (u (u fm_term_normalize _3579) _defs_2)) (\_x_6-> (u (u fm_term_normalize (u _3580 _x_6)) _defs_2)))); (8,f) -> u f (\_3581 _3582 _3583-> (u (u (u fm_term_ann _3581) (u (u fm_term_normalize _3582) _defs_2)) (u (u fm_term_normalize _3583) _defs_2))); (9,f) -> u f (\_3584 _3585 _3586-> (u (u (u fm_term_gol _3584) _3585) _3586)); (10,f) -> u f (\_3587-> (u fm_term_hol _3587)); (11,f) -> u f (\_3588-> (u fm_term_nat _3588)); (12,f) -> u f (\_3589-> (u fm_term_chr _3589)); (13,f) -> u f (\_3590-> (u fm_term_str _3590)); (14,f) -> u f (\_3591 _3592 _3593 _3594 _3595 _3596-> _term_1); (15,f) -> u f (\_3597 _3598-> (u (u fm_term_normalize _3598) _defs_2)); }))))
list_tail = (\_xs_2-> (let _3599 = _xs_2 in (case _3599 of {(0,f) -> u f (list_nil); (1,f) -> u f (\_3600 _3601-> _3601); })))
fm_smartmotive_vals_cont = (\_expr_1-> (\_term_2-> (\_args_3-> (\_defs_4-> (let _3602 = (u (u fm_term_reduce _term_2) _defs_4) in (case _3602 of {(0,f) -> u f (\_3603 _3604-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (1,f) -> u f (\_3605-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (2,f) -> u f ((u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (3,f) -> u f (\_3606 _3607 _3608 _3609 _3610-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (4,f) -> u f (\_3611 _3612-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (5,f) -> u f (\_3613 _3614-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _3613) (u (u list_cons _3614) _args_3)) _defs_4)); (6,f) -> u f (\_3615 _3616 _3617-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (7,f) -> u f (\_3618 _3619 _3620-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (8,f) -> u f (\_3621 _3622 _3623-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (9,f) -> u f (\_3624 _3625 _3626-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (10,f) -> u f (\_3627-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (11,f) -> u f (\_3628-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (12,f) -> u f (\_3629-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (13,f) -> u f (\_3630-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (14,f) -> u f (\_3631 _3632 _3633 _3634 _3635 _3636-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (15,f) -> u f (\_3637 _3638-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); }))))))
fm_smartmotive_vals = (\_expr_1-> (\_type_2-> (\_defs_3-> (let _3639 = (u (u fm_term_reduce _type_2) _defs_3) in (case _3639 of {(0,f) -> u f (\_3640 _3641-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (1,f) -> u f (\_3642-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (2,f) -> u f ((u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (3,f) -> u f (\_3643 _3644 _3645 _3646 _3647-> (u (u (u fm_smartmotive_vals _expr_1) (u (u _3647 fm_term_typ) fm_term_typ)) _defs_3)); (4,f) -> u f (\_3648 _3649-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (5,f) -> u f (\_3650 _3651-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (6,f) -> u f (\_3652 _3653 _3654-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (7,f) -> u f (\_3655 _3656 _3657-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (8,f) -> u f (\_3658 _3659 _3660-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (9,f) -> u f (\_3661 _3662 _3663-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (10,f) -> u f (\_3664-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (11,f) -> u f (\_3665-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (12,f) -> u f (\_3666-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (13,f) -> u f (\_3667-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (14,f) -> u f (\_3668 _3669 _3670 _3671 _3672 _3673-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (15,f) -> u f (\_3674 _3675-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); })))))
fm_smartmotive_nams_cont = (\_name_1-> (\_term_2-> (\_binds_3-> (\_defs_4-> (let _3676 = (u (u fm_term_reduce _term_2) _defs_4) in (case _3676 of {(0,f) -> u f (\_3677 _3678-> (u (u list_cons _name_1) (u list_tail _binds_3))); (1,f) -> u f (\_3679-> (u (u list_cons _name_1) (u list_tail _binds_3))); (2,f) -> u f ((u (u list_cons _name_1) (u list_tail _binds_3))); (3,f) -> u f (\_3680 _3681 _3682 _3683 _3684-> (u (u (u (u fm_smartmotive_nams_cont _name_1) (u (u _3684 (u fm_term_ref _3681)) (u fm_term_ref _3682))) (u (u list_cons (u string_flatten (u (u list_cons _name_1) (u (u list_cons ".") (u (u list_cons _3682) list_nil))))) _binds_3)) _defs_4)); (4,f) -> u f (\_3685 _3686-> (u (u list_cons _name_1) (u list_tail _binds_3))); (5,f) -> u f (\_3687 _3688-> (u (u list_cons _name_1) (u list_tail _binds_3))); (6,f) -> u f (\_3689 _3690 _3691-> (u (u list_cons _name_1) (u list_tail _binds_3))); (7,f) -> u f (\_3692 _3693 _3694-> (u (u list_cons _name_1) (u list_tail _binds_3))); (8,f) -> u f (\_3695 _3696 _3697-> (u (u list_cons _name_1) (u list_tail _binds_3))); (9,f) -> u f (\_3698 _3699 _3700-> (u (u list_cons _name_1) (u list_tail _binds_3))); (10,f) -> u f (\_3701-> (u (u list_cons _name_1) (u list_tail _binds_3))); (11,f) -> u f (\_3702-> (u (u list_cons _name_1) (u list_tail _binds_3))); (12,f) -> u f (\_3703-> (u (u list_cons _name_1) (u list_tail _binds_3))); (13,f) -> u f (\_3704-> (u (u list_cons _name_1) (u list_tail _binds_3))); (14,f) -> u f (\_3705 _3706 _3707 _3708 _3709 _3710-> (u (u list_cons _name_1) (u list_tail _binds_3))); (15,f) -> u f (\_3711 _3712-> (u (u list_cons _name_1) (u list_tail _binds_3))); }))))))
fm_smartmotive_nams = (\_name_1-> (\_type_2-> (\_defs_3-> (let _3713 = (u (u fm_term_reduce _type_2) _defs_3) in (case _3713 of {(0,f) -> u f (\_3714 _3715-> list_nil); (1,f) -> u f (\_3716-> list_nil); (2,f) -> u f (list_nil); (3,f) -> u f (\_3717 _3718 _3719 _3720 _3721-> (u (u (u (u fm_smartmotive_nams_cont _name_1) _3720) list_nil) _defs_3)); (4,f) -> u f (\_3722 _3723-> list_nil); (5,f) -> u f (\_3724 _3725-> list_nil); (6,f) -> u f (\_3726 _3727 _3728-> list_nil); (7,f) -> u f (\_3729 _3730 _3731-> list_nil); (8,f) -> u f (\_3732 _3733 _3734-> list_nil); (9,f) -> u f (\_3735 _3736 _3737-> list_nil); (10,f) -> u f (\_3738-> list_nil); (11,f) -> u f (\_3739-> list_nil); (12,f) -> u f (\_3740-> list_nil); (13,f) -> u f (\_3741-> list_nil); (14,f) -> u f (\_3742 _3743 _3744 _3745 _3746 _3747-> list_nil); (15,f) -> u f (\_3748 _3749-> list_nil); })))))
list_zip = (\_as_3-> (\_bs_4-> (let _3750 = _as_3 in (case _3750 of {(0,f) -> u f (list_nil); (1,f) -> u f (\_3751 _3752-> (let _3753 = _bs_4 in (case _3753 of {(0,f) -> u f (list_nil); (1,f) -> u f (\_3754 _3755-> (u (u list_cons (u (u pair_new _3751) _3754)) (u (u list_zip _3752) _3755))); }))); }))))
nat_gte = (\a0-> \a1-> ((a0::Integer) >= a1))
nat_sub = (\a0-> \a1-> ((a0::Integer) - a1))
fm_term_serialize_name = (\_name_1-> (u fm_name_to_bits _name_1))
fm_term_serialize = (\_term_1-> (\_depth_2-> (\_init_3-> (\_diff_4-> (\_x_5-> (let _3756 = _term_1 in (case _3756 of {(0,f) -> u f (\_3757 _3758-> (let _3759 = (((_3758::Integer) >= _init_3)) in (if _3759 then (let _name_8=(u bits_concat (u nat_to_bits (u nat_pred (((_depth_2::Integer) - _3758))))) in (u bits_o (u bits_o (u bits_i (u _name_8 _x_5))))) else (let _name_8=(u bits_concat (u nat_to_bits _3758)) in (u bits_o (u bits_i (u bits_o (u _name_8 _x_5)))))))); (1,f) -> u f (\_3760-> (let _name_7=(u bits_concat (u fm_term_serialize_name _3760)) in (u bits_o (u bits_o (u bits_o (u _name_7 _x_5)))))); (2,f) -> u f ((u bits_o (u bits_i (u bits_i _x_5)))); (3,f) -> u f (\_3761 _3762 _3763 _3764 _3765-> (let _eras_11=(let _3766 = _3761 in (if _3766 then bits_i else bits_o)) in (let _self_12=(u bits_concat (u fm_name_to_bits _3762)) in (let _xtyp_13=(u (u (u (u fm_term_serialize _3764) _depth_2) _init_3) _diff_4) in (let _body_14=(u (u (u (u fm_term_serialize (u (u _3765 (u (u fm_term_var _3762) _depth_2)) (u (u fm_term_var _3763) (u nat_succ _depth_2)))) (u nat_succ (u nat_succ _depth_2))) _init_3) _diff_4) in (u bits_i (u bits_o (u bits_o (u _eras_11 (u _self_12 (u _xtyp_13 (u _body_14 _x_5)))))))))))); (4,f) -> u f (\_3767 _3768-> (let _body_8=(u (u (u (u fm_term_serialize (u _3768 (u (u fm_term_var _3767) _depth_2))) (u nat_succ _depth_2)) _init_3) _diff_4) in (u bits_i (u bits_o (u bits_i (u _body_8 _x_5)))))); (5,f) -> u f (\_3769 _3770-> (let _func_8=(u (u (u (u fm_term_serialize _3769) _depth_2) _init_3) _diff_4) in (let _argm_9=(u (u (u (u fm_term_serialize _3770) _depth_2) _init_3) _diff_4) in (u bits_i (u bits_i (u bits_o (u _func_8 (u _argm_9 _x_5)))))))); (6,f) -> u f (\_3771 _3772 _3773-> (let _expr_9=(u (u (u (u fm_term_serialize _3772) _depth_2) _init_3) _diff_4) in (let _body_10=(u (u (u (u fm_term_serialize (u _3773 (u (u fm_term_var _3771) _depth_2))) (u nat_succ _depth_2)) _init_3) _diff_4) in (u bits_i (u bits_i (u bits_i (u _expr_9 (u _body_10 _x_5)))))))); (7,f) -> u f (\_3774 _3775 _3776-> (u (u (u (u (u fm_term_serialize (u _3776 _3775)) _depth_2) _init_3) _diff_4) _x_5)); (8,f) -> u f (\_3777 _3778 _3779-> (u (u (u (u (u fm_term_serialize _3778) _depth_2) _init_3) _diff_4) _x_5)); (9,f) -> u f (\_3780 _3781 _3782-> (let _name_9=(u bits_concat (u fm_name_to_bits _3780)) in (u bits_o (u bits_o (u bits_o (u _name_9 _x_5)))))); (10,f) -> u f (\_3783-> _x_5); (11,f) -> u f (\_3784-> (u (u (u (u (u fm_term_serialize (u fm_term_unroll_nat _3784)) _depth_2) _init_3) _diff_4) _x_5)); (12,f) -> u f (\_3785-> (u (u (u (u (u fm_term_serialize (u fm_term_unroll_chr _3785)) _depth_2) _init_3) _diff_4) _x_5)); (13,f) -> u f (\_3786-> (u (u (u (u (u fm_term_serialize (u fm_term_unroll_str _3786)) _depth_2) _init_3) _diff_4) _x_5)); (14,f) -> u f (\_3787 _3788 _3789 _3790 _3791 _3792-> (u _diff_4 _x_5)); (15,f) -> u f (\_3793 _3794-> (u (u (u (u (u fm_term_serialize _3794) _depth_2) _init_3) _diff_4) _x_5)); })))))))
bits_eql = (\_a_1-> (\_b_2-> (let _3795 = _a_1 in (case _3795 of {(0,f) -> u f ((let _3796 = _b_2 in (case _3796 of {(0,f) -> u f (bool_true); (1,f) -> u f (\_3797-> bool_false); (2,f) -> u f (\_3798-> bool_false); }))); (1,f) -> u f (\_3799-> (let _3800 = _b_2 in (case _3800 of {(0,f) -> u f (bool_false); (1,f) -> u f (\_3801-> (u (u bits_eql _3799) _3801)); (2,f) -> u f (\_3802-> bool_false); }))); (2,f) -> u f (\_3803-> (let _3804 = _b_2 in (case _3804 of {(0,f) -> u f (bool_false); (1,f) -> u f (\_3805-> bool_false); (2,f) -> u f (\_3806-> (u (u bits_eql _3803) _3806)); }))); }))))
fm_term_identical = (\_a_1-> (\_b_2-> (\_lv_3-> (let _ah_4=(u (u (u (u (u fm_term_serialize _a_1) _lv_3) _lv_3) bits_o) bits_e) in (let _bh_5=(u (u (u (u (u fm_term_serialize _b_2) _lv_3) _lv_3) bits_i) bits_e) in (u (u bits_eql _ah_4) _bh_5))))))
fm_smartmotive_replace = (\_term_1-> (\_from_2-> (\_to_3-> (\_lv_4-> (let _3807 = (u (u (u fm_term_identical _term_1) _from_2) _lv_4) in (if _3807 then _to_3 else (let _3808 = _term_1 in (case _3808 of {(0,f) -> u f (\_3809 _3810-> (u (u fm_term_var _3809) _3810)); (1,f) -> u f (\_3811-> (u fm_term_ref _3811)); (2,f) -> u f (fm_term_typ); (3,f) -> u f (\_3812 _3813 _3814 _3815 _3816-> (let _xtyp_10=(u (u (u (u fm_smartmotive_replace _3815) _from_2) _to_3) _lv_4) in (let _body_11=(u (u _3816 (u fm_term_ref _3813)) (u fm_term_ref _3814)) in (let _body_12=(u (u (u (u fm_smartmotive_replace _body_11) _from_2) _to_3) (u nat_succ (u nat_succ _lv_4))) in (u (u (u (u (u fm_term_all _3812) _3813) _3814) _xtyp_10) (\_s_13-> (\_x_14-> _body_12))))))); (4,f) -> u f (\_3817 _3818-> (let _body_7=(u _3818 (u fm_term_ref _3817)) in (let _body_8=(u (u (u (u fm_smartmotive_replace _body_7) _from_2) _to_3) (u nat_succ _lv_4)) in (u (u fm_term_lam _3817) (\_x_9-> _body_8))))); (5,f) -> u f (\_3819 _3820-> (let _func_7=(u (u (u (u fm_smartmotive_replace _3819) _from_2) _to_3) _lv_4) in (let _argm_8=(u (u (u (u fm_smartmotive_replace _3820) _from_2) _to_3) _lv_4) in (u (u fm_term_app _func_7) _argm_8)))); (6,f) -> u f (\_3821 _3822 _3823-> (let _expr_8=(u (u (u (u fm_smartmotive_replace _3822) _from_2) _to_3) _lv_4) in (let _body_9=(u _3823 (u fm_term_ref _3821)) in (let _body_10=(u (u (u (u fm_smartmotive_replace _body_9) _from_2) _to_3) (u nat_succ _lv_4)) in (u (u (u fm_term_let _3821) _expr_8) (\_x_11-> _body_10)))))); (7,f) -> u f (\_3824 _3825 _3826-> (let _expr_8=(u (u (u (u fm_smartmotive_replace _3825) _from_2) _to_3) _lv_4) in (let _body_9=(u _3826 (u fm_term_ref _3824)) in (let _body_10=(u (u (u (u fm_smartmotive_replace _body_9) _from_2) _to_3) (u nat_succ _lv_4)) in (u (u (u fm_term_def _3824) _expr_8) (\_x_11-> _body_10)))))); (8,f) -> u f (\_3827 _3828 _3829-> (let _term_8=(u (u (u (u fm_smartmotive_replace _3828) _from_2) _to_3) _lv_4) in (let _type_9=(u (u (u (u fm_smartmotive_replace _3829) _from_2) _to_3) _lv_4) in (u (u (u fm_term_ann _3827) _term_8) _type_9)))); (9,f) -> u f (\_3830 _3831 _3832-> _term_1); (10,f) -> u f (\_3833-> _term_1); (11,f) -> u f (\_3834-> _term_1); (12,f) -> u f (\_3835-> _term_1); (13,f) -> u f (\_3836-> _term_1); (14,f) -> u f (\_3837 _3838 _3839 _3840 _3841 _3842-> _term_1); (15,f) -> u f (\_3843 _3844-> (u (u (u (u fm_smartmotive_replace _3844) _from_2) _to_3) _lv_4)); }))))))))
fm_smartmotive_make = (\_name_1-> (\_expr_2-> (\_type_3-> (\_moti_4-> (\_lv_5-> (\_defs_6-> (let _vals_7=(u (u (u fm_smartmotive_vals _expr_2) _type_3) _defs_6) in (let _nams_8=(u (u (u fm_smartmotive_nams _name_1) _type_3) _defs_6) in (let _subs_9=(u (u list_zip _nams_8) _vals_7) in (let _moti_10=(u (u (u list_fold _subs_9) _moti_4) (\_sub_10-> (\_moti_11-> (let _3845 = _sub_10 in (case _3845 of {(0,f) -> u f (\_3846 _3847-> (u (u (u (u fm_smartmotive_replace _moti_11) _3847) (u fm_term_ref _3846)) _lv_5)); }))))) in _moti_10))))))))))
fm_term_desugar_cse_motive = (\_wyth_1-> (\_moti_2-> (let _3848 = _wyth_1 in (case _3848 of {(0,f) -> u f (_moti_2); (1,f) -> u f (\_3849 _3850-> (let _3851 = _3849 in (case _3851 of {(0,f) -> u f (\_3852 _3853 _3854 _3855 _3856 _3857-> (u (u (u (u (u fm_term_all bool_false) "") _3854) _3856) (\_s_11-> (\_x_12-> (u (u fm_term_desugar_cse_motive _3850) _moti_2))))); }))); }))))
string_is_empty = (\_str_1-> (let _3858 = _str_1 in (if null (_3858::String) then bool_true else bool_false)))
fm_term_desugar_cse_argument = (\_name_1-> (\_wyth_2-> (\_type_3-> (\_body_4-> (\_defs_5-> (let _3859 = (u (u fm_term_reduce _type_3) _defs_5) in (case _3859 of {(0,f) -> u f (\_3860 _3861-> (let _3862 = _wyth_2 in (case _3862 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_3863 _3864-> (let _3865 = _3863 in (case _3865 of {(0,f) -> u f (\_3866 _3867 _3868 _3869 _3870 _3871-> (u (u fm_term_lam _3868) (\_x_16-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _3864) _type_3) _body_4) _defs_5)))); }))); }))); (1,f) -> u f (\_3872-> (let _3873 = _wyth_2 in (case _3873 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_3874 _3875-> (let _3876 = _3874 in (case _3876 of {(0,f) -> u f (\_3877 _3878 _3879 _3880 _3881 _3882-> (u (u fm_term_lam _3879) (\_x_15-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _3875) _type_3) _body_4) _defs_5)))); }))); }))); (2,f) -> u f ((let _3883 = _wyth_2 in (case _3883 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_3884 _3885-> (let _3886 = _3884 in (case _3886 of {(0,f) -> u f (\_3887 _3888 _3889 _3890 _3891 _3892-> (u (u fm_term_lam _3889) (\_x_14-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _3885) _type_3) _body_4) _defs_5)))); }))); }))); (3,f) -> u f (\_3893 _3894 _3895 _3896 _3897-> (u (u fm_term_lam (let _3898 = (u string_is_empty _3895) in (if _3898 then _name_1 else (u string_flatten (u (u list_cons _name_1) (u (u list_cons ".") (u (u list_cons _3895) list_nil))))))) (\_x_11-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _wyth_2) (u (u _3897 (u (u fm_term_var _3894) 0)) (u (u fm_term_var _3895) 0))) _body_4) _defs_5)))); (4,f) -> u f (\_3899 _3900-> (let _3901 = _wyth_2 in (case _3901 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_3902 _3903-> (let _3904 = _3902 in (case _3904 of {(0,f) -> u f (\_3905 _3906 _3907 _3908 _3909 _3910-> (u (u fm_term_lam _3907) (\_x_16-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _3903) _type_3) _body_4) _defs_5)))); }))); }))); (5,f) -> u f (\_3911 _3912-> (let _3913 = _wyth_2 in (case _3913 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_3914 _3915-> (let _3916 = _3914 in (case _3916 of {(0,f) -> u f (\_3917 _3918 _3919 _3920 _3921 _3922-> (u (u fm_term_lam _3919) (\_x_16-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _3915) _type_3) _body_4) _defs_5)))); }))); }))); (6,f) -> u f (\_3923 _3924 _3925-> (let _3926 = _wyth_2 in (case _3926 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_3927 _3928-> (let _3929 = _3927 in (case _3929 of {(0,f) -> u f (\_3930 _3931 _3932 _3933 _3934 _3935-> (u (u fm_term_lam _3932) (\_x_17-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _3928) _type_3) _body_4) _defs_5)))); }))); }))); (7,f) -> u f (\_3936 _3937 _3938-> (let _3939 = _wyth_2 in (case _3939 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_3940 _3941-> (let _3942 = _3940 in (case _3942 of {(0,f) -> u f (\_3943 _3944 _3945 _3946 _3947 _3948-> (u (u fm_term_lam _3945) (\_x_17-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _3941) _type_3) _body_4) _defs_5)))); }))); }))); (8,f) -> u f (\_3949 _3950 _3951-> (let _3952 = _wyth_2 in (case _3952 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_3953 _3954-> (let _3955 = _3953 in (case _3955 of {(0,f) -> u f (\_3956 _3957 _3958 _3959 _3960 _3961-> (u (u fm_term_lam _3958) (\_x_17-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _3954) _type_3) _body_4) _defs_5)))); }))); }))); (9,f) -> u f (\_3962 _3963 _3964-> (let _3965 = _wyth_2 in (case _3965 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_3966 _3967-> (let _3968 = _3966 in (case _3968 of {(0,f) -> u f (\_3969 _3970 _3971 _3972 _3973 _3974-> (u (u fm_term_lam _3971) (\_x_17-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _3967) _type_3) _body_4) _defs_5)))); }))); }))); (10,f) -> u f (\_3975-> (let _3976 = _wyth_2 in (case _3976 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_3977 _3978-> (let _3979 = _3977 in (case _3979 of {(0,f) -> u f (\_3980 _3981 _3982 _3983 _3984 _3985-> (u (u fm_term_lam _3982) (\_x_15-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _3978) _type_3) _body_4) _defs_5)))); }))); }))); (11,f) -> u f (\_3986-> (let _3987 = _wyth_2 in (case _3987 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_3988 _3989-> (let _3990 = _3988 in (case _3990 of {(0,f) -> u f (\_3991 _3992 _3993 _3994 _3995 _3996-> (u (u fm_term_lam _3993) (\_x_15-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _3989) _type_3) _body_4) _defs_5)))); }))); }))); (12,f) -> u f (\_3997-> (let _3998 = _wyth_2 in (case _3998 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_3999 _4000-> (let _4001 = _3999 in (case _4001 of {(0,f) -> u f (\_4002 _4003 _4004 _4005 _4006 _4007-> (u (u fm_term_lam _4004) (\_x_15-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _4000) _type_3) _body_4) _defs_5)))); }))); }))); (13,f) -> u f (\_4008-> (let _4009 = _wyth_2 in (case _4009 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_4010 _4011-> (let _4012 = _4010 in (case _4012 of {(0,f) -> u f (\_4013 _4014 _4015 _4016 _4017 _4018-> (u (u fm_term_lam _4015) (\_x_15-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _4011) _type_3) _body_4) _defs_5)))); }))); }))); (14,f) -> u f (\_4019 _4020 _4021 _4022 _4023 _4024-> (let _4025 = _wyth_2 in (case _4025 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_4026 _4027-> (let _4028 = _4026 in (case _4028 of {(0,f) -> u f (\_4029 _4030 _4031 _4032 _4033 _4034-> (u (u fm_term_lam _4031) (\_x_20-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _4027) _type_3) _body_4) _defs_5)))); }))); }))); (15,f) -> u f (\_4035 _4036-> (let _4037 = _wyth_2 in (case _4037 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_4038 _4039-> (let _4040 = _4038 in (case _4040 of {(0,f) -> u f (\_4041 _4042 _4043 _4044 _4045 _4046-> (u (u fm_term_lam _4043) (\_x_16-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _4039) _type_3) _body_4) _defs_5)))); }))); }))); })))))))
maybe_or = (\_a_2-> (\_b_3-> (let _4047 = _a_2 in (case _4047 of {(0,f) -> u f (_b_3); (1,f) -> u f (\_4048-> (u maybe_some _4048)); }))))
fm_term_desugar_cse_cases = (\_expr_1-> (\_name_2-> (\_wyth_3-> (\_cses_4-> (\_type_5-> (\_defs_6-> (\_ctxt_7-> (let _4049 = (u (u fm_term_reduce _type_5) _defs_6) in (case _4049 of {(0,f) -> u f (\_4050 _4051-> (let _expr_10=(u (u (u list_for _wyth_3) _expr_1) (\_defn_10-> (\_expr_11-> (u (u fm_term_app _expr_11) (let _4052 = _defn_10 in (case _4052 of {(0,f) -> u f (\_4053 _4054 _4055 _4056 _4057 _4058-> _4056); })))))) in _expr_10)); (1,f) -> u f (\_4059-> (let _expr_9=(u (u (u list_for _wyth_3) _expr_1) (\_defn_9-> (\_expr_10-> (u (u fm_term_app _expr_10) (let _4060 = _defn_9 in (case _4060 of {(0,f) -> u f (\_4061 _4062 _4063 _4064 _4065 _4066-> _4064); })))))) in _expr_9)); (2,f) -> u f ((let _expr_8=(u (u (u list_for _wyth_3) _expr_1) (\_defn_8-> (\_expr_9-> (u (u fm_term_app _expr_9) (let _4067 = _defn_8 in (case _4067 of {(0,f) -> u f (\_4068 _4069 _4070 _4071 _4072 _4073-> _4071); })))))) in _expr_8)); (3,f) -> u f (\_4074 _4075 _4076 _4077 _4078-> (let _got_13=(u (u maybe_or (u (u fm_get _4076) _cses_4)) (u (u fm_get "_") _cses_4)) in (let _4079 = _got_13 in (case _4079 of {(0,f) -> u f ((let _expr_14=(u (u (u list_for _wyth_3) _expr_1) (\_defn_14-> (\_expr_15-> (let _4080 = _defn_14 in (case _4080 of {(0,f) -> u f (\_4081 _4082 _4083 _4084 _4085 _4086-> (u (u fm_term_app _expr_15) _4084)); }))))) in _expr_14)); (1,f) -> u f (\_4087-> (let _argm_15=(u (u (u (u (u fm_term_desugar_cse_argument _name_2) _wyth_3) _4077) _4087) _defs_6) in (let _expr_16=(u (u fm_term_app _expr_1) _argm_15) in (let _type_17=(u (u _4078 (u (u fm_term_var _4075) 0)) (u (u fm_term_var _4076) 0)) in (u (u (u (u (u (u (u fm_term_desugar_cse_cases _expr_16) _name_2) _wyth_3) _cses_4) _type_17) _defs_6) _ctxt_7))))); })))); (4,f) -> u f (\_4088 _4089-> (let _expr_10=(u (u (u list_for _wyth_3) _expr_1) (\_defn_10-> (\_expr_11-> (u (u fm_term_app _expr_11) (let _4090 = _defn_10 in (case _4090 of {(0,f) -> u f (\_4091 _4092 _4093 _4094 _4095 _4096-> _4094); })))))) in _expr_10)); (5,f) -> u f (\_4097 _4098-> (let _expr_10=(u (u (u list_for _wyth_3) _expr_1) (\_defn_10-> (\_expr_11-> (u (u fm_term_app _expr_11) (let _4099 = _defn_10 in (case _4099 of {(0,f) -> u f (\_4100 _4101 _4102 _4103 _4104 _4105-> _4103); })))))) in _expr_10)); (6,f) -> u f (\_4106 _4107 _4108-> (let _expr_11=(u (u (u list_for _wyth_3) _expr_1) (\_defn_11-> (\_expr_12-> (u (u fm_term_app _expr_12) (let _4109 = _defn_11 in (case _4109 of {(0,f) -> u f (\_4110 _4111 _4112 _4113 _4114 _4115-> _4113); })))))) in _expr_11)); (7,f) -> u f (\_4116 _4117 _4118-> (let _expr_11=(u (u (u list_for _wyth_3) _expr_1) (\_defn_11-> (\_expr_12-> (u (u fm_term_app _expr_12) (let _4119 = _defn_11 in (case _4119 of {(0,f) -> u f (\_4120 _4121 _4122 _4123 _4124 _4125-> _4123); })))))) in _expr_11)); (8,f) -> u f (\_4126 _4127 _4128-> (let _expr_11=(u (u (u list_for _wyth_3) _expr_1) (\_defn_11-> (\_expr_12-> (u (u fm_term_app _expr_12) (let _4129 = _defn_11 in (case _4129 of {(0,f) -> u f (\_4130 _4131 _4132 _4133 _4134 _4135-> _4133); })))))) in _expr_11)); (9,f) -> u f (\_4136 _4137 _4138-> (let _expr_11=(u (u (u list_for _wyth_3) _expr_1) (\_defn_11-> (\_expr_12-> (u (u fm_term_app _expr_12) (let _4139 = _defn_11 in (case _4139 of {(0,f) -> u f (\_4140 _4141 _4142 _4143 _4144 _4145-> _4143); })))))) in _expr_11)); (10,f) -> u f (\_4146-> (let _expr_9=(u (u (u list_for _wyth_3) _expr_1) (\_defn_9-> (\_expr_10-> (u (u fm_term_app _expr_10) (let _4147 = _defn_9 in (case _4147 of {(0,f) -> u f (\_4148 _4149 _4150 _4151 _4152 _4153-> _4151); })))))) in _expr_9)); (11,f) -> u f (\_4154-> (let _expr_9=(u (u (u list_for _wyth_3) _expr_1) (\_defn_9-> (\_expr_10-> (u (u fm_term_app _expr_10) (let _4155 = _defn_9 in (case _4155 of {(0,f) -> u f (\_4156 _4157 _4158 _4159 _4160 _4161-> _4159); })))))) in _expr_9)); (12,f) -> u f (\_4162-> (let _expr_9=(u (u (u list_for _wyth_3) _expr_1) (\_defn_9-> (\_expr_10-> (u (u fm_term_app _expr_10) (let _4163 = _defn_9 in (case _4163 of {(0,f) -> u f (\_4164 _4165 _4166 _4167 _4168 _4169-> _4167); })))))) in _expr_9)); (13,f) -> u f (\_4170-> (let _expr_9=(u (u (u list_for _wyth_3) _expr_1) (\_defn_9-> (\_expr_10-> (u (u fm_term_app _expr_10) (let _4171 = _defn_9 in (case _4171 of {(0,f) -> u f (\_4172 _4173 _4174 _4175 _4176 _4177-> _4175); })))))) in _expr_9)); (14,f) -> u f (\_4178 _4179 _4180 _4181 _4182 _4183-> (let _expr_14=(u (u (u list_for _wyth_3) _expr_1) (\_defn_14-> (\_expr_15-> (u (u fm_term_app _expr_15) (let _4184 = _defn_14 in (case _4184 of {(0,f) -> u f (\_4185 _4186 _4187 _4188 _4189 _4190-> _4188); })))))) in _expr_14)); (15,f) -> u f (\_4191 _4192-> (let _expr_10=(u (u (u list_for _wyth_3) _expr_1) (\_defn_10-> (\_expr_11-> (u (u fm_term_app _expr_11) (let _4193 = _defn_10 in (case _4193 of {(0,f) -> u f (\_4194 _4195 _4196 _4197 _4198 _4199-> _4197); })))))) in _expr_10)); })))))))))
fm_term_desugar_cse = (\_expr_1-> (\_name_2-> (\_with_3-> (\_cses_4-> (\_moti_5-> (\_type_6-> (\_defs_7-> (\_ctxt_8-> (let _4200 = (u (u fm_term_reduce _type_6) _defs_7) in (case _4200 of {(0,f) -> u f (\_4201 _4202-> maybe_none); (1,f) -> u f (\_4203-> maybe_none); (2,f) -> u f (maybe_none); (3,f) -> u f (\_4204 _4205 _4206 _4207 _4208-> (let _moti_14=(u (u fm_term_desugar_cse_motive _with_3) _moti_5) in (let _argm_15=(u (u (u (u (u fm_term_desugar_cse_argument _name_2) list_nil) _4207) _moti_14) _defs_7) in (let _expr_16=(u (u fm_term_app _expr_1) _argm_15) in (let _type_17=(u (u _4208 (u (u fm_term_var _4205) 0)) (u (u fm_term_var _4206) 0)) in (u maybe_some (u (u (u (u (u (u (u fm_term_desugar_cse_cases _expr_16) _name_2) _with_3) _cses_4) _type_17) _defs_7) _ctxt_8))))))); (4,f) -> u f (\_4209 _4210-> maybe_none); (5,f) -> u f (\_4211 _4212-> maybe_none); (6,f) -> u f (\_4213 _4214 _4215-> maybe_none); (7,f) -> u f (\_4216 _4217 _4218-> maybe_none); (8,f) -> u f (\_4219 _4220 _4221-> maybe_none); (9,f) -> u f (\_4222 _4223 _4224-> maybe_none); (10,f) -> u f (\_4225-> maybe_none); (11,f) -> u f (\_4226-> maybe_none); (12,f) -> u f (\_4227-> maybe_none); (13,f) -> u f (\_4228-> maybe_none); (14,f) -> u f (\_4229 _4230 _4231 _4232 _4233 _4234-> maybe_none); (15,f) -> u f (\_4235 _4236-> maybe_none); }))))))))))
fm_error_cant_infer = (\_origin_1-> (\_term_2-> (\_context_3-> (6,\t-> t _origin_1 _term_2 _context_3))))
set_has = (\_bits_1-> (\_set_2-> (let _4237 = (u (u map_get _bits_1) _set_2) in (case _4237 of {(0,f) -> u f (bool_false); (1,f) -> u f (\_4238-> bool_true); }))))
bool_or = (\a0-> \a1-> (a0 || a1))
fm_term_has_holes = (\_term_1-> (let _4239 = _term_1 in (case _4239 of {(0,f) -> u f (\_4240 _4241-> bool_false); (1,f) -> u f (\_4242-> bool_false); (2,f) -> u f (bool_false); (3,f) -> u f (\_4243 _4244 _4245 _4246 _4247-> (((u fm_term_has_holes _4246) || (u fm_term_has_holes (u (u _4247 fm_term_typ) fm_term_typ))))); (4,f) -> u f (\_4248 _4249-> (u fm_term_has_holes (u _4249 fm_term_typ))); (5,f) -> u f (\_4250 _4251-> (((u fm_term_has_holes _4250) || (u fm_term_has_holes _4251)))); (6,f) -> u f (\_4252 _4253 _4254-> (((u fm_term_has_holes _4253) || (u fm_term_has_holes (u _4254 fm_term_typ))))); (7,f) -> u f (\_4255 _4256 _4257-> (((u fm_term_has_holes _4256) || (u fm_term_has_holes (u _4257 fm_term_typ))))); (8,f) -> u f (\_4258 _4259 _4260-> (((u fm_term_has_holes _4259) || (u fm_term_has_holes _4260)))); (9,f) -> u f (\_4261 _4262 _4263-> bool_false); (10,f) -> u f (\_4264-> bool_true); (11,f) -> u f (\_4265-> bool_false); (12,f) -> u f (\_4266-> bool_false); (13,f) -> u f (\_4267-> bool_false); (14,f) -> u f (\_4268 _4269 _4270 _4271 _4272 _4273-> bool_false); (15,f) -> u f (\_4274 _4275-> (u fm_term_has_holes _4275)); })))
fm_term_equal_hole = (\_path_1-> (\_term_2-> (let _4276 = _term_2 in (case _4276 of {(0,f) -> u f (\_4277 _4278-> (let _4279 = (u fm_term_has_holes _term_2) in (if _4279 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); (1,f) -> u f (\_4280-> (let _4281 = (u fm_term_has_holes _term_2) in (if _4281 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); (2,f) -> u f ((let _4282 = (u fm_term_has_holes _term_2) in (if _4282 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); (3,f) -> u f (\_4283 _4284 _4285 _4286 _4287-> (let _4288 = (u fm_term_has_holes _term_2) in (if _4288 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); (4,f) -> u f (\_4289 _4290-> (let _4291 = (u fm_term_has_holes _term_2) in (if _4291 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); (5,f) -> u f (\_4292 _4293-> (let _4294 = (u fm_term_has_holes _term_2) in (if _4294 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); (6,f) -> u f (\_4295 _4296 _4297-> (let _4298 = (u fm_term_has_holes _term_2) in (if _4298 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); (7,f) -> u f (\_4299 _4300 _4301-> (let _4302 = (u fm_term_has_holes _term_2) in (if _4302 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); (8,f) -> u f (\_4303 _4304 _4305-> (let _4306 = (u fm_term_has_holes _term_2) in (if _4306 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); (9,f) -> u f (\_4307 _4308 _4309-> (let _4310 = (u fm_term_has_holes _term_2) in (if _4310 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); (10,f) -> u f (\_4311-> (u (u fm_check_result (u maybe_some bool_true)) list_nil)); (11,f) -> u f (\_4312-> (let _4313 = (u fm_term_has_holes _term_2) in (if _4313 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); (12,f) -> u f (\_4314-> (let _4315 = (u fm_term_has_holes _term_2) in (if _4315 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); (13,f) -> u f (\_4316-> (let _4317 = (u fm_term_has_holes _term_2) in (if _4317 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); (14,f) -> u f (\_4318 _4319 _4320 _4321 _4322 _4323-> (let _4324 = (u fm_term_has_holes _term_2) in (if _4324 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); (15,f) -> u f (\_4325 _4326-> (let _4327 = (u fm_term_has_holes _term_2) in (if _4327 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); }))))
fm_term_equal_extra_holes = (\_a_1-> (\_b_2-> (let _4328 = _a_1 in (case _4328 of {(0,f) -> u f (\_4329 _4330-> (let _4331 = _b_2 in (case _4331 of {(0,f) -> u f (\_4332 _4333-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (1,f) -> u f (\_4334-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some unit_new)) list_nil)); (3,f) -> u f (\_4335 _4336 _4337 _4338 _4339-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (4,f) -> u f (\_4340 _4341-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (5,f) -> u f (\_4342 _4343-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (6,f) -> u f (\_4344 _4345 _4346-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (7,f) -> u f (\_4347 _4348 _4349-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (8,f) -> u f (\_4350 _4351 _4352-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (9,f) -> u f (\_4353 _4354 _4355-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (10,f) -> u f (\_4356-> (let _4357 = (u (u fm_term_equal_hole _4356) _a_1) in (case _4357 of {(0,f) -> u f (\_4358 _4359-> (let _4360 = _4358 in (case _4360 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _4359)); (1,f) -> u f (\_4361-> (let _4362 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _4362 of {(0,f) -> u f (\_4363 _4364-> (u (u fm_check_result _4363) (u (u list_concat _4359) _4364))); }))); }))); }))); (11,f) -> u f (\_4365-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (12,f) -> u f (\_4366-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (13,f) -> u f (\_4367-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (14,f) -> u f (\_4368 _4369 _4370 _4371 _4372 _4373-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (15,f) -> u f (\_4374 _4375-> (u (u fm_term_equal_extra_holes _a_1) _4375)); }))); (1,f) -> u f (\_4376-> (let _4377 = _b_2 in (case _4377 of {(0,f) -> u f (\_4378 _4379-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (1,f) -> u f (\_4380-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some unit_new)) list_nil)); (3,f) -> u f (\_4381 _4382 _4383 _4384 _4385-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (4,f) -> u f (\_4386 _4387-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (5,f) -> u f (\_4388 _4389-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (6,f) -> u f (\_4390 _4391 _4392-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (7,f) -> u f (\_4393 _4394 _4395-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (8,f) -> u f (\_4396 _4397 _4398-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (9,f) -> u f (\_4399 _4400 _4401-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (10,f) -> u f (\_4402-> (let _4403 = (u (u fm_term_equal_hole _4402) _a_1) in (case _4403 of {(0,f) -> u f (\_4404 _4405-> (let _4406 = _4404 in (case _4406 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _4405)); (1,f) -> u f (\_4407-> (let _4408 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _4408 of {(0,f) -> u f (\_4409 _4410-> (u (u fm_check_result _4409) (u (u list_concat _4405) _4410))); }))); }))); }))); (11,f) -> u f (\_4411-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (12,f) -> u f (\_4412-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (13,f) -> u f (\_4413-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (14,f) -> u f (\_4414 _4415 _4416 _4417 _4418 _4419-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (15,f) -> u f (\_4420 _4421-> (u (u fm_term_equal_extra_holes _a_1) _4421)); }))); (2,f) -> u f ((let _4422 = _b_2 in (case _4422 of {(0,f) -> u f (\_4423 _4424-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (1,f) -> u f (\_4425-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some unit_new)) list_nil)); (3,f) -> u f (\_4426 _4427 _4428 _4429 _4430-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (4,f) -> u f (\_4431 _4432-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (5,f) -> u f (\_4433 _4434-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (6,f) -> u f (\_4435 _4436 _4437-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (7,f) -> u f (\_4438 _4439 _4440-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (8,f) -> u f (\_4441 _4442 _4443-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (9,f) -> u f (\_4444 _4445 _4446-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (10,f) -> u f (\_4447-> (let _4448 = (u (u fm_term_equal_hole _4447) _a_1) in (case _4448 of {(0,f) -> u f (\_4449 _4450-> (let _4451 = _4449 in (case _4451 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _4450)); (1,f) -> u f (\_4452-> (let _4453 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _4453 of {(0,f) -> u f (\_4454 _4455-> (u (u fm_check_result _4454) (u (u list_concat _4450) _4455))); }))); }))); }))); (11,f) -> u f (\_4456-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (12,f) -> u f (\_4457-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (13,f) -> u f (\_4458-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (14,f) -> u f (\_4459 _4460 _4461 _4462 _4463 _4464-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (15,f) -> u f (\_4465 _4466-> (u (u fm_term_equal_extra_holes _a_1) _4466)); }))); (3,f) -> u f (\_4467 _4468 _4469 _4470 _4471-> (let _4472 = _b_2 in (case _4472 of {(0,f) -> u f (\_4473 _4474-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (1,f) -> u f (\_4475-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some unit_new)) list_nil)); (3,f) -> u f (\_4476 _4477 _4478 _4479 _4480-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (4,f) -> u f (\_4481 _4482-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (5,f) -> u f (\_4483 _4484-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (6,f) -> u f (\_4485 _4486 _4487-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (7,f) -> u f (\_4488 _4489 _4490-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (8,f) -> u f (\_4491 _4492 _4493-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (9,f) -> u f (\_4494 _4495 _4496-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (10,f) -> u f (\_4497-> (let _4498 = (u (u fm_term_equal_hole _4497) _a_1) in (case _4498 of {(0,f) -> u f (\_4499 _4500-> (let _4501 = _4499 in (case _4501 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _4500)); (1,f) -> u f (\_4502-> (let _4503 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _4503 of {(0,f) -> u f (\_4504 _4505-> (u (u fm_check_result _4504) (u (u list_concat _4500) _4505))); }))); }))); }))); (11,f) -> u f (\_4506-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (12,f) -> u f (\_4507-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (13,f) -> u f (\_4508-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (14,f) -> u f (\_4509 _4510 _4511 _4512 _4513 _4514-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (15,f) -> u f (\_4515 _4516-> (u (u fm_term_equal_extra_holes _a_1) _4516)); }))); (4,f) -> u f (\_4517 _4518-> (let _4519 = _b_2 in (case _4519 of {(0,f) -> u f (\_4520 _4521-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (1,f) -> u f (\_4522-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some unit_new)) list_nil)); (3,f) -> u f (\_4523 _4524 _4525 _4526 _4527-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (4,f) -> u f (\_4528 _4529-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (5,f) -> u f (\_4530 _4531-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (6,f) -> u f (\_4532 _4533 _4534-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (7,f) -> u f (\_4535 _4536 _4537-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (8,f) -> u f (\_4538 _4539 _4540-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (9,f) -> u f (\_4541 _4542 _4543-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (10,f) -> u f (\_4544-> (let _4545 = (u (u fm_term_equal_hole _4544) _a_1) in (case _4545 of {(0,f) -> u f (\_4546 _4547-> (let _4548 = _4546 in (case _4548 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _4547)); (1,f) -> u f (\_4549-> (let _4550 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _4550 of {(0,f) -> u f (\_4551 _4552-> (u (u fm_check_result _4551) (u (u list_concat _4547) _4552))); }))); }))); }))); (11,f) -> u f (\_4553-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (12,f) -> u f (\_4554-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (13,f) -> u f (\_4555-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (14,f) -> u f (\_4556 _4557 _4558 _4559 _4560 _4561-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (15,f) -> u f (\_4562 _4563-> (u (u fm_term_equal_extra_holes _a_1) _4563)); }))); (5,f) -> u f (\_4564 _4565-> (let _4566 = _b_2 in (case _4566 of {(0,f) -> u f (\_4567 _4568-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (1,f) -> u f (\_4569-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some unit_new)) list_nil)); (3,f) -> u f (\_4570 _4571 _4572 _4573 _4574-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (4,f) -> u f (\_4575 _4576-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (5,f) -> u f (\_4577 _4578-> (let _4579 = (u (u fm_term_equal_extra_holes _4564) _4577) in (case _4579 of {(0,f) -> u f (\_4580 _4581-> (let _4582 = _4580 in (case _4582 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _4581)); (1,f) -> u f (\_4583-> (let _4584 = (u (u fm_term_equal_extra_holes _4565) _4578) in (case _4584 of {(0,f) -> u f (\_4585 _4586-> (u (u fm_check_result _4585) (u (u list_concat _4581) _4586))); }))); }))); }))); (6,f) -> u f (\_4587 _4588 _4589-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (7,f) -> u f (\_4590 _4591 _4592-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (8,f) -> u f (\_4593 _4594 _4595-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (9,f) -> u f (\_4596 _4597 _4598-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (10,f) -> u f (\_4599-> (let _4600 = (u (u fm_term_equal_hole _4599) _a_1) in (case _4600 of {(0,f) -> u f (\_4601 _4602-> (let _4603 = _4601 in (case _4603 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _4602)); (1,f) -> u f (\_4604-> (let _4605 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _4605 of {(0,f) -> u f (\_4606 _4607-> (u (u fm_check_result _4606) (u (u list_concat _4602) _4607))); }))); }))); }))); (11,f) -> u f (\_4608-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (12,f) -> u f (\_4609-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (13,f) -> u f (\_4610-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (14,f) -> u f (\_4611 _4612 _4613 _4614 _4615 _4616-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (15,f) -> u f (\_4617 _4618-> (u (u fm_term_equal_extra_holes _a_1) _4618)); }))); (6,f) -> u f (\_4619 _4620 _4621-> (let _4622 = _b_2 in (case _4622 of {(0,f) -> u f (\_4623 _4624-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (1,f) -> u f (\_4625-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some unit_new)) list_nil)); (3,f) -> u f (\_4626 _4627 _4628 _4629 _4630-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (4,f) -> u f (\_4631 _4632-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (5,f) -> u f (\_4633 _4634-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (6,f) -> u f (\_4635 _4636 _4637-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (7,f) -> u f (\_4638 _4639 _4640-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (8,f) -> u f (\_4641 _4642 _4643-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (9,f) -> u f (\_4644 _4645 _4646-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (10,f) -> u f (\_4647-> (let _4648 = (u (u fm_term_equal_hole _4647) _a_1) in (case _4648 of {(0,f) -> u f (\_4649 _4650-> (let _4651 = _4649 in (case _4651 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _4650)); (1,f) -> u f (\_4652-> (let _4653 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _4653 of {(0,f) -> u f (\_4654 _4655-> (u (u fm_check_result _4654) (u (u list_concat _4650) _4655))); }))); }))); }))); (11,f) -> u f (\_4656-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (12,f) -> u f (\_4657-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (13,f) -> u f (\_4658-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (14,f) -> u f (\_4659 _4660 _4661 _4662 _4663 _4664-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (15,f) -> u f (\_4665 _4666-> (u (u fm_term_equal_extra_holes _a_1) _4666)); }))); (7,f) -> u f (\_4667 _4668 _4669-> (let _4670 = _b_2 in (case _4670 of {(0,f) -> u f (\_4671 _4672-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (1,f) -> u f (\_4673-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some unit_new)) list_nil)); (3,f) -> u f (\_4674 _4675 _4676 _4677 _4678-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (4,f) -> u f (\_4679 _4680-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (5,f) -> u f (\_4681 _4682-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (6,f) -> u f (\_4683 _4684 _4685-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (7,f) -> u f (\_4686 _4687 _4688-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (8,f) -> u f (\_4689 _4690 _4691-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (9,f) -> u f (\_4692 _4693 _4694-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (10,f) -> u f (\_4695-> (let _4696 = (u (u fm_term_equal_hole _4695) _a_1) in (case _4696 of {(0,f) -> u f (\_4697 _4698-> (let _4699 = _4697 in (case _4699 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _4698)); (1,f) -> u f (\_4700-> (let _4701 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _4701 of {(0,f) -> u f (\_4702 _4703-> (u (u fm_check_result _4702) (u (u list_concat _4698) _4703))); }))); }))); }))); (11,f) -> u f (\_4704-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (12,f) -> u f (\_4705-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (13,f) -> u f (\_4706-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (14,f) -> u f (\_4707 _4708 _4709 _4710 _4711 _4712-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (15,f) -> u f (\_4713 _4714-> (u (u fm_term_equal_extra_holes _a_1) _4714)); }))); (8,f) -> u f (\_4715 _4716 _4717-> (let _4718 = _b_2 in (case _4718 of {(0,f) -> u f (\_4719 _4720-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (1,f) -> u f (\_4721-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some unit_new)) list_nil)); (3,f) -> u f (\_4722 _4723 _4724 _4725 _4726-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (4,f) -> u f (\_4727 _4728-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (5,f) -> u f (\_4729 _4730-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (6,f) -> u f (\_4731 _4732 _4733-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (7,f) -> u f (\_4734 _4735 _4736-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (8,f) -> u f (\_4737 _4738 _4739-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (9,f) -> u f (\_4740 _4741 _4742-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (10,f) -> u f (\_4743-> (let _4744 = (u (u fm_term_equal_hole _4743) _a_1) in (case _4744 of {(0,f) -> u f (\_4745 _4746-> (let _4747 = _4745 in (case _4747 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _4746)); (1,f) -> u f (\_4748-> (let _4749 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _4749 of {(0,f) -> u f (\_4750 _4751-> (u (u fm_check_result _4750) (u (u list_concat _4746) _4751))); }))); }))); }))); (11,f) -> u f (\_4752-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (12,f) -> u f (\_4753-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (13,f) -> u f (\_4754-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (14,f) -> u f (\_4755 _4756 _4757 _4758 _4759 _4760-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (15,f) -> u f (\_4761 _4762-> (u (u fm_term_equal_extra_holes _a_1) _4762)); }))); (9,f) -> u f (\_4763 _4764 _4765-> (let _4766 = _b_2 in (case _4766 of {(0,f) -> u f (\_4767 _4768-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (1,f) -> u f (\_4769-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some unit_new)) list_nil)); (3,f) -> u f (\_4770 _4771 _4772 _4773 _4774-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (4,f) -> u f (\_4775 _4776-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (5,f) -> u f (\_4777 _4778-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (6,f) -> u f (\_4779 _4780 _4781-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (7,f) -> u f (\_4782 _4783 _4784-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (8,f) -> u f (\_4785 _4786 _4787-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (9,f) -> u f (\_4788 _4789 _4790-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (10,f) -> u f (\_4791-> (let _4792 = (u (u fm_term_equal_hole _4791) _a_1) in (case _4792 of {(0,f) -> u f (\_4793 _4794-> (let _4795 = _4793 in (case _4795 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _4794)); (1,f) -> u f (\_4796-> (let _4797 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _4797 of {(0,f) -> u f (\_4798 _4799-> (u (u fm_check_result _4798) (u (u list_concat _4794) _4799))); }))); }))); }))); (11,f) -> u f (\_4800-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (12,f) -> u f (\_4801-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (13,f) -> u f (\_4802-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (14,f) -> u f (\_4803 _4804 _4805 _4806 _4807 _4808-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (15,f) -> u f (\_4809 _4810-> (u (u fm_term_equal_extra_holes _a_1) _4810)); }))); (10,f) -> u f (\_4811-> (let _4812 = (u (u fm_term_equal_hole _4811) _b_2) in (case _4812 of {(0,f) -> u f (\_4813 _4814-> (let _4815 = _4813 in (case _4815 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _4814)); (1,f) -> u f (\_4816-> (let _4817 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _4817 of {(0,f) -> u f (\_4818 _4819-> (u (u fm_check_result _4818) (u (u list_concat _4814) _4819))); }))); }))); }))); (11,f) -> u f (\_4820-> (let _4821 = _b_2 in (case _4821 of {(0,f) -> u f (\_4822 _4823-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (1,f) -> u f (\_4824-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some unit_new)) list_nil)); (3,f) -> u f (\_4825 _4826 _4827 _4828 _4829-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (4,f) -> u f (\_4830 _4831-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (5,f) -> u f (\_4832 _4833-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (6,f) -> u f (\_4834 _4835 _4836-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (7,f) -> u f (\_4837 _4838 _4839-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (8,f) -> u f (\_4840 _4841 _4842-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (9,f) -> u f (\_4843 _4844 _4845-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (10,f) -> u f (\_4846-> (let _4847 = (u (u fm_term_equal_hole _4846) _a_1) in (case _4847 of {(0,f) -> u f (\_4848 _4849-> (let _4850 = _4848 in (case _4850 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _4849)); (1,f) -> u f (\_4851-> (let _4852 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _4852 of {(0,f) -> u f (\_4853 _4854-> (u (u fm_check_result _4853) (u (u list_concat _4849) _4854))); }))); }))); }))); (11,f) -> u f (\_4855-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (12,f) -> u f (\_4856-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (13,f) -> u f (\_4857-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (14,f) -> u f (\_4858 _4859 _4860 _4861 _4862 _4863-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (15,f) -> u f (\_4864 _4865-> (u (u fm_term_equal_extra_holes _a_1) _4865)); }))); (12,f) -> u f (\_4866-> (let _4867 = _b_2 in (case _4867 of {(0,f) -> u f (\_4868 _4869-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (1,f) -> u f (\_4870-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some unit_new)) list_nil)); (3,f) -> u f (\_4871 _4872 _4873 _4874 _4875-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (4,f) -> u f (\_4876 _4877-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (5,f) -> u f (\_4878 _4879-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (6,f) -> u f (\_4880 _4881 _4882-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (7,f) -> u f (\_4883 _4884 _4885-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (8,f) -> u f (\_4886 _4887 _4888-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (9,f) -> u f (\_4889 _4890 _4891-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (10,f) -> u f (\_4892-> (let _4893 = (u (u fm_term_equal_hole _4892) _a_1) in (case _4893 of {(0,f) -> u f (\_4894 _4895-> (let _4896 = _4894 in (case _4896 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _4895)); (1,f) -> u f (\_4897-> (let _4898 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _4898 of {(0,f) -> u f (\_4899 _4900-> (u (u fm_check_result _4899) (u (u list_concat _4895) _4900))); }))); }))); }))); (11,f) -> u f (\_4901-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (12,f) -> u f (\_4902-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (13,f) -> u f (\_4903-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (14,f) -> u f (\_4904 _4905 _4906 _4907 _4908 _4909-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (15,f) -> u f (\_4910 _4911-> (u (u fm_term_equal_extra_holes _a_1) _4911)); }))); (13,f) -> u f (\_4912-> (let _4913 = _b_2 in (case _4913 of {(0,f) -> u f (\_4914 _4915-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (1,f) -> u f (\_4916-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some unit_new)) list_nil)); (3,f) -> u f (\_4917 _4918 _4919 _4920 _4921-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (4,f) -> u f (\_4922 _4923-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (5,f) -> u f (\_4924 _4925-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (6,f) -> u f (\_4926 _4927 _4928-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (7,f) -> u f (\_4929 _4930 _4931-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (8,f) -> u f (\_4932 _4933 _4934-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (9,f) -> u f (\_4935 _4936 _4937-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (10,f) -> u f (\_4938-> (let _4939 = (u (u fm_term_equal_hole _4938) _a_1) in (case _4939 of {(0,f) -> u f (\_4940 _4941-> (let _4942 = _4940 in (case _4942 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _4941)); (1,f) -> u f (\_4943-> (let _4944 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _4944 of {(0,f) -> u f (\_4945 _4946-> (u (u fm_check_result _4945) (u (u list_concat _4941) _4946))); }))); }))); }))); (11,f) -> u f (\_4947-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (12,f) -> u f (\_4948-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (13,f) -> u f (\_4949-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (14,f) -> u f (\_4950 _4951 _4952 _4953 _4954 _4955-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (15,f) -> u f (\_4956 _4957-> (u (u fm_term_equal_extra_holes _a_1) _4957)); }))); (14,f) -> u f (\_4958 _4959 _4960 _4961 _4962 _4963-> (let _4964 = _b_2 in (case _4964 of {(0,f) -> u f (\_4965 _4966-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (1,f) -> u f (\_4967-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some unit_new)) list_nil)); (3,f) -> u f (\_4968 _4969 _4970 _4971 _4972-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (4,f) -> u f (\_4973 _4974-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (5,f) -> u f (\_4975 _4976-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (6,f) -> u f (\_4977 _4978 _4979-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (7,f) -> u f (\_4980 _4981 _4982-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (8,f) -> u f (\_4983 _4984 _4985-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (9,f) -> u f (\_4986 _4987 _4988-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (10,f) -> u f (\_4989-> (let _4990 = (u (u fm_term_equal_hole _4989) _a_1) in (case _4990 of {(0,f) -> u f (\_4991 _4992-> (let _4993 = _4991 in (case _4993 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _4992)); (1,f) -> u f (\_4994-> (let _4995 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _4995 of {(0,f) -> u f (\_4996 _4997-> (u (u fm_check_result _4996) (u (u list_concat _4992) _4997))); }))); }))); }))); (11,f) -> u f (\_4998-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (12,f) -> u f (\_4999-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (13,f) -> u f (\_5000-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (14,f) -> u f (\_5001 _5002 _5003 _5004 _5005 _5006-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (15,f) -> u f (\_5007 _5008-> (u (u fm_term_equal_extra_holes _a_1) _5008)); }))); (15,f) -> u f (\_5009 _5010-> (u (u fm_term_equal_extra_holes _5010) _b_2)); }))))
set_set = (\_bits_1-> (\_set_2-> (u (u (u map_set _bits_1) unit_new) _set_2)))
bool_eql = (\_a_1-> (\_b_2-> (let _5011 = _a_1 in (if _5011 then _b_2 else ((not _b_2))))))
fm_term_equal = (\_a_1-> (\_b_2-> (\_defs_3-> (\_lv_4-> (\_seen_5-> (let _ah_6=(u (u (u (u (u fm_term_serialize (u (u fm_term_reduce _a_1) map_new)) _lv_4) _lv_4) bits_o) bits_e) in (let _bh_7=(u (u (u (u (u fm_term_serialize (u (u fm_term_reduce _b_2) map_new)) _lv_4) _lv_4) bits_i) bits_e) in (let _5012 = (u (u bits_eql _ah_6) _bh_7) in (if _5012 then (u (u fm_check_result (u maybe_some bool_true)) list_nil) else (let _a1_8=(u (u fm_term_reduce _a_1) _defs_3) in (let _b1_9=(u (u fm_term_reduce _b_2) _defs_3) in (let _ah_10=(u (u (u (u (u fm_term_serialize _a1_8) _lv_4) _lv_4) bits_o) bits_e) in (let _bh_11=(u (u (u (u (u fm_term_serialize _b1_9) _lv_4) _lv_4) bits_i) bits_e) in (let _5013 = (u (u bits_eql _ah_10) _bh_11) in (if _5013 then (u (u fm_check_result (u maybe_some bool_true)) list_nil) else (let _id_12=(u (u bits_concat _ah_10) _bh_11) in (let _5014 = (u (u set_has _id_12) _seen_5) in (if _5014 then (let _5015 = (u (u fm_term_equal_extra_holes _a_1) _b_2) in (case _5015 of {(0,f) -> u f (\_5016 _5017-> (let _5018 = _5016 in (case _5018 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5017)); (1,f) -> u f (\_5019-> (let _5020 = (u (u fm_check_result (u maybe_some bool_true)) list_nil) in (case _5020 of {(0,f) -> u f (\_5021 _5022-> (u (u fm_check_result _5021) (u (u list_concat _5017) _5022))); }))); }))); })) else (let _5023 = _a1_8 in (case _5023 of {(0,f) -> u f (\_5024 _5025-> (let _5026 = _b1_9 in (case _5026 of {(0,f) -> u f (\_5027 _5028-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5029-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5030 _5031 _5032 _5033 _5034-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (4,f) -> u f (\_5035 _5036-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (5,f) -> u f (\_5037 _5038-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (6,f) -> u f (\_5039 _5040 _5041-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (7,f) -> u f (\_5042 _5043 _5044-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5045 _5046 _5047-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5048 _5049 _5050-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5051-> (u (u fm_term_equal_hole _5051) _a_1)); (11,f) -> u f (\_5052-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5053-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5054-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5055 _5056 _5057 _5058 _5059 _5060-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5061 _5062-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); (1,f) -> u f (\_5063-> (let _5064 = _b1_9 in (case _5064 of {(0,f) -> u f (\_5065 _5066-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5067-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5068 _5069 _5070 _5071 _5072-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (4,f) -> u f (\_5073 _5074-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (5,f) -> u f (\_5075 _5076-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (6,f) -> u f (\_5077 _5078 _5079-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (7,f) -> u f (\_5080 _5081 _5082-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5083 _5084 _5085-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5086 _5087 _5088-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5089-> (u (u fm_term_equal_hole _5089) _a_1)); (11,f) -> u f (\_5090-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5091-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5092-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5093 _5094 _5095 _5096 _5097 _5098-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5099 _5100-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); (2,f) -> u f ((let _5101 = _b1_9 in (case _5101 of {(0,f) -> u f (\_5102 _5103-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5104-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5105 _5106 _5107 _5108 _5109-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (4,f) -> u f (\_5110 _5111-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (5,f) -> u f (\_5112 _5113-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (6,f) -> u f (\_5114 _5115 _5116-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (7,f) -> u f (\_5117 _5118 _5119-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5120 _5121 _5122-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5123 _5124 _5125-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5126-> (u (u fm_term_equal_hole _5126) _a_1)); (11,f) -> u f (\_5127-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5128-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5129-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5130 _5131 _5132 _5133 _5134 _5135-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5136 _5137-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); (3,f) -> u f (\_5138 _5139 _5140 _5141 _5142-> (let _5143 = _b1_9 in (case _5143 of {(0,f) -> u f (\_5144 _5145-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5146-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5147 _5148 _5149 _5150 _5151-> (let _seen_23=(u (u set_set _id_12) _seen_5) in (let _a1_body_24=(u (u _5142 (u (u fm_term_var _5139) _lv_4)) (u (u fm_term_var _5140) (u nat_succ _lv_4))) in (let _b1_body_25=(u (u _5151 (u (u fm_term_var _5148) _lv_4)) (u (u fm_term_var _5149) (u nat_succ _lv_4))) in (let _eq_self_26=(((_5139::String) == _5148)) in (let _eq_eras_27=(u (u bool_eql _5138) _5147) in (let _5152 = ((_eq_self_26 && _eq_eras_27)) in (if _5152 then (let _5153 = (u (u (u (u (u fm_term_equal _5141) _5150) _defs_3) _lv_4) _seen_23) in (case _5153 of {(0,f) -> u f (\_5154 _5155-> (let _5156 = _5154 in (case _5156 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5155)); (1,f) -> u f (\_5157-> (let _5158 = (let _5159 = (u (u (u (u (u fm_term_equal _a1_body_24) _b1_body_25) _defs_3) (u nat_succ (u nat_succ _lv_4))) _seen_23) in (case _5159 of {(0,f) -> u f (\_5160 _5161-> (let _5162 = _5160 in (case _5162 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5161)); (1,f) -> u f (\_5163-> (let _5164 = (u (u fm_check_result (u maybe_some ((_5157 && _5163)))) list_nil) in (case _5164 of {(0,f) -> u f (\_5165 _5166-> (u (u fm_check_result _5165) (u (u list_concat _5161) _5166))); }))); }))); })) in (case _5158 of {(0,f) -> u f (\_5167 _5168-> (u (u fm_check_result _5167) (u (u list_concat _5155) _5168))); }))); }))); })) else (u (u fm_check_result (u maybe_some bool_false)) list_nil))))))))); (4,f) -> u f (\_5169 _5170-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (5,f) -> u f (\_5171 _5172-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (6,f) -> u f (\_5173 _5174 _5175-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (7,f) -> u f (\_5176 _5177 _5178-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5179 _5180 _5181-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5182 _5183 _5184-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5185-> (u (u fm_term_equal_hole _5185) _a_1)); (11,f) -> u f (\_5186-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5187-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5188-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5189 _5190 _5191 _5192 _5193 _5194-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5195 _5196-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); (4,f) -> u f (\_5197 _5198-> (let _5199 = _b1_9 in (case _5199 of {(0,f) -> u f (\_5200 _5201-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5202-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5203 _5204 _5205 _5206 _5207-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (4,f) -> u f (\_5208 _5209-> (let _seen_17=(u (u set_set _id_12) _seen_5) in (let _a1_body_18=(u _5198 (u (u fm_term_var _5197) _lv_4)) in (let _b1_body_19=(u _5209 (u (u fm_term_var _5208) _lv_4)) in (let _5210 = (u (u (u (u (u fm_term_equal _a1_body_18) _b1_body_19) _defs_3) (u nat_succ _lv_4)) _seen_17) in (case _5210 of {(0,f) -> u f (\_5211 _5212-> (let _5213 = _5211 in (case _5213 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5212)); (1,f) -> u f (\_5214-> (let _5215 = (u (u fm_check_result (u maybe_some _5214)) list_nil) in (case _5215 of {(0,f) -> u f (\_5216 _5217-> (u (u fm_check_result _5216) (u (u list_concat _5212) _5217))); }))); }))); })))))); (5,f) -> u f (\_5218 _5219-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (6,f) -> u f (\_5220 _5221 _5222-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (7,f) -> u f (\_5223 _5224 _5225-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5226 _5227 _5228-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5229 _5230 _5231-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5232-> (u (u fm_term_equal_hole _5232) _a_1)); (11,f) -> u f (\_5233-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5234-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5235-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5236 _5237 _5238 _5239 _5240 _5241-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5242 _5243-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); (5,f) -> u f (\_5244 _5245-> (let _5246 = _b1_9 in (case _5246 of {(0,f) -> u f (\_5247 _5248-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5249-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5250 _5251 _5252 _5253 _5254-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (4,f) -> u f (\_5255 _5256-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (5,f) -> u f (\_5257 _5258-> (let _seen_17=(u (u set_set _id_12) _seen_5) in (let _5259 = (u (u (u (u (u fm_term_equal _5244) _5257) _defs_3) _lv_4) _seen_17) in (case _5259 of {(0,f) -> u f (\_5260 _5261-> (let _5262 = _5260 in (case _5262 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5261)); (1,f) -> u f (\_5263-> (let _5264 = (let _5265 = (u (u (u (u (u fm_term_equal _5245) _5258) _defs_3) _lv_4) _seen_17) in (case _5265 of {(0,f) -> u f (\_5266 _5267-> (let _5268 = _5266 in (case _5268 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5267)); (1,f) -> u f (\_5269-> (let _5270 = (u (u fm_check_result (u maybe_some ((_5263 && _5269)))) list_nil) in (case _5270 of {(0,f) -> u f (\_5271 _5272-> (u (u fm_check_result _5271) (u (u list_concat _5267) _5272))); }))); }))); })) in (case _5264 of {(0,f) -> u f (\_5273 _5274-> (u (u fm_check_result _5273) (u (u list_concat _5261) _5274))); }))); }))); })))); (6,f) -> u f (\_5275 _5276 _5277-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (7,f) -> u f (\_5278 _5279 _5280-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5281 _5282 _5283-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5284 _5285 _5286-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5287-> (u (u fm_term_equal_hole _5287) _a_1)); (11,f) -> u f (\_5288-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5289-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5290-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5291 _5292 _5293 _5294 _5295 _5296-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5297 _5298-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); (6,f) -> u f (\_5299 _5300 _5301-> (let _5302 = _b1_9 in (case _5302 of {(0,f) -> u f (\_5303 _5304-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5305-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5306 _5307 _5308 _5309 _5310-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (4,f) -> u f (\_5311 _5312-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (5,f) -> u f (\_5313 _5314-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (6,f) -> u f (\_5315 _5316 _5317-> (let _seen_19=(u (u set_set _id_12) _seen_5) in (let _a1_body_20=(u _5301 (u (u fm_term_var _5299) _lv_4)) in (let _b1_body_21=(u _5317 (u (u fm_term_var _5315) _lv_4)) in (let _5318 = (u (u (u (u (u fm_term_equal _5300) _5316) _defs_3) _lv_4) _seen_19) in (case _5318 of {(0,f) -> u f (\_5319 _5320-> (let _5321 = _5319 in (case _5321 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5320)); (1,f) -> u f (\_5322-> (let _5323 = (let _5324 = (u (u (u (u (u fm_term_equal _a1_body_20) _b1_body_21) _defs_3) (u nat_succ _lv_4)) _seen_19) in (case _5324 of {(0,f) -> u f (\_5325 _5326-> (let _5327 = _5325 in (case _5327 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5326)); (1,f) -> u f (\_5328-> (let _5329 = (u (u fm_check_result (u maybe_some ((_5322 && _5328)))) list_nil) in (case _5329 of {(0,f) -> u f (\_5330 _5331-> (u (u fm_check_result _5330) (u (u list_concat _5326) _5331))); }))); }))); })) in (case _5323 of {(0,f) -> u f (\_5332 _5333-> (u (u fm_check_result _5332) (u (u list_concat _5320) _5333))); }))); }))); })))))); (7,f) -> u f (\_5334 _5335 _5336-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5337 _5338 _5339-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5340 _5341 _5342-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5343-> (u (u fm_term_equal_hole _5343) _a_1)); (11,f) -> u f (\_5344-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5345-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5346-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5347 _5348 _5349 _5350 _5351 _5352-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5353 _5354-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); (7,f) -> u f (\_5355 _5356 _5357-> (let _5358 = _b1_9 in (case _5358 of {(0,f) -> u f (\_5359 _5360-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5361-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5362 _5363 _5364 _5365 _5366-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (4,f) -> u f (\_5367 _5368-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (5,f) -> u f (\_5369 _5370-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (6,f) -> u f (\_5371 _5372 _5373-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (7,f) -> u f (\_5374 _5375 _5376-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5377 _5378 _5379-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5380 _5381 _5382-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5383-> (u (u fm_term_equal_hole _5383) _a_1)); (11,f) -> u f (\_5384-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5385-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5386-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5387 _5388 _5389 _5390 _5391 _5392-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5393 _5394-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); (8,f) -> u f (\_5395 _5396 _5397-> (let _5398 = _b1_9 in (case _5398 of {(0,f) -> u f (\_5399 _5400-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5401-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5402 _5403 _5404 _5405 _5406-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (4,f) -> u f (\_5407 _5408-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (5,f) -> u f (\_5409 _5410-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (6,f) -> u f (\_5411 _5412 _5413-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (7,f) -> u f (\_5414 _5415 _5416-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5417 _5418 _5419-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5420 _5421 _5422-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5423-> (u (u fm_term_equal_hole _5423) _a_1)); (11,f) -> u f (\_5424-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5425-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5426-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5427 _5428 _5429 _5430 _5431 _5432-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5433 _5434-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); (9,f) -> u f (\_5435 _5436 _5437-> (let _5438 = _b1_9 in (case _5438 of {(0,f) -> u f (\_5439 _5440-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5441-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5442 _5443 _5444 _5445 _5446-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (4,f) -> u f (\_5447 _5448-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (5,f) -> u f (\_5449 _5450-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (6,f) -> u f (\_5451 _5452 _5453-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (7,f) -> u f (\_5454 _5455 _5456-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5457 _5458 _5459-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5460 _5461 _5462-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5463-> (u (u fm_term_equal_hole _5463) _a_1)); (11,f) -> u f (\_5464-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5465-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5466-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5467 _5468 _5469 _5470 _5471 _5472-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5473 _5474-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); (10,f) -> u f (\_5475-> (u (u fm_term_equal_hole _5475) _b_2)); (11,f) -> u f (\_5476-> (let _5477 = _b1_9 in (case _5477 of {(0,f) -> u f (\_5478 _5479-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5480-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5481 _5482 _5483 _5484 _5485-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (4,f) -> u f (\_5486 _5487-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (5,f) -> u f (\_5488 _5489-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (6,f) -> u f (\_5490 _5491 _5492-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (7,f) -> u f (\_5493 _5494 _5495-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5496 _5497 _5498-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5499 _5500 _5501-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5502-> (u (u fm_term_equal_hole _5502) _a_1)); (11,f) -> u f (\_5503-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5504-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5505-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5506 _5507 _5508 _5509 _5510 _5511-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5512 _5513-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); (12,f) -> u f (\_5514-> (let _5515 = _b1_9 in (case _5515 of {(0,f) -> u f (\_5516 _5517-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5518-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5519 _5520 _5521 _5522 _5523-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (4,f) -> u f (\_5524 _5525-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (5,f) -> u f (\_5526 _5527-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (6,f) -> u f (\_5528 _5529 _5530-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (7,f) -> u f (\_5531 _5532 _5533-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5534 _5535 _5536-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5537 _5538 _5539-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5540-> (u (u fm_term_equal_hole _5540) _a_1)); (11,f) -> u f (\_5541-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5542-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5543-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5544 _5545 _5546 _5547 _5548 _5549-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5550 _5551-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); (13,f) -> u f (\_5552-> (let _5553 = _b1_9 in (case _5553 of {(0,f) -> u f (\_5554 _5555-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5556-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5557 _5558 _5559 _5560 _5561-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (4,f) -> u f (\_5562 _5563-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (5,f) -> u f (\_5564 _5565-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (6,f) -> u f (\_5566 _5567 _5568-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (7,f) -> u f (\_5569 _5570 _5571-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5572 _5573 _5574-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5575 _5576 _5577-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5578-> (u (u fm_term_equal_hole _5578) _a_1)); (11,f) -> u f (\_5579-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5580-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5581-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5582 _5583 _5584 _5585 _5586 _5587-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5588 _5589-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); (14,f) -> u f (\_5590 _5591 _5592 _5593 _5594 _5595-> (let _5596 = _b1_9 in (case _5596 of {(0,f) -> u f (\_5597 _5598-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5599-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5600 _5601 _5602 _5603 _5604-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (4,f) -> u f (\_5605 _5606-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (5,f) -> u f (\_5607 _5608-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (6,f) -> u f (\_5609 _5610 _5611-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (7,f) -> u f (\_5612 _5613 _5614-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5615 _5616 _5617-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5618 _5619 _5620-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5621-> (u (u fm_term_equal_hole _5621) _a_1)); (11,f) -> u f (\_5622-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5623-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5624-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5625 _5626 _5627 _5628 _5629 _5630-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5631 _5632-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); (15,f) -> u f (\_5633 _5634-> (let _5635 = _b1_9 in (case _5635 of {(0,f) -> u f (\_5636 _5637-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5638-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5639 _5640 _5641 _5642 _5643-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (4,f) -> u f (\_5644 _5645-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (5,f) -> u f (\_5646 _5647-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (6,f) -> u f (\_5648 _5649 _5650-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (7,f) -> u f (\_5651 _5652 _5653-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5654 _5655 _5656-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5657 _5658 _5659-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5660-> (u (u fm_term_equal_hole _5660) _a_1)); (11,f) -> u f (\_5661-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5662-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5663-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5664 _5665 _5666 _5667 _5668 _5669-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5670 _5671-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); }))))))))))))))))))))
set_new = map_new
fm_term_check = (\_term_1-> (\_type_2-> (\_defs_3-> (\_ctx_4-> (\_path_5-> (\_orig_6-> (let _5672 = (let _5673 = _term_1 in (case _5673 of {(0,f) -> u f (\_5674 _5675-> (let _5676 = (u (u list_at_last _5675) _ctx_4) in (case _5676 of {(0,f) -> u f ((u (u fm_check_result _type_2) (u (u list_cons (u (u fm_error_undefined_reference _orig_6) _5674)) list_nil))); (1,f) -> u f (\_5677-> (u (u fm_check_result (u maybe_some (let _5678 = _5677 in (case _5678 of {(0,f) -> u f (\_5679 _5680-> _5680); })))) list_nil)); }))); (1,f) -> u f (\_5681-> (let _5682 = (u (u fm_get _5681) _defs_3) in (case _5682 of {(0,f) -> u f ((u (u fm_check_result _type_2) (u (u list_cons (u (u fm_error_undefined_reference _orig_6) _5681)) list_nil))); (1,f) -> u f (\_5683-> (let _5684 = _5683 in (case _5684 of {(0,f) -> u f (\_5685 _5686 _5687 _5688 _5689 _5690-> (let _ref_name_15=_5687 in (let _ref_type_16=_5689 in (let _ref_term_17=_5688 in (let _ref_stat_18=_5690 in (let _5691 = _ref_stat_18 in (case _5691 of {(0,f) -> u f ((u (u fm_check_result (u maybe_some _ref_type_16)) (u (u list_cons (u fm_error_waiting _ref_name_15)) list_nil))); (1,f) -> u f ((u (u fm_check_result (u maybe_some _ref_type_16)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some _ref_type_16)) list_nil)); (3,f) -> u f (\_5692-> (u (u fm_check_result (u maybe_some _ref_type_16)) (u (u list_cons (u fm_error_indirect _ref_name_15)) list_nil))); }))))))); }))); }))); (2,f) -> u f ((u (u fm_check_result (u maybe_some fm_term_typ)) list_nil)); (3,f) -> u f (\_5693 _5694 _5695 _5696 _5697-> (let _ctx_size_12=(u list_length _ctx_4) in (let _self_var_13=(u (u fm_term_var _5694) _ctx_size_12) in (let _body_var_14=(u (u fm_term_var _5695) (u nat_succ _ctx_size_12)) in (let _body_ctx_15=(u (u list_cons (u (u pair_new _5695) _5696)) (u (u list_cons (u (u pair_new _5694) _term_1)) _ctx_4)) in (let _5698 = (u (u (u (u (u (u fm_term_check _5696) (u maybe_some fm_term_typ)) _defs_3) _ctx_4) (u fm_mpath_o _path_5)) _orig_6) in (case _5698 of {(0,f) -> u f (\_5699 _5700-> (let _5701 = _5699 in (case _5701 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5700)); (1,f) -> u f (\_5702-> (let _5703 = (let _5704 = (u (u (u (u (u (u fm_term_check (u (u _5697 _self_var_13) _body_var_14)) (u maybe_some fm_term_typ)) _defs_3) _body_ctx_15) (u fm_mpath_i _path_5)) _orig_6) in (case _5704 of {(0,f) -> u f (\_5705 _5706-> (let _5707 = _5705 in (case _5707 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5706)); (1,f) -> u f (\_5708-> (let _5709 = (u (u fm_check_result (u maybe_some fm_term_typ)) list_nil) in (case _5709 of {(0,f) -> u f (\_5710 _5711-> (u (u fm_check_result _5710) (u (u list_concat _5706) _5711))); }))); }))); })) in (case _5703 of {(0,f) -> u f (\_5712 _5713-> (u (u fm_check_result _5712) (u (u list_concat _5700) _5713))); }))); }))); }))))))); (4,f) -> u f (\_5714 _5715-> (let _5716 = _type_2 in (case _5716 of {(0,f) -> u f ((let _lam_type_9=(u fm_term_hol bits_e) in (let _lam_term_10=(u (u (u fm_term_ann bool_false) _term_1) _lam_type_9) in (u (u fm_check_result _type_2) (u (u list_cons (u (u fm_error_patch (u fm_mpath_to_bits _path_5)) _lam_term_10)) list_nil))))); (1,f) -> u f (\_5717-> (let _typv_10=(u (u fm_term_reduce _5717) _defs_3) in (let _5718 = _typv_10 in (case _5718 of {(0,f) -> u f (\_5719 _5720-> (let _expected_13=(u either_left "(function type)") in (let _detected_14=(u either_right _5717) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_13) _detected_14) _ctx_4)) list_nil))))); (1,f) -> u f (\_5721-> (let _expected_12=(u either_left "(function type)") in (let _detected_13=(u either_right _5717) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_12) _detected_13) _ctx_4)) list_nil))))); (2,f) -> u f ((let _expected_11=(u either_left "(function type)") in (let _detected_12=(u either_right _5717) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_11) _detected_12) _ctx_4)) list_nil))))); (3,f) -> u f (\_5722 _5723 _5724 _5725 _5726-> (let _ctx_size_16=(u list_length _ctx_4) in (let _self_var_17=_term_1 in (let _body_var_18=(u (u fm_term_var _5714) _ctx_size_16) in (let _body_typ_19=(u (u _5726 _self_var_17) _body_var_18) in (let _body_ctx_20=(u (u list_cons (u (u pair_new _5714) _5725)) _ctx_4) in (let _5727 = (u (u (u (u (u (u fm_term_check (u _5715 _body_var_18)) (u maybe_some _body_typ_19)) _defs_3) _body_ctx_20) (u fm_mpath_o _path_5)) _orig_6) in (case _5727 of {(0,f) -> u f (\_5728 _5729-> (let _5730 = _5728 in (case _5730 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5729)); (1,f) -> u f (\_5731-> (let _5732 = (u (u fm_check_result (u maybe_some _5717)) list_nil) in (case _5732 of {(0,f) -> u f (\_5733 _5734-> (u (u fm_check_result _5733) (u (u list_concat _5729) _5734))); }))); }))); })))))))); (4,f) -> u f (\_5735 _5736-> (let _expected_13=(u either_left "(function type)") in (let _detected_14=(u either_right _5717) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_13) _detected_14) _ctx_4)) list_nil))))); (5,f) -> u f (\_5737 _5738-> (let _expected_13=(u either_left "(function type)") in (let _detected_14=(u either_right _5717) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_13) _detected_14) _ctx_4)) list_nil))))); (6,f) -> u f (\_5739 _5740 _5741-> (let _expected_14=(u either_left "(function type)") in (let _detected_15=(u either_right _5717) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_14) _detected_15) _ctx_4)) list_nil))))); (7,f) -> u f (\_5742 _5743 _5744-> (let _expected_14=(u either_left "(function type)") in (let _detected_15=(u either_right _5717) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_14) _detected_15) _ctx_4)) list_nil))))); (8,f) -> u f (\_5745 _5746 _5747-> (let _expected_14=(u either_left "(function type)") in (let _detected_15=(u either_right _5717) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_14) _detected_15) _ctx_4)) list_nil))))); (9,f) -> u f (\_5748 _5749 _5750-> (let _expected_14=(u either_left "(function type)") in (let _detected_15=(u either_right _5717) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_14) _detected_15) _ctx_4)) list_nil))))); (10,f) -> u f (\_5751-> (let _expected_12=(u either_left "(function type)") in (let _detected_13=(u either_right _5717) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_12) _detected_13) _ctx_4)) list_nil))))); (11,f) -> u f (\_5752-> (let _expected_12=(u either_left "(function type)") in (let _detected_13=(u either_right _5717) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_12) _detected_13) _ctx_4)) list_nil))))); (12,f) -> u f (\_5753-> (let _expected_12=(u either_left "(function type)") in (let _detected_13=(u either_right _5717) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_12) _detected_13) _ctx_4)) list_nil))))); (13,f) -> u f (\_5754-> (let _expected_12=(u either_left "(function type)") in (let _detected_13=(u either_right _5717) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_12) _detected_13) _ctx_4)) list_nil))))); (14,f) -> u f (\_5755 _5756 _5757 _5758 _5759 _5760-> (let _expected_17=(u either_left "(function type)") in (let _detected_18=(u either_right _5717) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_17) _detected_18) _ctx_4)) list_nil))))); (15,f) -> u f (\_5761 _5762-> (let _expected_13=(u either_left "(function type)") in (let _detected_14=(u either_right _5717) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_13) _detected_14) _ctx_4)) list_nil))))); })))); }))); (5,f) -> u f (\_5763 _5764-> (let _5765 = (u (u (u (u (u (u fm_term_check _5763) maybe_none) _defs_3) _ctx_4) (u fm_mpath_o _path_5)) _orig_6) in (case _5765 of {(0,f) -> u f (\_5766 _5767-> (let _5768 = _5766 in (case _5768 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5767)); (1,f) -> u f (\_5769-> (let _func_typ_12=(u (u fm_term_reduce _5769) _defs_3) in (let _5770 = (let _5771 = _func_typ_12 in (case _5771 of {(0,f) -> u f (\_5772 _5773-> (let _expected_15=(u either_left "(function type)") in (let _detected_16=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_15) _detected_16) _ctx_4)) list_nil))))); (1,f) -> u f (\_5774-> (let _expected_14=(u either_left "(function type)") in (let _detected_15=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_14) _detected_15) _ctx_4)) list_nil))))); (2,f) -> u f ((let _expected_13=(u either_left "(function type)") in (let _detected_14=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_13) _detected_14) _ctx_4)) list_nil))))); (3,f) -> u f (\_5775 _5776 _5777 _5778 _5779-> (let _5780 = (u (u (u (u (u (u fm_term_check _5764) (u maybe_some _5778)) _defs_3) _ctx_4) (u fm_mpath_i _path_5)) _orig_6) in (case _5780 of {(0,f) -> u f (\_5781 _5782-> (let _5783 = _5781 in (case _5783 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5782)); (1,f) -> u f (\_5784-> (let _5785 = (u (u fm_check_result (u maybe_some (u (u _5779 _5763) _5764))) list_nil) in (case _5785 of {(0,f) -> u f (\_5786 _5787-> (u (u fm_check_result _5786) (u (u list_concat _5782) _5787))); }))); }))); }))); (4,f) -> u f (\_5788 _5789-> (let _expected_15=(u either_left "(function type)") in (let _detected_16=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_15) _detected_16) _ctx_4)) list_nil))))); (5,f) -> u f (\_5790 _5791-> (let _expected_15=(u either_left "(function type)") in (let _detected_16=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_15) _detected_16) _ctx_4)) list_nil))))); (6,f) -> u f (\_5792 _5793 _5794-> (let _expected_16=(u either_left "(function type)") in (let _detected_17=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_16) _detected_17) _ctx_4)) list_nil))))); (7,f) -> u f (\_5795 _5796 _5797-> (let _expected_16=(u either_left "(function type)") in (let _detected_17=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_16) _detected_17) _ctx_4)) list_nil))))); (8,f) -> u f (\_5798 _5799 _5800-> (let _expected_16=(u either_left "(function type)") in (let _detected_17=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_16) _detected_17) _ctx_4)) list_nil))))); (9,f) -> u f (\_5801 _5802 _5803-> (let _expected_16=(u either_left "(function type)") in (let _detected_17=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_16) _detected_17) _ctx_4)) list_nil))))); (10,f) -> u f (\_5804-> (let _expected_14=(u either_left "(function type)") in (let _detected_15=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_14) _detected_15) _ctx_4)) list_nil))))); (11,f) -> u f (\_5805-> (let _expected_14=(u either_left "(function type)") in (let _detected_15=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_14) _detected_15) _ctx_4)) list_nil))))); (12,f) -> u f (\_5806-> (let _expected_14=(u either_left "(function type)") in (let _detected_15=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_14) _detected_15) _ctx_4)) list_nil))))); (13,f) -> u f (\_5807-> (let _expected_14=(u either_left "(function type)") in (let _detected_15=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_14) _detected_15) _ctx_4)) list_nil))))); (14,f) -> u f (\_5808 _5809 _5810 _5811 _5812 _5813-> (let _expected_19=(u either_left "(function type)") in (let _detected_20=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_19) _detected_20) _ctx_4)) list_nil))))); (15,f) -> u f (\_5814 _5815-> (let _expected_15=(u either_left "(function type)") in (let _detected_16=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_15) _detected_16) _ctx_4)) list_nil))))); })) in (case _5770 of {(0,f) -> u f (\_5816 _5817-> (u (u fm_check_result _5816) (u (u list_concat _5767) _5817))); })))); }))); }))); (6,f) -> u f (\_5818 _5819 _5820-> (let _ctx_size_10=(u list_length _ctx_4) in (let _5821 = (u (u (u (u (u (u fm_term_check _5819) maybe_none) _defs_3) _ctx_4) (u fm_mpath_o _path_5)) _orig_6) in (case _5821 of {(0,f) -> u f (\_5822 _5823-> (let _5824 = _5822 in (case _5824 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5823)); (1,f) -> u f (\_5825-> (let _body_val_14=(u _5820 (u (u fm_term_var _5818) _ctx_size_10)) in (let _body_ctx_15=(u (u list_cons (u (u pair_new _5818) _5825)) _ctx_4) in (let _5826 = (let _5827 = (u (u (u (u (u (u fm_term_check _body_val_14) _type_2) _defs_3) _body_ctx_15) (u fm_mpath_i _path_5)) _orig_6) in (case _5827 of {(0,f) -> u f (\_5828 _5829-> (let _5830 = _5828 in (case _5830 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5829)); (1,f) -> u f (\_5831-> (let _5832 = (u (u fm_check_result (u maybe_some _5831)) list_nil) in (case _5832 of {(0,f) -> u f (\_5833 _5834-> (u (u fm_check_result _5833) (u (u list_concat _5829) _5834))); }))); }))); })) in (case _5826 of {(0,f) -> u f (\_5835 _5836-> (u (u fm_check_result _5835) (u (u list_concat _5823) _5836))); }))))); }))); })))); (7,f) -> u f (\_5837 _5838 _5839-> (let _ctx_size_10=(u list_length _ctx_4) in (let _5840 = (u (u (u (u (u (u fm_term_check _5838) maybe_none) _defs_3) _ctx_4) (u fm_mpath_o _path_5)) _orig_6) in (case _5840 of {(0,f) -> u f (\_5841 _5842-> (let _5843 = _5841 in (case _5843 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5842)); (1,f) -> u f (\_5844-> (let _body_val_14=(u _5839 (u (u (u fm_term_ann bool_true) _5838) _5844)) in (let _body_ctx_15=(u (u list_cons (u (u pair_new _5837) _5844)) _ctx_4) in (let _5845 = (let _5846 = (u (u (u (u (u (u fm_term_check _body_val_14) _type_2) _defs_3) _body_ctx_15) (u fm_mpath_i _path_5)) _orig_6) in (case _5846 of {(0,f) -> u f (\_5847 _5848-> (let _5849 = _5847 in (case _5849 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5848)); (1,f) -> u f (\_5850-> (let _5851 = (u (u fm_check_result (u maybe_some _5850)) list_nil) in (case _5851 of {(0,f) -> u f (\_5852 _5853-> (u (u fm_check_result _5852) (u (u list_concat _5848) _5853))); }))); }))); })) in (case _5845 of {(0,f) -> u f (\_5854 _5855-> (u (u fm_check_result _5854) (u (u list_concat _5842) _5855))); }))))); }))); })))); (8,f) -> u f (\_5856 _5857 _5858-> (let _5859 = _5856 in (if _5859 then (u (u fm_check_result (u maybe_some _5858)) list_nil) else (let _5860 = (u (u (u (u (u (u fm_term_check _5857) (u maybe_some _5858)) _defs_3) _ctx_4) (u fm_mpath_o _path_5)) _orig_6) in (case _5860 of {(0,f) -> u f (\_5861 _5862-> (let _5863 = _5861 in (case _5863 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5862)); (1,f) -> u f (\_5864-> (let _5865 = (let _5866 = (u (u (u (u (u (u fm_term_check _5858) (u maybe_some fm_term_typ)) _defs_3) _ctx_4) (u fm_mpath_i _path_5)) _orig_6) in (case _5866 of {(0,f) -> u f (\_5867 _5868-> (let _5869 = _5867 in (case _5869 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5868)); (1,f) -> u f (\_5870-> (let _5871 = (u (u fm_check_result (u maybe_some _5858)) list_nil) in (case _5871 of {(0,f) -> u f (\_5872 _5873-> (u (u fm_check_result _5872) (u (u list_concat _5868) _5873))); }))); }))); })) in (case _5865 of {(0,f) -> u f (\_5874 _5875-> (u (u fm_check_result _5874) (u (u list_concat _5862) _5875))); }))); }))); }))))); (9,f) -> u f (\_5876 _5877 _5878-> (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u (u fm_error_show_goal _5876) _5877) _5878) _type_2) _ctx_4)) list_nil))); (10,f) -> u f (\_5879-> (u (u fm_check_result _type_2) list_nil)); (11,f) -> u f (\_5880-> (u (u fm_check_result (u maybe_some (u fm_term_ref "Nat"))) list_nil)); (12,f) -> u f (\_5881-> (u (u fm_check_result (u maybe_some (u fm_term_ref "Char"))) list_nil)); (13,f) -> u f (\_5882-> (u (u fm_check_result (u maybe_some (u fm_term_ref "String"))) list_nil)); (14,f) -> u f (\_5883 _5884 _5885 _5886 _5887 _5888-> (let _expr_13=_5884 in (let _5889 = (u (u (u (u (u (u fm_term_check _expr_13) maybe_none) _defs_3) _ctx_4) (u fm_mpath_o _path_5)) _orig_6) in (case _5889 of {(0,f) -> u f (\_5890 _5891-> (let _5892 = _5890 in (case _5892 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5891)); (1,f) -> u f (\_5893-> (let _dsug_17=(let _5894 = _5888 in (case _5894 of {(0,f) -> u f ((let _moti_17=(let _5895 = _type_2 in (case _5895 of {(0,f) -> u f ((u fm_term_hol bits_e)); (1,f) -> u f (\_5896-> (let _size_18=(u list_length _ctx_4) in (let _typv_19=(u (u fm_term_normalize _5896) map_new) in (let _moti_20=(u (u (u (u (u (u fm_smartmotive_make _5885) _5884) _5893) _typv_19) _size_18) _defs_3) in _moti_20)))); })) in (u maybe_some (u (u (u (u (u (u fm_term_cse _5883) _5884) _5885) _5886) _5887) (u maybe_some _moti_17))))); (1,f) -> u f (\_5897-> (u (u (u (u (u (u (u (u fm_term_desugar_cse _5884) _5885) _5886) _5887) _5897) _5893) _defs_3) _ctx_4)); })) in (let _5898 = (let _5899 = _dsug_17 in (case _5899 of {(0,f) -> u f ((u (u fm_check_result _type_2) (u (u list_cons (u (u (u fm_error_cant_infer _orig_6) _term_1) _ctx_4)) list_nil))); (1,f) -> u f (\_5900-> (u (u fm_check_result _type_2) (u (u list_cons (u (u fm_error_patch (u fm_mpath_to_bits _path_5)) _5900)) list_nil))); })) in (case _5898 of {(0,f) -> u f (\_5901 _5902-> (u (u fm_check_result _5901) (u (u list_concat _5891) _5902))); })))); }))); })))); (15,f) -> u f (\_5903 _5904-> (u (u (u (u (u (u fm_term_check _5904) _type_2) _defs_3) _ctx_4) _path_5) (u maybe_some _5903))); })) in (case _5672 of {(0,f) -> u f (\_5905 _5906-> (let _5907 = _5905 in (case _5907 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5906)); (1,f) -> u f (\_5908-> (let _5909 = (let _5910 = _type_2 in (case _5910 of {(0,f) -> u f ((u (u fm_check_result (u maybe_some _5908)) list_nil)); (1,f) -> u f (\_5911-> (let _5912 = (u (u (u (u (u fm_term_equal _5911) _5908) _defs_3) (u list_length _ctx_4)) set_new) in (case _5912 of {(0,f) -> u f (\_5913 _5914-> (let _5915 = _5913 in (case _5915 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5914)); (1,f) -> u f (\_5916-> (let _5917 = (let _5918 = _5916 in (if _5918 then (u (u fm_check_result (u maybe_some _5911)) list_nil) else (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) (u either_right _5911)) (u either_right _5908)) _ctx_4)) list_nil)))) in (case _5917 of {(0,f) -> u f (\_5919 _5920-> (u (u fm_check_result _5919) (u (u list_concat _5914) _5920))); }))); }))); }))); })) in (case _5909 of {(0,f) -> u f (\_5921 _5922-> (u (u fm_check_result _5921) (u (u list_concat _5906) _5922))); }))); }))); }))))))))
fm_path_nil = (\_x_1-> _x_1)
fm_mpath_nil = (u maybe_some fm_path_nil)
list_is_empty = (\_list_2-> (let _5923 = _list_2 in (case _5923 of {(0,f) -> u f (bool_true); (1,f) -> u f (\_5924 _5925-> bool_false); })))
fm_term_patch_at = (\_path_1-> (\_term_2-> (\_fn_3-> (let _5926 = _term_2 in (case _5926 of {(0,f) -> u f (\_5927 _5928-> (let _5929 = _path_1 in (case _5929 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_5930-> _term_2); (2,f) -> u f (\_5931-> _term_2); }))); (1,f) -> u f (\_5932-> (let _5933 = _path_1 in (case _5933 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_5934-> _term_2); (2,f) -> u f (\_5935-> _term_2); }))); (2,f) -> u f ((let _5936 = _path_1 in (case _5936 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_5937-> _term_2); (2,f) -> u f (\_5938-> _term_2); }))); (3,f) -> u f (\_5939 _5940 _5941 _5942 _5943-> (let _5944 = _path_1 in (case _5944 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_5945-> (u (u (u (u (u fm_term_all _5939) _5940) _5941) (u (u (u fm_term_patch_at _5945) _5942) _fn_3)) _5943)); (2,f) -> u f (\_5946-> (u (u (u (u (u fm_term_all _5939) _5940) _5941) _5942) (\_s_10-> (\_x_11-> (u (u (u fm_term_patch_at _5946) (u (u _5943 _s_10) _x_11)) _fn_3))))); }))); (4,f) -> u f (\_5947 _5948-> (let _5949 = _path_1 in (case _5949 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_5950-> (u (u fm_term_lam _5947) (\_x_7-> (u (u (u fm_term_patch_at (u bits_tail _path_1)) (u _5948 _x_7)) _fn_3)))); (2,f) -> u f (\_5951-> (u (u fm_term_lam _5947) (\_x_7-> (u (u (u fm_term_patch_at (u bits_tail _path_1)) (u _5948 _x_7)) _fn_3)))); }))); (5,f) -> u f (\_5952 _5953-> (let _5954 = _path_1 in (case _5954 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_5955-> (u (u fm_term_app (u (u (u fm_term_patch_at _5955) _5952) _fn_3)) _5953)); (2,f) -> u f (\_5956-> (u (u fm_term_app _5952) (u (u (u fm_term_patch_at _5956) _5953) _fn_3))); }))); (6,f) -> u f (\_5957 _5958 _5959-> (let _5960 = _path_1 in (case _5960 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_5961-> (u (u (u fm_term_let _5957) (u (u (u fm_term_patch_at _5961) _5958) _fn_3)) _5959)); (2,f) -> u f (\_5962-> (u (u (u fm_term_let _5957) _5958) (\_x_8-> (u (u (u fm_term_patch_at _5962) (u _5959 _x_8)) _fn_3)))); }))); (7,f) -> u f (\_5963 _5964 _5965-> (let _5966 = _path_1 in (case _5966 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_5967-> (u (u (u fm_term_def _5963) (u (u (u fm_term_patch_at _5967) _5964) _fn_3)) _5965)); (2,f) -> u f (\_5968-> (u (u (u fm_term_def _5963) _5964) (\_x_8-> (u (u (u fm_term_patch_at _5968) (u _5965 _x_8)) _fn_3)))); }))); (8,f) -> u f (\_5969 _5970 _5971-> (let _5972 = _path_1 in (case _5972 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_5973-> (u (u (u fm_term_ann _5969) (u (u (u fm_term_patch_at _5973) _5970) _fn_3)) _5971)); (2,f) -> u f (\_5974-> (u (u (u fm_term_ann _5969) _5970) (u (u (u fm_term_patch_at _5974) _5971) _fn_3))); }))); (9,f) -> u f (\_5975 _5976 _5977-> (let _5978 = _path_1 in (case _5978 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_5979-> _term_2); (2,f) -> u f (\_5980-> _term_2); }))); (10,f) -> u f (\_5981-> (let _5982 = _path_1 in (case _5982 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_5983-> _term_2); (2,f) -> u f (\_5984-> _term_2); }))); (11,f) -> u f (\_5985-> (let _5986 = _path_1 in (case _5986 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_5987-> _term_2); (2,f) -> u f (\_5988-> _term_2); }))); (12,f) -> u f (\_5989-> (let _5990 = _path_1 in (case _5990 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_5991-> _term_2); (2,f) -> u f (\_5992-> _term_2); }))); (13,f) -> u f (\_5993-> (let _5994 = _path_1 in (case _5994 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_5995-> _term_2); (2,f) -> u f (\_5996-> _term_2); }))); (14,f) -> u f (\_5997 _5998 _5999 _6000 _6001 _6002-> (let _6003 = _path_1 in (case _6003 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_6004-> _term_2); (2,f) -> u f (\_6005-> _term_2); }))); (15,f) -> u f (\_6006 _6007-> (u (u fm_term_ori _6006) (u (u (u fm_term_patch_at _path_1) _6007) _fn_3))); })))))
fm_synth_fix = (\_file_1-> (\_code_2-> (\_name_3-> (\_term_4-> (\_type_5-> (\_defs_6-> (\_errs_7-> (\_fixd_8-> (let _6008 = _errs_7 in (case _6008 of {(0,f) -> u f ((let _6009 = _fixd_8 in (if _6009 then (let _type_9=(u (u (u fm_term_bind list_nil) (\_x_9-> (u bits_i _x_9))) _type_5) in (let _term_10=(u (u (u fm_term_bind list_nil) (\_x_10-> (u bits_o _x_10))) _term_4) in (let _defs_11=(u (u (u fm_set _name_3) (u (u (u (u (u (u fm_def_new _file_1) _code_2) _name_3) _term_10) _type_9) fm_status_init)) _defs_6) in (u (u io_monad (\_m_bind_12-> (\_m_pure_13-> _m_pure_13))) (u maybe_some _defs_11))))) else (u (u io_monad (\_m_bind_9-> (\_m_pure_10-> _m_pure_10))) maybe_none)))); (1,f) -> u f (\_6010 _6011-> (let _6012 = _6010 in (case _6012 of {(0,f) -> u f (\_6013 _6014 _6015 _6016-> (u (u (u (u (u (u (u (u fm_synth_fix _file_1) _code_2) _name_3) _term_4) _type_5) _defs_6) _6011) _fixd_8)); (1,f) -> u f (\_6017 _6018 _6019 _6020 _6021-> (u (u (u (u (u (u (u (u fm_synth_fix _file_1) _code_2) _name_3) _term_4) _type_5) _defs_6) _6011) _fixd_8)); (2,f) -> u f (\_6022-> (u (u (u io_monad (\_m_bind_12-> (\_m_pure_13-> _m_bind_12))) (u (u fm_synth_one _6022) _defs_6)) (\_new_defs_12-> (let _6023 = _new_defs_12 in (case _6023 of {(0,f) -> u f ((u (u (u (u (u (u (u (u fm_synth_fix _file_1) _code_2) _name_3) _term_4) _type_5) _defs_6) _6011) _fixd_8)); (1,f) -> u f (\_6024-> (u (u (u (u (u (u (u (u fm_synth_fix _file_1) _code_2) _name_3) _term_4) _type_5) _6024) _6011) bool_true)); }))))); (3,f) -> u f (\_6025-> (u (u (u (u (u (u (u (u fm_synth_fix _file_1) _code_2) _name_3) _term_4) _type_5) _defs_6) _6011) _fixd_8)); (4,f) -> u f (\_6026 _6027-> (let _6028 = _6026 in (case _6028 of {(0,f) -> u f ((u (u io_monad (\_m_bind_13-> (\_m_pure_14-> _m_pure_14))) maybe_none)); (1,f) -> u f (\_6029-> (let _term_14=(u (u (u fm_term_patch_at _6029) _term_4) (\_x_14-> _6027)) in (u (u (u (u (u (u (u (u fm_synth_fix _file_1) _code_2) _name_3) _term_14) _type_5) _defs_6) _6011) bool_true))); (2,f) -> u f (\_6030-> (let _type_14=(u (u (u fm_term_patch_at _6030) _type_5) (\_x_14-> _6027)) in (u (u (u (u (u (u (u (u fm_synth_fix _file_1) _code_2) _name_3) _term_4) _type_14) _defs_6) _6011) bool_true))); }))); (5,f) -> u f (\_6031 _6032-> (u (u (u io_monad (\_m_bind_13-> (\_m_pure_14-> _m_bind_13))) (u (u fm_synth_one _6032) _defs_6)) (\_new_defs_13-> (let _6033 = _new_defs_13 in (case _6033 of {(0,f) -> u f ((u (u (u (u (u (u (u (u fm_synth_fix _file_1) _code_2) _name_3) _term_4) _type_5) _defs_6) _6011) _fixd_8)); (1,f) -> u f (\_6034-> (u (u (u (u (u (u (u (u fm_synth_fix _file_1) _code_2) _name_3) _term_4) _type_5) _6034) _6011) bool_true)); }))))); (6,f) -> u f (\_6035 _6036 _6037-> (u (u (u (u (u (u (u (u fm_synth_fix _file_1) _code_2) _name_3) _term_4) _type_5) _defs_6) _6011) _fixd_8)); }))); }))))))))))
fm_status_fail = (\_errors_1-> (3,\t-> t _errors_1))
fm_synth_one = (\_name_1-> (\_defs_2-> (let _6038 = (u (u fm_get _name_1) _defs_2) in (case _6038 of {(0,f) -> u f ((u (u (u io_monad (\_m_bind_3-> (\_m_pure_4-> _m_bind_3))) (u (u fm_synth_load _name_1) _defs_2)) (\_loaded_3-> (let _6039 = _loaded_3 in (case _6039 of {(0,f) -> u f ((u (u io_monad (\_m_bind_4-> (\_m_pure_5-> _m_pure_5))) maybe_none)); (1,f) -> u f (\_6040-> (u (u fm_synth_one _name_1) _6040)); }))))); (1,f) -> u f (\_6041-> (let _6042 = _6041 in (case _6042 of {(0,f) -> u f (\_6043 _6044 _6045 _6046 _6047 _6048-> (let _file_10=_6043 in (let _code_11=_6044 in (let _name_12=_6045 in (let _term_13=_6046 in (let _type_14=_6047 in (let _stat_15=_6048 in (let _6049 = _stat_15 in (case _6049 of {(0,f) -> u f ((let _defs_16=(u (u (u fm_set _name_12) (u (u (u (u (u (u fm_def_new _file_10) _code_11) _name_12) _term_13) _type_14) fm_status_wait)) _defs_2) in (let _checked_17=(let _6050 = (u (u (u (u (u (u fm_term_check _type_14) (u maybe_some fm_term_typ)) _defs_16) list_nil) (u fm_mpath_i fm_mpath_nil)) maybe_none) in (case _6050 of {(0,f) -> u f (\_6051 _6052-> (let _6053 = _6051 in (case _6053 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _6052)); (1,f) -> u f (\_6054-> (let _6055 = (let _6056 = (u (u (u (u (u (u fm_term_check _term_13) (u maybe_some _type_14)) _defs_16) list_nil) (u fm_mpath_o fm_mpath_nil)) maybe_none) in (case _6056 of {(0,f) -> u f (\_6057 _6058-> (let _6059 = _6057 in (case _6059 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _6058)); (1,f) -> u f (\_6060-> (let _6061 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _6061 of {(0,f) -> u f (\_6062 _6063-> (u (u fm_check_result _6062) (u (u list_concat _6058) _6063))); }))); }))); })) in (case _6055 of {(0,f) -> u f (\_6064 _6065-> (u (u fm_check_result _6064) (u (u list_concat _6052) _6065))); }))); }))); })) in (let _6066 = _checked_17 in (case _6066 of {(0,f) -> u f (\_6067 _6068-> (let _6069 = (u list_is_empty _6068) in (if _6069 then (let _defs_20=(u (u (u (u (u (u (u fm_define _file_10) _code_11) _name_12) _term_13) _type_14) bool_true) _defs_16) in (u (u io_monad (\_m_bind_21-> (\_m_pure_22-> _m_pure_22))) (u maybe_some _defs_20))) else (u (u (u io_monad (\_m_bind_20-> (\_m_pure_21-> _m_bind_20))) (u (u (u (u (u (u (u (u fm_synth_fix _file_10) _code_11) _name_12) _term_13) _type_14) _defs_16) _6068) bool_false)) (\_fixed_20-> (let _6070 = _fixed_20 in (case _6070 of {(0,f) -> u f ((let _stat_21=(u fm_status_fail _6068) in (let _defs_22=(u (u (u fm_set _name_12) (u (u (u (u (u (u fm_def_new _file_10) _code_11) _name_12) _term_13) _type_14) _stat_21)) _defs_16) in (u (u io_monad (\_m_bind_23-> (\_m_pure_24-> _m_pure_24))) (u maybe_some _defs_22))))); (1,f) -> u f (\_6071-> (u (u fm_synth_one _name_12) _6071)); }))))))); }))))); (1,f) -> u f ((u (u io_monad (\_m_bind_16-> (\_m_pure_17-> _m_pure_17))) (u maybe_some _defs_2))); (2,f) -> u f ((u (u io_monad (\_m_bind_16-> (\_m_pure_17-> _m_pure_17))) (u maybe_some _defs_2))); (3,f) -> u f (\_6072-> (u (u io_monad (\_m_bind_17-> (\_m_pure_18-> _m_pure_18))) (u maybe_some _defs_2))); }))))))))); }))); }))))
map_map = (\_fn_3-> (\_map_4-> (let _6073 = _map_4 in (case _6073 of {(0,f) -> u f (map_new); (1,f) -> u f (\_6074 _6075 _6076-> (let _val_8=(let _6077 = _6074 in (case _6077 of {(0,f) -> u f (maybe_none); (1,f) -> u f (\_6078-> (u maybe_some (u _fn_3 _6078))); })) in (let _lft_9=(u (u map_map _fn_3) _6075) in (let _rgt_10=(u (u map_map _fn_3) _6076) in (u (u (u map_tie _val_8) _lft_9) _rgt_10))))); }))))
fm_term_inline_names = (let _inl_1=(u (u list_cons "Monad.pure") (u (u list_cons "Monad.bind") (u (u list_cons "Monad.new") (u (u list_cons "Parser.monad") (u (u list_cons "Parser.bind") (u (u list_cons "Parser.pure") (u (u list_cons "Fm.Check.pure") (u (u list_cons "Fm.Check.bind") (u (u list_cons "Fm.Check.monad") (u (u list_cons "Fm.Check.value") (u (u list_cons "Fm.Check.none") list_nil))))))))))) in (let _kvs_2=(u (u list_mapped _inl_1) (\_x_2-> (u (u pair_new (u fm_name_to_bits _x_2)) unit_new))) in (u map_from_list _kvs_2)))
fm_term_inline_reduce = (\_term_1-> (\_defs_2-> (let _6079 = _term_1 in (case _6079 of {(0,f) -> u f (\_6080 _6081-> _term_1); (1,f) -> u f (\_6082-> (let _inli_4=(u (u set_has (u fm_name_to_bits _6082)) fm_term_inline_names) in (let _6083 = _inli_4 in (if _6083 then (let _6084 = (u (u fm_get _6082) _defs_2) in (case _6084 of {(0,f) -> u f ((u fm_term_ref _6082)); (1,f) -> u f (\_6085-> (let _6086 = _6085 in (case _6086 of {(0,f) -> u f (\_6087 _6088 _6089 _6090 _6091 _6092-> (u (u fm_term_inline_reduce _6090) _defs_2)); }))); })) else _term_1)))); (2,f) -> u f (_term_1); (3,f) -> u f (\_6093 _6094 _6095 _6096 _6097-> _term_1); (4,f) -> u f (\_6098 _6099-> _term_1); (5,f) -> u f (\_6100 _6101-> (let _func_5=(u (u fm_term_inline_reduce _6100) _defs_2) in (let _6102 = _func_5 in (case _6102 of {(0,f) -> u f (\_6103 _6104-> _term_1); (1,f) -> u f (\_6105-> _term_1); (2,f) -> u f (_term_1); (3,f) -> u f (\_6106 _6107 _6108 _6109 _6110-> _term_1); (4,f) -> u f (\_6111 _6112-> (u (u fm_term_inline_reduce (u _6112 _6101)) _defs_2)); (5,f) -> u f (\_6113 _6114-> _term_1); (6,f) -> u f (\_6115 _6116 _6117-> (u (u (u fm_term_let _6115) _6116) (\_x_9-> (u (u fm_term_inline_reduce (u (u fm_term_app (u _6117 _x_9)) _6101)) _defs_2)))); (7,f) -> u f (\_6118 _6119 _6120-> _term_1); (8,f) -> u f (\_6121 _6122 _6123-> _term_1); (9,f) -> u f (\_6124 _6125 _6126-> _term_1); (10,f) -> u f (\_6127-> _term_1); (11,f) -> u f (\_6128-> _term_1); (12,f) -> u f (\_6129-> _term_1); (13,f) -> u f (\_6130-> _term_1); (14,f) -> u f (\_6131 _6132 _6133 _6134 _6135 _6136-> _term_1); (15,f) -> u f (\_6137 _6138-> _term_1); })))); (6,f) -> u f (\_6139 _6140 _6141-> _term_1); (7,f) -> u f (\_6142 _6143 _6144-> _term_1); (8,f) -> u f (\_6145 _6146 _6147-> _term_1); (9,f) -> u f (\_6148 _6149 _6150-> _term_1); (10,f) -> u f (\_6151-> _term_1); (11,f) -> u f (\_6152-> _term_1); (12,f) -> u f (\_6153-> _term_1); (13,f) -> u f (\_6154-> _term_1); (14,f) -> u f (\_6155 _6156 _6157 _6158 _6159 _6160-> _term_1); (15,f) -> u f (\_6161 _6162-> (u (u fm_term_inline_reduce _6162) _defs_2)); }))))
fm_term_inline = (\_term_1-> (\_defs_2-> (let _6163 = (u (u fm_term_inline_reduce _term_1) _defs_2) in (case _6163 of {(0,f) -> u f (\_6164 _6165-> (u (u fm_term_var _6164) _6165)); (1,f) -> u f (\_6166-> (u fm_term_ref _6166)); (2,f) -> u f (fm_term_typ); (3,f) -> u f (\_6167 _6168 _6169 _6170 _6171-> (u (u (u (u (u fm_term_all _6167) _6168) _6169) (u (u fm_term_inline _6170) _defs_2)) (\_s_8-> (\_x_9-> (u (u fm_term_inline (u (u _6171 _s_8) _x_9)) _defs_2))))); (4,f) -> u f (\_6172 _6173-> (u (u fm_term_lam _6172) (\_x_5-> (u (u fm_term_inline (u _6173 _x_5)) _defs_2)))); (5,f) -> u f (\_6174 _6175-> (u (u fm_term_app (u (u fm_term_inline _6174) _defs_2)) (u (u fm_term_inline _6175) _defs_2))); (6,f) -> u f (\_6176 _6177 _6178-> (u (u (u fm_term_let _6176) (u (u fm_term_inline _6177) _defs_2)) (\_x_6-> (u (u fm_term_inline (u _6178 _x_6)) _defs_2)))); (7,f) -> u f (\_6179 _6180 _6181-> (u (u (u fm_term_def _6179) (u (u fm_term_inline _6180) _defs_2)) (\_x_6-> (u (u fm_term_inline (u _6181 _x_6)) _defs_2)))); (8,f) -> u f (\_6182 _6183 _6184-> (u (u (u fm_term_ann _6182) (u (u fm_term_inline _6183) _defs_2)) (u (u fm_term_inline _6184) _defs_2))); (9,f) -> u f (\_6185 _6186 _6187-> (u (u (u fm_term_gol _6185) _6186) _6187)); (10,f) -> u f (\_6188-> (u fm_term_hol _6188)); (11,f) -> u f (\_6189-> (u fm_term_nat _6189)); (12,f) -> u f (\_6190-> (u fm_term_chr _6190)); (13,f) -> u f (\_6191-> (u fm_term_str _6191)); (14,f) -> u f (\_6192 _6193 _6194 _6195 _6196 _6197-> _term_1); (15,f) -> u f (\_6198 _6199-> (u (u fm_term_inline _6199) _defs_2)); }))))
map_values_go = (\_xs_2-> (\_list_3-> (let _6200 = _xs_2 in (case _6200 of {(0,f) -> u f (_list_3); (1,f) -> u f (\_6201 _6202 _6203-> (let _list0_7=(let _6204 = _6201 in (case _6204 of {(0,f) -> u f (_list_3); (1,f) -> u f (\_6205-> (u (u list_cons _6205) _list_3)); })) in (let _list1_8=(u (u map_values_go _6202) _list0_7) in (let _list2_9=(u (u map_values_go _6203) _list1_8) in _list2_9)))); }))))
map_values = (\_xs_2-> (u (u map_values_go _xs_2) list_nil))
fm_core_var_name = (\_indx_1-> (\_name_2-> (\_brui_3-> (\_vars_4-> (let _6206 = _indx_1 in (if _6206==0 then (let _6207 = _brui_3 in (if _6207==0 then _name_2 else (((_name_2::String) ++ ((("^"::String) ++ (u nat_show _brui_3))))))) else (let _6208 = _vars_4 in (case _6208 of {(0,f) -> u f ("unbound"); (1,f) -> u f (\_6209 _6210-> (let _brui_8=(let _6211 = (((_name_2::String) == _6209)) in (if _6211 then (u nat_succ _brui_3) else _brui_3)) in (u (u (u (u fm_core_var_name (_6206-1)) _name_2) _brui_8) _6210))); }))))))))
fm_name_show = (\_name_1-> _name_1)
bits_to_nat = (\_b_1-> (let _6212 = _b_1 in (case _6212 of {(0,f) -> u f (0); (1,f) -> u f (\_6213-> (((2::Integer) * (u bits_to_nat _6213)))); (2,f) -> u f (\_6214-> (u nat_succ (((2::Integer) * (u bits_to_nat _6214))))); })))
u16_show_hex = (\_a_1-> (let _6215 = _a_1 in (u (u nat_to_string_base 16) (u bits_to_nat (u word_to_bits (u16_to_word _6215))))))
fm_escape_char = (\_chr_1-> (let _6216 = (((_chr_1::Word16) == fm_backslash)) in (if _6216 then (u (u string_cons fm_backslash) (u (u string_cons _chr_1) string_nil)) else (let _6217 = (((_chr_1::Word16) == 34)) in (if _6217 then (u (u string_cons fm_backslash) (u (u string_cons _chr_1) string_nil)) else (let _6218 = (((_chr_1::Word16) == 39)) in (if _6218 then (u (u string_cons fm_backslash) (u (u string_cons _chr_1) string_nil)) else (let _6219 = (u (u (u u16_btw 32) _chr_1) 126) in (if _6219 then (u (u string_cons _chr_1) string_nil) else (u string_flatten (u (u list_cons (u (u string_cons fm_backslash) string_nil)) (u (u list_cons "u{") (u (u list_cons (u u16_show_hex _chr_1)) (u (u list_cons "}") (u (u list_cons string_nil) list_nil)))))))))))))))
fm_escape = (\_str_1-> (let _6220 = _str_1 in (if null (_6220::String) then string_nil else (let _head_4=(u fm_escape_char (fromIntegral (fromEnum (head _6220 :: Char)) :: Word16)) in (let _tail_5=(u fm_escape (tail _6220)) in (((_head_4::String) ++ _tail_5)))))))
fm_core_show = (\_term_1-> (\_indx_2-> (\_vars_3-> (let _6221 = _term_1 in (case _6221 of {(0,f) -> u f (\_6222 _6223-> (u (u (u (u fm_core_var_name (u nat_pred (((_indx_2::Integer) - _6223)))) _6222) 0) _vars_3)); (1,f) -> u f (\_6224-> (u fm_name_show _6224)); (2,f) -> u f ("*"); (3,f) -> u f (\_6225 _6226 _6227 _6228 _6229-> (let _eras_9=_6225 in (let _init_10=(let _6230 = _eras_9 in (if _6230 then "%" else "@")) in (let _self_11=(u fm_name_show _6226) in (let _name_12=(u fm_name_show _6227) in (let _xtyp_13=(u (u (u fm_core_show _6228) _indx_2) _vars_3) in (let _body_14=(u (u (u fm_core_show (u (u _6229 (u (u fm_term_var _6226) _indx_2)) (u (u fm_term_var _6227) (u nat_succ _indx_2)))) (u nat_succ (u nat_succ _indx_2))) (u (u list_cons _6227) (u (u list_cons _6226) _vars_3))) in (u string_flatten (u (u list_cons _init_10) (u (u list_cons _self_11) (u (u list_cons "(") (u (u list_cons _name_12) (u (u list_cons ":") (u (u list_cons _xtyp_13) (u (u list_cons ") ") (u (u list_cons _body_14) list_nil)))))))))))))))); (4,f) -> u f (\_6231 _6232-> (let _name_6=(u fm_name_show _6231) in (let _body_7=(u (u (u fm_core_show (u _6232 (u (u fm_term_var _6231) _indx_2))) (u nat_succ _indx_2)) (u (u list_cons _6231) _vars_3)) in (u string_flatten (u (u list_cons "#") (u (u list_cons _name_6) (u (u list_cons " ") (u (u list_cons _body_7) list_nil)))))))); (5,f) -> u f (\_6233 _6234-> (let _func_6=(u (u (u fm_core_show _6233) _indx_2) _vars_3) in (let _argm_7=(u (u (u fm_core_show _6234) _indx_2) _vars_3) in (u string_flatten (u (u list_cons "(") (u (u list_cons _func_6) (u (u list_cons " ") (u (u list_cons _argm_7) (u (u list_cons ")") list_nil))))))))); (6,f) -> u f (\_6235 _6236 _6237-> (let _name_7=(u fm_name_show _6235) in (let _expr_8=(u (u (u fm_core_show _6236) _indx_2) _vars_3) in (let _body_9=(u (u (u fm_core_show (u _6237 (u (u fm_term_var _6235) _indx_2))) (u nat_succ _indx_2)) (u (u list_cons _6235) _vars_3)) in (u string_flatten (u (u list_cons "!") (u (u list_cons _name_7) (u (u list_cons " = ") (u (u list_cons _expr_8) (u (u list_cons "; ") (u (u list_cons _body_9) list_nil))))))))))); (7,f) -> u f (\_6238 _6239 _6240-> (let _name_7=(u fm_name_show _6238) in (let _expr_8=(u (u (u fm_core_show _6239) _indx_2) _vars_3) in (let _body_9=(u (u (u fm_core_show (u _6240 (u (u fm_term_var _6238) _indx_2))) (u nat_succ _indx_2)) (u (u list_cons _6238) _vars_3)) in (u string_flatten (u (u list_cons "$") (u (u list_cons _name_7) (u (u list_cons " = ") (u (u list_cons _expr_8) (u (u list_cons "; ") (u (u list_cons _body_9) list_nil))))))))))); (8,f) -> u f (\_6241 _6242 _6243-> (let _term_7=(u (u (u fm_core_show _6242) _indx_2) _vars_3) in (let _type_8=(u (u (u fm_core_show _6243) _indx_2) _vars_3) in (u string_flatten (u (u list_cons "{") (u (u list_cons _term_7) (u (u list_cons ":") (u (u list_cons _type_8) (u (u list_cons "}") list_nil))))))))); (9,f) -> u f (\_6244 _6245 _6246-> "<GOL>"); (10,f) -> u f (\_6247-> "<HOL>"); (11,f) -> u f (\_6248-> (u string_flatten (u (u list_cons "+") (u (u list_cons (u nat_show _6248)) list_nil)))); (12,f) -> u f (\_6249-> (u string_flatten (u (u list_cons "'") (u (u list_cons (u fm_escape_char _6249)) (u (u list_cons "'") list_nil))))); (13,f) -> u f (\_6250-> (u string_flatten (u (u list_cons "\"") (u (u list_cons (u fm_escape _6250)) (u (u list_cons "\"") list_nil))))); (14,f) -> u f (\_6251 _6252 _6253 _6254 _6255 _6256-> "<CSE>"); (15,f) -> u f (\_6257 _6258-> (u (u (u fm_core_show _6258) _indx_2) _vars_3)); })))))
fm_defs_core = (\_defs_1-> (let _result_2="" in (let _result_3=(u (u (u list_for (u map_values _defs_1)) _result_2) (\_defn_3-> (\_result_4-> (let _6259 = _defn_3 in (case _6259 of {(0,f) -> u f (\_6260 _6261 _6262 _6263 _6264 _6265-> (let _6266 = _6265 in (case _6266 of {(0,f) -> u f (_result_4); (1,f) -> u f (_result_4); (2,f) -> u f ((let _name_11=_6262 in (let _term_12=(u (u (u fm_core_show _6263) 0) list_nil) in (let _type_13=(u (u (u fm_core_show _6264) 0) list_nil) in (u string_flatten (u (u list_cons _result_4) (u (u list_cons _name_11) (u (u list_cons " : ") (u (u list_cons _type_13) (u (u list_cons " = ") (u (u list_cons _term_12) (u (u list_cons ";\n") list_nil)))))))))))); (3,f) -> u f (\_6267-> _result_4); }))); }))))) in _result_3)))
fm_to_core_io_one = (\_name_1-> (u (u (u io_monad (\_m_bind_2-> (\_m_pure_3-> _m_bind_2))) (u (u fm_synth_one _name_1) map_new)) (\_new_defs_2-> (let _defs_3=(let _6268 = _new_defs_2 in (case _6268 of {(0,f) -> u f (map_new); (1,f) -> u f (\_6269-> _6269); })) in (let _defs_4=(u (u map_map (\_defn_4-> (let _6270 = _defn_4 in (case _6270 of {(0,f) -> u f (\_6271 _6272 _6273 _6274 _6275 _6276-> (let _term_11=(u (u fm_term_inline _6274) _defs_3) in (let _type_12=(u (u fm_term_inline _6275) _defs_3) in (u (u (u (u (u (u fm_def_new _6271) _6272) _6273) _term_11) _type_12) _6276)))); })))) _defs_3) in (u (u io_monad (\_m_bind_5-> (\_m_pure_6-> _m_pure_6))) (u fm_defs_core _defs_4)))))))
io_print = (\_text_1-> (u (u (u io_ask "print") _text_1) (\_skip_2-> (u io_end unit_new))))
maybe_bind = (\_m_3-> (\_f_4-> (let _6277 = _m_3 in (case _6277 of {(0,f) -> u f (maybe_none); (1,f) -> u f (\_6278-> (u _f_4 _6278)); }))))
maybe_monad = (\_new_2-> (u (u _new_2 maybe_bind) maybe_some))
fm_term_show_as_nat_go = (\_term_1-> (let _6279 = _term_1 in (case _6279 of {(0,f) -> u f (\_6280 _6281-> maybe_none); (1,f) -> u f (\_6282-> (let _6283 = (((_6282::String) == "Nat.zero")) in (if _6283 then (u maybe_some 0) else maybe_none))); (2,f) -> u f (maybe_none); (3,f) -> u f (\_6284 _6285 _6286 _6287 _6288-> maybe_none); (4,f) -> u f (\_6289 _6290-> maybe_none); (5,f) -> u f (\_6291 _6292-> (let _6293 = _6291 in (case _6293 of {(0,f) -> u f (\_6294 _6295-> maybe_none); (1,f) -> u f (\_6296-> (let _6297 = (((_6296::String) == "Nat.succ")) in (if _6297 then (u (u (u maybe_monad (\_m_bind_5-> (\_m_pure_6-> _m_bind_5))) (u fm_term_show_as_nat_go _6292)) (\_pred_5-> (u (u maybe_monad (\_m_bind_6-> (\_m_pure_7-> _m_pure_7))) (u nat_succ _pred_5)))) else maybe_none))); (2,f) -> u f (maybe_none); (3,f) -> u f (\_6298 _6299 _6300 _6301 _6302-> maybe_none); (4,f) -> u f (\_6303 _6304-> maybe_none); (5,f) -> u f (\_6305 _6306-> maybe_none); (6,f) -> u f (\_6307 _6308 _6309-> maybe_none); (7,f) -> u f (\_6310 _6311 _6312-> maybe_none); (8,f) -> u f (\_6313 _6314 _6315-> maybe_none); (9,f) -> u f (\_6316 _6317 _6318-> maybe_none); (10,f) -> u f (\_6319-> maybe_none); (11,f) -> u f (\_6320-> maybe_none); (12,f) -> u f (\_6321-> maybe_none); (13,f) -> u f (\_6322-> maybe_none); (14,f) -> u f (\_6323 _6324 _6325 _6326 _6327 _6328-> maybe_none); (15,f) -> u f (\_6329 _6330-> maybe_none); }))); (6,f) -> u f (\_6331 _6332 _6333-> maybe_none); (7,f) -> u f (\_6334 _6335 _6336-> maybe_none); (8,f) -> u f (\_6337 _6338 _6339-> maybe_none); (9,f) -> u f (\_6340 _6341 _6342-> maybe_none); (10,f) -> u f (\_6343-> maybe_none); (11,f) -> u f (\_6344-> maybe_none); (12,f) -> u f (\_6345-> maybe_none); (13,f) -> u f (\_6346-> maybe_none); (14,f) -> u f (\_6347 _6348 _6349 _6350 _6351 _6352-> maybe_none); (15,f) -> u f (\_6353 _6354-> maybe_none); })))
fm_term_show_as_nat = (\_term_1-> (u (u maybe_mapped (u fm_term_show_as_nat_go _term_1)) nat_show))
fm_term_show_is_ref = (\_term_1-> (\_name_2-> (let _6355 = _term_1 in (case _6355 of {(0,f) -> u f (\_6356 _6357-> bool_false); (1,f) -> u f (\_6358-> (((_name_2::String) == _6358))); (2,f) -> u f (bool_false); (3,f) -> u f (\_6359 _6360 _6361 _6362 _6363-> bool_false); (4,f) -> u f (\_6364 _6365-> bool_false); (5,f) -> u f (\_6366 _6367-> bool_false); (6,f) -> u f (\_6368 _6369 _6370-> bool_false); (7,f) -> u f (\_6371 _6372 _6373-> bool_false); (8,f) -> u f (\_6374 _6375 _6376-> bool_false); (9,f) -> u f (\_6377 _6378 _6379-> bool_false); (10,f) -> u f (\_6380-> bool_false); (11,f) -> u f (\_6381-> bool_false); (12,f) -> u f (\_6382-> bool_false); (13,f) -> u f (\_6383-> bool_false); (14,f) -> u f (\_6384 _6385 _6386 _6387 _6388 _6389-> bool_false); (15,f) -> u f (\_6390 _6391-> bool_false); }))))
fm_term_show_app = (\_term_1-> (\_path_2-> (\_args_3-> (let _6392 = _term_1 in (case _6392 of {(0,f) -> u f (\_6393 _6394-> (let _arity_6=(u list_length _args_3) in (let _6395 = (((u (u fm_term_show_is_ref _term_1) "Equal") && (((_arity_6::Integer) == 3)))) in (if _6395 then (let _func_7=(u (u fm_term_show_go _term_1) _path_2) in (let _eq_lft_8=(u (u maybe_default "?") (u (u list_at 1) _args_3)) in (let _eq_rgt_9=(u (u maybe_default "?") (u (u list_at 2) _args_3)) in (u string_flatten (u (u list_cons _eq_lft_8) (u (u list_cons " == ") (u (u list_cons _eq_rgt_9) list_nil))))))) else (let _func_7=(u (u fm_term_show_go _term_1) _path_2) in (let _wrap_8=(let _6396 = _func_7 in (if null (_6396::String) then bool_false else ((((fromIntegral (fromEnum (head _6396 :: Char)) :: Word16)::Word16) == 40)))) in (let _args_9=(u (u string_join ",") _args_3) in (let _func_10=(let _6397 = _wrap_8 in (if _6397 then (u string_flatten (u (u list_cons "(") (u (u list_cons _func_7) (u (u list_cons ")") list_nil)))) else _func_7)) in (u string_flatten (u (u list_cons _func_10) (u (u list_cons "(") (u (u list_cons _args_9) (u (u list_cons ")") list_nil))))))))))))); (1,f) -> u f (\_6398-> (let _arity_5=(u list_length _args_3) in (let _6399 = (((u (u fm_term_show_is_ref _term_1) "Equal") && (((_arity_5::Integer) == 3)))) in (if _6399 then (let _func_6=(u (u fm_term_show_go _term_1) _path_2) in (let _eq_lft_7=(u (u maybe_default "?") (u (u list_at 1) _args_3)) in (let _eq_rgt_8=(u (u maybe_default "?") (u (u list_at 2) _args_3)) in (u string_flatten (u (u list_cons _eq_lft_7) (u (u list_cons " == ") (u (u list_cons _eq_rgt_8) list_nil))))))) else (let _func_6=(u (u fm_term_show_go _term_1) _path_2) in (let _wrap_7=(let _6400 = _func_6 in (if null (_6400::String) then bool_false else ((((fromIntegral (fromEnum (head _6400 :: Char)) :: Word16)::Word16) == 40)))) in (let _args_8=(u (u string_join ",") _args_3) in (let _func_9=(let _6401 = _wrap_7 in (if _6401 then (u string_flatten (u (u list_cons "(") (u (u list_cons _func_6) (u (u list_cons ")") list_nil)))) else _func_6)) in (u string_flatten (u (u list_cons _func_9) (u (u list_cons "(") (u (u list_cons _args_8) (u (u list_cons ")") list_nil))))))))))))); (2,f) -> u f ((let _arity_4=(u list_length _args_3) in (let _6402 = (((u (u fm_term_show_is_ref _term_1) "Equal") && (((_arity_4::Integer) == 3)))) in (if _6402 then (let _func_5=(u (u fm_term_show_go _term_1) _path_2) in (let _eq_lft_6=(u (u maybe_default "?") (u (u list_at 1) _args_3)) in (let _eq_rgt_7=(u (u maybe_default "?") (u (u list_at 2) _args_3)) in (u string_flatten (u (u list_cons _eq_lft_6) (u (u list_cons " == ") (u (u list_cons _eq_rgt_7) list_nil))))))) else (let _func_5=(u (u fm_term_show_go _term_1) _path_2) in (let _wrap_6=(let _6403 = _func_5 in (if null (_6403::String) then bool_false else ((((fromIntegral (fromEnum (head _6403 :: Char)) :: Word16)::Word16) == 40)))) in (let _args_7=(u (u string_join ",") _args_3) in (let _func_8=(let _6404 = _wrap_6 in (if _6404 then (u string_flatten (u (u list_cons "(") (u (u list_cons _func_5) (u (u list_cons ")") list_nil)))) else _func_5)) in (u string_flatten (u (u list_cons _func_8) (u (u list_cons "(") (u (u list_cons _args_7) (u (u list_cons ")") list_nil))))))))))))); (3,f) -> u f (\_6405 _6406 _6407 _6408 _6409-> (let _arity_9=(u list_length _args_3) in (let _6410 = (((u (u fm_term_show_is_ref _term_1) "Equal") && (((_arity_9::Integer) == 3)))) in (if _6410 then (let _func_10=(u (u fm_term_show_go _term_1) _path_2) in (let _eq_lft_11=(u (u maybe_default "?") (u (u list_at 1) _args_3)) in (let _eq_rgt_12=(u (u maybe_default "?") (u (u list_at 2) _args_3)) in (u string_flatten (u (u list_cons _eq_lft_11) (u (u list_cons " == ") (u (u list_cons _eq_rgt_12) list_nil))))))) else (let _func_10=(u (u fm_term_show_go _term_1) _path_2) in (let _wrap_11=(let _6411 = _func_10 in (if null (_6411::String) then bool_false else ((((fromIntegral (fromEnum (head _6411 :: Char)) :: Word16)::Word16) == 40)))) in (let _args_12=(u (u string_join ",") _args_3) in (let _func_13=(let _6412 = _wrap_11 in (if _6412 then (u string_flatten (u (u list_cons "(") (u (u list_cons _func_10) (u (u list_cons ")") list_nil)))) else _func_10)) in (u string_flatten (u (u list_cons _func_13) (u (u list_cons "(") (u (u list_cons _args_12) (u (u list_cons ")") list_nil))))))))))))); (4,f) -> u f (\_6413 _6414-> (let _arity_6=(u list_length _args_3) in (let _6415 = (((u (u fm_term_show_is_ref _term_1) "Equal") && (((_arity_6::Integer) == 3)))) in (if _6415 then (let _func_7=(u (u fm_term_show_go _term_1) _path_2) in (let _eq_lft_8=(u (u maybe_default "?") (u (u list_at 1) _args_3)) in (let _eq_rgt_9=(u (u maybe_default "?") (u (u list_at 2) _args_3)) in (u string_flatten (u (u list_cons _eq_lft_8) (u (u list_cons " == ") (u (u list_cons _eq_rgt_9) list_nil))))))) else (let _func_7=(u (u fm_term_show_go _term_1) _path_2) in (let _wrap_8=(let _6416 = _func_7 in (if null (_6416::String) then bool_false else ((((fromIntegral (fromEnum (head _6416 :: Char)) :: Word16)::Word16) == 40)))) in (let _args_9=(u (u string_join ",") _args_3) in (let _func_10=(let _6417 = _wrap_8 in (if _6417 then (u string_flatten (u (u list_cons "(") (u (u list_cons _func_7) (u (u list_cons ")") list_nil)))) else _func_7)) in (u string_flatten (u (u list_cons _func_10) (u (u list_cons "(") (u (u list_cons _args_9) (u (u list_cons ")") list_nil))))))))))))); (5,f) -> u f (\_6418 _6419-> (let _argm_6=(u (u fm_term_show_go _6419) (u fm_mpath_i _path_2)) in (u (u (u fm_term_show_app _6418) (u fm_mpath_o _path_2)) (u (u list_cons _argm_6) _args_3)))); (6,f) -> u f (\_6420 _6421 _6422-> (let _arity_7=(u list_length _args_3) in (let _6423 = (((u (u fm_term_show_is_ref _term_1) "Equal") && (((_arity_7::Integer) == 3)))) in (if _6423 then (let _func_8=(u (u fm_term_show_go _term_1) _path_2) in (let _eq_lft_9=(u (u maybe_default "?") (u (u list_at 1) _args_3)) in (let _eq_rgt_10=(u (u maybe_default "?") (u (u list_at 2) _args_3)) in (u string_flatten (u (u list_cons _eq_lft_9) (u (u list_cons " == ") (u (u list_cons _eq_rgt_10) list_nil))))))) else (let _func_8=(u (u fm_term_show_go _term_1) _path_2) in (let _wrap_9=(let _6424 = _func_8 in (if null (_6424::String) then bool_false else ((((fromIntegral (fromEnum (head _6424 :: Char)) :: Word16)::Word16) == 40)))) in (let _args_10=(u (u string_join ",") _args_3) in (let _func_11=(let _6425 = _wrap_9 in (if _6425 then (u string_flatten (u (u list_cons "(") (u (u list_cons _func_8) (u (u list_cons ")") list_nil)))) else _func_8)) in (u string_flatten (u (u list_cons _func_11) (u (u list_cons "(") (u (u list_cons _args_10) (u (u list_cons ")") list_nil))))))))))))); (7,f) -> u f (\_6426 _6427 _6428-> (let _arity_7=(u list_length _args_3) in (let _6429 = (((u (u fm_term_show_is_ref _term_1) "Equal") && (((_arity_7::Integer) == 3)))) in (if _6429 then (let _func_8=(u (u fm_term_show_go _term_1) _path_2) in (let _eq_lft_9=(u (u maybe_default "?") (u (u list_at 1) _args_3)) in (let _eq_rgt_10=(u (u maybe_default "?") (u (u list_at 2) _args_3)) in (u string_flatten (u (u list_cons _eq_lft_9) (u (u list_cons " == ") (u (u list_cons _eq_rgt_10) list_nil))))))) else (let _func_8=(u (u fm_term_show_go _term_1) _path_2) in (let _wrap_9=(let _6430 = _func_8 in (if null (_6430::String) then bool_false else ((((fromIntegral (fromEnum (head _6430 :: Char)) :: Word16)::Word16) == 40)))) in (let _args_10=(u (u string_join ",") _args_3) in (let _func_11=(let _6431 = _wrap_9 in (if _6431 then (u string_flatten (u (u list_cons "(") (u (u list_cons _func_8) (u (u list_cons ")") list_nil)))) else _func_8)) in (u string_flatten (u (u list_cons _func_11) (u (u list_cons "(") (u (u list_cons _args_10) (u (u list_cons ")") list_nil))))))))))))); (8,f) -> u f (\_6432 _6433 _6434-> (let _arity_7=(u list_length _args_3) in (let _6435 = (((u (u fm_term_show_is_ref _term_1) "Equal") && (((_arity_7::Integer) == 3)))) in (if _6435 then (let _func_8=(u (u fm_term_show_go _term_1) _path_2) in (let _eq_lft_9=(u (u maybe_default "?") (u (u list_at 1) _args_3)) in (let _eq_rgt_10=(u (u maybe_default "?") (u (u list_at 2) _args_3)) in (u string_flatten (u (u list_cons _eq_lft_9) (u (u list_cons " == ") (u (u list_cons _eq_rgt_10) list_nil))))))) else (let _func_8=(u (u fm_term_show_go _term_1) _path_2) in (let _wrap_9=(let _6436 = _func_8 in (if null (_6436::String) then bool_false else ((((fromIntegral (fromEnum (head _6436 :: Char)) :: Word16)::Word16) == 40)))) in (let _args_10=(u (u string_join ",") _args_3) in (let _func_11=(let _6437 = _wrap_9 in (if _6437 then (u string_flatten (u (u list_cons "(") (u (u list_cons _func_8) (u (u list_cons ")") list_nil)))) else _func_8)) in (u string_flatten (u (u list_cons _func_11) (u (u list_cons "(") (u (u list_cons _args_10) (u (u list_cons ")") list_nil))))))))))))); (9,f) -> u f (\_6438 _6439 _6440-> (let _arity_7=(u list_length _args_3) in (let _6441 = (((u (u fm_term_show_is_ref _term_1) "Equal") && (((_arity_7::Integer) == 3)))) in (if _6441 then (let _func_8=(u (u fm_term_show_go _term_1) _path_2) in (let _eq_lft_9=(u (u maybe_default "?") (u (u list_at 1) _args_3)) in (let _eq_rgt_10=(u (u maybe_default "?") (u (u list_at 2) _args_3)) in (u string_flatten (u (u list_cons _eq_lft_9) (u (u list_cons " == ") (u (u list_cons _eq_rgt_10) list_nil))))))) else (let _func_8=(u (u fm_term_show_go _term_1) _path_2) in (let _wrap_9=(let _6442 = _func_8 in (if null (_6442::String) then bool_false else ((((fromIntegral (fromEnum (head _6442 :: Char)) :: Word16)::Word16) == 40)))) in (let _args_10=(u (u string_join ",") _args_3) in (let _func_11=(let _6443 = _wrap_9 in (if _6443 then (u string_flatten (u (u list_cons "(") (u (u list_cons _func_8) (u (u list_cons ")") list_nil)))) else _func_8)) in (u string_flatten (u (u list_cons _func_11) (u (u list_cons "(") (u (u list_cons _args_10) (u (u list_cons ")") list_nil))))))))))))); (10,f) -> u f (\_6444-> (let _arity_5=(u list_length _args_3) in (let _6445 = (((u (u fm_term_show_is_ref _term_1) "Equal") && (((_arity_5::Integer) == 3)))) in (if _6445 then (let _func_6=(u (u fm_term_show_go _term_1) _path_2) in (let _eq_lft_7=(u (u maybe_default "?") (u (u list_at 1) _args_3)) in (let _eq_rgt_8=(u (u maybe_default "?") (u (u list_at 2) _args_3)) in (u string_flatten (u (u list_cons _eq_lft_7) (u (u list_cons " == ") (u (u list_cons _eq_rgt_8) list_nil))))))) else (let _func_6=(u (u fm_term_show_go _term_1) _path_2) in (let _wrap_7=(let _6446 = _func_6 in (if null (_6446::String) then bool_false else ((((fromIntegral (fromEnum (head _6446 :: Char)) :: Word16)::Word16) == 40)))) in (let _args_8=(u (u string_join ",") _args_3) in (let _func_9=(let _6447 = _wrap_7 in (if _6447 then (u string_flatten (u (u list_cons "(") (u (u list_cons _func_6) (u (u list_cons ")") list_nil)))) else _func_6)) in (u string_flatten (u (u list_cons _func_9) (u (u list_cons "(") (u (u list_cons _args_8) (u (u list_cons ")") list_nil))))))))))))); (11,f) -> u f (\_6448-> (let _arity_5=(u list_length _args_3) in (let _6449 = (((u (u fm_term_show_is_ref _term_1) "Equal") && (((_arity_5::Integer) == 3)))) in (if _6449 then (let _func_6=(u (u fm_term_show_go _term_1) _path_2) in (let _eq_lft_7=(u (u maybe_default "?") (u (u list_at 1) _args_3)) in (let _eq_rgt_8=(u (u maybe_default "?") (u (u list_at 2) _args_3)) in (u string_flatten (u (u list_cons _eq_lft_7) (u (u list_cons " == ") (u (u list_cons _eq_rgt_8) list_nil))))))) else (let _func_6=(u (u fm_term_show_go _term_1) _path_2) in (let _wrap_7=(let _6450 = _func_6 in (if null (_6450::String) then bool_false else ((((fromIntegral (fromEnum (head _6450 :: Char)) :: Word16)::Word16) == 40)))) in (let _args_8=(u (u string_join ",") _args_3) in (let _func_9=(let _6451 = _wrap_7 in (if _6451 then (u string_flatten (u (u list_cons "(") (u (u list_cons _func_6) (u (u list_cons ")") list_nil)))) else _func_6)) in (u string_flatten (u (u list_cons _func_9) (u (u list_cons "(") (u (u list_cons _args_8) (u (u list_cons ")") list_nil))))))))))))); (12,f) -> u f (\_6452-> (let _arity_5=(u list_length _args_3) in (let _6453 = (((u (u fm_term_show_is_ref _term_1) "Equal") && (((_arity_5::Integer) == 3)))) in (if _6453 then (let _func_6=(u (u fm_term_show_go _term_1) _path_2) in (let _eq_lft_7=(u (u maybe_default "?") (u (u list_at 1) _args_3)) in (let _eq_rgt_8=(u (u maybe_default "?") (u (u list_at 2) _args_3)) in (u string_flatten (u (u list_cons _eq_lft_7) (u (u list_cons " == ") (u (u list_cons _eq_rgt_8) list_nil))))))) else (let _func_6=(u (u fm_term_show_go _term_1) _path_2) in (let _wrap_7=(let _6454 = _func_6 in (if null (_6454::String) then bool_false else ((((fromIntegral (fromEnum (head _6454 :: Char)) :: Word16)::Word16) == 40)))) in (let _args_8=(u (u string_join ",") _args_3) in (let _func_9=(let _6455 = _wrap_7 in (if _6455 then (u string_flatten (u (u list_cons "(") (u (u list_cons _func_6) (u (u list_cons ")") list_nil)))) else _func_6)) in (u string_flatten (u (u list_cons _func_9) (u (u list_cons "(") (u (u list_cons _args_8) (u (u list_cons ")") list_nil))))))))))))); (13,f) -> u f (\_6456-> (let _arity_5=(u list_length _args_3) in (let _6457 = (((u (u fm_term_show_is_ref _term_1) "Equal") && (((_arity_5::Integer) == 3)))) in (if _6457 then (let _func_6=(u (u fm_term_show_go _term_1) _path_2) in (let _eq_lft_7=(u (u maybe_default "?") (u (u list_at 1) _args_3)) in (let _eq_rgt_8=(u (u maybe_default "?") (u (u list_at 2) _args_3)) in (u string_flatten (u (u list_cons _eq_lft_7) (u (u list_cons " == ") (u (u list_cons _eq_rgt_8) list_nil))))))) else (let _func_6=(u (u fm_term_show_go _term_1) _path_2) in (let _wrap_7=(let _6458 = _func_6 in (if null (_6458::String) then bool_false else ((((fromIntegral (fromEnum (head _6458 :: Char)) :: Word16)::Word16) == 40)))) in (let _args_8=(u (u string_join ",") _args_3) in (let _func_9=(let _6459 = _wrap_7 in (if _6459 then (u string_flatten (u (u list_cons "(") (u (u list_cons _func_6) (u (u list_cons ")") list_nil)))) else _func_6)) in (u string_flatten (u (u list_cons _func_9) (u (u list_cons "(") (u (u list_cons _args_8) (u (u list_cons ")") list_nil))))))))))))); (14,f) -> u f (\_6460 _6461 _6462 _6463 _6464 _6465-> (let _arity_10=(u list_length _args_3) in (let _6466 = (((u (u fm_term_show_is_ref _term_1) "Equal") && (((_arity_10::Integer) == 3)))) in (if _6466 then (let _func_11=(u (u fm_term_show_go _term_1) _path_2) in (let _eq_lft_12=(u (u maybe_default "?") (u (u list_at 1) _args_3)) in (let _eq_rgt_13=(u (u maybe_default "?") (u (u list_at 2) _args_3)) in (u string_flatten (u (u list_cons _eq_lft_12) (u (u list_cons " == ") (u (u list_cons _eq_rgt_13) list_nil))))))) else (let _func_11=(u (u fm_term_show_go _term_1) _path_2) in (let _wrap_12=(let _6467 = _func_11 in (if null (_6467::String) then bool_false else ((((fromIntegral (fromEnum (head _6467 :: Char)) :: Word16)::Word16) == 40)))) in (let _args_13=(u (u string_join ",") _args_3) in (let _func_14=(let _6468 = _wrap_12 in (if _6468 then (u string_flatten (u (u list_cons "(") (u (u list_cons _func_11) (u (u list_cons ")") list_nil)))) else _func_11)) in (u string_flatten (u (u list_cons _func_14) (u (u list_cons "(") (u (u list_cons _args_13) (u (u list_cons ")") list_nil))))))))))))); (15,f) -> u f (\_6469 _6470-> (u (u (u fm_term_show_app _6470) _path_2) _args_3)); })))))
map_to_list_go = (\_xs_2-> (\_key_3-> (\_list_4-> (let _6471 = _xs_2 in (case _6471 of {(0,f) -> u f (_list_4); (1,f) -> u f (\_6472 _6473 _6474-> (let _list0_8=(let _6475 = _6472 in (case _6475 of {(0,f) -> u f (_list_4); (1,f) -> u f (\_6476-> (u (u list_cons (u (u pair_new (u bits_reverse _key_3)) _6476)) _list_4)); })) in (let _list1_9=(u (u (u map_to_list_go _6473) (u bits_o _key_3)) _list0_8) in (let _list2_10=(u (u (u map_to_list_go _6474) (u bits_i _key_3)) _list1_9) in _list2_10)))); })))))
map_to_list = (\_xs_2-> (u list_reverse (u (u (u map_to_list_go _xs_2) bits_e) list_nil)))
bits_chunks_of_go = (\_len_1-> (\_bits_2-> (\_need_3-> (\_chunk_4-> (let _6477 = _bits_2 in (case _6477 of {(0,f) -> u f ((u (u list_cons (u bits_reverse _chunk_4)) list_nil)); (1,f) -> u f (\_6478-> (let _6479 = _need_3 in (if _6479==0 then (let _head_6=(u bits_reverse _chunk_4) in (let _tail_7=(u (u (u (u bits_chunks_of_go _len_1) _bits_2) _len_1) bits_e) in (u (u list_cons _head_6) _tail_7))) else (let _chunk_7=(u bits_o _chunk_4) in (u (u (u (u bits_chunks_of_go _len_1) _6478) (_6479-1)) _chunk_7))))); (2,f) -> u f (\_6480-> (let _6481 = _need_3 in (if _6481==0 then (let _head_6=(u bits_reverse _chunk_4) in (let _tail_7=(u (u (u (u bits_chunks_of_go _len_1) _bits_2) _len_1) bits_e) in (u (u list_cons _head_6) _tail_7))) else (let _chunk_7=(u bits_i _chunk_4) in (u (u (u (u bits_chunks_of_go _len_1) _6480) (_6481-1)) _chunk_7))))); }))))))
bits_chunks_of = (\_len_1-> (\_bits_2-> (u (u (u (u bits_chunks_of_go _len_1) _bits_2) _len_1) bits_e)))
word_from_bits = (\_size_1-> (\_bits_2-> (let _6482 = _size_1 in (if _6482==0 then word_e else (let _6483 = _bits_2 in (case _6483 of {(0,f) -> u f ((u word_o (u (u word_from_bits (_6482-1)) bits_e))); (1,f) -> u f (\_6484-> (u word_o (u (u word_from_bits (_6482-1)) _6484))); (2,f) -> u f (\_6485-> (u word_i (u (u word_from_bits (_6482-1)) _6485))); }))))))
fm_name_from_bits = (\_bits_1-> (let _list_2=(u (u bits_chunks_of 6) _bits_1) in (let _name_3=(u (u (u list_fold _list_2) string_nil) (\_bts_3-> (\_name_4-> (let _u16_5=(u u16_new (u (u word_from_bits 16) (u bits_reverse _bts_3))) in (let _chr_6=(let _6486 = (u (u (u u16_btw 0) _u16_5) 25) in (if _6486 then (((_u16_5::Word16) + 65)) else (let _6487 = (u (u (u u16_btw 26) _u16_5) 51) in (if _6487 then (((_u16_5::Word16) + 71)) else (let _6488 = (u (u (u u16_btw 52) _u16_5) 61) in (if _6488 then (((_u16_5::Word16) - 4)) else (let _6489 = (((62::Word16) == _u16_5)) in (if _6489 then 46 else 95)))))))) in (u (u string_cons _chr_6) _name_4)))))) in _name_3)))
fm_term_show_go = (\_term_1-> (\_path_2-> (let _6490 = (u fm_term_show_as_nat _term_1) in (case _6490 of {(0,f) -> u f ((let _6491 = _term_1 in (case _6491 of {(0,f) -> u f (\_6492 _6493-> (u fm_name_show _6492)); (1,f) -> u f (\_6494-> (let _name_4=(u fm_name_show _6494) in (let _6495 = _path_2 in (case _6495 of {(0,f) -> u f (_name_4); (1,f) -> u f (\_6496-> (let _path_val_6=(u (u bits_concat (u fm_path_to_bits _6496)) (u bits_i bits_e)) in (let _path_str_7=(u nat_show (u bits_to_nat _path_val_6)) in (u string_flatten (u (u list_cons _name_4) (u (u list_cons (u (u fm_color "2") ((("-"::String) ++ _path_str_7)))) list_nil)))))); })))); (2,f) -> u f ("Type"); (3,f) -> u f (\_6497 _6498 _6499 _6500 _6501-> (let _eras_8=_6497 in (let _self_9=(u fm_name_show _6498) in (let _name_10=(u fm_name_show _6499) in (let _type_11=(u (u fm_term_show_go _6500) (u fm_mpath_o _path_2)) in (let _open_12=(let _6502 = _eras_8 in (if _6502 then "<" else "(")) in (let _clos_13=(let _6503 = _eras_8 in (if _6503 then ">" else ")")) in (let _body_14=(u (u fm_term_show_go (u (u _6501 (u (u fm_term_var _6498) 0)) (u (u fm_term_var _6499) 0))) (u fm_mpath_i _path_2)) in (u string_flatten (u (u list_cons _self_9) (u (u list_cons _open_12) (u (u list_cons _name_10) (u (u list_cons ":") (u (u list_cons _type_11) (u (u list_cons _clos_13) (u (u list_cons " ") (u (u list_cons _body_14) list_nil))))))))))))))))); (4,f) -> u f (\_6504 _6505-> (let _name_5=(u fm_name_show _6504) in (let _body_6=(u (u fm_term_show_go (u _6505 (u (u fm_term_var _6504) 0))) (u fm_mpath_o _path_2)) in (u string_flatten (u (u list_cons "(") (u (u list_cons _name_5) (u (u list_cons ") ") (u (u list_cons _body_6) list_nil)))))))); (5,f) -> u f (\_6506 _6507-> (u (u (u fm_term_show_app _term_1) _path_2) list_nil)); (6,f) -> u f (\_6508 _6509 _6510-> (let _name_6=(u fm_name_show _6508) in (let _expr_7=(u (u fm_term_show_go _6509) (u fm_mpath_o _path_2)) in (let _body_8=(u (u fm_term_show_go (u _6510 (u (u fm_term_var _6508) 0))) (u fm_mpath_i _path_2)) in (u string_flatten (u (u list_cons "let ") (u (u list_cons _name_6) (u (u list_cons " = ") (u (u list_cons _expr_7) (u (u list_cons "; ") (u (u list_cons _body_8) list_nil))))))))))); (7,f) -> u f (\_6511 _6512 _6513-> (let _name_6=(u fm_name_show _6511) in (let _expr_7=(u (u fm_term_show_go _6512) (u fm_mpath_o _path_2)) in (let _body_8=(u (u fm_term_show_go (u _6513 (u (u fm_term_var _6511) 0))) (u fm_mpath_i _path_2)) in (u string_flatten (u (u list_cons "def ") (u (u list_cons _name_6) (u (u list_cons " = ") (u (u list_cons _expr_7) (u (u list_cons "; ") (u (u list_cons _body_8) list_nil))))))))))); (8,f) -> u f (\_6514 _6515 _6516-> (let _term_6=(u (u fm_term_show_go _6515) (u fm_mpath_o _path_2)) in (let _type_7=(u (u fm_term_show_go _6516) (u fm_mpath_i _path_2)) in (u string_flatten (u (u list_cons _term_6) (u (u list_cons "::") (u (u list_cons _type_7) list_nil))))))); (9,f) -> u f (\_6517 _6518 _6519-> (let _name_6=(u fm_name_show _6517) in (u string_flatten (u (u list_cons "?") (u (u list_cons _name_6) list_nil))))); (10,f) -> u f (\_6520-> "_"); (11,f) -> u f (\_6521-> (u string_flatten (u (u list_cons (u nat_show _6521)) list_nil))); (12,f) -> u f (\_6522-> (u string_flatten (u (u list_cons "'") (u (u list_cons (u fm_escape_char _6522)) (u (u list_cons "'") list_nil))))); (13,f) -> u f (\_6523-> (u string_flatten (u (u list_cons "\"") (u (u list_cons (u fm_escape _6523)) (u (u list_cons "\"") list_nil))))); (14,f) -> u f (\_6524 _6525 _6526 _6527 _6528 _6529-> (let _expr_9=(u (u fm_term_show_go _6525) (u fm_mpath_o _path_2)) in (let _name_10=(u fm_name_show _6526) in (let _wyth_11=(u (u string_join "") (u (u list_mapped _6527) (\_defn_11-> (let _6530 = _defn_11 in (case _6530 of {(0,f) -> u f (\_6531 _6532 _6533 _6534 _6535 _6536-> (let _name_18=(u fm_name_show _6533) in (let _type_19=(u (u fm_term_show_go _6535) maybe_none) in (let _term_20=(u (u fm_term_show_go _6534) maybe_none) in (u string_flatten (u (u list_cons _name_18) (u (u list_cons ": ") (u (u list_cons _type_19) (u (u list_cons " = ") (u (u list_cons _term_20) (u (u list_cons ";") list_nil))))))))))); }))))) in (let _cses_12=(u map_to_list _6528) in (let _cses_13=(u (u string_join "") (u (u list_mapped _cses_12) (\_x_13-> (let _name_14=(u fm_name_from_bits (u pair_fst _x_13)) in (let _term_15=(u (u fm_term_show_go (u pair_snd _x_13)) maybe_none) in (u string_flatten (u (u list_cons _name_14) (u (u list_cons ": ") (u (u list_cons _term_15) (u (u list_cons "; ") list_nil)))))))))) in (let _moti_14=(let _6537 = _6529 in (case _6537 of {(0,f) -> u f (""); (1,f) -> u f (\_6538-> (u string_flatten (u (u list_cons ": ") (u (u list_cons (u (u fm_term_show_go _6538) maybe_none)) list_nil)))); })) in (u string_flatten (u (u list_cons "case ") (u (u list_cons _expr_9) (u (u list_cons " as ") (u (u list_cons _name_10) (u (u list_cons _wyth_11) (u (u list_cons " { ") (u (u list_cons _cses_13) (u (u list_cons "}") (u (u list_cons _moti_14) list_nil))))))))))))))))); (15,f) -> u f (\_6539 _6540-> (u (u fm_term_show_go _6540) _path_2)); }))); (1,f) -> u f (\_6541-> _6541); }))))
fm_term_show = (\_term_1-> (u (u fm_term_show_go _term_1) maybe_none))
fm_error_relevant = (\_errors_1-> (\_got_2-> (let _6542 = _errors_1 in (case _6542 of {(0,f) -> u f (list_nil); (1,f) -> u f (\_6543 _6544-> (let _keep_5=(let _6545 = _6543 in (case _6545 of {(0,f) -> u f (\_6546 _6547 _6548 _6549-> ((not _got_2))); (1,f) -> u f (\_6550 _6551 _6552 _6553 _6554-> bool_true); (2,f) -> u f (\_6555-> bool_false); (3,f) -> u f (\_6556-> bool_false); (4,f) -> u f (\_6557 _6558-> bool_false); (5,f) -> u f (\_6559 _6560-> ((not _got_2))); (6,f) -> u f (\_6561 _6562 _6563-> ((not _got_2))); })) in (let _got_6=(let _6564 = _6543 in (case _6564 of {(0,f) -> u f (\_6565 _6566 _6567 _6568-> bool_true); (1,f) -> u f (\_6569 _6570 _6571 _6572 _6573-> _got_2); (2,f) -> u f (\_6574-> _got_2); (3,f) -> u f (\_6575-> _got_2); (4,f) -> u f (\_6576 _6577-> _got_2); (5,f) -> u f (\_6578 _6579-> bool_true); (6,f) -> u f (\_6580 _6581 _6582-> _got_2); })) in (let _tail_7=(u (u fm_error_relevant _6544) _got_6) in (let _6583 = _keep_5 in (if _6583 then (u (u list_cons _6543) _tail_7) else _tail_7)))))); }))))
fm_context_show = (\_context_1-> (let _6584 = _context_1 in (case _6584 of {(0,f) -> u f (""); (1,f) -> u f (\_6585 _6586-> (let _6587 = _6585 in (case _6587 of {(0,f) -> u f (\_6588 _6589-> (let _name_6=(u fm_name_show _6588) in (let _type_7=(u fm_term_show (u (u fm_term_normalize _6589) map_new)) in (let _rest_8=(u fm_context_show _6586) in (u string_flatten (u (u list_cons _rest_8) (u (u list_cons "- ") (u (u list_cons _name_6) (u (u list_cons ": ") (u (u list_cons _type_7) (u (u list_cons "\n") list_nil))))))))))); }))); })))
fm_term_expand_at = (\_path_1-> (\_term_2-> (\_defs_3-> (u (u (u fm_term_patch_at _path_1) _term_2) (\_term_4-> (let _6590 = _term_4 in (case _6590 of {(0,f) -> u f (\_6591 _6592-> _term_4); (1,f) -> u f (\_6593-> (let _6594 = (u (u fm_get _6593) _defs_3) in (case _6594 of {(0,f) -> u f ((u fm_term_ref _6593)); (1,f) -> u f (\_6595-> (let _6596 = _6595 in (case _6596 of {(0,f) -> u f (\_6597 _6598 _6599 _6600 _6601 _6602-> _6600); }))); }))); (2,f) -> u f (_term_4); (3,f) -> u f (\_6603 _6604 _6605 _6606 _6607-> _term_4); (4,f) -> u f (\_6608 _6609-> _term_4); (5,f) -> u f (\_6610 _6611-> _term_4); (6,f) -> u f (\_6612 _6613 _6614-> _term_4); (7,f) -> u f (\_6615 _6616 _6617-> _term_4); (8,f) -> u f (\_6618 _6619 _6620-> _term_4); (9,f) -> u f (\_6621 _6622 _6623-> _term_4); (10,f) -> u f (\_6624-> _term_4); (11,f) -> u f (\_6625-> _term_4); (12,f) -> u f (\_6626-> _term_4); (13,f) -> u f (\_6627-> _term_4); (14,f) -> u f (\_6628 _6629 _6630 _6631 _6632 _6633-> _term_4); (15,f) -> u f (\_6634 _6635-> _term_4); })))))))
fm_term_expand_ct = (\_term_1-> (\_defs_2-> (\_arity_3-> (let _6636 = _term_1 in (case _6636 of {(0,f) -> u f (\_6637 _6638-> (u (u fm_term_var _6637) _6638)); (1,f) -> u f (\_6639-> (let _expand_5=bool_false in (let _expand_6=(((((((_6639::String) == "Nat.succ")) && (((_arity_3::Integer) > 1)))) || _expand_5)) in (let _expand_7=(((((((_6639::String) == "Nat.zero")) && (((_arity_3::Integer) > 0)))) || _expand_6)) in (let _expand_8=(((((((_6639::String) == "Bool.true")) && (((_arity_3::Integer) > 0)))) || _expand_7)) in (let _expand_9=(((((((_6639::String) == "Bool.false")) && (((_arity_3::Integer) > 0)))) || _expand_8)) in (let _6640 = _expand_9 in (if _6640 then (let _6641 = (u (u fm_get _6639) _defs_2) in (case _6641 of {(0,f) -> u f ((u fm_term_ref _6639)); (1,f) -> u f (\_6642-> (let _6643 = _6642 in (case _6643 of {(0,f) -> u f (\_6644 _6645 _6646 _6647 _6648 _6649-> _6647); }))); })) else (u fm_term_ref _6639))))))))); (2,f) -> u f (fm_term_typ); (3,f) -> u f (\_6650 _6651 _6652 _6653 _6654-> (u (u (u (u (u fm_term_all _6650) _6651) _6652) (u (u (u fm_term_expand_ct _6653) _defs_2) 0)) (\_s_9-> (\_x_10-> (u (u (u fm_term_expand_ct (u (u _6654 _s_9) _x_10)) _defs_2) 0))))); (4,f) -> u f (\_6655 _6656-> (u (u fm_term_lam _6655) (\_x_6-> (u (u (u fm_term_expand_ct (u _6656 _x_6)) _defs_2) 0)))); (5,f) -> u f (\_6657 _6658-> (u (u fm_term_app (u (u (u fm_term_expand_ct _6657) _defs_2) (u nat_succ _arity_3))) (u (u (u fm_term_expand_ct _6658) _defs_2) 0))); (6,f) -> u f (\_6659 _6660 _6661-> (u (u (u fm_term_let _6659) (u (u (u fm_term_expand_ct _6660) _defs_2) 0)) (\_x_7-> (u (u (u fm_term_expand_ct (u _6661 _x_7)) _defs_2) 0)))); (7,f) -> u f (\_6662 _6663 _6664-> (u (u (u fm_term_def _6662) (u (u (u fm_term_expand_ct _6663) _defs_2) 0)) (\_x_7-> (u (u (u fm_term_expand_ct (u _6664 _x_7)) _defs_2) 0)))); (8,f) -> u f (\_6665 _6666 _6667-> (u (u (u fm_term_ann _6665) (u (u (u fm_term_expand_ct _6666) _defs_2) 0)) (u (u (u fm_term_expand_ct _6667) _defs_2) 0))); (9,f) -> u f (\_6668 _6669 _6670-> (u (u (u fm_term_gol _6668) _6669) _6670)); (10,f) -> u f (\_6671-> (u fm_term_hol _6671)); (11,f) -> u f (\_6672-> (u fm_term_nat _6672)); (12,f) -> u f (\_6673-> (u fm_term_chr _6673)); (13,f) -> u f (\_6674-> (u fm_term_str _6674)); (14,f) -> u f (\_6675 _6676 _6677 _6678 _6679 _6680-> _term_1); (15,f) -> u f (\_6681 _6682-> (u (u fm_term_ori _6681) _6682)); })))))
fm_term_expand = (\_dref_1-> (\_term_2-> (\_defs_3-> (let _term_4=(u (u fm_term_normalize _term_2) map_new) in (let _term_5=(u (u (u list_for _dref_1) _term_4) (\_path_5-> (\_term_6-> (let _term_7=(u (u (u fm_term_expand_at _path_5) _term_6) _defs_3) in (let _term_8=(u (u fm_term_normalize _term_7) map_new) in (let _term_9=(u (u (u fm_term_expand_ct _term_8) _defs_3) 0) in (let _term_10=(u (u fm_term_normalize _term_9) map_new) in _term_10))))))) in _term_5)))))
fm_error_show = (\_error_1-> (\_defs_2-> (let _6683 = _error_1 in (case _6683 of {(0,f) -> u f (\_6684 _6685 _6686 _6687-> (let _expected_7=(let _6688 = _6685 in (case _6688 of {(0,f) -> u f (\_6689-> _6689); (1,f) -> u f (\_6690-> (u fm_term_show (u (u fm_term_normalize _6690) map_new))); })) in (let _detected_8=(let _6691 = _6686 in (case _6691 of {(0,f) -> u f (\_6692-> _6692); (1,f) -> u f (\_6693-> (u fm_term_show (u (u fm_term_normalize _6693) map_new))); })) in (u string_flatten (u (u list_cons "Type mismatch.\n") (u (u list_cons "- Expected: ") (u (u list_cons _expected_7) (u (u list_cons "\n") (u (u list_cons "- Detected: ") (u (u list_cons _detected_8) (u (u list_cons "\n") (u (u list_cons (let _6694 = _6687 in (case _6694 of {(0,f) -> u f (""); (1,f) -> u f (\_6695 _6696-> (u string_flatten (u (u list_cons "With context:\n") (u (u list_cons (u fm_context_show _6687)) list_nil)))); }))) list_nil)))))))))))); (1,f) -> u f (\_6697 _6698 _6699 _6700 _6701-> (let _goal_name_8=(u string_flatten (u (u list_cons "Goal ?") (u (u list_cons (u fm_name_show _6697)) (u (u list_cons ":\n") list_nil)))) in (let _with_type_9=(let _6702 = _6700 in (case _6702 of {(0,f) -> u f (""); (1,f) -> u f (\_6703-> (let _goal_10=(u (u (u fm_term_expand _6698) _6703) _defs_2) in (u string_flatten (u (u list_cons "With type: ") (u (u list_cons (let _6704 = _6699 in (if _6704 then (u (u fm_term_show_go _goal_10) (u maybe_some (\_x_11-> _x_11))) else (u fm_term_show _goal_10)))) (u (u list_cons "\n") list_nil)))))); })) in (let _with_ctxt_10=(let _6705 = _6701 in (case _6705 of {(0,f) -> u f (""); (1,f) -> u f (\_6706 _6707-> (u string_flatten (u (u list_cons "With ctxt:\n") (u (u list_cons (u fm_context_show _6701)) list_nil)))); })) in (u string_flatten (u (u list_cons _goal_name_8) (u (u list_cons _with_type_9) (u (u list_cons _with_ctxt_10) list_nil)))))))); (2,f) -> u f (\_6708-> (u string_flatten (u (u list_cons "Waiting for '") (u (u list_cons _6708) (u (u list_cons "'.") list_nil))))); (3,f) -> u f (\_6709-> (u string_flatten (u (u list_cons "Error on dependency '") (u (u list_cons _6709) (u (u list_cons "'.") list_nil))))); (4,f) -> u f (\_6710 _6711-> (u string_flatten (u (u list_cons "Patching: ") (u (u list_cons (u fm_term_show _6711)) list_nil)))); (5,f) -> u f (\_6712 _6713-> (u string_flatten (u (u list_cons "Undefined reference: ") (u (u list_cons (u fm_name_show _6713)) (u (u list_cons "\n") list_nil))))); (6,f) -> u f (\_6714 _6715 _6716-> (let _term_6=(u fm_term_show _6715) in (let _context_7=(u fm_context_show _6716) in (u string_flatten (u (u list_cons "Can't infer type of: ") (u (u list_cons _term_6) (u (u list_cons "\n") (u (u list_cons "With ctxt:\n") (u (u list_cons _context_7) list_nil))))))))); }))))
fm_error_origin = (\_error_1-> (let _6717 = _error_1 in (case _6717 of {(0,f) -> u f (\_6718 _6719 _6720 _6721-> _6718); (1,f) -> u f (\_6722 _6723 _6724 _6725 _6726-> maybe_none); (2,f) -> u f (\_6727-> maybe_none); (3,f) -> u f (\_6728-> maybe_none); (4,f) -> u f (\_6729 _6730-> maybe_none); (5,f) -> u f (\_6731 _6732-> _6731); (6,f) -> u f (\_6733 _6734 _6735-> _6733); })))
fm_defs_report_go = (\_defs_1-> (\_list_2-> (\_errs_3-> (\_typs_4-> (let _6736 = _list_2 in (case _6736 of {(0,f) -> u f ((u string_flatten (u (u list_cons _typs_4) (u (u list_cons "\n") (u (u list_cons (let _6737 = _errs_3 in (if null (_6737::String) then "All terms check." else _errs_3))) list_nil))))); (1,f) -> u f (\_6738 _6739-> (let _name_7=_6738 in (let _6740 = (u (u fm_get _name_7) _defs_1) in (case _6740 of {(0,f) -> u f ((u (u (u (u fm_defs_report_go _defs_1) _6739) _errs_3) _typs_4)); (1,f) -> u f (\_6741-> (let _6742 = _6741 in (case _6742 of {(0,f) -> u f (\_6743 _6744 _6745 _6746 _6747 _6748-> (let _typs_15=(u string_flatten (u (u list_cons _typs_4) (u (u list_cons _name_7) (u (u list_cons ": ") (u (u list_cons (u fm_term_show _6747)) (u (u list_cons "\n") list_nil)))))) in (let _6749 = _6748 in (case _6749 of {(0,f) -> u f ((u (u (u (u fm_defs_report_go _defs_1) _6739) _errs_3) _typs_15)); (1,f) -> u f ((u (u (u (u fm_defs_report_go _defs_1) _6739) _errs_3) _typs_15)); (2,f) -> u f ((u (u (u (u fm_defs_report_go _defs_1) _6739) _errs_3) _typs_15)); (3,f) -> u f (\_6750-> (let _6751 = _6750 in (case _6751 of {(0,f) -> u f ((u (u (u (u fm_defs_report_go _defs_1) _6739) _errs_3) _typs_15)); (1,f) -> u f (\_6752 _6753-> (let _name_str_19=(u fm_name_show _6745) in (let _rel_errs_20=(u (u fm_error_relevant _6750) bool_false) in (let _6754 = _rel_errs_20 in (case _6754 of {(0,f) -> u f ((u (u (u (u fm_defs_report_go _defs_1) _6739) _errs_3) _typs_15)); (1,f) -> u f (\_6755 _6756-> (let _rel_msgs_23=(u (u list_mapped _rel_errs_20) (\_err_23-> (u string_flatten (u (u list_cons (u (u fm_error_show _err_23) _defs_1)) (u (u list_cons (let _6757 = (u fm_error_origin _err_23) in (case _6757 of {(0,f) -> u f (""); (1,f) -> u f (\_6758-> (let _6759 = _6758 in (case _6759 of {(0,f) -> u f (\_6760 _6761 _6762-> (u string_flatten (u (u list_cons "Inside '") (u (u list_cons _6743) (u (u list_cons "':\n") (u (u list_cons (u (u (u fm_highlight _6744) _6761) _6762)) (u (u list_cons "\n") list_nil))))))); }))); }))) list_nil))))) in (let _errs_24=(u string_flatten (u (u list_cons _errs_3) (u (u list_cons (u (u string_join "\n") _rel_msgs_23)) (u (u list_cons "\n") list_nil)))) in (u (u (u (u fm_defs_report_go _defs_1) _6739) _errs_24) _typs_15)))); }))))); }))); })))); }))); })))); }))))))
fm_defs_report = (\_defs_1-> (\_list_2-> (u (u (u (u fm_defs_report_go _defs_1) _list_2) "") "")))
fm_checker_io_one = (\_name_1-> (u (u (u io_monad (\_m_bind_2-> (\_m_pure_3-> _m_bind_2))) (u (u fm_synth_one _name_1) map_new)) (\_new_defs_2-> (let _6763 = _new_defs_2 in (case _6763 of {(0,f) -> u f ((u io_print (u (u fm_defs_report map_new) (u (u list_cons _name_1) list_nil)))); (1,f) -> u f (\_6764-> (u io_print (u (u fm_defs_report _6764) (u (u list_cons _name_1) list_nil)))); })))))
map_keys_go = (\_xs_2-> (\_key_3-> (\_list_4-> (let _6765 = _xs_2 in (case _6765 of {(0,f) -> u f (_list_4); (1,f) -> u f (\_6766 _6767 _6768-> (let _list0_8=(let _6769 = _6766 in (case _6769 of {(0,f) -> u f (_list_4); (1,f) -> u f (\_6770-> (u (u list_cons (u bits_reverse _key_3)) _list_4)); })) in (let _list1_9=(u (u (u map_keys_go _6767) (u bits_o _key_3)) _list0_8) in (let _list2_10=(u (u (u map_keys_go _6768) (u bits_i _key_3)) _list1_9) in _list2_10)))); })))))
map_keys = (\_xs_2-> (u list_reverse (u (u (u map_keys_go _xs_2) bits_e) list_nil)))
fm_synth_many = (\_names_1-> (\_defs_2-> (let _6771 = _names_1 in (case _6771 of {(0,f) -> u f ((u (u io_monad (\_m_bind_3-> (\_m_pure_4-> _m_pure_4))) _defs_2)); (1,f) -> u f (\_6772 _6773-> (u (u (u io_monad (\_m_bind_5-> (\_m_pure_6-> _m_bind_5))) (u (u fm_synth_one _6772) _defs_2)) (\_new_defs_5-> (let _6774 = _new_defs_5 in (case _6774 of {(0,f) -> u f ((u (u fm_synth_many _6773) _defs_2)); (1,f) -> u f (\_6775-> (u (u fm_synth_many _6773) _6775)); }))))); }))))
fm_synth_file = (\_file_1-> (\_defs_2-> (u (u (u io_monad (\_m_bind_3-> (\_m_pure_4-> _m_bind_3))) (u io_get_file _file_1)) (\_code_3-> (let _read_4=(u (u (u fm_defs_read _file_1) _code_3) _defs_2) in (let _6776 = _read_4 in (case _6776 of {(0,f) -> u f (\_6777-> (u (u io_monad (\_m_bind_6-> (\_m_pure_7-> _m_pure_7))) (u either_left _6777))); (1,f) -> u f (\_6778-> (let _file_defs_6=_6778 in (let _file_keys_7=(u map_keys _file_defs_6) in (let _file_nams_8=(u (u list_mapped _file_keys_7) fm_name_from_bits) in (u (u (u io_monad (\_m_bind_9-> (\_m_pure_10-> _m_bind_9))) (u (u fm_synth_many _file_nams_8) _file_defs_6)) (\_defs_9-> (u (u io_monad (\_m_bind_10-> (\_m_pure_11-> _m_pure_11))) (u either_right (u (u pair_new _file_nams_8) _defs_9))))))))); })))))))
fm_checker_io_file = (\_file_1-> (u (u (u io_monad (\_m_bind_2-> (\_m_pure_3-> _m_bind_2))) (u (u fm_synth_file _file_1) map_new)) (\_loaded_2-> (let _6779 = _loaded_2 in (case _6779 of {(0,f) -> u f (\_6780-> (u (u (u io_monad (\_m_bind_4-> (\_m_pure_5-> _m_bind_4))) (u io_print (u string_flatten (u (u list_cons "On '") (u (u list_cons _file_1) (u (u list_cons "':") list_nil)))))) (\__4-> (u io_print _6780)))); (1,f) -> u f (\_6781-> (let _6782 = _6781 in (case _6782 of {(0,f) -> u f (\_6783 _6784-> (let _nams_6=_6783 in (let _defs_7=_6784 in (u io_print (u (u fm_defs_report _defs_7) _nams_6))))); }))); })))))
io_purify = (\_io_2-> (let _6785 = _io_2 in (case _6785 of {(0,f) -> u f (\_6786-> _6786); (1,f) -> u f (\_6787 _6788 _6789-> (u io_purify (u _6789 ""))); })))
fm_checker_code = (\_code_1-> (let _6790 = (u (u (u fm_defs_read "Main.fm") _code_1) map_new) in (case _6790 of {(0,f) -> u f (\_6791-> _6791); (1,f) -> u f (\_6792-> (u io_purify (let _defs_3=_6792 in (let _nams_4=(u (u list_mapped (u map_keys _defs_3)) fm_name_from_bits) in (u (u (u io_monad (\_m_bind_5-> (\_m_pure_6-> _m_bind_5))) (u (u fm_synth_many _nams_4) _defs_3)) (\_defs_5-> (u (u io_monad (\_m_bind_6-> (\_m_pure_7-> _m_pure_7))) (u (u fm_defs_report _defs_5) _nams_4)))))))); })))
fm_term_read = (\_code_1-> (let _6793 = (u (u fm_parser_term 0) _code_1) in (case _6793 of {(0,f) -> u f (\_6794 _6795 _6796-> maybe_none); (1,f) -> u f (\_6797 _6798 _6799-> (u maybe_some _6799)); })))
fm_compute_io_one = (\_name_1-> (u (u (u io_monad (\_m_bind_2-> (\_m_pure_3-> _m_bind_2))) (u io_get_file (u fm_synth_file_of _name_1))) (\_code_2-> (let _6800 = (u (u (u fm_defs_read (((_name_1::String) ++ ".fm"))) _code_2) map_new) in (case _6800 of {(0,f) -> u f (\_6801-> (u io_print _6801)); (1,f) -> u f (\_6802-> (let _defs_4=_6802 in (let _defn_5=(u (u fm_get _name_1) _defs_4) in (let _6803 = _defn_5 in (case _6803 of {(0,f) -> u f ((u io_print ((("Term '"::String) ++ (((_name_1::String) ++ "' not found.")))))); (1,f) -> u f (\_6804-> (let _6805 = _6804 in (case _6805 of {(0,f) -> u f (\_6806 _6807 _6808 _6809 _6810 _6811-> (u io_print (u fm_term_show (u (u fm_term_normalize _6809) _defs_4)))); }))); }))))); })))))
fm = (let ___1=fm_to_core_io_one in (let ___2=fm_checker_io_one in (let ___3=fm_checker_io_file in (let ___4=fm_checker_code in (let ___5=fm_term_read in (let ___6=fm_compute_io_one in (u (u io_monad (\_m_bind_7-> (\_m_pure_8-> _m_pure_8))) unit_new)))))))


App.Kaelin.Map.creature.change_ap(
  value: I32
  pos: App.Kaelin.Coord
  map: App.Kaelin.Map
): Pair(I32, App.Kaelin.Map)

  change_ap = ((val, crea)
    open crea
    open crea.hero as hero
    let new_ap = I32.min(I32.add(crea.ap, value), hero.max_ap)
    crea@ap <- new_ap
  ):: I32 -> App.Kaelin.Creature -> App.Kaelin.Creature
  
  map = App.Kaelin.Map.creature.modify_at(change_ap(value), pos, map)
  {value, map}

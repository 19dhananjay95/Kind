#event #stt !state = ((stt # (App.State.local App.Playground.State)) #local #global local); ((state #state (IO (Maybe (App.State.local App.Playground.State)))) #state.device #state.window #state.mouse_over #state.code #state.output #state.kind_version ((((((((((event #event (IO (Maybe (App.State.local App.Playground.State)))) #event.time #event.user #event.info (App.pass App.Playground.State)) #event.time #event.info ((event.info #event.info (IO (Maybe (App.State.local App.Playground.State)))) #event.info.screen_size #event.info.mouse_pos ((event.info.screen_size #screen_size (IO (Maybe (App.State.local App.Playground.State)))) #screen_size.fst #screen_size.snd !device = (Device.classify screen_size.fst); !stt = ((state # App.Playground.State.local) #device #window #mouse_over #code #output #kind_version ((((((App.Playground.State.local.new device^1) window) mouse_over) code) output) kind_version)); ((App.set_local App.Playground.State) stt)))) #event.time #event.button (App.pass App.Playground.State)) #event.time #event.button (App.pass App.Playground.State)) #event.time #event.code (App.pass App.Playground.State)) #event.time #event.code (App.pass App.Playground.State)) #event.time #event.id ((App.set_local App.Playground.State) ((App.Playground.set_mouse_over event.id) state))) #event.time #event.id #event.action !window = (((((state.device #state.device App.Playground.Window) App.Playground.Window.terminal) App.Playground.Window.input) App.Playground.Window.input) App.Playground.Window.input); (((((String.eql event.id) "btn_type_check") # (IO (Maybe (App.State.local App.Playground.State)))) ((((String.is_empty state.code) # (IO (Maybe (App.State.local App.Playground.State)))) !stt = ((App.Playground.set_output "How can I type check an empty code? haha") state); ((App.set_local App.Playground.State) stt)) ((((((Monad.bind IO) IO.monad) String) (Maybe (App.State.local App.Playground.State))) (IO.request ((String.concat "http://localhost:3030/api/check_term?code=") state.code))) #checked !stt = ((App.Playground.set_output checked) state); !stt = ((App.Playground.set_window window) state); ((App.set_local App.Playground.State) stt)))) (((((String.eql event.id) "btn_run_code") # (IO (Maybe (App.State.local App.Playground.State)))) ((((String.is_empty state.code) # (IO (Maybe (App.State.local App.Playground.State)))) !stt = ((state # App.Playground.State.local) #device #window #mouse_over #code #output #kind_version ((((((App.Playground.State.local.new device) window) mouse_over) code) "How can I type check an empty code? haha") kind_version)); ((App.set_local App.Playground.State) stt)) ((((((Monad.bind IO) IO.monad) String) (Maybe (App.State.local App.Playground.State))) (IO.request ((String.concat "http://localhost:3030/api/run_term?code=") state.code))) #checked !stt = ((App.Playground.set_output checked) state); !stt = ((App.Playground.set_window window) state); ((App.set_local App.Playground.State) stt)))) (((((String.eql event.id) "terminal_view") # (IO (Maybe (App.State.local App.Playground.State)))) !stt = ((App.Playground.set_window App.Playground.Window.terminal) state); ((App.set_local App.Playground.State) stt)) (((((String.eql event.id) "input_view") # (IO (Maybe (App.State.local App.Playground.State)))) !stt = ((App.Playground.set_window App.Playground.Window.input) state); ((App.set_local App.Playground.State) stt)) (App.pass App.Playground.State)))))) #event.time #event.id #event.text (((((String.eql event.id) "input_code") # (IO (Maybe (App.State.local App.Playground.State)))) ((App.set_local App.Playground.State) ((App.Playground.set_input event.text) state))) (App.pass App.Playground.State))))
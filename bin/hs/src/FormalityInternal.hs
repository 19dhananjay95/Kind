module FormalityInternal where
import Unsafe.Coerce
import Data.Word
import Data.Bits
import Debug.Trace
import System.Exit
u = unsafeCoerce
run p = case p of {
  (1,f) -> (u f (\query param cont-> case query of {
    "print"    -> do { putStrLn param; run (cont ()); };
    "exit"     -> do { exitFailure; run (cont ()); };
    "get_line" -> do { line <- getLine; run (u cont line); };
    "get_file" -> do { line <- readFile param; run (u cont line); };
    otherwise  -> do { u cont (); };
  }));
  (0,f) -> (u f (\value-> do { (return :: a -> IO a) value; }));
}
word_to_u16       w        = u word_to_u16_go 0 w 0
word_to_u16_go 16 w      x = u x
word_to_u16_go  i (0,f)  x = u word_to_u16_go (i+1) (0,\t-> t) (x::Word16)
word_to_u16_go  i (1,f)  x = u f (\w-> word_to_u16_go (i+1) w x)
word_to_u16_go  i (2,f)  x = u f (\w-> word_to_u16_go (i+1) w (x .|. (shiftL 1 i)))
u16_to_word       x        = u u16_to_word_go 0 x (0,\t-> t)
u16_to_word_go 16 x      w = u w
u16_to_word_go  i x      w = u u16_to_word_go (i+1) (x::Word16) (if (shiftR x (16-i-1) .&. 1) > 0 then (2,\t-> t w) else (1,\t-> t w))
io = (\_a_1-> ())
io_ask = (\_query_2-> (\_param_3-> (\_then_4-> (1,\t-> t _query_2 _param_3 _then_4))))
io_bind = (\_a_3-> (\_f_4-> (let _0 = _a_3 in (case _0 of {(0,f) -> u f (\_1-> (u _f_4 _1)); (1,f) -> u f (\_2 _3 _4-> (u (u (u io_ask _2) _3) (\_x_8-> (u (u io_bind (u _4 _x_8)) _f_4)))); }))))
io_end = (\_value_2-> (0,\t-> t _value_2))
io_monad = (\_new_2-> (u (u _new_2 io_bind) io_end))
maybe = (\_a_1-> ())
map = (\_a_1-> ())
maybe_none = (0,\t-> t)
map_get = (\_bits_2-> (\_map_3-> (let _5 = _bits_2 in (case _5 of {(0,f) -> u f ((let _6 = _map_3 in (case _6 of {(0,f) -> u f (maybe_none); (1,f) -> u f (\_7 _8 _9-> _7); }))); (1,f) -> u f (\_10-> (let _11 = _map_3 in (case _11 of {(0,f) -> u f (maybe_none); (1,f) -> u f (\_12 _13 _14-> (u (u map_get _10) _13)); }))); (2,f) -> u f (\_15-> (let _16 = _map_3 in (case _16 of {(0,f) -> u f (maybe_none); (1,f) -> u f (\_17 _18 _19-> (u (u map_get _15) _19)); }))); }))))
bits_e = (0,\t-> t)
bool_false = False
bool_and = (\a0-> \a1-> (a0 && a1))
bool_true = True
cmp_as_lte = (\_cmp_1-> (let _20 = _cmp_1 in (case _20 of {(0,f) -> u f (bool_true); (1,f) -> u f (bool_true); (2,f) -> u f (bool_false); })))
cmp_ltn = (0,\t-> t)
cmp_gtn = (2,\t-> t)
word_cmp_go = (\_a_2-> (\_b_3-> (\_c_4-> (let _21 = _a_2 in (case _21 of {(0,f) -> u f ((\_b_5-> _c_4)); (1,f) -> u f (\_22-> (\_b_7-> (let _23 = _b_7 in (case _23 of {(0,f) -> u f ((\_a_pred_8-> _c_4)); (1,f) -> u f (\_24-> (\_a_pred_10-> (u (u (u word_cmp_go _a_pred_10) _24) _c_4))); (2,f) -> u f (\_25-> (\_a_pred_10-> (u (u (u word_cmp_go _a_pred_10) _25) cmp_ltn))); })) _22)); (2,f) -> u f (\_26-> (\_b_7-> (let _27 = _b_7 in (case _27 of {(0,f) -> u f ((\_a_pred_8-> _c_4)); (1,f) -> u f (\_28-> (\_a_pred_10-> (u (u (u word_cmp_go _a_pred_10) _28) cmp_gtn))); (2,f) -> u f (\_29-> (\_a_pred_10-> (u (u (u word_cmp_go _a_pred_10) _29) _c_4))); })) _26)); })) _b_3)))
cmp_eql = (1,\t-> t)
word_cmp = (\_a_2-> (\_b_3-> (u (u (u word_cmp_go _a_2) _b_3) cmp_eql)))
word_lte = (\_a_2-> (\_b_3-> (u cmp_as_lte (u (u word_cmp _a_2) _b_3))))
nat_succ = (\_pred_1-> 1+_pred_1)
nat_zero = 0
u16_lte = (\a0-> \a1-> ((a0::Word16) <= a1))
u16_btw = (\_a_1-> (\_b_2-> (\_c_3-> (((((_a_1::Word16) <= _b_2)) && (((_b_2::Word16) <= _c_3)))))))
u16_new = (\_value_1-> (word_to_u16 _value_1))
word_e = (0,\t-> t)
word = (\_size_1-> ())
word_i = (\_pred_2-> (2,\t-> t _pred_2))
word_o = (\_pred_2-> (1,\t-> t _pred_2))
word_subber = (\_a_2-> (\_b_3-> (\_c_4-> (let _30 = _a_2 in (case _30 of {(0,f) -> u f ((\_b_5-> word_e)); (1,f) -> u f (\_31-> (\_b_7-> (let _32 = _b_7 in (case _32 of {(0,f) -> u f ((\_a_pred_8-> word_e)); (1,f) -> u f (\_33-> (\_a_pred_10-> (let _34 = _c_4 in (if _34 then (u word_i (u (u (u word_subber _a_pred_10) _33) bool_true)) else (u word_o (u (u (u word_subber _a_pred_10) _33) bool_false)))))); (2,f) -> u f (\_35-> (\_a_pred_10-> (let _36 = _c_4 in (if _36 then (u word_o (u (u (u word_subber _a_pred_10) _35) bool_true)) else (u word_i (u (u (u word_subber _a_pred_10) _35) bool_true)))))); })) _31)); (2,f) -> u f (\_37-> (\_b_7-> (let _38 = _b_7 in (case _38 of {(0,f) -> u f ((\_a_pred_8-> word_e)); (1,f) -> u f (\_39-> (\_a_pred_10-> (let _40 = _c_4 in (if _40 then (u word_o (u (u (u word_subber _a_pred_10) _39) bool_false)) else (u word_i (u (u (u word_subber _a_pred_10) _39) bool_false)))))); (2,f) -> u f (\_41-> (\_a_pred_10-> (let _42 = _c_4 in (if _42 then (u word_i (u (u (u word_subber _a_pred_10) _41) bool_true)) else (u word_o (u (u (u word_subber _a_pred_10) _41) bool_false)))))); })) _37)); })) _b_3)))
word_sub = (\_a_2-> (\_b_3-> (u (u (u word_subber _a_2) _b_3) bool_false)))
u16_sub = (\a0-> \a1-> ((a0::Word16) - a1))
nat_apply = (\_n_2-> (\_f_3-> (\_x_4-> (let _43 = _n_2 in (if _43==0 then _x_4 else (u (u (u nat_apply (_43-1)) _f_3) (u _f_3 _x_4)))))))
word_inc = (\_word_2-> (let _44 = _word_2 in (case _44 of {(0,f) -> u f (word_e); (1,f) -> u f (\_45-> (u word_i _45)); (2,f) -> u f (\_46-> (u word_o (u word_inc _46))); })))
u16_inc = (\_a_1-> (let _47 = _a_1 in (u u16_new (u word_inc (u16_to_word _47)))))
word_zero = (\_size_1-> (let _48 = _size_1 in (if _48==0 then word_e else (u word_o (u word_zero (_48-1))))))
u16_zero = (u u16_new (u word_zero 16))
nat_to_u16 = (\a0-> (fromIntegral (a0::Integer)))
word_adder = (\_a_2-> (\_b_3-> (\_c_4-> (let _49 = _a_2 in (case _49 of {(0,f) -> u f ((\_b_5-> word_e)); (1,f) -> u f (\_50-> (\_b_7-> (let _51 = _b_7 in (case _51 of {(0,f) -> u f ((\_a_pred_8-> word_e)); (1,f) -> u f (\_52-> (\_a_pred_10-> (let _53 = _c_4 in (if _53 then (u word_i (u (u (u word_adder _a_pred_10) _52) bool_false)) else (u word_o (u (u (u word_adder _a_pred_10) _52) bool_false)))))); (2,f) -> u f (\_54-> (\_a_pred_10-> (let _55 = _c_4 in (if _55 then (u word_o (u (u (u word_adder _a_pred_10) _54) bool_true)) else (u word_i (u (u (u word_adder _a_pred_10) _54) bool_false)))))); })) _50)); (2,f) -> u f (\_56-> (\_b_7-> (let _57 = _b_7 in (case _57 of {(0,f) -> u f ((\_a_pred_8-> word_e)); (1,f) -> u f (\_58-> (\_a_pred_10-> (let _59 = _c_4 in (if _59 then (u word_o (u (u (u word_adder _a_pred_10) _58) bool_true)) else (u word_i (u (u (u word_adder _a_pred_10) _58) bool_false)))))); (2,f) -> u f (\_60-> (\_a_pred_10-> (let _61 = _c_4 in (if _61 then (u word_i (u (u (u word_adder _a_pred_10) _60) bool_true)) else (u word_o (u (u (u word_adder _a_pred_10) _60) bool_true)))))); })) _56)); })) _b_3)))
word_add = (\_a_2-> (\_b_3-> (u (u (u word_adder _a_2) _b_3) bool_false)))
u16_add = (\a0-> \a1-> ((a0::Word16) + a1))
cmp_as_eql = (\_cmp_1-> (let _62 = _cmp_1 in (case _62 of {(0,f) -> u f (bool_false); (1,f) -> u f (bool_true); (2,f) -> u f (bool_false); })))
word_eql = (\_a_2-> (\_b_3-> (u cmp_as_eql (u (u word_cmp _a_2) _b_3))))
u16_eql = (\a0-> \a1-> ((a0::Word16) == a1))
bits_o = (\_pred_1-> (1,\t-> t _pred_1))
bits_i = (\_pred_1-> (2,\t-> t _pred_1))
word_to_bits = (\_a_2-> (let _63 = _a_2 in (case _63 of {(0,f) -> u f (bits_e); (1,f) -> u f (\_64-> (u bits_o (u word_to_bits _64))); (2,f) -> u f (\_65-> (u bits_i (u word_to_bits _65))); })))
word_trim = (\_new_size_2-> (\_word_3-> (let _66 = _new_size_2 in (if _66==0 then word_e else (let _67 = _word_3 in (case _67 of {(0,f) -> u f ((u word_o (u (u word_trim (_66-1)) word_e))); (1,f) -> u f (\_68-> (u word_o (u (u word_trim (_66-1)) _68))); (2,f) -> u f (\_69-> (u word_i (u (u word_trim (_66-1)) _69))); }))))))
bits_concat = (\_a_1-> (\_b_2-> (let _70 = _a_1 in (case _70 of {(0,f) -> u f (_b_2); (1,f) -> u f (\_71-> (u bits_o (u (u bits_concat _71) _b_2))); (2,f) -> u f (\_72-> (u bits_i (u (u bits_concat _72) _b_2))); }))))
bits_reverse_tco = (\_a_1-> (\_r_2-> (let _73 = _a_1 in (case _73 of {(0,f) -> u f (_r_2); (1,f) -> u f (\_74-> (u (u bits_reverse_tco _74) (u bits_o _r_2))); (2,f) -> u f (\_75-> (u (u bits_reverse_tco _75) (u bits_i _r_2))); }))))
bits_reverse = (\_a_1-> (u (u bits_reverse_tco _a_1) bits_e))
fm_name_to_bits = (\_name_1-> (let _76 = _name_1 in (if null (_76::String) then bits_e else (let _chr_4=(fromIntegral (fromEnum (head _76 :: Char)) :: Word16) in (let _u16_5=(let _77 = (u (u (u u16_btw 65) _chr_4) 90) in (if _77 then (((_chr_4::Word16) - 65)) else (let _78 = (u (u (u u16_btw 97) _chr_4) 122) in (if _78 then (((_chr_4::Word16) - 71)) else (let _79 = (u (u (u u16_btw 48) _chr_4) 57) in (if _79 then (((_chr_4::Word16) + 4)) else (let _80 = (((46::Word16) == _chr_4)) in (if _80 then 62 else (let _81 = (((95::Word16) == _chr_4)) in (if _81 then 63 else 0)))))))))) in (let _bts_6=(let _82 = _u16_5 in (u word_to_bits (u (u word_trim 6) (u16_to_word _82)))) in (u (u bits_concat (u bits_reverse _bts_6)) (u fm_name_to_bits (tail _76)))))))))
fm_get = (\_name_2-> (\_map_3-> (u (u map_get (u fm_name_to_bits _name_2)) _map_3)))
string_cons = (\_head_1-> (\_tail_2-> ((toEnum (fromIntegral _head_1 :: Int) :: Char) : _tail_2)))
fm_synth_file_of = (\_name_1-> (let _83 = _name_1 in (if null (_83::String) then ".fm" else (let _84 = ((((fromIntegral (fromEnum (head _83 :: Char)) :: Word16)::Word16) == 46)) in (if _84 then ".fm" else (u (u string_cons (fromIntegral (fromEnum (head _83 :: Char)) :: Word16)) (u fm_synth_file_of (tail _83))))))))
io_get_file = (\_name_1-> (u (u (u io_ask "get_file") _name_1) (\_file_2-> (u io_end _file_2))))
parser_reply = (\_v_1-> ())
parser_reply_value = (\_idx_2-> (\_code_3-> (\_val_4-> (1,\t-> t _idx_2 _code_3 _val_4))))
parser_is_eof = (\_idx_1-> (\_code_2-> (let _85 = _code_2 in (if null (_85::String) then (u (u (u parser_reply_value _idx_1) _code_2) bool_true) else (u (u (u parser_reply_value _idx_1) _code_2) bool_false)))))
parser_reply_error = (\_idx_2-> (\_code_3-> (\_err_4-> (0,\t-> t _idx_2 _code_3 _err_4))))
parser = (\_v_1-> ())
maybe_some = (\_value_2-> (1,\t-> t _value_2))
parser_errorat_new = (\_idx_1-> (\_code_2-> (\_err_3-> (0,\t-> t _idx_1 _code_2 _err_3))))
nat_gtn = (\a0-> \a1-> ((a0::Integer) > a1))
parser_errorat_combine = (\_a_1-> (\_b_2-> (let _86 = _a_1 in (case _86 of {(0,f) -> u f (_b_2); (1,f) -> u f (\_87-> (let _88 = _b_2 in (case _88 of {(0,f) -> u f (_a_1); (1,f) -> u f (\_89-> (let _90 = _87 in (case _90 of {(0,f) -> u f (\_91 _92 _93-> (let _94 = _89 in (case _94 of {(0,f) -> u f (\_95 _96 _97-> (let _98 = (((_91::Integer) > _95)) in (if _98 then _a_1 else _b_2))); }))); }))); }))); }))))
parser_first_of_go = (\_pars_2-> (\_err_3-> (\_idx_4-> (\_code_5-> (let _99 = _pars_2 in (case _99 of {(0,f) -> u f ((let _100 = _err_3 in (case _100 of {(0,f) -> u f ((u (u (u parser_reply_error _idx_4) _code_5) "No parse.")); (1,f) -> u f (\_101-> (let _102 = _101 in (case _102 of {(0,f) -> u f (\_103 _104 _105-> (u (u (u parser_reply_error _103) _104) _105)); }))); }))); (1,f) -> u f (\_106 _107-> (let _parsed_8=(u (u _106 _idx_4) _code_5) in (let _108 = _parsed_8 in (case _108 of {(0,f) -> u f (\_109 _110 _111-> (let _neo_12=(u maybe_some (u (u (u parser_errorat_new _109) _110) _111)) in (let _err_13=(u (u parser_errorat_combine _neo_12) _err_3) in (u (u (u (u parser_first_of_go _107) _err_13) _idx_4) _code_5)))); (1,f) -> u f (\_112 _113 _114-> (u (u (u parser_reply_value _112) _113) _114)); })))); }))))))
parser_first_of = (\_pars_2-> (u (u parser_first_of_go _pars_2) maybe_none))
list_cons = (\_head_2-> (\_tail_3-> (1,\t-> t _head_2 _tail_3)))
list = (\_a_1-> ())
list_nil = (0,\t-> t)
parser_many_go = (\_parse_2-> (\_values_3-> (\_idx_4-> (\_code_5-> (let _115 = (u (u _parse_2 _idx_4) _code_5) in (case _115 of {(0,f) -> u f (\_116 _117 _118-> (u (u (u parser_reply_value _idx_4) _code_5) (u _values_3 list_nil))); (1,f) -> u f (\_119 _120 _121-> (u (u (u (u parser_many_go _parse_2) (\_xs_9-> (u _values_3 (u (u list_cons _121) _xs_9)))) _119) _120)); }))))))
parser_many = (\_parser_2-> (u (u parser_many_go _parser_2) (\_x_3-> _x_3)))
unit_new = ()
string_concat = (\a0-> \a1-> ((a0::String) ++ a1))
string_flatten_go = (\_xs_1-> (\_res_2-> (let _122 = _xs_1 in (case _122 of {(0,f) -> u f (_res_2); (1,f) -> u f (\_123 _124-> (u (u string_flatten_go _124) (((_res_2::String) ++ _123)))); }))))
string_flatten = (\_xs_1-> (u (u string_flatten_go _xs_1) ""))
string_nil = []
parser_text_go = (\_text_1-> (\_idx_2-> (\_code_3-> (let _125 = _text_1 in (if null (_125::String) then (u (u (u parser_reply_value _idx_2) _code_3) unit_new) else (let _126 = _code_3 in (if null (_126::String) then (let _error_6=(u string_flatten (u (u list_cons "Expected '") (u (u list_cons _text_1) (u (u list_cons "', found end of file.") list_nil)))) in (u (u (u parser_reply_error _idx_2) _code_3) _error_6)) else (let _127 = ((((fromIntegral (fromEnum (head _125 :: Char)) :: Word16)::Word16) == (fromIntegral (fromEnum (head _126 :: Char)) :: Word16))) in (if _127 then (u (u (u parser_text (tail _125)) (u nat_succ _idx_2)) (tail _126)) else (let _error_8=(u string_flatten (u (u list_cons "Expected '") (u (u list_cons _text_1) (u (u list_cons "', found '") (u (u list_cons (u (u string_cons (fromIntegral (fromEnum (head _126 :: Char)) :: Word16)) string_nil)) (u (u list_cons "'.") list_nil)))))) in (u (u (u parser_reply_error _idx_2) _code_3) _error_8)))))))))))
parser_text = (\_text_1-> (\_idx_2-> (\_code_3-> (let _128 = (u (u (u parser_text_go _text_1) _idx_2) _code_3) in (case _128 of {(0,f) -> u f (\_129 _130 _131-> (u (u (u parser_reply_error _idx_2) _code_3) _131)); (1,f) -> u f (\_132 _133 _134-> (u (u (u parser_reply_value _132) _133) _134)); })))))
parser_until_go = (\_until_2-> (\_parse_3-> (\_values_4-> (\_idx_5-> (\_code_6-> (let _until_reply_7=(u (u _until_2 _idx_5) _code_6) in (let _135 = _until_reply_7 in (case _135 of {(0,f) -> u f (\_136 _137 _138-> (let _reply_11=(u (u _parse_3 _idx_5) _code_6) in (let _139 = _reply_11 in (case _139 of {(0,f) -> u f (\_140 _141 _142-> (u (u (u parser_reply_error _140) _141) _142)); (1,f) -> u f (\_143 _144 _145-> (u (u (u (u (u parser_until_go _until_2) _parse_3) (\_xs_15-> (u _values_4 (u (u list_cons _145) _xs_15)))) _143) _144)); })))); (1,f) -> u f (\_146 _147 _148-> (u (u (u parser_reply_value _146) _147) (u _values_4 list_nil))); }))))))))
parser_until = (\_until_2-> (\_parse_3-> (u (u (u parser_until_go _until_2) _parse_3) (\_x_4-> _x_4))))
parser_one = (\_idx_1-> (\_code_2-> (let _149 = _code_2 in (if null (_149::String) then (u (u (u parser_reply_error _idx_1) _code_2) "Unexpected end of file.") else (u (u (u parser_reply_value (u nat_succ _idx_1)) (tail _149)) (fromIntegral (fromEnum (head _149 :: Char)) :: Word16))))))
fm_parser_spaces = (u parser_many (u parser_first_of (u (u list_cons (u parser_text " ")) (u (u list_cons (u parser_text "\t")) (u (u list_cons (u parser_text "\n")) (u (u list_cons (\_idx_1-> (\_code_2-> (let _150 = (u (u (u parser_text "//") _idx_1) _code_2) in (case _150 of {(0,f) -> u f (\_151 _152 _153-> (u (u (u parser_reply_error _151) _152) _153)); (1,f) -> u f (\_154 _155 _156-> (let _157 = (u (u (u (u parser_until (u parser_text "\n")) parser_one) _154) _155) in (case _157 of {(0,f) -> u f (\_158 _159 _160-> (u (u (u parser_reply_error _158) _159) _160)); (1,f) -> u f (\_161 _162 _163-> (u (u (u parser_reply_value _161) _162) unit_new)); }))); }))))) list_nil))))))
parser_many1 = (\_parser_2-> (\_idx_3-> (\_code_4-> (let _164 = (u (u _parser_2 _idx_3) _code_4) in (case _164 of {(0,f) -> u f (\_165 _166 _167-> (u (u (u parser_reply_error _165) _166) _167)); (1,f) -> u f (\_168 _169 _170-> (let _171 = (u (u (u parser_many _parser_2) _168) _169) in (case _171 of {(0,f) -> u f (\_172 _173 _174-> (u (u (u parser_reply_error _172) _173) _174)); (1,f) -> u f (\_175 _176 _177-> (u (u (u parser_reply_value _175) _176) (u (u list_cons _170) _177))); }))); })))))
fm_name_is_letter = (\_chr_1-> (let _178 = (u (u (u u16_btw 65) _chr_1) 90) in (if _178 then bool_true else (let _179 = (u (u (u u16_btw 97) _chr_1) 122) in (if _179 then bool_true else (let _180 = (u (u (u u16_btw 48) _chr_1) 57) in (if _180 then bool_true else (let _181 = (((46::Word16) == _chr_1)) in (if _181 then bool_true else (let _182 = (((95::Word16) == _chr_1)) in (if _182 then bool_true else (let _183 = (((94::Word16) == _chr_1)) in (if _183 then bool_true else bool_false)))))))))))))
fm_parser_letter = (\_idx_1-> (\_code_2-> (let _184 = _code_2 in (if null (_184::String) then (u (u (u parser_reply_error _idx_1) _code_2) "Unexpected eof.") else (let _185 = (u fm_name_is_letter (fromIntegral (fromEnum (head _184 :: Char)) :: Word16)) in (if _185 then (u (u (u parser_reply_value (u nat_succ _idx_1)) (tail _184)) (fromIntegral (fromEnum (head _184 :: Char)) :: Word16)) else (u (u (u parser_reply_error _idx_1) _code_2) "Expected letter.")))))))
list_fold = (\_list_2-> (\_nil_4-> (\_cons_5-> (let _186 = _list_2 in (case _186 of {(0,f) -> u f (_nil_4); (1,f) -> u f (\_187 _188-> (u (u _cons_5 _187) (u (u (u list_fold _188) _nil_4) _cons_5))); })))))
fm_parser_name1 = (\_idx_1-> (\_code_2-> (let _189 = (u (u fm_parser_spaces _idx_1) _code_2) in (case _189 of {(0,f) -> u f (\_190 _191 _192-> (u (u (u parser_reply_error _190) _191) _192)); (1,f) -> u f (\_193 _194 _195-> (let _196 = (u (u (u parser_many1 fm_parser_letter) _193) _194) in (case _196 of {(0,f) -> u f (\_197 _198 _199-> (u (u (u parser_reply_error _197) _198) _199)); (1,f) -> u f (\_200 _201 _202-> (u (u (u parser_reply_value _200) _201) (u (u (u list_fold _202) string_nil) string_cons))); }))); }))))
fm_parser_text = (\_text_1-> (\_idx_2-> (\_code_3-> (let _203 = (u (u fm_parser_spaces _idx_2) _code_3) in (case _203 of {(0,f) -> u f (\_204 _205 _206-> (u (u (u parser_reply_error _204) _205) _206)); (1,f) -> u f (\_207 _208 _209-> (u (u (u parser_text _text_1) _207) _208)); })))))
parser_until1 = (\_cond_2-> (\_parser_3-> (\_idx_4-> (\_code_5-> (let _210 = (u (u _parser_3 _idx_4) _code_5) in (case _210 of {(0,f) -> u f (\_211 _212 _213-> (u (u (u parser_reply_error _211) _212) _213)); (1,f) -> u f (\_214 _215 _216-> (let _217 = (u (u (u (u parser_until _cond_2) _parser_3) _214) _215) in (case _217 of {(0,f) -> u f (\_218 _219 _220-> (u (u (u parser_reply_error _218) _219) _220)); (1,f) -> u f (\_221 _222 _223-> (u (u (u parser_reply_value _221) _222) (u (u list_cons _216) _223))); }))); }))))))
pair = (\_a_1-> (\_b_2-> ()))
parser_maybe = (\_parse_2-> (\_idx_3-> (\_code_4-> (let _224 = (u (u _parse_2 _idx_3) _code_4) in (case _224 of {(0,f) -> u f (\_225 _226 _227-> (u (u (u parser_reply_value _idx_3) _code_4) maybe_none)); (1,f) -> u f (\_228 _229 _230-> (u (u (u parser_reply_value _228) _229) (u maybe_some _230))); })))))
fm_parser_item = (\_parser_2-> (\_idx_3-> (\_code_4-> (let _231 = (u (u fm_parser_spaces _idx_3) _code_4) in (case _231 of {(0,f) -> u f (\_232 _233 _234-> (u (u (u parser_reply_error _232) _233) _234)); (1,f) -> u f (\_235 _236 _237-> (let _238 = (u (u _parser_2 _235) _236) in (case _238 of {(0,f) -> u f (\_239 _240 _241-> (u (u (u parser_reply_error _239) _240) _241)); (1,f) -> u f (\_242 _243 _244-> (let _245 = (u (u (u parser_maybe (u fm_parser_text ",")) _242) _243) in (case _245 of {(0,f) -> u f (\_246 _247 _248-> (u (u (u parser_reply_error _246) _247) _248)); (1,f) -> u f (\_249 _250 _251-> (u (u (u parser_reply_value _249) _250) _244)); }))); }))); })))))
fm_parser_name = (\_idx_1-> (\_code_2-> (let _252 = (u (u fm_parser_spaces _idx_1) _code_2) in (case _252 of {(0,f) -> u f (\_253 _254 _255-> (u (u (u parser_reply_error _253) _254) _255)); (1,f) -> u f (\_256 _257 _258-> (let _259 = (u (u (u parser_many fm_parser_letter) _256) _257) in (case _259 of {(0,f) -> u f (\_260 _261 _262-> (u (u (u parser_reply_error _260) _261) _262)); (1,f) -> u f (\_263 _264 _265-> (u (u (u parser_reply_value _263) _264) (u (u (u list_fold _265) string_nil) string_cons))); }))); }))))
parser_get_index = (\_idx_1-> (\_code_2-> (u (u (u parser_reply_value _idx_1) _code_2) _idx_1)))
fm_parser_init = (\_idx_1-> (\_code_2-> (let _266 = (u (u fm_parser_spaces _idx_1) _code_2) in (case _266 of {(0,f) -> u f (\_267 _268 _269-> (u (u (u parser_reply_error _267) _268) _269)); (1,f) -> u f (\_270 _271 _272-> (let _273 = (u (u parser_get_index _270) _271) in (case _273 of {(0,f) -> u f (\_274 _275 _276-> (u (u (u parser_reply_error _274) _275) _276)); (1,f) -> u f (\_277 _278 _279-> (u (u (u parser_reply_value _277) _278) _279)); }))); }))))
fm_origin_new = (\_file_1-> (\_from_2-> (\_upto_3-> (0,\t-> t _file_1 _from_2 _upto_3))))
fm_parser_stop = (\_from_1-> (\_idx_2-> (\_code_3-> (let _280 = (u (u parser_get_index _idx_2) _code_3) in (case _280 of {(0,f) -> u f (\_281 _282 _283-> (u (u (u parser_reply_error _281) _282) _283)); (1,f) -> u f (\_284 _285 _286-> (let _orig_7=(u (u (u fm_origin_new "") _from_1) _286) in (u (u (u parser_reply_value _284) _285) _orig_7))); })))))
fm_term_ori = (\_orig_1-> (\_expr_2-> (15,\t-> t _orig_1 _expr_2)))
fm_term_typ = (2,\t-> t)
fm_parser_type = (\_idx_1-> (\_code_2-> (let _287 = (u (u fm_parser_init _idx_1) _code_2) in (case _287 of {(0,f) -> u f (\_288 _289 _290-> (u (u (u parser_reply_error _288) _289) _290)); (1,f) -> u f (\_291 _292 _293-> (let _294 = (u (u (u fm_parser_text "Type") _291) _292) in (case _294 of {(0,f) -> u f (\_295 _296 _297-> (u (u (u parser_reply_error _295) _296) _297)); (1,f) -> u f (\_298 _299 _300-> (let _301 = (u (u (u fm_parser_stop _293) _298) _299) in (case _301 of {(0,f) -> u f (\_302 _303 _304-> (u (u (u parser_reply_error _302) _303) _304)); (1,f) -> u f (\_305 _306 _307-> (u (u (u parser_reply_value _305) _306) (u (u fm_term_ori _307) fm_term_typ))); }))); }))); }))))
fm_term_all = (\_eras_1-> (\_self_2-> (\_name_3-> (\_xtyp_4-> (\_body_5-> (3,\t-> t _eras_1 _self_2 _name_3 _xtyp_4 _body_5))))))
fm_parser_forall = (\_idx_1-> (\_code_2-> (let _308 = (u (u fm_parser_init _idx_1) _code_2) in (case _308 of {(0,f) -> u f (\_309 _310 _311-> (u (u (u parser_reply_error _309) _310) _311)); (1,f) -> u f (\_312 _313 _314-> (let _315 = (u (u fm_parser_name _312) _313) in (case _315 of {(0,f) -> u f (\_316 _317 _318-> (u (u (u parser_reply_error _316) _317) _318)); (1,f) -> u f (\_319 _320 _321-> (let _322 = (u (u fm_parser_binder _319) _320) in (case _322 of {(0,f) -> u f (\_323 _324 _325-> (u (u (u parser_reply_error _323) _324) _325)); (1,f) -> u f (\_326 _327 _328-> (let _329 = (u (u (u parser_maybe (u fm_parser_text "->")) _326) _327) in (case _329 of {(0,f) -> u f (\_330 _331 _332-> (u (u (u parser_reply_error _330) _331) _332)); (1,f) -> u f (\_333 _334 _335-> (let _336 = (u (u fm_parser_term _333) _334) in (case _336 of {(0,f) -> u f (\_337 _338 _339-> (u (u (u parser_reply_error _337) _338) _339)); (1,f) -> u f (\_340 _341 _342-> (let _term_18=(u (u (u list_fold _328) _342) (\_x_18-> (\_t_19-> (let _343 = _x_18 in (case _343 of {(0,f) -> u f (\_344 _345 _346-> (u (u (u (u (u fm_term_all _344) "") _345) _346) (\_s_23-> (\_x_24-> _t_19)))); }))))) in (let _347 = (u (u (u fm_parser_stop _314) _340) _341) in (case _347 of {(0,f) -> u f (\_348 _349 _350-> (u (u (u parser_reply_error _348) _349) _350)); (1,f) -> u f (\_351 _352 _353-> (u (u (u parser_reply_value _351) _352) (let _354 = _term_18 in (case _354 of {(0,f) -> u f (\_355 _356-> _term_18); (1,f) -> u f (\_357-> _term_18); (2,f) -> u f (_term_18); (3,f) -> u f (\_358 _359 _360 _361 _362-> (u (u fm_term_ori _353) (u (u (u (u (u fm_term_all _358) _321) _360) _361) _362))); (4,f) -> u f (\_363 _364-> _term_18); (5,f) -> u f (\_365 _366-> _term_18); (6,f) -> u f (\_367 _368 _369-> _term_18); (7,f) -> u f (\_370 _371 _372-> _term_18); (8,f) -> u f (\_373 _374 _375-> _term_18); (9,f) -> u f (\_376 _377 _378-> _term_18); (10,f) -> u f (\_379-> _term_18); (11,f) -> u f (\_380-> _term_18); (12,f) -> u f (\_381-> _term_18); (13,f) -> u f (\_382-> _term_18); (14,f) -> u f (\_383 _384 _385 _386 _387 _388-> _term_18); (15,f) -> u f (\_389 _390-> _term_18); })))); })))); }))); }))); }))); }))); }))))
fm_term_lam = (\_name_1-> (\_body_2-> (4,\t-> t _name_1 _body_2)))
fm_parser_make_lambda = (\_names_1-> (\_body_2-> (let _391 = _names_1 in (case _391 of {(0,f) -> u f (_body_2); (1,f) -> u f (\_392 _393-> (u (u fm_term_lam _392) (\_x_5-> (u (u fm_parser_make_lambda _393) _body_2)))); }))))
fm_parser_lambda = (\_idx_1-> (\_code_2-> (let _394 = (u (u fm_parser_init _idx_1) _code_2) in (case _394 of {(0,f) -> u f (\_395 _396 _397-> (u (u (u parser_reply_error _395) _396) _397)); (1,f) -> u f (\_398 _399 _400-> (let _401 = (u (u (u fm_parser_text "(") _398) _399) in (case _401 of {(0,f) -> u f (\_402 _403 _404-> (u (u (u parser_reply_error _402) _403) _404)); (1,f) -> u f (\_405 _406 _407-> (let _408 = (u (u (u (u parser_until1 (u fm_parser_text ")")) (u fm_parser_item fm_parser_name1)) _405) _406) in (case _408 of {(0,f) -> u f (\_409 _410 _411-> (u (u (u parser_reply_error _409) _410) _411)); (1,f) -> u f (\_412 _413 _414-> (let _415 = (u (u fm_parser_term _412) _413) in (case _415 of {(0,f) -> u f (\_416 _417 _418-> (u (u (u parser_reply_error _416) _417) _418)); (1,f) -> u f (\_419 _420 _421-> (let _422 = (u (u (u fm_parser_stop _400) _419) _420) in (case _422 of {(0,f) -> u f (\_423 _424 _425-> (u (u (u parser_reply_error _423) _424) _425)); (1,f) -> u f (\_426 _427 _428-> (let _expr_18=(u (u fm_parser_make_lambda _414) _421) in (u (u (u parser_reply_value _426) _427) (u (u fm_term_ori _428) _expr_18)))); }))); }))); }))); }))); }))))
fm_parser_lambda_erased = (\_idx_1-> (\_code_2-> (let _429 = (u (u fm_parser_init _idx_1) _code_2) in (case _429 of {(0,f) -> u f (\_430 _431 _432-> (u (u (u parser_reply_error _430) _431) _432)); (1,f) -> u f (\_433 _434 _435-> (let _436 = (u (u (u fm_parser_text "<") _433) _434) in (case _436 of {(0,f) -> u f (\_437 _438 _439-> (u (u (u parser_reply_error _437) _438) _439)); (1,f) -> u f (\_440 _441 _442-> (let _443 = (u (u (u (u parser_until1 (u fm_parser_text ">")) (u fm_parser_item fm_parser_name1)) _440) _441) in (case _443 of {(0,f) -> u f (\_444 _445 _446-> (u (u (u parser_reply_error _444) _445) _446)); (1,f) -> u f (\_447 _448 _449-> (let _450 = (u (u fm_parser_term _447) _448) in (case _450 of {(0,f) -> u f (\_451 _452 _453-> (u (u (u parser_reply_error _451) _452) _453)); (1,f) -> u f (\_454 _455 _456-> (let _457 = (u (u (u fm_parser_stop _435) _454) _455) in (case _457 of {(0,f) -> u f (\_458 _459 _460-> (u (u (u parser_reply_error _458) _459) _460)); (1,f) -> u f (\_461 _462 _463-> (let _expr_18=(u (u fm_parser_make_lambda _449) _456) in (u (u (u parser_reply_value _461) _462) (u (u fm_term_ori _463) _expr_18)))); }))); }))); }))); }))); }))))
fm_parser_lambda_nameless = (\_idx_1-> (\_code_2-> (let _464 = (u (u fm_parser_init _idx_1) _code_2) in (case _464 of {(0,f) -> u f (\_465 _466 _467-> (u (u (u parser_reply_error _465) _466) _467)); (1,f) -> u f (\_468 _469 _470-> (let _471 = (u (u (u fm_parser_text "()") _468) _469) in (case _471 of {(0,f) -> u f (\_472 _473 _474-> (u (u (u parser_reply_error _472) _473) _474)); (1,f) -> u f (\_475 _476 _477-> (let _478 = (u (u fm_parser_term _475) _476) in (case _478 of {(0,f) -> u f (\_479 _480 _481-> (u (u (u parser_reply_error _479) _480) _481)); (1,f) -> u f (\_482 _483 _484-> (let _485 = (u (u (u fm_parser_stop _470) _482) _483) in (case _485 of {(0,f) -> u f (\_486 _487 _488-> (u (u (u parser_reply_error _486) _487) _488)); (1,f) -> u f (\_489 _490 _491-> (let _expr_15=(u (u fm_term_lam "") (\_x_15-> _484)) in (u (u (u parser_reply_value _489) _490) (u (u fm_term_ori _491) _expr_15)))); }))); }))); }))); }))))
fm_parser_parenthesis = (\_idx_1-> (\_code_2-> (let _492 = (u (u (u fm_parser_text "(") _idx_1) _code_2) in (case _492 of {(0,f) -> u f (\_493 _494 _495-> (u (u (u parser_reply_error _493) _494) _495)); (1,f) -> u f (\_496 _497 _498-> (let _499 = (u (u fm_parser_term _496) _497) in (case _499 of {(0,f) -> u f (\_500 _501 _502-> (u (u (u parser_reply_error _500) _501) _502)); (1,f) -> u f (\_503 _504 _505-> (let _506 = (u (u (u fm_parser_text ")") _503) _504) in (case _506 of {(0,f) -> u f (\_507 _508 _509-> (u (u (u parser_reply_error _507) _508) _509)); (1,f) -> u f (\_510 _511 _512-> (u (u (u parser_reply_value _510) _511) _505)); }))); }))); }))))
fm_term_ref = (\_name_1-> (1,\t-> t _name_1))
fm_term_app = (\_func_1-> (\_argm_2-> (5,\t-> t _func_1 _argm_2)))
fm_term_hol = (\_path_1-> (10,\t-> t _path_1))
fm_term_let = (\_name_1-> (\_expr_2-> (\_body_3-> (6,\t-> t _name_1 _expr_2 _body_3))))
fm_parser_letforrange_u32 = (\_idx_1-> (\_code_2-> (let _513 = (u (u fm_parser_init _idx_1) _code_2) in (case _513 of {(0,f) -> u f (\_514 _515 _516-> (u (u (u parser_reply_error _514) _515) _516)); (1,f) -> u f (\_517 _518 _519-> (let _520 = (u (u (u fm_parser_text "let ") _517) _518) in (case _520 of {(0,f) -> u f (\_521 _522 _523-> (u (u (u parser_reply_error _521) _522) _523)); (1,f) -> u f (\_524 _525 _526-> (let _527 = (u (u fm_parser_name1 _524) _525) in (case _527 of {(0,f) -> u f (\_528 _529 _530-> (u (u (u parser_reply_error _528) _529) _530)); (1,f) -> u f (\_531 _532 _533-> (let _534 = (u (u (u fm_parser_text "=") _531) _532) in (case _534 of {(0,f) -> u f (\_535 _536 _537-> (u (u (u parser_reply_error _535) _536) _537)); (1,f) -> u f (\_538 _539 _540-> (let _541 = (u (u (u fm_parser_text "for ") _538) _539) in (case _541 of {(0,f) -> u f (\_542 _543 _544-> (u (u (u parser_reply_error _542) _543) _544)); (1,f) -> u f (\_545 _546 _547-> (let _548 = (u (u fm_parser_name1 _545) _546) in (case _548 of {(0,f) -> u f (\_549 _550 _551-> (u (u (u parser_reply_error _549) _550) _551)); (1,f) -> u f (\_552 _553 _554-> (let _555 = (u (u (u fm_parser_text ":") _552) _553) in (case _555 of {(0,f) -> u f (\_556 _557 _558-> (u (u (u parser_reply_error _556) _557) _558)); (1,f) -> u f (\_559 _560 _561-> (let _562 = (u (u (u fm_parser_text "U32") _559) _560) in (case _562 of {(0,f) -> u f (\_563 _564 _565-> (u (u (u parser_reply_error _563) _564) _565)); (1,f) -> u f (\_566 _567 _568-> (let _569 = (u (u (u fm_parser_text "=") _566) _567) in (case _569 of {(0,f) -> u f (\_570 _571 _572-> (u (u (u parser_reply_error _570) _571) _572)); (1,f) -> u f (\_573 _574 _575-> (let _576 = (u (u fm_parser_term _573) _574) in (case _576 of {(0,f) -> u f (\_577 _578 _579-> (u (u (u parser_reply_error _577) _578) _579)); (1,f) -> u f (\_580 _581 _582-> (let _583 = (u (u (u fm_parser_text "..") _580) _581) in (case _583 of {(0,f) -> u f (\_584 _585 _586-> (u (u (u parser_reply_error _584) _585) _586)); (1,f) -> u f (\_587 _588 _589-> (let _590 = (u (u fm_parser_term _587) _588) in (case _590 of {(0,f) -> u f (\_591 _592 _593-> (u (u (u parser_reply_error _591) _592) _593)); (1,f) -> u f (\_594 _595 _596-> (let _597 = (u (u (u fm_parser_text ":") _594) _595) in (case _597 of {(0,f) -> u f (\_598 _599 _600-> (u (u (u parser_reply_error _598) _599) _600)); (1,f) -> u f (\_601 _602 _603-> (let _604 = (u (u fm_parser_term _601) _602) in (case _604 of {(0,f) -> u f (\_605 _606 _607-> (u (u (u parser_reply_error _605) _606) _607)); (1,f) -> u f (\_608 _609 _610-> (let _611 = (u (u (u parser_maybe (u fm_parser_text ";")) _608) _609) in (case _611 of {(0,f) -> u f (\_612 _613 _614-> (u (u (u parser_reply_error _612) _613) _614)); (1,f) -> u f (\_615 _616 _617-> (let _618 = (u (u fm_parser_term _615) _616) in (case _618 of {(0,f) -> u f (\_619 _620 _621-> (u (u (u parser_reply_error _619) _620) _621)); (1,f) -> u f (\_622 _623 _624-> (let _625 = (u (u (u fm_parser_stop _519) _622) _623) in (case _625 of {(0,f) -> u f (\_626 _627 _628-> (u (u (u parser_reply_error _626) _627) _628)); (1,f) -> u f (\_629 _630 _631-> (let _term_54=(u fm_term_ref "U32.for") in (let _term_55=(u (u fm_term_app _term_54) (u fm_term_hol bits_e)) in (let _term_56=(u (u fm_term_app _term_55) (u fm_term_ref _533)) in (let _term_57=(u (u fm_term_app _term_56) _582) in (let _term_58=(u (u fm_term_app _term_57) _596) in (let _lamb_59=(u (u fm_term_lam _554) (\_e_59-> (u (u fm_term_lam _533) (\_s_60-> _610)))) in (let _term_60=(u (u fm_term_app _term_58) _lamb_59) in (let _term_61=(u (u (u fm_term_let _533) _term_60) (\_x_61-> _624)) in (u (u (u parser_reply_value _629) _630) (u (u fm_term_ori _631) _term_61))))))))))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))))
fm_parser_letforin = (\_idx_1-> (\_code_2-> (let _632 = (u (u fm_parser_init _idx_1) _code_2) in (case _632 of {(0,f) -> u f (\_633 _634 _635-> (u (u (u parser_reply_error _633) _634) _635)); (1,f) -> u f (\_636 _637 _638-> (let _639 = (u (u (u fm_parser_text "let ") _636) _637) in (case _639 of {(0,f) -> u f (\_640 _641 _642-> (u (u (u parser_reply_error _640) _641) _642)); (1,f) -> u f (\_643 _644 _645-> (let _646 = (u (u fm_parser_name1 _643) _644) in (case _646 of {(0,f) -> u f (\_647 _648 _649-> (u (u (u parser_reply_error _647) _648) _649)); (1,f) -> u f (\_650 _651 _652-> (let _653 = (u (u (u fm_parser_text "=") _650) _651) in (case _653 of {(0,f) -> u f (\_654 _655 _656-> (u (u (u parser_reply_error _654) _655) _656)); (1,f) -> u f (\_657 _658 _659-> (let _660 = (u (u (u fm_parser_text "for ") _657) _658) in (case _660 of {(0,f) -> u f (\_661 _662 _663-> (u (u (u parser_reply_error _661) _662) _663)); (1,f) -> u f (\_664 _665 _666-> (let _667 = (u (u fm_parser_name1 _664) _665) in (case _667 of {(0,f) -> u f (\_668 _669 _670-> (u (u (u parser_reply_error _668) _669) _670)); (1,f) -> u f (\_671 _672 _673-> (let _674 = (u (u (u fm_parser_text "in") _671) _672) in (case _674 of {(0,f) -> u f (\_675 _676 _677-> (u (u (u parser_reply_error _675) _676) _677)); (1,f) -> u f (\_678 _679 _680-> (let _681 = (u (u fm_parser_term _678) _679) in (case _681 of {(0,f) -> u f (\_682 _683 _684-> (u (u (u parser_reply_error _682) _683) _684)); (1,f) -> u f (\_685 _686 _687-> (let _688 = (u (u (u fm_parser_text ":") _685) _686) in (case _688 of {(0,f) -> u f (\_689 _690 _691-> (u (u (u parser_reply_error _689) _690) _691)); (1,f) -> u f (\_692 _693 _694-> (let _695 = (u (u fm_parser_term _692) _693) in (case _695 of {(0,f) -> u f (\_696 _697 _698-> (u (u (u parser_reply_error _696) _697) _698)); (1,f) -> u f (\_699 _700 _701-> (let _702 = (u (u (u parser_maybe (u fm_parser_text ";")) _699) _700) in (case _702 of {(0,f) -> u f (\_703 _704 _705-> (u (u (u parser_reply_error _703) _704) _705)); (1,f) -> u f (\_706 _707 _708-> (let _709 = (u (u fm_parser_term _706) _707) in (case _709 of {(0,f) -> u f (\_710 _711 _712-> (u (u (u parser_reply_error _710) _711) _712)); (1,f) -> u f (\_713 _714 _715-> (let _716 = (u (u (u fm_parser_stop _638) _713) _714) in (case _716 of {(0,f) -> u f (\_717 _718 _719-> (u (u (u parser_reply_error _717) _718) _719)); (1,f) -> u f (\_720 _721 _722-> (let _term_42=(u fm_term_ref "List.for") in (let _term_43=(u (u fm_term_app _term_42) (u fm_term_hol bits_e)) in (let _term_44=(u (u fm_term_app _term_43) _687) in (let _term_45=(u (u fm_term_app _term_44) (u fm_term_hol bits_e)) in (let _term_46=(u (u fm_term_app _term_45) (u fm_term_ref _652)) in (let _lamb_47=(u (u fm_term_lam _673) (\_i_47-> (u (u fm_term_lam _652) (\_x_48-> _701)))) in (let _term_48=(u (u fm_term_app _term_46) _lamb_47) in (let _term_49=(u (u (u fm_term_let _652) _term_48) (\_x_49-> _715)) in (u (u (u parser_reply_value _720) _721) (u (u fm_term_ori _722) _term_49))))))))))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))))
fm_parser_let = (\_idx_1-> (\_code_2-> (let _723 = (u (u fm_parser_init _idx_1) _code_2) in (case _723 of {(0,f) -> u f (\_724 _725 _726-> (u (u (u parser_reply_error _724) _725) _726)); (1,f) -> u f (\_727 _728 _729-> (let _730 = (u (u (u fm_parser_text "let ") _727) _728) in (case _730 of {(0,f) -> u f (\_731 _732 _733-> (u (u (u parser_reply_error _731) _732) _733)); (1,f) -> u f (\_734 _735 _736-> (let _737 = (u (u fm_parser_name _734) _735) in (case _737 of {(0,f) -> u f (\_738 _739 _740-> (u (u (u parser_reply_error _738) _739) _740)); (1,f) -> u f (\_741 _742 _743-> (let _744 = (u (u (u fm_parser_text "=") _741) _742) in (case _744 of {(0,f) -> u f (\_745 _746 _747-> (u (u (u parser_reply_error _745) _746) _747)); (1,f) -> u f (\_748 _749 _750-> (let _751 = (u (u fm_parser_term _748) _749) in (case _751 of {(0,f) -> u f (\_752 _753 _754-> (u (u (u parser_reply_error _752) _753) _754)); (1,f) -> u f (\_755 _756 _757-> (let _758 = (u (u (u parser_maybe (u fm_parser_text ";")) _755) _756) in (case _758 of {(0,f) -> u f (\_759 _760 _761-> (u (u (u parser_reply_error _759) _760) _761)); (1,f) -> u f (\_762 _763 _764-> (let _765 = (u (u fm_parser_term _762) _763) in (case _765 of {(0,f) -> u f (\_766 _767 _768-> (u (u (u parser_reply_error _766) _767) _768)); (1,f) -> u f (\_769 _770 _771-> (let _772 = (u (u (u fm_parser_stop _729) _769) _770) in (case _772 of {(0,f) -> u f (\_773 _774 _775-> (u (u (u parser_reply_error _773) _774) _775)); (1,f) -> u f (\_776 _777 _778-> (u (u (u parser_reply_value _776) _777) (u (u fm_term_ori _778) (u (u (u fm_term_let _743) _757) (\_x_27-> _771))))); }))); }))); }))); }))); }))); }))); }))); }))))
fm_parser_get = (\_idx_1-> (\_code_2-> (let _779 = (u (u fm_parser_init _idx_1) _code_2) in (case _779 of {(0,f) -> u f (\_780 _781 _782-> (u (u (u parser_reply_error _780) _781) _782)); (1,f) -> u f (\_783 _784 _785-> (let _786 = (u (u (u fm_parser_text "let ") _783) _784) in (case _786 of {(0,f) -> u f (\_787 _788 _789-> (u (u (u parser_reply_error _787) _788) _789)); (1,f) -> u f (\_790 _791 _792-> (let _793 = (u (u (u fm_parser_text "{") _790) _791) in (case _793 of {(0,f) -> u f (\_794 _795 _796-> (u (u (u parser_reply_error _794) _795) _796)); (1,f) -> u f (\_797 _798 _799-> (let _800 = (u (u fm_parser_name _797) _798) in (case _800 of {(0,f) -> u f (\_801 _802 _803-> (u (u (u parser_reply_error _801) _802) _803)); (1,f) -> u f (\_804 _805 _806-> (let _807 = (u (u (u fm_parser_text ",") _804) _805) in (case _807 of {(0,f) -> u f (\_808 _809 _810-> (u (u (u parser_reply_error _808) _809) _810)); (1,f) -> u f (\_811 _812 _813-> (let _814 = (u (u fm_parser_name _811) _812) in (case _814 of {(0,f) -> u f (\_815 _816 _817-> (u (u (u parser_reply_error _815) _816) _817)); (1,f) -> u f (\_818 _819 _820-> (let _821 = (u (u (u fm_parser_text "}") _818) _819) in (case _821 of {(0,f) -> u f (\_822 _823 _824-> (u (u (u parser_reply_error _822) _823) _824)); (1,f) -> u f (\_825 _826 _827-> (let _828 = (u (u (u fm_parser_text "=") _825) _826) in (case _828 of {(0,f) -> u f (\_829 _830 _831-> (u (u (u parser_reply_error _829) _830) _831)); (1,f) -> u f (\_832 _833 _834-> (let _835 = (u (u fm_parser_term _832) _833) in (case _835 of {(0,f) -> u f (\_836 _837 _838-> (u (u (u parser_reply_error _836) _837) _838)); (1,f) -> u f (\_839 _840 _841-> (let _842 = (u (u (u parser_maybe (u fm_parser_text ";")) _839) _840) in (case _842 of {(0,f) -> u f (\_843 _844 _845-> (u (u (u parser_reply_error _843) _844) _845)); (1,f) -> u f (\_846 _847 _848-> (let _849 = (u (u fm_parser_term _846) _847) in (case _849 of {(0,f) -> u f (\_850 _851 _852-> (u (u (u parser_reply_error _850) _851) _852)); (1,f) -> u f (\_853 _854 _855-> (let _856 = (u (u (u fm_parser_stop _785) _853) _854) in (case _856 of {(0,f) -> u f (\_857 _858 _859-> (u (u (u parser_reply_error _857) _858) _859)); (1,f) -> u f (\_860 _861 _862-> (let _term_39=_841 in (let _term_40=(u (u fm_term_app _term_39) (u (u fm_term_lam "x") (\_x_40-> (u fm_term_hol bits_e)))) in (let _term_41=(u (u fm_term_app _term_40) (u (u fm_term_lam _806) (\_x_41-> (u (u fm_term_lam _820) (\_y_42-> _855))))) in (u (u (u parser_reply_value _860) _861) (u (u fm_term_ori _862) _term_41)))))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))))
fm_term_def = (\_name_1-> (\_expr_2-> (\_body_3-> (7,\t-> t _name_1 _expr_2 _body_3))))
fm_parser_def = (\_idx_1-> (\_code_2-> (let _863 = (u (u fm_parser_init _idx_1) _code_2) in (case _863 of {(0,f) -> u f (\_864 _865 _866-> (u (u (u parser_reply_error _864) _865) _866)); (1,f) -> u f (\_867 _868 _869-> (let _870 = (u (u (u fm_parser_text "def ") _867) _868) in (case _870 of {(0,f) -> u f (\_871 _872 _873-> (u (u (u parser_reply_error _871) _872) _873)); (1,f) -> u f (\_874 _875 _876-> (let _877 = (u (u fm_parser_name _874) _875) in (case _877 of {(0,f) -> u f (\_878 _879 _880-> (u (u (u parser_reply_error _878) _879) _880)); (1,f) -> u f (\_881 _882 _883-> (let _884 = (u (u (u fm_parser_text "=") _881) _882) in (case _884 of {(0,f) -> u f (\_885 _886 _887-> (u (u (u parser_reply_error _885) _886) _887)); (1,f) -> u f (\_888 _889 _890-> (let _891 = (u (u fm_parser_term _888) _889) in (case _891 of {(0,f) -> u f (\_892 _893 _894-> (u (u (u parser_reply_error _892) _893) _894)); (1,f) -> u f (\_895 _896 _897-> (let _898 = (u (u (u parser_maybe (u fm_parser_text ";")) _895) _896) in (case _898 of {(0,f) -> u f (\_899 _900 _901-> (u (u (u parser_reply_error _899) _900) _901)); (1,f) -> u f (\_902 _903 _904-> (let _905 = (u (u fm_parser_term _902) _903) in (case _905 of {(0,f) -> u f (\_906 _907 _908-> (u (u (u parser_reply_error _906) _907) _908)); (1,f) -> u f (\_909 _910 _911-> (let _912 = (u (u (u fm_parser_stop _869) _909) _910) in (case _912 of {(0,f) -> u f (\_913 _914 _915-> (u (u (u parser_reply_error _913) _914) _915)); (1,f) -> u f (\_916 _917 _918-> (u (u (u parser_reply_value _916) _917) (u (u fm_term_ori _918) (u (u (u fm_term_def _883) _897) (\_x_27-> _911))))); }))); }))); }))); }))); }))); }))); }))); }))))
fm_parser_if = (\_idx_1-> (\_code_2-> (let _919 = (u (u fm_parser_init _idx_1) _code_2) in (case _919 of {(0,f) -> u f (\_920 _921 _922-> (u (u (u parser_reply_error _920) _921) _922)); (1,f) -> u f (\_923 _924 _925-> (let _926 = (u (u (u fm_parser_text "if ") _923) _924) in (case _926 of {(0,f) -> u f (\_927 _928 _929-> (u (u (u parser_reply_error _927) _928) _929)); (1,f) -> u f (\_930 _931 _932-> (let _933 = (u (u fm_parser_term _930) _931) in (case _933 of {(0,f) -> u f (\_934 _935 _936-> (u (u (u parser_reply_error _934) _935) _936)); (1,f) -> u f (\_937 _938 _939-> (let _940 = (u (u (u fm_parser_text "then") _937) _938) in (case _940 of {(0,f) -> u f (\_941 _942 _943-> (u (u (u parser_reply_error _941) _942) _943)); (1,f) -> u f (\_944 _945 _946-> (let _947 = (u (u fm_parser_term _944) _945) in (case _947 of {(0,f) -> u f (\_948 _949 _950-> (u (u (u parser_reply_error _948) _949) _950)); (1,f) -> u f (\_951 _952 _953-> (let _954 = (u (u (u fm_parser_text "else") _951) _952) in (case _954 of {(0,f) -> u f (\_955 _956 _957-> (u (u (u parser_reply_error _955) _956) _957)); (1,f) -> u f (\_958 _959 _960-> (let _961 = (u (u fm_parser_term _958) _959) in (case _961 of {(0,f) -> u f (\_962 _963 _964-> (u (u (u parser_reply_error _962) _963) _964)); (1,f) -> u f (\_965 _966 _967-> (let _968 = (u (u (u fm_parser_stop _925) _965) _966) in (case _968 of {(0,f) -> u f (\_969 _970 _971-> (u (u (u parser_reply_error _969) _970) _971)); (1,f) -> u f (\_972 _973 _974-> (let _term_27=_939 in (let _term_28=(u (u fm_term_app _term_27) (u (u fm_term_lam "") (\_x_28-> (u fm_term_hol bits_e)))) in (let _term_29=(u (u fm_term_app _term_28) _953) in (let _term_30=(u (u fm_term_app _term_29) _967) in (u (u (u parser_reply_value _972) _973) (u (u fm_term_ori _974) _term_30))))))); }))); }))); }))); }))); }))); }))); }))); }))))
list_mapped = (\_as_2-> (\_f_4-> (let _975 = _as_2 in (case _975 of {(0,f) -> u f (list_nil); (1,f) -> u f (\_976 _977-> (u (u list_cons (u _f_4 _976)) (u (u list_mapped _977) _f_4))); }))))
pair_new = (\_fst_3-> (\_snd_4-> (0,\t-> t _fst_3 _snd_4)))
fm_backslash = 92
fm_escapes = (u (u list_cons (u (u pair_new "\\b") 8)) (u (u list_cons (u (u pair_new "\\f") 12)) (u (u list_cons (u (u pair_new "\\n") 10)) (u (u list_cons (u (u pair_new "\\r") 13)) (u (u list_cons (u (u pair_new "\\t") 9)) (u (u list_cons (u (u pair_new "\\v") 11)) (u (u list_cons (u (u pair_new (u (u string_cons fm_backslash) (u (u string_cons fm_backslash) string_nil))) fm_backslash)) (u (u list_cons (u (u pair_new "\\\"") 34)) (u (u list_cons (u (u pair_new "\\0") 0)) (u (u list_cons (u (u pair_new "\\'") 39)) list_nil))))))))))
fm_parser_char_single = (u parser_first_of (u (u list_cons (u parser_first_of (u (u list_mapped fm_escapes) (\_esc_1-> (let _978 = _esc_1 in (case _978 of {(0,f) -> u f (\_979 _980-> (\_idx_4-> (\_code_5-> (let _981 = (u (u (u parser_text _979) _idx_4) _code_5) in (case _981 of {(0,f) -> u f (\_982 _983 _984-> (u (u (u parser_reply_error _982) _983) _984)); (1,f) -> u f (\_985 _986 _987-> (u (u (u parser_reply_value _985) _986) _980)); }))))); })))))) (u (u list_cons parser_one) list_nil)))
fm_term_chr = (\_chrx_1-> (12,\t-> t _chrx_1))
fm_parser_char = (\_idx_1-> (\_code_2-> (let _988 = (u (u fm_parser_init _idx_1) _code_2) in (case _988 of {(0,f) -> u f (\_989 _990 _991-> (u (u (u parser_reply_error _989) _990) _991)); (1,f) -> u f (\_992 _993 _994-> (let _995 = (u (u (u fm_parser_text "'") _992) _993) in (case _995 of {(0,f) -> u f (\_996 _997 _998-> (u (u (u parser_reply_error _996) _997) _998)); (1,f) -> u f (\_999 _1000 _1001-> (let _1002 = (u (u fm_parser_char_single _999) _1000) in (case _1002 of {(0,f) -> u f (\_1003 _1004 _1005-> (u (u (u parser_reply_error _1003) _1004) _1005)); (1,f) -> u f (\_1006 _1007 _1008-> (let _1009 = (u (u (u parser_text "'") _1006) _1007) in (case _1009 of {(0,f) -> u f (\_1010 _1011 _1012-> (u (u (u parser_reply_error _1010) _1011) _1012)); (1,f) -> u f (\_1013 _1014 _1015-> (let _1016 = (u (u (u fm_parser_stop _994) _1013) _1014) in (case _1016 of {(0,f) -> u f (\_1017 _1018 _1019-> (u (u (u parser_reply_error _1017) _1018) _1019)); (1,f) -> u f (\_1020 _1021 _1022-> (u (u (u parser_reply_value _1020) _1021) (u (u fm_term_ori _1022) (u fm_term_chr _1008)))); }))); }))); }))); }))); }))))
fm_term_str = (\_strx_1-> (13,\t-> t _strx_1))
fm_parser_string = (\_idx_1-> (\_code_2-> (let _1023 = (u (u fm_parser_init _idx_1) _code_2) in (case _1023 of {(0,f) -> u f (\_1024 _1025 _1026-> (u (u (u parser_reply_error _1024) _1025) _1026)); (1,f) -> u f (\_1027 _1028 _1029-> (let _quot_6=(u (u string_cons 34) string_nil) in (let _1030 = (u (u (u fm_parser_text _quot_6) _1027) _1028) in (case _1030 of {(0,f) -> u f (\_1031 _1032 _1033-> (u (u (u parser_reply_error _1031) _1032) _1033)); (1,f) -> u f (\_1034 _1035 _1036-> (let _1037 = (u (u (u (u parser_until (u parser_text _quot_6)) fm_parser_char_single) _1034) _1035) in (case _1037 of {(0,f) -> u f (\_1038 _1039 _1040-> (u (u (u parser_reply_error _1038) _1039) _1040)); (1,f) -> u f (\_1041 _1042 _1043-> (let _strx_13=(u (u (u list_fold _1043) string_nil) string_cons) in (let _1044 = (u (u (u fm_parser_stop _1029) _1041) _1042) in (case _1044 of {(0,f) -> u f (\_1045 _1046 _1047-> (u (u (u parser_reply_error _1045) _1046) _1047)); (1,f) -> u f (\_1048 _1049 _1050-> (u (u (u parser_reply_value _1048) _1049) (u (u fm_term_ori _1050) (u fm_term_str _strx_13)))); })))); }))); })))); }))))
fm_parser_pair = (\_idx_1-> (\_code_2-> (let _1051 = (u (u fm_parser_init _idx_1) _code_2) in (case _1051 of {(0,f) -> u f (\_1052 _1053 _1054-> (u (u (u parser_reply_error _1052) _1053) _1054)); (1,f) -> u f (\_1055 _1056 _1057-> (let _1058 = (u (u (u fm_parser_text "{") _1055) _1056) in (case _1058 of {(0,f) -> u f (\_1059 _1060 _1061-> (u (u (u parser_reply_error _1059) _1060) _1061)); (1,f) -> u f (\_1062 _1063 _1064-> (let _1065 = (u (u fm_parser_term _1062) _1063) in (case _1065 of {(0,f) -> u f (\_1066 _1067 _1068-> (u (u (u parser_reply_error _1066) _1067) _1068)); (1,f) -> u f (\_1069 _1070 _1071-> (let _1072 = (u (u (u fm_parser_text ",") _1069) _1070) in (case _1072 of {(0,f) -> u f (\_1073 _1074 _1075-> (u (u (u parser_reply_error _1073) _1074) _1075)); (1,f) -> u f (\_1076 _1077 _1078-> (let _1079 = (u (u fm_parser_term _1076) _1077) in (case _1079 of {(0,f) -> u f (\_1080 _1081 _1082-> (u (u (u parser_reply_error _1080) _1081) _1082)); (1,f) -> u f (\_1083 _1084 _1085-> (let _1086 = (u (u (u fm_parser_text "}") _1083) _1084) in (case _1086 of {(0,f) -> u f (\_1087 _1088 _1089-> (u (u (u parser_reply_error _1087) _1088) _1089)); (1,f) -> u f (\_1090 _1091 _1092-> (let _1093 = (u (u (u fm_parser_stop _1057) _1090) _1091) in (case _1093 of {(0,f) -> u f (\_1094 _1095 _1096-> (u (u (u parser_reply_error _1094) _1095) _1096)); (1,f) -> u f (\_1097 _1098 _1099-> (let _term_24=(u fm_term_ref "Pair.new") in (let _term_25=(u (u fm_term_app _term_24) (u fm_term_hol bits_e)) in (let _term_26=(u (u fm_term_app _term_25) (u fm_term_hol bits_e)) in (let _term_27=(u (u fm_term_app _term_26) _1071) in (let _term_28=(u (u fm_term_app _term_27) _1085) in (u (u (u parser_reply_value _1097) _1098) (u (u fm_term_ori _1099) _term_28)))))))); }))); }))); }))); }))); }))); }))); }))))
fm_parser_sigma_type = (\_idx_1-> (\_code_2-> (let _1100 = (u (u fm_parser_init _idx_1) _code_2) in (case _1100 of {(0,f) -> u f (\_1101 _1102 _1103-> (u (u (u parser_reply_error _1101) _1102) _1103)); (1,f) -> u f (\_1104 _1105 _1106-> (let _1107 = (u (u (u fm_parser_text "{") _1104) _1105) in (case _1107 of {(0,f) -> u f (\_1108 _1109 _1110-> (u (u (u parser_reply_error _1108) _1109) _1110)); (1,f) -> u f (\_1111 _1112 _1113-> (let _1114 = (u (u fm_parser_name1 _1111) _1112) in (case _1114 of {(0,f) -> u f (\_1115 _1116 _1117-> (u (u (u parser_reply_error _1115) _1116) _1117)); (1,f) -> u f (\_1118 _1119 _1120-> (let _1121 = (u (u (u fm_parser_text ":") _1118) _1119) in (case _1121 of {(0,f) -> u f (\_1122 _1123 _1124-> (u (u (u parser_reply_error _1122) _1123) _1124)); (1,f) -> u f (\_1125 _1126 _1127-> (let _1128 = (u (u fm_parser_term _1125) _1126) in (case _1128 of {(0,f) -> u f (\_1129 _1130 _1131-> (u (u (u parser_reply_error _1129) _1130) _1131)); (1,f) -> u f (\_1132 _1133 _1134-> (let _1135 = (u (u (u fm_parser_text "}") _1132) _1133) in (case _1135 of {(0,f) -> u f (\_1136 _1137 _1138-> (u (u (u parser_reply_error _1136) _1137) _1138)); (1,f) -> u f (\_1139 _1140 _1141-> (let _1142 = (u (u fm_parser_term _1139) _1140) in (case _1142 of {(0,f) -> u f (\_1143 _1144 _1145-> (u (u (u parser_reply_error _1143) _1144) _1145)); (1,f) -> u f (\_1146 _1147 _1148-> (let _1149 = (u (u (u fm_parser_stop _1106) _1146) _1147) in (case _1149 of {(0,f) -> u f (\_1150 _1151 _1152-> (u (u (u parser_reply_error _1150) _1151) _1152)); (1,f) -> u f (\_1153 _1154 _1155-> (let _term_27=(u fm_term_ref "Sigma") in (let _term_28=(u (u fm_term_app _term_27) _1134) in (let _term_29=(u (u fm_term_app _term_28) (u (u fm_term_lam "x") (\_x_29-> _1148))) in (u (u (u parser_reply_value _1153) _1154) (u (u fm_term_ori _1155) _term_29)))))); }))); }))); }))); }))); }))); }))); }))); }))))
fm_parser_some = (\_idx_1-> (\_code_2-> (let _1156 = (u (u fm_parser_init _idx_1) _code_2) in (case _1156 of {(0,f) -> u f (\_1157 _1158 _1159-> (u (u (u parser_reply_error _1157) _1158) _1159)); (1,f) -> u f (\_1160 _1161 _1162-> (let _1163 = (u (u (u fm_parser_text "some(") _1160) _1161) in (case _1163 of {(0,f) -> u f (\_1164 _1165 _1166-> (u (u (u parser_reply_error _1164) _1165) _1166)); (1,f) -> u f (\_1167 _1168 _1169-> (let _1170 = (u (u fm_parser_term _1167) _1168) in (case _1170 of {(0,f) -> u f (\_1171 _1172 _1173-> (u (u (u parser_reply_error _1171) _1172) _1173)); (1,f) -> u f (\_1174 _1175 _1176-> (let _1177 = (u (u (u fm_parser_text ")") _1174) _1175) in (case _1177 of {(0,f) -> u f (\_1178 _1179 _1180-> (u (u (u parser_reply_error _1178) _1179) _1180)); (1,f) -> u f (\_1181 _1182 _1183-> (let _1184 = (u (u (u fm_parser_stop _1162) _1181) _1182) in (case _1184 of {(0,f) -> u f (\_1185 _1186 _1187-> (u (u (u parser_reply_error _1185) _1186) _1187)); (1,f) -> u f (\_1188 _1189 _1190-> (let _term_18=(u fm_term_ref "Maybe.some") in (let _term_19=(u (u fm_term_app _term_18) (u fm_term_hol bits_e)) in (let _term_20=(u (u fm_term_app _term_19) _1176) in (u (u (u parser_reply_value _1188) _1189) (u (u fm_term_ori _1190) _term_20)))))); }))); }))); }))); }))); }))))
fm_parser_apply = (\_idx_1-> (\_code_2-> (let _1191 = (u (u fm_parser_init _idx_1) _code_2) in (case _1191 of {(0,f) -> u f (\_1192 _1193 _1194-> (u (u (u parser_reply_error _1192) _1193) _1194)); (1,f) -> u f (\_1195 _1196 _1197-> (let _1198 = (u (u (u fm_parser_text "apply(") _1195) _1196) in (case _1198 of {(0,f) -> u f (\_1199 _1200 _1201-> (u (u (u parser_reply_error _1199) _1200) _1201)); (1,f) -> u f (\_1202 _1203 _1204-> (let _1205 = (u (u fm_parser_term _1202) _1203) in (case _1205 of {(0,f) -> u f (\_1206 _1207 _1208-> (u (u (u parser_reply_error _1206) _1207) _1208)); (1,f) -> u f (\_1209 _1210 _1211-> (let _1212 = (u (u (u fm_parser_text ",") _1209) _1210) in (case _1212 of {(0,f) -> u f (\_1213 _1214 _1215-> (u (u (u parser_reply_error _1213) _1214) _1215)); (1,f) -> u f (\_1216 _1217 _1218-> (let _1219 = (u (u fm_parser_term _1216) _1217) in (case _1219 of {(0,f) -> u f (\_1220 _1221 _1222-> (u (u (u parser_reply_error _1220) _1221) _1222)); (1,f) -> u f (\_1223 _1224 _1225-> (let _1226 = (u (u (u fm_parser_text ")") _1223) _1224) in (case _1226 of {(0,f) -> u f (\_1227 _1228 _1229-> (u (u (u parser_reply_error _1227) _1228) _1229)); (1,f) -> u f (\_1230 _1231 _1232-> (let _1233 = (u (u (u fm_parser_stop _1197) _1230) _1231) in (case _1233 of {(0,f) -> u f (\_1234 _1235 _1236-> (u (u (u parser_reply_error _1234) _1235) _1236)); (1,f) -> u f (\_1237 _1238 _1239-> (let _term_24=(u fm_term_ref "Equal.apply") in (let _term_25=(u (u fm_term_app _term_24) (u fm_term_hol bits_e)) in (let _term_26=(u (u fm_term_app _term_25) (u fm_term_hol bits_e)) in (let _term_27=(u (u fm_term_app _term_26) (u fm_term_hol bits_e)) in (let _term_28=(u (u fm_term_app _term_27) (u fm_term_hol bits_e)) in (let _term_29=(u (u fm_term_app _term_28) _1211) in (let _term_30=(u (u fm_term_app _term_29) _1225) in (u (u (u parser_reply_value _1237) _1238) (u (u fm_term_ori _1239) _term_30)))))))))); }))); }))); }))); }))); }))); }))); }))))
fm_parser_mirror = (\_idx_1-> (\_code_2-> (let _1240 = (u (u fm_parser_init _idx_1) _code_2) in (case _1240 of {(0,f) -> u f (\_1241 _1242 _1243-> (u (u (u parser_reply_error _1241) _1242) _1243)); (1,f) -> u f (\_1244 _1245 _1246-> (let _1247 = (u (u (u fm_parser_text "mirror(") _1244) _1245) in (case _1247 of {(0,f) -> u f (\_1248 _1249 _1250-> (u (u (u parser_reply_error _1248) _1249) _1250)); (1,f) -> u f (\_1251 _1252 _1253-> (let _1254 = (u (u fm_parser_term _1251) _1252) in (case _1254 of {(0,f) -> u f (\_1255 _1256 _1257-> (u (u (u parser_reply_error _1255) _1256) _1257)); (1,f) -> u f (\_1258 _1259 _1260-> (let _1261 = (u (u (u fm_parser_text ")") _1258) _1259) in (case _1261 of {(0,f) -> u f (\_1262 _1263 _1264-> (u (u (u parser_reply_error _1262) _1263) _1264)); (1,f) -> u f (\_1265 _1266 _1267-> (let _1268 = (u (u (u fm_parser_stop _1246) _1265) _1266) in (case _1268 of {(0,f) -> u f (\_1269 _1270 _1271-> (u (u (u parser_reply_error _1269) _1270) _1271)); (1,f) -> u f (\_1272 _1273 _1274-> (let _term_18=(u fm_term_ref "Equal.mirror") in (let _term_19=(u (u fm_term_app _term_18) (u fm_term_hol bits_e)) in (let _term_20=(u (u fm_term_app _term_19) (u fm_term_hol bits_e)) in (let _term_21=(u (u fm_term_app _term_20) (u fm_term_hol bits_e)) in (let _term_22=(u (u fm_term_app _term_21) _1260) in (u (u (u parser_reply_value _1272) _1273) (u (u fm_term_ori _1274) _term_22)))))))); }))); }))); }))); }))); }))))
fm_name_read = (\_str_1-> _str_1)
fm_parser_list = (\_idx_1-> (\_code_2-> (let _1275 = (u (u fm_parser_init _idx_1) _code_2) in (case _1275 of {(0,f) -> u f (\_1276 _1277 _1278-> (u (u (u parser_reply_error _1276) _1277) _1278)); (1,f) -> u f (\_1279 _1280 _1281-> (let _1282 = (u (u (u fm_parser_text "[") _1279) _1280) in (case _1282 of {(0,f) -> u f (\_1283 _1284 _1285-> (u (u (u parser_reply_error _1283) _1284) _1285)); (1,f) -> u f (\_1286 _1287 _1288-> (let _1289 = (u (u (u (u parser_until (u fm_parser_text "]")) (u fm_parser_item fm_parser_term)) _1286) _1287) in (case _1289 of {(0,f) -> u f (\_1290 _1291 _1292-> (u (u (u parser_reply_error _1290) _1291) _1292)); (1,f) -> u f (\_1293 _1294 _1295-> (let _1296 = (u (u (u fm_parser_stop _1281) _1293) _1294) in (case _1296 of {(0,f) -> u f (\_1297 _1298 _1299-> (u (u (u parser_reply_error _1297) _1298) _1299)); (1,f) -> u f (\_1300 _1301 _1302-> (u (u (u parser_reply_value _1300) _1301) (u (u (u list_fold _1295) (u (u fm_term_app (u fm_term_ref (u fm_name_read "List.nil"))) (u fm_term_hol bits_e))) (\_x_15-> (\_xs_16-> (let _term_17=(u fm_term_ref (u fm_name_read "List.cons")) in (let _term_18=(u (u fm_term_app _term_17) (u fm_term_hol bits_e)) in (let _term_19=(u (u fm_term_app _term_18) _x_15) in (let _term_20=(u (u fm_term_app _term_19) _xs_16) in (u (u fm_term_ori _1302) _term_20)))))))))); }))); }))); }))); }))))
fm_parser_log = (\_idx_1-> (\_code_2-> (let _1303 = (u (u fm_parser_init _idx_1) _code_2) in (case _1303 of {(0,f) -> u f (\_1304 _1305 _1306-> (u (u (u parser_reply_error _1304) _1305) _1306)); (1,f) -> u f (\_1307 _1308 _1309-> (let _1310 = (u (u (u fm_parser_text "log(") _1307) _1308) in (case _1310 of {(0,f) -> u f (\_1311 _1312 _1313-> (u (u (u parser_reply_error _1311) _1312) _1313)); (1,f) -> u f (\_1314 _1315 _1316-> (let _1317 = (u (u (u (u parser_until (u fm_parser_text ")")) (u fm_parser_item fm_parser_term)) _1314) _1315) in (case _1317 of {(0,f) -> u f (\_1318 _1319 _1320-> (u (u (u parser_reply_error _1318) _1319) _1320)); (1,f) -> u f (\_1321 _1322 _1323-> (let _1324 = (u (u fm_parser_term _1321) _1322) in (case _1324 of {(0,f) -> u f (\_1325 _1326 _1327-> (u (u (u parser_reply_error _1325) _1326) _1327)); (1,f) -> u f (\_1328 _1329 _1330-> (let _term_15=(u fm_term_ref "Debug.log") in (let _term_16=(u (u fm_term_app _term_15) (u fm_term_hol bits_e)) in (let _args_17=(u (u (u list_fold _1323) (u fm_term_ref "String.nil")) (\_x_17-> (\_xs_18-> (let _arg_19=(u fm_term_ref "String.concat") in (let _arg_20=(u (u fm_term_app _arg_19) _x_17) in (let _arg_21=(u (u fm_term_app _arg_20) _xs_18) in _arg_21)))))) in (let _term_18=(u (u fm_term_app _term_16) _args_17) in (let _term_19=(u (u fm_term_app _term_18) (u (u fm_term_lam "x") (\_x_19-> _1330))) in (let _1331 = (u (u (u fm_parser_stop _1309) _1328) _1329) in (case _1331 of {(0,f) -> u f (\_1332 _1333 _1334-> (u (u (u parser_reply_error _1332) _1333) _1334)); (1,f) -> u f (\_1335 _1336 _1337-> (u (u (u parser_reply_value _1335) _1336) (u (u fm_term_ori _1337) _term_19))); })))))))); }))); }))); }))); }))))
fm_parser_forrange_u32 = (\_idx_1-> (\_code_2-> (let _1338 = (u (u fm_parser_init _idx_1) _code_2) in (case _1338 of {(0,f) -> u f (\_1339 _1340 _1341-> (u (u (u parser_reply_error _1339) _1340) _1341)); (1,f) -> u f (\_1342 _1343 _1344-> (let _1345 = (u (u (u fm_parser_text "for ") _1342) _1343) in (case _1345 of {(0,f) -> u f (\_1346 _1347 _1348-> (u (u (u parser_reply_error _1346) _1347) _1348)); (1,f) -> u f (\_1349 _1350 _1351-> (let _1352 = (u (u fm_parser_name1 _1349) _1350) in (case _1352 of {(0,f) -> u f (\_1353 _1354 _1355-> (u (u (u parser_reply_error _1353) _1354) _1355)); (1,f) -> u f (\_1356 _1357 _1358-> (let _1359 = (u (u (u fm_parser_text ":") _1356) _1357) in (case _1359 of {(0,f) -> u f (\_1360 _1361 _1362-> (u (u (u parser_reply_error _1360) _1361) _1362)); (1,f) -> u f (\_1363 _1364 _1365-> (let _1366 = (u (u (u fm_parser_text "U32") _1363) _1364) in (case _1366 of {(0,f) -> u f (\_1367 _1368 _1369-> (u (u (u parser_reply_error _1367) _1368) _1369)); (1,f) -> u f (\_1370 _1371 _1372-> (let _1373 = (u (u (u fm_parser_text "=") _1370) _1371) in (case _1373 of {(0,f) -> u f (\_1374 _1375 _1376-> (u (u (u parser_reply_error _1374) _1375) _1376)); (1,f) -> u f (\_1377 _1378 _1379-> (let _1380 = (u (u fm_parser_term _1377) _1378) in (case _1380 of {(0,f) -> u f (\_1381 _1382 _1383-> (u (u (u parser_reply_error _1381) _1382) _1383)); (1,f) -> u f (\_1384 _1385 _1386-> (let _1387 = (u (u (u fm_parser_text "..") _1384) _1385) in (case _1387 of {(0,f) -> u f (\_1388 _1389 _1390-> (u (u (u parser_reply_error _1388) _1389) _1390)); (1,f) -> u f (\_1391 _1392 _1393-> (let _1394 = (u (u fm_parser_term _1391) _1392) in (case _1394 of {(0,f) -> u f (\_1395 _1396 _1397-> (u (u (u parser_reply_error _1395) _1396) _1397)); (1,f) -> u f (\_1398 _1399 _1400-> (let _1401 = (u (u (u fm_parser_text "with") _1398) _1399) in (case _1401 of {(0,f) -> u f (\_1402 _1403 _1404-> (u (u (u parser_reply_error _1402) _1403) _1404)); (1,f) -> u f (\_1405 _1406 _1407-> (let _1408 = (u (u fm_parser_name1 _1405) _1406) in (case _1408 of {(0,f) -> u f (\_1409 _1410 _1411-> (u (u (u parser_reply_error _1409) _1410) _1411)); (1,f) -> u f (\_1412 _1413 _1414-> (let _1415 = (u (u (u fm_parser_text ":") _1412) _1413) in (case _1415 of {(0,f) -> u f (\_1416 _1417 _1418-> (u (u (u parser_reply_error _1416) _1417) _1418)); (1,f) -> u f (\_1419 _1420 _1421-> (let _1422 = (u (u fm_parser_term _1419) _1420) in (case _1422 of {(0,f) -> u f (\_1423 _1424 _1425-> (u (u (u parser_reply_error _1423) _1424) _1425)); (1,f) -> u f (\_1426 _1427 _1428-> (let _1429 = (u (u (u fm_parser_stop _1344) _1426) _1427) in (case _1429 of {(0,f) -> u f (\_1430 _1431 _1432-> (u (u (u parser_reply_error _1430) _1431) _1432)); (1,f) -> u f (\_1433 _1434 _1435-> (let _term_45=(u fm_term_ref "U32.for") in (let _term_46=(u (u fm_term_app _term_45) (u fm_term_hol bits_e)) in (let _term_47=(u (u fm_term_app _term_46) (u fm_term_ref _1414)) in (let _term_48=(u (u fm_term_app _term_47) _1386) in (let _term_49=(u (u fm_term_app _term_48) _1400) in (let _lamb_50=(u (u fm_term_lam _1358) (\_e_50-> (u (u fm_term_lam _1414) (\_s_51-> _1428)))) in (let _term_51=(u (u fm_term_app _term_49) _lamb_50) in (let _term_52=(u (u (u fm_term_let _1414) _term_51) (\_x_52-> (u fm_term_ref _1414))) in (u (u (u parser_reply_value _1433) _1434) (u (u fm_term_ori _1435) _term_52))))))))))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))))
fm_parser_forrange_u32_2 = (\_idx_1-> (\_code_2-> (let _1436 = (u (u fm_parser_init _idx_1) _code_2) in (case _1436 of {(0,f) -> u f (\_1437 _1438 _1439-> (u (u (u parser_reply_error _1437) _1438) _1439)); (1,f) -> u f (\_1440 _1441 _1442-> (let _1443 = (u (u (u fm_parser_text "for ") _1440) _1441) in (case _1443 of {(0,f) -> u f (\_1444 _1445 _1446-> (u (u (u parser_reply_error _1444) _1445) _1446)); (1,f) -> u f (\_1447 _1448 _1449-> (let _1450 = (u (u fm_parser_name1 _1447) _1448) in (case _1450 of {(0,f) -> u f (\_1451 _1452 _1453-> (u (u (u parser_reply_error _1451) _1452) _1453)); (1,f) -> u f (\_1454 _1455 _1456-> (let _1457 = (u (u (u fm_parser_text ":") _1454) _1455) in (case _1457 of {(0,f) -> u f (\_1458 _1459 _1460-> (u (u (u parser_reply_error _1458) _1459) _1460)); (1,f) -> u f (\_1461 _1462 _1463-> (let _1464 = (u (u (u fm_parser_text "U32") _1461) _1462) in (case _1464 of {(0,f) -> u f (\_1465 _1466 _1467-> (u (u (u parser_reply_error _1465) _1466) _1467)); (1,f) -> u f (\_1468 _1469 _1470-> (let _1471 = (u (u (u fm_parser_text "=") _1468) _1469) in (case _1471 of {(0,f) -> u f (\_1472 _1473 _1474-> (u (u (u parser_reply_error _1472) _1473) _1474)); (1,f) -> u f (\_1475 _1476 _1477-> (let _1478 = (u (u fm_parser_term _1475) _1476) in (case _1478 of {(0,f) -> u f (\_1479 _1480 _1481-> (u (u (u parser_reply_error _1479) _1480) _1481)); (1,f) -> u f (\_1482 _1483 _1484-> (let _1485 = (u (u (u fm_parser_text "..") _1482) _1483) in (case _1485 of {(0,f) -> u f (\_1486 _1487 _1488-> (u (u (u parser_reply_error _1486) _1487) _1488)); (1,f) -> u f (\_1489 _1490 _1491-> (let _1492 = (u (u fm_parser_term _1489) _1490) in (case _1492 of {(0,f) -> u f (\_1493 _1494 _1495-> (u (u (u parser_reply_error _1493) _1494) _1495)); (1,f) -> u f (\_1496 _1497 _1498-> (let _1499 = (u (u (u fm_parser_text ":") _1496) _1497) in (case _1499 of {(0,f) -> u f (\_1500 _1501 _1502-> (u (u (u parser_reply_error _1500) _1501) _1502)); (1,f) -> u f (\_1503 _1504 _1505-> (let _1506 = (u (u fm_parser_name1 _1503) _1504) in (case _1506 of {(0,f) -> u f (\_1507 _1508 _1509-> (u (u (u parser_reply_error _1507) _1508) _1509)); (1,f) -> u f (\_1510 _1511 _1512-> (let _1513 = (u (u (u fm_parser_text "=") _1510) _1511) in (case _1513 of {(0,f) -> u f (\_1514 _1515 _1516-> (u (u (u parser_reply_error _1514) _1515) _1516)); (1,f) -> u f (\_1517 _1518 _1519-> (let _1520 = (u (u fm_parser_term _1517) _1518) in (case _1520 of {(0,f) -> u f (\_1521 _1522 _1523-> (u (u (u parser_reply_error _1521) _1522) _1523)); (1,f) -> u f (\_1524 _1525 _1526-> (let _1527 = (u (u (u parser_maybe (u fm_parser_text ";")) _1524) _1525) in (case _1527 of {(0,f) -> u f (\_1528 _1529 _1530-> (u (u (u parser_reply_error _1528) _1529) _1530)); (1,f) -> u f (\_1531 _1532 _1533-> (let _1534 = (u (u fm_parser_term _1531) _1532) in (case _1534 of {(0,f) -> u f (\_1535 _1536 _1537-> (u (u (u parser_reply_error _1535) _1536) _1537)); (1,f) -> u f (\_1538 _1539 _1540-> (let _1541 = (u (u (u fm_parser_stop _1442) _1538) _1539) in (case _1541 of {(0,f) -> u f (\_1542 _1543 _1544-> (u (u (u parser_reply_error _1542) _1543) _1544)); (1,f) -> u f (\_1545 _1546 _1547-> (let _term_51=(u fm_term_ref "U32.for") in (let _term_52=(u (u fm_term_app _term_51) (u fm_term_hol bits_e)) in (let _term_53=(u (u fm_term_app _term_52) (u fm_term_ref _1512)) in (let _term_54=(u (u fm_term_app _term_53) _1484) in (let _term_55=(u (u fm_term_app _term_54) _1498) in (let _lamb_56=(u (u fm_term_lam _1456) (\_e_56-> (u (u fm_term_lam _1512) (\_s_57-> _1526)))) in (let _term_57=(u (u fm_term_app _term_55) _lamb_56) in (let _term_58=(u (u (u fm_term_let _1512) _term_57) (\_x_58-> _1540)) in (u (u (u parser_reply_value _1545) _1546) (u (u fm_term_ori _1547) _term_58))))))))))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))))
fm_parser_forin = (\_idx_1-> (\_code_2-> (let _1548 = (u (u fm_parser_init _idx_1) _code_2) in (case _1548 of {(0,f) -> u f (\_1549 _1550 _1551-> (u (u (u parser_reply_error _1549) _1550) _1551)); (1,f) -> u f (\_1552 _1553 _1554-> (let _1555 = (u (u (u fm_parser_text "for ") _1552) _1553) in (case _1555 of {(0,f) -> u f (\_1556 _1557 _1558-> (u (u (u parser_reply_error _1556) _1557) _1558)); (1,f) -> u f (\_1559 _1560 _1561-> (let _1562 = (u (u fm_parser_name1 _1559) _1560) in (case _1562 of {(0,f) -> u f (\_1563 _1564 _1565-> (u (u (u parser_reply_error _1563) _1564) _1565)); (1,f) -> u f (\_1566 _1567 _1568-> (let _1569 = (u (u (u fm_parser_text "in") _1566) _1567) in (case _1569 of {(0,f) -> u f (\_1570 _1571 _1572-> (u (u (u parser_reply_error _1570) _1571) _1572)); (1,f) -> u f (\_1573 _1574 _1575-> (let _1576 = (u (u fm_parser_term _1573) _1574) in (case _1576 of {(0,f) -> u f (\_1577 _1578 _1579-> (u (u (u parser_reply_error _1577) _1578) _1579)); (1,f) -> u f (\_1580 _1581 _1582-> (let _1583 = (u (u (u fm_parser_text "with") _1580) _1581) in (case _1583 of {(0,f) -> u f (\_1584 _1585 _1586-> (u (u (u parser_reply_error _1584) _1585) _1586)); (1,f) -> u f (\_1587 _1588 _1589-> (let _1590 = (u (u fm_parser_name1 _1587) _1588) in (case _1590 of {(0,f) -> u f (\_1591 _1592 _1593-> (u (u (u parser_reply_error _1591) _1592) _1593)); (1,f) -> u f (\_1594 _1595 _1596-> (let _1597 = (u (u (u fm_parser_text ":") _1594) _1595) in (case _1597 of {(0,f) -> u f (\_1598 _1599 _1600-> (u (u (u parser_reply_error _1598) _1599) _1600)); (1,f) -> u f (\_1601 _1602 _1603-> (let _1604 = (u (u fm_parser_term _1601) _1602) in (case _1604 of {(0,f) -> u f (\_1605 _1606 _1607-> (u (u (u parser_reply_error _1605) _1606) _1607)); (1,f) -> u f (\_1608 _1609 _1610-> (let _1611 = (u (u (u fm_parser_stop _1554) _1608) _1609) in (case _1611 of {(0,f) -> u f (\_1612 _1613 _1614-> (u (u (u parser_reply_error _1612) _1613) _1614)); (1,f) -> u f (\_1615 _1616 _1617-> (let _term_33=(u fm_term_ref "List.for") in (let _term_34=(u (u fm_term_app _term_33) (u fm_term_hol bits_e)) in (let _term_35=(u (u fm_term_app _term_34) _1582) in (let _term_36=(u (u fm_term_app _term_35) (u fm_term_hol bits_e)) in (let _term_37=(u (u fm_term_app _term_36) (u fm_term_ref _1596)) in (let _lamb_38=(u (u fm_term_lam _1568) (\_i_38-> (u (u fm_term_lam _1596) (\_x_39-> _1610)))) in (let _term_39=(u (u fm_term_app _term_37) _lamb_38) in (let _term_40=(u (u (u fm_term_let _1596) _term_39) (\_x_40-> (u fm_term_ref _1596))) in (u (u (u parser_reply_value _1615) _1616) (u (u fm_term_ori _1617) _term_40))))))))))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))))
fm_parser_forin_2 = (\_idx_1-> (\_code_2-> (let _1618 = (u (u fm_parser_init _idx_1) _code_2) in (case _1618 of {(0,f) -> u f (\_1619 _1620 _1621-> (u (u (u parser_reply_error _1619) _1620) _1621)); (1,f) -> u f (\_1622 _1623 _1624-> (let _1625 = (u (u (u fm_parser_text "for ") _1622) _1623) in (case _1625 of {(0,f) -> u f (\_1626 _1627 _1628-> (u (u (u parser_reply_error _1626) _1627) _1628)); (1,f) -> u f (\_1629 _1630 _1631-> (let _1632 = (u (u fm_parser_name1 _1629) _1630) in (case _1632 of {(0,f) -> u f (\_1633 _1634 _1635-> (u (u (u parser_reply_error _1633) _1634) _1635)); (1,f) -> u f (\_1636 _1637 _1638-> (let _1639 = (u (u (u fm_parser_text "in") _1636) _1637) in (case _1639 of {(0,f) -> u f (\_1640 _1641 _1642-> (u (u (u parser_reply_error _1640) _1641) _1642)); (1,f) -> u f (\_1643 _1644 _1645-> (let _1646 = (u (u fm_parser_term _1643) _1644) in (case _1646 of {(0,f) -> u f (\_1647 _1648 _1649-> (u (u (u parser_reply_error _1647) _1648) _1649)); (1,f) -> u f (\_1650 _1651 _1652-> (let _1653 = (u (u (u fm_parser_text ":") _1650) _1651) in (case _1653 of {(0,f) -> u f (\_1654 _1655 _1656-> (u (u (u parser_reply_error _1654) _1655) _1656)); (1,f) -> u f (\_1657 _1658 _1659-> (let _1660 = (u (u fm_parser_name1 _1657) _1658) in (case _1660 of {(0,f) -> u f (\_1661 _1662 _1663-> (u (u (u parser_reply_error _1661) _1662) _1663)); (1,f) -> u f (\_1664 _1665 _1666-> (let _1667 = (u (u (u fm_parser_text "=") _1664) _1665) in (case _1667 of {(0,f) -> u f (\_1668 _1669 _1670-> (u (u (u parser_reply_error _1668) _1669) _1670)); (1,f) -> u f (\_1671 _1672 _1673-> (let _1674 = (u (u fm_parser_term _1671) _1672) in (case _1674 of {(0,f) -> u f (\_1675 _1676 _1677-> (u (u (u parser_reply_error _1675) _1676) _1677)); (1,f) -> u f (\_1678 _1679 _1680-> (let _1681 = (u (u (u parser_maybe (u fm_parser_text ";")) _1678) _1679) in (case _1681 of {(0,f) -> u f (\_1682 _1683 _1684-> (u (u (u parser_reply_error _1682) _1683) _1684)); (1,f) -> u f (\_1685 _1686 _1687-> (let _1688 = (u (u fm_parser_term _1685) _1686) in (case _1688 of {(0,f) -> u f (\_1689 _1690 _1691-> (u (u (u parser_reply_error _1689) _1690) _1691)); (1,f) -> u f (\_1692 _1693 _1694-> (let _1695 = (u (u (u fm_parser_stop _1624) _1692) _1693) in (case _1695 of {(0,f) -> u f (\_1696 _1697 _1698-> (u (u (u parser_reply_error _1696) _1697) _1698)); (1,f) -> u f (\_1699 _1700 _1701-> (let _term_39=(u fm_term_ref "List.for") in (let _term_40=(u (u fm_term_app _term_39) (u fm_term_hol bits_e)) in (let _term_41=(u (u fm_term_app _term_40) _1652) in (let _term_42=(u (u fm_term_app _term_41) (u fm_term_hol bits_e)) in (let _term_43=(u (u fm_term_app _term_42) (u fm_term_ref _1666)) in (let _lamb_44=(u (u fm_term_lam _1638) (\_i_44-> (u (u fm_term_lam _1666) (\_x_45-> _1680)))) in (let _term_45=(u (u fm_term_app _term_43) _lamb_44) in (let _term_46=(u (u (u fm_term_let _1666) _term_45) (\_x_46-> _1694)) in (u (u (u parser_reply_value _1699) _1700) (u (u fm_term_ori _1701) _term_46))))))))))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))))
fm_parser_do_statements = (\_monad_name_1-> (u parser_first_of (u (u list_cons (\_idx_2-> (\_code_3-> (let _1702 = (u (u fm_parser_init _idx_2) _code_3) in (case _1702 of {(0,f) -> u f (\_1703 _1704 _1705-> (u (u (u parser_reply_error _1703) _1704) _1705)); (1,f) -> u f (\_1706 _1707 _1708-> (let _1709 = (u (u (u fm_parser_text "var ") _1706) _1707) in (case _1709 of {(0,f) -> u f (\_1710 _1711 _1712-> (u (u (u parser_reply_error _1710) _1711) _1712)); (1,f) -> u f (\_1713 _1714 _1715-> (let _1716 = (u (u fm_parser_name1 _1713) _1714) in (case _1716 of {(0,f) -> u f (\_1717 _1718 _1719-> (u (u (u parser_reply_error _1717) _1718) _1719)); (1,f) -> u f (\_1720 _1721 _1722-> (let _1723 = (u (u (u fm_parser_text "=") _1720) _1721) in (case _1723 of {(0,f) -> u f (\_1724 _1725 _1726-> (u (u (u parser_reply_error _1724) _1725) _1726)); (1,f) -> u f (\_1727 _1728 _1729-> (let _1730 = (u (u fm_parser_term _1727) _1728) in (case _1730 of {(0,f) -> u f (\_1731 _1732 _1733-> (u (u (u parser_reply_error _1731) _1732) _1733)); (1,f) -> u f (\_1734 _1735 _1736-> (let _1737 = (u (u (u parser_maybe (u fm_parser_text ";")) _1734) _1735) in (case _1737 of {(0,f) -> u f (\_1738 _1739 _1740-> (u (u (u parser_reply_error _1738) _1739) _1740)); (1,f) -> u f (\_1741 _1742 _1743-> (let _1744 = (u (u (u fm_parser_do_statements _monad_name_1) _1741) _1742) in (case _1744 of {(0,f) -> u f (\_1745 _1746 _1747-> (u (u (u parser_reply_error _1745) _1746) _1747)); (1,f) -> u f (\_1748 _1749 _1750-> (let _1751 = (u (u (u fm_parser_stop _1708) _1748) _1749) in (case _1751 of {(0,f) -> u f (\_1752 _1753 _1754-> (u (u (u parser_reply_error _1752) _1753) _1754)); (1,f) -> u f (\_1755 _1756 _1757-> (let _term_28=(u (u fm_term_app (u fm_term_ref "Monad.bind")) (u fm_term_ref _monad_name_1)) in (let _term_29=(u (u fm_term_app _term_28) (u fm_term_ref (((_monad_name_1::String) ++ ".monad")))) in (let _term_30=(u (u fm_term_app _term_29) (u fm_term_hol bits_e)) in (let _term_31=(u (u fm_term_app _term_30) (u fm_term_hol bits_e)) in (let _term_32=(u (u fm_term_app _term_31) _1736) in (let _term_33=(u (u fm_term_app _term_32) (u (u fm_term_lam _1722) (\_x_33-> _1750))) in (u (u (u parser_reply_value _1755) _1756) (u (u fm_term_ori _1757) _term_33))))))))); }))); }))); }))); }))); }))); }))); }))); }))))) (u (u list_cons (\_idx_2-> (\_code_3-> (let _1758 = (u (u fm_parser_init _idx_2) _code_3) in (case _1758 of {(0,f) -> u f (\_1759 _1760 _1761-> (u (u (u parser_reply_error _1759) _1760) _1761)); (1,f) -> u f (\_1762 _1763 _1764-> (let _1765 = (u (u (u fm_parser_text "let ") _1762) _1763) in (case _1765 of {(0,f) -> u f (\_1766 _1767 _1768-> (u (u (u parser_reply_error _1766) _1767) _1768)); (1,f) -> u f (\_1769 _1770 _1771-> (let _1772 = (u (u fm_parser_name1 _1769) _1770) in (case _1772 of {(0,f) -> u f (\_1773 _1774 _1775-> (u (u (u parser_reply_error _1773) _1774) _1775)); (1,f) -> u f (\_1776 _1777 _1778-> (let _1779 = (u (u (u fm_parser_text "=") _1776) _1777) in (case _1779 of {(0,f) -> u f (\_1780 _1781 _1782-> (u (u (u parser_reply_error _1780) _1781) _1782)); (1,f) -> u f (\_1783 _1784 _1785-> (let _1786 = (u (u fm_parser_term _1783) _1784) in (case _1786 of {(0,f) -> u f (\_1787 _1788 _1789-> (u (u (u parser_reply_error _1787) _1788) _1789)); (1,f) -> u f (\_1790 _1791 _1792-> (let _1793 = (u (u (u parser_maybe (u fm_parser_text ";")) _1790) _1791) in (case _1793 of {(0,f) -> u f (\_1794 _1795 _1796-> (u (u (u parser_reply_error _1794) _1795) _1796)); (1,f) -> u f (\_1797 _1798 _1799-> (let _1800 = (u (u (u fm_parser_do_statements _monad_name_1) _1797) _1798) in (case _1800 of {(0,f) -> u f (\_1801 _1802 _1803-> (u (u (u parser_reply_error _1801) _1802) _1803)); (1,f) -> u f (\_1804 _1805 _1806-> (let _1807 = (u (u (u fm_parser_stop _1764) _1804) _1805) in (case _1807 of {(0,f) -> u f (\_1808 _1809 _1810-> (u (u (u parser_reply_error _1808) _1809) _1810)); (1,f) -> u f (\_1811 _1812 _1813-> (u (u (u parser_reply_value _1811) _1812) (u (u fm_term_ori _1813) (u (u (u fm_term_let _1778) _1792) (\_x_28-> _1806))))); }))); }))); }))); }))); }))); }))); }))); }))))) (u (u list_cons (\_idx_2-> (\_code_3-> (let _1814 = (u (u fm_parser_init _idx_2) _code_3) in (case _1814 of {(0,f) -> u f (\_1815 _1816 _1817-> (u (u (u parser_reply_error _1815) _1816) _1817)); (1,f) -> u f (\_1818 _1819 _1820-> (let _1821 = (u (u (u fm_parser_text "return ") _1818) _1819) in (case _1821 of {(0,f) -> u f (\_1822 _1823 _1824-> (u (u (u parser_reply_error _1822) _1823) _1824)); (1,f) -> u f (\_1825 _1826 _1827-> (let _1828 = (u (u fm_parser_term _1825) _1826) in (case _1828 of {(0,f) -> u f (\_1829 _1830 _1831-> (u (u (u parser_reply_error _1829) _1830) _1831)); (1,f) -> u f (\_1832 _1833 _1834-> (let _1835 = (u (u (u parser_maybe (u fm_parser_text ";")) _1832) _1833) in (case _1835 of {(0,f) -> u f (\_1836 _1837 _1838-> (u (u (u parser_reply_error _1836) _1837) _1838)); (1,f) -> u f (\_1839 _1840 _1841-> (let _1842 = (u (u (u fm_parser_stop _1820) _1839) _1840) in (case _1842 of {(0,f) -> u f (\_1843 _1844 _1845-> (u (u (u parser_reply_error _1843) _1844) _1845)); (1,f) -> u f (\_1846 _1847 _1848-> (let _term_19=(u (u fm_term_app (u fm_term_ref "Monad.pure")) (u fm_term_ref _monad_name_1)) in (let _term_20=(u (u fm_term_app _term_19) (u fm_term_ref (((_monad_name_1::String) ++ ".monad")))) in (let _term_21=(u (u fm_term_app _term_20) (u fm_term_hol bits_e)) in (let _term_22=(u (u fm_term_app _term_21) _1834) in (u (u (u parser_reply_value _1846) _1847) (u (u fm_term_ori _1848) _term_22))))))); }))); }))); }))); }))); }))))) (u (u list_cons (\_idx_2-> (\_code_3-> (let _1849 = (u (u fm_parser_init _idx_2) _code_3) in (case _1849 of {(0,f) -> u f (\_1850 _1851 _1852-> (u (u (u parser_reply_error _1850) _1851) _1852)); (1,f) -> u f (\_1853 _1854 _1855-> (let _1856 = (u (u fm_parser_term _1853) _1854) in (case _1856 of {(0,f) -> u f (\_1857 _1858 _1859-> (u (u (u parser_reply_error _1857) _1858) _1859)); (1,f) -> u f (\_1860 _1861 _1862-> (let _1863 = (u (u (u parser_maybe (u fm_parser_text ";")) _1860) _1861) in (case _1863 of {(0,f) -> u f (\_1864 _1865 _1866-> (u (u (u parser_reply_error _1864) _1865) _1866)); (1,f) -> u f (\_1867 _1868 _1869-> (let _1870 = (u (u (u fm_parser_do_statements _monad_name_1) _1867) _1868) in (case _1870 of {(0,f) -> u f (\_1871 _1872 _1873-> (u (u (u parser_reply_error _1871) _1872) _1873)); (1,f) -> u f (\_1874 _1875 _1876-> (let _1877 = (u (u (u fm_parser_stop _1855) _1874) _1875) in (case _1877 of {(0,f) -> u f (\_1878 _1879 _1880-> (u (u (u parser_reply_error _1878) _1879) _1880)); (1,f) -> u f (\_1881 _1882 _1883-> (let _term_19=(u (u fm_term_app (u fm_term_ref "Monad.bind")) (u fm_term_ref _monad_name_1)) in (let _term_20=(u (u fm_term_app _term_19) (u fm_term_ref (((_monad_name_1::String) ++ ".monad")))) in (let _term_21=(u (u fm_term_app _term_20) (u fm_term_hol bits_e)) in (let _term_22=(u (u fm_term_app _term_21) (u fm_term_hol bits_e)) in (let _term_23=(u (u fm_term_app _term_22) _1862) in (let _term_24=(u (u fm_term_app _term_23) (u (u fm_term_lam "") (\_x_24-> _1876))) in (u (u (u parser_reply_value _1881) _1882) (u (u fm_term_ori _1883) _term_24))))))))); }))); }))); }))); }))); }))))) (u (u list_cons (\_idx_2-> (\_code_3-> (let _1884 = (u (u fm_parser_term _idx_2) _code_3) in (case _1884 of {(0,f) -> u f (\_1885 _1886 _1887-> (u (u (u parser_reply_error _1885) _1886) _1887)); (1,f) -> u f (\_1888 _1889 _1890-> (let _1891 = (u (u (u parser_maybe (u fm_parser_text ";")) _1888) _1889) in (case _1891 of {(0,f) -> u f (\_1892 _1893 _1894-> (u (u (u parser_reply_error _1892) _1893) _1894)); (1,f) -> u f (\_1895 _1896 _1897-> (u (u (u parser_reply_value _1895) _1896) _1890)); }))); }))))) list_nil)))))))
fm_parser_do = (\_idx_1-> (\_code_2-> (let _1898 = (u (u (u fm_parser_text "do ") _idx_1) _code_2) in (case _1898 of {(0,f) -> u f (\_1899 _1900 _1901-> (u (u (u parser_reply_error _1899) _1900) _1901)); (1,f) -> u f (\_1902 _1903 _1904-> (let _1905 = (u (u fm_parser_name1 _1902) _1903) in (case _1905 of {(0,f) -> u f (\_1906 _1907 _1908-> (u (u (u parser_reply_error _1906) _1907) _1908)); (1,f) -> u f (\_1909 _1910 _1911-> (let _1912 = (u (u (u fm_parser_text "{") _1909) _1910) in (case _1912 of {(0,f) -> u f (\_1913 _1914 _1915-> (u (u (u parser_reply_error _1913) _1914) _1915)); (1,f) -> u f (\_1916 _1917 _1918-> (let _1919 = (u (u (u fm_parser_do_statements _1911) _1916) _1917) in (case _1919 of {(0,f) -> u f (\_1920 _1921 _1922-> (u (u (u parser_reply_error _1920) _1921) _1922)); (1,f) -> u f (\_1923 _1924 _1925-> (let _1926 = (u (u (u fm_parser_text "}") _1923) _1924) in (case _1926 of {(0,f) -> u f (\_1927 _1928 _1929-> (u (u (u parser_reply_error _1927) _1928) _1929)); (1,f) -> u f (\_1930 _1931 _1932-> (u (u (u parser_reply_value _1930) _1931) _1925)); }))); }))); }))); }))); }))))
fm_term_nat = (\_natx_1-> (11,\t-> t _natx_1))
fm_term_unroll_nat = (\_natx_1-> (let _1933 = _natx_1 in (if _1933==0 then (u fm_term_ref (u fm_name_read "Nat.zero")) else (let _func_3=(u fm_term_ref (u fm_name_read "Nat.succ")) in (let _argm_4=(u fm_term_nat (_1933-1)) in (u (u fm_term_app _func_3) _argm_4))))))
u16_to_bits = (\_a_1-> (let _1934 = _a_1 in (u word_to_bits (u16_to_word _1934))))
fm_term_unroll_chr_bits = (\_bits_1-> (let _1935 = _bits_1 in (case _1935 of {(0,f) -> u f ((u fm_term_ref (u fm_name_read "Bits.e"))); (1,f) -> u f (\_1936-> (u (u fm_term_app (u fm_term_ref (u fm_name_read "Bits.o"))) (u fm_term_unroll_chr_bits _1936))); (2,f) -> u f (\_1937-> (u (u fm_term_app (u fm_term_ref (u fm_name_read "Bits.i"))) (u fm_term_unroll_chr_bits _1937))); })))
fm_term_unroll_chr = (\_chrx_1-> (let _bits_2=(u u16_to_bits _chrx_1) in (let _term_3=(u fm_term_ref (u fm_name_read "Word.from_bits")) in (let _term_4=(u (u fm_term_app _term_3) (u fm_term_nat 16)) in (let _term_5=(u (u fm_term_app _term_4) (u fm_term_unroll_chr_bits _bits_2)) in (let _term_6=(u (u fm_term_app (u fm_term_ref (u fm_name_read "U16.new"))) _term_5) in _term_6))))))
fm_term_unroll_str = (\_strx_1-> (let _1938 = _strx_1 in (if null (_1938::String) then (u fm_term_ref (u fm_name_read "String.nil")) else (let _char_4=(u fm_term_chr (fromIntegral (fromEnum (head _1938 :: Char)) :: Word16)) in (let _term_5=(u fm_term_ref (u fm_name_read "String.cons")) in (let _term_6=(u (u fm_term_app _term_5) _char_4) in (let _term_7=(u (u fm_term_app _term_6) (u fm_term_str (tail _1938))) in _term_7)))))))
fm_term_reduce = (\_term_1-> (\_defs_2-> (let _1939 = _term_1 in (case _1939 of {(0,f) -> u f (\_1940 _1941-> _term_1); (1,f) -> u f (\_1942-> (let _1943 = (u (u fm_get _1942) _defs_2) in (case _1943 of {(0,f) -> u f ((u fm_term_ref _1942)); (1,f) -> u f (\_1944-> (let _1945 = _1944 in (case _1945 of {(0,f) -> u f (\_1946 _1947 _1948 _1949 _1950 _1951-> (u (u fm_term_reduce _1949) _defs_2)); }))); }))); (2,f) -> u f (_term_1); (3,f) -> u f (\_1952 _1953 _1954 _1955 _1956-> _term_1); (4,f) -> u f (\_1957 _1958-> _term_1); (5,f) -> u f (\_1959 _1960-> (let _func_5=(u (u fm_term_reduce _1959) _defs_2) in (let _1961 = _func_5 in (case _1961 of {(0,f) -> u f (\_1962 _1963-> _term_1); (1,f) -> u f (\_1964-> _term_1); (2,f) -> u f (_term_1); (3,f) -> u f (\_1965 _1966 _1967 _1968 _1969-> _term_1); (4,f) -> u f (\_1970 _1971-> (u (u fm_term_reduce (u _1971 _1960)) _defs_2)); (5,f) -> u f (\_1972 _1973-> _term_1); (6,f) -> u f (\_1974 _1975 _1976-> _term_1); (7,f) -> u f (\_1977 _1978 _1979-> _term_1); (8,f) -> u f (\_1980 _1981 _1982-> _term_1); (9,f) -> u f (\_1983 _1984 _1985-> _term_1); (10,f) -> u f (\_1986-> _term_1); (11,f) -> u f (\_1987-> _term_1); (12,f) -> u f (\_1988-> _term_1); (13,f) -> u f (\_1989-> _term_1); (14,f) -> u f (\_1990 _1991 _1992 _1993 _1994 _1995-> _term_1); (15,f) -> u f (\_1996 _1997-> _term_1); })))); (6,f) -> u f (\_1998 _1999 _2000-> (u (u fm_term_reduce (u _2000 _1999)) _defs_2)); (7,f) -> u f (\_2001 _2002 _2003-> (u (u fm_term_reduce (u _2003 _2002)) _defs_2)); (8,f) -> u f (\_2004 _2005 _2006-> (u (u fm_term_reduce _2005) _defs_2)); (9,f) -> u f (\_2007 _2008 _2009-> _term_1); (10,f) -> u f (\_2010-> _term_1); (11,f) -> u f (\_2011-> (u (u fm_term_reduce (u fm_term_unroll_nat _2011)) _defs_2)); (12,f) -> u f (\_2012-> (u (u fm_term_reduce (u fm_term_unroll_chr _2012)) _defs_2)); (13,f) -> u f (\_2013-> (u (u fm_term_reduce (u fm_term_unroll_str _2013)) _defs_2)); (14,f) -> u f (\_2014 _2015 _2016 _2017 _2018 _2019-> _term_1); (15,f) -> u f (\_2020 _2021-> (u (u fm_term_reduce _2021) _defs_2)); }))))
map_new = (0,\t-> t)
fm_def_new = (\_file_1-> (\_code_2-> (\_name_3-> (\_term_4-> (\_type_5-> (\_stat_6-> (0,\t-> t _file_1 _code_2 _name_3 _term_4 _type_5 _stat_6)))))))
fm_status_init = (0,\t-> t)
fm_parser_case_with = (\_idx_1-> (\_code_2-> (let _2022 = (u (u (u fm_parser_text "with") _idx_1) _code_2) in (case _2022 of {(0,f) -> u f (\_2023 _2024 _2025-> (u (u (u parser_reply_error _2023) _2024) _2025)); (1,f) -> u f (\_2026 _2027 _2028-> (let _2029 = (u (u fm_parser_name1 _2026) _2027) in (case _2029 of {(0,f) -> u f (\_2030 _2031 _2032-> (u (u (u parser_reply_error _2030) _2031) _2032)); (1,f) -> u f (\_2033 _2034 _2035-> (let _2036 = (u (u (u fm_parser_text ":") _2033) _2034) in (case _2036 of {(0,f) -> u f (\_2037 _2038 _2039-> (u (u (u parser_reply_error _2037) _2038) _2039)); (1,f) -> u f (\_2040 _2041 _2042-> (let _2043 = (u (u fm_parser_term _2040) _2041) in (case _2043 of {(0,f) -> u f (\_2044 _2045 _2046-> (u (u (u parser_reply_error _2044) _2045) _2046)); (1,f) -> u f (\_2047 _2048 _2049-> (let _2050 = (u (u (u fm_parser_text "=") _2047) _2048) in (case _2050 of {(0,f) -> u f (\_2051 _2052 _2053-> (u (u (u parser_reply_error _2051) _2052) _2053)); (1,f) -> u f (\_2054 _2055 _2056-> (let _2057 = (u (u fm_parser_term _2054) _2055) in (case _2057 of {(0,f) -> u f (\_2058 _2059 _2060-> (u (u (u parser_reply_error _2058) _2059) _2060)); (1,f) -> u f (\_2061 _2062 _2063-> (u (u (u parser_reply_value _2061) _2062) (u (u (u (u (u (u fm_def_new "") "") _2035) _2063) _2049) fm_status_init))); }))); }))); }))); }))); }))); }))))
fm_parser_case_case = (\_idx_1-> (\_code_2-> (let _2064 = (u (u fm_parser_name1 _idx_1) _code_2) in (case _2064 of {(0,f) -> u f (\_2065 _2066 _2067-> (u (u (u parser_reply_error _2065) _2066) _2067)); (1,f) -> u f (\_2068 _2069 _2070-> (let _2071 = (u (u (u fm_parser_text ":") _2068) _2069) in (case _2071 of {(0,f) -> u f (\_2072 _2073 _2074-> (u (u (u parser_reply_error _2072) _2073) _2074)); (1,f) -> u f (\_2075 _2076 _2077-> (let _2078 = (u (u fm_parser_term _2075) _2076) in (case _2078 of {(0,f) -> u f (\_2079 _2080 _2081-> (u (u (u parser_reply_error _2079) _2080) _2081)); (1,f) -> u f (\_2082 _2083 _2084-> (let _2085 = (u (u (u parser_maybe (u fm_parser_text ",")) _2082) _2083) in (case _2085 of {(0,f) -> u f (\_2086 _2087 _2088-> (u (u (u parser_reply_error _2086) _2087) _2088)); (1,f) -> u f (\_2089 _2090 _2091-> (u (u (u parser_reply_value _2089) _2090) (u (u pair_new _2070) _2084))); }))); }))); }))); }))))
map_tie = (\_val_2-> (\_lft_3-> (\_rgt_4-> (1,\t-> t _val_2 _lft_3 _rgt_4))))
map_set = (\_bits_2-> (\_val_3-> (\_map_4-> (let _2092 = _bits_2 in (case _2092 of {(0,f) -> u f ((let _2093 = _map_4 in (case _2093 of {(0,f) -> u f ((u (u (u map_tie (u maybe_some _val_3)) map_new) map_new)); (1,f) -> u f (\_2094 _2095 _2096-> (u (u (u map_tie (u maybe_some _val_3)) _2095) _2096)); }))); (1,f) -> u f (\_2097-> (let _2098 = _map_4 in (case _2098 of {(0,f) -> u f ((u (u (u map_tie maybe_none) (u (u (u map_set _2097) _val_3) map_new)) map_new)); (1,f) -> u f (\_2099 _2100 _2101-> (u (u (u map_tie _2099) (u (u (u map_set _2097) _val_3) _2100)) _2101)); }))); (2,f) -> u f (\_2102-> (let _2103 = _map_4 in (case _2103 of {(0,f) -> u f ((u (u (u map_tie maybe_none) map_new) (u (u (u map_set _2102) _val_3) map_new))); (1,f) -> u f (\_2104 _2105 _2106-> (u (u (u map_tie _2104) _2105) (u (u (u map_set _2102) _val_3) _2106))); }))); })))))
map_from_list = (\_xs_2-> (let _2107 = _xs_2 in (case _2107 of {(0,f) -> u f (map_new); (1,f) -> u f (\_2108 _2109-> (let _2110 = _2108 in (case _2110 of {(0,f) -> u f (\_2111 _2112-> (u (u (u map_set _2111) _2112) (u map_from_list _2109))); }))); })))
pair_fst = (\_pair_3-> (let _2113 = _pair_3 in (case _2113 of {(0,f) -> u f (\_2114 _2115-> _2114); })))
pair_snd = (\_pair_3-> (let _2116 = _pair_3 in (case _2116 of {(0,f) -> u f (\_2117 _2118-> _2118); })))
fm_term_cse = (\_path_1-> (\_expr_2-> (\_name_3-> (\_with_4-> (\_cses_5-> (\_moti_6-> (14,\t-> t _path_1 _expr_2 _name_3 _with_4 _cses_5 _moti_6)))))))
fm_parser_case = (\_idx_1-> (\_code_2-> (let _2119 = (u (u fm_parser_init _idx_1) _code_2) in (case _2119 of {(0,f) -> u f (\_2120 _2121 _2122-> (u (u (u parser_reply_error _2120) _2121) _2122)); (1,f) -> u f (\_2123 _2124 _2125-> (let _2126 = (u (u (u fm_parser_text "case ") _2123) _2124) in (case _2126 of {(0,f) -> u f (\_2127 _2128 _2129-> (u (u (u parser_reply_error _2127) _2128) _2129)); (1,f) -> u f (\_2130 _2131 _2132-> (let _2133 = (u (u fm_parser_spaces _2130) _2131) in (case _2133 of {(0,f) -> u f (\_2134 _2135 _2136-> (u (u (u parser_reply_error _2134) _2135) _2136)); (1,f) -> u f (\_2137 _2138 _2139-> (let _2140 = (u (u fm_parser_term _2137) _2138) in (case _2140 of {(0,f) -> u f (\_2141 _2142 _2143-> (u (u (u parser_reply_error _2141) _2142) _2143)); (1,f) -> u f (\_2144 _2145 _2146-> (let _2147 = (u (u (u parser_maybe (\_idx_15-> (\_code_16-> (let _2148 = (u (u (u fm_parser_text "as") _idx_15) _code_16) in (case _2148 of {(0,f) -> u f (\_2149 _2150 _2151-> (u (u (u parser_reply_error _2149) _2150) _2151)); (1,f) -> u f (\_2152 _2153 _2154-> (u (u fm_parser_name1 _2152) _2153)); }))))) _2144) _2145) in (case _2147 of {(0,f) -> u f (\_2155 _2156 _2157-> (u (u (u parser_reply_error _2155) _2156) _2157)); (1,f) -> u f (\_2158 _2159 _2160-> (let _name_18=(let _2161 = _2160 in (case _2161 of {(0,f) -> u f ((let _2162 = (u (u fm_term_reduce _2146) map_new) in (case _2162 of {(0,f) -> u f (\_2163 _2164-> _2163); (1,f) -> u f (\_2165-> _2165); (2,f) -> u f ((u fm_name_read "self")); (3,f) -> u f (\_2166 _2167 _2168 _2169 _2170-> (u fm_name_read "self")); (4,f) -> u f (\_2171 _2172-> (u fm_name_read "self")); (5,f) -> u f (\_2173 _2174-> (u fm_name_read "self")); (6,f) -> u f (\_2175 _2176 _2177-> (u fm_name_read "self")); (7,f) -> u f (\_2178 _2179 _2180-> (u fm_name_read "self")); (8,f) -> u f (\_2181 _2182 _2183-> (u fm_name_read "self")); (9,f) -> u f (\_2184 _2185 _2186-> (u fm_name_read "self")); (10,f) -> u f (\_2187-> (u fm_name_read "self")); (11,f) -> u f (\_2188-> (u fm_name_read "self")); (12,f) -> u f (\_2189-> (u fm_name_read "self")); (13,f) -> u f (\_2190-> (u fm_name_read "self")); (14,f) -> u f (\_2191 _2192 _2193 _2194 _2195 _2196-> (u fm_name_read "self")); (15,f) -> u f (\_2197 _2198-> (u fm_name_read "self")); }))); (1,f) -> u f (\_2199-> _2199); })) in (let _2200 = (u (u (u parser_many fm_parser_case_with) _2158) _2159) in (case _2200 of {(0,f) -> u f (\_2201 _2202 _2203-> (u (u (u parser_reply_error _2201) _2202) _2203)); (1,f) -> u f (\_2204 _2205 _2206-> (let _2207 = (u (u (u fm_parser_text "{") _2204) _2205) in (case _2207 of {(0,f) -> u f (\_2208 _2209 _2210-> (u (u (u parser_reply_error _2208) _2209) _2210)); (1,f) -> u f (\_2211 _2212 _2213-> (let _2214 = (u (u (u (u parser_until (u fm_parser_text "}")) fm_parser_case_case) _2211) _2212) in (case _2214 of {(0,f) -> u f (\_2215 _2216 _2217-> (u (u (u parser_reply_error _2215) _2216) _2217)); (1,f) -> u f (\_2218 _2219 _2220-> (let _cses_28=(u map_from_list (u (u list_mapped _2220) (\_x_28-> (u (u pair_new (u fm_name_to_bits (u pair_fst _x_28))) (u pair_snd _x_28))))) in (let _2221 = (u (u (u parser_first_of (u (u list_cons (\_idx_29-> (\_code_30-> (let _2222 = (u (u (u fm_parser_text ":") _idx_29) _code_30) in (case _2222 of {(0,f) -> u f (\_2223 _2224 _2225-> (u (u (u parser_reply_error _2223) _2224) _2225)); (1,f) -> u f (\_2226 _2227 _2228-> (let _2229 = (u (u fm_parser_term _2226) _2227) in (case _2229 of {(0,f) -> u f (\_2230 _2231 _2232-> (u (u (u parser_reply_error _2230) _2231) _2232)); (1,f) -> u f (\_2233 _2234 _2235-> (u (u (u parser_reply_value _2233) _2234) (u maybe_some _2235))); }))); }))))) (u (u list_cons (\_idx_29-> (\_code_30-> (let _2236 = (u (u (u fm_parser_text "!") _idx_29) _code_30) in (case _2236 of {(0,f) -> u f (\_2237 _2238 _2239-> (u (u (u parser_reply_error _2237) _2238) _2239)); (1,f) -> u f (\_2240 _2241 _2242-> (u (u (u parser_reply_value _2240) _2241) maybe_none)); }))))) (u (u list_cons (\_idx_29-> (\_code_30-> (u (u (u parser_reply_value _idx_29) _code_30) (u maybe_some (u fm_term_hol bits_e)))))) list_nil)))) _2218) _2219) in (case _2221 of {(0,f) -> u f (\_2243 _2244 _2245-> (u (u (u parser_reply_error _2243) _2244) _2245)); (1,f) -> u f (\_2246 _2247 _2248-> (let _2249 = (u (u (u fm_parser_stop _2125) _2246) _2247) in (case _2249 of {(0,f) -> u f (\_2250 _2251 _2252-> (u (u (u parser_reply_error _2250) _2251) _2252)); (1,f) -> u f (\_2253 _2254 _2255-> (u (u (u parser_reply_value _2253) _2254) (u (u fm_term_ori _2255) (u (u (u (u (u (u fm_term_cse bits_e) _2146) _name_18) _2206) _cses_28) _2248)))); }))); })))); }))); }))); })))); }))); }))); }))); }))); }))))
fm_set = (\_name_2-> (\_val_3-> (\_map_4-> (u (u (u map_set (u fm_name_to_bits _name_2)) _val_3) _map_4))))
fm_parser_open = (\_idx_1-> (\_code_2-> (let _2256 = (u (u fm_parser_init _idx_1) _code_2) in (case _2256 of {(0,f) -> u f (\_2257 _2258 _2259-> (u (u (u parser_reply_error _2257) _2258) _2259)); (1,f) -> u f (\_2260 _2261 _2262-> (let _2263 = (u (u (u fm_parser_text "open ") _2260) _2261) in (case _2263 of {(0,f) -> u f (\_2264 _2265 _2266-> (u (u (u parser_reply_error _2264) _2265) _2266)); (1,f) -> u f (\_2267 _2268 _2269-> (let _2270 = (u (u fm_parser_spaces _2267) _2268) in (case _2270 of {(0,f) -> u f (\_2271 _2272 _2273-> (u (u (u parser_reply_error _2271) _2272) _2273)); (1,f) -> u f (\_2274 _2275 _2276-> (let _2277 = (u (u fm_parser_term _2274) _2275) in (case _2277 of {(0,f) -> u f (\_2278 _2279 _2280-> (u (u (u parser_reply_error _2278) _2279) _2280)); (1,f) -> u f (\_2281 _2282 _2283-> (let _2284 = (u (u (u parser_maybe (\_idx_15-> (\_code_16-> (let _2285 = (u (u (u fm_parser_text "as") _idx_15) _code_16) in (case _2285 of {(0,f) -> u f (\_2286 _2287 _2288-> (u (u (u parser_reply_error _2286) _2287) _2288)); (1,f) -> u f (\_2289 _2290 _2291-> (u (u fm_parser_name1 _2289) _2290)); }))))) _2281) _2282) in (case _2284 of {(0,f) -> u f (\_2292 _2293 _2294-> (u (u (u parser_reply_error _2292) _2293) _2294)); (1,f) -> u f (\_2295 _2296 _2297-> (let _2298 = (u (u (u parser_maybe (u fm_parser_text ";")) _2295) _2296) in (case _2298 of {(0,f) -> u f (\_2299 _2300 _2301-> (u (u (u parser_reply_error _2299) _2300) _2301)); (1,f) -> u f (\_2302 _2303 _2304-> (let _name_21=(let _2305 = _2297 in (case _2305 of {(0,f) -> u f ((let _2306 = (u (u fm_term_reduce _2283) map_new) in (case _2306 of {(0,f) -> u f (\_2307 _2308-> _2307); (1,f) -> u f (\_2309-> _2309); (2,f) -> u f ((u fm_name_read "self")); (3,f) -> u f (\_2310 _2311 _2312 _2313 _2314-> (u fm_name_read "self")); (4,f) -> u f (\_2315 _2316-> (u fm_name_read "self")); (5,f) -> u f (\_2317 _2318-> (u fm_name_read "self")); (6,f) -> u f (\_2319 _2320 _2321-> (u fm_name_read "self")); (7,f) -> u f (\_2322 _2323 _2324-> (u fm_name_read "self")); (8,f) -> u f (\_2325 _2326 _2327-> (u fm_name_read "self")); (9,f) -> u f (\_2328 _2329 _2330-> (u fm_name_read "self")); (10,f) -> u f (\_2331-> (u fm_name_read "self")); (11,f) -> u f (\_2332-> (u fm_name_read "self")); (12,f) -> u f (\_2333-> (u fm_name_read "self")); (13,f) -> u f (\_2334-> (u fm_name_read "self")); (14,f) -> u f (\_2335 _2336 _2337 _2338 _2339 _2340-> (u fm_name_read "self")); (15,f) -> u f (\_2341 _2342-> (u fm_name_read "self")); }))); (1,f) -> u f (\_2343-> _2343); })) in (let _wyth_22=list_nil in (let _2344 = (u (u fm_parser_term _2302) _2303) in (case _2344 of {(0,f) -> u f (\_2345 _2346 _2347-> (u (u (u parser_reply_error _2345) _2346) _2347)); (1,f) -> u f (\_2348 _2349 _2350-> (let _cses_26=(u (u (u fm_set "_") _2350) map_new) in (let _moti_27=(u maybe_some (u fm_term_hol bits_e)) in (let _2351 = (u (u (u fm_parser_stop _2262) _2348) _2349) in (case _2351 of {(0,f) -> u f (\_2352 _2353 _2354-> (u (u (u parser_reply_error _2352) _2353) _2354)); (1,f) -> u f (\_2355 _2356 _2357-> (u (u (u parser_reply_value _2355) _2356) (u (u fm_term_ori _2357) (u (u (u (u (u (u fm_term_cse bits_e) _2283) _name_21) _wyth_22) _cses_26) _moti_27)))); }))))); }))))); }))); }))); }))); }))); }))); }))))
parser_digit = (\_idx_1-> (\_code_2-> (let _2358 = _code_2 in (if null (_2358::String) then (u (u (u parser_reply_error _idx_1) _code_2) "Not a digit.") else (let _sidx_5=(u nat_succ _idx_1) in (let _2359 = ((((fromIntegral (fromEnum (head _2358 :: Char)) :: Word16)::Word16) == 48)) in (if _2359 then (u (u (u parser_reply_value _sidx_5) (tail _2358)) 0) else (let _2360 = ((((fromIntegral (fromEnum (head _2358 :: Char)) :: Word16)::Word16) == 49)) in (if _2360 then (u (u (u parser_reply_value _sidx_5) (tail _2358)) 1) else (let _2361 = ((((fromIntegral (fromEnum (head _2358 :: Char)) :: Word16)::Word16) == 50)) in (if _2361 then (u (u (u parser_reply_value _sidx_5) (tail _2358)) 2) else (let _2362 = ((((fromIntegral (fromEnum (head _2358 :: Char)) :: Word16)::Word16) == 51)) in (if _2362 then (u (u (u parser_reply_value _sidx_5) (tail _2358)) 3) else (let _2363 = ((((fromIntegral (fromEnum (head _2358 :: Char)) :: Word16)::Word16) == 52)) in (if _2363 then (u (u (u parser_reply_value _sidx_5) (tail _2358)) 4) else (let _2364 = ((((fromIntegral (fromEnum (head _2358 :: Char)) :: Word16)::Word16) == 53)) in (if _2364 then (u (u (u parser_reply_value _sidx_5) (tail _2358)) 5) else (let _2365 = ((((fromIntegral (fromEnum (head _2358 :: Char)) :: Word16)::Word16) == 54)) in (if _2365 then (u (u (u parser_reply_value _sidx_5) (tail _2358)) 6) else (let _2366 = ((((fromIntegral (fromEnum (head _2358 :: Char)) :: Word16)::Word16) == 55)) in (if _2366 then (u (u (u parser_reply_value _sidx_5) (tail _2358)) 7) else (let _2367 = ((((fromIntegral (fromEnum (head _2358 :: Char)) :: Word16)::Word16) == 56)) in (if _2367 then (u (u (u parser_reply_value _sidx_5) (tail _2358)) 8) else (let _2368 = ((((fromIntegral (fromEnum (head _2358 :: Char)) :: Word16)::Word16) == 57)) in (if _2368 then (u (u (u parser_reply_value _sidx_5) (tail _2358)) 9) else (u (u (u parser_reply_error _idx_1) _code_2) "Not a digit."))))))))))))))))))))))))))
nat_add = (\a0-> \a1-> ((a0::Integer) + a1))
nat_mul = (\a0-> \a1-> ((a0::Integer) * a1))
nat_from_base_go = (\_b_1-> (\_ds_2-> (\_p_3-> (\_res_4-> (let _2369 = _ds_2 in (case _2369 of {(0,f) -> u f (_res_4); (1,f) -> u f (\_2370 _2371-> (u (u (u (u nat_from_base_go _b_1) _2371) (((_b_1::Integer) * _p_3))) ((((((_2370::Integer) * _p_3))::Integer) + _res_4)))); }))))))
list_reverse_go = (\_xs_2-> (\_res_3-> (let _2372 = _xs_2 in (case _2372 of {(0,f) -> u f (_res_3); (1,f) -> u f (\_2373 _2374-> (u (u list_reverse_go _2374) (u (u list_cons _2373) _res_3))); }))))
list_reverse = (\_xs_2-> (u (u list_reverse_go _xs_2) list_nil))
nat_from_base = (\_base_1-> (\_ds_2-> (u (u (u (u nat_from_base_go _base_1) (u list_reverse _ds_2)) 1) 0)))
parser_nat = (\_idx_1-> (\_code_2-> (let _2375 = (u (u (u parser_many1 parser_digit) _idx_1) _code_2) in (case _2375 of {(0,f) -> u f (\_2376 _2377 _2378-> (u (u (u parser_reply_error _2376) _2377) _2378)); (1,f) -> u f (\_2379 _2380 _2381-> (u (u (u parser_reply_value _2379) _2380) (u (u nat_from_base 10) _2381))); }))))
bits_tail = (\_a_1-> (let _2382 = _a_1 in (case _2382 of {(0,f) -> u f (bits_e); (1,f) -> u f (\_2383-> _2383); (2,f) -> u f (\_2384-> _2384); })))
bits_inc = (\_a_1-> (let _2385 = _a_1 in (case _2385 of {(0,f) -> u f ((u bits_i bits_e)); (1,f) -> u f (\_2386-> (u bits_i _2386)); (2,f) -> u f (\_2387-> (u bits_o (u bits_inc _2387))); })))
nat_to_bits = (\_n_1-> (let _2388 = _n_1 in (if _2388==0 then bits_e else (u bits_inc (u nat_to_bits (_2388-1))))))
maybe_to_bool = (\_m_2-> (let _2389 = _m_2 in (case _2389 of {(0,f) -> u f (bool_false); (1,f) -> u f (\_2390-> bool_true); })))
fm_term_gol = (\_name_1-> (\_dref_2-> (\_verb_3-> (9,\t-> t _name_1 _dref_2 _verb_3))))
fm_parser_goal = (\_idx_1-> (\_code_2-> (let _2391 = (u (u fm_parser_init _idx_1) _code_2) in (case _2391 of {(0,f) -> u f (\_2392 _2393 _2394-> (u (u (u parser_reply_error _2392) _2393) _2394)); (1,f) -> u f (\_2395 _2396 _2397-> (let _2398 = (u (u (u fm_parser_text "?") _2395) _2396) in (case _2398 of {(0,f) -> u f (\_2399 _2400 _2401-> (u (u (u parser_reply_error _2399) _2400) _2401)); (1,f) -> u f (\_2402 _2403 _2404-> (let _2405 = (u (u fm_parser_name _2402) _2403) in (case _2405 of {(0,f) -> u f (\_2406 _2407 _2408-> (u (u (u parser_reply_error _2406) _2407) _2408)); (1,f) -> u f (\_2409 _2410 _2411-> (let _2412 = (u (u (u parser_many (\_idx_12-> (\_code_13-> (let _2413 = (u (u (u fm_parser_text "-") _idx_12) _code_13) in (case _2413 of {(0,f) -> u f (\_2414 _2415 _2416-> (u (u (u parser_reply_error _2414) _2415) _2416)); (1,f) -> u f (\_2417 _2418 _2419-> (let _2420 = (u (u parser_nat _2417) _2418) in (case _2420 of {(0,f) -> u f (\_2421 _2422 _2423-> (u (u (u parser_reply_error _2421) _2422) _2423)); (1,f) -> u f (\_2424 _2425 _2426-> (let _bits_20=(u bits_reverse (u bits_tail (u bits_reverse (u nat_to_bits _2426)))) in (u (u (u parser_reply_value _2424) _2425) _bits_20))); }))); }))))) _2409) _2410) in (case _2412 of {(0,f) -> u f (\_2427 _2428 _2429-> (u (u (u parser_reply_error _2427) _2428) _2429)); (1,f) -> u f (\_2430 _2431 _2432-> (let _2433 = (let _2434 = (u (u (u parser_maybe (u parser_text "-")) _2430) _2431) in (case _2434 of {(0,f) -> u f (\_2435 _2436 _2437-> (u (u (u parser_reply_error _2435) _2436) _2437)); (1,f) -> u f (\_2438 _2439 _2440-> (u (u (u parser_reply_value _2438) _2439) (u maybe_to_bool _2440))); })) in (case _2433 of {(0,f) -> u f (\_2441 _2442 _2443-> (u (u (u parser_reply_error _2441) _2442) _2443)); (1,f) -> u f (\_2444 _2445 _2446-> (let _2447 = (u (u (u fm_parser_stop _2397) _2444) _2445) in (case _2447 of {(0,f) -> u f (\_2448 _2449 _2450-> (u (u (u parser_reply_error _2448) _2449) _2450)); (1,f) -> u f (\_2451 _2452 _2453-> (u (u (u parser_reply_value _2451) _2452) (u (u fm_term_ori _2453) (u (u (u fm_term_gol _2411) _2432) _2446)))); }))); }))); }))); }))); }))); }))))
fm_parser_hole = (\_idx_1-> (\_code_2-> (let _2454 = (u (u fm_parser_init _idx_1) _code_2) in (case _2454 of {(0,f) -> u f (\_2455 _2456 _2457-> (u (u (u parser_reply_error _2455) _2456) _2457)); (1,f) -> u f (\_2458 _2459 _2460-> (let _2461 = (u (u (u fm_parser_text "_") _2458) _2459) in (case _2461 of {(0,f) -> u f (\_2462 _2463 _2464-> (u (u (u parser_reply_error _2462) _2463) _2464)); (1,f) -> u f (\_2465 _2466 _2467-> (let _2468 = (u (u (u fm_parser_stop _2460) _2465) _2466) in (case _2468 of {(0,f) -> u f (\_2469 _2470 _2471-> (u (u (u parser_reply_error _2469) _2470) _2471)); (1,f) -> u f (\_2472 _2473 _2474-> (u (u (u parser_reply_value _2472) _2473) (u (u fm_term_ori _2474) (u fm_term_hol bits_e)))); }))); }))); }))))
fm_parser_u8 = (\_idx_1-> (\_code_2-> (let _2475 = (u (u fm_parser_init _idx_1) _code_2) in (case _2475 of {(0,f) -> u f (\_2476 _2477 _2478-> (u (u (u parser_reply_error _2476) _2477) _2478)); (1,f) -> u f (\_2479 _2480 _2481-> (let _2482 = (u (u fm_parser_spaces _2479) _2480) in (case _2482 of {(0,f) -> u f (\_2483 _2484 _2485-> (u (u (u parser_reply_error _2483) _2484) _2485)); (1,f) -> u f (\_2486 _2487 _2488-> (let _2489 = (u (u parser_nat _2486) _2487) in (case _2489 of {(0,f) -> u f (\_2490 _2491 _2492-> (u (u (u parser_reply_error _2490) _2491) _2492)); (1,f) -> u f (\_2493 _2494 _2495-> (let _2496 = (u (u (u parser_text "b") _2493) _2494) in (case _2496 of {(0,f) -> u f (\_2497 _2498 _2499-> (u (u (u parser_reply_error _2497) _2498) _2499)); (1,f) -> u f (\_2500 _2501 _2502-> (let _term_15=(u fm_term_ref "Nat.to_u8") in (let _term_16=(u (u fm_term_app _term_15) (u fm_term_nat _2495)) in (let _2503 = (u (u (u fm_parser_stop _2481) _2500) _2501) in (case _2503 of {(0,f) -> u f (\_2504 _2505 _2506-> (u (u (u parser_reply_error _2504) _2505) _2506)); (1,f) -> u f (\_2507 _2508 _2509-> (u (u (u parser_reply_value _2507) _2508) (u (u fm_term_ori _2509) _term_16))); }))))); }))); }))); }))); }))))
fm_parser_u16 = (\_idx_1-> (\_code_2-> (let _2510 = (u (u fm_parser_init _idx_1) _code_2) in (case _2510 of {(0,f) -> u f (\_2511 _2512 _2513-> (u (u (u parser_reply_error _2511) _2512) _2513)); (1,f) -> u f (\_2514 _2515 _2516-> (let _2517 = (u (u fm_parser_spaces _2514) _2515) in (case _2517 of {(0,f) -> u f (\_2518 _2519 _2520-> (u (u (u parser_reply_error _2518) _2519) _2520)); (1,f) -> u f (\_2521 _2522 _2523-> (let _2524 = (u (u parser_nat _2521) _2522) in (case _2524 of {(0,f) -> u f (\_2525 _2526 _2527-> (u (u (u parser_reply_error _2525) _2526) _2527)); (1,f) -> u f (\_2528 _2529 _2530-> (let _2531 = (u (u (u parser_text "s") _2528) _2529) in (case _2531 of {(0,f) -> u f (\_2532 _2533 _2534-> (u (u (u parser_reply_error _2532) _2533) _2534)); (1,f) -> u f (\_2535 _2536 _2537-> (let _term_15=(u fm_term_ref "Nat.to_u16") in (let _term_16=(u (u fm_term_app _term_15) (u fm_term_nat _2530)) in (let _2538 = (u (u (u fm_parser_stop _2516) _2535) _2536) in (case _2538 of {(0,f) -> u f (\_2539 _2540 _2541-> (u (u (u parser_reply_error _2539) _2540) _2541)); (1,f) -> u f (\_2542 _2543 _2544-> (u (u (u parser_reply_value _2542) _2543) (u (u fm_term_ori _2544) _term_16))); }))))); }))); }))); }))); }))))
fm_parser_u32 = (\_idx_1-> (\_code_2-> (let _2545 = (u (u fm_parser_init _idx_1) _code_2) in (case _2545 of {(0,f) -> u f (\_2546 _2547 _2548-> (u (u (u parser_reply_error _2546) _2547) _2548)); (1,f) -> u f (\_2549 _2550 _2551-> (let _2552 = (u (u fm_parser_spaces _2549) _2550) in (case _2552 of {(0,f) -> u f (\_2553 _2554 _2555-> (u (u (u parser_reply_error _2553) _2554) _2555)); (1,f) -> u f (\_2556 _2557 _2558-> (let _2559 = (u (u parser_nat _2556) _2557) in (case _2559 of {(0,f) -> u f (\_2560 _2561 _2562-> (u (u (u parser_reply_error _2560) _2561) _2562)); (1,f) -> u f (\_2563 _2564 _2565-> (let _2566 = (u (u (u parser_text "u") _2563) _2564) in (case _2566 of {(0,f) -> u f (\_2567 _2568 _2569-> (u (u (u parser_reply_error _2567) _2568) _2569)); (1,f) -> u f (\_2570 _2571 _2572-> (let _term_15=(u fm_term_ref "Nat.to_u32") in (let _term_16=(u (u fm_term_app _term_15) (u fm_term_nat _2565)) in (let _2573 = (u (u (u fm_parser_stop _2551) _2570) _2571) in (case _2573 of {(0,f) -> u f (\_2574 _2575 _2576-> (u (u (u parser_reply_error _2574) _2575) _2576)); (1,f) -> u f (\_2577 _2578 _2579-> (u (u (u parser_reply_value _2577) _2578) (u (u fm_term_ori _2579) _term_16))); }))))); }))); }))); }))); }))))
fm_parser_u64 = (\_idx_1-> (\_code_2-> (let _2580 = (u (u fm_parser_init _idx_1) _code_2) in (case _2580 of {(0,f) -> u f (\_2581 _2582 _2583-> (u (u (u parser_reply_error _2581) _2582) _2583)); (1,f) -> u f (\_2584 _2585 _2586-> (let _2587 = (u (u fm_parser_spaces _2584) _2585) in (case _2587 of {(0,f) -> u f (\_2588 _2589 _2590-> (u (u (u parser_reply_error _2588) _2589) _2590)); (1,f) -> u f (\_2591 _2592 _2593-> (let _2594 = (u (u parser_nat _2591) _2592) in (case _2594 of {(0,f) -> u f (\_2595 _2596 _2597-> (u (u (u parser_reply_error _2595) _2596) _2597)); (1,f) -> u f (\_2598 _2599 _2600-> (let _2601 = (u (u (u parser_text "l") _2598) _2599) in (case _2601 of {(0,f) -> u f (\_2602 _2603 _2604-> (u (u (u parser_reply_error _2602) _2603) _2604)); (1,f) -> u f (\_2605 _2606 _2607-> (let _term_15=(u fm_term_ref "Nat.to_u64") in (let _term_16=(u (u fm_term_app _term_15) (u fm_term_nat _2600)) in (let _2608 = (u (u (u fm_parser_stop _2586) _2605) _2606) in (case _2608 of {(0,f) -> u f (\_2609 _2610 _2611-> (u (u (u parser_reply_error _2609) _2610) _2611)); (1,f) -> u f (\_2612 _2613 _2614-> (u (u (u parser_reply_value _2612) _2613) (u (u fm_term_ori _2614) _term_16))); }))))); }))); }))); }))); }))))
fm_parser_nat = (\_idx_1-> (\_code_2-> (let _2615 = (u (u fm_parser_init _idx_1) _code_2) in (case _2615 of {(0,f) -> u f (\_2616 _2617 _2618-> (u (u (u parser_reply_error _2616) _2617) _2618)); (1,f) -> u f (\_2619 _2620 _2621-> (let _2622 = (u (u fm_parser_spaces _2619) _2620) in (case _2622 of {(0,f) -> u f (\_2623 _2624 _2625-> (u (u (u parser_reply_error _2623) _2624) _2625)); (1,f) -> u f (\_2626 _2627 _2628-> (let _2629 = (u (u parser_nat _2626) _2627) in (case _2629 of {(0,f) -> u f (\_2630 _2631 _2632-> (u (u (u parser_reply_error _2630) _2631) _2632)); (1,f) -> u f (\_2633 _2634 _2635-> (let _2636 = (u (u (u fm_parser_stop _2621) _2633) _2634) in (case _2636 of {(0,f) -> u f (\_2637 _2638 _2639-> (u (u (u parser_reply_error _2637) _2638) _2639)); (1,f) -> u f (\_2640 _2641 _2642-> (u (u (u parser_reply_value _2640) _2641) (u (u fm_term_ori _2642) (u fm_term_nat _2635)))); }))); }))); }))); }))))
string_eql = (\a0-> \a1-> ((a0::String) == a1))
parser_fail = (\_error_2-> (\_idx_3-> (\_code_4-> (u (u (u parser_reply_error _idx_3) _code_4) _error_2))))
fm_parser_reference = (\_idx_1-> (\_code_2-> (let _2643 = (u (u fm_parser_init _idx_1) _code_2) in (case _2643 of {(0,f) -> u f (\_2644 _2645 _2646-> (u (u (u parser_reply_error _2644) _2645) _2646)); (1,f) -> u f (\_2647 _2648 _2649-> (let _2650 = (u (u fm_parser_name1 _2647) _2648) in (case _2650 of {(0,f) -> u f (\_2651 _2652 _2653-> (u (u (u parser_reply_error _2651) _2652) _2653)); (1,f) -> u f (\_2654 _2655 _2656-> (let _2657 = (((_2656::String) == "case")) in (if _2657 then (u parser_fail "Reserved keyword.") else (let _2658 = (((_2656::String) == "do")) in (if _2658 then (u parser_fail "Reserved keyword.") else (let _2659 = (((_2656::String) == "if")) in (if _2659 then (u parser_fail "Reserved keyword.") else (let _2660 = (((_2656::String) == "with")) in (if _2660 then (u parser_fail "Reserved keyword.") else (let _2661 = (((_2656::String) == "let")) in (if _2661 then (u parser_fail "Reserved keyword.") else (let _2662 = (((_2656::String) == "def")) in (if _2662 then (u parser_fail "Reserved keyword.") else (let _2663 = (((_2656::String) == "true")) in (if _2663 then (\_idx_9-> (\_code_10-> (u (u (u parser_reply_value _idx_9) _code_10) (u fm_term_ref "Bool.true")))) else (let _2664 = (((_2656::String) == "false")) in (if _2664 then (\_idx_9-> (\_code_10-> (u (u (u parser_reply_value _idx_9) _code_10) (u fm_term_ref "Bool.false")))) else (let _2665 = (((_2656::String) == "unit")) in (if _2665 then (\_idx_9-> (\_code_10-> (u (u (u parser_reply_value _idx_9) _code_10) (u fm_term_ref "Unit.new")))) else (let _2666 = (((_2656::String) == "none")) in (if _2666 then (let _term_9=(u fm_term_ref "Maybe.none") in (let _term_10=(u (u fm_term_app _term_9) (u fm_term_hol bits_e)) in (\_idx_11-> (\_code_12-> (u (u (u parser_reply_value _idx_11) _code_12) _term_10))))) else (let _2667 = (((_2656::String) == "refl")) in (if _2667 then (let _term_9=(u fm_term_ref "Equal.refl") in (let _term_10=(u (u fm_term_app _term_9) (u fm_term_hol bits_e)) in (let _term_11=(u (u fm_term_app _term_10) (u fm_term_hol bits_e)) in (\_idx_12-> (\_code_13-> (u (u (u parser_reply_value _idx_12) _code_13) _term_11)))))) else (\_idx_9-> (\_code_10-> (let _2668 = (u (u (u fm_parser_stop _2649) _idx_9) _code_10) in (case _2668 of {(0,f) -> u f (\_2669 _2670 _2671-> (u (u (u parser_reply_error _2669) _2670) _2671)); (1,f) -> u f (\_2672 _2673 _2674-> (u (u (u parser_reply_value _2672) _2673) (u (u fm_term_ori _2674) (u fm_term_ref _2656)))); })))))))))))))))))))))))))) _2654 _2655); }))); }))))
list_for = (\_xs_2-> (\_b_4-> (\_f_5-> (let _2675 = _xs_2 in (case _2675 of {(0,f) -> u f (_b_4); (1,f) -> u f (\_2676 _2677-> (u (u (u list_for _2677) (u (u _f_5 _2676) _b_4)) _f_5)); })))))
fm_parser_application = (\_init_1-> (\_func_2-> (\_idx_3-> (\_code_4-> (let _2678 = (u (u (u parser_text "(") _idx_3) _code_4) in (case _2678 of {(0,f) -> u f (\_2679 _2680 _2681-> (u (u (u parser_reply_error _2679) _2680) _2681)); (1,f) -> u f (\_2682 _2683 _2684-> (let _2685 = (u (u (u (u parser_until1 (u fm_parser_text ")")) (u fm_parser_item fm_parser_term)) _2682) _2683) in (case _2685 of {(0,f) -> u f (\_2686 _2687 _2688-> (u (u (u parser_reply_error _2686) _2687) _2688)); (1,f) -> u f (\_2689 _2690 _2691-> (let _2692 = (u (u (u fm_parser_stop _init_1) _2689) _2690) in (case _2692 of {(0,f) -> u f (\_2693 _2694 _2695-> (u (u (u parser_reply_error _2693) _2694) _2695)); (1,f) -> u f (\_2696 _2697 _2698-> (let _expr_14=(u (u (u list_for _2691) _func_2) (\_x_14-> (\_f_15-> (u (u fm_term_app _f_15) _x_14)))) in (u (u (u parser_reply_value _2696) _2697) (u (u fm_term_ori _2698) _expr_14)))); }))); }))); }))))))
parser_spaces = (u parser_many (u parser_first_of (u (u list_cons (u parser_text " ")) (u (u list_cons (u parser_text "\n")) list_nil))))
parser_spaces_text = (\_text_1-> (\_idx_2-> (\_code_3-> (let _2699 = (u (u parser_spaces _idx_2) _code_3) in (case _2699 of {(0,f) -> u f (\_2700 _2701 _2702-> (u (u (u parser_reply_error _2700) _2701) _2702)); (1,f) -> u f (\_2703 _2704 _2705-> (u (u (u parser_text _text_1) _2703) _2704)); })))))
fm_parser_application_erased = (\_init_1-> (\_func_2-> (\_idx_3-> (\_code_4-> (let _2706 = (u (u parser_get_index _idx_3) _code_4) in (case _2706 of {(0,f) -> u f (\_2707 _2708 _2709-> (u (u (u parser_reply_error _2707) _2708) _2709)); (1,f) -> u f (\_2710 _2711 _2712-> (let _2713 = (u (u (u parser_text "<") _2710) _2711) in (case _2713 of {(0,f) -> u f (\_2714 _2715 _2716-> (u (u (u parser_reply_error _2714) _2715) _2716)); (1,f) -> u f (\_2717 _2718 _2719-> (let _2720 = (u (u (u (u parser_until1 (u parser_spaces_text ">")) (u fm_parser_item fm_parser_term)) _2717) _2718) in (case _2720 of {(0,f) -> u f (\_2721 _2722 _2723-> (u (u (u parser_reply_error _2721) _2722) _2723)); (1,f) -> u f (\_2724 _2725 _2726-> (let _2727 = (u (u (u fm_parser_stop _2712) _2724) _2725) in (case _2727 of {(0,f) -> u f (\_2728 _2729 _2730-> (u (u (u parser_reply_error _2728) _2729) _2730)); (1,f) -> u f (\_2731 _2732 _2733-> (let _expr_17=(u (u (u list_for _2726) _func_2) (\_x_17-> (\_f_18-> (u (u fm_term_app _f_18) _x_17)))) in (u (u (u parser_reply_value _2731) _2732) (u (u fm_term_ori _2733) _expr_17)))); }))); }))); }))); }))))))
fm_parser_arrow = (\_init_1-> (\_xtyp_2-> (\_idx_3-> (\_code_4-> (let _2734 = (u (u (u fm_parser_text "->") _idx_3) _code_4) in (case _2734 of {(0,f) -> u f (\_2735 _2736 _2737-> (u (u (u parser_reply_error _2735) _2736) _2737)); (1,f) -> u f (\_2738 _2739 _2740-> (let _2741 = (u (u fm_parser_term _2738) _2739) in (case _2741 of {(0,f) -> u f (\_2742 _2743 _2744-> (u (u (u parser_reply_error _2742) _2743) _2744)); (1,f) -> u f (\_2745 _2746 _2747-> (let _2748 = (u (u (u fm_parser_stop _init_1) _2745) _2746) in (case _2748 of {(0,f) -> u f (\_2749 _2750 _2751-> (u (u (u parser_reply_error _2749) _2750) _2751)); (1,f) -> u f (\_2752 _2753 _2754-> (u (u (u parser_reply_value _2752) _2753) (u (u fm_term_ori _2754) (u (u (u (u (u fm_term_all bool_false) "") "") _xtyp_2) (\_s_14-> (\_x_15-> _2747)))))); }))); }))); }))))))
fm_parser_op = (\_sym_1-> (\_ref_2-> (\_init_3-> (\_val0_4-> (\_idx_5-> (\_code_6-> (let _2755 = (u (u (u fm_parser_text _sym_1) _idx_5) _code_6) in (case _2755 of {(0,f) -> u f (\_2756 _2757 _2758-> (u (u (u parser_reply_error _2756) _2757) _2758)); (1,f) -> u f (\_2759 _2760 _2761-> (let _2762 = (u (u fm_parser_term _2759) _2760) in (case _2762 of {(0,f) -> u f (\_2763 _2764 _2765-> (u (u (u parser_reply_error _2763) _2764) _2765)); (1,f) -> u f (\_2766 _2767 _2768-> (let _2769 = (u (u (u fm_parser_stop _init_3) _2766) _2767) in (case _2769 of {(0,f) -> u f (\_2770 _2771 _2772-> (u (u (u parser_reply_error _2770) _2771) _2772)); (1,f) -> u f (\_2773 _2774 _2775-> (let _term_16=(u fm_term_ref _ref_2) in (let _term_17=(u (u fm_term_app _term_16) _val0_4) in (let _term_18=(u (u fm_term_app _term_17) _2768) in (u (u (u parser_reply_value _2773) _2774) (u (u fm_term_ori _2775) _term_18)))))); }))); }))); }))))))))
fm_parser_add = (u (u fm_parser_op "+") "Nat.add")
fm_parser_sub = (u (u fm_parser_op "+") "Nat.add")
fm_parser_mul = (u (u fm_parser_op "*") "Nat.mul")
fm_parser_div = (u (u fm_parser_op "/") "Nat.div")
fm_parser_mod = (u (u fm_parser_op "%") "Nat.mod")
fm_parser_cons = (\_init_1-> (\_head_2-> (\_idx_3-> (\_code_4-> (let _2776 = (u (u (u fm_parser_text "&") _idx_3) _code_4) in (case _2776 of {(0,f) -> u f (\_2777 _2778 _2779-> (u (u (u parser_reply_error _2777) _2778) _2779)); (1,f) -> u f (\_2780 _2781 _2782-> (let _2783 = (u (u fm_parser_term _2780) _2781) in (case _2783 of {(0,f) -> u f (\_2784 _2785 _2786-> (u (u (u parser_reply_error _2784) _2785) _2786)); (1,f) -> u f (\_2787 _2788 _2789-> (let _2790 = (u (u (u fm_parser_stop _init_1) _2787) _2788) in (case _2790 of {(0,f) -> u f (\_2791 _2792 _2793-> (u (u (u parser_reply_error _2791) _2792) _2793)); (1,f) -> u f (\_2794 _2795 _2796-> (let _term_14=(u fm_term_ref "List.cons") in (let _term_15=(u (u fm_term_app _term_14) (u fm_term_hol bits_e)) in (let _term_16=(u (u fm_term_app _term_15) _head_2) in (let _term_17=(u (u fm_term_app _term_16) _2789) in (let _2797 = (u (u (u fm_parser_stop _init_1) _2794) _2795) in (case _2797 of {(0,f) -> u f (\_2798 _2799 _2800-> (u (u (u parser_reply_error _2798) _2799) _2800)); (1,f) -> u f (\_2801 _2802 _2803-> (u (u (u parser_reply_value _2801) _2802) (u (u fm_term_ori _2803) _term_17))); }))))))); }))); }))); }))))))
fm_parser_concat = (\_init_1-> (\_lst0_2-> (\_idx_3-> (\_code_4-> (let _2804 = (u (u (u fm_parser_text "++") _idx_3) _code_4) in (case _2804 of {(0,f) -> u f (\_2805 _2806 _2807-> (u (u (u parser_reply_error _2805) _2806) _2807)); (1,f) -> u f (\_2808 _2809 _2810-> (let _2811 = (u (u fm_parser_term _2808) _2809) in (case _2811 of {(0,f) -> u f (\_2812 _2813 _2814-> (u (u (u parser_reply_error _2812) _2813) _2814)); (1,f) -> u f (\_2815 _2816 _2817-> (let _2818 = (u (u (u fm_parser_stop _init_1) _2815) _2816) in (case _2818 of {(0,f) -> u f (\_2819 _2820 _2821-> (u (u (u parser_reply_error _2819) _2820) _2821)); (1,f) -> u f (\_2822 _2823 _2824-> (let _term_14=(u fm_term_ref "List.concat") in (let _term_15=(u (u fm_term_app _term_14) (u fm_term_hol bits_e)) in (let _term_16=(u (u fm_term_app _term_15) _lst0_2) in (let _term_17=(u (u fm_term_app _term_16) _2817) in (let _2825 = (u (u (u fm_parser_stop _init_1) _2822) _2823) in (case _2825 of {(0,f) -> u f (\_2826 _2827 _2828-> (u (u (u parser_reply_error _2826) _2827) _2828)); (1,f) -> u f (\_2829 _2830 _2831-> (u (u (u parser_reply_value _2829) _2830) (u (u fm_term_ori _2831) _term_17))); }))))))); }))); }))); }))))))
fm_parser_string_concat = (\_init_1-> (\_str0_2-> (\_idx_3-> (\_code_4-> (let _2832 = (u (u (u fm_parser_text "|") _idx_3) _code_4) in (case _2832 of {(0,f) -> u f (\_2833 _2834 _2835-> (u (u (u parser_reply_error _2833) _2834) _2835)); (1,f) -> u f (\_2836 _2837 _2838-> (let _2839 = (u (u fm_parser_term _2836) _2837) in (case _2839 of {(0,f) -> u f (\_2840 _2841 _2842-> (u (u (u parser_reply_error _2840) _2841) _2842)); (1,f) -> u f (\_2843 _2844 _2845-> (let _2846 = (u (u (u fm_parser_stop _init_1) _2843) _2844) in (case _2846 of {(0,f) -> u f (\_2847 _2848 _2849-> (u (u (u parser_reply_error _2847) _2848) _2849)); (1,f) -> u f (\_2850 _2851 _2852-> (let _term_14=(u fm_term_ref "String.concat") in (let _term_15=(u (u fm_term_app _term_14) _str0_2) in (let _term_16=(u (u fm_term_app _term_15) _2845) in (let _2853 = (u (u (u fm_parser_stop _init_1) _2850) _2851) in (case _2853 of {(0,f) -> u f (\_2854 _2855 _2856-> (u (u (u parser_reply_error _2854) _2855) _2856)); (1,f) -> u f (\_2857 _2858 _2859-> (u (u (u parser_reply_value _2857) _2858) (u (u fm_term_ori _2859) _term_16))); })))))); }))); }))); }))))))
fm_parser_sigma = (\_init_1-> (\_val0_2-> (\_idx_3-> (\_code_4-> (let _2860 = (u (u (u fm_parser_text "~") _idx_3) _code_4) in (case _2860 of {(0,f) -> u f (\_2861 _2862 _2863-> (u (u (u parser_reply_error _2861) _2862) _2863)); (1,f) -> u f (\_2864 _2865 _2866-> (let _2867 = (u (u fm_parser_term _2864) _2865) in (case _2867 of {(0,f) -> u f (\_2868 _2869 _2870-> (u (u (u parser_reply_error _2868) _2869) _2870)); (1,f) -> u f (\_2871 _2872 _2873-> (let _2874 = (u (u (u fm_parser_stop _init_1) _2871) _2872) in (case _2874 of {(0,f) -> u f (\_2875 _2876 _2877-> (u (u (u parser_reply_error _2875) _2876) _2877)); (1,f) -> u f (\_2878 _2879 _2880-> (let _term_14=(u fm_term_ref "Sigma.new") in (let _term_15=(u (u fm_term_app _term_14) (u fm_term_hol bits_e)) in (let _term_16=(u (u fm_term_app _term_15) (u fm_term_hol bits_e)) in (let _term_17=(u (u fm_term_app _term_16) _val0_2) in (let _term_18=(u (u fm_term_app _term_17) _2873) in (u (u (u parser_reply_value _2878) _2879) (u (u fm_term_ori _2880) _term_18)))))))); }))); }))); }))))))
fm_parser_equality = (\_init_1-> (\_val0_2-> (\_idx_3-> (\_code_4-> (let _2881 = (u (u (u fm_parser_text "==") _idx_3) _code_4) in (case _2881 of {(0,f) -> u f (\_2882 _2883 _2884-> (u (u (u parser_reply_error _2882) _2883) _2884)); (1,f) -> u f (\_2885 _2886 _2887-> (let _2888 = (u (u fm_parser_term _2885) _2886) in (case _2888 of {(0,f) -> u f (\_2889 _2890 _2891-> (u (u (u parser_reply_error _2889) _2890) _2891)); (1,f) -> u f (\_2892 _2893 _2894-> (let _2895 = (u (u (u fm_parser_stop _init_1) _2892) _2893) in (case _2895 of {(0,f) -> u f (\_2896 _2897 _2898-> (u (u (u parser_reply_error _2896) _2897) _2898)); (1,f) -> u f (\_2899 _2900 _2901-> (let _term_14=(u fm_term_ref "Equal") in (let _term_15=(u (u fm_term_app _term_14) (u fm_term_hol bits_e)) in (let _term_16=(u (u fm_term_app _term_15) _val0_2) in (let _term_17=(u (u fm_term_app _term_16) _2894) in (u (u (u parser_reply_value _2899) _2900) (u (u fm_term_ori _2901) _term_17))))))); }))); }))); }))))))
fm_parser_inequality = (\_init_1-> (\_val0_2-> (\_idx_3-> (\_code_4-> (let _2902 = (u (u (u fm_parser_text "!=") _idx_3) _code_4) in (case _2902 of {(0,f) -> u f (\_2903 _2904 _2905-> (u (u (u parser_reply_error _2903) _2904) _2905)); (1,f) -> u f (\_2906 _2907 _2908-> (let _2909 = (u (u fm_parser_term _2906) _2907) in (case _2909 of {(0,f) -> u f (\_2910 _2911 _2912-> (u (u (u parser_reply_error _2910) _2911) _2912)); (1,f) -> u f (\_2913 _2914 _2915-> (let _2916 = (u (u (u fm_parser_stop _init_1) _2913) _2914) in (case _2916 of {(0,f) -> u f (\_2917 _2918 _2919-> (u (u (u parser_reply_error _2917) _2918) _2919)); (1,f) -> u f (\_2920 _2921 _2922-> (let _term_14=(u fm_term_ref "Equal") in (let _term_15=(u (u fm_term_app _term_14) (u fm_term_hol bits_e)) in (let _term_16=(u (u fm_term_app _term_15) _val0_2) in (let _term_17=(u (u fm_term_app _term_16) _2915) in (let _term_18=(u (u fm_term_app (u fm_term_ref "Not")) _term_17) in (u (u (u parser_reply_value _2920) _2921) (u (u fm_term_ori _2922) _term_18)))))))); }))); }))); }))))))
fm_parser_rewrite = (\_init_1-> (\_subt_2-> (\_idx_3-> (\_code_4-> (let _2923 = (u (u (u fm_parser_text "::") _idx_3) _code_4) in (case _2923 of {(0,f) -> u f (\_2924 _2925 _2926-> (u (u (u parser_reply_error _2924) _2925) _2926)); (1,f) -> u f (\_2927 _2928 _2929-> (let _2930 = (u (u (u fm_parser_text "rewrite") _2927) _2928) in (case _2930 of {(0,f) -> u f (\_2931 _2932 _2933-> (u (u (u parser_reply_error _2931) _2932) _2933)); (1,f) -> u f (\_2934 _2935 _2936-> (let _2937 = (u (u fm_parser_name1 _2934) _2935) in (case _2937 of {(0,f) -> u f (\_2938 _2939 _2940-> (u (u (u parser_reply_error _2938) _2939) _2940)); (1,f) -> u f (\_2941 _2942 _2943-> (let _2944 = (u (u (u fm_parser_text "in") _2941) _2942) in (case _2944 of {(0,f) -> u f (\_2945 _2946 _2947-> (u (u (u parser_reply_error _2945) _2946) _2947)); (1,f) -> u f (\_2948 _2949 _2950-> (let _2951 = (u (u fm_parser_term _2948) _2949) in (case _2951 of {(0,f) -> u f (\_2952 _2953 _2954-> (u (u (u parser_reply_error _2952) _2953) _2954)); (1,f) -> u f (\_2955 _2956 _2957-> (let _2958 = (u (u (u fm_parser_text "with") _2955) _2956) in (case _2958 of {(0,f) -> u f (\_2959 _2960 _2961-> (u (u (u parser_reply_error _2959) _2960) _2961)); (1,f) -> u f (\_2962 _2963 _2964-> (let _2965 = (u (u fm_parser_term _2962) _2963) in (case _2965 of {(0,f) -> u f (\_2966 _2967 _2968-> (u (u (u parser_reply_error _2966) _2967) _2968)); (1,f) -> u f (\_2969 _2970 _2971-> (let _2972 = (u (u (u fm_parser_stop _init_1) _2969) _2970) in (case _2972 of {(0,f) -> u f (\_2973 _2974 _2975-> (u (u (u parser_reply_error _2973) _2974) _2975)); (1,f) -> u f (\_2976 _2977 _2978-> (let _term_29=(u fm_term_ref "Equal.rewrite") in (let _term_30=(u (u fm_term_app _term_29) (u fm_term_hol bits_e)) in (let _term_31=(u (u fm_term_app _term_30) (u fm_term_hol bits_e)) in (let _term_32=(u (u fm_term_app _term_31) (u fm_term_hol bits_e)) in (let _term_33=(u (u fm_term_app _term_32) _2971) in (let _term_34=(u (u fm_term_app _term_33) (u (u fm_term_lam _2943) (\_x_34-> _2957))) in (let _term_35=(u (u fm_term_app _term_34) _subt_2) in (u (u (u parser_reply_value _2976) _2977) (u (u fm_term_ori _2978) _term_35)))))))))); }))); }))); }))); }))); }))); }))); }))); }))))))
fm_term_ann = (\_done_1-> (\_term_2-> (\_type_3-> (8,\t-> t _done_1 _term_2 _type_3))))
fm_parser_annotation = (\_init_1-> (\_term_2-> (\_idx_3-> (\_code_4-> (let _2979 = (u (u (u fm_parser_text "::") _idx_3) _code_4) in (case _2979 of {(0,f) -> u f (\_2980 _2981 _2982-> (u (u (u parser_reply_error _2980) _2981) _2982)); (1,f) -> u f (\_2983 _2984 _2985-> (let _2986 = (u (u fm_parser_term _2983) _2984) in (case _2986 of {(0,f) -> u f (\_2987 _2988 _2989-> (u (u (u parser_reply_error _2987) _2988) _2989)); (1,f) -> u f (\_2990 _2991 _2992-> (let _2993 = (u (u (u fm_parser_stop _init_1) _2990) _2991) in (case _2993 of {(0,f) -> u f (\_2994 _2995 _2996-> (u (u (u parser_reply_error _2994) _2995) _2996)); (1,f) -> u f (\_2997 _2998 _2999-> (u (u (u parser_reply_value _2997) _2998) (u (u fm_term_ori _2999) (u (u (u fm_term_ann bool_false) _term_2) _2992)))); }))); }))); }))))))
fm_parser_application_hole = (\_init_1-> (\_term_2-> (\_idx_3-> (\_code_4-> (let _3000 = (u (u (u fm_parser_text "!") _idx_3) _code_4) in (case _3000 of {(0,f) -> u f (\_3001 _3002 _3003-> (u (u (u parser_reply_error _3001) _3002) _3003)); (1,f) -> u f (\_3004 _3005 _3006-> (let _3007 = (u (u (u fm_parser_stop _init_1) _3004) _3005) in (case _3007 of {(0,f) -> u f (\_3008 _3009 _3010-> (u (u (u parser_reply_error _3008) _3009) _3010)); (1,f) -> u f (\_3011 _3012 _3013-> (u (u (u parser_reply_value _3011) _3012) (u (u fm_term_ori _3013) (u (u fm_term_app _term_2) (u fm_term_hol bits_e))))); }))); }))))))
fm_parser_suffix = (\_init_1-> (\_term_2-> (\_idx_3-> (\_code_4-> (let _suffix_parser_5=(u parser_first_of (u (u list_cons (u (u fm_parser_application _init_1) _term_2)) (u (u list_cons (u (u fm_parser_application_erased _init_1) _term_2)) (u (u list_cons (u (u fm_parser_arrow _init_1) _term_2)) (u (u list_cons (u (u fm_parser_add _init_1) _term_2)) (u (u list_cons (u (u fm_parser_sub _init_1) _term_2)) (u (u list_cons (u (u fm_parser_mul _init_1) _term_2)) (u (u list_cons (u (u fm_parser_div _init_1) _term_2)) (u (u list_cons (u (u fm_parser_mod _init_1) _term_2)) (u (u list_cons (u (u fm_parser_cons _init_1) _term_2)) (u (u list_cons (u (u fm_parser_concat _init_1) _term_2)) (u (u list_cons (u (u fm_parser_string_concat _init_1) _term_2)) (u (u list_cons (u (u fm_parser_sigma _init_1) _term_2)) (u (u list_cons (u (u fm_parser_equality _init_1) _term_2)) (u (u list_cons (u (u fm_parser_inequality _init_1) _term_2)) (u (u list_cons (u (u fm_parser_rewrite _init_1) _term_2)) (u (u list_cons (u (u fm_parser_annotation _init_1) _term_2)) (u (u list_cons (u (u fm_parser_application_hole _init_1) _term_2)) list_nil)))))))))))))))))) in (let _3014 = (u (u _suffix_parser_5 _idx_3) _code_4) in (case _3014 of {(0,f) -> u f (\_3015 _3016 _3017-> (u (u (u parser_reply_value _idx_3) _code_4) _term_2)); (1,f) -> u f (\_3018 _3019 _3020-> (u (u (u (u fm_parser_suffix _init_1) _3020) _3018) _3019)); })))))))
fm_parser_term = (\_idx_1-> (\_code_2-> (let _3021 = (u (u fm_parser_init _idx_1) _code_2) in (case _3021 of {(0,f) -> u f (\_3022 _3023 _3024-> (u (u (u parser_reply_error _3022) _3023) _3024)); (1,f) -> u f (\_3025 _3026 _3027-> (let _3028 = (u (u (u parser_first_of (u (u list_cons fm_parser_type) (u (u list_cons fm_parser_forall) (u (u list_cons fm_parser_lambda) (u (u list_cons fm_parser_lambda_erased) (u (u list_cons fm_parser_lambda_nameless) (u (u list_cons fm_parser_parenthesis) (u (u list_cons fm_parser_letforrange_u32) (u (u list_cons fm_parser_letforin) (u (u list_cons fm_parser_let) (u (u list_cons fm_parser_get) (u (u list_cons fm_parser_def) (u (u list_cons fm_parser_if) (u (u list_cons fm_parser_char) (u (u list_cons fm_parser_string) (u (u list_cons fm_parser_pair) (u (u list_cons fm_parser_sigma_type) (u (u list_cons fm_parser_some) (u (u list_cons fm_parser_apply) (u (u list_cons fm_parser_mirror) (u (u list_cons fm_parser_list) (u (u list_cons fm_parser_log) (u (u list_cons fm_parser_forrange_u32) (u (u list_cons fm_parser_forrange_u32_2) (u (u list_cons fm_parser_forin) (u (u list_cons fm_parser_forin_2) (u (u list_cons fm_parser_do) (u (u list_cons fm_parser_case) (u (u list_cons fm_parser_open) (u (u list_cons fm_parser_goal) (u (u list_cons fm_parser_hole) (u (u list_cons fm_parser_u8) (u (u list_cons fm_parser_u16) (u (u list_cons fm_parser_u32) (u (u list_cons fm_parser_u64) (u (u list_cons fm_parser_nat) (u (u list_cons fm_parser_reference) list_nil))))))))))))))))))))))))))))))))))))) _3025) _3026) in (case _3028 of {(0,f) -> u f (\_3029 _3030 _3031-> (u (u (u parser_reply_error _3029) _3030) _3031)); (1,f) -> u f (\_3032 _3033 _3034-> (u (u (u (u fm_parser_suffix _3027) _3034) _3032) _3033)); }))); }))))
fm_parser_name_term = (\_idx_1-> (\_code_2-> (let _3035 = (u (u fm_parser_name _idx_1) _code_2) in (case _3035 of {(0,f) -> u f (\_3036 _3037 _3038-> (u (u (u parser_reply_error _3036) _3037) _3038)); (1,f) -> u f (\_3039 _3040 _3041-> (let _3042 = (u (u (u fm_parser_text ":") _3039) _3040) in (case _3042 of {(0,f) -> u f (\_3043 _3044 _3045-> (u (u (u parser_reply_error _3043) _3044) _3045)); (1,f) -> u f (\_3046 _3047 _3048-> (let _3049 = (u (u fm_parser_term _3046) _3047) in (case _3049 of {(0,f) -> u f (\_3050 _3051 _3052-> (u (u (u parser_reply_error _3050) _3051) _3052)); (1,f) -> u f (\_3053 _3054 _3055-> (u (u (u parser_reply_value _3053) _3054) (u (u pair_new _3041) _3055))); }))); }))); }))))
fm_binder_new = (\_eras_1-> (\_name_2-> (\_term_3-> (0,\t-> t _eras_1 _name_2 _term_3))))
fm_parser_binder_homo = (\_eras_1-> (\_idx_2-> (\_code_3-> (let _3056 = (u (u (u fm_parser_text (let _3057 = _eras_1 in (if _3057 then "<" else "("))) _idx_2) _code_3) in (case _3056 of {(0,f) -> u f (\_3058 _3059 _3060-> (u (u (u parser_reply_error _3058) _3059) _3060)); (1,f) -> u f (\_3061 _3062 _3063-> (let _3064 = (u (u (u (u parser_until1 (u fm_parser_text (let _3065 = _eras_1 in (if _3065 then ">" else ")")))) (u fm_parser_item fm_parser_name_term)) _3061) _3062) in (case _3064 of {(0,f) -> u f (\_3066 _3067 _3068-> (u (u (u parser_reply_error _3066) _3067) _3068)); (1,f) -> u f (\_3069 _3070 _3071-> (u (u (u parser_reply_value _3069) _3070) (u (u list_mapped _3071) (\_pair_10-> (let _3072 = _pair_10 in (case _3072 of {(0,f) -> u f (\_3073 _3074-> (u (u (u fm_binder_new _eras_1) _3073) _3074)); })))))); }))); })))))
list_concat = (\_as_2-> (\_bs_3-> (let _3075 = _as_2 in (case _3075 of {(0,f) -> u f (_bs_3); (1,f) -> u f (\_3076 _3077-> (u (u list_cons _3076) (u (u list_concat _3077) _bs_3))); }))))
list_flatten = (\_xs_2-> (let _3078 = _xs_2 in (case _3078 of {(0,f) -> u f (list_nil); (1,f) -> u f (\_3079 _3080-> (u (u list_concat _3079) (u list_flatten _3080))); })))
fm_parser_binder = (\_idx_1-> (\_code_2-> (let _3081 = (u (u (u parser_many1 (u parser_first_of (u (u list_cons (u fm_parser_binder_homo bool_true)) (u (u list_cons (u fm_parser_binder_homo bool_false)) list_nil)))) _idx_1) _code_2) in (case _3081 of {(0,f) -> u f (\_3082 _3083 _3084-> (u (u (u parser_reply_error _3082) _3083) _3084)); (1,f) -> u f (\_3085 _3086 _3087-> (u (u (u parser_reply_value _3085) _3086) (u list_flatten _3087))); }))))
fm_parser_make_forall = (\_binds_1-> (\_body_2-> (let _3088 = _binds_1 in (case _3088 of {(0,f) -> u f (_body_2); (1,f) -> u f (\_3089 _3090-> (let _3091 = _3089 in (case _3091 of {(0,f) -> u f (\_3092 _3093 _3094-> (u (u (u (u (u fm_term_all _3092) "") _3093) _3094) (\_s_8-> (\_x_9-> (u (u fm_parser_make_forall _3090) _body_2))))); }))); }))))
list_at = (\_index_2-> (\_list_3-> (let _3095 = _list_3 in (case _3095 of {(0,f) -> u f (maybe_none); (1,f) -> u f (\_3096 _3097-> (let _3098 = _index_2 in (if _3098==0 then (u maybe_some _3096) else (u (u list_at (_3098-1)) _3097)))); }))))
list_at_last = (\_index_2-> (\_list_3-> (u (u list_at _index_2) (u list_reverse _list_3))))
fm_term_var = (\_name_1-> (\_indx_2-> (0,\t-> t _name_1 _indx_2)))
fm_context_get_name_skips = (\_name_1-> (let _3099 = _name_1 in (if null (_3099::String) then (u (u pair_new "") 0) else (let _name_skips_4=(u fm_context_get_name_skips (tail _3099)) in (let _3100 = _name_skips_4 in (case _3100 of {(0,f) -> u f (\_3101 _3102-> (let _3103 = ((((fromIntegral (fromEnum (head _3099 :: Char)) :: Word16)::Word16) == 94)) in (if _3103 then (u (u pair_new _3101) (u nat_succ _3102)) else (u (u pair_new (u (u string_cons (fromIntegral (fromEnum (head _3099 :: Char)) :: Word16)) _3101)) _3102)))); }))))))
fm_name_eql = (\_a_1-> (\_b_2-> (((_a_1::String) == _b_2))))
fm_context_find_go = (\_name_1-> (\_skip_2-> (\_ctx_3-> (let _3104 = _ctx_3 in (case _3104 of {(0,f) -> u f (maybe_none); (1,f) -> u f (\_3105 _3106-> (let _3107 = _3105 in (case _3107 of {(0,f) -> u f (\_3108 _3109-> (let _3110 = (u (u fm_name_eql _name_1) _3108) in (if _3110 then (let _3111 = _skip_2 in (if _3111==0 then (u maybe_some _3109) else (u (u (u fm_context_find_go _name_1) (_3111-1)) _3106))) else (u (u (u fm_context_find_go _name_1) _skip_2) _3106)))); }))); })))))
fm_context_find = (\_name_1-> (\_ctx_2-> (let _3112 = (u fm_context_get_name_skips _name_1) in (case _3112 of {(0,f) -> u f (\_3113 _3114-> (u (u (u fm_context_find_go _3113) _3114) _ctx_2)); }))))
list_length = (\_xs_2-> (let _3115 = _xs_2 in (case _3115 of {(0,f) -> u f (0); (1,f) -> u f (\_3116 _3117-> (u nat_succ (u list_length _3117))); })))
fm_path_o = (\_path_1-> (\_x_2-> (u _path_1 (u bits_o _x_2))))
fm_path_i = (\_path_1-> (\_x_2-> (u _path_1 (u bits_i _x_2))))
fm_path_to_bits = (\_path_1-> (u _path_1 bits_e))
fm_term_bind = (\_vars_1-> (\_path_2-> (\_term_3-> (let _3118 = _term_3 in (case _3118 of {(0,f) -> u f (\_3119 _3120-> (let _3121 = (u (u list_at_last _3120) _vars_1) in (case _3121 of {(0,f) -> u f ((u (u fm_term_var _3119) _3120)); (1,f) -> u f (\_3122-> (u pair_snd _3122)); }))); (1,f) -> u f (\_3123-> (let _3124 = (u (u fm_context_find _3123) _vars_1) in (case _3124 of {(0,f) -> u f ((u fm_term_ref _3123)); (1,f) -> u f (\_3125-> _3125); }))); (2,f) -> u f (fm_term_typ); (3,f) -> u f (\_3126 _3127 _3128 _3129 _3130-> (let _vlen_9=(u list_length _vars_1) in (u (u (u (u (u fm_term_all _3126) _3127) _3128) (u (u (u fm_term_bind _vars_1) (u fm_path_o _path_2)) _3129)) (\_s_10-> (\_x_11-> (u (u (u fm_term_bind (u (u list_cons (u (u pair_new _3128) _x_11)) (u (u list_cons (u (u pair_new _3127) _s_10)) _vars_1))) (u fm_path_i _path_2)) (u (u _3130 (u (u fm_term_var _3127) _vlen_9)) (u (u fm_term_var _3128) (u nat_succ _vlen_9))))))))); (4,f) -> u f (\_3131 _3132-> (let _vlen_6=(u list_length _vars_1) in (u (u fm_term_lam _3131) (\_x_7-> (u (u (u fm_term_bind (u (u list_cons (u (u pair_new _3131) _x_7)) _vars_1)) (u fm_path_o _path_2)) (u _3132 (u (u fm_term_var _3131) _vlen_6))))))); (5,f) -> u f (\_3133 _3134-> (u (u fm_term_app (u (u (u fm_term_bind _vars_1) (u fm_path_o _path_2)) _3133)) (u (u (u fm_term_bind _vars_1) (u fm_path_i _path_2)) _3134))); (6,f) -> u f (\_3135 _3136 _3137-> (let _vlen_7=(u list_length _vars_1) in (u (u (u fm_term_let _3135) (u (u (u fm_term_bind _vars_1) (u fm_path_o _path_2)) _3136)) (\_x_8-> (u (u (u fm_term_bind (u (u list_cons (u (u pair_new _3135) _x_8)) _vars_1)) (u fm_path_i _path_2)) (u _3137 (u (u fm_term_var _3135) _vlen_7))))))); (7,f) -> u f (\_3138 _3139 _3140-> (let _vlen_7=(u list_length _vars_1) in (u (u (u fm_term_def _3138) (u (u (u fm_term_bind _vars_1) (u fm_path_o _path_2)) _3139)) (\_x_8-> (u (u (u fm_term_bind (u (u list_cons (u (u pair_new _3138) _x_8)) _vars_1)) (u fm_path_i _path_2)) (u _3140 (u (u fm_term_var _3138) _vlen_7))))))); (8,f) -> u f (\_3141 _3142 _3143-> (u (u (u fm_term_ann _3141) (u (u (u fm_term_bind _vars_1) (u fm_path_o _path_2)) _3142)) (u (u (u fm_term_bind _vars_1) (u fm_path_i _path_2)) _3143))); (9,f) -> u f (\_3144 _3145 _3146-> (u (u (u fm_term_gol _3144) _3145) _3146)); (10,f) -> u f (\_3147-> (u fm_term_hol (u fm_path_to_bits _path_2))); (11,f) -> u f (\_3148-> (u fm_term_nat _3148)); (12,f) -> u f (\_3149-> (u fm_term_chr _3149)); (13,f) -> u f (\_3150-> (u fm_term_str _3150)); (14,f) -> u f (\_3151 _3152 _3153 _3154 _3155 _3156-> (let _expr_10=(u (u (u fm_term_bind _vars_1) (u fm_path_o _path_2)) _3152) in (let _name_11=_3153 in (let _wyth_12=_3154 in (let _cses_13=_3155 in (let _moti_14=_3156 in (u (u (u (u (u (u fm_term_cse (u fm_path_to_bits _path_2)) _expr_10) _name_11) _wyth_12) _cses_13) _moti_14))))))); (15,f) -> u f (\_3157 _3158-> (u (u fm_term_ori _3157) (u (u (u fm_term_bind _vars_1) _path_2) _3158))); })))))
fm_status_done = (2,\t-> t)
fm_define = (\_file_1-> (\_code_2-> (\_name_3-> (\_term_4-> (\_type_5-> (\_done_6-> (\_defs_7-> (let _stat_8=(let _3159 = _done_6 in (if _3159 then fm_status_done else fm_status_init)) in (u (u (u fm_set _name_3) (u (u (u (u (u (u fm_def_new _file_1) _code_2) _name_3) _term_4) _type_5) _stat_8)) _defs_7)))))))))
fm_parser_file_def = (\_file_1-> (\_code_2-> (\_defs_3-> (\_idx_4-> (\_code_5-> (let _3160 = (u (u fm_parser_name1 _idx_4) _code_5) in (case _3160 of {(0,f) -> u f (\_3161 _3162 _3163-> (u (u (u parser_reply_error _3161) _3162) _3163)); (1,f) -> u f (\_3164 _3165 _3166-> (let _3167 = (u (u (u parser_many fm_parser_binder) _3164) _3165) in (case _3167 of {(0,f) -> u f (\_3168 _3169 _3170-> (u (u (u parser_reply_error _3168) _3169) _3170)); (1,f) -> u f (\_3171 _3172 _3173-> (let _args_12=(u list_flatten _3173) in (let _3174 = (u (u (u fm_parser_text ":") _3171) _3172) in (case _3174 of {(0,f) -> u f (\_3175 _3176 _3177-> (u (u (u parser_reply_error _3175) _3176) _3177)); (1,f) -> u f (\_3178 _3179 _3180-> (let _3181 = (u (u fm_parser_term _3178) _3179) in (case _3181 of {(0,f) -> u f (\_3182 _3183 _3184-> (u (u (u parser_reply_error _3182) _3183) _3184)); (1,f) -> u f (\_3185 _3186 _3187-> (let _3188 = (u (u fm_parser_term _3185) _3186) in (case _3188 of {(0,f) -> u f (\_3189 _3190 _3191-> (u (u (u parser_reply_error _3189) _3190) _3191)); (1,f) -> u f (\_3192 _3193 _3194-> (let _type_22=(u (u fm_parser_make_forall _args_12) _3187) in (let _term_23=(u (u fm_parser_make_lambda (u (u list_mapped _args_12) (\_x_23-> (let _3195 = _x_23 in (case _3195 of {(0,f) -> u f (\_3196 _3197 _3198-> _3197); }))))) _3194) in (let _type_24=(u (u (u fm_term_bind list_nil) (\_x_24-> (u bits_i _x_24))) _type_22) in (let _term_25=(u (u (u fm_term_bind list_nil) (\_x_25-> (u bits_o _x_25))) _term_23) in (let _defs_26=(u (u (u (u (u (u (u fm_define _file_1) _code_2) _3166) _term_25) _type_24) bool_false) _defs_3) in (u (u (u parser_reply_value _3192) _3193) _defs_26))))))); }))); }))); })))); }))); })))))))
maybe_default = (\_a_2-> (\_m_3-> (let _3199 = _m_3 in (case _3199 of {(0,f) -> u f (_a_2); (1,f) -> u f (\_3200-> _3200); }))))
fm_constructor_new = (\_name_1-> (\_args_2-> (\_inds_3-> (0,\t-> t _name_1 _args_2 _inds_3))))
fm_parser_constructor = (\_namespace_1-> (\_idx_2-> (\_code_3-> (let _3201 = (u (u fm_parser_name1 _idx_2) _code_3) in (case _3201 of {(0,f) -> u f (\_3202 _3203 _3204-> (u (u (u parser_reply_error _3202) _3203) _3204)); (1,f) -> u f (\_3205 _3206 _3207-> (let _3208 = (u (u (u parser_maybe fm_parser_binder) _3205) _3206) in (case _3208 of {(0,f) -> u f (\_3209 _3210 _3211-> (u (u (u parser_reply_error _3209) _3210) _3211)); (1,f) -> u f (\_3212 _3213 _3214-> (let _3215 = (u (u (u parser_maybe (\_idx_10-> (\_code_11-> (let _3216 = (u (u (u fm_parser_text "~") _idx_10) _code_11) in (case _3216 of {(0,f) -> u f (\_3217 _3218 _3219-> (u (u (u parser_reply_error _3217) _3218) _3219)); (1,f) -> u f (\_3220 _3221 _3222-> (u (u fm_parser_binder _3220) _3221)); }))))) _3212) _3213) in (case _3215 of {(0,f) -> u f (\_3223 _3224 _3225-> (u (u (u parser_reply_error _3223) _3224) _3225)); (1,f) -> u f (\_3226 _3227 _3228-> (let _args_13=(u (u maybe_default list_nil) _3214) in (let _inds_14=(u (u maybe_default list_nil) _3228) in (u (u (u parser_reply_value _3226) _3227) (u (u (u fm_constructor_new _3207) _args_13) _inds_14))))); }))); }))); })))))
fm_datatype_new = (\_name_1-> (\_pars_2-> (\_inds_3-> (\_ctrs_4-> (0,\t-> t _name_1 _pars_2 _inds_3 _ctrs_4)))))
fm_parser_datatype = (\_idx_1-> (\_code_2-> (let _3229 = (u (u (u fm_parser_text "type ") _idx_1) _code_2) in (case _3229 of {(0,f) -> u f (\_3230 _3231 _3232-> (u (u (u parser_reply_error _3230) _3231) _3232)); (1,f) -> u f (\_3233 _3234 _3235-> (let _3236 = (u (u fm_parser_name1 _3233) _3234) in (case _3236 of {(0,f) -> u f (\_3237 _3238 _3239-> (u (u (u parser_reply_error _3237) _3238) _3239)); (1,f) -> u f (\_3240 _3241 _3242-> (let _3243 = (u (u (u parser_maybe fm_parser_binder) _3240) _3241) in (case _3243 of {(0,f) -> u f (\_3244 _3245 _3246-> (u (u (u parser_reply_error _3244) _3245) _3246)); (1,f) -> u f (\_3247 _3248 _3249-> (let _3250 = (u (u (u parser_maybe (\_idx_12-> (\_code_13-> (let _3251 = (u (u (u fm_parser_text "~") _idx_12) _code_13) in (case _3251 of {(0,f) -> u f (\_3252 _3253 _3254-> (u (u (u parser_reply_error _3252) _3253) _3254)); (1,f) -> u f (\_3255 _3256 _3257-> (u (u fm_parser_binder _3255) _3256)); }))))) _3247) _3248) in (case _3250 of {(0,f) -> u f (\_3258 _3259 _3260-> (u (u (u parser_reply_error _3258) _3259) _3260)); (1,f) -> u f (\_3261 _3262 _3263-> (let _pars_15=(u (u maybe_default list_nil) _3249) in (let _inds_16=(u (u maybe_default list_nil) _3263) in (let _3264 = (u (u (u fm_parser_text "{") _3261) _3262) in (case _3264 of {(0,f) -> u f (\_3265 _3266 _3267-> (u (u (u parser_reply_error _3265) _3266) _3267)); (1,f) -> u f (\_3268 _3269 _3270-> (let _3271 = (u (u (u (u parser_until (u fm_parser_text "}")) (u fm_parser_item (u fm_parser_constructor _3242))) _3268) _3269) in (case _3271 of {(0,f) -> u f (\_3272 _3273 _3274-> (u (u (u parser_reply_error _3272) _3273) _3274)); (1,f) -> u f (\_3275 _3276 _3277-> (u (u (u parser_reply_value _3275) _3276) (u (u (u (u fm_datatype_new _3242) _pars_15) _inds_16) _3277))); }))); }))))); }))); }))); }))); }))))
fm_datatype_build_term_motive_go = (\_type_1-> (\_name_2-> (\_inds_3-> (let _3278 = _inds_3 in (case _3278 of {(0,f) -> u f ((let _3279 = _type_1 in (case _3279 of {(0,f) -> u f (\_3280 _3281 _3282 _3283-> (let _slf_8=(u fm_term_ref _name_2) in (let _slf_9=(u (u (u list_for _3281) _slf_8) (\_var_9-> (\_slf_10-> (u (u fm_term_app _slf_10) (u fm_term_ref (let _3284 = _var_9 in (case _3284 of {(0,f) -> u f (\_3285 _3286 _3287-> _3286); }))))))) in (let _slf_10=(u (u (u list_for _3282) _slf_9) (\_var_10-> (\_slf_11-> (u (u fm_term_app _slf_11) (u fm_term_ref (let _3288 = _var_10 in (case _3288 of {(0,f) -> u f (\_3289 _3290 _3291-> _3290); }))))))) in (u (u (u (u (u fm_term_all bool_false) "") "") _slf_10) (\_s_11-> (\_x_12-> fm_term_typ))))))); }))); (1,f) -> u f (\_3292 _3293-> (let _3294 = _3292 in (case _3294 of {(0,f) -> u f (\_3295 _3296 _3297-> (u (u (u (u (u fm_term_all _3295) "") _3296) _3297) (\_s_9-> (\_x_10-> (u (u (u fm_datatype_build_term_motive_go _type_1) _name_2) _3293))))); }))); })))))
fm_datatype_build_term_motive = (\_type_1-> (let _3298 = _type_1 in (case _3298 of {(0,f) -> u f (\_3299 _3300 _3301 _3302-> (u (u (u fm_datatype_build_term_motive_go _type_1) _3299) _3301)); })))
fm_datatype_build_term_constructor_go = (\_type_1-> (\_ctor_2-> (\_args_3-> (let _3303 = _args_3 in (case _3303 of {(0,f) -> u f ((let _3304 = _type_1 in (case _3304 of {(0,f) -> u f (\_3305 _3306 _3307 _3308-> (let _3309 = _ctor_2 in (case _3309 of {(0,f) -> u f (\_3310 _3311 _3312-> (let _ret_11=(u fm_term_ref (u fm_name_read "P")) in (let _ret_12=(u (u (u list_for _3312) _ret_11) (\_var_12-> (\_ret_13-> (u (u fm_term_app _ret_13) (let _3313 = _var_12 in (case _3313 of {(0,f) -> u f (\_3314 _3315 _3316-> _3316); })))))) in (let _ctr_13=(u string_flatten (u (u list_cons _3305) (u (u list_cons (u fm_name_read ".")) (u (u list_cons _3310) list_nil)))) in (let _slf_14=(u fm_term_ref _ctr_13) in (let _slf_15=(u (u (u list_for _3306) _slf_14) (\_var_15-> (\_slf_16-> (u (u fm_term_app _slf_16) (u fm_term_ref (let _3317 = _var_15 in (case _3317 of {(0,f) -> u f (\_3318 _3319 _3320-> _3319); }))))))) in (let _slf_16=(u (u (u list_for _3311) _slf_15) (\_var_16-> (\_slf_17-> (u (u fm_term_app _slf_17) (u fm_term_ref (let _3321 = _var_16 in (case _3321 of {(0,f) -> u f (\_3322 _3323 _3324-> _3323); }))))))) in (u (u fm_term_app _ret_12) _slf_16)))))))); }))); }))); (1,f) -> u f (\_3325 _3326-> (let _3327 = _3325 in (case _3327 of {(0,f) -> u f (\_3328 _3329 _3330-> (let _eras_9=_3328 in (let _name_10=_3329 in (let _xtyp_11=_3330 in (let _body_12=(u (u (u fm_datatype_build_term_constructor_go _type_1) _ctor_2) _3326) in (u (u (u (u (u fm_term_all _eras_9) "") _name_10) _xtyp_11) (\_s_13-> (\_x_14-> _body_12)))))))); }))); })))))
fm_datatype_build_term_constructor = (\_type_1-> (\_ctor_2-> (let _3331 = _ctor_2 in (case _3331 of {(0,f) -> u f (\_3332 _3333 _3334-> (u (u (u fm_datatype_build_term_constructor_go _type_1) _ctor_2) _3333)); }))))
fm_datatype_build_term_constructors_go = (\_type_1-> (\_name_2-> (\_ctrs_3-> (let _3335 = _ctrs_3 in (case _3335 of {(0,f) -> u f ((let _3336 = _type_1 in (case _3336 of {(0,f) -> u f (\_3337 _3338 _3339 _3340-> (let _ret_8=(u fm_term_ref (u fm_name_read "P")) in (let _ret_9=(u (u (u list_for _3339) _ret_8) (\_var_9-> (\_ret_10-> (u (u fm_term_app _ret_10) (u fm_term_ref (let _3341 = _var_9 in (case _3341 of {(0,f) -> u f (\_3342 _3343 _3344-> _3343); }))))))) in (u (u fm_term_app _ret_9) (u fm_term_ref (((_name_2::String) ++ ".Self"))))))); }))); (1,f) -> u f (\_3345 _3346-> (let _3347 = _3345 in (case _3347 of {(0,f) -> u f (\_3348 _3349 _3350-> (u (u (u (u (u fm_term_all bool_false) "") _3348) (u (u fm_datatype_build_term_constructor _type_1) _3345)) (\_s_9-> (\_x_10-> (u (u (u fm_datatype_build_term_constructors_go _type_1) _name_2) _3346))))); }))); })))))
fm_datatype_build_term_constructors = (\_type_1-> (let _3351 = _type_1 in (case _3351 of {(0,f) -> u f (\_3352 _3353 _3354 _3355-> (u (u (u fm_datatype_build_term_constructors_go _type_1) _3352) _3355)); })))
fm_datatype_build_term_go = (\_type_1-> (\_name_2-> (\_pars_3-> (\_inds_4-> (let _3356 = _pars_3 in (case _3356 of {(0,f) -> u f ((let _3357 = _inds_4 in (case _3357 of {(0,f) -> u f ((u (u (u (u (u fm_term_all bool_true) (((_name_2::String) ++ ".Self"))) (u fm_name_read "P")) (u fm_datatype_build_term_motive _type_1)) (\_s_5-> (\_x_6-> (u fm_datatype_build_term_constructors _type_1))))); (1,f) -> u f (\_3358 _3359-> (let _3360 = _3358 in (case _3360 of {(0,f) -> u f (\_3361 _3362 _3363-> (u (u fm_term_lam _3362) (\_x_10-> (u (u (u (u fm_datatype_build_term_go _type_1) _name_2) _pars_3) _3359)))); }))); }))); (1,f) -> u f (\_3364 _3365-> (let _3366 = _3364 in (case _3366 of {(0,f) -> u f (\_3367 _3368 _3369-> (u (u fm_term_lam _3368) (\_x_10-> (u (u (u (u fm_datatype_build_term_go _type_1) _name_2) _3365) _inds_4)))); }))); }))))))
fm_datatype_build_term = (\_type_1-> (let _3370 = _type_1 in (case _3370 of {(0,f) -> u f (\_3371 _3372 _3373 _3374-> (u (u (u (u fm_datatype_build_term_go _type_1) _3371) _3372) _3373)); })))
fm_datatype_build_type_go = (\_type_1-> (\_name_2-> (\_pars_3-> (\_inds_4-> (let _3375 = _pars_3 in (case _3375 of {(0,f) -> u f ((let _3376 = _inds_4 in (case _3376 of {(0,f) -> u f (fm_term_typ); (1,f) -> u f (\_3377 _3378-> (let _3379 = _3377 in (case _3379 of {(0,f) -> u f (\_3380 _3381 _3382-> (u (u (u (u (u fm_term_all bool_false) "") _3381) _3382) (\_s_10-> (\_x_11-> (u (u (u (u fm_datatype_build_type_go _type_1) _name_2) _pars_3) _3378))))); }))); }))); (1,f) -> u f (\_3383 _3384-> (let _3385 = _3383 in (case _3385 of {(0,f) -> u f (\_3386 _3387 _3388-> (u (u (u (u (u fm_term_all bool_false) "") _3387) _3388) (\_s_10-> (\_x_11-> (u (u (u (u fm_datatype_build_type_go _type_1) _name_2) _3384) _inds_4))))); }))); }))))))
fm_datatype_build_type = (\_type_1-> (let _3389 = _type_1 in (case _3389 of {(0,f) -> u f (\_3390 _3391 _3392 _3393-> (u (u (u (u fm_datatype_build_type_go _type_1) _3390) _3391) _3392)); })))
fm_constructor_build_term_opt_go = (\_type_1-> (\_ctor_2-> (\_ctrs_3-> (let _3394 = _ctrs_3 in (case _3394 of {(0,f) -> u f ((let _3395 = _ctor_2 in (case _3395 of {(0,f) -> u f (\_3396 _3397 _3398-> (let _ret_7=(u fm_term_ref _3396) in (let _ret_8=(u (u (u list_for _3397) _ret_7) (\_arg_8-> (\_ret_9-> (u (u fm_term_app _ret_9) (u fm_term_ref (let _3399 = _arg_8 in (case _3399 of {(0,f) -> u f (\_3400 _3401 _3402-> _3401); }))))))) in _ret_8))); }))); (1,f) -> u f (\_3403 _3404-> (let _3405 = _3403 in (case _3405 of {(0,f) -> u f (\_3406 _3407 _3408-> (u (u fm_term_lam _3406) (\_x_9-> (u (u (u fm_constructor_build_term_opt_go _type_1) _ctor_2) _3404)))); }))); })))))
fm_constructor_build_term_opt = (\_type_1-> (\_ctor_2-> (let _3409 = _type_1 in (case _3409 of {(0,f) -> u f (\_3410 _3411 _3412 _3413-> (u (u (u fm_constructor_build_term_opt_go _type_1) _ctor_2) _3413)); }))))
fm_constructor_build_term_go = (\_type_1-> (\_ctor_2-> (\_name_3-> (\_pars_4-> (\_args_5-> (let _3414 = _pars_4 in (case _3414 of {(0,f) -> u f ((let _3415 = _args_5 in (case _3415 of {(0,f) -> u f ((u (u fm_term_lam (u fm_name_read "P")) (\_x_6-> (u (u fm_constructor_build_term_opt _type_1) _ctor_2)))); (1,f) -> u f (\_3416 _3417-> (let _3418 = _3416 in (case _3418 of {(0,f) -> u f (\_3419 _3420 _3421-> (u (u fm_term_lam _3420) (\_x_11-> (u (u (u (u (u fm_constructor_build_term_go _type_1) _ctor_2) _name_3) _pars_4) _3417)))); }))); }))); (1,f) -> u f (\_3422 _3423-> (let _3424 = _3422 in (case _3424 of {(0,f) -> u f (\_3425 _3426 _3427-> (u (u fm_term_lam _3426) (\_x_11-> (u (u (u (u (u fm_constructor_build_term_go _type_1) _ctor_2) _name_3) _3423) _args_5)))); }))); })))))))
fm_constructor_build_term = (\_type_1-> (\_ctor_2-> (let _3428 = _type_1 in (case _3428 of {(0,f) -> u f (\_3429 _3430 _3431 _3432-> (let _3433 = _ctor_2 in (case _3433 of {(0,f) -> u f (\_3434 _3435 _3436-> (u (u (u (u (u fm_constructor_build_term_go _type_1) _ctor_2) _3429) _3430) _3435)); }))); }))))
fm_constructor_build_type_go = (\_type_1-> (\_ctor_2-> (\_name_3-> (\_pars_4-> (\_args_5-> (let _3437 = _pars_4 in (case _3437 of {(0,f) -> u f ((let _3438 = _args_5 in (case _3438 of {(0,f) -> u f ((let _3439 = _type_1 in (case _3439 of {(0,f) -> u f (\_3440 _3441 _3442 _3443-> (let _3444 = _ctor_2 in (case _3444 of {(0,f) -> u f (\_3445 _3446 _3447-> (let _type_13=(u fm_term_ref _name_3) in (let _type_14=(u (u (u list_for _3441) _type_13) (\_var_14-> (\_type_15-> (u (u fm_term_app _type_15) (u fm_term_ref (let _3448 = _var_14 in (case _3448 of {(0,f) -> u f (\_3449 _3450 _3451-> _3450); }))))))) in (let _type_15=(u (u (u list_for _3447) _type_14) (\_var_15-> (\_type_16-> (u (u fm_term_app _type_16) (let _3452 = _var_15 in (case _3452 of {(0,f) -> u f (\_3453 _3454 _3455-> _3455); })))))) in _type_15)))); }))); }))); (1,f) -> u f (\_3456 _3457-> (let _3458 = _3456 in (case _3458 of {(0,f) -> u f (\_3459 _3460 _3461-> (u (u (u (u (u fm_term_all _3459) "") _3460) _3461) (\_s_11-> (\_x_12-> (u (u (u (u (u fm_constructor_build_type_go _type_1) _ctor_2) _name_3) _pars_4) _3457))))); }))); }))); (1,f) -> u f (\_3462 _3463-> (let _3464 = _3462 in (case _3464 of {(0,f) -> u f (\_3465 _3466 _3467-> (u (u (u (u (u fm_term_all _3465) "") _3466) _3467) (\_s_11-> (\_x_12-> (u (u (u (u (u fm_constructor_build_type_go _type_1) _ctor_2) _name_3) _3463) _args_5))))); }))); })))))))
fm_constructor_build_type = (\_type_1-> (\_ctor_2-> (let _3468 = _type_1 in (case _3468 of {(0,f) -> u f (\_3469 _3470 _3471 _3472-> (let _3473 = _ctor_2 in (case _3473 of {(0,f) -> u f (\_3474 _3475 _3476-> (u (u (u (u (u fm_constructor_build_type_go _type_1) _ctor_2) _3469) _3470) _3475)); }))); }))))
fm_parser_file_adt = (\_file_1-> (\_code_2-> (\_defs_3-> (\_idx_4-> (\_code_5-> (let _3477 = (u (u fm_parser_datatype _idx_4) _code_5) in (case _3477 of {(0,f) -> u f (\_3478 _3479 _3480-> (u (u (u parser_reply_error _3478) _3479) _3480)); (1,f) -> u f (\_3481 _3482 _3483-> (let _3484 = _3483 in (case _3484 of {(0,f) -> u f (\_3485 _3486 _3487 _3488-> (let _term_13=(u fm_datatype_build_term _3483) in (let _term_14=(u (u (u fm_term_bind list_nil) (\_x_14-> (u bits_i _x_14))) _term_13) in (let _type_15=(u fm_datatype_build_type _3483) in (let _type_16=(u (u (u fm_term_bind list_nil) (\_x_16-> (u bits_o _x_16))) _type_15) in (let _defs_17=(u (u (u (u (u (u (u fm_define _file_1) _code_2) _3485) _term_14) _type_16) bool_false) _defs_3) in (let _defs_18=(u (u (u list_fold _3488) _defs_17) (\_ctr_18-> (\_defs_19-> (let _typ_name_20=_3485 in (let _ctr_name_21=(u string_flatten (u (u list_cons _typ_name_20) (u (u list_cons (u fm_name_read ".")) (u (u list_cons (let _3489 = _ctr_18 in (case _3489 of {(0,f) -> u f (\_3490 _3491 _3492-> _3490); }))) list_nil)))) in (let _ctr_term_22=(u (u fm_constructor_build_term _3483) _ctr_18) in (let _ctr_term_23=(u (u (u fm_term_bind list_nil) (\_x_23-> (u bits_i _x_23))) _ctr_term_22) in (let _ctr_type_24=(u (u fm_constructor_build_type _3483) _ctr_18) in (let _ctr_type_25=(u (u (u fm_term_bind list_nil) (\_x_25-> (u bits_o _x_25))) _ctr_type_24) in (u (u (u (u (u (u (u fm_define _file_1) _code_2) _ctr_name_21) _ctr_term_23) _ctr_type_25) bool_false) _defs_19)))))))))) in (\_idx_19-> (\_code_20-> (u (u (u parser_reply_value _idx_19) _code_20) _defs_18)))))))))); })) _3481 _3482); })))))))
parser_eof = (\_idx_1-> (\_code_2-> (let _3493 = _code_2 in (if null (_3493::String) then (u (u (u parser_reply_value _idx_1) _code_2) unit_new) else (u (u (u parser_reply_error _idx_1) _code_2) "Expected end-of-file.")))))
fm_parser_file_end = (\_file_1-> (\_code_2-> (\_defs_3-> (\_idx_4-> (\_code_5-> (let _3494 = (u (u fm_parser_spaces _idx_4) _code_5) in (case _3494 of {(0,f) -> u f (\_3495 _3496 _3497-> (u (u (u parser_reply_error _3495) _3496) _3497)); (1,f) -> u f (\_3498 _3499 _3500-> (let _3501 = (u (u parser_eof _3498) _3499) in (case _3501 of {(0,f) -> u f (\_3502 _3503 _3504-> (u (u (u parser_reply_error _3502) _3503) _3504)); (1,f) -> u f (\_3505 _3506 _3507-> (u (u (u parser_reply_value _3505) _3506) _defs_3)); }))); })))))))
fm_parser_file = (\_file_1-> (\_code_2-> (\_defs_3-> (\_idx_4-> (\_code_5-> (let _3508 = (u (u parser_is_eof _idx_4) _code_5) in (case _3508 of {(0,f) -> u f (\_3509 _3510 _3511-> (u (u (u parser_reply_error _3509) _3510) _3511)); (1,f) -> u f (\_3512 _3513 _3514-> (let _3515 = _3514 in (if _3515 then (\_idx_9-> (\_code_10-> (u (u (u parser_reply_value _idx_9) _code_10) _defs_3))) else (\_idx_9-> (\_code_10-> (let _3516 = (u (u (u parser_first_of (u (u list_cons (u (u (u fm_parser_file_def _file_1) _code_2) _defs_3)) (u (u list_cons (u (u (u fm_parser_file_adt _file_1) _code_2) _defs_3)) (u (u list_cons (u (u (u fm_parser_file_end _file_1) _code_2) _defs_3)) list_nil)))) _idx_9) _code_10) in (case _3516 of {(0,f) -> u f (\_3517 _3518 _3519-> (u (u (u parser_reply_error _3517) _3518) _3519)); (1,f) -> u f (\_3520 _3521 _3522-> (u (u (u (u (u fm_parser_file _file_1) _code_2) _3522) _3520) _3521)); })))))) _3512 _3513); })))))))
either = (\_a_1-> (\_b_2-> ()))
string_join_go = (\_sep_1-> (\_list_2-> (\_fst_3-> (let _3523 = _list_2 in (case _3523 of {(0,f) -> u f (""); (1,f) -> u f (\_3524 _3525-> (u string_flatten (u (u list_cons (let _3526 = _fst_3 in (if _3526 then "" else _sep_1))) (u (u list_cons _3524) (u (u list_cons (u (u (u string_join_go _sep_1) _3525) bool_false)) list_nil))))); })))))
string_join = (\_sep_1-> (\_list_2-> (u (u (u string_join_go _sep_1) _list_2) bool_true)))
fm_highlight_end = (\_col_1-> (\_row_2-> (\_res_3-> (u (u string_join "\n") _res_3))))
maybe_extract = (\_m_2-> (\_a_4-> (\_f_5-> (let _3527 = _m_2 in (case _3527 of {(0,f) -> u f (_a_4); (1,f) -> u f (\_3528-> (u _f_5 _3528)); })))))
nat_is_zero = (\_n_1-> (let _3529 = _n_1 in (if _3529==0 then bool_true else bool_false)))
nat_double = (\_n_1-> (let _3530 = _n_1 in (if _3530==0 then nat_zero else (u nat_succ (u nat_succ (u nat_double (_3530-1)))))))
nat_pred = (\_n_1-> (let _3531 = _n_1 in (if _3531==0 then nat_zero else (_3531-1))))
string_reverse_go = (\_xs_1-> (\_res_2-> (let _3532 = _xs_1 in (if null (_3532::String) then _res_2 else (u (u string_reverse_go (tail _3532)) (u (u string_cons (fromIntegral (fromEnum (head _3532 :: Char)) :: Word16)) _res_2))))))
string_reverse = (\_xs_1-> (u (u string_reverse_go _xs_1) string_nil))
string_pad_right = (\_size_1-> (\_chr_2-> (\_str_3-> (let _3533 = _size_1 in (if _3533==0 then _str_3 else (let _3534 = _str_3 in (if null (_3534::String) then (u (u string_cons _chr_2) (u (u (u string_pad_right (_3533-1)) _chr_2) "")) else (u (u string_cons (fromIntegral (fromEnum (head _3534 :: Char)) :: Word16)) (u (u (u string_pad_right (_3533-1)) _chr_2) (tail _3534))))))))))
string_pad_left = (\_size_1-> (\_chr_2-> (\_str_3-> (u string_reverse (u (u (u string_pad_right _size_1) _chr_2) (u string_reverse _str_3))))))
either_left = (\_value_3-> (0,\t-> t _value_3))
either_right = (\_value_3-> (1,\t-> t _value_3))
nat_sub_rem = (\_n_1-> (\_m_2-> (let _3535 = _m_2 in (if _3535==0 then (u either_left _n_1) else (let _3536 = _n_1 in (if _3536==0 then (u either_right (u nat_succ (_3535-1))) else (u (u nat_sub_rem (_3536-1)) (_3535-1))))))))
nat_div_mod_go = (\_n_1-> (\_m_2-> (\_d_3-> (let _3537 = (u (u nat_sub_rem _n_1) _m_2) in (case _3537 of {(0,f) -> u f (\_3538-> (u (u (u nat_div_mod_go _3538) _m_2) (u nat_succ _d_3))); (1,f) -> u f (\_3539-> (u (u pair_new _d_3) _n_1)); })))))
nat_div_mod = (\_n_1-> (\_m_2-> (u (u (u nat_div_mod_go _n_1) _m_2) nat_zero)))
nat_to_base_go = (\_base_1-> (\_nat_2-> (\_res_3-> (let _3540 = (u (u nat_div_mod _nat_2) _base_1) in (case _3540 of {(0,f) -> u f (\_3541 _3542-> (let _3543 = _3541 in (if _3543==0 then (u (u list_cons _3542) _res_3) else (u (u (u nat_to_base_go _base_1) _3541) (u (u list_cons _3542) _res_3))))); })))))
nat_to_base = (\_base_1-> (\_nat_2-> (u (u (u nat_to_base_go _base_1) _nat_2) list_nil)))
nat_mod_go = (\_n_1-> (\_m_2-> (\_r_3-> (let _3544 = _m_2 in (if _3544==0 then (u (u (u nat_mod_go _n_1) _r_3) _m_2) else (let _3545 = _n_1 in (if _3545==0 then _r_3 else (u (u (u nat_mod_go (_3545-1)) (_3544-1)) (u nat_succ _r_3)))))))))
nat_mod = (\_n_1-> (\_m_2-> (u (u (u nat_mod_go _n_1) _m_2) 0)))
nat_lte = (\a0-> \a1-> ((a0::Integer) <= a1))
nat_show_digit = (\_base_1-> (\_n_2-> (let _m_3=(u (u nat_mod _n_2) _base_1) in (let _base64_4=(u (u list_cons 48) (u (u list_cons 49) (u (u list_cons 50) (u (u list_cons 51) (u (u list_cons 52) (u (u list_cons 53) (u (u list_cons 54) (u (u list_cons 55) (u (u list_cons 56) (u (u list_cons 57) (u (u list_cons 65) (u (u list_cons 66) (u (u list_cons 67) (u (u list_cons 68) (u (u list_cons 69) (u (u list_cons 70) (u (u list_cons 71) (u (u list_cons 72) (u (u list_cons 73) (u (u list_cons 74) (u (u list_cons 75) (u (u list_cons 76) (u (u list_cons 77) (u (u list_cons 78) (u (u list_cons 79) (u (u list_cons 80) (u (u list_cons 81) (u (u list_cons 82) (u (u list_cons 83) (u (u list_cons 84) (u (u list_cons 85) (u (u list_cons 86) (u (u list_cons 87) (u (u list_cons 88) (u (u list_cons 89) (u (u list_cons 90) (u (u list_cons 97) (u (u list_cons 98) (u (u list_cons 99) (u (u list_cons 100) (u (u list_cons 101) (u (u list_cons 102) (u (u list_cons 103) (u (u list_cons 104) (u (u list_cons 105) (u (u list_cons 106) (u (u list_cons 107) (u (u list_cons 108) (u (u list_cons 109) (u (u list_cons 110) (u (u list_cons 111) (u (u list_cons 112) (u (u list_cons 113) (u (u list_cons 114) (u (u list_cons 115) (u (u list_cons 116) (u (u list_cons 117) (u (u list_cons 118) (u (u list_cons 119) (u (u list_cons 120) (u (u list_cons 121) (u (u list_cons 122) (u (u list_cons 43) (u (u list_cons 47) list_nil)))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))) in (let _3546 = (((((_base_1::Integer) > 0)) && (((_base_1::Integer) <= 64)))) in (if _3546 then (let _3547 = (u (u list_at _m_3) _base64_4) in (case _3547 of {(0,f) -> u f (35); (1,f) -> u f (\_3548-> _3548); })) else 35))))))
nat_to_string_base = (\_base_1-> (\_nat_2-> (u (u (u list_fold (u (u nat_to_base _base_1) _nat_2)) string_nil) (\_n_3-> (\_str_4-> (u (u string_cons (u (u nat_show_digit _base_1) _n_3)) _str_4))))))
nat_show = (\_n_1-> (u (u nat_to_string_base 10) _n_1))
bool_not = (\a0-> (not a0))
fm_color = (\_col_1-> (\_str_2-> (u (u string_cons 27) (u (u string_cons 91) (((_col_1::String) ++ (u (u string_cons 109) (((_str_2::String) ++ (u (u string_cons 27) (u (u string_cons 91) (u (u string_cons 48) (u (u string_cons 109) string_nil)))))))))))))
nat_eql = (\a0-> \a1-> ((a0::Integer) == a1))
list_take = (\_n_2-> (\_xs_3-> (let _3549 = _xs_3 in (case _3549 of {(0,f) -> u f (list_nil); (1,f) -> u f (\_3550 _3551-> (let _3552 = _n_2 in (if _3552==0 then list_nil else (u (u list_cons _3550) (u (u list_take (_3552-1)) _3551))))); }))))
fm_highlight_tc = (\_code_1-> (\_ix0_2-> (\_ix1_3-> (\_col_4-> (\_row_5-> (\_lft_6-> (\_lin_7-> (\_res_8-> (let _spa_9=3 in (let _3553 = _code_1 in (if null (_3553::String) then (u (u (u fm_highlight_end _col_4) _row_5) (u list_reverse _res_8)) else (let _3554 = ((((fromIntegral (fromEnum (head _3553 :: Char)) :: Word16)::Word16) == 10)) in (if _3554 then (let _stp_12=(u (u (u maybe_extract _lft_6) bool_false) nat_is_zero) in (let _3555 = _stp_12 in (if _3555 then (u (u (u fm_highlight_end _col_4) _row_5) (u list_reverse _res_8)) else (let _siz_13=(u nat_succ (u nat_double _spa_9)) in (let _lft_14=(let _3556 = _ix1_3 in (if _3556==0 then (let _3557 = _lft_6 in (case _3557 of {(0,f) -> u f ((u maybe_some _spa_9)); (1,f) -> u f (\_3558-> (u maybe_some (u nat_pred _3558))); })) else _lft_6)) in (let _ix0_15=(u nat_pred _ix0_2) in (let _ix1_16=(u nat_pred _ix1_3) in (let _col_17=0 in (let _row_18=(u nat_succ _row_5) in (let _res_19=(u (u list_cons (u string_reverse _lin_7)) _res_8) in (let _lin_20=(u string_reverse (u string_flatten (u (u list_cons (u (u (u string_pad_left 4) 32) (u nat_show _row_18))) (u (u list_cons " | ") list_nil)))) in (u (u (u (u (u (u (u (u fm_highlight_tc (tail _3553)) _ix0_15) _ix1_16) _col_17) _row_18) _lft_14) _lin_20) _res_19)))))))))))) else (let _chr_12=(u (u string_cons (fromIntegral (fromEnum (head _3553 :: Char)) :: Word16)) string_nil) in (let _chr_13=(let _3559 = (((u nat_is_zero _ix0_2) && ((not (u nat_is_zero _ix1_3))))) in (if _3559 then (u string_reverse (u (u fm_color "31") (u (u fm_color "4") _chr_12))) else _chr_12)) in (let _res_14=(let _3560 = (((_ix0_2::Integer) == 1)) in (if _3560 then (u (u list_take _spa_9) _res_8) else _res_8)) in (let _ix0_15=(u nat_pred _ix0_2) in (let _ix1_16=(u nat_pred _ix1_3) in (let _col_17=(u nat_succ _col_4) in (let _lin_18=(u string_flatten (u (u list_cons _chr_13) (u (u list_cons _lin_7) list_nil))) in (u (u (u (u (u (u (u (u fm_highlight_tc (tail _3553)) _ix0_15) _ix1_16) _col_17) _row_5) _lft_6) _lin_18) _res_14)))))))))))))))))))))
fm_highlight = (\_code_1-> (\_idx0_2-> (\_idx1_3-> (u (u (u (u (u (u (u (u fm_highlight_tc _code_1) _idx0_2) _idx1_3) 0) 1) maybe_none) (u string_reverse "   1 | ")) list_nil))))
fm_defs_read = (\_file_1-> (\_code_2-> (\_defs_3-> (let _3561 = (u (u (u (u (u fm_parser_file _file_1) _code_2) _defs_3) 0) _code_2) in (case _3561 of {(0,f) -> u f (\_3562 _3563 _3564-> (let _err_7=_3564 in (let _hig_8=(u (u (u fm_highlight _code_2) _3562) (u nat_succ _3562)) in (let _str_9=(u string_flatten (u (u list_cons _err_7) (u (u list_cons "\n") (u (u list_cons _hig_8) list_nil)))) in (u either_left _str_9))))); (1,f) -> u f (\_3565 _3566 _3567-> (u either_right _3567)); })))))
fm_synth_load = (\_name_1-> (\_defs_2-> (let _file_3=(u fm_synth_file_of _name_1) in (u (u (u io_monad (\_m_bind_4-> (\_m_pure_5-> _m_bind_4))) (u io_get_file _file_3)) (\_code_4-> (let _read_5=(u (u (u fm_defs_read _file_3) _code_4) _defs_2) in (let _3568 = _read_5 in (case _3568 of {(0,f) -> u f (\_3569-> (u (u io_monad (\_m_bind_7-> (\_m_pure_8-> _m_pure_8))) maybe_none)); (1,f) -> u f (\_3570-> (let _defs_7=_3570 in (let _3571 = (u (u fm_get _name_1) _defs_7) in (case _3571 of {(0,f) -> u f ((u (u io_monad (\_m_bind_8-> (\_m_pure_9-> _m_pure_9))) maybe_none)); (1,f) -> u f (\_3572-> (u (u io_monad (\_m_bind_9-> (\_m_pure_10-> _m_pure_10))) (u maybe_some _defs_7))); })))); }))))))))
fm_status_wait = (1,\t-> t)
fm_check = (\_v_1-> ())
fm_check_result = (\_value_2-> (\_errors_3-> (0,\t-> t _value_2 _errors_3)))
fm_error_undefined_reference = (\_origin_1-> (\_name_2-> (5,\t-> t _origin_1 _name_2)))
fm_error_waiting = (\_name_1-> (2,\t-> t _name_1))
fm_error_indirect = (\_name_1-> (3,\t-> t _name_1))
maybe_mapped = (\_m_2-> (\_f_4-> (let _3573 = _m_2 in (case _3573 of {(0,f) -> u f (maybe_none); (1,f) -> u f (\_3574-> (u maybe_some (u _f_4 _3574))); }))))
fm_mpath_o = (\_path_1-> (u (u maybe_mapped _path_1) fm_path_o))
fm_mpath_i = (\_path_1-> (u (u maybe_mapped _path_1) fm_path_i))
fm_error_patch = (\_path_1-> (\_term_2-> (4,\t-> t _path_1 _term_2)))
fm_mpath_to_bits = (\_path_1-> (let _3575 = _path_1 in (case _3575 of {(0,f) -> u f (bits_e); (1,f) -> u f (\_3576-> (u _3576 bits_e)); })))
fm_error_type_mismatch = (\_origin_1-> (\_expected_2-> (\_detected_3-> (\_context_4-> (0,\t-> t _origin_1 _expected_2 _detected_3 _context_4)))))
fm_error_show_goal = (\_name_1-> (\_dref_2-> (\_verb_3-> (\_goal_4-> (\_context_5-> (1,\t-> t _name_1 _dref_2 _verb_3 _goal_4 _context_5))))))
fm_term_normalize = (\_term_1-> (\_defs_2-> (let _3577 = (u (u fm_term_reduce _term_1) _defs_2) in (case _3577 of {(0,f) -> u f (\_3578 _3579-> (u (u fm_term_var _3578) _3579)); (1,f) -> u f (\_3580-> (u fm_term_ref _3580)); (2,f) -> u f (fm_term_typ); (3,f) -> u f (\_3581 _3582 _3583 _3584 _3585-> (u (u (u (u (u fm_term_all _3581) _3582) _3583) (u (u fm_term_normalize _3584) _defs_2)) (\_s_8-> (\_x_9-> (u (u fm_term_normalize (u (u _3585 _s_8) _x_9)) _defs_2))))); (4,f) -> u f (\_3586 _3587-> (u (u fm_term_lam _3586) (\_x_5-> (u (u fm_term_normalize (u _3587 _x_5)) _defs_2)))); (5,f) -> u f (\_3588 _3589-> (u (u fm_term_app (u (u fm_term_normalize _3588) _defs_2)) (u (u fm_term_normalize _3589) _defs_2))); (6,f) -> u f (\_3590 _3591 _3592-> (u (u (u fm_term_let _3590) (u (u fm_term_normalize _3591) _defs_2)) (\_x_6-> (u (u fm_term_normalize (u _3592 _x_6)) _defs_2)))); (7,f) -> u f (\_3593 _3594 _3595-> (u (u (u fm_term_def _3593) (u (u fm_term_normalize _3594) _defs_2)) (\_x_6-> (u (u fm_term_normalize (u _3595 _x_6)) _defs_2)))); (8,f) -> u f (\_3596 _3597 _3598-> (u (u (u fm_term_ann _3596) (u (u fm_term_normalize _3597) _defs_2)) (u (u fm_term_normalize _3598) _defs_2))); (9,f) -> u f (\_3599 _3600 _3601-> (u (u (u fm_term_gol _3599) _3600) _3601)); (10,f) -> u f (\_3602-> (u fm_term_hol _3602)); (11,f) -> u f (\_3603-> (u fm_term_nat _3603)); (12,f) -> u f (\_3604-> (u fm_term_chr _3604)); (13,f) -> u f (\_3605-> (u fm_term_str _3605)); (14,f) -> u f (\_3606 _3607 _3608 _3609 _3610 _3611-> _term_1); (15,f) -> u f (\_3612 _3613-> (u (u fm_term_normalize _3613) _defs_2)); }))))
list_tail = (\_xs_2-> (let _3614 = _xs_2 in (case _3614 of {(0,f) -> u f (list_nil); (1,f) -> u f (\_3615 _3616-> _3616); })))
fm_smartmotive_vals_cont = (\_expr_1-> (\_term_2-> (\_args_3-> (\_defs_4-> (let _3617 = (u (u fm_term_reduce _term_2) _defs_4) in (case _3617 of {(0,f) -> u f (\_3618 _3619-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (1,f) -> u f (\_3620-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (2,f) -> u f ((u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (3,f) -> u f (\_3621 _3622 _3623 _3624 _3625-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (4,f) -> u f (\_3626 _3627-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (5,f) -> u f (\_3628 _3629-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _3628) (u (u list_cons _3629) _args_3)) _defs_4)); (6,f) -> u f (\_3630 _3631 _3632-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (7,f) -> u f (\_3633 _3634 _3635-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (8,f) -> u f (\_3636 _3637 _3638-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (9,f) -> u f (\_3639 _3640 _3641-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (10,f) -> u f (\_3642-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (11,f) -> u f (\_3643-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (12,f) -> u f (\_3644-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (13,f) -> u f (\_3645-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (14,f) -> u f (\_3646 _3647 _3648 _3649 _3650 _3651-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (15,f) -> u f (\_3652 _3653-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); }))))))
fm_smartmotive_vals = (\_expr_1-> (\_type_2-> (\_defs_3-> (let _3654 = (u (u fm_term_reduce _type_2) _defs_3) in (case _3654 of {(0,f) -> u f (\_3655 _3656-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (1,f) -> u f (\_3657-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (2,f) -> u f ((u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (3,f) -> u f (\_3658 _3659 _3660 _3661 _3662-> (u (u (u fm_smartmotive_vals _expr_1) (u (u _3662 fm_term_typ) fm_term_typ)) _defs_3)); (4,f) -> u f (\_3663 _3664-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (5,f) -> u f (\_3665 _3666-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (6,f) -> u f (\_3667 _3668 _3669-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (7,f) -> u f (\_3670 _3671 _3672-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (8,f) -> u f (\_3673 _3674 _3675-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (9,f) -> u f (\_3676 _3677 _3678-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (10,f) -> u f (\_3679-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (11,f) -> u f (\_3680-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (12,f) -> u f (\_3681-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (13,f) -> u f (\_3682-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (14,f) -> u f (\_3683 _3684 _3685 _3686 _3687 _3688-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (15,f) -> u f (\_3689 _3690-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); })))))
fm_smartmotive_nams_cont = (\_name_1-> (\_term_2-> (\_binds_3-> (\_defs_4-> (let _3691 = (u (u fm_term_reduce _term_2) _defs_4) in (case _3691 of {(0,f) -> u f (\_3692 _3693-> (u (u list_cons _name_1) (u list_tail _binds_3))); (1,f) -> u f (\_3694-> (u (u list_cons _name_1) (u list_tail _binds_3))); (2,f) -> u f ((u (u list_cons _name_1) (u list_tail _binds_3))); (3,f) -> u f (\_3695 _3696 _3697 _3698 _3699-> (u (u (u (u fm_smartmotive_nams_cont _name_1) (u (u _3699 (u fm_term_ref _3696)) (u fm_term_ref _3697))) (u (u list_cons (u string_flatten (u (u list_cons _name_1) (u (u list_cons ".") (u (u list_cons _3697) list_nil))))) _binds_3)) _defs_4)); (4,f) -> u f (\_3700 _3701-> (u (u list_cons _name_1) (u list_tail _binds_3))); (5,f) -> u f (\_3702 _3703-> (u (u list_cons _name_1) (u list_tail _binds_3))); (6,f) -> u f (\_3704 _3705 _3706-> (u (u list_cons _name_1) (u list_tail _binds_3))); (7,f) -> u f (\_3707 _3708 _3709-> (u (u list_cons _name_1) (u list_tail _binds_3))); (8,f) -> u f (\_3710 _3711 _3712-> (u (u list_cons _name_1) (u list_tail _binds_3))); (9,f) -> u f (\_3713 _3714 _3715-> (u (u list_cons _name_1) (u list_tail _binds_3))); (10,f) -> u f (\_3716-> (u (u list_cons _name_1) (u list_tail _binds_3))); (11,f) -> u f (\_3717-> (u (u list_cons _name_1) (u list_tail _binds_3))); (12,f) -> u f (\_3718-> (u (u list_cons _name_1) (u list_tail _binds_3))); (13,f) -> u f (\_3719-> (u (u list_cons _name_1) (u list_tail _binds_3))); (14,f) -> u f (\_3720 _3721 _3722 _3723 _3724 _3725-> (u (u list_cons _name_1) (u list_tail _binds_3))); (15,f) -> u f (\_3726 _3727-> (u (u list_cons _name_1) (u list_tail _binds_3))); }))))))
fm_smartmotive_nams = (\_name_1-> (\_type_2-> (\_defs_3-> (let _3728 = (u (u fm_term_reduce _type_2) _defs_3) in (case _3728 of {(0,f) -> u f (\_3729 _3730-> list_nil); (1,f) -> u f (\_3731-> list_nil); (2,f) -> u f (list_nil); (3,f) -> u f (\_3732 _3733 _3734 _3735 _3736-> (u (u (u (u fm_smartmotive_nams_cont _name_1) _3735) list_nil) _defs_3)); (4,f) -> u f (\_3737 _3738-> list_nil); (5,f) -> u f (\_3739 _3740-> list_nil); (6,f) -> u f (\_3741 _3742 _3743-> list_nil); (7,f) -> u f (\_3744 _3745 _3746-> list_nil); (8,f) -> u f (\_3747 _3748 _3749-> list_nil); (9,f) -> u f (\_3750 _3751 _3752-> list_nil); (10,f) -> u f (\_3753-> list_nil); (11,f) -> u f (\_3754-> list_nil); (12,f) -> u f (\_3755-> list_nil); (13,f) -> u f (\_3756-> list_nil); (14,f) -> u f (\_3757 _3758 _3759 _3760 _3761 _3762-> list_nil); (15,f) -> u f (\_3763 _3764-> list_nil); })))))
list_zip = (\_as_3-> (\_bs_4-> (let _3765 = _as_3 in (case _3765 of {(0,f) -> u f (list_nil); (1,f) -> u f (\_3766 _3767-> (let _3768 = _bs_4 in (case _3768 of {(0,f) -> u f (list_nil); (1,f) -> u f (\_3769 _3770-> (u (u list_cons (u (u pair_new _3766) _3769)) (u (u list_zip _3767) _3770))); }))); }))))
nat_gte = (\a0-> \a1-> ((a0::Integer) >= a1))
nat_sub = (\a0-> \a1-> ((a0::Integer) - a1))
fm_term_serialize_name = (\_name_1-> (u fm_name_to_bits _name_1))
fm_term_serialize = (\_term_1-> (\_depth_2-> (\_init_3-> (\_diff_4-> (\_x_5-> (let _3771 = _term_1 in (case _3771 of {(0,f) -> u f (\_3772 _3773-> (let _3774 = (((_3773::Integer) >= _init_3)) in (if _3774 then (let _name_8=(u bits_concat (u nat_to_bits (u nat_pred (((_depth_2::Integer) - _3773))))) in (u bits_o (u bits_o (u bits_i (u _name_8 _x_5))))) else (let _name_8=(u bits_concat (u nat_to_bits _3773)) in (u bits_o (u bits_i (u bits_o (u _name_8 _x_5)))))))); (1,f) -> u f (\_3775-> (let _name_7=(u bits_concat (u fm_term_serialize_name _3775)) in (u bits_o (u bits_o (u bits_o (u _name_7 _x_5)))))); (2,f) -> u f ((u bits_o (u bits_i (u bits_i _x_5)))); (3,f) -> u f (\_3776 _3777 _3778 _3779 _3780-> (let _eras_11=(let _3781 = _3776 in (if _3781 then bits_i else bits_o)) in (let _self_12=(u bits_concat (u fm_name_to_bits _3777)) in (let _xtyp_13=(u (u (u (u fm_term_serialize _3779) _depth_2) _init_3) _diff_4) in (let _body_14=(u (u (u (u fm_term_serialize (u (u _3780 (u (u fm_term_var _3777) _depth_2)) (u (u fm_term_var _3778) (u nat_succ _depth_2)))) (u nat_succ (u nat_succ _depth_2))) _init_3) _diff_4) in (u bits_i (u bits_o (u bits_o (u _eras_11 (u _self_12 (u _xtyp_13 (u _body_14 _x_5)))))))))))); (4,f) -> u f (\_3782 _3783-> (let _body_8=(u (u (u (u fm_term_serialize (u _3783 (u (u fm_term_var _3782) _depth_2))) (u nat_succ _depth_2)) _init_3) _diff_4) in (u bits_i (u bits_o (u bits_i (u _body_8 _x_5)))))); (5,f) -> u f (\_3784 _3785-> (let _func_8=(u (u (u (u fm_term_serialize _3784) _depth_2) _init_3) _diff_4) in (let _argm_9=(u (u (u (u fm_term_serialize _3785) _depth_2) _init_3) _diff_4) in (u bits_i (u bits_i (u bits_o (u _func_8 (u _argm_9 _x_5)))))))); (6,f) -> u f (\_3786 _3787 _3788-> (let _expr_9=(u (u (u (u fm_term_serialize _3787) _depth_2) _init_3) _diff_4) in (let _body_10=(u (u (u (u fm_term_serialize (u _3788 (u (u fm_term_var _3786) _depth_2))) (u nat_succ _depth_2)) _init_3) _diff_4) in (u bits_i (u bits_i (u bits_i (u _expr_9 (u _body_10 _x_5)))))))); (7,f) -> u f (\_3789 _3790 _3791-> (u (u (u (u (u fm_term_serialize (u _3791 _3790)) _depth_2) _init_3) _diff_4) _x_5)); (8,f) -> u f (\_3792 _3793 _3794-> (u (u (u (u (u fm_term_serialize _3793) _depth_2) _init_3) _diff_4) _x_5)); (9,f) -> u f (\_3795 _3796 _3797-> (let _name_9=(u bits_concat (u fm_name_to_bits _3795)) in (u bits_o (u bits_o (u bits_o (u _name_9 _x_5)))))); (10,f) -> u f (\_3798-> _x_5); (11,f) -> u f (\_3799-> (u (u (u (u (u fm_term_serialize (u fm_term_unroll_nat _3799)) _depth_2) _init_3) _diff_4) _x_5)); (12,f) -> u f (\_3800-> (u (u (u (u (u fm_term_serialize (u fm_term_unroll_chr _3800)) _depth_2) _init_3) _diff_4) _x_5)); (13,f) -> u f (\_3801-> (u (u (u (u (u fm_term_serialize (u fm_term_unroll_str _3801)) _depth_2) _init_3) _diff_4) _x_5)); (14,f) -> u f (\_3802 _3803 _3804 _3805 _3806 _3807-> (u _diff_4 _x_5)); (15,f) -> u f (\_3808 _3809-> (u (u (u (u (u fm_term_serialize _3809) _depth_2) _init_3) _diff_4) _x_5)); })))))))
bits_eql = (\_a_1-> (\_b_2-> (let _3810 = _a_1 in (case _3810 of {(0,f) -> u f ((let _3811 = _b_2 in (case _3811 of {(0,f) -> u f (bool_true); (1,f) -> u f (\_3812-> bool_false); (2,f) -> u f (\_3813-> bool_false); }))); (1,f) -> u f (\_3814-> (let _3815 = _b_2 in (case _3815 of {(0,f) -> u f (bool_false); (1,f) -> u f (\_3816-> (u (u bits_eql _3814) _3816)); (2,f) -> u f (\_3817-> bool_false); }))); (2,f) -> u f (\_3818-> (let _3819 = _b_2 in (case _3819 of {(0,f) -> u f (bool_false); (1,f) -> u f (\_3820-> bool_false); (2,f) -> u f (\_3821-> (u (u bits_eql _3818) _3821)); }))); }))))
fm_term_identical = (\_a_1-> (\_b_2-> (\_lv_3-> (let _ah_4=(u (u (u (u (u fm_term_serialize _a_1) _lv_3) _lv_3) bits_o) bits_e) in (let _bh_5=(u (u (u (u (u fm_term_serialize _b_2) _lv_3) _lv_3) bits_i) bits_e) in (u (u bits_eql _ah_4) _bh_5))))))
fm_smartmotive_replace = (\_term_1-> (\_from_2-> (\_to_3-> (\_lv_4-> (let _3822 = (u (u (u fm_term_identical _term_1) _from_2) _lv_4) in (if _3822 then _to_3 else (let _3823 = _term_1 in (case _3823 of {(0,f) -> u f (\_3824 _3825-> (u (u fm_term_var _3824) _3825)); (1,f) -> u f (\_3826-> (u fm_term_ref _3826)); (2,f) -> u f (fm_term_typ); (3,f) -> u f (\_3827 _3828 _3829 _3830 _3831-> (let _xtyp_10=(u (u (u (u fm_smartmotive_replace _3830) _from_2) _to_3) _lv_4) in (let _body_11=(u (u _3831 (u fm_term_ref _3828)) (u fm_term_ref _3829)) in (let _body_12=(u (u (u (u fm_smartmotive_replace _body_11) _from_2) _to_3) (u nat_succ (u nat_succ _lv_4))) in (u (u (u (u (u fm_term_all _3827) _3828) _3829) _xtyp_10) (\_s_13-> (\_x_14-> _body_12))))))); (4,f) -> u f (\_3832 _3833-> (let _body_7=(u _3833 (u fm_term_ref _3832)) in (let _body_8=(u (u (u (u fm_smartmotive_replace _body_7) _from_2) _to_3) (u nat_succ _lv_4)) in (u (u fm_term_lam _3832) (\_x_9-> _body_8))))); (5,f) -> u f (\_3834 _3835-> (let _func_7=(u (u (u (u fm_smartmotive_replace _3834) _from_2) _to_3) _lv_4) in (let _argm_8=(u (u (u (u fm_smartmotive_replace _3835) _from_2) _to_3) _lv_4) in (u (u fm_term_app _func_7) _argm_8)))); (6,f) -> u f (\_3836 _3837 _3838-> (let _expr_8=(u (u (u (u fm_smartmotive_replace _3837) _from_2) _to_3) _lv_4) in (let _body_9=(u _3838 (u fm_term_ref _3836)) in (let _body_10=(u (u (u (u fm_smartmotive_replace _body_9) _from_2) _to_3) (u nat_succ _lv_4)) in (u (u (u fm_term_let _3836) _expr_8) (\_x_11-> _body_10)))))); (7,f) -> u f (\_3839 _3840 _3841-> (let _expr_8=(u (u (u (u fm_smartmotive_replace _3840) _from_2) _to_3) _lv_4) in (let _body_9=(u _3841 (u fm_term_ref _3839)) in (let _body_10=(u (u (u (u fm_smartmotive_replace _body_9) _from_2) _to_3) (u nat_succ _lv_4)) in (u (u (u fm_term_def _3839) _expr_8) (\_x_11-> _body_10)))))); (8,f) -> u f (\_3842 _3843 _3844-> (let _term_8=(u (u (u (u fm_smartmotive_replace _3843) _from_2) _to_3) _lv_4) in (let _type_9=(u (u (u (u fm_smartmotive_replace _3844) _from_2) _to_3) _lv_4) in (u (u (u fm_term_ann _3842) _term_8) _type_9)))); (9,f) -> u f (\_3845 _3846 _3847-> _term_1); (10,f) -> u f (\_3848-> _term_1); (11,f) -> u f (\_3849-> _term_1); (12,f) -> u f (\_3850-> _term_1); (13,f) -> u f (\_3851-> _term_1); (14,f) -> u f (\_3852 _3853 _3854 _3855 _3856 _3857-> _term_1); (15,f) -> u f (\_3858 _3859-> (u (u (u (u fm_smartmotive_replace _3859) _from_2) _to_3) _lv_4)); }))))))))
fm_smartmotive_make = (\_name_1-> (\_expr_2-> (\_type_3-> (\_moti_4-> (\_lv_5-> (\_defs_6-> (let _vals_7=(u (u (u fm_smartmotive_vals _expr_2) _type_3) _defs_6) in (let _nams_8=(u (u (u fm_smartmotive_nams _name_1) _type_3) _defs_6) in (let _subs_9=(u (u list_zip _nams_8) _vals_7) in (let _moti_10=(u (u (u list_fold _subs_9) _moti_4) (\_sub_10-> (\_moti_11-> (let _3860 = _sub_10 in (case _3860 of {(0,f) -> u f (\_3861 _3862-> (u (u (u (u fm_smartmotive_replace _moti_11) _3862) (u fm_term_ref _3861)) _lv_5)); }))))) in _moti_10))))))))))
fm_term_desugar_cse_motive = (\_wyth_1-> (\_moti_2-> (let _3863 = _wyth_1 in (case _3863 of {(0,f) -> u f (_moti_2); (1,f) -> u f (\_3864 _3865-> (let _3866 = _3864 in (case _3866 of {(0,f) -> u f (\_3867 _3868 _3869 _3870 _3871 _3872-> (u (u (u (u (u fm_term_all bool_false) "") _3869) _3871) (\_s_11-> (\_x_12-> (u (u fm_term_desugar_cse_motive _3865) _moti_2))))); }))); }))))
string_is_empty = (\_str_1-> (let _3873 = _str_1 in (if null (_3873::String) then bool_true else bool_false)))
fm_term_desugar_cse_argument = (\_name_1-> (\_wyth_2-> (\_type_3-> (\_body_4-> (\_defs_5-> (let _3874 = (u (u fm_term_reduce _type_3) _defs_5) in (case _3874 of {(0,f) -> u f (\_3875 _3876-> (let _3877 = _wyth_2 in (case _3877 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_3878 _3879-> (let _3880 = _3878 in (case _3880 of {(0,f) -> u f (\_3881 _3882 _3883 _3884 _3885 _3886-> (u (u fm_term_lam _3883) (\_x_16-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _3879) _type_3) _body_4) _defs_5)))); }))); }))); (1,f) -> u f (\_3887-> (let _3888 = _wyth_2 in (case _3888 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_3889 _3890-> (let _3891 = _3889 in (case _3891 of {(0,f) -> u f (\_3892 _3893 _3894 _3895 _3896 _3897-> (u (u fm_term_lam _3894) (\_x_15-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _3890) _type_3) _body_4) _defs_5)))); }))); }))); (2,f) -> u f ((let _3898 = _wyth_2 in (case _3898 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_3899 _3900-> (let _3901 = _3899 in (case _3901 of {(0,f) -> u f (\_3902 _3903 _3904 _3905 _3906 _3907-> (u (u fm_term_lam _3904) (\_x_14-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _3900) _type_3) _body_4) _defs_5)))); }))); }))); (3,f) -> u f (\_3908 _3909 _3910 _3911 _3912-> (u (u fm_term_lam (let _3913 = (u string_is_empty _3910) in (if _3913 then _name_1 else (u string_flatten (u (u list_cons _name_1) (u (u list_cons ".") (u (u list_cons _3910) list_nil))))))) (\_x_11-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _wyth_2) (u (u _3912 (u (u fm_term_var _3909) 0)) (u (u fm_term_var _3910) 0))) _body_4) _defs_5)))); (4,f) -> u f (\_3914 _3915-> (let _3916 = _wyth_2 in (case _3916 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_3917 _3918-> (let _3919 = _3917 in (case _3919 of {(0,f) -> u f (\_3920 _3921 _3922 _3923 _3924 _3925-> (u (u fm_term_lam _3922) (\_x_16-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _3918) _type_3) _body_4) _defs_5)))); }))); }))); (5,f) -> u f (\_3926 _3927-> (let _3928 = _wyth_2 in (case _3928 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_3929 _3930-> (let _3931 = _3929 in (case _3931 of {(0,f) -> u f (\_3932 _3933 _3934 _3935 _3936 _3937-> (u (u fm_term_lam _3934) (\_x_16-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _3930) _type_3) _body_4) _defs_5)))); }))); }))); (6,f) -> u f (\_3938 _3939 _3940-> (let _3941 = _wyth_2 in (case _3941 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_3942 _3943-> (let _3944 = _3942 in (case _3944 of {(0,f) -> u f (\_3945 _3946 _3947 _3948 _3949 _3950-> (u (u fm_term_lam _3947) (\_x_17-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _3943) _type_3) _body_4) _defs_5)))); }))); }))); (7,f) -> u f (\_3951 _3952 _3953-> (let _3954 = _wyth_2 in (case _3954 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_3955 _3956-> (let _3957 = _3955 in (case _3957 of {(0,f) -> u f (\_3958 _3959 _3960 _3961 _3962 _3963-> (u (u fm_term_lam _3960) (\_x_17-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _3956) _type_3) _body_4) _defs_5)))); }))); }))); (8,f) -> u f (\_3964 _3965 _3966-> (let _3967 = _wyth_2 in (case _3967 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_3968 _3969-> (let _3970 = _3968 in (case _3970 of {(0,f) -> u f (\_3971 _3972 _3973 _3974 _3975 _3976-> (u (u fm_term_lam _3973) (\_x_17-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _3969) _type_3) _body_4) _defs_5)))); }))); }))); (9,f) -> u f (\_3977 _3978 _3979-> (let _3980 = _wyth_2 in (case _3980 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_3981 _3982-> (let _3983 = _3981 in (case _3983 of {(0,f) -> u f (\_3984 _3985 _3986 _3987 _3988 _3989-> (u (u fm_term_lam _3986) (\_x_17-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _3982) _type_3) _body_4) _defs_5)))); }))); }))); (10,f) -> u f (\_3990-> (let _3991 = _wyth_2 in (case _3991 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_3992 _3993-> (let _3994 = _3992 in (case _3994 of {(0,f) -> u f (\_3995 _3996 _3997 _3998 _3999 _4000-> (u (u fm_term_lam _3997) (\_x_15-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _3993) _type_3) _body_4) _defs_5)))); }))); }))); (11,f) -> u f (\_4001-> (let _4002 = _wyth_2 in (case _4002 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_4003 _4004-> (let _4005 = _4003 in (case _4005 of {(0,f) -> u f (\_4006 _4007 _4008 _4009 _4010 _4011-> (u (u fm_term_lam _4008) (\_x_15-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _4004) _type_3) _body_4) _defs_5)))); }))); }))); (12,f) -> u f (\_4012-> (let _4013 = _wyth_2 in (case _4013 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_4014 _4015-> (let _4016 = _4014 in (case _4016 of {(0,f) -> u f (\_4017 _4018 _4019 _4020 _4021 _4022-> (u (u fm_term_lam _4019) (\_x_15-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _4015) _type_3) _body_4) _defs_5)))); }))); }))); (13,f) -> u f (\_4023-> (let _4024 = _wyth_2 in (case _4024 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_4025 _4026-> (let _4027 = _4025 in (case _4027 of {(0,f) -> u f (\_4028 _4029 _4030 _4031 _4032 _4033-> (u (u fm_term_lam _4030) (\_x_15-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _4026) _type_3) _body_4) _defs_5)))); }))); }))); (14,f) -> u f (\_4034 _4035 _4036 _4037 _4038 _4039-> (let _4040 = _wyth_2 in (case _4040 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_4041 _4042-> (let _4043 = _4041 in (case _4043 of {(0,f) -> u f (\_4044 _4045 _4046 _4047 _4048 _4049-> (u (u fm_term_lam _4046) (\_x_20-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _4042) _type_3) _body_4) _defs_5)))); }))); }))); (15,f) -> u f (\_4050 _4051-> (let _4052 = _wyth_2 in (case _4052 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_4053 _4054-> (let _4055 = _4053 in (case _4055 of {(0,f) -> u f (\_4056 _4057 _4058 _4059 _4060 _4061-> (u (u fm_term_lam _4058) (\_x_16-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _4054) _type_3) _body_4) _defs_5)))); }))); }))); })))))))
maybe_or = (\_a_2-> (\_b_3-> (let _4062 = _a_2 in (case _4062 of {(0,f) -> u f (_b_3); (1,f) -> u f (\_4063-> (u maybe_some _4063)); }))))
fm_term_desugar_cse_cases = (\_expr_1-> (\_name_2-> (\_wyth_3-> (\_cses_4-> (\_type_5-> (\_defs_6-> (\_ctxt_7-> (let _4064 = (u (u fm_term_reduce _type_5) _defs_6) in (case _4064 of {(0,f) -> u f (\_4065 _4066-> (let _expr_10=(u (u (u list_for _wyth_3) _expr_1) (\_defn_10-> (\_expr_11-> (u (u fm_term_app _expr_11) (let _4067 = _defn_10 in (case _4067 of {(0,f) -> u f (\_4068 _4069 _4070 _4071 _4072 _4073-> _4071); })))))) in _expr_10)); (1,f) -> u f (\_4074-> (let _expr_9=(u (u (u list_for _wyth_3) _expr_1) (\_defn_9-> (\_expr_10-> (u (u fm_term_app _expr_10) (let _4075 = _defn_9 in (case _4075 of {(0,f) -> u f (\_4076 _4077 _4078 _4079 _4080 _4081-> _4079); })))))) in _expr_9)); (2,f) -> u f ((let _expr_8=(u (u (u list_for _wyth_3) _expr_1) (\_defn_8-> (\_expr_9-> (u (u fm_term_app _expr_9) (let _4082 = _defn_8 in (case _4082 of {(0,f) -> u f (\_4083 _4084 _4085 _4086 _4087 _4088-> _4086); })))))) in _expr_8)); (3,f) -> u f (\_4089 _4090 _4091 _4092 _4093-> (let _got_13=(u (u maybe_or (u (u fm_get _4091) _cses_4)) (u (u fm_get "_") _cses_4)) in (let _4094 = _got_13 in (case _4094 of {(0,f) -> u f ((let _expr_14=(u (u (u list_for _wyth_3) _expr_1) (\_defn_14-> (\_expr_15-> (let _4095 = _defn_14 in (case _4095 of {(0,f) -> u f (\_4096 _4097 _4098 _4099 _4100 _4101-> (u (u fm_term_app _expr_15) _4099)); }))))) in _expr_14)); (1,f) -> u f (\_4102-> (let _argm_15=(u (u (u (u (u fm_term_desugar_cse_argument _name_2) _wyth_3) _4092) _4102) _defs_6) in (let _expr_16=(u (u fm_term_app _expr_1) _argm_15) in (let _type_17=(u (u _4093 (u (u fm_term_var _4090) 0)) (u (u fm_term_var _4091) 0)) in (u (u (u (u (u (u (u fm_term_desugar_cse_cases _expr_16) _name_2) _wyth_3) _cses_4) _type_17) _defs_6) _ctxt_7))))); })))); (4,f) -> u f (\_4103 _4104-> (let _expr_10=(u (u (u list_for _wyth_3) _expr_1) (\_defn_10-> (\_expr_11-> (u (u fm_term_app _expr_11) (let _4105 = _defn_10 in (case _4105 of {(0,f) -> u f (\_4106 _4107 _4108 _4109 _4110 _4111-> _4109); })))))) in _expr_10)); (5,f) -> u f (\_4112 _4113-> (let _expr_10=(u (u (u list_for _wyth_3) _expr_1) (\_defn_10-> (\_expr_11-> (u (u fm_term_app _expr_11) (let _4114 = _defn_10 in (case _4114 of {(0,f) -> u f (\_4115 _4116 _4117 _4118 _4119 _4120-> _4118); })))))) in _expr_10)); (6,f) -> u f (\_4121 _4122 _4123-> (let _expr_11=(u (u (u list_for _wyth_3) _expr_1) (\_defn_11-> (\_expr_12-> (u (u fm_term_app _expr_12) (let _4124 = _defn_11 in (case _4124 of {(0,f) -> u f (\_4125 _4126 _4127 _4128 _4129 _4130-> _4128); })))))) in _expr_11)); (7,f) -> u f (\_4131 _4132 _4133-> (let _expr_11=(u (u (u list_for _wyth_3) _expr_1) (\_defn_11-> (\_expr_12-> (u (u fm_term_app _expr_12) (let _4134 = _defn_11 in (case _4134 of {(0,f) -> u f (\_4135 _4136 _4137 _4138 _4139 _4140-> _4138); })))))) in _expr_11)); (8,f) -> u f (\_4141 _4142 _4143-> (let _expr_11=(u (u (u list_for _wyth_3) _expr_1) (\_defn_11-> (\_expr_12-> (u (u fm_term_app _expr_12) (let _4144 = _defn_11 in (case _4144 of {(0,f) -> u f (\_4145 _4146 _4147 _4148 _4149 _4150-> _4148); })))))) in _expr_11)); (9,f) -> u f (\_4151 _4152 _4153-> (let _expr_11=(u (u (u list_for _wyth_3) _expr_1) (\_defn_11-> (\_expr_12-> (u (u fm_term_app _expr_12) (let _4154 = _defn_11 in (case _4154 of {(0,f) -> u f (\_4155 _4156 _4157 _4158 _4159 _4160-> _4158); })))))) in _expr_11)); (10,f) -> u f (\_4161-> (let _expr_9=(u (u (u list_for _wyth_3) _expr_1) (\_defn_9-> (\_expr_10-> (u (u fm_term_app _expr_10) (let _4162 = _defn_9 in (case _4162 of {(0,f) -> u f (\_4163 _4164 _4165 _4166 _4167 _4168-> _4166); })))))) in _expr_9)); (11,f) -> u f (\_4169-> (let _expr_9=(u (u (u list_for _wyth_3) _expr_1) (\_defn_9-> (\_expr_10-> (u (u fm_term_app _expr_10) (let _4170 = _defn_9 in (case _4170 of {(0,f) -> u f (\_4171 _4172 _4173 _4174 _4175 _4176-> _4174); })))))) in _expr_9)); (12,f) -> u f (\_4177-> (let _expr_9=(u (u (u list_for _wyth_3) _expr_1) (\_defn_9-> (\_expr_10-> (u (u fm_term_app _expr_10) (let _4178 = _defn_9 in (case _4178 of {(0,f) -> u f (\_4179 _4180 _4181 _4182 _4183 _4184-> _4182); })))))) in _expr_9)); (13,f) -> u f (\_4185-> (let _expr_9=(u (u (u list_for _wyth_3) _expr_1) (\_defn_9-> (\_expr_10-> (u (u fm_term_app _expr_10) (let _4186 = _defn_9 in (case _4186 of {(0,f) -> u f (\_4187 _4188 _4189 _4190 _4191 _4192-> _4190); })))))) in _expr_9)); (14,f) -> u f (\_4193 _4194 _4195 _4196 _4197 _4198-> (let _expr_14=(u (u (u list_for _wyth_3) _expr_1) (\_defn_14-> (\_expr_15-> (u (u fm_term_app _expr_15) (let _4199 = _defn_14 in (case _4199 of {(0,f) -> u f (\_4200 _4201 _4202 _4203 _4204 _4205-> _4203); })))))) in _expr_14)); (15,f) -> u f (\_4206 _4207-> (let _expr_10=(u (u (u list_for _wyth_3) _expr_1) (\_defn_10-> (\_expr_11-> (u (u fm_term_app _expr_11) (let _4208 = _defn_10 in (case _4208 of {(0,f) -> u f (\_4209 _4210 _4211 _4212 _4213 _4214-> _4212); })))))) in _expr_10)); })))))))))
fm_term_desugar_cse = (\_expr_1-> (\_name_2-> (\_wyth_3-> (\_cses_4-> (\_moti_5-> (\_type_6-> (\_defs_7-> (\_ctxt_8-> (let _4215 = (u (u fm_term_reduce _type_6) _defs_7) in (case _4215 of {(0,f) -> u f (\_4216 _4217-> maybe_none); (1,f) -> u f (\_4218-> maybe_none); (2,f) -> u f (maybe_none); (3,f) -> u f (\_4219 _4220 _4221 _4222 _4223-> (let _moti_14=(u (u fm_term_desugar_cse_motive _wyth_3) _moti_5) in (let _argm_15=(u (u (u (u (u fm_term_desugar_cse_argument _name_2) list_nil) _4222) _moti_14) _defs_7) in (let _expr_16=(u (u fm_term_app _expr_1) _argm_15) in (let _type_17=(u (u _4223 (u (u fm_term_var _4220) 0)) (u (u fm_term_var _4221) 0)) in (u maybe_some (u (u (u (u (u (u (u fm_term_desugar_cse_cases _expr_16) _name_2) _wyth_3) _cses_4) _type_17) _defs_7) _ctxt_8))))))); (4,f) -> u f (\_4224 _4225-> maybe_none); (5,f) -> u f (\_4226 _4227-> maybe_none); (6,f) -> u f (\_4228 _4229 _4230-> maybe_none); (7,f) -> u f (\_4231 _4232 _4233-> maybe_none); (8,f) -> u f (\_4234 _4235 _4236-> maybe_none); (9,f) -> u f (\_4237 _4238 _4239-> maybe_none); (10,f) -> u f (\_4240-> maybe_none); (11,f) -> u f (\_4241-> maybe_none); (12,f) -> u f (\_4242-> maybe_none); (13,f) -> u f (\_4243-> maybe_none); (14,f) -> u f (\_4244 _4245 _4246 _4247 _4248 _4249-> maybe_none); (15,f) -> u f (\_4250 _4251-> maybe_none); }))))))))))
fm_error_cant_infer = (\_origin_1-> (\_term_2-> (\_context_3-> (6,\t-> t _origin_1 _term_2 _context_3))))
set_has = (\_bits_1-> (\_set_2-> (let _4252 = (u (u map_get _bits_1) _set_2) in (case _4252 of {(0,f) -> u f (bool_false); (1,f) -> u f (\_4253-> bool_true); }))))
bool_or = (\a0-> \a1-> (a0 || a1))
fm_term_has_holes = (\_term_1-> (let _4254 = _term_1 in (case _4254 of {(0,f) -> u f (\_4255 _4256-> bool_false); (1,f) -> u f (\_4257-> bool_false); (2,f) -> u f (bool_false); (3,f) -> u f (\_4258 _4259 _4260 _4261 _4262-> (((u fm_term_has_holes _4261) || (u fm_term_has_holes (u (u _4262 fm_term_typ) fm_term_typ))))); (4,f) -> u f (\_4263 _4264-> (u fm_term_has_holes (u _4264 fm_term_typ))); (5,f) -> u f (\_4265 _4266-> (((u fm_term_has_holes _4265) || (u fm_term_has_holes _4266)))); (6,f) -> u f (\_4267 _4268 _4269-> (((u fm_term_has_holes _4268) || (u fm_term_has_holes (u _4269 fm_term_typ))))); (7,f) -> u f (\_4270 _4271 _4272-> (((u fm_term_has_holes _4271) || (u fm_term_has_holes (u _4272 fm_term_typ))))); (8,f) -> u f (\_4273 _4274 _4275-> (((u fm_term_has_holes _4274) || (u fm_term_has_holes _4275)))); (9,f) -> u f (\_4276 _4277 _4278-> bool_false); (10,f) -> u f (\_4279-> bool_true); (11,f) -> u f (\_4280-> bool_false); (12,f) -> u f (\_4281-> bool_false); (13,f) -> u f (\_4282-> bool_false); (14,f) -> u f (\_4283 _4284 _4285 _4286 _4287 _4288-> bool_false); (15,f) -> u f (\_4289 _4290-> (u fm_term_has_holes _4290)); })))
fm_term_equal_hole = (\_path_1-> (\_term_2-> (let _4291 = _term_2 in (case _4291 of {(0,f) -> u f (\_4292 _4293-> (let _4294 = (u fm_term_has_holes _term_2) in (if _4294 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); (1,f) -> u f (\_4295-> (let _4296 = (u fm_term_has_holes _term_2) in (if _4296 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); (2,f) -> u f ((let _4297 = (u fm_term_has_holes _term_2) in (if _4297 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); (3,f) -> u f (\_4298 _4299 _4300 _4301 _4302-> (let _4303 = (u fm_term_has_holes _term_2) in (if _4303 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); (4,f) -> u f (\_4304 _4305-> (let _4306 = (u fm_term_has_holes _term_2) in (if _4306 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); (5,f) -> u f (\_4307 _4308-> (let _4309 = (u fm_term_has_holes _term_2) in (if _4309 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); (6,f) -> u f (\_4310 _4311 _4312-> (let _4313 = (u fm_term_has_holes _term_2) in (if _4313 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); (7,f) -> u f (\_4314 _4315 _4316-> (let _4317 = (u fm_term_has_holes _term_2) in (if _4317 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); (8,f) -> u f (\_4318 _4319 _4320-> (let _4321 = (u fm_term_has_holes _term_2) in (if _4321 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); (9,f) -> u f (\_4322 _4323 _4324-> (let _4325 = (u fm_term_has_holes _term_2) in (if _4325 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); (10,f) -> u f (\_4326-> (u (u fm_check_result (u maybe_some bool_true)) list_nil)); (11,f) -> u f (\_4327-> (let _4328 = (u fm_term_has_holes _term_2) in (if _4328 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); (12,f) -> u f (\_4329-> (let _4330 = (u fm_term_has_holes _term_2) in (if _4330 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); (13,f) -> u f (\_4331-> (let _4332 = (u fm_term_has_holes _term_2) in (if _4332 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); (14,f) -> u f (\_4333 _4334 _4335 _4336 _4337 _4338-> (let _4339 = (u fm_term_has_holes _term_2) in (if _4339 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); (15,f) -> u f (\_4340 _4341-> (let _4342 = (u fm_term_has_holes _term_2) in (if _4342 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); }))))
fm_term_equal_extra_holes = (\_a_1-> (\_b_2-> (let _4343 = _a_1 in (case _4343 of {(0,f) -> u f (\_4344 _4345-> (let _4346 = _b_2 in (case _4346 of {(0,f) -> u f (\_4347 _4348-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (1,f) -> u f (\_4349-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some unit_new)) list_nil)); (3,f) -> u f (\_4350 _4351 _4352 _4353 _4354-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (4,f) -> u f (\_4355 _4356-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (5,f) -> u f (\_4357 _4358-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (6,f) -> u f (\_4359 _4360 _4361-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (7,f) -> u f (\_4362 _4363 _4364-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (8,f) -> u f (\_4365 _4366 _4367-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (9,f) -> u f (\_4368 _4369 _4370-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (10,f) -> u f (\_4371-> (let _4372 = (u (u fm_term_equal_hole _4371) _a_1) in (case _4372 of {(0,f) -> u f (\_4373 _4374-> (let _4375 = _4373 in (case _4375 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _4374)); (1,f) -> u f (\_4376-> (let _4377 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _4377 of {(0,f) -> u f (\_4378 _4379-> (u (u fm_check_result _4378) (u (u list_concat _4374) _4379))); }))); }))); }))); (11,f) -> u f (\_4380-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (12,f) -> u f (\_4381-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (13,f) -> u f (\_4382-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (14,f) -> u f (\_4383 _4384 _4385 _4386 _4387 _4388-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (15,f) -> u f (\_4389 _4390-> (u (u fm_term_equal_extra_holes _a_1) _4390)); }))); (1,f) -> u f (\_4391-> (let _4392 = _b_2 in (case _4392 of {(0,f) -> u f (\_4393 _4394-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (1,f) -> u f (\_4395-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some unit_new)) list_nil)); (3,f) -> u f (\_4396 _4397 _4398 _4399 _4400-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (4,f) -> u f (\_4401 _4402-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (5,f) -> u f (\_4403 _4404-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (6,f) -> u f (\_4405 _4406 _4407-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (7,f) -> u f (\_4408 _4409 _4410-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (8,f) -> u f (\_4411 _4412 _4413-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (9,f) -> u f (\_4414 _4415 _4416-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (10,f) -> u f (\_4417-> (let _4418 = (u (u fm_term_equal_hole _4417) _a_1) in (case _4418 of {(0,f) -> u f (\_4419 _4420-> (let _4421 = _4419 in (case _4421 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _4420)); (1,f) -> u f (\_4422-> (let _4423 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _4423 of {(0,f) -> u f (\_4424 _4425-> (u (u fm_check_result _4424) (u (u list_concat _4420) _4425))); }))); }))); }))); (11,f) -> u f (\_4426-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (12,f) -> u f (\_4427-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (13,f) -> u f (\_4428-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (14,f) -> u f (\_4429 _4430 _4431 _4432 _4433 _4434-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (15,f) -> u f (\_4435 _4436-> (u (u fm_term_equal_extra_holes _a_1) _4436)); }))); (2,f) -> u f ((let _4437 = _b_2 in (case _4437 of {(0,f) -> u f (\_4438 _4439-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (1,f) -> u f (\_4440-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some unit_new)) list_nil)); (3,f) -> u f (\_4441 _4442 _4443 _4444 _4445-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (4,f) -> u f (\_4446 _4447-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (5,f) -> u f (\_4448 _4449-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (6,f) -> u f (\_4450 _4451 _4452-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (7,f) -> u f (\_4453 _4454 _4455-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (8,f) -> u f (\_4456 _4457 _4458-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (9,f) -> u f (\_4459 _4460 _4461-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (10,f) -> u f (\_4462-> (let _4463 = (u (u fm_term_equal_hole _4462) _a_1) in (case _4463 of {(0,f) -> u f (\_4464 _4465-> (let _4466 = _4464 in (case _4466 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _4465)); (1,f) -> u f (\_4467-> (let _4468 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _4468 of {(0,f) -> u f (\_4469 _4470-> (u (u fm_check_result _4469) (u (u list_concat _4465) _4470))); }))); }))); }))); (11,f) -> u f (\_4471-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (12,f) -> u f (\_4472-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (13,f) -> u f (\_4473-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (14,f) -> u f (\_4474 _4475 _4476 _4477 _4478 _4479-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (15,f) -> u f (\_4480 _4481-> (u (u fm_term_equal_extra_holes _a_1) _4481)); }))); (3,f) -> u f (\_4482 _4483 _4484 _4485 _4486-> (let _4487 = _b_2 in (case _4487 of {(0,f) -> u f (\_4488 _4489-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (1,f) -> u f (\_4490-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some unit_new)) list_nil)); (3,f) -> u f (\_4491 _4492 _4493 _4494 _4495-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (4,f) -> u f (\_4496 _4497-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (5,f) -> u f (\_4498 _4499-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (6,f) -> u f (\_4500 _4501 _4502-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (7,f) -> u f (\_4503 _4504 _4505-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (8,f) -> u f (\_4506 _4507 _4508-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (9,f) -> u f (\_4509 _4510 _4511-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (10,f) -> u f (\_4512-> (let _4513 = (u (u fm_term_equal_hole _4512) _a_1) in (case _4513 of {(0,f) -> u f (\_4514 _4515-> (let _4516 = _4514 in (case _4516 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _4515)); (1,f) -> u f (\_4517-> (let _4518 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _4518 of {(0,f) -> u f (\_4519 _4520-> (u (u fm_check_result _4519) (u (u list_concat _4515) _4520))); }))); }))); }))); (11,f) -> u f (\_4521-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (12,f) -> u f (\_4522-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (13,f) -> u f (\_4523-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (14,f) -> u f (\_4524 _4525 _4526 _4527 _4528 _4529-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (15,f) -> u f (\_4530 _4531-> (u (u fm_term_equal_extra_holes _a_1) _4531)); }))); (4,f) -> u f (\_4532 _4533-> (let _4534 = _b_2 in (case _4534 of {(0,f) -> u f (\_4535 _4536-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (1,f) -> u f (\_4537-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some unit_new)) list_nil)); (3,f) -> u f (\_4538 _4539 _4540 _4541 _4542-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (4,f) -> u f (\_4543 _4544-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (5,f) -> u f (\_4545 _4546-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (6,f) -> u f (\_4547 _4548 _4549-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (7,f) -> u f (\_4550 _4551 _4552-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (8,f) -> u f (\_4553 _4554 _4555-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (9,f) -> u f (\_4556 _4557 _4558-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (10,f) -> u f (\_4559-> (let _4560 = (u (u fm_term_equal_hole _4559) _a_1) in (case _4560 of {(0,f) -> u f (\_4561 _4562-> (let _4563 = _4561 in (case _4563 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _4562)); (1,f) -> u f (\_4564-> (let _4565 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _4565 of {(0,f) -> u f (\_4566 _4567-> (u (u fm_check_result _4566) (u (u list_concat _4562) _4567))); }))); }))); }))); (11,f) -> u f (\_4568-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (12,f) -> u f (\_4569-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (13,f) -> u f (\_4570-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (14,f) -> u f (\_4571 _4572 _4573 _4574 _4575 _4576-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (15,f) -> u f (\_4577 _4578-> (u (u fm_term_equal_extra_holes _a_1) _4578)); }))); (5,f) -> u f (\_4579 _4580-> (let _4581 = _b_2 in (case _4581 of {(0,f) -> u f (\_4582 _4583-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (1,f) -> u f (\_4584-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some unit_new)) list_nil)); (3,f) -> u f (\_4585 _4586 _4587 _4588 _4589-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (4,f) -> u f (\_4590 _4591-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (5,f) -> u f (\_4592 _4593-> (let _4594 = (u (u fm_term_equal_extra_holes _4579) _4592) in (case _4594 of {(0,f) -> u f (\_4595 _4596-> (let _4597 = _4595 in (case _4597 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _4596)); (1,f) -> u f (\_4598-> (let _4599 = (u (u fm_term_equal_extra_holes _4580) _4593) in (case _4599 of {(0,f) -> u f (\_4600 _4601-> (u (u fm_check_result _4600) (u (u list_concat _4596) _4601))); }))); }))); }))); (6,f) -> u f (\_4602 _4603 _4604-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (7,f) -> u f (\_4605 _4606 _4607-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (8,f) -> u f (\_4608 _4609 _4610-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (9,f) -> u f (\_4611 _4612 _4613-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (10,f) -> u f (\_4614-> (let _4615 = (u (u fm_term_equal_hole _4614) _a_1) in (case _4615 of {(0,f) -> u f (\_4616 _4617-> (let _4618 = _4616 in (case _4618 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _4617)); (1,f) -> u f (\_4619-> (let _4620 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _4620 of {(0,f) -> u f (\_4621 _4622-> (u (u fm_check_result _4621) (u (u list_concat _4617) _4622))); }))); }))); }))); (11,f) -> u f (\_4623-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (12,f) -> u f (\_4624-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (13,f) -> u f (\_4625-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (14,f) -> u f (\_4626 _4627 _4628 _4629 _4630 _4631-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (15,f) -> u f (\_4632 _4633-> (u (u fm_term_equal_extra_holes _a_1) _4633)); }))); (6,f) -> u f (\_4634 _4635 _4636-> (let _4637 = _b_2 in (case _4637 of {(0,f) -> u f (\_4638 _4639-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (1,f) -> u f (\_4640-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some unit_new)) list_nil)); (3,f) -> u f (\_4641 _4642 _4643 _4644 _4645-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (4,f) -> u f (\_4646 _4647-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (5,f) -> u f (\_4648 _4649-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (6,f) -> u f (\_4650 _4651 _4652-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (7,f) -> u f (\_4653 _4654 _4655-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (8,f) -> u f (\_4656 _4657 _4658-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (9,f) -> u f (\_4659 _4660 _4661-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (10,f) -> u f (\_4662-> (let _4663 = (u (u fm_term_equal_hole _4662) _a_1) in (case _4663 of {(0,f) -> u f (\_4664 _4665-> (let _4666 = _4664 in (case _4666 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _4665)); (1,f) -> u f (\_4667-> (let _4668 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _4668 of {(0,f) -> u f (\_4669 _4670-> (u (u fm_check_result _4669) (u (u list_concat _4665) _4670))); }))); }))); }))); (11,f) -> u f (\_4671-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (12,f) -> u f (\_4672-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (13,f) -> u f (\_4673-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (14,f) -> u f (\_4674 _4675 _4676 _4677 _4678 _4679-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (15,f) -> u f (\_4680 _4681-> (u (u fm_term_equal_extra_holes _a_1) _4681)); }))); (7,f) -> u f (\_4682 _4683 _4684-> (let _4685 = _b_2 in (case _4685 of {(0,f) -> u f (\_4686 _4687-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (1,f) -> u f (\_4688-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some unit_new)) list_nil)); (3,f) -> u f (\_4689 _4690 _4691 _4692 _4693-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (4,f) -> u f (\_4694 _4695-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (5,f) -> u f (\_4696 _4697-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (6,f) -> u f (\_4698 _4699 _4700-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (7,f) -> u f (\_4701 _4702 _4703-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (8,f) -> u f (\_4704 _4705 _4706-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (9,f) -> u f (\_4707 _4708 _4709-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (10,f) -> u f (\_4710-> (let _4711 = (u (u fm_term_equal_hole _4710) _a_1) in (case _4711 of {(0,f) -> u f (\_4712 _4713-> (let _4714 = _4712 in (case _4714 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _4713)); (1,f) -> u f (\_4715-> (let _4716 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _4716 of {(0,f) -> u f (\_4717 _4718-> (u (u fm_check_result _4717) (u (u list_concat _4713) _4718))); }))); }))); }))); (11,f) -> u f (\_4719-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (12,f) -> u f (\_4720-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (13,f) -> u f (\_4721-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (14,f) -> u f (\_4722 _4723 _4724 _4725 _4726 _4727-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (15,f) -> u f (\_4728 _4729-> (u (u fm_term_equal_extra_holes _a_1) _4729)); }))); (8,f) -> u f (\_4730 _4731 _4732-> (let _4733 = _b_2 in (case _4733 of {(0,f) -> u f (\_4734 _4735-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (1,f) -> u f (\_4736-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some unit_new)) list_nil)); (3,f) -> u f (\_4737 _4738 _4739 _4740 _4741-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (4,f) -> u f (\_4742 _4743-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (5,f) -> u f (\_4744 _4745-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (6,f) -> u f (\_4746 _4747 _4748-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (7,f) -> u f (\_4749 _4750 _4751-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (8,f) -> u f (\_4752 _4753 _4754-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (9,f) -> u f (\_4755 _4756 _4757-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (10,f) -> u f (\_4758-> (let _4759 = (u (u fm_term_equal_hole _4758) _a_1) in (case _4759 of {(0,f) -> u f (\_4760 _4761-> (let _4762 = _4760 in (case _4762 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _4761)); (1,f) -> u f (\_4763-> (let _4764 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _4764 of {(0,f) -> u f (\_4765 _4766-> (u (u fm_check_result _4765) (u (u list_concat _4761) _4766))); }))); }))); }))); (11,f) -> u f (\_4767-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (12,f) -> u f (\_4768-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (13,f) -> u f (\_4769-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (14,f) -> u f (\_4770 _4771 _4772 _4773 _4774 _4775-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (15,f) -> u f (\_4776 _4777-> (u (u fm_term_equal_extra_holes _a_1) _4777)); }))); (9,f) -> u f (\_4778 _4779 _4780-> (let _4781 = _b_2 in (case _4781 of {(0,f) -> u f (\_4782 _4783-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (1,f) -> u f (\_4784-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some unit_new)) list_nil)); (3,f) -> u f (\_4785 _4786 _4787 _4788 _4789-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (4,f) -> u f (\_4790 _4791-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (5,f) -> u f (\_4792 _4793-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (6,f) -> u f (\_4794 _4795 _4796-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (7,f) -> u f (\_4797 _4798 _4799-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (8,f) -> u f (\_4800 _4801 _4802-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (9,f) -> u f (\_4803 _4804 _4805-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (10,f) -> u f (\_4806-> (let _4807 = (u (u fm_term_equal_hole _4806) _a_1) in (case _4807 of {(0,f) -> u f (\_4808 _4809-> (let _4810 = _4808 in (case _4810 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _4809)); (1,f) -> u f (\_4811-> (let _4812 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _4812 of {(0,f) -> u f (\_4813 _4814-> (u (u fm_check_result _4813) (u (u list_concat _4809) _4814))); }))); }))); }))); (11,f) -> u f (\_4815-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (12,f) -> u f (\_4816-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (13,f) -> u f (\_4817-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (14,f) -> u f (\_4818 _4819 _4820 _4821 _4822 _4823-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (15,f) -> u f (\_4824 _4825-> (u (u fm_term_equal_extra_holes _a_1) _4825)); }))); (10,f) -> u f (\_4826-> (let _4827 = (u (u fm_term_equal_hole _4826) _b_2) in (case _4827 of {(0,f) -> u f (\_4828 _4829-> (let _4830 = _4828 in (case _4830 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _4829)); (1,f) -> u f (\_4831-> (let _4832 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _4832 of {(0,f) -> u f (\_4833 _4834-> (u (u fm_check_result _4833) (u (u list_concat _4829) _4834))); }))); }))); }))); (11,f) -> u f (\_4835-> (let _4836 = _b_2 in (case _4836 of {(0,f) -> u f (\_4837 _4838-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (1,f) -> u f (\_4839-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some unit_new)) list_nil)); (3,f) -> u f (\_4840 _4841 _4842 _4843 _4844-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (4,f) -> u f (\_4845 _4846-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (5,f) -> u f (\_4847 _4848-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (6,f) -> u f (\_4849 _4850 _4851-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (7,f) -> u f (\_4852 _4853 _4854-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (8,f) -> u f (\_4855 _4856 _4857-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (9,f) -> u f (\_4858 _4859 _4860-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (10,f) -> u f (\_4861-> (let _4862 = (u (u fm_term_equal_hole _4861) _a_1) in (case _4862 of {(0,f) -> u f (\_4863 _4864-> (let _4865 = _4863 in (case _4865 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _4864)); (1,f) -> u f (\_4866-> (let _4867 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _4867 of {(0,f) -> u f (\_4868 _4869-> (u (u fm_check_result _4868) (u (u list_concat _4864) _4869))); }))); }))); }))); (11,f) -> u f (\_4870-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (12,f) -> u f (\_4871-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (13,f) -> u f (\_4872-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (14,f) -> u f (\_4873 _4874 _4875 _4876 _4877 _4878-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (15,f) -> u f (\_4879 _4880-> (u (u fm_term_equal_extra_holes _a_1) _4880)); }))); (12,f) -> u f (\_4881-> (let _4882 = _b_2 in (case _4882 of {(0,f) -> u f (\_4883 _4884-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (1,f) -> u f (\_4885-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some unit_new)) list_nil)); (3,f) -> u f (\_4886 _4887 _4888 _4889 _4890-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (4,f) -> u f (\_4891 _4892-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (5,f) -> u f (\_4893 _4894-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (6,f) -> u f (\_4895 _4896 _4897-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (7,f) -> u f (\_4898 _4899 _4900-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (8,f) -> u f (\_4901 _4902 _4903-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (9,f) -> u f (\_4904 _4905 _4906-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (10,f) -> u f (\_4907-> (let _4908 = (u (u fm_term_equal_hole _4907) _a_1) in (case _4908 of {(0,f) -> u f (\_4909 _4910-> (let _4911 = _4909 in (case _4911 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _4910)); (1,f) -> u f (\_4912-> (let _4913 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _4913 of {(0,f) -> u f (\_4914 _4915-> (u (u fm_check_result _4914) (u (u list_concat _4910) _4915))); }))); }))); }))); (11,f) -> u f (\_4916-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (12,f) -> u f (\_4917-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (13,f) -> u f (\_4918-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (14,f) -> u f (\_4919 _4920 _4921 _4922 _4923 _4924-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (15,f) -> u f (\_4925 _4926-> (u (u fm_term_equal_extra_holes _a_1) _4926)); }))); (13,f) -> u f (\_4927-> (let _4928 = _b_2 in (case _4928 of {(0,f) -> u f (\_4929 _4930-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (1,f) -> u f (\_4931-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some unit_new)) list_nil)); (3,f) -> u f (\_4932 _4933 _4934 _4935 _4936-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (4,f) -> u f (\_4937 _4938-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (5,f) -> u f (\_4939 _4940-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (6,f) -> u f (\_4941 _4942 _4943-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (7,f) -> u f (\_4944 _4945 _4946-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (8,f) -> u f (\_4947 _4948 _4949-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (9,f) -> u f (\_4950 _4951 _4952-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (10,f) -> u f (\_4953-> (let _4954 = (u (u fm_term_equal_hole _4953) _a_1) in (case _4954 of {(0,f) -> u f (\_4955 _4956-> (let _4957 = _4955 in (case _4957 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _4956)); (1,f) -> u f (\_4958-> (let _4959 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _4959 of {(0,f) -> u f (\_4960 _4961-> (u (u fm_check_result _4960) (u (u list_concat _4956) _4961))); }))); }))); }))); (11,f) -> u f (\_4962-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (12,f) -> u f (\_4963-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (13,f) -> u f (\_4964-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (14,f) -> u f (\_4965 _4966 _4967 _4968 _4969 _4970-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (15,f) -> u f (\_4971 _4972-> (u (u fm_term_equal_extra_holes _a_1) _4972)); }))); (14,f) -> u f (\_4973 _4974 _4975 _4976 _4977 _4978-> (let _4979 = _b_2 in (case _4979 of {(0,f) -> u f (\_4980 _4981-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (1,f) -> u f (\_4982-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some unit_new)) list_nil)); (3,f) -> u f (\_4983 _4984 _4985 _4986 _4987-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (4,f) -> u f (\_4988 _4989-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (5,f) -> u f (\_4990 _4991-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (6,f) -> u f (\_4992 _4993 _4994-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (7,f) -> u f (\_4995 _4996 _4997-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (8,f) -> u f (\_4998 _4999 _5000-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (9,f) -> u f (\_5001 _5002 _5003-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (10,f) -> u f (\_5004-> (let _5005 = (u (u fm_term_equal_hole _5004) _a_1) in (case _5005 of {(0,f) -> u f (\_5006 _5007-> (let _5008 = _5006 in (case _5008 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5007)); (1,f) -> u f (\_5009-> (let _5010 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _5010 of {(0,f) -> u f (\_5011 _5012-> (u (u fm_check_result _5011) (u (u list_concat _5007) _5012))); }))); }))); }))); (11,f) -> u f (\_5013-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (12,f) -> u f (\_5014-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (13,f) -> u f (\_5015-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (14,f) -> u f (\_5016 _5017 _5018 _5019 _5020 _5021-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (15,f) -> u f (\_5022 _5023-> (u (u fm_term_equal_extra_holes _a_1) _5023)); }))); (15,f) -> u f (\_5024 _5025-> (u (u fm_term_equal_extra_holes _5025) _b_2)); }))))
set_set = (\_bits_1-> (\_set_2-> (u (u (u map_set _bits_1) unit_new) _set_2)))
bool_eql = (\_a_1-> (\_b_2-> (let _5026 = _a_1 in (if _5026 then _b_2 else ((not _b_2))))))
fm_term_equal = (\_a_1-> (\_b_2-> (\_defs_3-> (\_lv_4-> (\_seen_5-> (let _ah_6=(u (u (u (u (u fm_term_serialize (u (u fm_term_reduce _a_1) map_new)) _lv_4) _lv_4) bits_o) bits_e) in (let _bh_7=(u (u (u (u (u fm_term_serialize (u (u fm_term_reduce _b_2) map_new)) _lv_4) _lv_4) bits_i) bits_e) in (let _5027 = (u (u bits_eql _ah_6) _bh_7) in (if _5027 then (u (u fm_check_result (u maybe_some bool_true)) list_nil) else (let _a1_8=(u (u fm_term_reduce _a_1) _defs_3) in (let _b1_9=(u (u fm_term_reduce _b_2) _defs_3) in (let _ah_10=(u (u (u (u (u fm_term_serialize _a1_8) _lv_4) _lv_4) bits_o) bits_e) in (let _bh_11=(u (u (u (u (u fm_term_serialize _b1_9) _lv_4) _lv_4) bits_i) bits_e) in (let _5028 = (u (u bits_eql _ah_10) _bh_11) in (if _5028 then (u (u fm_check_result (u maybe_some bool_true)) list_nil) else (let _id_12=(u (u bits_concat _ah_10) _bh_11) in (let _5029 = (u (u set_has _id_12) _seen_5) in (if _5029 then (let _5030 = (u (u fm_term_equal_extra_holes _a_1) _b_2) in (case _5030 of {(0,f) -> u f (\_5031 _5032-> (let _5033 = _5031 in (case _5033 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5032)); (1,f) -> u f (\_5034-> (let _5035 = (u (u fm_check_result (u maybe_some bool_true)) list_nil) in (case _5035 of {(0,f) -> u f (\_5036 _5037-> (u (u fm_check_result _5036) (u (u list_concat _5032) _5037))); }))); }))); })) else (let _5038 = _a1_8 in (case _5038 of {(0,f) -> u f (\_5039 _5040-> (let _5041 = _b1_9 in (case _5041 of {(0,f) -> u f (\_5042 _5043-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5044-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5045 _5046 _5047 _5048 _5049-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (4,f) -> u f (\_5050 _5051-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (5,f) -> u f (\_5052 _5053-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (6,f) -> u f (\_5054 _5055 _5056-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (7,f) -> u f (\_5057 _5058 _5059-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5060 _5061 _5062-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5063 _5064 _5065-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5066-> (u (u fm_term_equal_hole _5066) _a_1)); (11,f) -> u f (\_5067-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5068-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5069-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5070 _5071 _5072 _5073 _5074 _5075-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5076 _5077-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); (1,f) -> u f (\_5078-> (let _5079 = _b1_9 in (case _5079 of {(0,f) -> u f (\_5080 _5081-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5082-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5083 _5084 _5085 _5086 _5087-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (4,f) -> u f (\_5088 _5089-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (5,f) -> u f (\_5090 _5091-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (6,f) -> u f (\_5092 _5093 _5094-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (7,f) -> u f (\_5095 _5096 _5097-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5098 _5099 _5100-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5101 _5102 _5103-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5104-> (u (u fm_term_equal_hole _5104) _a_1)); (11,f) -> u f (\_5105-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5106-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5107-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5108 _5109 _5110 _5111 _5112 _5113-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5114 _5115-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); (2,f) -> u f ((let _5116 = _b1_9 in (case _5116 of {(0,f) -> u f (\_5117 _5118-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5119-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5120 _5121 _5122 _5123 _5124-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (4,f) -> u f (\_5125 _5126-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (5,f) -> u f (\_5127 _5128-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (6,f) -> u f (\_5129 _5130 _5131-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (7,f) -> u f (\_5132 _5133 _5134-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5135 _5136 _5137-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5138 _5139 _5140-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5141-> (u (u fm_term_equal_hole _5141) _a_1)); (11,f) -> u f (\_5142-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5143-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5144-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5145 _5146 _5147 _5148 _5149 _5150-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5151 _5152-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); (3,f) -> u f (\_5153 _5154 _5155 _5156 _5157-> (let _5158 = _b1_9 in (case _5158 of {(0,f) -> u f (\_5159 _5160-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5161-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5162 _5163 _5164 _5165 _5166-> (let _seen_23=(u (u set_set _id_12) _seen_5) in (let _a1_body_24=(u (u _5157 (u (u fm_term_var _5154) _lv_4)) (u (u fm_term_var _5155) (u nat_succ _lv_4))) in (let _b1_body_25=(u (u _5166 (u (u fm_term_var _5163) _lv_4)) (u (u fm_term_var _5164) (u nat_succ _lv_4))) in (let _eq_self_26=(((_5154::String) == _5163)) in (let _eq_eras_27=(u (u bool_eql _5153) _5162) in (let _5167 = ((_eq_self_26 && _eq_eras_27)) in (if _5167 then (let _5168 = (u (u (u (u (u fm_term_equal _5156) _5165) _defs_3) _lv_4) _seen_23) in (case _5168 of {(0,f) -> u f (\_5169 _5170-> (let _5171 = _5169 in (case _5171 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5170)); (1,f) -> u f (\_5172-> (let _5173 = (let _5174 = (u (u (u (u (u fm_term_equal _a1_body_24) _b1_body_25) _defs_3) (u nat_succ (u nat_succ _lv_4))) _seen_23) in (case _5174 of {(0,f) -> u f (\_5175 _5176-> (let _5177 = _5175 in (case _5177 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5176)); (1,f) -> u f (\_5178-> (let _5179 = (u (u fm_check_result (u maybe_some ((_5172 && _5178)))) list_nil) in (case _5179 of {(0,f) -> u f (\_5180 _5181-> (u (u fm_check_result _5180) (u (u list_concat _5176) _5181))); }))); }))); })) in (case _5173 of {(0,f) -> u f (\_5182 _5183-> (u (u fm_check_result _5182) (u (u list_concat _5170) _5183))); }))); }))); })) else (u (u fm_check_result (u maybe_some bool_false)) list_nil))))))))); (4,f) -> u f (\_5184 _5185-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (5,f) -> u f (\_5186 _5187-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (6,f) -> u f (\_5188 _5189 _5190-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (7,f) -> u f (\_5191 _5192 _5193-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5194 _5195 _5196-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5197 _5198 _5199-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5200-> (u (u fm_term_equal_hole _5200) _a_1)); (11,f) -> u f (\_5201-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5202-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5203-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5204 _5205 _5206 _5207 _5208 _5209-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5210 _5211-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); (4,f) -> u f (\_5212 _5213-> (let _5214 = _b1_9 in (case _5214 of {(0,f) -> u f (\_5215 _5216-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5217-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5218 _5219 _5220 _5221 _5222-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (4,f) -> u f (\_5223 _5224-> (let _seen_17=(u (u set_set _id_12) _seen_5) in (let _a1_body_18=(u _5213 (u (u fm_term_var _5212) _lv_4)) in (let _b1_body_19=(u _5224 (u (u fm_term_var _5223) _lv_4)) in (let _5225 = (u (u (u (u (u fm_term_equal _a1_body_18) _b1_body_19) _defs_3) (u nat_succ _lv_4)) _seen_17) in (case _5225 of {(0,f) -> u f (\_5226 _5227-> (let _5228 = _5226 in (case _5228 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5227)); (1,f) -> u f (\_5229-> (let _5230 = (u (u fm_check_result (u maybe_some _5229)) list_nil) in (case _5230 of {(0,f) -> u f (\_5231 _5232-> (u (u fm_check_result _5231) (u (u list_concat _5227) _5232))); }))); }))); })))))); (5,f) -> u f (\_5233 _5234-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (6,f) -> u f (\_5235 _5236 _5237-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (7,f) -> u f (\_5238 _5239 _5240-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5241 _5242 _5243-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5244 _5245 _5246-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5247-> (u (u fm_term_equal_hole _5247) _a_1)); (11,f) -> u f (\_5248-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5249-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5250-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5251 _5252 _5253 _5254 _5255 _5256-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5257 _5258-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); (5,f) -> u f (\_5259 _5260-> (let _5261 = _b1_9 in (case _5261 of {(0,f) -> u f (\_5262 _5263-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5264-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5265 _5266 _5267 _5268 _5269-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (4,f) -> u f (\_5270 _5271-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (5,f) -> u f (\_5272 _5273-> (let _seen_17=(u (u set_set _id_12) _seen_5) in (let _5274 = (u (u (u (u (u fm_term_equal _5259) _5272) _defs_3) _lv_4) _seen_17) in (case _5274 of {(0,f) -> u f (\_5275 _5276-> (let _5277 = _5275 in (case _5277 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5276)); (1,f) -> u f (\_5278-> (let _5279 = (let _5280 = (u (u (u (u (u fm_term_equal _5260) _5273) _defs_3) _lv_4) _seen_17) in (case _5280 of {(0,f) -> u f (\_5281 _5282-> (let _5283 = _5281 in (case _5283 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5282)); (1,f) -> u f (\_5284-> (let _5285 = (u (u fm_check_result (u maybe_some ((_5278 && _5284)))) list_nil) in (case _5285 of {(0,f) -> u f (\_5286 _5287-> (u (u fm_check_result _5286) (u (u list_concat _5282) _5287))); }))); }))); })) in (case _5279 of {(0,f) -> u f (\_5288 _5289-> (u (u fm_check_result _5288) (u (u list_concat _5276) _5289))); }))); }))); })))); (6,f) -> u f (\_5290 _5291 _5292-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (7,f) -> u f (\_5293 _5294 _5295-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5296 _5297 _5298-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5299 _5300 _5301-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5302-> (u (u fm_term_equal_hole _5302) _a_1)); (11,f) -> u f (\_5303-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5304-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5305-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5306 _5307 _5308 _5309 _5310 _5311-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5312 _5313-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); (6,f) -> u f (\_5314 _5315 _5316-> (let _5317 = _b1_9 in (case _5317 of {(0,f) -> u f (\_5318 _5319-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5320-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5321 _5322 _5323 _5324 _5325-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (4,f) -> u f (\_5326 _5327-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (5,f) -> u f (\_5328 _5329-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (6,f) -> u f (\_5330 _5331 _5332-> (let _seen_19=(u (u set_set _id_12) _seen_5) in (let _a1_body_20=(u _5316 (u (u fm_term_var _5314) _lv_4)) in (let _b1_body_21=(u _5332 (u (u fm_term_var _5330) _lv_4)) in (let _5333 = (u (u (u (u (u fm_term_equal _5315) _5331) _defs_3) _lv_4) _seen_19) in (case _5333 of {(0,f) -> u f (\_5334 _5335-> (let _5336 = _5334 in (case _5336 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5335)); (1,f) -> u f (\_5337-> (let _5338 = (let _5339 = (u (u (u (u (u fm_term_equal _a1_body_20) _b1_body_21) _defs_3) (u nat_succ _lv_4)) _seen_19) in (case _5339 of {(0,f) -> u f (\_5340 _5341-> (let _5342 = _5340 in (case _5342 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5341)); (1,f) -> u f (\_5343-> (let _5344 = (u (u fm_check_result (u maybe_some ((_5337 && _5343)))) list_nil) in (case _5344 of {(0,f) -> u f (\_5345 _5346-> (u (u fm_check_result _5345) (u (u list_concat _5341) _5346))); }))); }))); })) in (case _5338 of {(0,f) -> u f (\_5347 _5348-> (u (u fm_check_result _5347) (u (u list_concat _5335) _5348))); }))); }))); })))))); (7,f) -> u f (\_5349 _5350 _5351-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5352 _5353 _5354-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5355 _5356 _5357-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5358-> (u (u fm_term_equal_hole _5358) _a_1)); (11,f) -> u f (\_5359-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5360-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5361-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5362 _5363 _5364 _5365 _5366 _5367-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5368 _5369-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); (7,f) -> u f (\_5370 _5371 _5372-> (let _5373 = _b1_9 in (case _5373 of {(0,f) -> u f (\_5374 _5375-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5376-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5377 _5378 _5379 _5380 _5381-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (4,f) -> u f (\_5382 _5383-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (5,f) -> u f (\_5384 _5385-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (6,f) -> u f (\_5386 _5387 _5388-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (7,f) -> u f (\_5389 _5390 _5391-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5392 _5393 _5394-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5395 _5396 _5397-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5398-> (u (u fm_term_equal_hole _5398) _a_1)); (11,f) -> u f (\_5399-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5400-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5401-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5402 _5403 _5404 _5405 _5406 _5407-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5408 _5409-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); (8,f) -> u f (\_5410 _5411 _5412-> (let _5413 = _b1_9 in (case _5413 of {(0,f) -> u f (\_5414 _5415-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5416-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5417 _5418 _5419 _5420 _5421-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (4,f) -> u f (\_5422 _5423-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (5,f) -> u f (\_5424 _5425-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (6,f) -> u f (\_5426 _5427 _5428-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (7,f) -> u f (\_5429 _5430 _5431-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5432 _5433 _5434-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5435 _5436 _5437-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5438-> (u (u fm_term_equal_hole _5438) _a_1)); (11,f) -> u f (\_5439-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5440-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5441-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5442 _5443 _5444 _5445 _5446 _5447-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5448 _5449-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); (9,f) -> u f (\_5450 _5451 _5452-> (let _5453 = _b1_9 in (case _5453 of {(0,f) -> u f (\_5454 _5455-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5456-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5457 _5458 _5459 _5460 _5461-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (4,f) -> u f (\_5462 _5463-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (5,f) -> u f (\_5464 _5465-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (6,f) -> u f (\_5466 _5467 _5468-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (7,f) -> u f (\_5469 _5470 _5471-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5472 _5473 _5474-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5475 _5476 _5477-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5478-> (u (u fm_term_equal_hole _5478) _a_1)); (11,f) -> u f (\_5479-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5480-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5481-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5482 _5483 _5484 _5485 _5486 _5487-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5488 _5489-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); (10,f) -> u f (\_5490-> (u (u fm_term_equal_hole _5490) _b_2)); (11,f) -> u f (\_5491-> (let _5492 = _b1_9 in (case _5492 of {(0,f) -> u f (\_5493 _5494-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5495-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5496 _5497 _5498 _5499 _5500-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (4,f) -> u f (\_5501 _5502-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (5,f) -> u f (\_5503 _5504-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (6,f) -> u f (\_5505 _5506 _5507-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (7,f) -> u f (\_5508 _5509 _5510-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5511 _5512 _5513-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5514 _5515 _5516-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5517-> (u (u fm_term_equal_hole _5517) _a_1)); (11,f) -> u f (\_5518-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5519-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5520-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5521 _5522 _5523 _5524 _5525 _5526-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5527 _5528-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); (12,f) -> u f (\_5529-> (let _5530 = _b1_9 in (case _5530 of {(0,f) -> u f (\_5531 _5532-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5533-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5534 _5535 _5536 _5537 _5538-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (4,f) -> u f (\_5539 _5540-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (5,f) -> u f (\_5541 _5542-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (6,f) -> u f (\_5543 _5544 _5545-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (7,f) -> u f (\_5546 _5547 _5548-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5549 _5550 _5551-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5552 _5553 _5554-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5555-> (u (u fm_term_equal_hole _5555) _a_1)); (11,f) -> u f (\_5556-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5557-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5558-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5559 _5560 _5561 _5562 _5563 _5564-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5565 _5566-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); (13,f) -> u f (\_5567-> (let _5568 = _b1_9 in (case _5568 of {(0,f) -> u f (\_5569 _5570-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5571-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5572 _5573 _5574 _5575 _5576-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (4,f) -> u f (\_5577 _5578-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (5,f) -> u f (\_5579 _5580-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (6,f) -> u f (\_5581 _5582 _5583-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (7,f) -> u f (\_5584 _5585 _5586-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5587 _5588 _5589-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5590 _5591 _5592-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5593-> (u (u fm_term_equal_hole _5593) _a_1)); (11,f) -> u f (\_5594-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5595-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5596-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5597 _5598 _5599 _5600 _5601 _5602-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5603 _5604-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); (14,f) -> u f (\_5605 _5606 _5607 _5608 _5609 _5610-> (let _5611 = _b1_9 in (case _5611 of {(0,f) -> u f (\_5612 _5613-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5614-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5615 _5616 _5617 _5618 _5619-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (4,f) -> u f (\_5620 _5621-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (5,f) -> u f (\_5622 _5623-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (6,f) -> u f (\_5624 _5625 _5626-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (7,f) -> u f (\_5627 _5628 _5629-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5630 _5631 _5632-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5633 _5634 _5635-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5636-> (u (u fm_term_equal_hole _5636) _a_1)); (11,f) -> u f (\_5637-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5638-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5639-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5640 _5641 _5642 _5643 _5644 _5645-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5646 _5647-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); (15,f) -> u f (\_5648 _5649-> (let _5650 = _b1_9 in (case _5650 of {(0,f) -> u f (\_5651 _5652-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5653-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5654 _5655 _5656 _5657 _5658-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (4,f) -> u f (\_5659 _5660-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (5,f) -> u f (\_5661 _5662-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (6,f) -> u f (\_5663 _5664 _5665-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (7,f) -> u f (\_5666 _5667 _5668-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5669 _5670 _5671-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5672 _5673 _5674-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5675-> (u (u fm_term_equal_hole _5675) _a_1)); (11,f) -> u f (\_5676-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5677-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5678-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5679 _5680 _5681 _5682 _5683 _5684-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5685 _5686-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); }))))))))))))))))))))
set_new = map_new
fm_term_check = (\_term_1-> (\_type_2-> (\_defs_3-> (\_ctx_4-> (\_path_5-> (\_orig_6-> (let _5687 = (let _5688 = _term_1 in (case _5688 of {(0,f) -> u f (\_5689 _5690-> (let _5691 = (u (u list_at_last _5690) _ctx_4) in (case _5691 of {(0,f) -> u f ((u (u fm_check_result _type_2) (u (u list_cons (u (u fm_error_undefined_reference _orig_6) _5689)) list_nil))); (1,f) -> u f (\_5692-> (u (u fm_check_result (u maybe_some (let _5693 = _5692 in (case _5693 of {(0,f) -> u f (\_5694 _5695-> _5695); })))) list_nil)); }))); (1,f) -> u f (\_5696-> (let _5697 = (u (u fm_get _5696) _defs_3) in (case _5697 of {(0,f) -> u f ((u (u fm_check_result _type_2) (u (u list_cons (u (u fm_error_undefined_reference _orig_6) _5696)) list_nil))); (1,f) -> u f (\_5698-> (let _5699 = _5698 in (case _5699 of {(0,f) -> u f (\_5700 _5701 _5702 _5703 _5704 _5705-> (let _ref_name_15=_5702 in (let _ref_type_16=_5704 in (let _ref_term_17=_5703 in (let _ref_stat_18=_5705 in (let _5706 = _ref_stat_18 in (case _5706 of {(0,f) -> u f ((u (u fm_check_result (u maybe_some _ref_type_16)) (u (u list_cons (u fm_error_waiting _ref_name_15)) list_nil))); (1,f) -> u f ((u (u fm_check_result (u maybe_some _ref_type_16)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some _ref_type_16)) list_nil)); (3,f) -> u f (\_5707-> (u (u fm_check_result (u maybe_some _ref_type_16)) (u (u list_cons (u fm_error_indirect _ref_name_15)) list_nil))); }))))))); }))); }))); (2,f) -> u f ((u (u fm_check_result (u maybe_some fm_term_typ)) list_nil)); (3,f) -> u f (\_5708 _5709 _5710 _5711 _5712-> (let _ctx_size_12=(u list_length _ctx_4) in (let _self_var_13=(u (u fm_term_var _5709) _ctx_size_12) in (let _body_var_14=(u (u fm_term_var _5710) (u nat_succ _ctx_size_12)) in (let _body_ctx_15=(u (u list_cons (u (u pair_new _5710) _5711)) (u (u list_cons (u (u pair_new _5709) _term_1)) _ctx_4)) in (let _5713 = (u (u (u (u (u (u fm_term_check _5711) (u maybe_some fm_term_typ)) _defs_3) _ctx_4) (u fm_mpath_o _path_5)) _orig_6) in (case _5713 of {(0,f) -> u f (\_5714 _5715-> (let _5716 = _5714 in (case _5716 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5715)); (1,f) -> u f (\_5717-> (let _5718 = (let _5719 = (u (u (u (u (u (u fm_term_check (u (u _5712 _self_var_13) _body_var_14)) (u maybe_some fm_term_typ)) _defs_3) _body_ctx_15) (u fm_mpath_i _path_5)) _orig_6) in (case _5719 of {(0,f) -> u f (\_5720 _5721-> (let _5722 = _5720 in (case _5722 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5721)); (1,f) -> u f (\_5723-> (let _5724 = (u (u fm_check_result (u maybe_some fm_term_typ)) list_nil) in (case _5724 of {(0,f) -> u f (\_5725 _5726-> (u (u fm_check_result _5725) (u (u list_concat _5721) _5726))); }))); }))); })) in (case _5718 of {(0,f) -> u f (\_5727 _5728-> (u (u fm_check_result _5727) (u (u list_concat _5715) _5728))); }))); }))); }))))))); (4,f) -> u f (\_5729 _5730-> (let _5731 = _type_2 in (case _5731 of {(0,f) -> u f ((let _lam_type_9=(u fm_term_hol bits_e) in (let _lam_term_10=(u (u (u fm_term_ann bool_false) _term_1) _lam_type_9) in (u (u fm_check_result _type_2) (u (u list_cons (u (u fm_error_patch (u fm_mpath_to_bits _path_5)) _lam_term_10)) list_nil))))); (1,f) -> u f (\_5732-> (let _typv_10=(u (u fm_term_reduce _5732) _defs_3) in (let _5733 = _typv_10 in (case _5733 of {(0,f) -> u f (\_5734 _5735-> (let _expected_13=(u either_left "(function type)") in (let _detected_14=(u either_right _5732) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_13) _detected_14) _ctx_4)) list_nil))))); (1,f) -> u f (\_5736-> (let _expected_12=(u either_left "(function type)") in (let _detected_13=(u either_right _5732) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_12) _detected_13) _ctx_4)) list_nil))))); (2,f) -> u f ((let _expected_11=(u either_left "(function type)") in (let _detected_12=(u either_right _5732) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_11) _detected_12) _ctx_4)) list_nil))))); (3,f) -> u f (\_5737 _5738 _5739 _5740 _5741-> (let _ctx_size_16=(u list_length _ctx_4) in (let _self_var_17=_term_1 in (let _body_var_18=(u (u fm_term_var _5729) _ctx_size_16) in (let _body_typ_19=(u (u _5741 _self_var_17) _body_var_18) in (let _body_ctx_20=(u (u list_cons (u (u pair_new _5729) _5740)) _ctx_4) in (let _5742 = (u (u (u (u (u (u fm_term_check (u _5730 _body_var_18)) (u maybe_some _body_typ_19)) _defs_3) _body_ctx_20) (u fm_mpath_o _path_5)) _orig_6) in (case _5742 of {(0,f) -> u f (\_5743 _5744-> (let _5745 = _5743 in (case _5745 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5744)); (1,f) -> u f (\_5746-> (let _5747 = (u (u fm_check_result (u maybe_some _5732)) list_nil) in (case _5747 of {(0,f) -> u f (\_5748 _5749-> (u (u fm_check_result _5748) (u (u list_concat _5744) _5749))); }))); }))); })))))))); (4,f) -> u f (\_5750 _5751-> (let _expected_13=(u either_left "(function type)") in (let _detected_14=(u either_right _5732) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_13) _detected_14) _ctx_4)) list_nil))))); (5,f) -> u f (\_5752 _5753-> (let _expected_13=(u either_left "(function type)") in (let _detected_14=(u either_right _5732) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_13) _detected_14) _ctx_4)) list_nil))))); (6,f) -> u f (\_5754 _5755 _5756-> (let _expected_14=(u either_left "(function type)") in (let _detected_15=(u either_right _5732) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_14) _detected_15) _ctx_4)) list_nil))))); (7,f) -> u f (\_5757 _5758 _5759-> (let _expected_14=(u either_left "(function type)") in (let _detected_15=(u either_right _5732) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_14) _detected_15) _ctx_4)) list_nil))))); (8,f) -> u f (\_5760 _5761 _5762-> (let _expected_14=(u either_left "(function type)") in (let _detected_15=(u either_right _5732) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_14) _detected_15) _ctx_4)) list_nil))))); (9,f) -> u f (\_5763 _5764 _5765-> (let _expected_14=(u either_left "(function type)") in (let _detected_15=(u either_right _5732) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_14) _detected_15) _ctx_4)) list_nil))))); (10,f) -> u f (\_5766-> (let _expected_12=(u either_left "(function type)") in (let _detected_13=(u either_right _5732) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_12) _detected_13) _ctx_4)) list_nil))))); (11,f) -> u f (\_5767-> (let _expected_12=(u either_left "(function type)") in (let _detected_13=(u either_right _5732) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_12) _detected_13) _ctx_4)) list_nil))))); (12,f) -> u f (\_5768-> (let _expected_12=(u either_left "(function type)") in (let _detected_13=(u either_right _5732) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_12) _detected_13) _ctx_4)) list_nil))))); (13,f) -> u f (\_5769-> (let _expected_12=(u either_left "(function type)") in (let _detected_13=(u either_right _5732) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_12) _detected_13) _ctx_4)) list_nil))))); (14,f) -> u f (\_5770 _5771 _5772 _5773 _5774 _5775-> (let _expected_17=(u either_left "(function type)") in (let _detected_18=(u either_right _5732) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_17) _detected_18) _ctx_4)) list_nil))))); (15,f) -> u f (\_5776 _5777-> (let _expected_13=(u either_left "(function type)") in (let _detected_14=(u either_right _5732) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_13) _detected_14) _ctx_4)) list_nil))))); })))); }))); (5,f) -> u f (\_5778 _5779-> (let _5780 = (u (u (u (u (u (u fm_term_check _5778) maybe_none) _defs_3) _ctx_4) (u fm_mpath_o _path_5)) _orig_6) in (case _5780 of {(0,f) -> u f (\_5781 _5782-> (let _5783 = _5781 in (case _5783 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5782)); (1,f) -> u f (\_5784-> (let _func_typ_12=(u (u fm_term_reduce _5784) _defs_3) in (let _5785 = (let _5786 = _func_typ_12 in (case _5786 of {(0,f) -> u f (\_5787 _5788-> (let _expected_15=(u either_left "(function type)") in (let _detected_16=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_15) _detected_16) _ctx_4)) list_nil))))); (1,f) -> u f (\_5789-> (let _expected_14=(u either_left "(function type)") in (let _detected_15=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_14) _detected_15) _ctx_4)) list_nil))))); (2,f) -> u f ((let _expected_13=(u either_left "(function type)") in (let _detected_14=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_13) _detected_14) _ctx_4)) list_nil))))); (3,f) -> u f (\_5790 _5791 _5792 _5793 _5794-> (let _5795 = (u (u (u (u (u (u fm_term_check _5779) (u maybe_some _5793)) _defs_3) _ctx_4) (u fm_mpath_i _path_5)) _orig_6) in (case _5795 of {(0,f) -> u f (\_5796 _5797-> (let _5798 = _5796 in (case _5798 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5797)); (1,f) -> u f (\_5799-> (let _5800 = (u (u fm_check_result (u maybe_some (u (u _5794 _5778) _5779))) list_nil) in (case _5800 of {(0,f) -> u f (\_5801 _5802-> (u (u fm_check_result _5801) (u (u list_concat _5797) _5802))); }))); }))); }))); (4,f) -> u f (\_5803 _5804-> (let _expected_15=(u either_left "(function type)") in (let _detected_16=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_15) _detected_16) _ctx_4)) list_nil))))); (5,f) -> u f (\_5805 _5806-> (let _expected_15=(u either_left "(function type)") in (let _detected_16=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_15) _detected_16) _ctx_4)) list_nil))))); (6,f) -> u f (\_5807 _5808 _5809-> (let _expected_16=(u either_left "(function type)") in (let _detected_17=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_16) _detected_17) _ctx_4)) list_nil))))); (7,f) -> u f (\_5810 _5811 _5812-> (let _expected_16=(u either_left "(function type)") in (let _detected_17=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_16) _detected_17) _ctx_4)) list_nil))))); (8,f) -> u f (\_5813 _5814 _5815-> (let _expected_16=(u either_left "(function type)") in (let _detected_17=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_16) _detected_17) _ctx_4)) list_nil))))); (9,f) -> u f (\_5816 _5817 _5818-> (let _expected_16=(u either_left "(function type)") in (let _detected_17=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_16) _detected_17) _ctx_4)) list_nil))))); (10,f) -> u f (\_5819-> (let _expected_14=(u either_left "(function type)") in (let _detected_15=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_14) _detected_15) _ctx_4)) list_nil))))); (11,f) -> u f (\_5820-> (let _expected_14=(u either_left "(function type)") in (let _detected_15=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_14) _detected_15) _ctx_4)) list_nil))))); (12,f) -> u f (\_5821-> (let _expected_14=(u either_left "(function type)") in (let _detected_15=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_14) _detected_15) _ctx_4)) list_nil))))); (13,f) -> u f (\_5822-> (let _expected_14=(u either_left "(function type)") in (let _detected_15=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_14) _detected_15) _ctx_4)) list_nil))))); (14,f) -> u f (\_5823 _5824 _5825 _5826 _5827 _5828-> (let _expected_19=(u either_left "(function type)") in (let _detected_20=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_19) _detected_20) _ctx_4)) list_nil))))); (15,f) -> u f (\_5829 _5830-> (let _expected_15=(u either_left "(function type)") in (let _detected_16=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_15) _detected_16) _ctx_4)) list_nil))))); })) in (case _5785 of {(0,f) -> u f (\_5831 _5832-> (u (u fm_check_result _5831) (u (u list_concat _5782) _5832))); })))); }))); }))); (6,f) -> u f (\_5833 _5834 _5835-> (let _ctx_size_10=(u list_length _ctx_4) in (let _5836 = (u (u (u (u (u (u fm_term_check _5834) maybe_none) _defs_3) _ctx_4) (u fm_mpath_o _path_5)) _orig_6) in (case _5836 of {(0,f) -> u f (\_5837 _5838-> (let _5839 = _5837 in (case _5839 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5838)); (1,f) -> u f (\_5840-> (let _body_val_14=(u _5835 (u (u fm_term_var _5833) _ctx_size_10)) in (let _body_ctx_15=(u (u list_cons (u (u pair_new _5833) _5840)) _ctx_4) in (let _5841 = (let _5842 = (u (u (u (u (u (u fm_term_check _body_val_14) _type_2) _defs_3) _body_ctx_15) (u fm_mpath_i _path_5)) _orig_6) in (case _5842 of {(0,f) -> u f (\_5843 _5844-> (let _5845 = _5843 in (case _5845 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5844)); (1,f) -> u f (\_5846-> (let _5847 = (u (u fm_check_result (u maybe_some _5846)) list_nil) in (case _5847 of {(0,f) -> u f (\_5848 _5849-> (u (u fm_check_result _5848) (u (u list_concat _5844) _5849))); }))); }))); })) in (case _5841 of {(0,f) -> u f (\_5850 _5851-> (u (u fm_check_result _5850) (u (u list_concat _5838) _5851))); }))))); }))); })))); (7,f) -> u f (\_5852 _5853 _5854-> (let _ctx_size_10=(u list_length _ctx_4) in (let _5855 = (u (u (u (u (u (u fm_term_check _5853) maybe_none) _defs_3) _ctx_4) (u fm_mpath_o _path_5)) _orig_6) in (case _5855 of {(0,f) -> u f (\_5856 _5857-> (let _5858 = _5856 in (case _5858 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5857)); (1,f) -> u f (\_5859-> (let _body_val_14=(u _5854 (u (u (u fm_term_ann bool_true) _5853) _5859)) in (let _body_ctx_15=(u (u list_cons (u (u pair_new _5852) _5859)) _ctx_4) in (let _5860 = (let _5861 = (u (u (u (u (u (u fm_term_check _body_val_14) _type_2) _defs_3) _body_ctx_15) (u fm_mpath_i _path_5)) _orig_6) in (case _5861 of {(0,f) -> u f (\_5862 _5863-> (let _5864 = _5862 in (case _5864 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5863)); (1,f) -> u f (\_5865-> (let _5866 = (u (u fm_check_result (u maybe_some _5865)) list_nil) in (case _5866 of {(0,f) -> u f (\_5867 _5868-> (u (u fm_check_result _5867) (u (u list_concat _5863) _5868))); }))); }))); })) in (case _5860 of {(0,f) -> u f (\_5869 _5870-> (u (u fm_check_result _5869) (u (u list_concat _5857) _5870))); }))))); }))); })))); (8,f) -> u f (\_5871 _5872 _5873-> (let _5874 = _5871 in (if _5874 then (u (u fm_check_result (u maybe_some _5873)) list_nil) else (let _5875 = (u (u (u (u (u (u fm_term_check _5872) (u maybe_some _5873)) _defs_3) _ctx_4) (u fm_mpath_o _path_5)) _orig_6) in (case _5875 of {(0,f) -> u f (\_5876 _5877-> (let _5878 = _5876 in (case _5878 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5877)); (1,f) -> u f (\_5879-> (let _5880 = (let _5881 = (u (u (u (u (u (u fm_term_check _5873) (u maybe_some fm_term_typ)) _defs_3) _ctx_4) (u fm_mpath_i _path_5)) _orig_6) in (case _5881 of {(0,f) -> u f (\_5882 _5883-> (let _5884 = _5882 in (case _5884 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5883)); (1,f) -> u f (\_5885-> (let _5886 = (u (u fm_check_result (u maybe_some _5873)) list_nil) in (case _5886 of {(0,f) -> u f (\_5887 _5888-> (u (u fm_check_result _5887) (u (u list_concat _5883) _5888))); }))); }))); })) in (case _5880 of {(0,f) -> u f (\_5889 _5890-> (u (u fm_check_result _5889) (u (u list_concat _5877) _5890))); }))); }))); }))))); (9,f) -> u f (\_5891 _5892 _5893-> (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u (u fm_error_show_goal _5891) _5892) _5893) _type_2) _ctx_4)) list_nil))); (10,f) -> u f (\_5894-> (u (u fm_check_result _type_2) list_nil)); (11,f) -> u f (\_5895-> (u (u fm_check_result (u maybe_some (u fm_term_ref "Nat"))) list_nil)); (12,f) -> u f (\_5896-> (u (u fm_check_result (u maybe_some (u fm_term_ref "Char"))) list_nil)); (13,f) -> u f (\_5897-> (u (u fm_check_result (u maybe_some (u fm_term_ref "String"))) list_nil)); (14,f) -> u f (\_5898 _5899 _5900 _5901 _5902 _5903-> (let _expr_13=_5899 in (let _5904 = (u (u (u (u (u (u fm_term_check _expr_13) maybe_none) _defs_3) _ctx_4) (u fm_mpath_o _path_5)) _orig_6) in (case _5904 of {(0,f) -> u f (\_5905 _5906-> (let _5907 = _5905 in (case _5907 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5906)); (1,f) -> u f (\_5908-> (let _dsug_17=(let _5909 = _5903 in (case _5909 of {(0,f) -> u f ((let _moti_17=(let _5910 = _type_2 in (case _5910 of {(0,f) -> u f ((u fm_term_hol bits_e)); (1,f) -> u f (\_5911-> (let _size_18=(u list_length _ctx_4) in (let _typv_19=(u (u fm_term_normalize _5911) map_new) in (let _moti_20=(u (u (u (u (u (u fm_smartmotive_make _5900) _5899) _5908) _typv_19) _size_18) _defs_3) in _moti_20)))); })) in (u maybe_some (u (u (u (u (u (u fm_term_cse _5898) _5899) _5900) _5901) _5902) (u maybe_some _moti_17))))); (1,f) -> u f (\_5912-> (u (u (u (u (u (u (u (u fm_term_desugar_cse _5899) _5900) _5901) _5902) _5912) _5908) _defs_3) _ctx_4)); })) in (let _5913 = (let _5914 = _dsug_17 in (case _5914 of {(0,f) -> u f ((u (u fm_check_result _type_2) (u (u list_cons (u (u (u fm_error_cant_infer _orig_6) _term_1) _ctx_4)) list_nil))); (1,f) -> u f (\_5915-> (u (u fm_check_result _type_2) (u (u list_cons (u (u fm_error_patch (u fm_mpath_to_bits _path_5)) _5915)) list_nil))); })) in (case _5913 of {(0,f) -> u f (\_5916 _5917-> (u (u fm_check_result _5916) (u (u list_concat _5906) _5917))); })))); }))); })))); (15,f) -> u f (\_5918 _5919-> (u (u (u (u (u (u fm_term_check _5919) _type_2) _defs_3) _ctx_4) _path_5) (u maybe_some _5918))); })) in (case _5687 of {(0,f) -> u f (\_5920 _5921-> (let _5922 = _5920 in (case _5922 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5921)); (1,f) -> u f (\_5923-> (let _5924 = (let _5925 = _type_2 in (case _5925 of {(0,f) -> u f ((u (u fm_check_result (u maybe_some _5923)) list_nil)); (1,f) -> u f (\_5926-> (let _5927 = (u (u (u (u (u fm_term_equal _5926) _5923) _defs_3) (u list_length _ctx_4)) set_new) in (case _5927 of {(0,f) -> u f (\_5928 _5929-> (let _5930 = _5928 in (case _5930 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5929)); (1,f) -> u f (\_5931-> (let _5932 = (let _5933 = _5931 in (if _5933 then (u (u fm_check_result (u maybe_some _5926)) list_nil) else (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) (u either_right _5926)) (u either_right _5923)) _ctx_4)) list_nil)))) in (case _5932 of {(0,f) -> u f (\_5934 _5935-> (u (u fm_check_result _5934) (u (u list_concat _5929) _5935))); }))); }))); }))); })) in (case _5924 of {(0,f) -> u f (\_5936 _5937-> (u (u fm_check_result _5936) (u (u list_concat _5921) _5937))); }))); }))); }))))))))
fm_path_nil = (\_x_1-> _x_1)
fm_mpath_nil = (u maybe_some fm_path_nil)
list_is_empty = (\_list_2-> (let _5938 = _list_2 in (case _5938 of {(0,f) -> u f (bool_true); (1,f) -> u f (\_5939 _5940-> bool_false); })))
fm_term_patch_at = (\_path_1-> (\_term_2-> (\_fn_3-> (let _5941 = _term_2 in (case _5941 of {(0,f) -> u f (\_5942 _5943-> (let _5944 = _path_1 in (case _5944 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_5945-> _term_2); (2,f) -> u f (\_5946-> _term_2); }))); (1,f) -> u f (\_5947-> (let _5948 = _path_1 in (case _5948 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_5949-> _term_2); (2,f) -> u f (\_5950-> _term_2); }))); (2,f) -> u f ((let _5951 = _path_1 in (case _5951 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_5952-> _term_2); (2,f) -> u f (\_5953-> _term_2); }))); (3,f) -> u f (\_5954 _5955 _5956 _5957 _5958-> (let _5959 = _path_1 in (case _5959 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_5960-> (u (u (u (u (u fm_term_all _5954) _5955) _5956) (u (u (u fm_term_patch_at _5960) _5957) _fn_3)) _5958)); (2,f) -> u f (\_5961-> (u (u (u (u (u fm_term_all _5954) _5955) _5956) _5957) (\_s_10-> (\_x_11-> (u (u (u fm_term_patch_at _5961) (u (u _5958 _s_10) _x_11)) _fn_3))))); }))); (4,f) -> u f (\_5962 _5963-> (let _5964 = _path_1 in (case _5964 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_5965-> (u (u fm_term_lam _5962) (\_x_7-> (u (u (u fm_term_patch_at (u bits_tail _path_1)) (u _5963 _x_7)) _fn_3)))); (2,f) -> u f (\_5966-> (u (u fm_term_lam _5962) (\_x_7-> (u (u (u fm_term_patch_at (u bits_tail _path_1)) (u _5963 _x_7)) _fn_3)))); }))); (5,f) -> u f (\_5967 _5968-> (let _5969 = _path_1 in (case _5969 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_5970-> (u (u fm_term_app (u (u (u fm_term_patch_at _5970) _5967) _fn_3)) _5968)); (2,f) -> u f (\_5971-> (u (u fm_term_app _5967) (u (u (u fm_term_patch_at _5971) _5968) _fn_3))); }))); (6,f) -> u f (\_5972 _5973 _5974-> (let _5975 = _path_1 in (case _5975 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_5976-> (u (u (u fm_term_let _5972) (u (u (u fm_term_patch_at _5976) _5973) _fn_3)) _5974)); (2,f) -> u f (\_5977-> (u (u (u fm_term_let _5972) _5973) (\_x_8-> (u (u (u fm_term_patch_at _5977) (u _5974 _x_8)) _fn_3)))); }))); (7,f) -> u f (\_5978 _5979 _5980-> (let _5981 = _path_1 in (case _5981 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_5982-> (u (u (u fm_term_def _5978) (u (u (u fm_term_patch_at _5982) _5979) _fn_3)) _5980)); (2,f) -> u f (\_5983-> (u (u (u fm_term_def _5978) _5979) (\_x_8-> (u (u (u fm_term_patch_at _5983) (u _5980 _x_8)) _fn_3)))); }))); (8,f) -> u f (\_5984 _5985 _5986-> (let _5987 = _path_1 in (case _5987 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_5988-> (u (u (u fm_term_ann _5984) (u (u (u fm_term_patch_at _5988) _5985) _fn_3)) _5986)); (2,f) -> u f (\_5989-> (u (u (u fm_term_ann _5984) _5985) (u (u (u fm_term_patch_at _5989) _5986) _fn_3))); }))); (9,f) -> u f (\_5990 _5991 _5992-> (let _5993 = _path_1 in (case _5993 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_5994-> _term_2); (2,f) -> u f (\_5995-> _term_2); }))); (10,f) -> u f (\_5996-> (let _5997 = _path_1 in (case _5997 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_5998-> _term_2); (2,f) -> u f (\_5999-> _term_2); }))); (11,f) -> u f (\_6000-> (let _6001 = _path_1 in (case _6001 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_6002-> _term_2); (2,f) -> u f (\_6003-> _term_2); }))); (12,f) -> u f (\_6004-> (let _6005 = _path_1 in (case _6005 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_6006-> _term_2); (2,f) -> u f (\_6007-> _term_2); }))); (13,f) -> u f (\_6008-> (let _6009 = _path_1 in (case _6009 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_6010-> _term_2); (2,f) -> u f (\_6011-> _term_2); }))); (14,f) -> u f (\_6012 _6013 _6014 _6015 _6016 _6017-> (let _6018 = _path_1 in (case _6018 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_6019-> _term_2); (2,f) -> u f (\_6020-> _term_2); }))); (15,f) -> u f (\_6021 _6022-> (u (u fm_term_ori _6021) (u (u (u fm_term_patch_at _path_1) _6022) _fn_3))); })))))
fm_synth_fix = (\_file_1-> (\_code_2-> (\_name_3-> (\_term_4-> (\_type_5-> (\_defs_6-> (\_errs_7-> (\_fixd_8-> (let _6023 = _errs_7 in (case _6023 of {(0,f) -> u f ((let _6024 = _fixd_8 in (if _6024 then (let _type_9=(u (u (u fm_term_bind list_nil) (\_x_9-> (u bits_i _x_9))) _type_5) in (let _term_10=(u (u (u fm_term_bind list_nil) (\_x_10-> (u bits_o _x_10))) _term_4) in (let _defs_11=(u (u (u fm_set _name_3) (u (u (u (u (u (u fm_def_new _file_1) _code_2) _name_3) _term_10) _type_9) fm_status_init)) _defs_6) in (u (u io_monad (\_m_bind_12-> (\_m_pure_13-> _m_pure_13))) (u maybe_some _defs_11))))) else (u (u io_monad (\_m_bind_9-> (\_m_pure_10-> _m_pure_10))) maybe_none)))); (1,f) -> u f (\_6025 _6026-> (let _6027 = _6025 in (case _6027 of {(0,f) -> u f (\_6028 _6029 _6030 _6031-> (u (u (u (u (u (u (u (u fm_synth_fix _file_1) _code_2) _name_3) _term_4) _type_5) _defs_6) _6026) _fixd_8)); (1,f) -> u f (\_6032 _6033 _6034 _6035 _6036-> (u (u (u (u (u (u (u (u fm_synth_fix _file_1) _code_2) _name_3) _term_4) _type_5) _defs_6) _6026) _fixd_8)); (2,f) -> u f (\_6037-> (u (u (u io_monad (\_m_bind_12-> (\_m_pure_13-> _m_bind_12))) (u (u fm_synth_one _6037) _defs_6)) (\_new_defs_12-> (let _6038 = _new_defs_12 in (case _6038 of {(0,f) -> u f ((u (u (u (u (u (u (u (u fm_synth_fix _file_1) _code_2) _name_3) _term_4) _type_5) _defs_6) _6026) _fixd_8)); (1,f) -> u f (\_6039-> (u (u (u (u (u (u (u (u fm_synth_fix _file_1) _code_2) _name_3) _term_4) _type_5) _6039) _6026) bool_true)); }))))); (3,f) -> u f (\_6040-> (u (u (u (u (u (u (u (u fm_synth_fix _file_1) _code_2) _name_3) _term_4) _type_5) _defs_6) _6026) _fixd_8)); (4,f) -> u f (\_6041 _6042-> (let _6043 = _6041 in (case _6043 of {(0,f) -> u f ((u (u io_monad (\_m_bind_13-> (\_m_pure_14-> _m_pure_14))) maybe_none)); (1,f) -> u f (\_6044-> (let _term_14=(u (u (u fm_term_patch_at _6044) _term_4) (\_x_14-> _6042)) in (u (u (u (u (u (u (u (u fm_synth_fix _file_1) _code_2) _name_3) _term_14) _type_5) _defs_6) _6026) bool_true))); (2,f) -> u f (\_6045-> (let _type_14=(u (u (u fm_term_patch_at _6045) _type_5) (\_x_14-> _6042)) in (u (u (u (u (u (u (u (u fm_synth_fix _file_1) _code_2) _name_3) _term_4) _type_14) _defs_6) _6026) bool_true))); }))); (5,f) -> u f (\_6046 _6047-> (u (u (u io_monad (\_m_bind_13-> (\_m_pure_14-> _m_bind_13))) (u (u fm_synth_one _6047) _defs_6)) (\_new_defs_13-> (let _6048 = _new_defs_13 in (case _6048 of {(0,f) -> u f ((u (u (u (u (u (u (u (u fm_synth_fix _file_1) _code_2) _name_3) _term_4) _type_5) _defs_6) _6026) _fixd_8)); (1,f) -> u f (\_6049-> (u (u (u (u (u (u (u (u fm_synth_fix _file_1) _code_2) _name_3) _term_4) _type_5) _6049) _6026) bool_true)); }))))); (6,f) -> u f (\_6050 _6051 _6052-> (u (u (u (u (u (u (u (u fm_synth_fix _file_1) _code_2) _name_3) _term_4) _type_5) _defs_6) _6026) _fixd_8)); }))); }))))))))))
fm_status_fail = (\_errors_1-> (3,\t-> t _errors_1))
fm_synth_one = (\_name_1-> (\_defs_2-> (let _6053 = (u (u fm_get _name_1) _defs_2) in (case _6053 of {(0,f) -> u f ((u (u (u io_monad (\_m_bind_3-> (\_m_pure_4-> _m_bind_3))) (u (u fm_synth_load _name_1) _defs_2)) (\_loaded_3-> (let _6054 = _loaded_3 in (case _6054 of {(0,f) -> u f ((u (u io_monad (\_m_bind_4-> (\_m_pure_5-> _m_pure_5))) maybe_none)); (1,f) -> u f (\_6055-> (u (u fm_synth_one _name_1) _6055)); }))))); (1,f) -> u f (\_6056-> (let _6057 = _6056 in (case _6057 of {(0,f) -> u f (\_6058 _6059 _6060 _6061 _6062 _6063-> (let _file_10=_6058 in (let _code_11=_6059 in (let _name_12=_6060 in (let _term_13=_6061 in (let _type_14=_6062 in (let _stat_15=_6063 in (let _6064 = _stat_15 in (case _6064 of {(0,f) -> u f ((let _defs_16=(u (u (u fm_set _name_12) (u (u (u (u (u (u fm_def_new _file_10) _code_11) _name_12) _term_13) _type_14) fm_status_wait)) _defs_2) in (let _checked_17=(let _6065 = (u (u (u (u (u (u fm_term_check _type_14) (u maybe_some fm_term_typ)) _defs_16) list_nil) (u fm_mpath_i fm_mpath_nil)) maybe_none) in (case _6065 of {(0,f) -> u f (\_6066 _6067-> (let _6068 = _6066 in (case _6068 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _6067)); (1,f) -> u f (\_6069-> (let _6070 = (let _6071 = (u (u (u (u (u (u fm_term_check _term_13) (u maybe_some _type_14)) _defs_16) list_nil) (u fm_mpath_o fm_mpath_nil)) maybe_none) in (case _6071 of {(0,f) -> u f (\_6072 _6073-> (let _6074 = _6072 in (case _6074 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _6073)); (1,f) -> u f (\_6075-> (let _6076 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _6076 of {(0,f) -> u f (\_6077 _6078-> (u (u fm_check_result _6077) (u (u list_concat _6073) _6078))); }))); }))); })) in (case _6070 of {(0,f) -> u f (\_6079 _6080-> (u (u fm_check_result _6079) (u (u list_concat _6067) _6080))); }))); }))); })) in (let _6081 = _checked_17 in (case _6081 of {(0,f) -> u f (\_6082 _6083-> (let _6084 = (u list_is_empty _6083) in (if _6084 then (let _defs_20=(u (u (u (u (u (u (u fm_define _file_10) _code_11) _name_12) _term_13) _type_14) bool_true) _defs_16) in (u (u io_monad (\_m_bind_21-> (\_m_pure_22-> _m_pure_22))) (u maybe_some _defs_20))) else (u (u (u io_monad (\_m_bind_20-> (\_m_pure_21-> _m_bind_20))) (u (u (u (u (u (u (u (u fm_synth_fix _file_10) _code_11) _name_12) _term_13) _type_14) _defs_16) _6083) bool_false)) (\_fixed_20-> (let _6085 = _fixed_20 in (case _6085 of {(0,f) -> u f ((let _stat_21=(u fm_status_fail _6083) in (let _defs_22=(u (u (u fm_set _name_12) (u (u (u (u (u (u fm_def_new _file_10) _code_11) _name_12) _term_13) _type_14) _stat_21)) _defs_16) in (u (u io_monad (\_m_bind_23-> (\_m_pure_24-> _m_pure_24))) (u maybe_some _defs_22))))); (1,f) -> u f (\_6086-> (u (u fm_synth_one _name_12) _6086)); }))))))); }))))); (1,f) -> u f ((u (u io_monad (\_m_bind_16-> (\_m_pure_17-> _m_pure_17))) (u maybe_some _defs_2))); (2,f) -> u f ((u (u io_monad (\_m_bind_16-> (\_m_pure_17-> _m_pure_17))) (u maybe_some _defs_2))); (3,f) -> u f (\_6087-> (u (u io_monad (\_m_bind_17-> (\_m_pure_18-> _m_pure_18))) (u maybe_some _defs_2))); }))))))))); }))); }))))
map_map = (\_fn_3-> (\_map_4-> (let _6088 = _map_4 in (case _6088 of {(0,f) -> u f (map_new); (1,f) -> u f (\_6089 _6090 _6091-> (let _val_8=(let _6092 = _6089 in (case _6092 of {(0,f) -> u f (maybe_none); (1,f) -> u f (\_6093-> (u maybe_some (u _fn_3 _6093))); })) in (let _lft_9=(u (u map_map _fn_3) _6090) in (let _rgt_10=(u (u map_map _fn_3) _6091) in (u (u (u map_tie _val_8) _lft_9) _rgt_10))))); }))))
fm_term_inline_names = (let _inl_1=(u (u list_cons "Monad.pure") (u (u list_cons "Monad.bind") (u (u list_cons "Monad.new") (u (u list_cons "Parser.monad") (u (u list_cons "Parser.bind") (u (u list_cons "Parser.pure") (u (u list_cons "Fm.Check.pure") (u (u list_cons "Fm.Check.bind") (u (u list_cons "Fm.Check.monad") (u (u list_cons "Fm.Check.value") (u (u list_cons "Fm.Check.none") list_nil))))))))))) in (let _kvs_2=(u (u list_mapped _inl_1) (\_x_2-> (u (u pair_new (u fm_name_to_bits _x_2)) unit_new))) in (u map_from_list _kvs_2)))
fm_term_inline_reduce = (\_term_1-> (\_defs_2-> (let _6094 = _term_1 in (case _6094 of {(0,f) -> u f (\_6095 _6096-> _term_1); (1,f) -> u f (\_6097-> (let _inli_4=(u (u set_has (u fm_name_to_bits _6097)) fm_term_inline_names) in (let _6098 = _inli_4 in (if _6098 then (let _6099 = (u (u fm_get _6097) _defs_2) in (case _6099 of {(0,f) -> u f ((u fm_term_ref _6097)); (1,f) -> u f (\_6100-> (let _6101 = _6100 in (case _6101 of {(0,f) -> u f (\_6102 _6103 _6104 _6105 _6106 _6107-> (u (u fm_term_inline_reduce _6105) _defs_2)); }))); })) else _term_1)))); (2,f) -> u f (_term_1); (3,f) -> u f (\_6108 _6109 _6110 _6111 _6112-> _term_1); (4,f) -> u f (\_6113 _6114-> _term_1); (5,f) -> u f (\_6115 _6116-> (let _func_5=(u (u fm_term_inline_reduce _6115) _defs_2) in (let _6117 = _func_5 in (case _6117 of {(0,f) -> u f (\_6118 _6119-> _term_1); (1,f) -> u f (\_6120-> _term_1); (2,f) -> u f (_term_1); (3,f) -> u f (\_6121 _6122 _6123 _6124 _6125-> _term_1); (4,f) -> u f (\_6126 _6127-> (u (u fm_term_inline_reduce (u _6127 _6116)) _defs_2)); (5,f) -> u f (\_6128 _6129-> _term_1); (6,f) -> u f (\_6130 _6131 _6132-> (u (u (u fm_term_let _6130) _6131) (\_x_9-> (u (u fm_term_inline_reduce (u (u fm_term_app (u _6132 _x_9)) _6116)) _defs_2)))); (7,f) -> u f (\_6133 _6134 _6135-> _term_1); (8,f) -> u f (\_6136 _6137 _6138-> _term_1); (9,f) -> u f (\_6139 _6140 _6141-> _term_1); (10,f) -> u f (\_6142-> _term_1); (11,f) -> u f (\_6143-> _term_1); (12,f) -> u f (\_6144-> _term_1); (13,f) -> u f (\_6145-> _term_1); (14,f) -> u f (\_6146 _6147 _6148 _6149 _6150 _6151-> _term_1); (15,f) -> u f (\_6152 _6153-> _term_1); })))); (6,f) -> u f (\_6154 _6155 _6156-> _term_1); (7,f) -> u f (\_6157 _6158 _6159-> _term_1); (8,f) -> u f (\_6160 _6161 _6162-> _term_1); (9,f) -> u f (\_6163 _6164 _6165-> _term_1); (10,f) -> u f (\_6166-> _term_1); (11,f) -> u f (\_6167-> _term_1); (12,f) -> u f (\_6168-> _term_1); (13,f) -> u f (\_6169-> _term_1); (14,f) -> u f (\_6170 _6171 _6172 _6173 _6174 _6175-> _term_1); (15,f) -> u f (\_6176 _6177-> (u (u fm_term_inline_reduce _6177) _defs_2)); }))))
fm_term_inline = (\_term_1-> (\_defs_2-> (let _6178 = (u (u fm_term_inline_reduce _term_1) _defs_2) in (case _6178 of {(0,f) -> u f (\_6179 _6180-> (u (u fm_term_var _6179) _6180)); (1,f) -> u f (\_6181-> (u fm_term_ref _6181)); (2,f) -> u f (fm_term_typ); (3,f) -> u f (\_6182 _6183 _6184 _6185 _6186-> (u (u (u (u (u fm_term_all _6182) _6183) _6184) (u (u fm_term_inline _6185) _defs_2)) (\_s_8-> (\_x_9-> (u (u fm_term_inline (u (u _6186 _s_8) _x_9)) _defs_2))))); (4,f) -> u f (\_6187 _6188-> (u (u fm_term_lam _6187) (\_x_5-> (u (u fm_term_inline (u _6188 _x_5)) _defs_2)))); (5,f) -> u f (\_6189 _6190-> (u (u fm_term_app (u (u fm_term_inline _6189) _defs_2)) (u (u fm_term_inline _6190) _defs_2))); (6,f) -> u f (\_6191 _6192 _6193-> (u (u (u fm_term_let _6191) (u (u fm_term_inline _6192) _defs_2)) (\_x_6-> (u (u fm_term_inline (u _6193 _x_6)) _defs_2)))); (7,f) -> u f (\_6194 _6195 _6196-> (u (u (u fm_term_def _6194) (u (u fm_term_inline _6195) _defs_2)) (\_x_6-> (u (u fm_term_inline (u _6196 _x_6)) _defs_2)))); (8,f) -> u f (\_6197 _6198 _6199-> (u (u (u fm_term_ann _6197) (u (u fm_term_inline _6198) _defs_2)) (u (u fm_term_inline _6199) _defs_2))); (9,f) -> u f (\_6200 _6201 _6202-> (u (u (u fm_term_gol _6200) _6201) _6202)); (10,f) -> u f (\_6203-> (u fm_term_hol _6203)); (11,f) -> u f (\_6204-> (u fm_term_nat _6204)); (12,f) -> u f (\_6205-> (u fm_term_chr _6205)); (13,f) -> u f (\_6206-> (u fm_term_str _6206)); (14,f) -> u f (\_6207 _6208 _6209 _6210 _6211 _6212-> _term_1); (15,f) -> u f (\_6213 _6214-> (u (u fm_term_inline _6214) _defs_2)); }))))
map_values_go = (\_xs_2-> (\_list_3-> (let _6215 = _xs_2 in (case _6215 of {(0,f) -> u f (_list_3); (1,f) -> u f (\_6216 _6217 _6218-> (let _list0_7=(let _6219 = _6216 in (case _6219 of {(0,f) -> u f (_list_3); (1,f) -> u f (\_6220-> (u (u list_cons _6220) _list_3)); })) in (let _list1_8=(u (u map_values_go _6217) _list0_7) in (let _list2_9=(u (u map_values_go _6218) _list1_8) in _list2_9)))); }))))
map_values = (\_xs_2-> (u (u map_values_go _xs_2) list_nil))
fm_core_var_name = (\_indx_1-> (\_name_2-> (\_brui_3-> (\_vars_4-> (let _6221 = _indx_1 in (if _6221==0 then (let _6222 = _brui_3 in (if _6222==0 then _name_2 else (((_name_2::String) ++ ((("^"::String) ++ (u nat_show _brui_3))))))) else (let _6223 = _vars_4 in (case _6223 of {(0,f) -> u f ("unbound"); (1,f) -> u f (\_6224 _6225-> (let _brui_8=(let _6226 = (((_name_2::String) == _6224)) in (if _6226 then (u nat_succ _brui_3) else _brui_3)) in (u (u (u (u fm_core_var_name (_6221-1)) _name_2) _brui_8) _6225))); }))))))))
fm_name_show = (\_name_1-> _name_1)
bits_to_nat = (\_b_1-> (let _6227 = _b_1 in (case _6227 of {(0,f) -> u f (0); (1,f) -> u f (\_6228-> (((2::Integer) * (u bits_to_nat _6228)))); (2,f) -> u f (\_6229-> (u nat_succ (((2::Integer) * (u bits_to_nat _6229))))); })))
u16_show_hex = (\_a_1-> (let _6230 = _a_1 in (u (u nat_to_string_base 16) (u bits_to_nat (u word_to_bits (u16_to_word _6230))))))
fm_escape_char = (\_chr_1-> (let _6231 = (((_chr_1::Word16) == fm_backslash)) in (if _6231 then (u (u string_cons fm_backslash) (u (u string_cons _chr_1) string_nil)) else (let _6232 = (((_chr_1::Word16) == 34)) in (if _6232 then (u (u string_cons fm_backslash) (u (u string_cons _chr_1) string_nil)) else (let _6233 = (((_chr_1::Word16) == 39)) in (if _6233 then (u (u string_cons fm_backslash) (u (u string_cons _chr_1) string_nil)) else (let _6234 = (u (u (u u16_btw 32) _chr_1) 126) in (if _6234 then (u (u string_cons _chr_1) string_nil) else (u string_flatten (u (u list_cons (u (u string_cons fm_backslash) string_nil)) (u (u list_cons "u{") (u (u list_cons (u u16_show_hex _chr_1)) (u (u list_cons "}") (u (u list_cons string_nil) list_nil)))))))))))))))
fm_escape = (\_str_1-> (let _6235 = _str_1 in (if null (_6235::String) then string_nil else (let _head_4=(u fm_escape_char (fromIntegral (fromEnum (head _6235 :: Char)) :: Word16)) in (let _tail_5=(u fm_escape (tail _6235)) in (((_head_4::String) ++ _tail_5)))))))
fm_core_show = (\_term_1-> (\_indx_2-> (\_vars_3-> (let _6236 = _term_1 in (case _6236 of {(0,f) -> u f (\_6237 _6238-> (u (u (u (u fm_core_var_name (u nat_pred (((_indx_2::Integer) - _6238)))) _6237) 0) _vars_3)); (1,f) -> u f (\_6239-> (u fm_name_show _6239)); (2,f) -> u f ("*"); (3,f) -> u f (\_6240 _6241 _6242 _6243 _6244-> (let _eras_9=_6240 in (let _init_10=(let _6245 = _eras_9 in (if _6245 then "%" else "@")) in (let _self_11=(u fm_name_show _6241) in (let _name_12=(u fm_name_show _6242) in (let _xtyp_13=(u (u (u fm_core_show _6243) _indx_2) _vars_3) in (let _body_14=(u (u (u fm_core_show (u (u _6244 (u (u fm_term_var _6241) _indx_2)) (u (u fm_term_var _6242) (u nat_succ _indx_2)))) (u nat_succ (u nat_succ _indx_2))) (u (u list_cons _6242) (u (u list_cons _6241) _vars_3))) in (u string_flatten (u (u list_cons _init_10) (u (u list_cons _self_11) (u (u list_cons "(") (u (u list_cons _name_12) (u (u list_cons ":") (u (u list_cons _xtyp_13) (u (u list_cons ") ") (u (u list_cons _body_14) list_nil)))))))))))))))); (4,f) -> u f (\_6246 _6247-> (let _name_6=(u fm_name_show _6246) in (let _body_7=(u (u (u fm_core_show (u _6247 (u (u fm_term_var _6246) _indx_2))) (u nat_succ _indx_2)) (u (u list_cons _6246) _vars_3)) in (u string_flatten (u (u list_cons "#") (u (u list_cons _name_6) (u (u list_cons " ") (u (u list_cons _body_7) list_nil)))))))); (5,f) -> u f (\_6248 _6249-> (let _func_6=(u (u (u fm_core_show _6248) _indx_2) _vars_3) in (let _argm_7=(u (u (u fm_core_show _6249) _indx_2) _vars_3) in (u string_flatten (u (u list_cons "(") (u (u list_cons _func_6) (u (u list_cons " ") (u (u list_cons _argm_7) (u (u list_cons ")") list_nil))))))))); (6,f) -> u f (\_6250 _6251 _6252-> (let _name_7=(u fm_name_show _6250) in (let _expr_8=(u (u (u fm_core_show _6251) _indx_2) _vars_3) in (let _body_9=(u (u (u fm_core_show (u _6252 (u (u fm_term_var _6250) _indx_2))) (u nat_succ _indx_2)) (u (u list_cons _6250) _vars_3)) in (u string_flatten (u (u list_cons "!") (u (u list_cons _name_7) (u (u list_cons " = ") (u (u list_cons _expr_8) (u (u list_cons "; ") (u (u list_cons _body_9) list_nil))))))))))); (7,f) -> u f (\_6253 _6254 _6255-> (let _name_7=(u fm_name_show _6253) in (let _expr_8=(u (u (u fm_core_show _6254) _indx_2) _vars_3) in (let _body_9=(u (u (u fm_core_show (u _6255 (u (u fm_term_var _6253) _indx_2))) (u nat_succ _indx_2)) (u (u list_cons _6253) _vars_3)) in (u string_flatten (u (u list_cons "$") (u (u list_cons _name_7) (u (u list_cons " = ") (u (u list_cons _expr_8) (u (u list_cons "; ") (u (u list_cons _body_9) list_nil))))))))))); (8,f) -> u f (\_6256 _6257 _6258-> (let _term_7=(u (u (u fm_core_show _6257) _indx_2) _vars_3) in (let _type_8=(u (u (u fm_core_show _6258) _indx_2) _vars_3) in (u string_flatten (u (u list_cons "{") (u (u list_cons _term_7) (u (u list_cons ":") (u (u list_cons _type_8) (u (u list_cons "}") list_nil))))))))); (9,f) -> u f (\_6259 _6260 _6261-> "<GOL>"); (10,f) -> u f (\_6262-> "<HOL>"); (11,f) -> u f (\_6263-> (u string_flatten (u (u list_cons "+") (u (u list_cons (u nat_show _6263)) list_nil)))); (12,f) -> u f (\_6264-> (u string_flatten (u (u list_cons "'") (u (u list_cons (u fm_escape_char _6264)) (u (u list_cons "'") list_nil))))); (13,f) -> u f (\_6265-> (u string_flatten (u (u list_cons "\"") (u (u list_cons (u fm_escape _6265)) (u (u list_cons "\"") list_nil))))); (14,f) -> u f (\_6266 _6267 _6268 _6269 _6270 _6271-> "<CSE>"); (15,f) -> u f (\_6272 _6273-> (u (u (u fm_core_show _6273) _indx_2) _vars_3)); })))))
fm_defs_core = (\_defs_1-> (let _result_2="" in (let _result_3=(u (u (u list_for (u map_values _defs_1)) _result_2) (\_defn_3-> (\_result_4-> (let _6274 = _defn_3 in (case _6274 of {(0,f) -> u f (\_6275 _6276 _6277 _6278 _6279 _6280-> (let _6281 = _6280 in (case _6281 of {(0,f) -> u f (_result_4); (1,f) -> u f (_result_4); (2,f) -> u f ((let _name_11=_6277 in (let _term_12=(u (u (u fm_core_show _6278) 0) list_nil) in (let _type_13=(u (u (u fm_core_show _6279) 0) list_nil) in (u string_flatten (u (u list_cons _result_4) (u (u list_cons _name_11) (u (u list_cons " : ") (u (u list_cons _type_13) (u (u list_cons " = ") (u (u list_cons _term_12) (u (u list_cons ";\n") list_nil)))))))))))); (3,f) -> u f (\_6282-> _result_4); }))); }))))) in _result_3)))
fm_to_core_io_one = (\_name_1-> (u (u (u io_monad (\_m_bind_2-> (\_m_pure_3-> _m_bind_2))) (u (u fm_synth_one _name_1) map_new)) (\_new_defs_2-> (let _defs_3=(let _6283 = _new_defs_2 in (case _6283 of {(0,f) -> u f (map_new); (1,f) -> u f (\_6284-> _6284); })) in (let _defs_4=(u (u map_map (\_defn_4-> (let _6285 = _defn_4 in (case _6285 of {(0,f) -> u f (\_6286 _6287 _6288 _6289 _6290 _6291-> (let _term_11=(u (u fm_term_inline _6289) _defs_3) in (let _type_12=(u (u fm_term_inline _6290) _defs_3) in (u (u (u (u (u (u fm_def_new _6286) _6287) _6288) _term_11) _type_12) _6291)))); })))) _defs_3) in (u (u io_monad (\_m_bind_5-> (\_m_pure_6-> _m_pure_6))) (u fm_defs_core _defs_4)))))))
io_print = (\_text_1-> (u (u (u io_ask "print") _text_1) (\_skip_2-> (u io_end unit_new))))
maybe_bind = (\_m_3-> (\_f_4-> (let _6292 = _m_3 in (case _6292 of {(0,f) -> u f (maybe_none); (1,f) -> u f (\_6293-> (u _f_4 _6293)); }))))
maybe_monad = (\_new_2-> (u (u _new_2 maybe_bind) maybe_some))
fm_term_show_as_nat_go = (\_term_1-> (let _6294 = _term_1 in (case _6294 of {(0,f) -> u f (\_6295 _6296-> maybe_none); (1,f) -> u f (\_6297-> (let _6298 = (((_6297::String) == "Nat.zero")) in (if _6298 then (u maybe_some 0) else maybe_none))); (2,f) -> u f (maybe_none); (3,f) -> u f (\_6299 _6300 _6301 _6302 _6303-> maybe_none); (4,f) -> u f (\_6304 _6305-> maybe_none); (5,f) -> u f (\_6306 _6307-> (let _6308 = _6306 in (case _6308 of {(0,f) -> u f (\_6309 _6310-> maybe_none); (1,f) -> u f (\_6311-> (let _6312 = (((_6311::String) == "Nat.succ")) in (if _6312 then (u (u (u maybe_monad (\_m_bind_5-> (\_m_pure_6-> _m_bind_5))) (u fm_term_show_as_nat_go _6307)) (\_pred_5-> (u (u maybe_monad (\_m_bind_6-> (\_m_pure_7-> _m_pure_7))) (u nat_succ _pred_5)))) else maybe_none))); (2,f) -> u f (maybe_none); (3,f) -> u f (\_6313 _6314 _6315 _6316 _6317-> maybe_none); (4,f) -> u f (\_6318 _6319-> maybe_none); (5,f) -> u f (\_6320 _6321-> maybe_none); (6,f) -> u f (\_6322 _6323 _6324-> maybe_none); (7,f) -> u f (\_6325 _6326 _6327-> maybe_none); (8,f) -> u f (\_6328 _6329 _6330-> maybe_none); (9,f) -> u f (\_6331 _6332 _6333-> maybe_none); (10,f) -> u f (\_6334-> maybe_none); (11,f) -> u f (\_6335-> maybe_none); (12,f) -> u f (\_6336-> maybe_none); (13,f) -> u f (\_6337-> maybe_none); (14,f) -> u f (\_6338 _6339 _6340 _6341 _6342 _6343-> maybe_none); (15,f) -> u f (\_6344 _6345-> maybe_none); }))); (6,f) -> u f (\_6346 _6347 _6348-> maybe_none); (7,f) -> u f (\_6349 _6350 _6351-> maybe_none); (8,f) -> u f (\_6352 _6353 _6354-> maybe_none); (9,f) -> u f (\_6355 _6356 _6357-> maybe_none); (10,f) -> u f (\_6358-> maybe_none); (11,f) -> u f (\_6359-> maybe_none); (12,f) -> u f (\_6360-> maybe_none); (13,f) -> u f (\_6361-> maybe_none); (14,f) -> u f (\_6362 _6363 _6364 _6365 _6366 _6367-> maybe_none); (15,f) -> u f (\_6368 _6369-> maybe_none); })))
fm_term_show_as_nat = (\_term_1-> (u (u maybe_mapped (u fm_term_show_as_nat_go _term_1)) nat_show))
fm_term_show_is_ref = (\_term_1-> (\_name_2-> (let _6370 = _term_1 in (case _6370 of {(0,f) -> u f (\_6371 _6372-> bool_false); (1,f) -> u f (\_6373-> (((_name_2::String) == _6373))); (2,f) -> u f (bool_false); (3,f) -> u f (\_6374 _6375 _6376 _6377 _6378-> bool_false); (4,f) -> u f (\_6379 _6380-> bool_false); (5,f) -> u f (\_6381 _6382-> bool_false); (6,f) -> u f (\_6383 _6384 _6385-> bool_false); (7,f) -> u f (\_6386 _6387 _6388-> bool_false); (8,f) -> u f (\_6389 _6390 _6391-> bool_false); (9,f) -> u f (\_6392 _6393 _6394-> bool_false); (10,f) -> u f (\_6395-> bool_false); (11,f) -> u f (\_6396-> bool_false); (12,f) -> u f (\_6397-> bool_false); (13,f) -> u f (\_6398-> bool_false); (14,f) -> u f (\_6399 _6400 _6401 _6402 _6403 _6404-> bool_false); (15,f) -> u f (\_6405 _6406-> bool_false); }))))
fm_term_show_app_done = (\_term_1-> (\_path_2-> (\_args_3-> (let _arity_4=(u list_length _args_3) in (let _6407 = (((u (u fm_term_show_is_ref _term_1) "Equal") && (((_arity_4::Integer) == 3)))) in (if _6407 then (let _func_5=(u (u fm_term_show_go _term_1) _path_2) in (let _eq_lft_6=(u (u maybe_default "?") (u (u list_at 1) _args_3)) in (let _eq_rgt_7=(u (u maybe_default "?") (u (u list_at 2) _args_3)) in (u string_flatten (u (u list_cons _eq_lft_6) (u (u list_cons " == ") (u (u list_cons _eq_rgt_7) list_nil))))))) else (let _func_5=(u (u fm_term_show_go _term_1) _path_2) in (let _wrap_6=(let _6408 = _func_5 in (if null (_6408::String) then bool_false else ((((fromIntegral (fromEnum (head _6408 :: Char)) :: Word16)::Word16) == 40)))) in (let _args_7=(u (u string_join ",") _args_3) in (let _func_8=(let _6409 = _wrap_6 in (if _6409 then (u string_flatten (u (u list_cons "(") (u (u list_cons _func_5) (u (u list_cons ")") list_nil)))) else _func_5)) in (u string_flatten (u (u list_cons _func_8) (u (u list_cons "(") (u (u list_cons _args_7) (u (u list_cons ")") list_nil)))))))))))))))
fm_term_show_app = (\_term_1-> (\_path_2-> (\_args_3-> (let _6410 = _term_1 in (case _6410 of {(0,f) -> u f (\_6411 _6412-> (u (u (u fm_term_show_app_done _term_1) _path_2) _args_3)); (1,f) -> u f (\_6413-> (u (u (u fm_term_show_app_done _term_1) _path_2) _args_3)); (2,f) -> u f ((u (u (u fm_term_show_app_done _term_1) _path_2) _args_3)); (3,f) -> u f (\_6414 _6415 _6416 _6417 _6418-> (u (u (u fm_term_show_app_done _term_1) _path_2) _args_3)); (4,f) -> u f (\_6419 _6420-> (u (u (u fm_term_show_app_done _term_1) _path_2) _args_3)); (5,f) -> u f (\_6421 _6422-> (u (u (u fm_term_show_app _6421) (u fm_mpath_o _path_2)) (u (u list_cons (u (u fm_term_show_go _6422) (u fm_mpath_i _path_2))) _args_3))); (6,f) -> u f (\_6423 _6424 _6425-> (u (u (u fm_term_show_app_done _term_1) _path_2) _args_3)); (7,f) -> u f (\_6426 _6427 _6428-> (u (u (u fm_term_show_app_done _term_1) _path_2) _args_3)); (8,f) -> u f (\_6429 _6430 _6431-> (u (u (u fm_term_show_app_done _term_1) _path_2) _args_3)); (9,f) -> u f (\_6432 _6433 _6434-> (u (u (u fm_term_show_app_done _term_1) _path_2) _args_3)); (10,f) -> u f (\_6435-> (u (u (u fm_term_show_app_done _term_1) _path_2) _args_3)); (11,f) -> u f (\_6436-> (u (u (u fm_term_show_app_done _term_1) _path_2) _args_3)); (12,f) -> u f (\_6437-> (u (u (u fm_term_show_app_done _term_1) _path_2) _args_3)); (13,f) -> u f (\_6438-> (u (u (u fm_term_show_app_done _term_1) _path_2) _args_3)); (14,f) -> u f (\_6439 _6440 _6441 _6442 _6443 _6444-> (u (u (u fm_term_show_app_done _term_1) _path_2) _args_3)); (15,f) -> u f (\_6445 _6446-> (u (u (u fm_term_show_app _6446) _path_2) _args_3)); })))))
map_to_list_go = (\_xs_2-> (\_key_3-> (\_list_4-> (let _6447 = _xs_2 in (case _6447 of {(0,f) -> u f (_list_4); (1,f) -> u f (\_6448 _6449 _6450-> (let _list0_8=(let _6451 = _6448 in (case _6451 of {(0,f) -> u f (_list_4); (1,f) -> u f (\_6452-> (u (u list_cons (u (u pair_new (u bits_reverse _key_3)) _6452)) _list_4)); })) in (let _list1_9=(u (u (u map_to_list_go _6449) (u bits_o _key_3)) _list0_8) in (let _list2_10=(u (u (u map_to_list_go _6450) (u bits_i _key_3)) _list1_9) in _list2_10)))); })))))
map_to_list = (\_xs_2-> (u list_reverse (u (u (u map_to_list_go _xs_2) bits_e) list_nil)))
bits_chunks_of_go = (\_len_1-> (\_bits_2-> (\_need_3-> (\_chunk_4-> (let _6453 = _bits_2 in (case _6453 of {(0,f) -> u f ((u (u list_cons (u bits_reverse _chunk_4)) list_nil)); (1,f) -> u f (\_6454-> (let _6455 = _need_3 in (if _6455==0 then (let _head_6=(u bits_reverse _chunk_4) in (let _tail_7=(u (u (u (u bits_chunks_of_go _len_1) _bits_2) _len_1) bits_e) in (u (u list_cons _head_6) _tail_7))) else (let _chunk_7=(u bits_o _chunk_4) in (u (u (u (u bits_chunks_of_go _len_1) _6454) (_6455-1)) _chunk_7))))); (2,f) -> u f (\_6456-> (let _6457 = _need_3 in (if _6457==0 then (let _head_6=(u bits_reverse _chunk_4) in (let _tail_7=(u (u (u (u bits_chunks_of_go _len_1) _bits_2) _len_1) bits_e) in (u (u list_cons _head_6) _tail_7))) else (let _chunk_7=(u bits_i _chunk_4) in (u (u (u (u bits_chunks_of_go _len_1) _6456) (_6457-1)) _chunk_7))))); }))))))
bits_chunks_of = (\_len_1-> (\_bits_2-> (u (u (u (u bits_chunks_of_go _len_1) _bits_2) _len_1) bits_e)))
word_from_bits = (\_size_1-> (\_bits_2-> (let _6458 = _size_1 in (if _6458==0 then word_e else (let _6459 = _bits_2 in (case _6459 of {(0,f) -> u f ((u word_o (u (u word_from_bits (_6458-1)) bits_e))); (1,f) -> u f (\_6460-> (u word_o (u (u word_from_bits (_6458-1)) _6460))); (2,f) -> u f (\_6461-> (u word_i (u (u word_from_bits (_6458-1)) _6461))); }))))))
fm_name_from_bits = (\_bits_1-> (let _list_2=(u (u bits_chunks_of 6) _bits_1) in (let _name_3=(u (u (u list_fold _list_2) string_nil) (\_bts_3-> (\_name_4-> (let _u16_5=(u u16_new (u (u word_from_bits 16) (u bits_reverse _bts_3))) in (let _chr_6=(let _6462 = (u (u (u u16_btw 0) _u16_5) 25) in (if _6462 then (((_u16_5::Word16) + 65)) else (let _6463 = (u (u (u u16_btw 26) _u16_5) 51) in (if _6463 then (((_u16_5::Word16) + 71)) else (let _6464 = (u (u (u u16_btw 52) _u16_5) 61) in (if _6464 then (((_u16_5::Word16) - 4)) else (let _6465 = (((62::Word16) == _u16_5)) in (if _6465 then 46 else 95)))))))) in (u (u string_cons _chr_6) _name_4)))))) in _name_3)))
fm_term_show_go = (\_term_1-> (\_path_2-> (let _6466 = (u fm_term_show_as_nat _term_1) in (case _6466 of {(0,f) -> u f ((let _6467 = _term_1 in (case _6467 of {(0,f) -> u f (\_6468 _6469-> (u fm_name_show _6468)); (1,f) -> u f (\_6470-> (let _name_4=(u fm_name_show _6470) in (let _6471 = _path_2 in (case _6471 of {(0,f) -> u f (_name_4); (1,f) -> u f (\_6472-> (let _path_val_6=(u (u bits_concat (u fm_path_to_bits _6472)) (u bits_i bits_e)) in (let _path_str_7=(u nat_show (u bits_to_nat _path_val_6)) in (u string_flatten (u (u list_cons _name_4) (u (u list_cons (u (u fm_color "2") ((("-"::String) ++ _path_str_7)))) list_nil)))))); })))); (2,f) -> u f ("Type"); (3,f) -> u f (\_6473 _6474 _6475 _6476 _6477-> (let _eras_8=_6473 in (let _self_9=(u fm_name_show _6474) in (let _name_10=(u fm_name_show _6475) in (let _type_11=(u (u fm_term_show_go _6476) (u fm_mpath_o _path_2)) in (let _open_12=(let _6478 = _eras_8 in (if _6478 then "<" else "(")) in (let _clos_13=(let _6479 = _eras_8 in (if _6479 then ">" else ")")) in (let _body_14=(u (u fm_term_show_go (u (u _6477 (u (u fm_term_var _6474) 0)) (u (u fm_term_var _6475) 0))) (u fm_mpath_i _path_2)) in (u string_flatten (u (u list_cons _self_9) (u (u list_cons _open_12) (u (u list_cons _name_10) (u (u list_cons ":") (u (u list_cons _type_11) (u (u list_cons _clos_13) (u (u list_cons " ") (u (u list_cons _body_14) list_nil))))))))))))))))); (4,f) -> u f (\_6480 _6481-> (let _name_5=(u fm_name_show _6480) in (let _body_6=(u (u fm_term_show_go (u _6481 (u (u fm_term_var _6480) 0))) (u fm_mpath_o _path_2)) in (u string_flatten (u (u list_cons "(") (u (u list_cons _name_5) (u (u list_cons ") ") (u (u list_cons _body_6) list_nil)))))))); (5,f) -> u f (\_6482 _6483-> (u (u (u fm_term_show_app _term_1) _path_2) list_nil)); (6,f) -> u f (\_6484 _6485 _6486-> (let _name_6=(u fm_name_show _6484) in (let _expr_7=(u (u fm_term_show_go _6485) (u fm_mpath_o _path_2)) in (let _body_8=(u (u fm_term_show_go (u _6486 (u (u fm_term_var _6484) 0))) (u fm_mpath_i _path_2)) in (u string_flatten (u (u list_cons "let ") (u (u list_cons _name_6) (u (u list_cons " = ") (u (u list_cons _expr_7) (u (u list_cons "; ") (u (u list_cons _body_8) list_nil))))))))))); (7,f) -> u f (\_6487 _6488 _6489-> (let _name_6=(u fm_name_show _6487) in (let _expr_7=(u (u fm_term_show_go _6488) (u fm_mpath_o _path_2)) in (let _body_8=(u (u fm_term_show_go (u _6489 (u (u fm_term_var _6487) 0))) (u fm_mpath_i _path_2)) in (u string_flatten (u (u list_cons "def ") (u (u list_cons _name_6) (u (u list_cons " = ") (u (u list_cons _expr_7) (u (u list_cons "; ") (u (u list_cons _body_8) list_nil))))))))))); (8,f) -> u f (\_6490 _6491 _6492-> (let _term_6=(u (u fm_term_show_go _6491) (u fm_mpath_o _path_2)) in (let _type_7=(u (u fm_term_show_go _6492) (u fm_mpath_i _path_2)) in (u string_flatten (u (u list_cons _term_6) (u (u list_cons "::") (u (u list_cons _type_7) list_nil))))))); (9,f) -> u f (\_6493 _6494 _6495-> (let _name_6=(u fm_name_show _6493) in (u string_flatten (u (u list_cons "?") (u (u list_cons _name_6) list_nil))))); (10,f) -> u f (\_6496-> "_"); (11,f) -> u f (\_6497-> (u string_flatten (u (u list_cons (u nat_show _6497)) list_nil))); (12,f) -> u f (\_6498-> (u string_flatten (u (u list_cons "'") (u (u list_cons (u fm_escape_char _6498)) (u (u list_cons "'") list_nil))))); (13,f) -> u f (\_6499-> (u string_flatten (u (u list_cons "\"") (u (u list_cons (u fm_escape _6499)) (u (u list_cons "\"") list_nil))))); (14,f) -> u f (\_6500 _6501 _6502 _6503 _6504 _6505-> (let _expr_9=(u (u fm_term_show_go _6501) (u fm_mpath_o _path_2)) in (let _name_10=(u fm_name_show _6502) in (let _wyth_11=(u (u string_join "") (u (u list_mapped _6503) (\_defn_11-> (let _6506 = _defn_11 in (case _6506 of {(0,f) -> u f (\_6507 _6508 _6509 _6510 _6511 _6512-> (let _name_18=(u fm_name_show _6509) in (let _type_19=(u (u fm_term_show_go _6511) maybe_none) in (let _term_20=(u (u fm_term_show_go _6510) maybe_none) in (u string_flatten (u (u list_cons _name_18) (u (u list_cons ": ") (u (u list_cons _type_19) (u (u list_cons " = ") (u (u list_cons _term_20) (u (u list_cons ";") list_nil))))))))))); }))))) in (let _cses_12=(u map_to_list _6504) in (let _cses_13=(u (u string_join "") (u (u list_mapped _cses_12) (\_x_13-> (let _name_14=(u fm_name_from_bits (u pair_fst _x_13)) in (let _term_15=(u (u fm_term_show_go (u pair_snd _x_13)) maybe_none) in (u string_flatten (u (u list_cons _name_14) (u (u list_cons ": ") (u (u list_cons _term_15) (u (u list_cons "; ") list_nil)))))))))) in (let _moti_14=(let _6513 = _6505 in (case _6513 of {(0,f) -> u f (""); (1,f) -> u f (\_6514-> (u string_flatten (u (u list_cons ": ") (u (u list_cons (u (u fm_term_show_go _6514) maybe_none)) list_nil)))); })) in (u string_flatten (u (u list_cons "case ") (u (u list_cons _expr_9) (u (u list_cons " as ") (u (u list_cons _name_10) (u (u list_cons _wyth_11) (u (u list_cons " { ") (u (u list_cons _cses_13) (u (u list_cons "}") (u (u list_cons _moti_14) list_nil))))))))))))))))); (15,f) -> u f (\_6515 _6516-> (u (u fm_term_show_go _6516) _path_2)); }))); (1,f) -> u f (\_6517-> _6517); }))))
fm_term_show = (\_term_1-> (u (u fm_term_show_go _term_1) maybe_none))
fm_error_relevant = (\_errors_1-> (\_got_2-> (let _6518 = _errors_1 in (case _6518 of {(0,f) -> u f (list_nil); (1,f) -> u f (\_6519 _6520-> (let _keep_5=(let _6521 = _6519 in (case _6521 of {(0,f) -> u f (\_6522 _6523 _6524 _6525-> ((not _got_2))); (1,f) -> u f (\_6526 _6527 _6528 _6529 _6530-> bool_true); (2,f) -> u f (\_6531-> bool_false); (3,f) -> u f (\_6532-> bool_false); (4,f) -> u f (\_6533 _6534-> bool_false); (5,f) -> u f (\_6535 _6536-> ((not _got_2))); (6,f) -> u f (\_6537 _6538 _6539-> ((not _got_2))); })) in (let _got_6=(let _6540 = _6519 in (case _6540 of {(0,f) -> u f (\_6541 _6542 _6543 _6544-> bool_true); (1,f) -> u f (\_6545 _6546 _6547 _6548 _6549-> _got_2); (2,f) -> u f (\_6550-> _got_2); (3,f) -> u f (\_6551-> _got_2); (4,f) -> u f (\_6552 _6553-> _got_2); (5,f) -> u f (\_6554 _6555-> bool_true); (6,f) -> u f (\_6556 _6557 _6558-> _got_2); })) in (let _tail_7=(u (u fm_error_relevant _6520) _got_6) in (let _6559 = _keep_5 in (if _6559 then (u (u list_cons _6519) _tail_7) else _tail_7)))))); }))))
fm_context_show = (\_context_1-> (let _6560 = _context_1 in (case _6560 of {(0,f) -> u f (""); (1,f) -> u f (\_6561 _6562-> (let _6563 = _6561 in (case _6563 of {(0,f) -> u f (\_6564 _6565-> (let _name_6=(u fm_name_show _6564) in (let _type_7=(u fm_term_show (u (u fm_term_normalize _6565) map_new)) in (let _rest_8=(u fm_context_show _6562) in (u string_flatten (u (u list_cons _rest_8) (u (u list_cons "- ") (u (u list_cons _name_6) (u (u list_cons ": ") (u (u list_cons _type_7) (u (u list_cons "\n") list_nil))))))))))); }))); })))
fm_term_expand_at = (\_path_1-> (\_term_2-> (\_defs_3-> (u (u (u fm_term_patch_at _path_1) _term_2) (\_term_4-> (let _6566 = _term_4 in (case _6566 of {(0,f) -> u f (\_6567 _6568-> _term_4); (1,f) -> u f (\_6569-> (let _6570 = (u (u fm_get _6569) _defs_3) in (case _6570 of {(0,f) -> u f ((u fm_term_ref _6569)); (1,f) -> u f (\_6571-> (let _6572 = _6571 in (case _6572 of {(0,f) -> u f (\_6573 _6574 _6575 _6576 _6577 _6578-> _6576); }))); }))); (2,f) -> u f (_term_4); (3,f) -> u f (\_6579 _6580 _6581 _6582 _6583-> _term_4); (4,f) -> u f (\_6584 _6585-> _term_4); (5,f) -> u f (\_6586 _6587-> _term_4); (6,f) -> u f (\_6588 _6589 _6590-> _term_4); (7,f) -> u f (\_6591 _6592 _6593-> _term_4); (8,f) -> u f (\_6594 _6595 _6596-> _term_4); (9,f) -> u f (\_6597 _6598 _6599-> _term_4); (10,f) -> u f (\_6600-> _term_4); (11,f) -> u f (\_6601-> _term_4); (12,f) -> u f (\_6602-> _term_4); (13,f) -> u f (\_6603-> _term_4); (14,f) -> u f (\_6604 _6605 _6606 _6607 _6608 _6609-> _term_4); (15,f) -> u f (\_6610 _6611-> _term_4); })))))))
fm_term_expand_ct = (\_term_1-> (\_defs_2-> (\_arity_3-> (let _6612 = _term_1 in (case _6612 of {(0,f) -> u f (\_6613 _6614-> (u (u fm_term_var _6613) _6614)); (1,f) -> u f (\_6615-> (let _expand_5=bool_false in (let _expand_6=(((((((_6615::String) == "Nat.succ")) && (((_arity_3::Integer) > 1)))) || _expand_5)) in (let _expand_7=(((((((_6615::String) == "Nat.zero")) && (((_arity_3::Integer) > 0)))) || _expand_6)) in (let _expand_8=(((((((_6615::String) == "Bool.true")) && (((_arity_3::Integer) > 0)))) || _expand_7)) in (let _expand_9=(((((((_6615::String) == "Bool.false")) && (((_arity_3::Integer) > 0)))) || _expand_8)) in (let _6616 = _expand_9 in (if _6616 then (let _6617 = (u (u fm_get _6615) _defs_2) in (case _6617 of {(0,f) -> u f ((u fm_term_ref _6615)); (1,f) -> u f (\_6618-> (let _6619 = _6618 in (case _6619 of {(0,f) -> u f (\_6620 _6621 _6622 _6623 _6624 _6625-> _6623); }))); })) else (u fm_term_ref _6615))))))))); (2,f) -> u f (fm_term_typ); (3,f) -> u f (\_6626 _6627 _6628 _6629 _6630-> (u (u (u (u (u fm_term_all _6626) _6627) _6628) (u (u (u fm_term_expand_ct _6629) _defs_2) 0)) (\_s_9-> (\_x_10-> (u (u (u fm_term_expand_ct (u (u _6630 _s_9) _x_10)) _defs_2) 0))))); (4,f) -> u f (\_6631 _6632-> (u (u fm_term_lam _6631) (\_x_6-> (u (u (u fm_term_expand_ct (u _6632 _x_6)) _defs_2) 0)))); (5,f) -> u f (\_6633 _6634-> (u (u fm_term_app (u (u (u fm_term_expand_ct _6633) _defs_2) (u nat_succ _arity_3))) (u (u (u fm_term_expand_ct _6634) _defs_2) 0))); (6,f) -> u f (\_6635 _6636 _6637-> (u (u (u fm_term_let _6635) (u (u (u fm_term_expand_ct _6636) _defs_2) 0)) (\_x_7-> (u (u (u fm_term_expand_ct (u _6637 _x_7)) _defs_2) 0)))); (7,f) -> u f (\_6638 _6639 _6640-> (u (u (u fm_term_def _6638) (u (u (u fm_term_expand_ct _6639) _defs_2) 0)) (\_x_7-> (u (u (u fm_term_expand_ct (u _6640 _x_7)) _defs_2) 0)))); (8,f) -> u f (\_6641 _6642 _6643-> (u (u (u fm_term_ann _6641) (u (u (u fm_term_expand_ct _6642) _defs_2) 0)) (u (u (u fm_term_expand_ct _6643) _defs_2) 0))); (9,f) -> u f (\_6644 _6645 _6646-> (u (u (u fm_term_gol _6644) _6645) _6646)); (10,f) -> u f (\_6647-> (u fm_term_hol _6647)); (11,f) -> u f (\_6648-> (u fm_term_nat _6648)); (12,f) -> u f (\_6649-> (u fm_term_chr _6649)); (13,f) -> u f (\_6650-> (u fm_term_str _6650)); (14,f) -> u f (\_6651 _6652 _6653 _6654 _6655 _6656-> _term_1); (15,f) -> u f (\_6657 _6658-> (u (u fm_term_ori _6657) _6658)); })))))
fm_term_expand = (\_dref_1-> (\_term_2-> (\_defs_3-> (let _term_4=(u (u fm_term_normalize _term_2) map_new) in (let _term_5=(u (u (u list_for _dref_1) _term_4) (\_path_5-> (\_term_6-> (let _term_7=(u (u (u fm_term_expand_at _path_5) _term_6) _defs_3) in (let _term_8=(u (u fm_term_normalize _term_7) map_new) in (let _term_9=(u (u (u fm_term_expand_ct _term_8) _defs_3) 0) in (let _term_10=(u (u fm_term_normalize _term_9) map_new) in _term_10))))))) in _term_5)))))
fm_error_show = (\_error_1-> (\_defs_2-> (let _6659 = _error_1 in (case _6659 of {(0,f) -> u f (\_6660 _6661 _6662 _6663-> (let _expected_7=(let _6664 = _6661 in (case _6664 of {(0,f) -> u f (\_6665-> _6665); (1,f) -> u f (\_6666-> (u fm_term_show (u (u fm_term_normalize _6666) map_new))); })) in (let _detected_8=(let _6667 = _6662 in (case _6667 of {(0,f) -> u f (\_6668-> _6668); (1,f) -> u f (\_6669-> (u fm_term_show (u (u fm_term_normalize _6669) map_new))); })) in (u string_flatten (u (u list_cons "Type mismatch.\n") (u (u list_cons "- Expected: ") (u (u list_cons _expected_7) (u (u list_cons "\n") (u (u list_cons "- Detected: ") (u (u list_cons _detected_8) (u (u list_cons "\n") (u (u list_cons (let _6670 = _6663 in (case _6670 of {(0,f) -> u f (""); (1,f) -> u f (\_6671 _6672-> (u string_flatten (u (u list_cons "With context:\n") (u (u list_cons (u fm_context_show _6663)) list_nil)))); }))) list_nil)))))))))))); (1,f) -> u f (\_6673 _6674 _6675 _6676 _6677-> (let _goal_name_8=(u string_flatten (u (u list_cons "Goal ?") (u (u list_cons (u fm_name_show _6673)) (u (u list_cons ":\n") list_nil)))) in (let _with_type_9=(let _6678 = _6676 in (case _6678 of {(0,f) -> u f (""); (1,f) -> u f (\_6679-> (let _goal_10=(u (u (u fm_term_expand _6674) _6679) _defs_2) in (u string_flatten (u (u list_cons "With type: ") (u (u list_cons (let _6680 = _6675 in (if _6680 then (u (u fm_term_show_go _goal_10) (u maybe_some (\_x_11-> _x_11))) else (u fm_term_show _goal_10)))) (u (u list_cons "\n") list_nil)))))); })) in (let _with_ctxt_10=(let _6681 = _6677 in (case _6681 of {(0,f) -> u f (""); (1,f) -> u f (\_6682 _6683-> (u string_flatten (u (u list_cons "With ctxt:\n") (u (u list_cons (u fm_context_show _6677)) list_nil)))); })) in (u string_flatten (u (u list_cons _goal_name_8) (u (u list_cons _with_type_9) (u (u list_cons _with_ctxt_10) list_nil)))))))); (2,f) -> u f (\_6684-> (u string_flatten (u (u list_cons "Waiting for '") (u (u list_cons _6684) (u (u list_cons "'.") list_nil))))); (3,f) -> u f (\_6685-> (u string_flatten (u (u list_cons "Error on dependency '") (u (u list_cons _6685) (u (u list_cons "'.") list_nil))))); (4,f) -> u f (\_6686 _6687-> (u string_flatten (u (u list_cons "Patching: ") (u (u list_cons (u fm_term_show _6687)) list_nil)))); (5,f) -> u f (\_6688 _6689-> (u string_flatten (u (u list_cons "Undefined reference: ") (u (u list_cons (u fm_name_show _6689)) (u (u list_cons "\n") list_nil))))); (6,f) -> u f (\_6690 _6691 _6692-> (let _term_6=(u fm_term_show _6691) in (let _context_7=(u fm_context_show _6692) in (u string_flatten (u (u list_cons "Can't infer type of: ") (u (u list_cons _term_6) (u (u list_cons "\n") (u (u list_cons "With ctxt:\n") (u (u list_cons _context_7) list_nil))))))))); }))))
fm_error_origin = (\_error_1-> (let _6693 = _error_1 in (case _6693 of {(0,f) -> u f (\_6694 _6695 _6696 _6697-> _6694); (1,f) -> u f (\_6698 _6699 _6700 _6701 _6702-> maybe_none); (2,f) -> u f (\_6703-> maybe_none); (3,f) -> u f (\_6704-> maybe_none); (4,f) -> u f (\_6705 _6706-> maybe_none); (5,f) -> u f (\_6707 _6708-> _6707); (6,f) -> u f (\_6709 _6710 _6711-> _6709); })))
fm_defs_report_go = (\_defs_1-> (\_list_2-> (\_errs_3-> (\_typs_4-> (let _6712 = _list_2 in (case _6712 of {(0,f) -> u f ((u string_flatten (u (u list_cons _typs_4) (u (u list_cons "\n") (u (u list_cons (let _6713 = _errs_3 in (if null (_6713::String) then "All terms check." else _errs_3))) list_nil))))); (1,f) -> u f (\_6714 _6715-> (let _name_7=_6714 in (let _6716 = (u (u fm_get _name_7) _defs_1) in (case _6716 of {(0,f) -> u f ((u (u (u (u fm_defs_report_go _defs_1) _6715) _errs_3) _typs_4)); (1,f) -> u f (\_6717-> (let _6718 = _6717 in (case _6718 of {(0,f) -> u f (\_6719 _6720 _6721 _6722 _6723 _6724-> (let _typs_15=(u string_flatten (u (u list_cons _typs_4) (u (u list_cons _name_7) (u (u list_cons ": ") (u (u list_cons (u fm_term_show _6723)) (u (u list_cons "\n") list_nil)))))) in (let _6725 = _6724 in (case _6725 of {(0,f) -> u f ((u (u (u (u fm_defs_report_go _defs_1) _6715) _errs_3) _typs_15)); (1,f) -> u f ((u (u (u (u fm_defs_report_go _defs_1) _6715) _errs_3) _typs_15)); (2,f) -> u f ((u (u (u (u fm_defs_report_go _defs_1) _6715) _errs_3) _typs_15)); (3,f) -> u f (\_6726-> (let _6727 = _6726 in (case _6727 of {(0,f) -> u f ((u (u (u (u fm_defs_report_go _defs_1) _6715) _errs_3) _typs_15)); (1,f) -> u f (\_6728 _6729-> (let _name_str_19=(u fm_name_show _6721) in (let _rel_errs_20=(u (u fm_error_relevant _6726) bool_false) in (let _6730 = _rel_errs_20 in (case _6730 of {(0,f) -> u f ((u (u (u (u fm_defs_report_go _defs_1) _6715) _errs_3) _typs_15)); (1,f) -> u f (\_6731 _6732-> (let _rel_msgs_23=(u (u list_mapped _rel_errs_20) (\_err_23-> (u string_flatten (u (u list_cons (u (u fm_error_show _err_23) _defs_1)) (u (u list_cons (let _6733 = (u fm_error_origin _err_23) in (case _6733 of {(0,f) -> u f (""); (1,f) -> u f (\_6734-> (let _6735 = _6734 in (case _6735 of {(0,f) -> u f (\_6736 _6737 _6738-> (u string_flatten (u (u list_cons "Inside '") (u (u list_cons _6719) (u (u list_cons "':\n") (u (u list_cons (u (u (u fm_highlight _6720) _6737) _6738)) (u (u list_cons "\n") list_nil))))))); }))); }))) list_nil))))) in (let _errs_24=(u string_flatten (u (u list_cons _errs_3) (u (u list_cons (u (u string_join "\n") _rel_msgs_23)) (u (u list_cons "\n") list_nil)))) in (u (u (u (u fm_defs_report_go _defs_1) _6715) _errs_24) _typs_15)))); }))))); }))); })))); }))); })))); }))))))
fm_defs_report = (\_defs_1-> (\_list_2-> (u (u (u (u fm_defs_report_go _defs_1) _list_2) "") "")))
fm_checker_io_one = (\_name_1-> (u (u (u io_monad (\_m_bind_2-> (\_m_pure_3-> _m_bind_2))) (u (u fm_synth_one _name_1) map_new)) (\_new_defs_2-> (let _6739 = _new_defs_2 in (case _6739 of {(0,f) -> u f ((u io_print (u (u fm_defs_report map_new) (u (u list_cons _name_1) list_nil)))); (1,f) -> u f (\_6740-> (u io_print (u (u fm_defs_report _6740) (u (u list_cons _name_1) list_nil)))); })))))
map_keys_go = (\_xs_2-> (\_key_3-> (\_list_4-> (let _6741 = _xs_2 in (case _6741 of {(0,f) -> u f (_list_4); (1,f) -> u f (\_6742 _6743 _6744-> (let _list0_8=(let _6745 = _6742 in (case _6745 of {(0,f) -> u f (_list_4); (1,f) -> u f (\_6746-> (u (u list_cons (u bits_reverse _key_3)) _list_4)); })) in (let _list1_9=(u (u (u map_keys_go _6743) (u bits_o _key_3)) _list0_8) in (let _list2_10=(u (u (u map_keys_go _6744) (u bits_i _key_3)) _list1_9) in _list2_10)))); })))))
map_keys = (\_xs_2-> (u list_reverse (u (u (u map_keys_go _xs_2) bits_e) list_nil)))
fm_synth_many = (\_names_1-> (\_defs_2-> (let _6747 = _names_1 in (case _6747 of {(0,f) -> u f ((u (u io_monad (\_m_bind_3-> (\_m_pure_4-> _m_pure_4))) _defs_2)); (1,f) -> u f (\_6748 _6749-> (u (u (u io_monad (\_m_bind_5-> (\_m_pure_6-> _m_bind_5))) (u (u fm_synth_one _6748) _defs_2)) (\_new_defs_5-> (let _6750 = _new_defs_5 in (case _6750 of {(0,f) -> u f ((u (u fm_synth_many _6749) _defs_2)); (1,f) -> u f (\_6751-> (u (u fm_synth_many _6749) _6751)); }))))); }))))
fm_synth_file = (\_file_1-> (\_defs_2-> (u (u (u io_monad (\_m_bind_3-> (\_m_pure_4-> _m_bind_3))) (u io_get_file _file_1)) (\_code_3-> (let _read_4=(u (u (u fm_defs_read _file_1) _code_3) _defs_2) in (let _6752 = _read_4 in (case _6752 of {(0,f) -> u f (\_6753-> (u (u io_monad (\_m_bind_6-> (\_m_pure_7-> _m_pure_7))) (u either_left _6753))); (1,f) -> u f (\_6754-> (let _file_defs_6=_6754 in (let _file_keys_7=(u map_keys _file_defs_6) in (let _file_nams_8=(u (u list_mapped _file_keys_7) fm_name_from_bits) in (u (u (u io_monad (\_m_bind_9-> (\_m_pure_10-> _m_bind_9))) (u (u fm_synth_many _file_nams_8) _file_defs_6)) (\_defs_9-> (u (u io_monad (\_m_bind_10-> (\_m_pure_11-> _m_pure_11))) (u either_right (u (u pair_new _file_nams_8) _defs_9))))))))); })))))))
fm_checker_io_file = (\_file_1-> (u (u (u io_monad (\_m_bind_2-> (\_m_pure_3-> _m_bind_2))) (u (u fm_synth_file _file_1) map_new)) (\_loaded_2-> (let _6755 = _loaded_2 in (case _6755 of {(0,f) -> u f (\_6756-> (u (u (u io_monad (\_m_bind_4-> (\_m_pure_5-> _m_bind_4))) (u io_print (u string_flatten (u (u list_cons "On '") (u (u list_cons _file_1) (u (u list_cons "':") list_nil)))))) (\__4-> (u io_print _6756)))); (1,f) -> u f (\_6757-> (let _6758 = _6757 in (case _6758 of {(0,f) -> u f (\_6759 _6760-> (let _nams_6=_6759 in (let _defs_7=_6760 in (u io_print (u (u fm_defs_report _defs_7) _nams_6))))); }))); })))))
io_purify = (\_io_2-> (let _6761 = _io_2 in (case _6761 of {(0,f) -> u f (\_6762-> _6762); (1,f) -> u f (\_6763 _6764 _6765-> (u io_purify (u _6765 ""))); })))
fm_checker_code = (\_code_1-> (let _6766 = (u (u (u fm_defs_read "Main.fm") _code_1) map_new) in (case _6766 of {(0,f) -> u f (\_6767-> _6767); (1,f) -> u f (\_6768-> (u io_purify (let _defs_3=_6768 in (let _nams_4=(u (u list_mapped (u map_keys _defs_3)) fm_name_from_bits) in (u (u (u io_monad (\_m_bind_5-> (\_m_pure_6-> _m_bind_5))) (u (u fm_synth_many _nams_4) _defs_3)) (\_defs_5-> (u (u io_monad (\_m_bind_6-> (\_m_pure_7-> _m_pure_7))) (u (u fm_defs_report _defs_5) _nams_4)))))))); })))
fm_term_read = (\_code_1-> (let _6769 = (u (u fm_parser_term 0) _code_1) in (case _6769 of {(0,f) -> u f (\_6770 _6771 _6772-> maybe_none); (1,f) -> u f (\_6773 _6774 _6775-> (u maybe_some _6775)); })))
fm_compute_io_one = (\_name_1-> (u (u (u io_monad (\_m_bind_2-> (\_m_pure_3-> _m_bind_2))) (u io_get_file (u fm_synth_file_of _name_1))) (\_code_2-> (let _6776 = (u (u (u fm_defs_read (((_name_1::String) ++ ".fm"))) _code_2) map_new) in (case _6776 of {(0,f) -> u f (\_6777-> (u io_print _6777)); (1,f) -> u f (\_6778-> (let _defs_4=_6778 in (let _defn_5=(u (u fm_get _name_1) _defs_4) in (let _6779 = _defn_5 in (case _6779 of {(0,f) -> u f ((u io_print ((("Term '"::String) ++ (((_name_1::String) ++ "' not found.")))))); (1,f) -> u f (\_6780-> (let _6781 = _6780 in (case _6781 of {(0,f) -> u f (\_6782 _6783 _6784 _6785 _6786 _6787-> (u io_print (u fm_term_show (u (u fm_term_normalize _6785) _defs_4)))); }))); }))))); })))))
fm = (let ___1=fm_to_core_io_one in (let ___2=fm_checker_io_one in (let ___3=fm_checker_io_file in (let ___4=fm_checker_code in (let ___5=fm_term_read in (let ___6=fm_compute_io_one in (u (u io_monad (\_m_bind_7-> (\_m_pure_8-> _m_pure_8))) unit_new)))))))

